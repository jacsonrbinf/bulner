-- MySQL dump 10.13  Distrib 5.7.20, for Linux (x86_64)
--
-- Host: localhost    Database: fse2014tomcat
-- ------------------------------------------------------
-- Server version	5.7.25-0ubuntu0.16.04.2

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE='+00:00' */;
/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;

--
-- Table structure for table `bug_commit`
--

DROP TABLE IF EXISTS `bug_commit`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `bug_commit` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `bug_id` int(11) NOT NULL,
  `summary` text CHARACTER SET utf8 NOT NULL,
  `description` text CHARACTER SET utf8 NOT NULL,
  `report_time` datetime NOT NULL,
  `reporter` varchar(50) CHARACTER SET utf8 NOT NULL,
  `assignee` varchar(50) CHARACTER SET utf8 NOT NULL,
  `status` varchar(50) CHARACTER SET utf8 NOT NULL,
  `product` varchar(50) CHARACTER SET utf8 NOT NULL,
  `component` varchar(50) CHARACTER SET utf8 NOT NULL,
  `importance` varchar(50) CHARACTER SET utf8 NOT NULL,
  `commit` varchar(50) CHARACTER SET utf8 NOT NULL,
  `author` varchar(50) CHARACTER SET utf8 NOT NULL,
  `commit_time` datetime NOT NULL,
  `log` text CHARACTER SET utf8 NOT NULL,
  `files` mediumtext CHARACTER SET utf8 NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=MyISAM AUTO_INCREMENT=2275 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `bug_commit`
--

LOCK TABLES `bug_commit` WRITE;
/*!40000 ALTER TABLE `bug_commit` DISABLE KEYS */;
INSERT INTO `bug_commit` VALUES (1,56031,'Bug 56031 – Tomcat 7.0.50 breaks on valid EL ternary expressions','After migrating an existing webapp to tomcat 7.0.50 I started getting exceptions for EL expressions that worked fine in previous versions (everything seems to work just fine in 7.0.47 and previous versions, also tomcat 6.0.x).\n\nAll the errors I got were related to ternary expressions, and the error reported a strange corrupted version of the expression.\n\nThis is a sample expression:\n${my:link(!empty registration ? registration : ‘/test/registration\')}\n\nAnd this is the error I get:\norg.apache.jasper.JasperException: /WEB-INF/tags/project/tool.tag (line: 224, column: 110) \"${my:link(!empty registration ? registration : \'/test/registration\')}\" contains invalid expression(s): javax.el.ELException: Failed to parse the expression [${my:link(!emptyregistration?::\'/test/registration\')}]\n\n\nAs you can see in the error tomcat reports the expression as \"${my:link(!emptyregistration?::’/test/registration\')}\", removing all the whitespace and also replacing the \"registration\" variable with \":\".\n\nI checked all the settings to see if there may be a problem with the file encoding, whitespace characters or similar, but everything looks ok. After downgrading to 7.0.47 with the same webapp and settings everything works ok.\n\nI got several other errors in similar expressions, for all of them the expression reported in the errors has all the whitespace removed.\n\n\nI did a few tests and for this specific case I can make it work by changing it in the following way:\n${my:link(!empty registration ? registration : ‘/test/registration\')} -> does not work\n${my:link(!empty registration ? \'test\' : ‘/test/registration\')} -> works\n\nIf this matters, the problems showed up in jsp tag files, with declared jsp version 2.0 (<jsp:root version=\"2.0\" ), xml format. Tested both on mac osx/java6 and redhat linux/java6.\n\nI couldn\'t find anything that may be related in jasper changelog between 7.0.47 and 7.0.50... do you have any idea if there is something that could cause this behaviour?','2014-01-18 20:53:00','Fabrizio Giustina','Tomcat Developers Mailing List','','Tomcat 7','Jasper','P2 regression','efc56c5','Mark Emlyn David Thomas','2014-01-18 16:33:21','Add the test case from bug 56031 as it suggested there may be further issues - there were not','test/org/apache/jasper/compiler/TestELParser.java'),(2,56012,'Bug 56012 – wrong import statement generation while using the extends attribute of the page directive','','2014-01-15 07:30:17','Eugene Chung (TmaxSoft)','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','42056be','Mark Emlyn David Thomas','2014-01-18 16:24:37','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=56012 Imports from unnamed packages are now explicitly illegal','java/org/apache/jasper/compiler/PageInfo.java\njava/org/apache/jasper/compiler/Validator.java'),(3,56029,'Bug 56029 – Ternary operator doesn\'t work as expected inside attributes in jspx pages','','2014-01-18 12:42:47','Michael Simons','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 major','b430e29','Mark Emlyn David Thomas','2014-01-18 14:33:19','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=56029 a regression in the fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=55198 Remove the code to skip whitespace from the \'simple\'EL parser. It is far simpler to retain the whitespace than it is to teach this simple parser parser when to insert it. This also has the benefit that the EL should remain unchanged. A a number of test cases for BZ 56029','java/org/apache/jasper/compiler/ELParser.java\ntest/org/apache/jasper/compiler/TestELParser.java'),(4,55198,'Bug 55198 – Quote entity in html element attribute evaluated in tagx if attribute contains EL expression','','2013-07-05 04:32:38','Evan Greensmith','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','b430e29','Mark Emlyn David Thomas','2014-01-18 14:33:19','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=56029 a regression in the fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=55198 Remove the code to skip whitespace from the \'simple\'EL parser. It is far simpler to retain the whitespace than it is to teach this simple parser parser when to insert it. This also has the benefit that the EL should remain unchanged. A a number of test cases for BZ 56029','java/org/apache/jasper/compiler/ELParser.java\ntest/org/apache/jasper/compiler/TestELParser.java'),(6,55943,'Bug 55943 – Provide a way prevent  looking at the System classloader before the webapp classloaders','','2014-01-01 10:02:46','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','f28800c','Mark Emlyn David Thomas','2014-01-17 10:16:35','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55943 Better implementation of the class loader check that prevents web applications from trying to override J2SE implementation classes. Refactor the way a null parent class loader was handled which enables a number of null checks and object creation calls to be removed','java/org/apache/catalina/loader/WebappClassLoader.java'),(7,56025,'Bug 56025 – Order of invocation of method of ServerEndpointConfig.Configurator','','2014-01-17 08:23:30','Simone Bordet','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','WebSocket','P2 normal','11b1e83','Mark Emlyn David Thomas','2014-01-17 06:50:11','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=56025 Always call ServerEndpointConfig.Configurator.getNegotiatedSubprotocol() CReate the EndPoint instance after calling ServerEndpointConfig.Configurator.modifyHandshake()','java/org/apache/tomcat/websocket/server/UpgradeUtil.java'),(8,56010,'Bug 56010 – JspFactory.getPageContext with JspWriter.DEFAULT_BUFFER throws IllegalArgumentException','','2014-01-15 03:34:23','Eugene Chung (TmaxSoft)','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','48650dd','Mark Emlyn David Thomas','2014-01-16 09:21:17','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=56010 Don\'t throw an IllegalArgumentException when JspFactory.getPageContext is used with JspWriter.DEFAULT_BUFFER Based on a patch by Eugene Chung. (markt)','java/org/apache/jasper/runtime/PageContextImpl.java\ntest/org/apache/jasper/runtime/TestPageContextImpl.java'),(9,55855,'Bug 55855 – Unexpected WsFilter is configured in a webapp that does not use WebSocket','','2013-12-07 00:38:18','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','af5af77','Mark Emlyn David Thomas','2014-01-15 07:23:23','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55855 Provide a context level option to exclude container SCIs.','java/org/apache/catalina/Context.java\njava/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/startup/ContextConfig.java\njava/org/apache/catalina/startup/FailedContext.java\njava/org/apache/catalina/startup/WebappServiceLoader.java\ntest/org/apache/catalina/core/TesterContext.java\ntest/org/apache/catalina/startup/TestWebappServiceLoader.java\nwebapps/docs/config/context.xml'),(10,55996,'Bug 55996 – Async context does not timeout with HTTP NIO connector','','2014-01-13 06:12:37','Hardeep','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 critical','553ad39','Mark Emlyn David Thomas','2014-01-14 12:58:45','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55996 Ensure Async requests timeout correctly.','java/org/apache/tomcat/util/net/SocketWrapper.java'),(11,56003,'Bug 56003 – tool-wrapper.bat cannot report failures. because ExceptionUtils class is not on classpath','','2014-01-13 22:59:44','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','b18520a','Mark Emlyn David Thomas','2014-01-14 07:10:07','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=56003 tool-wrapper.[sh|bat] requires tomcat-util.jar on the class path','bin/tool-wrapper.bat\nbin/tool-wrapper.sh'),(12,55995,'Bug 55995 – java.lang.NullPointerException at org.apache.jasper.servlet.JspCServletContext.getResource(JspCServletContext.java:344)','Null pointer exception when running JSPC from a Shell Script.\n\nJspCServletContext.java:344\n    /**\n     * Return a URL object of a resource that is mapped to the\n     * specified context-relative path.\n     *\n     * @param path Context-relative path of the desired resource\n     *\n     * @exception MalformedURLException if the resource path is\n     *  not properly formed\n     */\n    @Override\n    public URL getResource(String path) throws MalformedURLException {\n\n        if (!path.startsWith(\"/\"))\n            throw new MalformedURLException(\"Path \'\" + path +\n                                            \"\' does not start with \'/\'\");\n\nTldCache.java:124\n\n    private long[] getLastModified(TldResourcePath tldResourcePath) {\n        long[] result = new long[2];\n        result[0] = -1;\n        result[1] = -1;\n        try {\n            URL url = servletContext.getResource(tldResourcePath.getWebappPath());\n\n\n/usr/java/jdk1.7.0_45/bin/java -classpath :/home/tomcat/apache-tomcat-8.0.0-RC10/lib/catalina-storeconfig.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/tomcat-websocket.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/tomcat-i18n-es.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/catalina-tribes.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/catalina-ha.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/tomcat-i18n-ja.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/jsp-api.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/tomcat-util.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/tomcat-jni.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/jasper.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/websocket-api.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/ecj-4.3.1.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/tomcat-i18n-fr.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/tomcat-api.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/tomcat-coyote.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/servlet-api.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/jasper-el.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/catalina.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/tomcat-dbcp.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/tomcat-jdbc.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/annotations-api.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/tomcat-util-scan.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/catalina-ant.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/el-api.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/lib/tomcat-spdy.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/bin/tomcat-juli.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/bin/bootstrap.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/bin/commons-daemon.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/webapps/examples/WEB-INF/lib/jstl.jar:/home/tomcat/apache-tomcat-8.0.0-RC10/webapps/examples/WEB-INF/lib/standard.jar:/home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/lib/ant-1.6.5.jar org.apache.jasper.JspC 	-d /home/java/source/HEAD/work/tomcat80 	-v 	-l 	-uriroot /home/java/source/HEAD/work/jsp_compile_shared /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/dialog/qbAxesDlg.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/dialog/qbManualGecodingDlg.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/fmtdlg.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/index.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/joindlg.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/producer.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/simplefilter.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/selectvaluedlg.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/binddowsTestView.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/variableeditordlg.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/filterprompteditor.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/ajax_response.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/fontdlg.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/join_fields.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/tree_component.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/waiting_banner.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/folderblock/BID_FolderBlockInit.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/folderblock/BID_FolderBlockBoot.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/BID_EmptyContent.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/xml/BID_UrlProperties.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/xml/BID_IBFSpathToHrefs.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/xml/BID_xmlresponse.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/xml/BID_statusResponse.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/favorites/BID_favorites_tree.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/favorites/BID_FavoritesBlockBoot.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/favorites/BID_FavoritesBlockInit.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/favorites/BID_favorites_tree_boot.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/favorites/BID_listToXML.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/index.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/views/BID_InternalPage.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/views/BID_SearchTree_Boot.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/views/BID_SATree_Boot.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/views/BID_BiFrame.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/views/BID_initView.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/views/BID_ShowToolbar.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/views/BID_ExternalPage.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/views/BID_SATreeBiFrame.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/views/BID_initBindows.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/views/BID_SearchTreeBiFrame.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/recents/BID_recents_tree_boot.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/recents/BID_recents_tree.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/recents/BID_listToXML.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/error.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/groups/BID_listToXML.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/search/BID_searchListToXML.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/search/BID_listToXML.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/tree/BID_MrPropertiesToXML.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/tree/BID_flatListToXML.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/tree/BID_PlainText.jsp /home/java/source/HEAD/work/jsp_compile_shared/WEB-INF/jsp/bid/tree/BID_listToXML.jsp	  2>&1\n	\n	\nException in thread \"main\" java.lang.NullPointerException\n	at org.apache.jasper.servlet.JspCServletContext.getResource(JspCServletContext.java:344)\n	at org.apache.jasper.compiler.TldCache.getLastModified(TldCache.java:124)\n	at org.apache.jasper.compiler.TldCache.<init>(TldCache.java:70)\n	at org.apache.jasper.JspC.initServletContext(JspC.java:1468)\n	at org.apache.jasper.JspC.execute(JspC.java:1321)\n	at org.apache.jasper.JspC.main(JspC.java:269)','2014-01-13 05:55:30','Peter Lenahan','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Jasper','P2 normal','5e6b884','Mark Emlyn David Thomas','2014-01-14 07:04:41','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55995 Fix NPE when using JspC and there are JARs containing TLDs on the classpath','java/org/apache/jasper/compiler/TldCache.java'),(13,55986,'Bug 55986 – catalina.sh -force may falsely report \"Tomcat has not been killed completely yet\"','','2014-01-11 11:51:50','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','94fb142','Mark Emlyn David Thomas','2014-01-13 10:39:47','https://issues.apache.org/bugzilla/show_bug.cgi?id=55986 Ensure that if Tomcat is stopped via \"kill -9 <PID>\" that the script doesn\'t falsely report that it is still running. Based on a patch by jess.','bin/catalina.sh'),(14,55743,'Bug 55743 – Shutdown script broken on linux when only using PID-File','I disabled the tomcat shutdown port on my production systems for sanity and security reasons. I\'m only using the CATALINA_PID mechanism.\n\nWhen shutting down the the tomcat server with ./shutdown.sh, nothing happens. I always have to use ./shutdown.sh -force which triggers an kill -9 internally.\n\nWhen using \"kill <tomcatpid>\", the tomcat is shutting down cleanly.\n\nIn the catalina.sh i can only find kill -0 and kill -9, but no normal kill (SIGTERM).\n\nI would expect, that the ./shutdown.sh / catalina.sh script at first sends a normal kill (15, SIGTERM), and, if the -force parameter is set, sends an kill -9 after a small timeout - but that never happens.\n\nThis problem exists with all tomcat 7 versions on 32 / 64 bit linux.','2013-11-05 11:04:11','Felix Becker','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Packaging','P2 enhancement','c6f512d','Mark Emlyn David Thomas','2014-01-13 10:20:59','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55743 Enable the stop script to work when the shutdown port is disabled and a PID file is defined.','bin/catalina.sh'),(15,55893,'Bug 55893 – Split AccessLogValve and extract the formatting logic in an AbstractAccessLogValve','','2013-12-16 21:24:37','Cyrille Le Clerc','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 enhancement','92ce68a','Mark Emlyn David Thomas','2014-01-10 08:09:50','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55893 Split AccessLogValve and extract the formatting logic in an AbstractAccessLogValve to facilitate other implementations that output to destinations other than files. Patch provided by Cyrille Le Clerc','java/org/apache/catalina/valves/AbstractAccessLogValve.java\njava/org/apache/catalina/valves/AccessLogValve.java'),(16,55978,'Bug 55978 – Initial call to onWritePossible() not made by container when using HTTP upgrade','When using a WriteListener and non-blocking IO with the Servlet async API, the container makes the first call to onWritePossible() as per the spec.\n\nWhen using a WriteListener and non-blocking IO with the Servlet HTTP upgrade API the container does not make the initial call to onWritePossible(). When fixing this bug it is worth checking the initial call to onDataAvailable() as well.','2014-01-08 10:37:25','Mark Thomas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Connectors','P2 normal','bd24edc','Mark Emlyn David Thomas','2014-01-10 06:43:02','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55978 Ensure that container makes first call on onWritePossible when using non-blocking IO with an HTTP upgraded connection','java/org/apache/coyote/AbstractProtocol.java\njava/org/apache/coyote/http11/upgrade/AbstractProcessor.java\njava/org/apache/coyote/http11/upgrade/AbstractServletOutputStream.java\njava/org/apache/coyote/http11/upgrade/AprServletOutputStream.java\njava/org/apache/coyote/http11/upgrade/BioServletOutputStream.java\njava/org/apache/coyote/http11/upgrade/NioServletOutputStream.java\ntest/org/apache/coyote/http11/upgrade/TestUpgrade.java'),(17,55976,'Bug 55976 – Broken response from NIO connector in Tomcat 7.0.50','','2014-01-08 09:52:04','Ognjen Blagojevic','Tomcat Developers Mailing List','CLOSED FIXED','Tomcat 7','Connectors','P2 normal','d423ae2','Mark Emlyn David Thomas','2014-01-09 16:32:25','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55976 Fix sendfile support on NIO','java/org/apache/coyote/http11/Http11NioProcessor.java'),(18,55974,'Bug 55974 – Honor the order when reporting XML parsing errors and warnings in XmlErrorHandler class','','2014-01-07 22:59:05','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','328adb1','Mark Emlyn David Thomas','2014-01-09 10:29:45','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55974 Preserve the order of reported errors and warnings','java/org/apache/tomcat/util/descriptor/XmlErrorHandler.java'),(19,55970,'Bug 55970 – A reloadable context is reloaded repeatedly if WEB-INF/lib contains non-jar files','','2014-01-07 18:13:45','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','5594699','Mark Emlyn David Thomas','2014-01-09 10:25:14','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55970 Ignore non-JAR resources in WEB-INF/lib when checking to see if a reloadable web application has updated JARs.','java/org/apache/catalina/loader/LocalStrings.properties\njava/org/apache/catalina/loader/WebappClassLoader.java'),(20,55960,'Bug 55960 – TestSSOnonLoginAndBasicAuthenticator is flawed and incomplete','','2014-01-06 14:47:05','Brian Burch','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 minor','ad129f8','Mark Emlyn David Thomas','2014-01-09 10:01:41','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55960 Improve SSO unit tests Patch by Brian Burch','test/org/apache/catalina/authenticator/TestSSOnonLoginAndBasicAuthenticator.java\ntest/org/apache/catalina/startup/TesterServletEncodeUrl.java'),(21,55958,'Bug 55958 – Tomcat tries to deploy dir as zip archive even when it is a directory if the name ends with .war','Webapp deployment fails if the dirname ends with .war because it is automatically considered as zip archive.','2014-01-06 09:28:12','Radim Hatlapatka','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','5964a52','Mark Emlyn David Thomas','2014-01-09 08:59:10','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55958 Differentiate between foo.war the directory and foo.war the file','java/org/apache/catalina/core/ContainerBase.java\njava/org/apache/catalina/ha/deploy/FarmWarDeployer.java\njava/org/apache/catalina/manager/HTMLManagerServlet.java\njava/org/apache/catalina/mbeans/MBeanUtils.java\njava/org/apache/catalina/startup/FailedContext.java\njava/org/apache/catalina/startup/HostConfig.java\njava/org/apache/catalina/storeconfig/StandardContextSF.java\njava/org/apache/catalina/util/ContextName.java\ntest/org/apache/catalina/startup/TestHostConfigAutomaticDeployment.java\ntest/org/apache/catalina/util/TestContextName.java'),(22,55937,'Bug 55937 – Tomcat auto deployer not working for ROOT applications','','2013-12-27 15:41:22','Jesse Barnum','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Manager','P2 minor','346e264','Mark Emlyn David Thomas','2014-01-09 06:38:52','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55937 Treat a context path of \"/ROOT\" as equivalent to \"\" (i.e. it is treated as the ROOT application). Note that when deploying an application via the manager text interface to /ROOT, it was deployed as the ROOT application but reported that the deployment had failed. It now deploys it as the ROOT application and reports a successful deployment to the context path \"/\"','java/org/apache/catalina/util/ContextName.java\ntest/org/apache/catalina/util/TestContextName.java'),(23,55888,'Bug 55888 – Not clear that a container may only contain a single Realm in server.xml','I defined a realm in server.xml...\n\ninside\n<Engine name=\"Catalina\" defaultHost=\"localhost\">\n\nbelow the block\n<!-- Use the LockOutRealm to prevent attempts to guess user passwords\n     via a brute-force attack -->\n<Realm className=\"org.apache.catalina.realm.LockOutRealm\">\n  <!-- This Realm uses the UserDatabase configured in the global JNDI\n       resources under the key \"UserDatabase\".  Any edits\n       that are performed against this UserDatabase are immediately\n       available for use by the Realm.  -->\n  <Realm className=\"org.apache.catalina.realm.UserDatabaseRealm\"\n         resourceName=\"UserDatabase\"/>\n</Realm>\n\nadd\n<Realm className=\"org.apache.catalina.realm.MemoryRealm\"\n    digest=\"MD5\" pathname=\"conf/my-realm.xml\"/>\n\nIt works fine initially. Later, I move the realm def above that block. The config is not changed logically, but then authentication of my realm fails.','2013-12-16 08:39:25','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 normal','21e1546','Mark Emlyn David Thomas','2014-01-09 05:42:56','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55888 Clarify that Container elements may only no more than one Realm.','webapps/docs/config/realm.xml'),(24,55939,'Bug 55939 – Seeing issues with non-blocking io when writing lots of data','','2013-12-29 19:40:03','Daniel Mikusa','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','411e4cc','Mark Emlyn David Thomas','2013-12-30 14:39:23','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55939 Ensure that flags used for non-blocking writes are reset between requests.','java/org/apache/coyote/Response.java'),(25,55917,'Bug 55917 – Cookie parsing fails hard with ISO-8859-1 values','','2013-12-20 20:22:13','Jeremy Boynes','Tomcat Developers Mailing List','NEW','Tomcat 8','Connectors','P2 normal','0f985f2','Jeremy Boynes','2013-12-23 14:15:35','fix #55917 by allowing 8-bit ISO-8859-1 characters in V0 cookie values','java/org/apache/tomcat/util/http/Cookies.java\ntest/org/apache/tomcat/util/http/TestCookies.java\nwebapps/docs/changelog.xml'),(26,55905,'Bug 55905 – Error message unhelpful when web.xml references a tld file that doesn\'t exist','','2013-12-18 14:30:15','Anthony Gerrard','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','bcb9c58','Violeta Georgieva Georgieva','2013-12-18 14:28:21','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55905 Prevent NPE when the specified tld resource does not exists.','java/org/apache/jasper/resources/LocalStrings.properties\njava/org/apache/jasper/servlet/TldScanner.java'),(27,55855,'Bug 55855 – Unexpected WsFilter is configured in a webapp that does not use WebSocket','','2013-12-07 00:38:18','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','82cf5dc','Mark Emlyn David Thomas','2013-12-18 12:29:08','Alternative partial fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=55855. Don\'t do the expensive \'Is this a WebSocket upgrade request check\' if no endpoints have been registered','java/org/apache/tomcat/websocket/server/WsFilter.java\njava/org/apache/tomcat/websocket/server/WsServerContainer.java'),(28,48550,'Bug 48550 – Update examples and default server.xml to use UTF-8','','2010-01-14 13:52:03','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Examples','P2 enhancement','653da8f','Konstantin Preißer','2013-12-17 21:53:35','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48550 Follow-Up to r1511468: Fix example servlets to output text as UTF-8. This fixes encoding issues with the \"Request Parameters\" and \"Cookies\" servlet examples as otherwise the browser would encode the form data with the document encoding (ISO-8859-1) but Tomcat will interpret it as UTF-8.','webapps/examples/WEB-INF/classes/CookieExample.java\nwebapps/examples/WEB-INF/classes/HelloWorldExample.java\nwebapps/examples/WEB-INF/classes/RequestHeaderExample.java\nwebapps/examples/WEB-INF/classes/RequestInfoExample.java\nwebapps/examples/WEB-INF/classes/RequestParamExample.java\nwebapps/examples/WEB-INF/classes/SessionExample.java'),(29,55855,'Bug 55855 – Unexpected WsFilter is configured in a webapp that does not use WebSocket','','2013-12-07 00:38:18','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','0b39cf4','Mark Emlyn David Thomas','2013-12-16 15:59:36','Performance improvement Partial fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=55855 Make the adding of the WsFilter lazy so it doesn\'t get added to web apps that don\'t need it.','java/org/apache/tomcat/websocket/server/WsServerContainer.java'),(30,55884,'Bug 55884 – JSPs no longer compile in Java 8','','2013-12-14 17:03:59','Nick Williams','Tomcat Developers Mailing List','VERIFIED FIXED','Tomcat 8','Jasper','P2 major','8a5179c','Mark Emlyn David Thomas','2013-12-16 10:48:04','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55884 Ensure that URLs that are converted to file paths are correctly decoded. The primary use is to ensure that %20 sequences are converted to spaces.','java/org/apache/jasper/compiler/JspRuntimeContext.java'),(31,55820,'Bug 55820 – Add 172.16/12 range to default internal proxies','','2013-11-27 15:53:07','Filip Hanik','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 enhancement','c1be72f','Mark Emlyn David Thomas','2013-12-09 04:48:42','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55820 Include the 172.16/12 range in the default value for internal proxies.','java/org/apache/catalina/filters/RemoteIpFilter.java\njava/org/apache/catalina/valves/RemoteIpValve.java\nwebapps/docs/config/filter.xml\nwebapps/docs/config/valve.xml'),(32,55811,'Bug 55811 – Do not parse web-fragment.xml files when empty absolute-ordering','','2013-11-22 14:45:40','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','f4da7dc','Mark Emlyn David Thomas','2013-12-07 15:43:46','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55811 Do not parse web-fragment.xml files when an empty absolute-ordering element is present.','java/org/apache/catalina/startup/ContextConfig.java\njava/org/apache/jasper/servlet/JspCServletContext.java\njava/org/apache/tomcat/util/descriptor/web/FragmentJarScannerCallback.java'),(33,55801,'Bug 55801 – Add ability to provide custom SSLContext for websocket client','','2013-11-20 09:57:24','Maciej Lypik','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','ef3f56e','Mark Emlyn David Thomas','2013-12-07 15:10:59','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55801 Add the ability to use a custom SSLContext when creating client wss connections. Patch provided by Maciej Lypik.','java/org/apache/tomcat/websocket/WsWebSocketContainer.java\nwebapps/docs/web-socket-howto.xml'),(34,55851,'Bug 55851 – Tomcat SPNEGO authenticator incompatible with IBM JDK: Accept Security Context needs to be wrapped around a Privileged Action in order for server side authentication','','2013-12-06 08:56:41','Arunav Sanyal','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','bba9747','Mark Emlyn David Thomas','2013-12-06 14:42:43','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55851 Enable SPNEGO to work with IBM JDKs. Based on a patch by Arunav Sanyal.','java/org/apache/catalina/authenticator/SpnegoAuthenticator.java'),(35,55842,'Bug 55842 – response.setBufferSize() does not seem to work properly','I found a problem with setting the buffer size for the ServletResponse. \nIf I call \'response.setBufferSize(1,000,000);\' and send about 20,000 characters, the response will be chunked even though it should not.\nThe response is sent in several chunks and contains the \'Transfer-Encoding: chunked\' response header.\nIn my understanding in this case the response should be fully buffered on the server and then sent as a whole containing the Content-Length-header.\n\nThis causes a problem in my application because I want to use a larger buffer to be able to redirect to an error page if an error occurs during rendering the response. \n\nI was able to reproduce this on Tomcat 7.0.39, 7.0.40, 7.0.42, 7.0.47. Tomcat 7.0.37 works fine and as expected.\n\nThis is easily reproducable by using a JSP as follows:\n<%\nresponse.setBufferSize(1000*1000);\nfor (int i = 0; i < 100; i++) {\n	for (int j = 0; j < 100; j++) {\n		response.getWriter().write(\"X\");\n	}\n    response.getWriter().write(\"<br />\");\n}\n%>','2013-12-04 15:56:09','Martin Maier-Moessner','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','f4970a7','Mark Emlyn David Thomas','2013-12-06 07:12:15','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55842 Check if the output buffer can grow before flushing it when using a writer.','java/org/apache/catalina/connector/OutputBuffer.java\njava/org/apache/tomcat/util/buf/ByteChunk.java'),(36,55839,'Bug 55839 – DataSourceRealm doesn\'t handle prefix on password digest','','2013-12-03 16:30:00','Steve Holmes','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','5ef87d2','Mark Emlyn David Thomas','2013-12-05 11:11:55','Additional fix for BZ 55839 required by MemoryRealm','java/org/apache/catalina/realm/MemoryRealm.java'),(37,55839,'Bug 55839 – DataSourceRealm doesn\'t handle prefix on password digest','','2013-12-03 16:30:00','Steve Holmes','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','676718b','Mark Emlyn David Thomas','2013-12-05 11:08:44','Additional fix for BZ 55839 required by JDBCRealm','java/org/apache/catalina/realm/JDBCRealm.java'),(38,55839,'Bug 55839 – DataSourceRealm doesn\'t handle prefix on password digest','','2013-12-03 16:30:00','Steve Holmes','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','1327875','Mark Emlyn David Thomas','2013-12-05 11:07:40','Additional fix for BZ 55839 required by DataSourceRealm','java/org/apache/catalina/realm/DataSourceRealm.java'),(39,55839,'Bug 55839 – DataSourceRealm doesn\'t handle prefix on password digest','','2013-12-03 16:30:00','Steve Holmes','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','676411f','Mark Emlyn David Thomas','2013-12-05 10:36:36','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55839 Extend support for digest prefixes {MD5}, {SHA} and {SSHA} to all Realms rather than just the JNDIRealm.','java/org/apache/catalina/realm/JNDIRealm.java\njava/org/apache/catalina/realm/RealmBase.java\ntest/org/apache/catalina/core/TesterContext.java\ntest/org/apache/catalina/realm/TestRealmBase.java'),(40,55837,'Bug 55837 – ServletContext.getRealPath() returns null','[code]\nString path = servletContext.getRealPath(\'/test\');\n\nif no file or folder named \'/test\' exist in webroot \nthen path return null\n\nbut int tomcat 5\\6\\7, it will return the correct value , ex /data/oschina/webapp/test','2013-12-03 08:03:13','oschina.net','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','a63bf3a','Mark Emlyn David Thomas','2013-12-04 12:18:57','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55837 getRealPath() should return a result for resources that don\'t exist where possible Add some unit tests to check this.','java/org/apache/catalina/webresources/DirResourceSet.java\njava/org/apache/catalina/webresources/EmptyResource.java\njava/org/apache/catalina/webresources/StandardRoot.java\ntest/org/apache/catalina/webresources/AbstractTestResourceSet.java'),(41,55383,'Bug 55383 – Improve markup and design of Tomcat\'s HTML pages','','2013-08-07 20:54:30','Konstantin Preißer','Tomcat Developers Mailing List','NEW','Tomcat 8','Documentation','P2 enhancement','dc6f22b','Konstantin Preißer','2013-11-29 18:41:55','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55383 Include \"Open Sans\" font and use it for the documentation.','webapps/docs/images/docs-stylesheet.css\nwebapps/docs/images/fonts/OpenSans400.woff\nwebapps/docs/images/fonts/OpenSans400italic.woff\nwebapps/docs/images/fonts/OpenSans600.woff\nwebapps/docs/images/fonts/OpenSans600italic.woff\nwebapps/docs/images/fonts/OpenSans700.woff\nwebapps/docs/images/fonts/OpenSans700italic.woff\nwebapps/docs/images/fonts/fonts.css'),(42,55804,'Bug 55804 – SPNEGOAUTHENTICATOR - GSSCredential does not get renewed after RemainingLifeTime is less than zero','In SpnegoAuthenticator, we check for request.getUserPrincipal() if it returns a prinicpal we do not do a fresh authentication. This happens even when the GSSCredential returned by GenericPrincipal has remainingLife time less than zero. This causes issues in delegating the credential as the credential is not valid any more.\n\nCan we add additional check to reauthenticate when the credental has expired and put GSSCredential in the same session?','2013-11-20 19:23:11','Sachin Kumar','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 critical','8f67335','Mark Emlyn David Thomas','2013-11-29 14:25:49','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55804 If the GSSCrednetial for the cached principal expires when using SPNEGO authentication, force a re-authentication.','java/org/apache/catalina/connector/LocalStrings.properties\njava/org/apache/catalina/connector/Request.java'),(43,55799,'Bug 55799 – [websocket] Stability issues when concurrently sending large messages','','2013-11-20 00:01:34','Konstantin Preißer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','WebSocket','P2 normal','6edf370','Mark Emlyn David Thomas','2013-11-28 09:55:03','Additional fix required for bug 55799','java/org/apache/tomcat/websocket/WsRemoteEndpointImplBase.java'),(44,55807,'Bug 55807 – JSP\'s always marked as outdated with Jar Scanner Component configured with “scanAllDirectories” and referenced Taglib in WEB-INF/classes/META-INF','consider the following (simplified) eclipse project configuration.\n\nweb_base_jar (shared taglib etc.)\nweb_war (uses web_base_jar)\n\nWhen developing our web project locally we use an exploded war layout. The compile output\nof web_base_jar is directly copied (not as a jar!) to the war’s\nweb_war/WEB-INF/classes directory by our ide’s (eclipse with sysdeo plugin and intellij).\nOur shared taglib ends up here: web_war/WEB-INF/classes/META-INF/myTaglib.tld. The taglib\nis successfully picked up by the Jar Scanner configured with “scanAllDirectories”.\n\nThis leads to the following generated jsp code when myTaglib is used:\n\n  static {\n    _jspx_dependants = new java.util.HashMap<java.lang.String,java.lang.Long>(1);\n    _jspx_dependants.put(\"file:/somepath/pc_web_war_exploded/WEB-INF/classes/META-INF/ myTaglib.tld\n\", Long.valueOf(-1L));\n  }\n\nThe relevant code for this snippet is in org.apache.jasper.compiler.TagLibraryInfoImpl.<init>(TagLibraryInfoImpl.java:173).\nBecause the Taglib is a file uri (file:/C:/somepath/pc_web_war_exploded/WEB-INF/classes/META-INF/myTaglib.tld)\nit is not found by ApplicationContext#getResource and the method\norg.apache.jasper.JspCompilationContext.getLastModified(JspCompilationContext.java:437) returns\n-1 in this case.\n\nWhen the compiler checks if the current jsp is outdated it checks also all includes/dependants.\nBecause myTaglib is in the dependants  list of our jsps it is also checked. The check tests\nthe lastModified timestamp of the file against -1 and returns always true. See here org.apache.jasper.compiler.Compiler.isOutDated(Compiler.java:519)\nThis means that our jsps are recompiled on every request. We have some workarounds for this but it would be nice if this setup would work out of the box','2013-11-21 13:14:21','Philip Herbst','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','fe68fe1','Mark Emlyn David Thomas','2013-11-27 15:28:40','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55807 The JSP compiler used a last modified time of -1 for TLDs in JARs expanded in to WEB-INF/classes (IDEs often do this expansion) when creating the dependency list for JSPs that used that TLD. This meant JSPs using that TLD were recompiled on every access.','webapps/docs/changelog.xml'),(45,55807,'Bug 55807 – JSP\'s always marked as outdated with Jar Scanner Component configured with “scanAllDirectories” and referenced Taglib in WEB-INF/classes/META-INF','consider the following (simplified) eclipse project configuration.\n\nweb_base_jar (shared taglib etc.)\nweb_war (uses web_base_jar)\n\nWhen developing our web project locally we use an exploded war layout. The compile output\nof web_base_jar is directly copied (not as a jar!) to the war’s\nweb_war/WEB-INF/classes directory by our ide’s (eclipse with sysdeo plugin and intellij).\nOur shared taglib ends up here: web_war/WEB-INF/classes/META-INF/myTaglib.tld. The taglib\nis successfully picked up by the Jar Scanner configured with “scanAllDirectories”.\n\nThis leads to the following generated jsp code when myTaglib is used:\n\n  static {\n    _jspx_dependants = new java.util.HashMap<java.lang.String,java.lang.Long>(1);\n    _jspx_dependants.put(\"file:/somepath/pc_web_war_exploded/WEB-INF/classes/META-INF/ myTaglib.tld\n\", Long.valueOf(-1L));\n  }\n\nThe relevant code for this snippet is in org.apache.jasper.compiler.TagLibraryInfoImpl.<init>(TagLibraryInfoImpl.java:173).\nBecause the Taglib is a file uri (file:/C:/somepath/pc_web_war_exploded/WEB-INF/classes/META-INF/myTaglib.tld)\nit is not found by ApplicationContext#getResource and the method\norg.apache.jasper.JspCompilationContext.getLastModified(JspCompilationContext.java:437) returns\n-1 in this case.\n\nWhen the compiler checks if the current jsp is outdated it checks also all includes/dependants.\nBecause myTaglib is in the dependants  list of our jsps it is also checked. The check tests\nthe lastModified timestamp of the file against -1 and returns always true. See here org.apache.jasper.compiler.Compiler.isOutDated(Compiler.java:519)\nThis means that our jsps are recompiled on every request. We have some workarounds for this but it would be nice if this setup would work out of the box','2013-11-21 13:14:21','Philip Herbst','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','2439a4e','Mark Emlyn David Thomas','2013-11-27 14:58:05','Create dependency to the TLD file rather than to the webappPath of the root of the search Add a test case for bug 55807 and the other issues fixed in TldScanner while investigating bug 55807','java/org/apache/jasper/servlet/TldScanner.java\ntest/org/apache/jasper/servlet/TestTldScanner.java\ntest/webapp/WEB-INF/classes/META-INF/bug55807.tld\ntest/webapp/bug5nnnn/bug55807.jsp'),(46,55807,'Bug 55807 – JSP\'s always marked as outdated with Jar Scanner Component configured with “scanAllDirectories” and referenced Taglib in WEB-INF/classes/META-INF','consider the following (simplified) eclipse project configuration.\n\nweb_base_jar (shared taglib etc.)\nweb_war (uses web_base_jar)\n\nWhen developing our web project locally we use an exploded war layout. The compile output\nof web_base_jar is directly copied (not as a jar!) to the war’s\nweb_war/WEB-INF/classes directory by our ide’s (eclipse with sysdeo plugin and intellij).\nOur shared taglib ends up here: web_war/WEB-INF/classes/META-INF/myTaglib.tld. The taglib\nis successfully picked up by the Jar Scanner configured with “scanAllDirectories”.\n\nThis leads to the following generated jsp code when myTaglib is used:\n\n  static {\n    _jspx_dependants = new java.util.HashMap<java.lang.String,java.lang.Long>(1);\n    _jspx_dependants.put(\"file:/somepath/pc_web_war_exploded/WEB-INF/classes/META-INF/ myTaglib.tld\n\", Long.valueOf(-1L));\n  }\n\nThe relevant code for this snippet is in org.apache.jasper.compiler.TagLibraryInfoImpl.<init>(TagLibraryInfoImpl.java:173).\nBecause the Taglib is a file uri (file:/C:/somepath/pc_web_war_exploded/WEB-INF/classes/META-INF/myTaglib.tld)\nit is not found by ApplicationContext#getResource and the method\norg.apache.jasper.JspCompilationContext.getLastModified(JspCompilationContext.java:437) returns\n-1 in this case.\n\nWhen the compiler checks if the current jsp is outdated it checks also all includes/dependants.\nBecause myTaglib is in the dependants  list of our jsps it is also checked. The check tests\nthe lastModified timestamp of the file against -1 and returns always true. See here org.apache.jasper.compiler.Compiler.isOutDated(Compiler.java:519)\nThis means that our jsps are recompiled on every request. We have some workarounds for this but it would be nice if this setup would work out of the box','2013-11-21 13:14:21','Philip Herbst','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','2439a4e','Mark Emlyn David Thomas','2013-11-27 14:58:05','Create dependency to the TLD file rather than to the webappPath of the root of the search Add a test case for bug 55807 and the other issues fixed in TldScanner while investigating bug 55807','java/org/apache/jasper/servlet/TldScanner.java\ntest/org/apache/jasper/servlet/TestTldScanner.java\ntest/webapp/WEB-INF/classes/META-INF/bug55807.tld\ntest/webapp/bug5nnnn/bug55807.jsp'),(47,55799,'Bug 55799 – [websocket] Stability issues when concurrently sending large messages','','2013-11-20 00:01:34','Konstantin Preißer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','WebSocket','P2 normal','f8ba507','Mark Emlyn David Thomas','2013-11-26 06:29:54','Fix regression in fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=55799 that broke stream messages. Add a test case for stream messages.','java/org/apache/tomcat/websocket/WsRemoteEndpointImplBase.java\ntest/org/apache/tomcat/websocket/TestWsRemoteEndpoint.java'),(48,52323,'Bug 52323 – Cobertura test code coverage support for build.xml and build.properties.default','','2011-12-13 13:57:56','Violeta Georgieva','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Packaging','P2 enhancement','a926e08','Konstantin Kolinko','2013-11-24 17:01:22','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52323 Exclude servlet-api and Jetty JARs from Cobertura classpath. It works without them.','build.xml'),(49,52323,'Bug 52323 – Cobertura test code coverage support for build.xml and build.properties.default','','2011-12-13 13:57:56','Violeta Georgieva','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Packaging','P2 enhancement','bb4bf6b','Konstantin Kolinko','2013-11-24 16:24:17','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52323 Correct typo, add note about licensing','BUILDING.txt'),(50,55799,'Bug 55799 – [websocket] Stability issues when concurrently sending large messages','','2013-11-20 00:01:34','Konstantin Preißer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','WebSocket','P2 normal','071b542','Mark Emlyn David Thomas','2013-11-21 04:35:51','More https://issues.apache.org/bugzilla/show_bug.cgi?id=55799 If the connection is closed mid-message, report this cleanly back to the caller.','java/org/apache/tomcat/websocket/LocalStrings.properties\njava/org/apache/tomcat/websocket/WsRemoteEndpointImplBase.java'),(51,55799,'Bug 55799 – [websocket] Stability issues when concurrently sending large messages','','2013-11-20 00:01:34','Konstantin Preißer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','WebSocket','P2 normal','e1c3c3d','Mark Emlyn David Thomas','2013-11-21 04:11:07','Continuing the https://issues.apache.org/bugzilla/show_bug.cgi?id=55799 code review The check that only allowed control messages to be added to the queue is not valid so remove it. If a control message is sent in the middle of a sequence of text message parts when the current text part completes and the control message is sent there is a strong chance that the next text message part will need to be queued until the control message completes.','java/org/apache/tomcat/websocket/LocalStrings.properties\njava/org/apache/tomcat/websocket/WsRemoteEndpointImplBase.java'),(52,55799,'Bug 55799 – [websocket] Stability issues when concurrently sending large messages','','2013-11-20 00:01:34','Konstantin Preißer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','WebSocket','P2 normal','fcaefcf','Mark Emlyn David Thomas','2013-11-20 15:57:52','Further work on https://issues.apache.org/bugzilla/show_bug.cgi?id=55799 If an IO error occurs while sending (or receiving) a WebSocket message pretty much the only thing that can be done is to close the connection - hopefully in a graceful manner. Therefore, leave the state machine in the \"message in progress\" state if an error occurs as this will prevent further attempts to send non-control messages. The close message is a control message so it will not be blocked. Note that the close message may not reach the other end of the connection.','java/org/apache/tomcat/websocket/WsRemoteEndpointImplBase.java'),(53,55799,'Bug 55799 – [websocket] Stability issues when concurrently sending large messages','','2013-11-20 00:01:34','Konstantin Preißer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','WebSocket','P2 normal','fa6736e','Mark Emlyn David Thomas','2013-11-20 08:51:34','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55799 Implement the restriction required by the JSR356 specification that only one message can be written to a remote endpoint at a time.','java/org/apache/tomcat/websocket/LocalStrings.properties\njava/org/apache/tomcat/websocket/WsRemoteEndpointImplBase.java'),(54,55798,'Bug 55798 – Enabling Manager App - process and description is inadequate','','2013-11-19 23:03:23','BJ Chippindale','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 minor','13c6551','Mark Emlyn David Thomas','2013-11-20 05:07:51','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55798 Log an error if the file can\'t be found','java/org/apache/catalina/users/LocalStrings.properties\njava/org/apache/catalina/users/MemoryUserDatabase.java'),(55,55792,'Bug 55792 – EL expression containing a map is not parsed correctly. \'}\' is interpreted as closing brace of the EL expression.','I have the following EL expression in a JSP. The expression evaluates and executes correctly without error:\n\n    ${users.stream()\n        .filter(u -> fn:contains(u.username, \'1\'))\n        .sorted((u1, u2) -> (x = u1.lastName.compareTo(u2.lastName);\n            x == 0 ? u1.firstName.compareTo(u2.firstName) : x))\n        .toList()}\n\nI want to apply the map operation to this as well. Section 2.3.6.4 of the JUEL 3.0 specification uses the following example, where a list-literal is used as the right-hand side of the mapping lambda expression:\n\n    products.stream().filter(p->p.unitPrice >= 10)\n        .map(p->[p.name, p.unitPrice])\n        .toList()\n\nSo I tried applying the exact same pattern to my map operation (the new map operation is the only change to the expression):\n\n    ${users.stream()\n        .filter(u -> fn:contains(u.username, \'1\'))\n        .sorted((u1, u2) -> (x = u1.lastName.compareTo(u2.lastName);\n            x == 0 ? u1.firstName.compareTo(u2.firstName) : x))\n        .map(u -> [u.username, u.firstName, u.lastName])\n        .toList()}\n\nI also tried using a map-literal:\n\n    ${users.stream()\n        .filter(u -> fn:contains(u.username, \'1\'))\n        .sorted((u1, u2) -> (x = u1.lastName.compareTo(u2.lastName);\n            x == 0 ? u1.firstName.compareTo(u2.firstName) : x))\n        .map(u -> {\'username\':u.username, \'first\':u.firstName,\n            \'last\':u.lastName})\n        .toList()}\n\nHowever, using the list-literal in my map lambda expression results in this error, indicating that it doesn\'t recognize the list-literal as a list-literal:\n\njavax.el.ELException: java.lang.NumberFormatException: For input string: \"lastName\"\n      javax.el.BeanELResolver.invoke(BeanELResolver.java:185)\n      org.apache.jasper.el.JasperELResolver.invoke(JasperELResolver.java:147)\n      org.apache.el.parser.AstValue.getValue(AstValue.java:158)\n      ...\n\nAnd using the map-literal results in this error, indicating that it doesn\'t recognize the map-literal as a map-literal (instead, it thinks the closing brace of the map-literal is the end of the EL expression:\n\njavax.el.ELException: Failed to parse the expression [${users.stream()\n        .filter(u -> fn:contains(u.username, \'1\'))\n        .sorted((u1, u2) -> (x = u1.lastName.compareTo(u2.lastName);\n            x == 0 ? u1.firstName.compareTo(u2.firstName) : x))\n        .map(u -> {\'username\':u.username, \'first\':u.firstName,\n            \'last\':u.lastName}]\n   ...\n<root cause>\norg.apache.el.parser.ParseException: Encountered \"<EOF>\" at line 6, column 38. Was expecting one of:\n   \".\" ...\n   \")\" ...\n   etc...\n\nPutting parentheses around the list- and map-literals does not work, but the Section 2.3.6.4 example doesn\'t use parentheses. Section 1.20 also indicates that collection literals as bodies of lambda expressions are legal:\n\n    customers.select(c->[c.name, c.orders.sum(o->o.total)])\n\nCollection literals are described in more detail in Section 2.2.','2013-11-18 13:42:42','Nick Williams','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','EL','P2 normal','c2f87f7','Mark Emlyn David Thomas','2013-11-19 04:41:24','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55792 EL 3.0 introduced the possibility of nested {...} sequences within EL expressions so update the JSP parser to handle them.','java/org/apache/jasper/compiler/Parser.java'),(56,55792,'Bug 55792 – EL expression containing a map is not parsed correctly. \'}\' is interpreted as closing brace of the EL expression.','I have the following EL expression in a JSP. The expression evaluates and executes correctly without error:\n\n    ${users.stream()\n        .filter(u -> fn:contains(u.username, \'1\'))\n        .sorted((u1, u2) -> (x = u1.lastName.compareTo(u2.lastName);\n            x == 0 ? u1.firstName.compareTo(u2.firstName) : x))\n        .toList()}\n\nI want to apply the map operation to this as well. Section 2.3.6.4 of the JUEL 3.0 specification uses the following example, where a list-literal is used as the right-hand side of the mapping lambda expression:\n\n    products.stream().filter(p->p.unitPrice >= 10)\n        .map(p->[p.name, p.unitPrice])\n        .toList()\n\nSo I tried applying the exact same pattern to my map operation (the new map operation is the only change to the expression):\n\n    ${users.stream()\n        .filter(u -> fn:contains(u.username, \'1\'))\n        .sorted((u1, u2) -> (x = u1.lastName.compareTo(u2.lastName);\n            x == 0 ? u1.firstName.compareTo(u2.firstName) : x))\n        .map(u -> [u.username, u.firstName, u.lastName])\n        .toList()}\n\nI also tried using a map-literal:\n\n    ${users.stream()\n        .filter(u -> fn:contains(u.username, \'1\'))\n        .sorted((u1, u2) -> (x = u1.lastName.compareTo(u2.lastName);\n            x == 0 ? u1.firstName.compareTo(u2.firstName) : x))\n        .map(u -> {\'username\':u.username, \'first\':u.firstName,\n            \'last\':u.lastName})\n        .toList()}\n\nHowever, using the list-literal in my map lambda expression results in this error, indicating that it doesn\'t recognize the list-literal as a list-literal:\n\njavax.el.ELException: java.lang.NumberFormatException: For input string: \"lastName\"\n      javax.el.BeanELResolver.invoke(BeanELResolver.java:185)\n      org.apache.jasper.el.JasperELResolver.invoke(JasperELResolver.java:147)\n      org.apache.el.parser.AstValue.getValue(AstValue.java:158)\n      ...\n\nAnd using the map-literal results in this error, indicating that it doesn\'t recognize the map-literal as a map-literal (instead, it thinks the closing brace of the map-literal is the end of the EL expression:\n\njavax.el.ELException: Failed to parse the expression [${users.stream()\n        .filter(u -> fn:contains(u.username, \'1\'))\n        .sorted((u1, u2) -> (x = u1.lastName.compareTo(u2.lastName);\n            x == 0 ? u1.firstName.compareTo(u2.firstName) : x))\n        .map(u -> {\'username\':u.username, \'first\':u.firstName,\n            \'last\':u.lastName}]\n   ...\n<root cause>\norg.apache.el.parser.ParseException: Encountered \"<EOF>\" at line 6, column 38. Was expecting one of:\n   \".\" ...\n   \")\" ...\n   etc...\n\nPutting parentheses around the list- and map-literals does not work, but the Section 2.3.6.4 example doesn\'t use parentheses. Section 1.20 also indicates that collection literals as bodies of lambda expressions are legal:\n\n    customers.select(c->[c.name, c.orders.sum(o->o.total)])\n\nCollection literals are described in more detail in Section 2.2.','2013-11-18 13:42:42','Nick Williams','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','EL','P2 normal','13b28f3','Mark Emlyn David Thomas','2013-11-19 04:38:53','Add kkolinko\'s unit test for https://issues.apache.org/bugzilla/show_bug.cgi?id=55792','test/org/apache/el/TestELInJsp.java\ntest/webapp/el-misc.jsp'),(57,55778,'Bug 55778 – JNDIRealm: Authentication with GSSAPI to LDAP with SSL connection causes an exception','Whenever i try to authenticate with GSSAPI to a LDAP server with a SSL connection (ldaps), the following exception is thrown:\n\njavax.naming.ServiceUnavailableException: myserver.at:636; socket closed; remaining name \'dc=example,dc=org\'\n    at com.sun.jndi.ldap.Connection.readReply(Connection.java:452)\n    at com.sun.jndi.ldap.LdapClient.getSearchReply(LdapClient.java:631)\n    at com.sun.jndi.ldap.LdapClient.search(LdapClient.java:554)\n    at com.sun.jndi.ldap.LdapCtx.doSearch(LdapCtx.java:1985)\n    at com.sun.jndi.ldap.LdapCtx.searchAux(LdapCtx.java:1847)\n    at com.sun.jndi.ldap.LdapCtx.c_search(LdapCtx.java:1772)\n    ...\n\nSteps to reproduce:\n1. Configure the valve org.apache.catalina.authenticator.SpnegoAuthenticator in the server.xml with storeDelegatedCredential=\"true\".\n2. Configure the realm org.apache.catalina.realm.JNDIRealm in the server.xml with an SSL connection url (e.g. ldaps://myserver.at:636)\n3. Configure an auth-method with SPNEGO, security-constraints and security-roles in the web.xml\n4. Add required keystores to the jdk for the ldaps connection.\n5. Try to authenticate\n\nI debugged into the JNDIRealm and figured out, that changing line 2082 from \"context.addToEnvironment(\"javax.security.sasl.qop\", \"auth-conf\");\" to \"context.addToEnvironment(\"javax.security.sasl.qop\", \"auth\");\" would solve the problem. I also tested the fix with a new written JNDIRealm.\n\nBut i\'m not sure, if this fix causes other security issues.','2013-11-14 14:51:16','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 major','27806aa','Mark Emlyn David Thomas','2013-11-15 12:39:05','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55778 Make value used for javax.security.sasl.qop with SPNEGO configurable.','java/org/apache/catalina/realm/JNDIRealm.java\nwebapps/docs/config/realm.xml'),(58,55776,'Bug 55776 – if path include relative char, eg: ../, classloader will not find zhe file','I use ibatis in my project, config file path include \'..\', tomcat can not find the file, command line show:\nCould not find resource ../ibatis/code/sendType.xml','2013-11-14 06:14:50','LabnizDirac','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','a1ad6ce','Mark Emlyn David Thomas','2013-11-15 10:04:52','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55776 Normalize resource requests before processing them.','java/org/apache/catalina/webresources/StandardRoot.java'),(59,55772,'Bug 55772 – Flushing AsyncContext response writer after ClientAbortException (BrokenPipe) causes request state to leak','','2013-11-13 04:45:21','Todd West','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 critical','cb62f86','Mark Emlyn David Thomas','2013-11-15 08:39:52','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55772 Ensure that the request and response are recycled after an error during async processing.','java/org/apache/catalina/connector/CoyoteAdapter.java\njava/org/apache/coyote/ActionCode.java\njava/org/apache/coyote/ajp/AbstractAjpProcessor.java\njava/org/apache/coyote/http11/AbstractHttp11Processor.java\njava/org/apache/coyote/spdy/SpdyProcessor.java\ntest/org/apache/coyote/http11/TestAbstractHttp11Processor.java'),(60,55760,'Bug 55760 – Tomcat SPNEGO authenticator incompatible with IBM JDK in case of Keytab based initiate and accept authentication','','2013-11-08 11:48:18','Arunav Sanyal','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P1 blocker','0a4e847','Mark Emlyn David Thomas','2013-11-11 04:45:49','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55760 Remove unnecessary setting of property that causes problems whe using SPNEGO with IBM JDKs.','java/org/apache/catalina/authenticator/SpnegoAuthenticator.java'),(61,55749,'Bug 55749 – Disabling SSLEngine in AprLifecycleListener leads to misleading error message at startup when SSL Connector is delcared','Put a <Listener className=\"org.apache.catalina.core.AprLifecycleListener\" SSLEngine=\"off\" /> in you server.xml.\n\nPut the APR connector some weeks later in your server.xml:\n\n<Connector protocol=\"org.apache.coyote.http11.Http11AprProtocol\"\n  port=\"@HTTPS_PORT@\" connectionTimeout=\"20000\" maxHttpHeaderSize=\"24576\"\n  maxThreads=\"250\" URIEncoding=\"UTF-8\" bufferSize=\"4096\"\n  scheme=\"https\" secure=\"true\" SSLEnabled=\"true\" SSLProtocol=\"TLSv1\"	  \n  SSLCipherSuite=\"HIGH:!ADH\" SSLCertificateFile=\"@SSL_CERT_FILE@\"\n  SSLCertificateKeyFile=\"@SSL_CERT_KEY_FILE@\" SSLPassword=\"@SSL_PASSWORD@\" />\n\nStart your Tomcat and receive following confusing message:\nNov 06, 2013 1:30:39 PM org.apache.coyote.http11.Http11AprProtocol start\nSEVERE: Error starting endpoint\njava.lang.Exception: Socket bind failed: [226] Adresse bereits im Zugriff\n        at org.apache.tomcat.util.net.AprEndpoint.init(AprEndpoint.java:671)\n        at org.apache.tomcat.util.net.AprEndpoint.start(AprEndpoint.java:851)\n        at org.apache.coyote.http11.Http11AprProtocol.start(Http11AprProtocol.java:139)\n        at org.apache.catalina.connector.Connector.start(Connector.java:1196)\n        at org.apache.catalina.core.StandardService.start(StandardService.java:540)\n        at org.apache.catalina.core.StandardServer.start(StandardServer.java:754)\n        at org.apache.catalina.startup.Catalina.start(Catalina.java:595)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n        at java.lang.reflect.Method.invoke(Method.java:606)\n        at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:289)\n        at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414)\n\nNov 06, 2013 1:30:39 PM org.apache.catalina.core.StandardService start\nSEVERE: Failed to start connector [Connector[HTTP/1.1-8444]]\nLifecycleException:  service.getName(): \"Catalina\";  Protocol handler start failed: java.lang.Exception: Socket bind failed: [226] Adresse bereits im Zugriff\n        at org.apache.catalina.connector.Connector.start(Connector.java:1203)\n        at org.apache.catalina.core.StandardService.start(StandardService.java:540)\n        at org.apache.catalina.core.StandardServer.start(StandardServer.java:754)\n        at org.apache.catalina.startup.Catalina.start(Catalina.java:595)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n        at java.lang.reflect.Method.invoke(Method.java:606)\n        at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:289)\n        at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414)\n\nThis is of course not correct. The port IS availble but the SSL engine has been turned off.\n\nThere should be a check at stratup which says that this is an illegal state.','2013-11-06 12:32:17','Michael Osipov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 normal','014cf1c','Mark Emlyn David Thomas','2013-11-10 15:20:37','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55749 Improve error message when SSLEngine is disabled in AprLifecycleListener and SSL is configured for an APR/native connector.','java/org/apache/tomcat/util/net/AprEndpoint.java\njava/org/apache/tomcat/util/net/res/LocalStrings.properties'),(62,55746,'Bug 55746 – Add documentation for AllRolesMode for CombinedRealm','','2013-11-06 06:59:41','Cédric Couralet','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 minor','63b97cb','Mark Emlyn David Thomas','2013-11-09 14:31:32','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55746 Add documentation for AllRolesMode for CombinedRealm Patch by Cédric Couralet','webapps/docs/config/realm.xml'),(63,55383,'Bug 55383 – Improve markup and design of Tomcat\'s HTML pages','','2013-08-07 20:54:30','Konstantin Preißer','Tomcat Developers Mailing List','NEW','Tomcat 8','Documentation','P2 enhancement','71b9921','Konstantin Preißer','2013-11-08 10:33:07','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55383 Follow-Up to r1540077: Improve HTML markup in the examples.','webapps/examples/jsp/jsp2/jspx/basic.html'),(64,55383,'Bug 55383 – Improve markup and design of Tomcat\'s HTML pages','','2013-08-07 20:54:30','Konstantin Preißer','Tomcat Developers Mailing List','NEW','Tomcat 8','Documentation','P2 enhancement','5b84630','Konstantin Preißer','2013-11-08 10:28:42','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55383 Improve HTML markup in the examples.','webapps/examples/jsp/jsp2/jspx/svgexample.html\nwebapps/examples/jsp/jsp2/jspx/textRotate.html\nwebapps/examples/jsp/jsp2/jspx/textRotate.jspx'),(65,55383,'Bug 55383 – Improve markup and design of Tomcat\'s HTML pages','','2013-08-07 20:54:30','Konstantin Preißer','Tomcat Developers Mailing List','NEW','Tomcat 8','Documentation','P2 enhancement','87f60e0','Konstantin Preißer','2013-11-08 10:15:38','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55383 Improve markup of XHTML Basic JSPX example: - Since it is intented to be XHTML, change it to actually output XHTML instead of malformed HTML. - Simplify by moving the DOCTYPE declaration into the file itself (Note that my understanding is that HTML5 obsoletes XHTML 1.x DOCTYPES so the DOCTYPE probably can be removed - I don\'t know if there is actually software that interpretes XHTML documents which are limited to an XHTML 1.1 Basic scheme).','webapps/examples/WEB-INF/tags/xhtmlbasic.tag\nwebapps/examples/jsp/jsp2/jspx/basic.jspx'),(66,55759,'Bug 55759 – Update to ECJ 4.3.1','','2013-11-08 08:50:08','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 enhancement','905e126','Konstantin Kolinko','2013-11-08 04:00:02','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55759 Update Eclipse JDT Core Batch Compiler (ecj.jar) from 4.2.2 to 4.3.1.','build.properties.default\nres/ide-support/eclipse/eclipse.classpath\nres/ide-support/netbeans/nb-tomcat-build.properties\nres/ide-support/netbeans/project.xml\nres/maven/tomcat-embed-jasper.pom\nres/maven/tomcat-jasper.pom'),(67,55735,'Bug 55735 – Additional quote entity in html element attribute evaluated in tagx if attribute contains EL expression','','2013-11-02 06:14:56','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','7ee1275','Mark Emlyn David Thomas','2013-11-05 17:46:35','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55735 This fixes a regression caused by the fix to https://issues.apache.org/bugzilla/show_bug.cgi?id=55198 When processing JSP documents, attributes in UninterpretedTag nodes that contain EL should have the the non-EL components XML escaped and the output of the EL components should not be escaped.','java/org/apache/jasper/compiler/Validator.java\njava/org/apache/jasper/runtime/PageContextImpl.java\ntest/org/apache/jasper/compiler/TestParser.java\ntest/org/apache/jasper/compiler/TesterValidator.java\ntest/org/apache/jasper/runtime/TesterPageContextImpl.java\ntest/webapp/WEB-INF/tags/bug55198.tagx\ntest/webapp/bug5nnnn/bug55198.jsp'),(68,55198,'Bug 55198 – Quote entity in html element attribute evaluated in tagx if attribute contains EL expression','','2013-07-05 04:32:38','Evan Greensmith','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','7ee1275','Mark Emlyn David Thomas','2013-11-05 17:46:35','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55735 This fixes a regression caused by the fix to https://issues.apache.org/bugzilla/show_bug.cgi?id=55198 When processing JSP documents, attributes in UninterpretedTag nodes that contain EL should have the the non-EL components XML escaped and the output of the EL components should not be escaped.','java/org/apache/jasper/compiler/Validator.java\njava/org/apache/jasper/runtime/PageContextImpl.java\ntest/org/apache/jasper/compiler/TestParser.java\ntest/org/apache/jasper/compiler/TesterValidator.java\ntest/org/apache/jasper/runtime/TesterPageContextImpl.java\ntest/webapp/WEB-INF/tags/bug55198.tagx\ntest/webapp/bug5nnnn/bug55198.jsp'),(69,52323,'Bug 52323 – Cobertura test code coverage support for build.xml and build.properties.default','','2011-12-13 13:57:56','Violeta Georgieva','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Packaging','P2 enhancement','fa7ac5d','Konstantin Kolinko','2013-11-04 18:07:04','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52323 Do not download Cobertura, unless it has been enabled.','build.xml'),(70,52323,'Bug 52323 – Cobertura test code coverage support for build.xml and build.properties.default','','2011-12-13 13:57:56','Violeta Georgieva','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Packaging','P2 enhancement','1705779','Mark Emlyn David Thomas','2013-11-04 04:08:20','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52323 Add support for code coverage with Cobertura (disabled by default) when running the unit tests','build.properties.default\nbuild.xml'),(71,55715,'Bug 55715 – RemoteEndpoint.Async#sendText(String, SendHandler) can cause StackOverflowErrors and contradicts Oracle\'s JavaDoc','','2013-10-28 15:34:56','Konstantin Preißer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','WebSocket','P2 normal','3f316f1','Mark Emlyn David Thomas','2013-10-30 07:20:08','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55715 Add a per web application executor to the WebSocket implementation and use it for calling SendHandler.onResult() when there is a chance that the current thread also initiated the write','java/org/apache/tomcat/websocket/server/Constants.java\njava/org/apache/tomcat/websocket/server/WsContextListener.java\njava/org/apache/tomcat/websocket/server/WsHttpUpgradeHandler.java\njava/org/apache/tomcat/websocket/server/WsRemoteEndpointImplServer.java\njava/org/apache/tomcat/websocket/server/WsServerContainer.java\njava/org/apache/tomcat/websocket/server/WsWriteTimeout.java\nwebapps/docs/web-socket-howto.xml'),(72,55703,'Bug 55703 – Error in the JNDI Generic JavaBean Resources documentation','','2013-10-25 11:50:00','Giulio Quaresima','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 normal','f690e3d','Mark Emlyn David Thomas','2013-10-29 10:32:30','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55703 Clarify role of singleton attribute for JNDI factories','webapps/docs/jndi-resources-howto.xml'),(73,55702,'Bug 55702 – TLD cannot be loaded if CATALINA_HOME contains spaces','A web application containing an own TLD within its WEB-INF directory fails to render a JSP page referencing that TLD if Tomcat it installed into a directory with spaces in the path, such as \"C:\\Program Files\\...\". \nAfter moving the entire Tomcat installation directory to a path without spaces (such as \"C:\\1\\Tomcat8\"), the application can render that same JSP page.\n\nFollowing stacktrace is printed. Note the %20 in the file path\n\norg.apache.jasper.JasperException: /jsp/layouts/standard.jsp (line: 7, column: 69) File \"file:/C:/Program%20Files/Apache/Tomcat-8.0.0-RC5/webapps/mywebapp/WEB-INF/tlds/mywebapp-tags.tld\" not found\n	org.apache.jasper.compiler.DefaultErrorHandler.jspError(DefaultErrorHandler.java:42)\n	org.apache.jasper.compiler.ErrorDispatcher.dispatch(ErrorDispatcher.java:276)\n	org.apache.jasper.compiler.ErrorDispatcher.jspError(ErrorDispatcher.java:92)\n	org.apache.jasper.compiler.TagLibraryInfoImpl.<init>(TagLibraryInfoImpl.java:166)\n	org.apache.jasper.compiler.Parser.parseTaglibDirective(Parser.java:410)\n	org.apache.jasper.compiler.Parser.parseDirective(Parser.java:476)\n	org.apache.jasper.compiler.Parser.parseElements(Parser.java:1451)\n	org.apache.jasper.compiler.Parser.parse(Parser.java:138)\n	org.apache.jasper.compiler.ParserController.doParse(ParserController.java:242)\n	org.apache.jasper.compiler.ParserController.parse(ParserController.java:102)\n	org.apache.jasper.compiler.Compiler.generateJava(Compiler.java:198)\n	org.apache.jasper.compiler.Compiler.compile(Compiler.java:373)\n	org.apache.jasper.compiler.Compiler.compile(Compiler.java:353)\n	org.apache.jasper.compiler.Compiler.compile(Compiler.java:340)\n	org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:606)\n	org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:357)\n	org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:403)\n	org.apache.jasper.servlet.JspServlet.service(JspServlet.java:347)\n	javax.servlet.http.HttpServlet.service(HttpServlet.java:728)\n\n\nJava version used: Oracle JDK 7 Update 45 (64 Bit)\nActive Tomcat connector: [\"http-nio-8080\"]','2013-10-25 10:03:35','Steffen Ryll','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Jasper','P2 regression','ad50e54','Mark Emlyn David Thomas','2013-10-29 09:00:00','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55702 Fix loading of TLD when CATALINA_HOME contains spaces','java/org/apache/jasper/compiler/TagLibraryInfoImpl.java'),(74,55684,'Bug 55684 – WebappClassLoader.getThread want an access to root ThreadGroup','Tomcat may not have all permissions granted.\nThe method WebappClassLoader.getThread try to access the root ThreadGroup in order to list all threads.\nYou should either manage SecurityException or avoid to access the parent ThreadGroup of the thread which start Tomcat.','2013-10-21 16:30:04','Gael Lalire','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','d244284','Mark Emlyn David Thomas','2013-10-29 05:53:27','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55684 Log a warning but continue if the memory leak detection code is unable to access all threads.','java/org/apache/catalina/loader/LocalStrings.properties\njava/org/apache/catalina/loader/WebappClassLoader.java'),(75,55691,'Bug 55691 – javax.el.ArrayELResolver.setValue not supporting arrays of primitives','was working in tomcat 6.0.20\n\nERROR javax.faces.context.ExceptionHandlerWrapper - javax.faces.component.UpdateModelException: java.lang.ClassCastException: Unable to add an object of type [java.lang.Integer] to an array of objects of type [int]\njava.lang.ClassCastException: Unable to add an object of type [java.lang.Integer] to an array of objects of type [int]\n	at javax.el.ArrayELResolver.setValue(ArrayELResolver.java:94)\n	at com.sun.faces.el.DemuxCompositeELResolver._setValue(DemuxCompositeELResolver.java:255)\n	at com.sun.faces.el.DemuxCompositeELResolver.setValue(DemuxCompositeELResolver.java:281)\n	at org.apache.el.parser.AstValue.setValue(AstValue.java:158)\n	at org.apache.el.ValueExpressionImpl.setValue(ValueExpressionImpl.java:249)\n	at com.sun.faces.facelets.el.TagValueExpression.setValue(TagValueExpression.java:131)\n	at javax.faces.component.UIInput.updateModel(UIInput.java:818)\n	at javax.faces.component.UIInput.processUpdates(UIInput.java:735)\n	at javax.faces.component.UIData.iterate(UIData.java:2001)\n	at javax.faces.component.UIData.processUpdates(UIData.java:1253)\n	at javax.faces.component.UIComponentBase.processUpdates(UIComponentBase.java:1242)\n	at javax.faces.component.UIForm.processUpdates(UIForm.java:281)\n	at javax.faces.component.UIComponentBase.processUpdates(UIComponentBase.java:1242)\n	at javax.faces.component.UIComponentBase.processUpdates(UIComponentBase.java:1242)\n	at javax.faces.component.UIViewRoot.processUpdates(UIViewRoot.java:1231)\n	at com.sun.faces.lifecycle.UpdateModelValuesPhase.execute(UpdateModelValuesPhase.java:78)\n	at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)\n	at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)\n	at javax.faces.webapp.FacesServlet.service(FacesServlet.java:593)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)','2013-10-22 23:05:42','taly','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Servlet & JSP API','P2 normal','b82c0c6','Mark Emlyn David Thomas','2013-10-28 16:59:41','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55691 ArrayELResolver needs to handle the case where the base object is an array of primitives.','java/javax/el/ArrayELResolver.java\njava/javax/el/Util.java\ntest/javax/el/TestArrayELResolver.java'),(76,55681,'Bug 55681 – JSR-356 message handling: NULL pointer being thrown when DecodeException is caught in PojoMessageHandlerWholeBase<T>.onMessage','I am testing what happens when Encode/Decode Exceptions occur during JSR-356 communication.  In our case, we do NOT use annotation, but we \"extend Endpoint\" and \"implement Whole<ThingworxMessage>\".  I was forcing a DecodeException to occur - expecting to my onError to be called with the actual DecodeException.  Instead, I got a Null.  \n\nStepping the following code in Tomcat:\n\nin onMessage, the ((WsSession)session) is NULL.  As a result, the actual DecodeException (cause) is lost.\n\n       // Can this message be decoded?\n        Object payload;\n        try {\n            payload = decode(message);\n        } catch (DecodeException de) {\n            ((WsSession) session).getLocal().onError(session, de);\n            return;\n        }\n\n\nTracing this further up the stack, I found that Util.getMessageHandlers is initializing it and passing NULL in for the session:\n\n            if (decoderMatch.getTextDecoders().size() > 0) {\n                MessageHandlerResult result = new MessageHandlerResult(\n                        new PojoMessageHandlerWholeText(listener, m, null,\n                                endpointConfig,\n                                decoderMatch.getTextDecoders(), new Object[1],\n                                0, false, -1, -1),\n                        MessageHandlerResultType.TEXT);\n                results.add(result);\n            }\n\nPlease let me know if I can provide any more details.\n\n-bob','2013-10-20 17:37:21','Bob DeRemer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 normal','514cefb','Mark Emlyn David Thomas','2013-10-20 17:03:52','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55681 Pass the session to the Pojo MessageHandler wrappers so it is passed in to the MessageHandler method calls.','java/org/apache/tomcat/websocket/Util.java\njava/org/apache/tomcat/websocket/WsSession.java'),(77,55664,'Bug 55664 – [websocket] NPE in Util$DecoderMatch during application start','','2013-10-17 19:01:26','Niki Dokovski','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','4e4a24a','Mark Emlyn David Thomas','2013-10-18 03:40:00','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55664 Correctly handle Encoder, Decoder and MessageHandler implementations that use a generic type such as Encoder.Text<List<String>>','java/org/apache/tomcat/websocket/Util.java\ntest/org/apache/tomcat/websocket/TestUtil.java\ntest/org/apache/tomcat/websocket/pojo/TestEncodingDecoding.java'),(78,55663,'Bug 55663 – Incorrect text in NOTICE file','','2013-10-17 16:52:22','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 major','f1f9c5a','Violeta Georgieva Georgieva','2013-10-17 22:23:14','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55663 Notice files are corrected according to http://www.apache.org/legal/src-headers.html#notice','NOTICE\nres/META-INF/default.notice\nres/META-INF/servlet-api.jar.notice'),(79,55656,'Bug 55656 – Server ClassLoader not used for Server creation','','2013-10-16 09:56:54','Roberto Benedetti','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','86ec1f4','Mark Emlyn David Thomas','2013-10-17 11:26:13','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55656 Configure the Digester to use the server class loader when parsing server.xml rather than the class loader that loaded StandardServer. Patch provided by Roberto Benedetti.','java/org/apache/catalina/startup/Catalina.java'),(80,55620,'Bug 55620 – When using startup.bat if apache-tomcat-7.0.xx is in directory with \",\" (comma) or \";\" (semi-colon) Tomcat fails to start','When using startup.bat if apache-tomcat-7.0.xx is in directory with \",\" (comma) or \";\" (semi-colon) Tomcat fails to start correctly\n\nExample:\n\nC:\\Users\\username\\Desktop\\Some Parent\\Another parent with, a comma\\apache-tomcat-7.0.42\\\n\ncd \"C:\\Users\\username\\Desktop\\Some Parent\\Another parent with, a comma\\apache-tomcat-7.0.42\"\n\ncd bin\n\nset java_home=c:\\Program Files\\java\\jre7\n\nstartup.bat\n\n\nYou get the catalina log attached at the end.\n\nIf there is a semi-colon then you get no log at all.\n\n\nMost likely the Windows batch scripts for startup need to better handle escaping directory paths.  The error isn\'t clear as to the cause.  A work-around is to move the apache-tomcat-7.0.xx to a full pathname with NO commas or semi-colons.\n\n\n\ncatalina log:\n\nOct 02, 2013 11:34:31 AM org.apache.catalina.startup.ClassLoaderFactory validateFile\nWARNING: Problem with directory [C:\\Users\\username\\Desktop\\Some Parent\\Another parent with], exists: [false], isDirectory: [false], canRead: [false]\nOct 02, 2013 11:34:31 AM org.apache.catalina.startup.ClassLoaderFactory validateFile\nWARNING: Problem with directory [C:\\Users\\username\\Desktop\\Some Parent\\Another parent with, a comma\\apache-tomcat-7.0.42\\bin\\a comma\\apache-tomcat-7.0.42\\lib], exists: [false], isDirectory: [false], canRead: [false]\nOct 02, 2013 11:34:31 AM org.apache.catalina.startup.ClassLoaderFactory validateFile\nWARNING: Problem with directory [C:\\Users\\username\\Desktop\\Some Parent\\Another parent with], exists: [false], isDirectory: [false], canRead: [false]\nOct 02, 2013 11:34:31 AM org.apache.catalina.startup.ClassLoaderFactory validateFile\nWARNING: Problem with directory [C:\\Users\\username\\Desktop\\Some Parent\\Another parent with, a comma\\apache-tomcat-7.0.42\\bin\\a comma\\apache-tomcat-7.0.42\\lib], exists: [false], isDirectory: [false], canRead: [false]\nOct 02, 2013 11:34:31 AM org.apache.catalina.startup.ClassLoaderFactory validateFile\nWARNING: Problem with directory [C:\\Users\\username\\Desktop\\Some Parent\\Another parent with], exists: [false], isDirectory: [false], canRead: [false]\nOct 02, 2013 11:34:31 AM org.apache.catalina.startup.ClassLoaderFactory validateFile\nWARNING: Problem with directory [C:\\Users\\username\\Desktop\\Some Parent\\Another parent with, a comma\\apache-tomcat-7.0.42\\bin\\a comma\\apache-tomcat-7.0.42\\lib], exists: [false], isDirectory: [false], canRead: [false]\nOct 02, 2013 11:34:31 AM org.apache.catalina.startup.ClassLoaderFactory validateFile\nWARNING: Problem with directory [C:\\Users\\username\\Desktop\\Some Parent\\Another parent with], exists: [false], isDirectory: [false], canRead: [false]\nOct 02, 2013 11:34:31 AM org.apache.catalina.startup.ClassLoaderFactory validateFile\nWARNING: Problem with directory [C:\\Users\\username\\Desktop\\Some Parent\\Another parent with, a comma\\apache-tomcat-7.0.42\\bin\\a comma\\apache-tomcat-7.0.42\\lib], exists: [false], isDirectory: [false], canRead: [false]','2013-10-02 16:36:43','Rodney Beede','Tomcat Developers Mailing List','RESOLVED WONTFIX','Tomcat 8','Catalina','P2 minor','5e12dde','Konstantin Kolinko','2013-10-13 08:15:10','For https://issues.apache.org/bugzilla/show_bug.cgi?id=55620 Correct a copy-paste typo in r1530890','bin/catalina.bat'),(81,55639,'Bug 55639 – Add Drawboard Websocket Example','','2013-10-07 23:16:40','Konstantin Preißer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Examples','P2 enhancement','3155830','Konstantin Preißer','2013-10-11 09:29:47','Remove changelog entry for https://issues.apache.org/bugzilla/show_bug.cgi?id=55639 as it is now backported to 7.0.x.','webapps/docs/changelog.xml'),(82,54095,'Bug 54095 – [patch] support gzipped versions of static resources by DefaultServlet','','2012-11-03 20:49:45','Philippe Marschall','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 enhancement','f0101d0','Mark Emlyn David Thomas','2013-10-10 17:24:59','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54095 Add support to the Default Servlet for serving gzipped versions of static resources directly from disk as an alternative to Tomcat compressing them on each request. Patch by Philippe Marschall.','conf/web.xml\njava/org/apache/catalina/servlets/DefaultServlet.java\ntest/org/apache/catalina/servlets/TestDefaultServlet.java\ntest/webapp/index.html.gz\nwebapps/docs/changelog.xml\nwebapps/docs/default-servlet.xml'),(83,55251,'Bug 55251 – JspC fails silently if directory for generated web.xml does not exist','If the file specified for webXml (via call to setWebXml) cannot be created (for example if the directory does not exist), then JspC fails silently.','2013-07-12 03:50:46','Jeremy Boynes','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Jasper','P2 normal','06d8338','Mark Emlyn David Thomas','2013-10-10 09:38:20','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55251 Do not allow JspC task to fail silently if the web.xml or web.xml fragment can not be generated.','java/org/apache/jasper/JspC.java\nwebapps/docs/changelog.xml'),(84,55620,'Bug 55620 – When using startup.bat if apache-tomcat-7.0.xx is in directory with \",\" (comma) or \";\" (semi-colon) Tomcat fails to start','When using startup.bat if apache-tomcat-7.0.xx is in directory with \",\" (comma) or \";\" (semi-colon) Tomcat fails to start correctly\n\nExample:\n\nC:\\Users\\username\\Desktop\\Some Parent\\Another parent with, a comma\\apache-tomcat-7.0.42\\\n\ncd \"C:\\Users\\username\\Desktop\\Some Parent\\Another parent with, a comma\\apache-tomcat-7.0.42\"\n\ncd bin\n\nset java_home=c:\\Program Files\\java\\jre7\n\nstartup.bat\n\n\nYou get the catalina log attached at the end.\n\nIf there is a semi-colon then you get no log at all.\n\n\nMost likely the Windows batch scripts for startup need to better handle escaping directory paths.  The error isn\'t clear as to the cause.  A work-around is to move the apache-tomcat-7.0.xx to a full pathname with NO commas or semi-colons.\n\n\n\ncatalina log:\n\nOct 02, 2013 11:34:31 AM org.apache.catalina.startup.ClassLoaderFactory validateFile\nWARNING: Problem with directory [C:\\Users\\username\\Desktop\\Some Parent\\Another parent with], exists: [false], isDirectory: [false], canRead: [false]\nOct 02, 2013 11:34:31 AM org.apache.catalina.startup.ClassLoaderFactory validateFile\nWARNING: Problem with directory [C:\\Users\\username\\Desktop\\Some Parent\\Another parent with, a comma\\apache-tomcat-7.0.42\\bin\\a comma\\apache-tomcat-7.0.42\\lib], exists: [false], isDirectory: [false], canRead: [false]\nOct 02, 2013 11:34:31 AM org.apache.catalina.startup.ClassLoaderFactory validateFile\nWARNING: Problem with directory [C:\\Users\\username\\Desktop\\Some Parent\\Another parent with], exists: [false], isDirectory: [false], canRead: [false]\nOct 02, 2013 11:34:31 AM org.apache.catalina.startup.ClassLoaderFactory validateFile\nWARNING: Problem with directory [C:\\Users\\username\\Desktop\\Some Parent\\Another parent with, a comma\\apache-tomcat-7.0.42\\bin\\a comma\\apache-tomcat-7.0.42\\lib], exists: [false], isDirectory: [false], canRead: [false]\nOct 02, 2013 11:34:31 AM org.apache.catalina.startup.ClassLoaderFactory validateFile\nWARNING: Problem with directory [C:\\Users\\username\\Desktop\\Some Parent\\Another parent with], exists: [false], isDirectory: [false], canRead: [false]\nOct 02, 2013 11:34:31 AM org.apache.catalina.startup.ClassLoaderFactory validateFile\nWARNING: Problem with directory [C:\\Users\\username\\Desktop\\Some Parent\\Another parent with, a comma\\apache-tomcat-7.0.42\\bin\\a comma\\apache-tomcat-7.0.42\\lib], exists: [false], isDirectory: [false], canRead: [false]\nOct 02, 2013 11:34:31 AM org.apache.catalina.startup.ClassLoaderFactory validateFile\nWARNING: Problem with directory [C:\\Users\\username\\Desktop\\Some Parent\\Another parent with], exists: [false], isDirectory: [false], canRead: [false]\nOct 02, 2013 11:34:31 AM org.apache.catalina.startup.ClassLoaderFactory validateFile\nWARNING: Problem with directory [C:\\Users\\username\\Desktop\\Some Parent\\Another parent with, a comma\\apache-tomcat-7.0.42\\bin\\a comma\\apache-tomcat-7.0.42\\lib], exists: [false], isDirectory: [false], canRead: [false]','2013-10-02 16:36:43','Rodney Beede','Tomcat Developers Mailing List','RESOLVED WONTFIX','Tomcat 8','Catalina','P2 minor','d88ad9e','Mark Emlyn David Thomas','2013-10-10 07:04:41','Partial fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=55620 Prevent Tomcat from starting on Linux when CATALINA_HOME or CATALINA_BASE contains a colon','bin/catalina.sh'),(85,55620,'Bug 55620 – When using startup.bat if apache-tomcat-7.0.xx is in directory with \",\" (comma) or \";\" (semi-colon) Tomcat fails to start','When using startup.bat if apache-tomcat-7.0.xx is in directory with \",\" (comma) or \";\" (semi-colon) Tomcat fails to start correctly\n\nExample:\n\nC:\\Users\\username\\Desktop\\Some Parent\\Another parent with, a comma\\apache-tomcat-7.0.42\\\n\ncd \"C:\\Users\\username\\Desktop\\Some Parent\\Another parent with, a comma\\apache-tomcat-7.0.42\"\n\ncd bin\n\nset java_home=c:\\Program Files\\java\\jre7\n\nstartup.bat\n\n\nYou get the catalina log attached at the end.\n\nIf there is a semi-colon then you get no log at all.\n\n\nMost likely the Windows batch scripts for startup need to better handle escaping directory paths.  The error isn\'t clear as to the cause.  A work-around is to move the apache-tomcat-7.0.xx to a full pathname with NO commas or semi-colons.\n\n\n\ncatalina log:\n\nOct 02, 2013 11:34:31 AM org.apache.catalina.startup.ClassLoaderFactory validateFile\nWARNING: Problem with directory [C:\\Users\\username\\Desktop\\Some Parent\\Another parent with], exists: [false], isDirectory: [false], canRead: [false]\nOct 02, 2013 11:34:31 AM org.apache.catalina.startup.ClassLoaderFactory validateFile\nWARNING: Problem with directory [C:\\Users\\username\\Desktop\\Some Parent\\Another parent with, a comma\\apache-tomcat-7.0.42\\bin\\a comma\\apache-tomcat-7.0.42\\lib], exists: [false], isDirectory: [false], canRead: [false]\nOct 02, 2013 11:34:31 AM org.apache.catalina.startup.ClassLoaderFactory validateFile\nWARNING: Problem with directory [C:\\Users\\username\\Desktop\\Some Parent\\Another parent with], exists: [false], isDirectory: [false], canRead: [false]\nOct 02, 2013 11:34:31 AM org.apache.catalina.startup.ClassLoaderFactory validateFile\nWARNING: Problem with directory [C:\\Users\\username\\Desktop\\Some Parent\\Another parent with, a comma\\apache-tomcat-7.0.42\\bin\\a comma\\apache-tomcat-7.0.42\\lib], exists: [false], isDirectory: [false], canRead: [false]\nOct 02, 2013 11:34:31 AM org.apache.catalina.startup.ClassLoaderFactory validateFile\nWARNING: Problem with directory [C:\\Users\\username\\Desktop\\Some Parent\\Another parent with], exists: [false], isDirectory: [false], canRead: [false]\nOct 02, 2013 11:34:31 AM org.apache.catalina.startup.ClassLoaderFactory validateFile\nWARNING: Problem with directory [C:\\Users\\username\\Desktop\\Some Parent\\Another parent with, a comma\\apache-tomcat-7.0.42\\bin\\a comma\\apache-tomcat-7.0.42\\lib], exists: [false], isDirectory: [false], canRead: [false]\nOct 02, 2013 11:34:31 AM org.apache.catalina.startup.ClassLoaderFactory validateFile\nWARNING: Problem with directory [C:\\Users\\username\\Desktop\\Some Parent\\Another parent with], exists: [false], isDirectory: [false], canRead: [false]\nOct 02, 2013 11:34:31 AM org.apache.catalina.startup.ClassLoaderFactory validateFile\nWARNING: Problem with directory [C:\\Users\\username\\Desktop\\Some Parent\\Another parent with, a comma\\apache-tomcat-7.0.42\\bin\\a comma\\apache-tomcat-7.0.42\\lib], exists: [false], isDirectory: [false], canRead: [false]','2013-10-02 16:36:43','Rodney Beede','Tomcat Developers Mailing List','RESOLVED WONTFIX','Tomcat 8','Catalina','P2 minor','d4bc19e','Mark Emlyn David Thomas','2013-10-10 05:17:24','Partial fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=55620 Prevent Tomcat from starting on Windows when CATALINA_HOME contains a ; character','bin/catalina.bat'),(86,55642,'Bug 55642 – TagPluginManager isConstantAttribute broken','Function isConstantAttribute in TagPluginManager seems to be be broken.\nFor value \"order.status\" it returns false. And for value \"${order.state.name}\" it returns true. According to javadoc it should be exact opposite.\n\nProblem seems to be in Node.isLiteral function. \"el!= null\" should probably be \"el== null\" But this function is being used elsewhere.\n\n\n/**\n* @return true if the attribute is specified and its value is a\n*         translation-time constant.\n*/\npublic boolean TagPluginManager.isConstantAttribute(String attribute){\n    Node.JspAttribute attr = getNodeAttribute(attribute);\n    if (attr == null)\n        return false;\n    return attr.isLiteral();\n}\n/**\n* @return true if the value is a string literal known at translation\n*         time.\n*/\npublic boolean isLiteral() {\n    return !expression && (el != null) && !namedAttribute;\n}','2013-10-09 13:02:21','Pavel Cibulka','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','af49b44','Mark Emlyn David Thomas','2013-10-09 10:33:39','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55642 Correct logic error in Node.isLiteral() that was returning the inverse of the desired result when the value was an EL expression.','java/org/apache/jasper/compiler/Node.java\ntest/org/apache/jasper/compiler/TestNode.java\ntest/webapp/bug5nnnn/bug55642a.jsp\ntest/webapp/bug5nnnn/bug55642b.jsp'),(87,55638,'Bug 55638 – [websocket] Tomcat corrupts binary websocket messages when using the NIO connector','','2013-10-07 16:36:31','Konstantin Preißer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','WebSocket','P2 normal','49a9bde','Mark Emlyn David Thomas','2013-10-08 17:03:15','Fix infinite loop issue triggered by the test case for BZ 55638','java/org/apache/tomcat/websocket/WsFrameBase.java'),(88,55638,'Bug 55638 – [websocket] Tomcat corrupts binary websocket messages when using the NIO connector','','2013-10-07 16:36:31','Konstantin Preißer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','WebSocket','P2 normal','d742770','Mark Emlyn David Thomas','2013-10-08 15:18:04','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55638 Fix the corruption of large WebSocket messages when using the NIO connector.','java/org/apache/coyote/http11/upgrade/NioServletOutputStream.java'),(89,55639,'Bug 55639 – Add Drawboard Websocket Example','','2013-10-07 23:16:40','Konstantin Preißer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Examples','P2 enhancement','c619ef4','Konstantin Preißer','2013-10-08 10:41:32','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55639 Add a Drawboard WebSocket example.','webapps/docs/changelog.xml\nwebapps/examples/WEB-INF/classes/websocket/drawboard/Client.java\nwebapps/examples/WEB-INF/classes/websocket/drawboard/DrawMessage.java\nwebapps/examples/WEB-INF/classes/websocket/drawboard/DrawboardEndpoint.java\nwebapps/examples/WEB-INF/classes/websocket/drawboard/Room.java\nwebapps/examples/WEB-INF/classes/websocket/drawboard/WsConfigListener.java\nwebapps/examples/WEB-INF/classes/websocket/drawboard/wsmessages/AbstractWebsocketMessage.java\nwebapps/examples/WEB-INF/classes/websocket/drawboard/wsmessages/BinaryWebsocketMessage.java\nwebapps/examples/WEB-INF/classes/websocket/drawboard/wsmessages/StringWebsocketMessage.java\nwebapps/examples/websocket/drawboard.xhtml\nwebapps/examples/websocket/index.xhtml'),(90,55633,'Bug 55633 – [websocket] Tomcat can\'t read data from the client after the client temporarily pauses','','2013-10-06 01:41:23','Konstantin Preißer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','WebSocket','P2 normal','9caedee','Mark Emlyn David Thomas','2013-10-07 17:44:09','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55633 for APR. If the socket was registered for read and write and only one occurred, the registration for the other event was lost. Ensure that the socket is re-registered with the Poller when necessary.','java/org/apache/tomcat/util/net/AprEndpoint.java'),(91,55633,'Bug 55633 – [websocket] Tomcat can\'t read data from the client after the client temporarily pauses','','2013-10-06 01:41:23','Konstantin Preißer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','WebSocket','P2 normal','8282b57','Mark Emlyn David Thomas','2013-10-07 16:44:04','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55633 for NIO. The Comet code that ensured that multiple threads didn\'t process the same socket when the selector indicated that a socket was ready for read and write pre-dated r1001698 where syncs where added to the SocketProcessor to achieve the same aim for Servlet 3.0 asyncs processing. The Comet code was re-used to handle upgraded connections. The upgrade code did not handle the case where a socket was registered for read and write but only a write event occurred. In this case the read registration was lost. This is the root cause of the lack of responsiveness observed in bug 55633. With the changes in r1001698, a simpler solution can be used for both Comet and HTTP upgrade. The new approach unregisters the socket operations the selector has reported ready for and then triggers a read and/or write as appropriate. For Comet the syncs will ensure that read and write aren\'t processed in parallel. For HTTP upgrade such parallel processing is permitted.','java/org/apache/tomcat/util/net/NioEndpoint.java'),(92,55633,'Bug 55633 – [websocket] Tomcat can\'t read data from the client after the client temporarily pauses','','2013-10-06 01:41:23','Konstantin Preißer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','WebSocket','P2 normal','8282b57','Mark Emlyn David Thomas','2013-10-07 16:44:04','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55633 for NIO. The Comet code that ensured that multiple threads didn\'t process the same socket when the selector indicated that a socket was ready for read and write pre-dated r1001698 where syncs where added to the SocketProcessor to achieve the same aim for Servlet 3.0 asyncs processing. The Comet code was re-used to handle upgraded connections. The upgrade code did not handle the case where a socket was registered for read and write but only a write event occurred. In this case the read registration was lost. This is the root cause of the lack of responsiveness observed in bug 55633. With the changes in r1001698, a simpler solution can be used for both Comet and HTTP upgrade. The new approach unregisters the socket operations the selector has reported ready for and then triggers a read and/or write as appropriate. For Comet the syncs will ensure that read and write aren\'t processed in parallel. For HTTP upgrade such parallel processing is permitted.','java/org/apache/tomcat/util/net/NioEndpoint.java'),(93,55630,'Bug 55630 – clean way to avoid setURLStreamHandlerFactory call','A current method is to set WebappLoader.first via reflection (because private).\n\nI think the setURLStreamHandlerFactory should be move to Catalina.start (\'first\' static field can be move in Catalina).\nSo we could have a static method in Catalina to prevent setURLStreamHandlerFactory call while first starting.','2013-10-05 16:51:34','Gael Lalire','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','bd56eea','Mark Emlyn David Thomas','2013-10-07 14:49:56','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55630 Provide a way to disable the custom URLStreamHandlerFactory','java/org/apache/catalina/webresources/TomcatURLStreamHandlerFactory.java'),(94,55620,'Bug 55620 – When using startup.bat if apache-tomcat-7.0.xx is in directory with \",\" (comma) or \";\" (semi-colon) Tomcat fails to start','When using startup.bat if apache-tomcat-7.0.xx is in directory with \",\" (comma) or \";\" (semi-colon) Tomcat fails to start correctly\n\nExample:\n\nC:\\Users\\username\\Desktop\\Some Parent\\Another parent with, a comma\\apache-tomcat-7.0.42\\\n\ncd \"C:\\Users\\username\\Desktop\\Some Parent\\Another parent with, a comma\\apache-tomcat-7.0.42\"\n\ncd bin\n\nset java_home=c:\\Program Files\\java\\jre7\n\nstartup.bat\n\n\nYou get the catalina log attached at the end.\n\nIf there is a semi-colon then you get no log at all.\n\n\nMost likely the Windows batch scripts for startup need to better handle escaping directory paths.  The error isn\'t clear as to the cause.  A work-around is to move the apache-tomcat-7.0.xx to a full pathname with NO commas or semi-colons.\n\n\n\ncatalina log:\n\nOct 02, 2013 11:34:31 AM org.apache.catalina.startup.ClassLoaderFactory validateFile\nWARNING: Problem with directory [C:\\Users\\username\\Desktop\\Some Parent\\Another parent with], exists: [false], isDirectory: [false], canRead: [false]\nOct 02, 2013 11:34:31 AM org.apache.catalina.startup.ClassLoaderFactory validateFile\nWARNING: Problem with directory [C:\\Users\\username\\Desktop\\Some Parent\\Another parent with, a comma\\apache-tomcat-7.0.42\\bin\\a comma\\apache-tomcat-7.0.42\\lib], exists: [false], isDirectory: [false], canRead: [false]\nOct 02, 2013 11:34:31 AM org.apache.catalina.startup.ClassLoaderFactory validateFile\nWARNING: Problem with directory [C:\\Users\\username\\Desktop\\Some Parent\\Another parent with], exists: [false], isDirectory: [false], canRead: [false]\nOct 02, 2013 11:34:31 AM org.apache.catalina.startup.ClassLoaderFactory validateFile\nWARNING: Problem with directory [C:\\Users\\username\\Desktop\\Some Parent\\Another parent with, a comma\\apache-tomcat-7.0.42\\bin\\a comma\\apache-tomcat-7.0.42\\lib], exists: [false], isDirectory: [false], canRead: [false]\nOct 02, 2013 11:34:31 AM org.apache.catalina.startup.ClassLoaderFactory validateFile\nWARNING: Problem with directory [C:\\Users\\username\\Desktop\\Some Parent\\Another parent with], exists: [false], isDirectory: [false], canRead: [false]\nOct 02, 2013 11:34:31 AM org.apache.catalina.startup.ClassLoaderFactory validateFile\nWARNING: Problem with directory [C:\\Users\\username\\Desktop\\Some Parent\\Another parent with, a comma\\apache-tomcat-7.0.42\\bin\\a comma\\apache-tomcat-7.0.42\\lib], exists: [false], isDirectory: [false], canRead: [false]\nOct 02, 2013 11:34:31 AM org.apache.catalina.startup.ClassLoaderFactory validateFile\nWARNING: Problem with directory [C:\\Users\\username\\Desktop\\Some Parent\\Another parent with], exists: [false], isDirectory: [false], canRead: [false]\nOct 02, 2013 11:34:31 AM org.apache.catalina.startup.ClassLoaderFactory validateFile\nWARNING: Problem with directory [C:\\Users\\username\\Desktop\\Some Parent\\Another parent with, a comma\\apache-tomcat-7.0.42\\bin\\a comma\\apache-tomcat-7.0.42\\lib], exists: [false], isDirectory: [false], canRead: [false]','2013-10-02 16:36:43','Rodney Beede','Tomcat Developers Mailing List','RESOLVED WONTFIX','Tomcat 8','Catalina','P2 minor','cea59a1','Mark Emlyn David Thomas','2013-10-07 06:55:18','Partial fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=55620 Handle the case of a comma in $CATALINA_HOME or $CATALINA_BASE','conf/catalina.properties\njava/org/apache/catalina/startup/Bootstrap.java\ntest/org/apache/catalina/startup/TestBootstrap.java\nwebapps/docs/changelog.xml'),(95,55629,'Bug 55629 – StatusManagerServlet does not remove JMX notification listener','StatusManagerServlet.destroy should call mBeanServer.removeNotificationListener because init method call mBeanServer.addNotificationListener.','2013-10-05 16:38:36','Gael Lalire','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','95faaec','Violeta Georgieva Georgieva','2013-10-07 04:36:23','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55629 Remove JMX notification listener when destroying servlet o.a.catalina.manager.StatusManagerServlet','java/org/apache/catalina/manager/StatusManagerServlet.java'),(96,55383,'Bug 55383 – Improve markup and design of Tomcat\'s HTML pages','','2013-08-07 20:54:30','Konstantin Preißer','Tomcat Developers Mailing List','NEW','Tomcat 8','Documentation','P2 enhancement','0f13911','Konstantin Preißer','2013-10-06 17:01:35','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55383 Improve HTML markup.','webapps/docs/api/index.html\nwebapps/docs/elapi/index.html\nwebapps/docs/jspapi/index.html\nwebapps/docs/servletapi/index.html\nwebapps/docs/websocketapi/index.html'),(97,55383,'Bug 55383 – Improve markup and design of Tomcat\'s HTML pages','','2013-08-07 20:54:30','Konstantin Preißer','Tomcat Developers Mailing List','NEW','Tomcat 8','Documentation','P2 enhancement','17a3a8e','Konstantin Preißer','2013-10-06 16:43:20','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55383 Improve HTML markup of \"sample\" webb application.','webapps/docs/appdev/sample/index.html\nwebapps/docs/appdev/sample/src/mypackage/Hello.java\nwebapps/docs/appdev/sample/web/hello.jsp\nwebapps/docs/appdev/sample/web/index.html'),(98,49134,'Bug 49134 – Server.stop() doesn\'t unregister all MBeans','','2010-04-16 05:32:43','Marc Guillemot','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','b27e898','Mark Emlyn David Thomas','2013-10-05 18:53:05','Partial fix for re-opened https://issues.apache.org/bugzilla/show_bug.cgi?id=49134 Ensure nested realms are correctly destroyed, ensuring that the associated MBeans are deregistered.','java/org/apache/catalina/realm/CombinedRealm.java\ntest/org/apache/catalina/mbeans/TestRegistration.java'),(99,55383,'Bug 55383 – Improve markup and design of Tomcat\'s HTML pages','','2013-08-07 20:54:30','Konstantin Preißer','Tomcat Developers Mailing List','NEW','Tomcat 8','Documentation','P2 enhancement','8a16992','Konstantin Preißer','2013-10-01 16:26:55','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55383 - Improve HTML markup of generated pages by Txt2HTML ant task. - Use declared encoding (\"ISO-8859-1\") instead of default encoding to read the source files. - Use declared line separator instead of \"line.separator\" property so that the file is generated the same on every plattform.','java/org/apache/tomcat/buildutil/Txt2Html.java'),(100,55383,'Bug 55383 – Improve markup and design of Tomcat\'s HTML pages','','2013-08-07 20:54:30','Konstantin Preißer','Tomcat Developers Mailing List','NEW','Tomcat 8','Documentation','P2 enhancement','54345ee','Konstantin Preißer','2013-10-01 14:46:55','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55383 Improve markup of HTML page. Fix broken link to \"ServletToJsp.java.html\" - it is generated by Ant txt2html task.','webapps/examples/jsp/jsptoserv/jts.html'),(101,55383,'Bug 55383 – Improve markup and design of Tomcat\'s HTML pages','','2013-08-07 20:54:30','Konstantin Preißer','Tomcat Developers Mailing List','NEW','Tomcat 8','Documentation','P2 enhancement','5024aeb','Konstantin Preißer','2013-09-27 10:48:41','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55383 Improve CSS: - Use media queries in the main CSS file to better control when CSS styles should not be applied for printing. - Use \"noPrint\" class for ASF logo.','webapps/docs/images/docs-stylesheet.css\nwebapps/docs/tomcat-docs.xsl'),(102,55317,'Bug 55317 – Facilitate weaving by allowing ClassFileTransformer to be added to WebppClassLoader','','2013-07-28 07:17:28','Nick Williams','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','dd0cba7','Mark Emlyn David Thomas','2013-09-26 18:55:22','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55317 Facilitate weaving by allowing ClassFileTransformer to be added to WebppClassLoader Patch be Nick Williams','java/org/apache/catalina/loader/LocalStrings.properties\njava/org/apache/catalina/loader/WebappClassLoader.java\njava/org/apache/tomcat/InstrumentableClassLoader.java\ntest/org/apache/catalina/loader/TestWebappClassLoaderWeaving.java\ntest/org/apache/catalina/loader/TesterNeverWeavedClass.java\ntest/org/apache/catalina/loader/TesterUnweavedClass.java\nwebapps/docs/changelog.xml'),(103,55383,'Bug 55383 – Improve markup and design of Tomcat\'s HTML pages','','2013-08-07 20:54:30','Konstantin Preißer','Tomcat Developers Mailing List','NEW','Tomcat 8','Documentation','P2 enhancement','4486503','Konstantin Preißer','2013-09-26 10:29:33','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55383 Improve markup for examples (part 1).','webapps/examples/websocket/chat.xhtml\nwebapps/examples/websocket/echo.xhtml\nwebapps/examples/websocket/index.xhtml\nwebapps/examples/websocket/snake.xhtml'),(104,55383,'Bug 55383 – Improve markup and design of Tomcat\'s HTML pages','','2013-08-07 20:54:30','Konstantin Preißer','Tomcat Developers Mailing List','NEW','Tomcat 8','Documentation','P2 enhancement','d3cb351','Konstantin Preißer','2013-09-25 12:31:22','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55383 Improve HTML markup of the ErrorReportValve. The design/layout is still the same, but I\'m looking into how it can be improved.','java/org/apache/catalina/util/TomcatCSS.java\njava/org/apache/catalina/valves/ErrorReportValve.java'),(105,55383,'Bug 55383 – Improve markup and design of Tomcat\'s HTML pages','','2013-08-07 20:54:30','Konstantin Preißer','Tomcat Developers Mailing List','NEW','Tomcat 8','Documentation','P2 enhancement','8fdc9b9','Konstantin Preißer','2013-09-25 10:15:05','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55383 Use UTF-8 as encoding for the ROOT index.jsp.','webapps/ROOT/index.jsp'),(106,55576,'Bug 55576 – Order of ServletRequest parameters is not preserved','The ServletRequest interface provides two methods to iterate through request parameters:\n\nEnumeration<String> getParameterNames(), and\nMap<String, String[]> getParameterMap()\n\nUnfortunately, the underlying implementation in Tomcat is a HashMap, which fails to preserve the order of parameters as they are specified in the request.\n\nAn alternate implementation should be used to preserve request order.  LinkedHashMap, for example, is capable of preserving insertion order.\n\nThe Servlet Specification (v3.0) speaks only to the relative ordering of query string data and post body data. However, section 17.13.3 of the HTML specification (v4.01) titled \"Processing form data\", clearly states that \"control names/values are listed in the order they appear in the document.\"\n\nTherefore, I do not see a valid interpretation of either specification to rationalize Tomcat\'s implementation. To receive a request with an ordered list of parameters and represent them in an implementation that is guaranteed not to preserve this order is difficult to rationalize.','2013-09-20 21:14:32','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 major','90556a9','Mark Emlyn David Thomas','2013-09-23 16:52:58','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55576 Preserve the order that request parameters were presented by the client.','java/org/apache/catalina/util/ParameterMap.java\njava/org/apache/tomcat/util/http/Parameters.java'),(107,55582,'Bug 55582 – Concurrent issue of TagFileProcessor','','2013-09-22 10:00:36','Sheldon Shao','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','f627cc8','Mark Emlyn David Thomas','2013-09-23 09:54:31','https://issues.apache.org/bugzilla/show_bug.cgi?id=55582 Correct concurrency issue that can result in two instances of JspServletWrapper being created for one tag. Patch provided by Sheldon Shao.','java/org/apache/jasper/compiler/TagFileProcessor.java'),(108,55383,'Bug 55383 – Improve markup and design of Tomcat\'s HTML pages','','2013-08-07 20:54:30','Konstantin Preißer','Tomcat Developers Mailing List','NEW','Tomcat 8','Documentation','P2 enhancement','3ac592b','Mark Emlyn David Thomas','2013-09-19 16:52:44','https://issues.apache.org/bugzilla/show_bug.cgi?id=55383 Improve markup for examples (part 1) Patch provided by Konstantin Preißer','webapps/examples/index.html\nwebapps/examples/jsp/index.html\nwebapps/examples/servlets/index.html\nwebapps/examples/websocket/chat.html\nwebapps/examples/websocket/chat.xhtml\nwebapps/examples/websocket/echo.html\nwebapps/examples/websocket/echo.xhtml\nwebapps/examples/websocket/index.html\nwebapps/examples/websocket/index.xhtml\nwebapps/examples/websocket/snake.html\nwebapps/examples/websocket/snake.xhtml'),(109,55383,'Bug 55383 – Improve markup and design of Tomcat\'s HTML pages','','2013-08-07 20:54:30','Konstantin Preißer','Tomcat Developers Mailing List','NEW','Tomcat 8','Documentation','P2 enhancement','9a26da8','Mark Emlyn David Thomas','2013-09-19 16:50:25','https://issues.apache.org/bugzilla/show_bug.cgi?id=55383 Improve markup for Welcome pages Patch provided by Konstantin Preißer','res/welcome.bin.html\nres/welcome.main.html'),(110,55570,'Bug 55570 – SpnegoAuthenticator: Resource file is missing placeholders for exceptions.','In java/org/apache/catalina/authenticator/SpnegoAuthenticator.java problems are logged with an exception. The exception does not show up in the logging. The exception only shows up if I hack java/org/apache/catalina/authenticator/LocalStrings.properties in catalina.jar, and add a placeholder.\n\n\nREPRODUCE:\n- Configure SP-NEGO with Kerberos.\n- Mess up your principal in com.sun.security.jgss.krb5.accept in jaas.config.\n- Try to login. \n- See that you get something like:\nFINE [org.apache.catalina.authenticator.SpnegoAuthenticator authenticate] Failed to validate client supplied ticket \n\nFIX:\nIn java/org/apache/catalina/authenticator/LocalStrings.properties please add [{0}] to the following lines:\nspnegoAuthenticator.ticketValidateFail=Failed to validate client supplied ticket\nspnegoAuthenticator.serviceLoginFail=Unable to login as the service principal\nIn SpnegoAuthenticator.java you can verify that exceptions are indeed passed to the log.\n\nVALIDATE:\n- Reproduce again\n- See that you now get\nFailed to validate client supplied ticket [GSSException: Failure unspecified at GSS-API level (Mechanism level: Invalid argument (400) - Cannot find key of appropriate type to decrypt AP REP - RC4 with HMAC)] \n\nThe exception is not super-helpful, but at least it\'s something.','2013-09-19 12:48:43','Sander','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','910d4d9','Mark Emlyn David Thomas','2013-09-19 10:50:06','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55570 Correct log exceptions so they appear in the logs','java/org/apache/catalina/authenticator/SpnegoAuthenticator.java'),(111,46727,'Bug 46727 – DefaultServlet - serving multiple encodings','','2009-02-17 15:01:26','Fred Toth','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 enhancement','f74257e','Mark Emlyn David Thomas','2013-09-18 09:21:08','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46727  Refactor default servlet to make it easier to sub-class to implement finer grained control of the file encoding. Based on a patch by Fred Toth.','java/org/apache/catalina/servlets/DefaultServlet.java\nwebapps/docs/changelog.xml'),(112,52558,'Bug 52558 – CometConnectionManagerValve is adding non-serializable Request[] to Session','CometConnectionManagerValve is adding HttpServletRequest[] to HttpSession which is preventing the Session being serialized in a Clustered setup.\n\nWe\'re resolving this locally using a serializable ConnectionList class with a transient Request[]\n\ni.e.\n\npublic class ConnectionList implements Serializable {\n	\n	transient Request[] connectionList = null;\n	\n	ConnectionList(Request[] connectionList){\n		this.connectionList = connectionList;\n	}\n	\n	public Request[] get(){\n		return connectionList;\n	}\n}','2012-01-30 10:46:47','adam hawkins','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 enhancement','b284611','Mark Emlyn David Thomas','2013-09-12 07:16:15','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52558 Refactor CometConnectionManagerValve so that it does not prevent the session from being serialized in when running in a cluster.','java/org/apache/catalina/valves/CometConnectionManagerValve.java\nwebapps/docs/changelog.xml'),(113,55552,'Bug 55552 – Potential NullPointerException in compiled JSPs if expected EL result is of primitive type','','2013-09-12 06:19:31','Arvīds Grabovskis','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Jasper','P2 normal','66932c4','Mark Emlyn David Thomas','2013-09-12 06:06:16','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55552 Separate the return type (which must be an object) from the expected type which may be a primitive. This is necessary for EL 3.0 onwards as the default handling of nulls is now different for primitives and objects. The expression engine needs to know what the true expected type is in order to correctly coerce the result to the right type.','java/org/apache/jasper/compiler/JspUtil.java'),(114,55383,'Bug 55383 – Improve markup and design of Tomcat\'s HTML pages','','2013-08-07 20:54:30','Konstantin Preißer','Tomcat Developers Mailing List','NEW','Tomcat 8','Documentation','P2 enhancement','cacaa8a','Mark Emlyn David Thomas','2013-09-11 09:50:13','https://issues.apache.org/bugzilla/show_bug.cgi?id=55383 IE<=9 fixes for Tomcat 8 docs','webapps/docs/images/docs-stylesheet-ie-fix.css\nwebapps/docs/tomcat-docs.xsl'),(115,55534,'Bug 55534 – Tomcat 7 and 8 missing javax.annotation classes added in Java EE 6, 7 respectively','JSR 250 (\"Common Annotations 1.0\") specified a set of common annotations for application development. Some of them were included in Java SE 6 and later, but many of them are Java EE-specific and were added in Java EE 5. Tomcat 6 included these annotations since Tomcat supported some of them. The annotations included in Tomcat 6 are:\n\njavax.annotation.Generated\njavax.annotation.PostConstruct\njavax.annotation.PreDestroy\njavax.annotation.Resource\njavax.annotation.Resources\njavax.annotation.security.DeclareRoles\njavax.annotation.security.DenyAll\njavax.annotation.security.PermitAll\njavax.annotation.security.RolesAllowed\njavax.annotation.security.RunAs\n\nThis was fine in Java EE 5 / Tomcat 6. However, Java EE 6 (\"Common Annotations 1.1\") added the following annotations that Tomcat 7 never included:\n\njavax.annotation.ManagedBean\njavax.annotation.sql.DataSourceDefinition\njavax.annotation.sql.DataSourceDefinitions\n\nFurthermore, Java EE 7 (\"Common Annotations 1.2\") added the following annotation that Tomcat 8 has not yet included:\n\njavax.annotation.Priority\n\nTomcat should included these annotations in its \"annotations-api.jar\". Other frameworks (like Spring Framework and JPA providers) make use of these new annotations. Since Tomcat does not include them, the /correct/ thing for an application that needs them to do is include the official javax.annotation-api.jar artifact in their application. However, this JAR redefines annotations already supplied by Tomcat, which could lead to hard-to-diagnose errors (similar to why an application should never include the servlet-api artifact in their application). Adding these missing annotations would remove the requirement for applications to include the problem JAR in their application.\n\nTomcat 7 should ship @ManagedBean, @DataSourceDefinition, and @DataSourceDefinitions. Tomcat 8 should ship with @Priority.','2013-09-07 23:00:47','Nick Williams','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 normal','80154c4','Mark Emlyn David Thomas','2013-09-09 06:51:36','Remainder of fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=55534 Commons Annotations 1.2 changes','java/javax/annotation/Priority.java\njava/javax/annotation/Resource.java'),(116,55534,'Bug 55534 – Tomcat 7 and 8 missing javax.annotation classes added in Java EE 6, 7 respectively','JSR 250 (\"Common Annotations 1.0\") specified a set of common annotations for application development. Some of them were included in Java SE 6 and later, but many of them are Java EE-specific and were added in Java EE 5. Tomcat 6 included these annotations since Tomcat supported some of them. The annotations included in Tomcat 6 are:\n\njavax.annotation.Generated\njavax.annotation.PostConstruct\njavax.annotation.PreDestroy\njavax.annotation.Resource\njavax.annotation.Resources\njavax.annotation.security.DeclareRoles\njavax.annotation.security.DenyAll\njavax.annotation.security.PermitAll\njavax.annotation.security.RolesAllowed\njavax.annotation.security.RunAs\n\nThis was fine in Java EE 5 / Tomcat 6. However, Java EE 6 (\"Common Annotations 1.1\") added the following annotations that Tomcat 7 never included:\n\njavax.annotation.ManagedBean\njavax.annotation.sql.DataSourceDefinition\njavax.annotation.sql.DataSourceDefinitions\n\nFurthermore, Java EE 7 (\"Common Annotations 1.2\") added the following annotation that Tomcat 8 has not yet included:\n\njavax.annotation.Priority\n\nTomcat should included these annotations in its \"annotations-api.jar\". Other frameworks (like Spring Framework and JPA providers) make use of these new annotations. Since Tomcat does not include them, the /correct/ thing for an application that needs them to do is include the official javax.annotation-api.jar artifact in their application. However, this JAR redefines annotations already supplied by Tomcat, which could lead to hard-to-diagnose errors (similar to why an application should never include the servlet-api artifact in their application). Adding these missing annotations would remove the requirement for applications to include the problem JAR in their application.\n\nTomcat 7 should ship @ManagedBean, @DataSourceDefinition, and @DataSourceDefinitions. Tomcat 8 should ship with @Priority.','2013-09-07 23:00:47','Nick Williams','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 normal','98f5292','Mark Emlyn David Thomas','2013-09-09 06:50:58','Partial fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=55534 More Commons Annotations 1.1 changes','java/javax/annotation/sql/DataSourceDefinitions.java'),(117,55534,'Bug 55534 – Tomcat 7 and 8 missing javax.annotation classes added in Java EE 6, 7 respectively','JSR 250 (\"Common Annotations 1.0\") specified a set of common annotations for application development. Some of them were included in Java SE 6 and later, but many of them are Java EE-specific and were added in Java EE 5. Tomcat 6 included these annotations since Tomcat supported some of them. The annotations included in Tomcat 6 are:\n\njavax.annotation.Generated\njavax.annotation.PostConstruct\njavax.annotation.PreDestroy\njavax.annotation.Resource\njavax.annotation.Resources\njavax.annotation.security.DeclareRoles\njavax.annotation.security.DenyAll\njavax.annotation.security.PermitAll\njavax.annotation.security.RolesAllowed\njavax.annotation.security.RunAs\n\nThis was fine in Java EE 5 / Tomcat 6. However, Java EE 6 (\"Common Annotations 1.1\") added the following annotations that Tomcat 7 never included:\n\njavax.annotation.ManagedBean\njavax.annotation.sql.DataSourceDefinition\njavax.annotation.sql.DataSourceDefinitions\n\nFurthermore, Java EE 7 (\"Common Annotations 1.2\") added the following annotation that Tomcat 8 has not yet included:\n\njavax.annotation.Priority\n\nTomcat should included these annotations in its \"annotations-api.jar\". Other frameworks (like Spring Framework and JPA providers) make use of these new annotations. Since Tomcat does not include them, the /correct/ thing for an application that needs them to do is include the official javax.annotation-api.jar artifact in their application. However, this JAR redefines annotations already supplied by Tomcat, which could lead to hard-to-diagnose errors (similar to why an application should never include the servlet-api artifact in their application). Adding these missing annotations would remove the requirement for applications to include the problem JAR in their application.\n\nTomcat 7 should ship @ManagedBean, @DataSourceDefinition, and @DataSourceDefinitions. Tomcat 8 should ship with @Priority.','2013-09-07 23:00:47','Nick Williams','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 normal','a3d5f1d','Mark Emlyn David Thomas','2013-09-09 06:36:09','Partial fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=55534 Commons Annotations 1.1 changes','java/javax/annotation/ManagedBean.java\njava/javax/annotation/sql/DataSourceDefinition.java\njava/javax/annotation/sql/DataSourceDefinitions.java'),(118,55534,'Bug 55534 – Tomcat 7 and 8 missing javax.annotation classes added in Java EE 6, 7 respectively','JSR 250 (\"Common Annotations 1.0\") specified a set of common annotations for application development. Some of them were included in Java SE 6 and later, but many of them are Java EE-specific and were added in Java EE 5. Tomcat 6 included these annotations since Tomcat supported some of them. The annotations included in Tomcat 6 are:\n\njavax.annotation.Generated\njavax.annotation.PostConstruct\njavax.annotation.PreDestroy\njavax.annotation.Resource\njavax.annotation.Resources\njavax.annotation.security.DeclareRoles\njavax.annotation.security.DenyAll\njavax.annotation.security.PermitAll\njavax.annotation.security.RolesAllowed\njavax.annotation.security.RunAs\n\nThis was fine in Java EE 5 / Tomcat 6. However, Java EE 6 (\"Common Annotations 1.1\") added the following annotations that Tomcat 7 never included:\n\njavax.annotation.ManagedBean\njavax.annotation.sql.DataSourceDefinition\njavax.annotation.sql.DataSourceDefinitions\n\nFurthermore, Java EE 7 (\"Common Annotations 1.2\") added the following annotation that Tomcat 8 has not yet included:\n\njavax.annotation.Priority\n\nTomcat should included these annotations in its \"annotations-api.jar\". Other frameworks (like Spring Framework and JPA providers) make use of these new annotations. Since Tomcat does not include them, the /correct/ thing for an application that needs them to do is include the official javax.annotation-api.jar artifact in their application. However, this JAR redefines annotations already supplied by Tomcat, which could lead to hard-to-diagnose errors (similar to why an application should never include the servlet-api artifact in their application). Adding these missing annotations would remove the requirement for applications to include the problem JAR in their application.\n\nTomcat 7 should ship @ManagedBean, @DataSourceDefinition, and @DataSourceDefinitions. Tomcat 8 should ship with @Priority.','2013-09-07 23:00:47','Nick Williams','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 normal','80f0955','Mark Emlyn David Thomas','2013-09-09 06:11:33','Remove some unnecessary whitespace. Add some @since markers prior to fixing bz 55534.','java/javax/annotation/Generated.java\njava/javax/annotation/PostConstruct.java\njava/javax/annotation/PreDestroy.java\njava/javax/annotation/Resource.java\njava/javax/annotation/Resources.java\njava/javax/annotation/security/DeclareRoles.java\njava/javax/annotation/security/DenyAll.java\njava/javax/annotation/security/PermitAll.java\njava/javax/annotation/security/RolesAllowed.java\njava/javax/annotation/security/RunAs.java'),(119,54693,'Bug 54693 – Add a validationQueryTimeout property','','2013-03-13 20:04:20','Daniel Mikusa','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 enhancement','b022c57','Keiichi Fujino','2013-09-09 06:11:07','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54693. - Add a validationQueryTimeout property - Avoid NPE caused by createConnection(..) returns null. (see Comment 6)','modules/jdbc-pool/doc/jdbc-pool.xml\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/DataSourceFactory.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/DataSourceProxy.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/PoolConfiguration.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/PoolProperties.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/PooledConnection.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/jmx/ConnectionPool.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/mbeans-descriptors.xml\nmodules/jdbc-pool/src/test/java/org/apache/tomcat/jdbc/test/TestValidationQueryTimeout.java'),(120,55521,'Bug 55521 – Race Condition in HttpSession#invalidate() / HttpServletRequest#getSession(boolean)','','2013-09-04 10:24:05','Christoph','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 normal','262c069','Mark Emlyn David Thomas','2013-09-05 11:42:48','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55521 Ensure that session.expire() doesn\'t return until the session has been invalidated. Ensure that the return valid of session.isValid() is consistent the current state.','java/org/apache/catalina/ha/session/DeltaSession.java\njava/org/apache/catalina/session/StandardSession.java'),(121,55383,'Bug 55383 – Improve markup and design of Tomcat\'s HTML pages','','2013-08-07 20:54:30','Konstantin Preißer','Tomcat Developers Mailing List','NEW','Tomcat 8','Documentation','P2 enhancement','a7deb3f','Mark Emlyn David Thomas','2013-09-05 10:17:07','Final part of https://issues.apache.org/bugzilla/show_bug.cgi?id=55383 for Tomcat 8 Improve markup and design of Tomcat\'s HTML pages Patch by Konstantin Preißer','webapps/docs/funcspecs/fs-admin-objects.xml\nwebapps/docs/funcspecs/fs-admin-opers.xml\nwebapps/docs/funcspecs/fs-default.xml\nwebapps/docs/funcspecs/mbean-names.xml\nwebapps/docs/tribes/introduction.xml'),(122,55527,'Bug 55527 – JSSESocketFactory conditionally converts alias to lower case; condition is unwise','JSSESocketFactory conditionally converts the alias to lower case.\n\nThe condition is coded as follows:\n\nprivate static final String defaultKeystoreType = \"JKS\";\n...\nif (JSSESocketFactory.defaultKeystoreType.equals(keystoreType)) {\n    alias = alias.toLowerCase(Locale.ENGLISH);\n}\n\nIf the intention is to downcase only JKS store aliases, then the comparison should be made with \"JKS\", not a constant that happens to contain \"JKS\" at present.\n\nUsing a specific comparator would both clarify the code and protect against a possible change to the default (albeit very unlikely).','2013-09-05 09:05:01','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 minor','f126b5a','Mark Emlyn David Thomas','2013-09-05 06:36:34','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55527','java/org/apache/tomcat/util/net/jsse/JSSESocketFactory.java'),(123,55343,'Bug 55343 – Add flag to ignore exceptions while creating initial pool','I want my initial pool to be of some size i.e. not empty AND start even if it fails to create all or some of connections.\n\nIf pool fails to create initial connections for some reason it just throws exceptions. To workaround that I have to set initial pool size to 0.\n\nIt can be handy to add a flag to ignore (just log them) exceptions that occur while creating initial connections.','2013-08-02 06:05:03','Mikhail Mazursky','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 enhancement','4aa42d7','Keiichi Fujino','2013-09-04 04:56:24','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55343 Add flag to ignore error of connection creation while initializing the pool.','modules/jdbc-pool/doc/jdbc-pool.xml\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/DataSourceFactory.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/DataSourceProxy.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/PoolConfiguration.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/PoolProperties.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/jmx/ConnectionPool.java'),(124,55342,'Bug 55342 – Lost interruption','org.apache.tomcat.jdbc.pool.ConnectionPool#close should not call Thread.interrupted() because interrupt was already reset by code that thrown InterruptedException.\n\n  } catch (InterruptedException ex) {\n      if (getPoolProperties().getPropagateInterruptState()) {\n          Thread.currentThread().interrupt();\n-     } else {\n-         Thread.interrupted();\n      }\n  }','2013-08-02 05:54:35','Mikhail Mazursky','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','41225cd','Keiichi Fujino','2013-09-03 22:17:25','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55342 Remove unnecessary reset of interrupted flag. If the InterruptedException is thrown, the interrupted flag has been cleared.','modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java'),(125,55383,'Bug 55383 – Improve markup and design of Tomcat\'s HTML pages','','2013-08-07 20:54:30','Konstantin Preißer','Tomcat Developers Mailing List','NEW','Tomcat 8','Documentation','P2 enhancement','dd07f98','Mark Emlyn David Thomas','2013-09-03 08:41:42','Further patch (part 3) for https://issues.apache.org/bugzilla/show_bug.cgi?id=55383 Improve markup and design of Tomcat\'s HTML pages Fix some version references for Tomcat 8','webapps/docs/appdev/deployment.xml\nwebapps/docs/appdev/index.xml\nwebapps/docs/appdev/installation.xml\nwebapps/docs/appdev/introduction.xml\nwebapps/docs/appdev/processes.xml\nwebapps/docs/appdev/source.xml\nwebapps/docs/architecture/startup.xml\nwebapps/docs/config/ajp.xml\nwebapps/docs/config/cluster-interceptor.xml\nwebapps/docs/config/cluster-membership.xml\nwebapps/docs/config/cluster-sender.xml\nwebapps/docs/config/cluster.xml\nwebapps/docs/config/context.xml\nwebapps/docs/config/engine.xml\nwebapps/docs/config/filter.xml\nwebapps/docs/config/globalresources.xml\nwebapps/docs/config/host.xml\nwebapps/docs/config/http.xml\nwebapps/docs/config/listeners.xml\nwebapps/docs/config/loader.xml\nwebapps/docs/config/manager.xml\nwebapps/docs/config/realm.xml\nwebapps/docs/config/systemprops.xml\nwebapps/docs/config/valve.xml\nwebapps/docs/images/docs-stylesheet.css\nwebapps/docs/tomcat-docs.xsl'),(126,55517,'Bug 55517 – Resynch classpaths for netbeans support','','2013-09-03 12:09:28','Brian Burch','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 minor','ca38ec8','Mark Emlyn David Thomas','2013-09-03 08:14:09','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55517 Resynch classpaths for netbeans support Patch provided by Brian Burch','res/ide-support/netbeans/project.xml'),(127,55500,'Bug 55500 – AsyncListener.onTimeout is not called via AJP AjpNioProtocol connector','The AsyncListener.onTimeout is not called, when timeout occurs, when traffic routed via AJP connector configured with AjpNioProtocol protocol.','2013-08-29 12:21:17','Pavel Orehov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 critical','cf1e104','Mark Emlyn David Thomas','2013-09-03 05:24:08','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55500 Ensure async timeout is applied when using Servlet 3.0 async with the AJP NIO connector.','java/org/apache/coyote/ajp/AbstractAjpProcessor.java\njava/org/apache/coyote/ajp/AjpAprProcessor.java\njava/org/apache/coyote/ajp/AjpNioProcessor.java\njava/org/apache/coyote/ajp/AjpProcessor.java'),(128,55383,'Bug 55383 – Improve markup and design of Tomcat\'s HTML pages','','2013-08-07 20:54:30','Konstantin Preißer','Tomcat Developers Mailing List','NEW','Tomcat 8','Documentation','P2 enhancement','20bf585','Mark Emlyn David Thomas','2013-08-30 03:39:36','Part of fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=55383 Improve CSS - use different colours for odd and even table rows Patch by Konstantin Preißer','webapps/docs/images/docs-stylesheet.css'),(129,55383,'Bug 55383 – Improve markup and design of Tomcat\'s HTML pages','','2013-08-07 20:54:30','Konstantin Preißer','Tomcat Developers Mailing List','NEW','Tomcat 8','Documentation','P2 enhancement','321f656','Mark Emlyn David Thomas','2013-08-30 03:38:49','Part of fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=55383 Improve mark-up in docs part 2 Patch by Konstantin Preißer','webapps/docs/maven-jars.xml\nwebapps/docs/mbeans-descriptor-howto.xml\nwebapps/docs/monitoring.xml\nwebapps/docs/proxy-howto.xml\nwebapps/docs/realm-howto.xml\nwebapps/docs/rewrite.xml\nwebapps/docs/security-howto.xml\nwebapps/docs/security-manager-howto.xml\nwebapps/docs/setup.xml\nwebapps/docs/ssi-howto.xml\nwebapps/docs/ssl-howto.xml\nwebapps/docs/virtual-hosting-howto.xml\nwebapps/docs/windows-auth-howto.xml\nwebapps/docs/windows-service-howto.xml'),(130,55383,'Bug 55383 – Improve markup and design of Tomcat\'s HTML pages','','2013-08-07 20:54:30','Konstantin Preißer','Tomcat Developers Mailing List','NEW','Tomcat 8','Documentation','P2 enhancement','18c854c','Mark Emlyn David Thomas','2013-08-29 05:02:41','Further fixes for https://issues.apache.org/bugzilla/show_bug.cgi?id=55383 Improve HTML markup and follow new XSLT - Part 1. Patch provided by  Konstantin Preißer.','modules/jdbc-pool/doc/jdbc-pool.xml\nwebapps/docs/aio.xml\nwebapps/docs/apr.xml\nwebapps/docs/building.xml\nwebapps/docs/cgi-howto.xml\nwebapps/docs/class-loader-howto.xml\nwebapps/docs/cluster-howto.xml\nwebapps/docs/connectors.xml\nwebapps/docs/default-servlet.xml\nwebapps/docs/deployer-howto.xml\nwebapps/docs/html-manager-howto.xml\nwebapps/docs/jasper-howto.xml\nwebapps/docs/jndi-datasource-examples-howto.xml\nwebapps/docs/jndi-resources-howto.xml\nwebapps/docs/logging.xml\nwebapps/docs/manager-howto.xml'),(131,55215,'Bug 55215 – Improvements to sample log4j configuration','','2013-07-08 17:58:14','Brian Burch','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Documentation','P2 minor','e781984','Mark Emlyn David Thomas','2013-08-29 04:28:43','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55215 Additional clarifications to logging documentation that make clear why access logs are handled separately. Patch provided by Brian Burch.','webapps/docs/config/valve.xml\nwebapps/docs/logging.xml'),(132,55483,'Bug 55483 – ELException when object has overloaded methods','Included below are two test cases which fail.  The first calls an overloaded method on an object.  The second calls an overloaded constructor.  More details below.\n\n\n1.) Here\'s the first test.\n\n   @Test\n   public void test01() {\n       ELProcessor processor = new ELProcessor();\n       processor.defineBean(\"sb\", new StringBuilder());\n       Assert.assertEquals(\"a\", processor.eval(\"sb.append(\'a\'); sb.toString()\"));\n   }\n\nThis fails with the following stack trace.\n\njavax.el.ELException: Cannot convert a of type class java.lang.String to long\n	at org.apache.el.lang.ELSupport.coerceToNumber(ELSupport.java:349)\n	at org.apache.el.lang.ELSupport.coerceToNumber(ELSupport.java:328)\n	at org.apache.el.lang.ELSupport.coerceToType(ELSupport.java:450)\n	at org.apache.el.ExpressionFactoryImpl.coerceToType(ExpressionFactoryImpl.java:48)\n	at javax.el.Util.buildParameters(Util.java:351)\n	at javax.el.BeanELResolver.invoke(BeanELResolver.java:173)\n	at javax.el.CompositeELResolver.invoke(CompositeELResolver.java:84)\n	at org.apache.el.parser.AstValue.getValue(AstValue.java:157)\n	at org.apache.el.parser.AstSemicolon.getValue(AstSemicolon.java:35)\n	at org.apache.el.ValueExpressionImpl.getValue(ValueExpressionImpl.java:188)\n	at javax.el.ELProcessor.getValue(ELProcessor.java:45)\n	at javax.el.ELProcessor.eval(ELProcessor.java:38)\n	at org.apache.el.parser.TestAstMethodCalls.test01(TestAstMethodCalls.java:32)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n	at java.lang.reflect.Method.invoke(Method.java:606)\n	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)\n	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)\n	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)\n	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)\n	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)\n	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)\n	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)\n	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)\n	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)\n	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)\n	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)\n	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)\n	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)\n	at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)\n	at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)\n	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)\n	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)\n	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)\n	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)\n\nLooking into this, it appears that the EL is having trouble because StringBuilder\'s append method is overloaded.  It is instructed to call append with the character \'c\', but instead is trying to coerce the character \'c\' to a long and call append with the long.\n\nThis chain of events seems to be kicked off in AstValue.getValue() line #157, where it\'s calling resolver.invoke(..).  The call to resolver.invoke() is passing null as the paramTypes argument.  This trickles down to BeanELResolver.invoke(), which calls Util.findMethod().  Because paramTypes is null, Util.findMethod() selects the first method it finds with the expected number of arguments.  In the case above, it selects StringBuilder.append(long), which causes the problem above.\n\n\n\n2.) Here\'s the second test.\n\n   @Test\n   public void test02() {\n       ELProcessor processor = new ELProcessor();\n       processor.getELManager().importClass(\"java.util.Date\");\n       Date result = (Date) processor.eval(\"Date(86400)\");\n       Assert.assertEquals(86400, result.getTime());\n   }\n\nThis one fails intermittently with the following stack trace.\n\njavax.el.ELException: java.lang.IllegalArgumentException\n	at javax.el.StaticFieldELResolver.invoke(StaticFieldELResolver.java:118)\n	at javax.el.CompositeELResolver.invoke(CompositeELResolver.java:84)\n	at org.apache.el.parser.AstFunction.getValue(AstFunction.java:138)\n	at org.apache.el.ValueExpressionImpl.getValue(ValueExpressionImpl.java:188)\n	at javax.el.ELProcessor.getValue(ELProcessor.java:45)\n	at javax.el.ELProcessor.eval(ELProcessor.java:38)\n	at org.apache.el.parser.TestAstMethodCalls.test02(TestAstMethodCalls.java:39)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n	at java.lang.reflect.Method.invoke(Method.java:606)\n	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)\n	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)\n	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)\n	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)\n	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)\n	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)\n	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)\n	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)\n	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)\n	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)\n	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)\n	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)\n	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)\n	at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)\n	at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)\n	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)\n	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)\n	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)\n	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)\nCaused by: java.lang.IllegalArgumentException\n	at java.util.Date.parse(Date.java:615)\n	at java.util.Date.<init>(Date.java:272)\n	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)\n	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n	at java.lang.reflect.Constructor.newInstance(Constructor.java:526)\n	at javax.el.StaticFieldELResolver.invoke(StaticFieldELResolver.java:111)\n	... 29 more\n\nLooking into this error, it seems similar to #1.  The difference is that AstFunction.getValue() line #138 is calling invoke on the resolver and passing null as the paramTypes.  This trickles down to the StaticFieldELResolver.invoke() method, which calls Util.findConstructor().  Again, because paramTypes is null, Util.findConstructor() searches the available constructors for the one with the same number of arguments.  The reason that this intermittently fails is because on my system, the call to Class.getConstructors() returns the list of constructs in an arbitrary order. So it fails when Date(String) is listed first, but succeeds when Date(long) is listed first.','2013-08-26 12:27:34','Daniel Mikusa','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','EL','P2 normal','ed00275','Mark Emlyn David Thomas','2013-08-28 16:50:13','Remainder of fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=55483 Handle overloaded consructors. As far as the constructor matching code is concerned, constructors can be treated as methods with a special name. Therefore, refactor the newly enhanced method matching code to handle methods or constructors and then use it to replace the current simplistic constructor matching.','java/javax/el/Util.java\ntest/javax/el/TestStaticFieldELResolver.java\ntest/javax/el/TestUtil.java'),(133,55483,'Bug 55483 – ELException when object has overloaded methods','Included below are two test cases which fail.  The first calls an overloaded method on an object.  The second calls an overloaded constructor.  More details below.\n\n\n1.) Here\'s the first test.\n\n   @Test\n   public void test01() {\n       ELProcessor processor = new ELProcessor();\n       processor.defineBean(\"sb\", new StringBuilder());\n       Assert.assertEquals(\"a\", processor.eval(\"sb.append(\'a\'); sb.toString()\"));\n   }\n\nThis fails with the following stack trace.\n\njavax.el.ELException: Cannot convert a of type class java.lang.String to long\n	at org.apache.el.lang.ELSupport.coerceToNumber(ELSupport.java:349)\n	at org.apache.el.lang.ELSupport.coerceToNumber(ELSupport.java:328)\n	at org.apache.el.lang.ELSupport.coerceToType(ELSupport.java:450)\n	at org.apache.el.ExpressionFactoryImpl.coerceToType(ExpressionFactoryImpl.java:48)\n	at javax.el.Util.buildParameters(Util.java:351)\n	at javax.el.BeanELResolver.invoke(BeanELResolver.java:173)\n	at javax.el.CompositeELResolver.invoke(CompositeELResolver.java:84)\n	at org.apache.el.parser.AstValue.getValue(AstValue.java:157)\n	at org.apache.el.parser.AstSemicolon.getValue(AstSemicolon.java:35)\n	at org.apache.el.ValueExpressionImpl.getValue(ValueExpressionImpl.java:188)\n	at javax.el.ELProcessor.getValue(ELProcessor.java:45)\n	at javax.el.ELProcessor.eval(ELProcessor.java:38)\n	at org.apache.el.parser.TestAstMethodCalls.test01(TestAstMethodCalls.java:32)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n	at java.lang.reflect.Method.invoke(Method.java:606)\n	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)\n	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)\n	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)\n	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)\n	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)\n	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)\n	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)\n	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)\n	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)\n	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)\n	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)\n	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)\n	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)\n	at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)\n	at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)\n	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)\n	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)\n	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)\n	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)\n\nLooking into this, it appears that the EL is having trouble because StringBuilder\'s append method is overloaded.  It is instructed to call append with the character \'c\', but instead is trying to coerce the character \'c\' to a long and call append with the long.\n\nThis chain of events seems to be kicked off in AstValue.getValue() line #157, where it\'s calling resolver.invoke(..).  The call to resolver.invoke() is passing null as the paramTypes argument.  This trickles down to BeanELResolver.invoke(), which calls Util.findMethod().  Because paramTypes is null, Util.findMethod() selects the first method it finds with the expected number of arguments.  In the case above, it selects StringBuilder.append(long), which causes the problem above.\n\n\n\n2.) Here\'s the second test.\n\n   @Test\n   public void test02() {\n       ELProcessor processor = new ELProcessor();\n       processor.getELManager().importClass(\"java.util.Date\");\n       Date result = (Date) processor.eval(\"Date(86400)\");\n       Assert.assertEquals(86400, result.getTime());\n   }\n\nThis one fails intermittently with the following stack trace.\n\njavax.el.ELException: java.lang.IllegalArgumentException\n	at javax.el.StaticFieldELResolver.invoke(StaticFieldELResolver.java:118)\n	at javax.el.CompositeELResolver.invoke(CompositeELResolver.java:84)\n	at org.apache.el.parser.AstFunction.getValue(AstFunction.java:138)\n	at org.apache.el.ValueExpressionImpl.getValue(ValueExpressionImpl.java:188)\n	at javax.el.ELProcessor.getValue(ELProcessor.java:45)\n	at javax.el.ELProcessor.eval(ELProcessor.java:38)\n	at org.apache.el.parser.TestAstMethodCalls.test02(TestAstMethodCalls.java:39)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n	at java.lang.reflect.Method.invoke(Method.java:606)\n	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)\n	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)\n	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)\n	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)\n	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)\n	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)\n	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)\n	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)\n	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)\n	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)\n	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)\n	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)\n	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)\n	at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)\n	at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)\n	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)\n	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)\n	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)\n	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)\nCaused by: java.lang.IllegalArgumentException\n	at java.util.Date.parse(Date.java:615)\n	at java.util.Date.<init>(Date.java:272)\n	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)\n	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n	at java.lang.reflect.Constructor.newInstance(Constructor.java:526)\n	at javax.el.StaticFieldELResolver.invoke(StaticFieldELResolver.java:111)\n	... 29 more\n\nLooking into this error, it seems similar to #1.  The difference is that AstFunction.getValue() line #138 is calling invoke on the resolver and passing null as the paramTypes.  This trickles down to the StaticFieldELResolver.invoke() method, which calls Util.findConstructor().  Again, because paramTypes is null, Util.findConstructor() searches the available constructors for the one with the same number of arguments.  The reason that this intermittently fails is because on my system, the call to Class.getConstructors() returns the list of constructs in an arbitrary order. So it fails when Date(String) is listed first, but succeeds when Date(long) is listed first.','2013-08-26 12:27:34','Daniel Mikusa','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','EL','P2 normal','4d5e79a','Mark Emlyn David Thomas','2013-08-28 15:02:39','Partial fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=55483 This fixes calling overloaded methods and aligns the method matching code in the API and the implementation. Unfortunately, this has required a fair amount of duplication. I don\'t see a way to avoid this, short of an el-util JAR that both depend on.','java/javax/el/LocalStrings.properties\njava/javax/el/Util.java\njava/org/apache/el/parser/AstValue.java\njava/org/apache/el/util/ReflectionUtil.java\ntest/javax/el/TestUtil.java'),(134,55494,'Bug 55494 – JNDIRealm throws exception after timeout / Connection reset','','2013-08-28 12:54:09','Thomas Hoffmann','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','7e74aee','Mark Emlyn David Thomas','2013-08-28 10:02:50','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55494 Reduce log level of exception messages that are logged for re-tries. Make clear in the message that a retry is taking place.','java/org/apache/catalina/realm/JNDIRealm.java\njava/org/apache/catalina/realm/LocalStrings.properties'),(135,55453,'Bug 55453 – AJP send Body with Status 304','','2013-08-20 04:48:03','Dieter Paradeiser','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 normal','6d99103','Mark Emlyn David Thomas','2013-08-28 09:01:03','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55453 Do not return a response body for those status codes and request methods that do not permit one.','java/org/apache/coyote/ajp/AbstractAjpProcessor.java\ntest/org/apache/coyote/ajp/TestAbstractAjpProcessor.java'),(136,55383,'Bug 55383 – Improve markup and design of Tomcat\'s HTML pages','','2013-08-07 20:54:30','Konstantin Preißer','Tomcat Developers Mailing List','NEW','Tomcat 8','Documentation','P2 enhancement','848c60b','Mark Emlyn David Thomas','2013-08-27 16:37:17','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55383 Set the mime-type to prevent an error when viewing the changelog directly.',''),(137,51526,'Bug 51526 – Process web application context config with embedded Tomcat.addWebApp(...)','It would be nice if org.apache.catalina.startup.Tomcat.addWebApp(...) would process the web application\'s META-INF/context.xml if found.  The current implementation skips META-INF/context.xml loading, and does not appear to offer any hook to enable it--the StandardContext is instantiated and initialized with a null configFile in the single call to addWebApp(...).','2011-07-18 23:08:06','Ian Brandt','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','058f044','Violeta Georgieva Georgieva','2013-08-27 15:22:47','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51526 o.a.catalina.startup.Tomcat.addWebapp(...) will process web application\'s context.xml when it is presented in the provided baseDir.','java/org/apache/catalina/startup/Tomcat.java\ntest/org/apache/catalina/startup/TestTomcat.java'),(138,55383,'Bug 55383 – Improve markup and design of Tomcat\'s HTML pages','','2013-08-07 20:54:30','Konstantin Preißer','Tomcat Developers Mailing List','NEW','Tomcat 8','Documentation','P2 enhancement','4dd0538','Mark Emlyn David Thomas','2013-08-27 06:18:08','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55383 Improve markup and design of the Tomcat 8 documentation webapp. Patch provided by Konstantin Preißer.','build.xml\nwebapps/docs/images/docs-stylesheet.css\nwebapps/docs/images/tomcat.png\nwebapps/docs/tomcat-docs.xsl'),(139,55469,'Bug 55469 – Missing HTML closing tags in Manager application','','2013-08-22 20:05:22','Larry Shatzer, jr.','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Manager','P2 trivial','9a22360','Violeta Georgieva Georgieva','2013-08-23 02:34:50','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55469 tr and td tags for UPLOAD_SECTION where not properly closed','java/org/apache/catalina/manager/HTMLManagerServlet.java'),(140,55439,'Bug 55439 – \'catalina.sh stop -force\' doesn\'t account for empty pid file','When CATALINA_PID is provided to \'catalina.sh stop -force\', but the script doesn\'t have permission to remove the file, the script instead clears the CATALINA_PID file\'s contents. The subsequent code for \'-force\' doesn\'t account for this and attempts to call kill an empty PID argument, leading to spurious error messages.','2013-08-16 21:40:18','David Minor','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Packaging','P2 minor','cd329e3','Mark Emlyn David Thomas','2013-08-20 15:07:25','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55439 Don\'t try a forced stop (kill -9 $PID) if Tomcat has already been stopped and the PID file cleared else a bunch of errors will result. Additionally, improve handling in a forced stop of situation when the PID file can be written to  but not deleted.','bin/catalina.sh'),(141,55454,'Bug 55454 – NullPointerException caused by invalid contentType, e.g. trailing semicolon','possible related to 53353\n\nWhen having an invalid contenttype like:\n<jsp:directive.page language=\"java\" contentType=\"text/html;\"/>\n(note the trailing \";\") Tomcat throws a NullPointerException like this:\n\njava.lang.NullPointerException\n	org.apache.tomcat.util.http.parser.HttpParser.parseMediaType(HttpParser.java:217)\n	org.apache.tomcat.util.http.parser.MediaTypeCache.parse(MediaTypeCache.java:54)\n	org.apache.catalina.connector.Response.setContentType(Response.java:805)\n	org.apache.catalina.connector.ResponseFacade.setContentType(ResponseFacade.java:245)\n	javax.servlet.ServletResponseWrapper.setContentType(ServletResponseWrapper.java:123)\n\nAfter removing the extra \";\" or entering a charset like this:\n<jsp:directive.page language=\"java\" contentType=\"text/html; charset=UTF-8\"/>\nit works as expected.\n\nMy desired behaviour would be:\nDon\'t crash with a NPE.\nOther Tomcat versions seem to handly this different.','2013-08-20 09:30:09','Christian','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','8b03dcf','Violeta Georgieva Georgieva','2013-08-20 11:02:23','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55454 Fixed NPE thrown when parsing an invalid content type.','java/org/apache/tomcat/util/http/parser/HttpParser.java\ntest/org/apache/tomcat/util/http/parser/TestMediaType.java'),(142,55442,'Bug 55442 – EL Constructor throws exception','In the EL 3.0 Spec, section 1.22.3 \"Constructor Reference\"  states \"A class name reference, followed by arguments in parenthesis, such as \"Boolean(true)\" denotes the invocation of the constructor of the class with the supplied arguments.\"\n\nThis leads me to believe that the following test should work:\n\n   @Test\n   public void testImport03() {\n   	ELProcessor processor = new ELProcessor();\n       Object result =\n               processor.getValue(\"Integer(\'1000\')\",\n                       Integer.class);\n       Assert.assertEquals(Integer.valueOf(1000), result);\n   }\n\nUnfortunately, this fails with the following error.\n\njavax.el.ELException: Function \':Integer\' not found\n	at org.apache.el.parser.AstFunction.getValue(AstFunction.java:136)\n	at org.apache.el.ValueExpressionImpl.getValue(ValueExpressionImpl.java:188)\n	at javax.el.ELProcessor.getValue(ELProcessor.java:45)\n	at org.apache.el.parser.TestAstIdentifier.testImport03(TestAstIdentifier.java:53)\n…\n\nThanks','2013-08-17 13:39:06','Daniel Mikusa','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','EL','P2 normal','ab70f07','Violeta Georgieva Georgieva','2013-08-20 04:38:29','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55442 Handle calls to a constructor of an imported class or to a static method, imported statically. Unit test based on a patch provided by Daniel Mikusa.','java/org/apache/el/parser/AstFunction.java\ntest/org/apache/el/parser/TestAstFunction.java'),(143,55438,'Bug 55438 – Non Blocking API\'s onAllDataRead being called twice','','2013-08-16 18:51:10','Daniel Mikusa','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 minor','7f6ea48','Mark Emlyn David Thomas','2013-08-19 10:54:15','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55438 Don\'t call onAllDataRead() twice for an empty request body. Make the non-blocking test more robust as on client disconnect the error may occur in the read or the write listener. Unit test provided by Daniel Mikusa.','java/org/apache/catalina/connector/InputBuffer.java\njava/org/apache/catalina/connector/Request.java\njava/org/apache/coyote/Request.java\ntest/org/apache/catalina/nonblocking/TestNonBlockingAPI.java'),(144,55434,'Bug 55434 – The path /foo/a/a/bar causes IllegalArgumentException when WsServerContainer creates UriTemplate','WsFilter calls WsServerContainer.findMapping(\"/foo/a/a/bar\"), which in turn calls new UriTemplate(path). If the path contains repeated segments, it causes the following code in the UriTemplate constructor to throw an exception:\n\nSegment old =\n        this.segments.put(segment, new Segment(index, segment));\nif (old != null) {\n    throw new IllegalArgumentException(\n            sm.getString(\"uriTemplate.duplicateName\", segment));\n}\n\nThis would be valid if the duplicates were URI variable names but not when their plain path segments.','2013-08-16 17:31:48','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','98ee5b4','Mark Emlyn David Thomas','2013-08-18 14:14:36','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55434 Ensure only duplicate parameters rather than duplicate segements trigger an error.','java/org/apache/tomcat/websocket/server/LocalStrings.properties\njava/org/apache/tomcat/websocket/server/UriTemplate.java\nres/findbugs/filter-false-positives.xml\ntest/org/apache/tomcat/websocket/server/TestUriTemplate.java'),(145,55399,'Bug 55399 – Request English but Response Spanish Language (Default Locale)','== Server: Windows, Language: es_ES\n== Client: Linux, Language: en_US\n\n== Request:\n\nPOST /xxxxxx HTTP/1.1\nHost: x.x.x.x:8080\nAccept: */*\nAccept-Language: en\nContent-Length: 0\nContent-Type: application/x-www-form-urlencoded\n\n== Response:\n\nHTTP/1.1 400 Petición incorrecta\nServer: Apache-Coyote/1.1\nContent-Type: text/html;charset=ISO-8859-1\nContent-Length: 1030\nDate: Sat, 10 Aug 2013 17:25:17 GMT\nConnection: close\n\n...cut...\n\n---\n\nHTTP Response \"Petición incorrecta\" must be in English. Right?\n\nI tried to do response.setLocale() workarround in the Servlet but neither works:\n\n---\nprotected void doPost(HttpServletRequest request, HttpServletResponse response)\n	throws ServletException, IOException {\n// ...\n	response.setLocale(Locale.ENGLISH); // Locale.US neither\n// ...\n	response.sendError(HttpServletResponse.SC_BAD_REQUEST, \"BAD REQUEST\");\n}\n---\n\nHttpServletResponse.setLocale() don\'t honors?','2013-08-10 17:50:55','Guillermo Grandes','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','c2f3617','Mark Emlyn David Thomas','2013-08-15 16:51:38','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55399 Have the message in the response line use the locale set for the response.','java/org/apache/coyote/ajp/AbstractAjpProcessor.java\njava/org/apache/coyote/http11/AbstractOutputBuffer.java\njava/org/apache/coyote/spdy/SpdyProcessor.java\njava/org/apache/tomcat/util/http/HttpMessages.java'),(146,55354,'Bug 55354 – JNDIRealm.getPrincipal(context,username,gssCredential) corrupts realm context','The getPrincipal(context,username,gssCredential) method in JNDIRealm is designed to allow delegated credentials to be applied to the directory server connection as part of SPNEGO authentication.\n\nThis is done by manipulation of a number of the directory context\'s environment parameters.\n\nHowever, as currently implemented, these environment parameters are forcibly cleared after the getUser() call regardless of whether the values were even changed (i.e. if isUseDelegatedCredential() returned false).\n\nIf the container realm is defined to use GSSAPI authentication, only the first SPNEGO authentication request will succeed.  All subsequent requests will fail with this exception:\njavax.naming.NamingException: [LDAP: error code 1 - 000004DC: LdapErr: DSID-0C0906DC, comment: In order to perform this operation a successful bind must be completed on the connection., data 0, v1db0 \n\nThe exception is due to the Context.SECURITY_AUTHENTICATION being cleared by getPrincipal() - resulting in a attempted \"simple\" bind with no username/password (i.e. anonymous).\n\nA workaround is to ensure that the connectionName and connectionPassword parameters are specified in the realm definition - however, if one is using GSSAPI - this shouldn\'t be necessary and certainly defeats the purpose of using GSSAPI in the first place.\n\nThe code should preserve pre-existing environment parameters in the context before changing them, then restore those values afterwards - rather than just clearing the settings completely.','2013-08-05 02:53:29','Richard Begg','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','135e2c4','Violeta Georgieva Georgieva','2013-08-15 16:31:48','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55354 Restore the context environment parameters after associating the Principle with the given user. Based on patch provided by Richard Begg.','java/org/apache/catalina/realm/JNDIRealm.java'),(147,55314,'Bug 55314 – Provide option to allow programmatic deployment of server (WebSocket) endpoint at runtime','','2013-07-26 16:24:12','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','d61a1dc','Mark Emlyn David Thomas','2013-08-15 15:19:59','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55314 Provide a container specific extension to the WsServerContainer to allow frameworks to more easily diaptch requests to WebSocket endpoints.','java/org/apache/tomcat/websocket/server/UpgradeUtil.java\njava/org/apache/tomcat/websocket/server/WsFilter.java\njava/org/apache/tomcat/websocket/server/WsServerContainer.java'),(148,55399,'Bug 55399 – Request English but Response Spanish Language (Default Locale)','== Server: Windows, Language: es_ES\n== Client: Linux, Language: en_US\n\n== Request:\n\nPOST /xxxxxx HTTP/1.1\nHost: x.x.x.x:8080\nAccept: */*\nAccept-Language: en\nContent-Length: 0\nContent-Type: application/x-www-form-urlencoded\n\n== Response:\n\nHTTP/1.1 400 Petición incorrecta\nServer: Apache-Coyote/1.1\nContent-Type: text/html;charset=ISO-8859-1\nContent-Length: 1030\nDate: Sat, 10 Aug 2013 17:25:17 GMT\nConnection: close\n\n...cut...\n\n---\n\nHTTP Response \"Petición incorrecta\" must be in English. Right?\n\nI tried to do response.setLocale() workarround in the Servlet but neither works:\n\n---\nprotected void doPost(HttpServletRequest request, HttpServletResponse response)\n	throws ServletException, IOException {\n// ...\n	response.setLocale(Locale.ENGLISH); // Locale.US neither\n// ...\n	response.sendError(HttpServletResponse.SC_BAD_REQUEST, \"BAD REQUEST\");\n}\n---\n\nHttpServletResponse.setLocale() don\'t honors?','2013-08-10 17:50:55','Guillermo Grandes','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','07d1c18','Mark Emlyn David Thomas','2013-08-15 10:47:20','Partial fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=55399 Base i18n of error reports on request locale rather than default server local.','java/org/apache/catalina/valves/ErrorReportValve.java'),(149,55357,'Bug 55357 – Cannot deserialize session when it contains Externalizable objects (using PersistentManager)','I\'m using PersistentManager with JDBCStore to store sessions in my database. But in my webapplication, there is an object in my session which is an instance of org.apache.el.MethodExpressionImpl. This class implements the Externalizable interface but in this readExternal method it uses org.apache.el.util.ReflectionUtil.forName(String) which use Thread.currentThread().getContextClassLoader() as its ClassLoader.\n\nIt seems to be incorrect because this method return a StandardClassLoader which cannot find my classes in WEB-INF/lib directory of my webapp.\n\nIs it the problem of the MethodExpressionImpl class which use this method or the JDBCStore which does not set the thread contextClassLoader as the WebappClassLoader ?\n\nHere is the stacktrace :\n\nSEVERE: Error processing request\njava.lang.IllegalStateException: Erreur lors de la désérialisation de la session 1634C328D27A31CB9FC4D52392FDB05F: {1}\n	at org.apache.catalina.session.PersistentManagerBase.swapIn(PersistentManagerBase.java:713)\n	at org.apache.catalina.session.PersistentManagerBase.findSession(PersistentManagerBase.java:503)\n	at org.apache.catalina.connector.Request.isRequestedSessionIdValid(Request.java:2391)\n	at org.apache.catalina.connector.CoyoteAdapter.parseSessionCookiesId(CoyoteAdapter.java:954)\n	at org.apache.catalina.connector.CoyoteAdapter.postParseRequest(CoyoteAdapter.java:688)\n	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:402)\n	at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1002)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:585)\n	at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:312)\n	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n	at java.lang.Thread.run(Thread.java:722)\nCaused by: java.lang.ClassNotFoundException: javax.faces.event.ActionEvent\n	at java.net.URLClassLoader$1.run(URLClassLoader.java:366)\n	at java.net.URLClassLoader$1.run(URLClassLoader.java:355)\n	at java.security.AccessController.doPrivileged(Native Method)\n	at java.net.URLClassLoader.findClass(URLClassLoader.java:354)\n	at java.lang.ClassLoader.loadClass(ClassLoader.java:423)\n	at java.lang.ClassLoader.loadClass(ClassLoader.java:356)\n	at java.lang.Class.forName0(Native Method)\n	at java.lang.Class.forName(Class.java:266)\n	at org.apache.el.util.ReflectionUtil.forName(ReflectionUtil.java:62)\n	at org.apache.el.util.ReflectionUtil.toTypeArray(ReflectionUtil.java:88)\n	at org.apache.el.MethodExpressionImpl.readExternal(MethodExpressionImpl.java:290)\n	at java.io.ObjectInputStream.readExternalData(ObjectInputStream.java:1835)\n	at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1794)\n	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1348)\n	at java.io.ObjectInputStream.readObject(ObjectInputStream.java:370)\n	at com.sun.facelets.el.TagMethodExpression.readExternal(TagMethodExpression.java:101)\n	at java.io.ObjectInputStream.readExternalData(ObjectInputStream.java:1835)\n	at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1794)\n	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1348)\n	at java.io.ObjectInputStream.readArray(ObjectInputStream.java:1704)\n	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1342)\n	at java.io.ObjectInputStream.defaultReadFields(ObjectInputStream.java:1989)\n	at java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:1913)\n	at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1796)\n	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1348)\n	at java.io.ObjectInputStream.readObject(ObjectInputStream.java:370)\n	at java.util.ArrayList.readObject(ArrayList.java:733)\n	at sun.reflect.GeneratedMethodAccessor90.invoke(Unknown Source)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n	at java.lang.reflect.Method.invoke(Method.java:601)\n	at java.io.ObjectStreamClass.invokeReadObject(ObjectStreamClass.java:1004)\n	at java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:1891)\n	at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1796)\n	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1348)\n	at java.io.ObjectInputStream.readArray(ObjectInputStream.java:1704)\n	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1342)\n	at java.io.ObjectInputStream.readArray(ObjectInputStream.java:1704)\n	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1342)\n	at java.io.ObjectInputStream.readArray(ObjectInputStream.java:1704)\n	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1342)\n	at java.io.ObjectInputStream.readArray(ObjectInputStream.java:1704)\n	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1342)\n	at java.io.ObjectInputStream.readArray(ObjectInputStream.java:1704)\n	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1342)\n	at java.io.ObjectInputStream.readArray(ObjectInputStream.java:1704)\n	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1342)\n	at java.io.ObjectInputStream.readArray(ObjectInputStream.java:1704)\n	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1342)\n	at java.io.ObjectInputStream.readArray(ObjectInputStream.java:1704)\n	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1342)\n	at java.io.ObjectInputStream.readArray(ObjectInputStream.java:1704)\n	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1342)\n	at java.io.ObjectInputStream.readArray(ObjectInputStream.java:1704)\n	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1342)\n	at java.io.ObjectInputStream.readArray(ObjectInputStream.java:1704)\n	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1342)\n	at java.io.ObjectInputStream.readArray(ObjectInputStream.java:1704)\n	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1342)\n	at java.io.ObjectInputStream.readArray(ObjectInputStream.java:1704)\n	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1342)\n	at java.io.ObjectInputStream.defaultReadFields(ObjectInputStream.java:1989)\n	at java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:1913)\n	at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1796)\n	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1348)\n	at java.io.ObjectInputStream.readObject(ObjectInputStream.java:370)\n	at java.util.HashMap.readObject(HashMap.java:1155)\n	at sun.reflect.GeneratedMethodAccessor89.invoke(Unknown Source)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n	at java.lang.reflect.Method.invoke(Method.java:601)\n	at java.io.ObjectStreamClass.invokeReadObject(ObjectStreamClass.java:1004)\n	at java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:1891)\n	at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1796)\n	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1348)\n	at java.io.ObjectInputStream.readObject(ObjectInputStream.java:370)\n	at java.util.HashMap.readObject(HashMap.java:1155)\n	at sun.reflect.GeneratedMethodAccessor89.invoke(Unknown Source)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n	at java.lang.reflect.Method.invoke(Method.java:601)\n	at java.io.ObjectStreamClass.invokeReadObject(ObjectStreamClass.java:1004)\n	at java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:1891)\n	at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1796)\n	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1348)\n	at java.io.ObjectInputStream.defaultReadFields(ObjectInputStream.java:1989)\n	at java.io.ObjectInputStream.defaultReadObject(ObjectInputStream.java:499)\n	at org.ajax4jsf.application.AjaxStateHolder.readObject(AjaxStateHolder.java:204)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n	at java.lang.reflect.Method.invoke(Method.java:601)\n	at java.io.ObjectStreamClass.invokeReadObject(ObjectStreamClass.java:1004)\n	at java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:1891)\n	at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1796)\n	at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1348)\n	at java.io.ObjectInputStream.readObject(ObjectInputStream.java:370)\n	at org.apache.catalina.session.StandardSession.readObject(StandardSession.java:1595)\n	at org.apache.catalina.session.StandardSession.readObjectData(StandardSession.java:1060)\n	at org.apache.catalina.session.JDBCStore.load(JDBCStore.java:657)\n	at org.apache.catalina.session.PersistentManagerBase.swapIn(PersistentManagerBase.java:707)\n	... 11 more','2013-08-05 15:15:18','Maxime Falaize','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 major','e19e794','Violeta Georgieva Georgieva','2013-08-15 10:06:20','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55357 Set the web app classloader as a context classloader before reading the object data.','java/org/apache/catalina/session/FileStore.java\njava/org/apache/catalina/session/JDBCStore.java'),(150,55381,'Bug 55381 – Issue with the Non Blocking API & TestNonBlockingAPI test','Looking at the the NBReadServlet class included in TestNonBlockingAPI, the class appears to be directly calling the ReadListener.onDataAvailable() method.\n\n@WebServlet(asyncSupported = true)\npublic class NBReadServlet extends TesterServlet {\n   private static final long serialVersionUID = 1L;\n   public volatile TestReadListener listener;\n   @Override\n   protected void service(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n       // step 1 - start async\n       AsyncContext actx = req.startAsync();\n       actx.setTimeout(Long.MAX_VALUE);\n       actx.addListener(new AsyncListener() {\n           // removed for brevity \n       });\n       // step 2 - notify on read\n       ServletInputStream in = req.getInputStream();\n       listener = new TestReadListener(actx);\n       in.setReadListener(listener);\n\n       listener.onDataAvailable();\n   }\n}\n\nIn Section 3.7 of the spec it says...\n\n\"The onDataAvailable method is invoked on the ReadListener when data is available to read from the incoming request stream. The container will invoke the method the first time when data is available to read. The container will subsequently invoke the onDataAvailable method if and only if isReady method on ServletInputStream, described below, returns false.\"\n\n...which leads me to believe that the container should be calling onDataAvailable and not the servlet.\n\nIf the line \"listener.onDataAvailable()\" is removed from the test, then the test will hang and ReadListener.onDataAvailable() is never called.\n\n\nThe same is true with the NBWriteServlet in TestNonBlockingAPI and the WriteListener.onWritePossible() method.  The NBWriteServlet is calling this method directly, while the spec seems to indicate that it should be called by the container.\n\n\"void onWritePossible(). When a WriteListener is registered with the ServletOutputStream, this method will be invoked by the container the first time when it is possible to write data. The container will subsequently invoke the onWritePossible method if and only if isReady method on ServletOutputStream, described below, returns false.\"\n\nThanks','2013-08-07 19:17:49','Daniel Mikusa','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','bda4eee','Mark Emlyn David Thomas','2013-08-15 07:31:03','Partial fix for BZ 55381 and OSX','java/org/apache/coyote/http11/AbstractHttp11Processor.java'),(151,55400,'Bug 55400 – WsFilter not compatible with async sample applications','','2013-08-10 20:20:50','Jeremy Boynes','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','WebSocket','P2 normal','3490f73','Mark Emlyn David Thomas','2013-08-14 08:29:03','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55400 WsFilter needs to be marked as supporting async else it prevents apps from using async requests.','java/org/apache/tomcat/websocket/server/WsServerContainer.java'),(152,55381,'Bug 55381 – Issue with the Non Blocking API & TestNonBlockingAPI test','Looking at the the NBReadServlet class included in TestNonBlockingAPI, the class appears to be directly calling the ReadListener.onDataAvailable() method.\n\n@WebServlet(asyncSupported = true)\npublic class NBReadServlet extends TesterServlet {\n   private static final long serialVersionUID = 1L;\n   public volatile TestReadListener listener;\n   @Override\n   protected void service(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n       // step 1 - start async\n       AsyncContext actx = req.startAsync();\n       actx.setTimeout(Long.MAX_VALUE);\n       actx.addListener(new AsyncListener() {\n           // removed for brevity \n       });\n       // step 2 - notify on read\n       ServletInputStream in = req.getInputStream();\n       listener = new TestReadListener(actx);\n       in.setReadListener(listener);\n\n       listener.onDataAvailable();\n   }\n}\n\nIn Section 3.7 of the spec it says...\n\n\"The onDataAvailable method is invoked on the ReadListener when data is available to read from the incoming request stream. The container will invoke the method the first time when data is available to read. The container will subsequently invoke the onDataAvailable method if and only if isReady method on ServletInputStream, described below, returns false.\"\n\n...which leads me to believe that the container should be calling onDataAvailable and not the servlet.\n\nIf the line \"listener.onDataAvailable()\" is removed from the test, then the test will hang and ReadListener.onDataAvailable() is never called.\n\n\nThe same is true with the NBWriteServlet in TestNonBlockingAPI and the WriteListener.onWritePossible() method.  The NBWriteServlet is calling this method directly, while the spec seems to indicate that it should be called by the container.\n\n\"void onWritePossible(). When a WriteListener is registered with the ServletOutputStream, this method will be invoked by the container the first time when it is possible to write data. The container will subsequently invoke the onWritePossible method if and only if isReady method on ServletOutputStream, described below, returns false.\"\n\nThanks','2013-08-07 19:17:49','Daniel Mikusa','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','1b1f86c','Mark Emlyn David Thomas','2013-08-13 17:47:36','Poller may return an error value with or without a value that matches a registered event. Use i18n for debug messages. Make debug messages consistent. Add new debug message to show what events poller returned. Improvements while working on a fix for BZ 55381.','java/org/apache/tomcat/util/net/AprEndpoint.java\njava/org/apache/tomcat/util/net/res/LocalStrings.properties'),(153,55404,'Bug 55404 – ContextConfig#validateSecurityRoles emits three info log messages which contain a warning','','2013-08-12 13:09:52','Michael Osipov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','df02b95','Mark Emlyn David Thomas','2013-08-12 10:27:33','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55404 Log warnings as warnings','java/org/apache/catalina/startup/ContextConfig.java\njava/org/apache/catalina/startup/LocalStrings.properties'),(154,55381,'Bug 55381 – Issue with the Non Blocking API & TestNonBlockingAPI test','Looking at the the NBReadServlet class included in TestNonBlockingAPI, the class appears to be directly calling the ReadListener.onDataAvailable() method.\n\n@WebServlet(asyncSupported = true)\npublic class NBReadServlet extends TesterServlet {\n   private static final long serialVersionUID = 1L;\n   public volatile TestReadListener listener;\n   @Override\n   protected void service(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n       // step 1 - start async\n       AsyncContext actx = req.startAsync();\n       actx.setTimeout(Long.MAX_VALUE);\n       actx.addListener(new AsyncListener() {\n           // removed for brevity \n       });\n       // step 2 - notify on read\n       ServletInputStream in = req.getInputStream();\n       listener = new TestReadListener(actx);\n       in.setReadListener(listener);\n\n       listener.onDataAvailable();\n   }\n}\n\nIn Section 3.7 of the spec it says...\n\n\"The onDataAvailable method is invoked on the ReadListener when data is available to read from the incoming request stream. The container will invoke the method the first time when data is available to read. The container will subsequently invoke the onDataAvailable method if and only if isReady method on ServletInputStream, described below, returns false.\"\n\n...which leads me to believe that the container should be calling onDataAvailable and not the servlet.\n\nIf the line \"listener.onDataAvailable()\" is removed from the test, then the test will hang and ReadListener.onDataAvailable() is never called.\n\n\nThe same is true with the NBWriteServlet in TestNonBlockingAPI and the WriteListener.onWritePossible() method.  The NBWriteServlet is calling this method directly, while the spec seems to indicate that it should be called by the container.\n\n\"void onWritePossible(). When a WriteListener is registered with the ServletOutputStream, this method will be invoked by the container the first time when it is possible to write data. The container will subsequently invoke the onWritePossible method if and only if isReady method on ServletOutputStream, described below, returns false.\"\n\nThanks','2013-08-07 19:17:49','Daniel Mikusa','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','f3c12ec','Mark Emlyn David Thomas','2013-08-08 17:09:00','Switch the logic around in preparation for a fix for BZ 55381','java/org/apache/tomcat/util/net/NioEndpoint.java'),(155,52092,'Bug 52092 – Please make AsyncFileHandler and OneLineFormatter the default for logging.properties','Apache Tomcat 7 has created some very important enhancements to logging, and we should exploit them. Please make the org.apache.juli.AsyncFileHandler and org.apache.juli.OneLineFormatter the defaults for shipped conf/logging.properties.\n\nThese enhancements have been vetted with over 20 releases of Apache Tomcat, let\'s give them some first class status.','2011-10-26 11:49:26','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Packaging','P2 enhancement','7d0408e','Mark Emlyn David Thomas','2013-08-07 17:14:55','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52092 Switch to the AsyncLogWriter and OneLineFormatter by default','conf/logging.properties\njava/org/apache/juli/FileHandler.java\nwebapps/docs/changelog.xml'),(156,48550,'Bug 48550 – Update examples and default server.xml to use UTF-8','','2010-01-14 13:52:03','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Examples','P2 enhancement','8d5c19a','Mark Emlyn David Thomas','2013-08-07 16:07:15','Part of fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=48550 Make sure Servlets that could output UTF-8 mark the content as UTF-8. I think I found all the places where this needed to be changed. The other possible places involve HTTP headers so must be ISO-8859-1.','webapps/examples/WEB-INF/classes/SessionExample.java'),(157,48550,'Bug 48550 – Update examples and default server.xml to use UTF-8','','2010-01-14 13:52:03','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Examples','P2 enhancement','9e0c50f','Mark Emlyn David Thomas','2013-08-07 16:00:51','Part of fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=48550 Make sure JSPs that could output UTF-8 mark the content as UTF-8. I think I found all the places where this needed to be changed.','webapps/examples/jsp/cal/cal1.jsp\nwebapps/examples/jsp/cal/cal2.jsp\nwebapps/examples/jsp/jsp2/el/functions.jsp\nwebapps/examples/jsp/jsp2/el/implicit-objects.jsp'),(158,48550,'Bug 48550 – Update examples and default server.xml to use UTF-8','','2010-01-14 13:52:03','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Examples','P2 enhancement','84b357e','Mark Emlyn David Thomas','2013-08-07 15:37:39','Part of fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=48550 Enable the character encoding filter for the examples web-app with UTF-8.','webapps/examples/WEB-INF/web.xml'),(159,48550,'Bug 48550 – Update examples and default server.xml to use UTF-8','','2010-01-14 13:52:03','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Examples','P2 enhancement','bfa967e','Mark Emlyn David Thomas','2013-08-07 15:20:51','Part of fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=48550 Change the default URIEncoding for all connectors to UTF-8.','java/org/apache/catalina/connector/Connector.java\nwebapps/docs/changelog.xml\nwebapps/docs/config/ajp.xml\nwebapps/docs/config/http.xml\nwebapps/docs/config/systemprops.xml'),(160,45428,'Bug 45428 – warn if the tomcat stop doesn\'t complete','my linux distro\'s \"/etc/init.d/tomcat stop\" roughly after 30 secs kill the tomcat process.\n\nThis probably relates to some web-app owned threads that wait and thus are no longer seen been by the manager.\n\nSince this is probably a hint about an application-internal software-engineering problem.\n\n\nTherefore, my suggestion:\n\nIf after ~ 15 secs (or some heuristic depending on the number of listeners configured by server.xml) the manager still couldn\'t really stop, print the stack-traces of the threads left to catalina.out (~ equivalent of \"kill -QUIT\")','2008-07-18 00:54:36','Ralf Hauser','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P3 enhancement','f5d18d7','Mark Emlyn David Thomas','2013-08-07 14:44:32','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45428 Trigger a thread dump to aid diagnostics if Tomcat fails to stop in a timely manner.','bin/catalina.sh'),(161,55372,'Bug 55372 – Bind JPDA_ADDRESS by default to localhost','The default setting of JPDA_ADDRESS=8000 poses some security risk. In many corporate environments daily or weekly security scans are normal.\n\nPeople, like me, sometimes forget to shutdown Tomcat in debug mode. Port 8000 is open to anyone.\n\nDefault JPDA_ADDRESS should be changed to localhost:8000 to minimize security scan reports and possible VM hijacks.\n\nSince this is a breaking change, this can be done for Tomcat 8.','2013-08-06 19:16:14','Michael Osipov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 enhancement','43ec4a5','Mark Emlyn David Thomas','2013-08-07 03:53:09','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55372 Make listening on localhost only be the default when enabling jpda.','bin/catalina.bat'),(162,55372,'Bug 55372 – Bind JPDA_ADDRESS by default to localhost','The default setting of JPDA_ADDRESS=8000 poses some security risk. In many corporate environments daily or weekly security scans are normal.\n\nPeople, like me, sometimes forget to shutdown Tomcat in debug mode. Port 8000 is open to anyone.\n\nDefault JPDA_ADDRESS should be changed to localhost:8000 to minimize security scan reports and possible VM hijacks.\n\nSince this is a breaking change, this can be done for Tomcat 8.','2013-08-06 19:16:14','Michael Osipov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 enhancement','6f2e8cf','Mark Emlyn David Thomas','2013-08-06 17:24:34','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55372 Listen on localhost only be default when enabling jpda.','bin/catalina.sh\nwebapps/docs/changelog.xml'),(163,55345,'Bug 55345 – Webresources class AbstractResourceSet throws exception upon callong ServletContext.getRealPath(\"\")','As described on user list:\n\nTomcat 8, unlike Tomcat 7.0.42, throws IllegalArgumentException upon calling ServletContext.getRealPath(\"\"). It seems that TC8 expects that argument provided to getRealPath is non-empty string.\n\nI believe that ServletContext.getRealPath should allow empty string as argument.\n\n-Ognjen\n\n\nStack trace:\n\n[ERROR] java.lang.IllegalArgumentException\njava.lang.IllegalArgumentException\n        at org.apache.catalina.webresources.AbstractResourceSet.checkPath(AbstractResourceSet.java:39)\n        at org.apache.catalina.webresources.DirResourceSet.getResource(DirResourceSet.java:91)\n        at org.apache.catalina.webresources.StandardRoot.getResourceInternal(StandardRoot.java:176)\n        at org.apache.catalina.webresources.CachedResource.validate(CachedResource.java:62)\n        at org.apache.catalina.webresources.Cache.getResource(Cache.java:78)\n        at org.apache.catalina.webresources.StandardRoot.getResource(StandardRoot.java:163)\n        at org.apache.catalina.core.StandardContext.getRealPath(StandardContext.java:4528)\n        at org.apache.catalina.core.ApplicationContext.getRealPath(ApplicationContext.java:398)\n        at org.apache.catalina.core.ApplicationContextFacade.getRealPath(ApplicationContextFacade.java:335)\n        at org.apache.axis2.deployment.WarBasedAxisConfigurator.<init>(WarBasedAxisConfigurator.java:103)\n        at org.apache.axis2.transport.http.AxisServlet.initConfigContext(AxisServlet.java:584)\n        at org.apache.axis2.transport.http.AxisServlet.init(AxisServlet.java:454)\n        at org.apache.catalina.core.StandardWrapper.initServlet(StandardWrapper.java:1235)\n        at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1148)\n        at org.apache.catalina.core.StandardWrapper.load(StandardWrapper.java:1044)\n        at org.apache.catalina.core.StandardContext.loadOnStartup(StandardContext.java:5025)\n        at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5322)\n        at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)\n        at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:726)\n        at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:702)\n        at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:698)\n        at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:968)\n        at org.apache.catalina.startup.HostConfig$DeployWar.run(HostConfig.java:1742)\n        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)\n        at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)\n        at java.util.concurrent.FutureTask.run(FutureTask.java:166)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:724)','2013-08-02 11:52:04','Ognjen Blagojevic','Tomcat Developers Mailing List','CLOSED FIXED','Tomcat 8','Catalina','P2 regression','aa15bac','Mark Emlyn David Thomas','2013-08-02 16:05:43','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55345 Handle ServletContext.getRealPath(\"\") in the same way for tc8 as for earlier versions.','java/org/apache/catalina/core/StandardContext.java'),(164,55336,'Bug 55336 – Cannot start apache tomcat 7.0 if server path contains two consecutive spaces.','Today, I tried to start apache tomcat 7.0.42 in Linux environment. Server path contains two consecutive spaces. When I run ./catalina.sh run, server cannot start and there is the following exception in console\n\n./catalina.sh run\nUsing CATALINA_BASE:   /home/example/twoconsecutive  spaces\nUsing CATALINA_HOME:   /home/example/twoconsecutive  spaces\nUsing CATALINA_TMPDIR: /home/example/twoconsecutive  spaces/temp\nUsing JRE_HOME:        /home/example/java/jdk1.6\nUsing CLASSPATH:       /home/example/twoconsecutive spaces/bin/bootstrap.jar:/home/example/twoconsecutive spaces/bin/tomcat-juli.jar\nException in thread \"main\" java.lang.NoClassDefFoundError: org/apache/catalina/startup/Bootstrap\nCaused by: java.lang.ClassNotFoundException: org.apache.catalina.startup.Bootstrap\n    at java.net.URLClassLoader$1.run(URLClassLoader.java:202)\n    at java.security.AccessController.doPrivileged(Native Method)\n    at java.net.URLClassLoader.findClass(URLClassLoader.java:190)\n    at java.lang.ClassLoader.loadClass(ClassLoader.java:306)\n    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)\n    at java.lang.ClassLoader.loadClass(ClassLoader.java:247)\nCould not find the main class: org.apache.catalina.startup.Bootstrap.  Program will exit.\n\nTomcat server can start if  server path does not contain consecutive space.','2013-08-01 05:00:34','TRAN Trung-Thanh','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','af3d7b1','Mark Emlyn David Thomas','2013-08-01 06:40:18','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55336 Correctly quote parameters passed to eval','bin/catalina.sh'),(165,55333,'Bug 55333 – JDBCRealm Digest authentication Flow is not working throws Function sequence error','Issue: Digest authentication flow is not working\nError Thrown : Function sequence error\n\nPackageName: org.apache.catalina.realm\nClassName : JDBCRealm\nMethodName: String getPassword(String username)\n\nSnapshot from above mentioned method\n===================================\n stmt = credentials(dbConnection, username);\n rs = stmt.executeQuery();\n // Due to this connection commit,  resultset is nullified \n dbConnection.commit();\n \n // While executing this statement it throws Function sequence error\n if (rs.next()) {\n    dbCredentials = rs.getString(1);\n }\n\n===================================\n\nAbove explanation has been validate by placing 7.0.41 catalina.jar where the above changes are not there due to fix of 55071 bug\n \n\nBelow snapshot is the error observed while trying for Digest authentication\n========================================================================== \n\nJul 31, 2013 3:43:40 PM org.apache.catalina.realm.JDBCRealm getPassword\n\nSEVERE: Exception performing authentication\n\njava.sql.SQLException: [TimesTen][TimesTen 11.2.2.5.0 ODBC Driver]Function sequence error\n\n    at com.timesten.jdbc.JdbcOdbc.createSQLException(JdbcOdbc.java:3238)\n\n    at com.timesten.jdbc.JdbcOdbc.standardError(JdbcOdbc.java:3387)\n\n    at com.timesten.jdbc.JdbcOdbc.SQLFetch(JdbcOdbc.java:921)\n\n    at com.timesten.jdbc.JdbcOdbcResultSet.next(JdbcOdbcResultSet.java:409)\n\n    at org.apache.catalina.realm.JDBCRealm.getPassword(JDBCRealm.java:558)\n\n    at org.apache.catalina.realm.RealmBase.getDigest(RealmBase.java:1189)\n\n    at org.apache.catalina.realm.RealmBase.authenticate(RealmBase.java:409)\n\n    at com.kodiak.digest.authentication.KnDigestAuthenticator$KnDigestInfo.authenticate(KnDigestAuthenticator.java:733)\n\n    at com.kodiak.digest.authentication.KnDigestAuthenticator.authenticate(KnDigestAuthenticator.java:275)\n\n    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:574)\n\n    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:953)\n\n    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:171)\n\n    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99)\n\n    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)\n\n    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:408)\n\n    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1023)\n\n    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:589)\n\n    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:312)\n\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n\n    at java.lang.Thread.run(Thread.java:724)\n\n \n\nJul 31, 2013 3:43:40 PM org.apache.catalina.realm.JDBCRealm getPassword\n\nSEVERE: Exception performing authentication\n\njava.sql.SQLException: [TimesTen][TimesTen 11.2.2.5.0 ODBC Driver]Function sequence error\n\n    at com.timesten.jdbc.JdbcOdbc.createSQLException(JdbcOdbc.java:3238)\n\n    at com.timesten.jdbc.JdbcOdbc.standardError(JdbcOdbc.java:3387)\n\n    at com.timesten.jdbc.JdbcOdbc.SQLFetch(JdbcOdbc.java:921)\n\n    at com.timesten.jdbc.JdbcOdbcResultSet.next(JdbcOdbcResultSet.java:409)\n\n    at org.apache.catalina.realm.JDBCRealm.getPassword(JDBCRealm.java:558)\n\n    at org.apache.catalina.realm.RealmBase.getDigest(RealmBase.java:1189)\n\n    at org.apache.catalina.realm.RealmBase.authenticate(RealmBase.java:409)\n\n\"localhost.2013-07-31.log\" 50L, 3800C         \n\nCheers,\nMahaaboob','2013-07-31 17:44:41','Shaik Mahaaboob Basha','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 blocker','6cd42af','Mark Emlyn David Thomas','2013-08-01 06:13:31','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55333 Correct regression in fix for bug 55071. Don\'t commit the connection until after the ResultSet has been used.','java/org/apache/catalina/realm/JDBCRealm.java'),(166,55071,'Bug 55071 – try finally catch structure masks original exception in JDBCRealm.getPassword()','I have run into a mysterious apparent SQL exception in JDBCRealm.getPassword().\n\nPresumably, line 557 \"stmt.executeQuery()\" occasionally fails. I\'m not sure why and would like to know why. \n\nHowever, the finally block contains dbConnection.commit() (line 579). This throws an exception (Connection Closed) which is then logged on line 585. \n\nIn summary, line 579 should be surrounded by a try catch.','2013-06-06 22:26:48','bruce weertman','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','6cd42af','Mark Emlyn David Thomas','2013-08-01 06:13:31','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55333 Correct regression in fix for bug 55071. Don\'t commit the connection until after the ResultSet has been used.','java/org/apache/catalina/realm/JDBCRealm.java'),(167,55331,'Bug 55331 – Dispatch after async timeout fails','With Tomcat 7.0.42 and the NIO connector, calling AsyncContext.dispatch() from an onTimeout() handler fails with this error message:\n\njul 31, 2013 1:40:30 PM org.apache.coyote.AbstractProtocol$AbstractConnectionHandler process\nSEVERE: Error reading request, ignored\njava.lang.IllegalStateException: Calling [asyncPostProcess()] is not valid for a request with Async state [STARTED]\n        at org.apache.coyote.AsyncStateMachine.asyncPostProcess(AsyncStateMachine.java:204)\n        at org.apache.coyote.AbstractProcessor.asyncPostProcess(AbstractProcessor.java:116)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:593)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1690)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:724)\n\n\nTest code:\n\npublic class AsyncServlet extends HttpServlet {\n\n  protected void doGet(final HttpServletRequest request, HttpServletResponse response)\n      throws ServletException, IOException {\n\n    if (request.isAsyncStarted()) {\n      response.getWriter().write(\"asyncResult=\" + request.getAttribute(\"asyncResult\"));\n    }\n    else {\n      final AsyncContext asyncContext = request.startAsync(request, response);\n\n      asyncContext.addListener(new AsyncListener() {\n        public void onTimeout(AsyncEvent event) throws IOException {\n            request.setAttribute(\"asyncResult\", \"timeout\\n\");\n            asyncContext.dispatch();\n        }\n        public void onStartAsync(AsyncEvent event) throws IOException {}\n        public void onError(AsyncEvent event) throws IOException {}\n        public void onComplete(AsyncEvent event) throws IOException {}\n      });\n\n      asyncContext.setTimeout(5000L);\n    }\n  }\n\n}\n\n\nThis seems somewhat similar to the (ancient) report #50308.','2013-07-31 11:50:09','Peter De Wachter','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','a2f27f7','Mark Emlyn David Thomas','2013-08-01 05:46:15','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55331 A disatch to an async servlet during the onTimeout method of an async listener should not trigger an ISE.','java/org/apache/coyote/AsyncStateMachine.java\ntest/org/apache/catalina/core/TestAsyncContextImpl.java'),(168,55331,'Bug 55331 – Dispatch after async timeout fails','With Tomcat 7.0.42 and the NIO connector, calling AsyncContext.dispatch() from an onTimeout() handler fails with this error message:\n\njul 31, 2013 1:40:30 PM org.apache.coyote.AbstractProtocol$AbstractConnectionHandler process\nSEVERE: Error reading request, ignored\njava.lang.IllegalStateException: Calling [asyncPostProcess()] is not valid for a request with Async state [STARTED]\n        at org.apache.coyote.AsyncStateMachine.asyncPostProcess(AsyncStateMachine.java:204)\n        at org.apache.coyote.AbstractProcessor.asyncPostProcess(AbstractProcessor.java:116)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:593)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1690)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:724)\n\n\nTest code:\n\npublic class AsyncServlet extends HttpServlet {\n\n  protected void doGet(final HttpServletRequest request, HttpServletResponse response)\n      throws ServletException, IOException {\n\n    if (request.isAsyncStarted()) {\n      response.getWriter().write(\"asyncResult=\" + request.getAttribute(\"asyncResult\"));\n    }\n    else {\n      final AsyncContext asyncContext = request.startAsync(request, response);\n\n      asyncContext.addListener(new AsyncListener() {\n        public void onTimeout(AsyncEvent event) throws IOException {\n            request.setAttribute(\"asyncResult\", \"timeout\\n\");\n            asyncContext.dispatch();\n        }\n        public void onStartAsync(AsyncEvent event) throws IOException {}\n        public void onError(AsyncEvent event) throws IOException {}\n        public void onComplete(AsyncEvent event) throws IOException {}\n      });\n\n      asyncContext.setTimeout(5000L);\n    }\n  }\n\n}\n\n\nThis seems somewhat similar to the (ancient) report #50308.','2013-07-31 11:50:09','Peter De Wachter','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','a5c8f42','Mark Emlyn David Thomas','2013-08-01 04:59:18','Refactor test with a view to extending it to cover bug 55331. No functional change to this point.','test/org/apache/catalina/core/TestAsyncContextImpl.java'),(169,55316,'Bug 55316 – Ugly error log when WS client disconnects unexpectedly','When a WS browser client disconnects unexpectedly (e.g. in the SNake sample if the user just closes the browser or loads another page) you get ugle ERROR logs in the Tomcat server.  E.g.\n\n2013-07-27 12:04:34.424 ERROR 31847 --- [nio-8080-exec-7] org.apache.tomcat.websocket.WsSession    : Failed to send close message to remote endpoint\n\njava.io.IOException: java.util.concurrent.ExecutionException: java.io.EOFException\n	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.startMessageBlock(WsRemoteEndpointImplBase.java:221)\n	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:466)\n	at org.apache.tomcat.websocket.WsSession.onClose(WsSession.java:430)\n	at org.apache.tomcat.websocket.server.WsHttpUpgradeHandler.close(WsHttpUpgradeHandler.java:172)\n	at org.apache.tomcat.websocket.server.WsHttpUpgradeHandler.access$200(WsHttpUpgradeHandler.java:45)\n	at org.apache.tomcat.websocket.server.WsHttpUpgradeHandler$WsReadListener.onDataAvailable(WsHttpUpgradeHandler.java:198)\n	at org.apache.coyote.http11.upgrade.AbstractServletInputStream.onDataAvailable(AbstractServletInputStream.java:169)\n	at org.apache.coyote.http11.upgrade.AbstractProcessor.upgradeDispatch(AbstractProcessor.java:95)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:630)\n	at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1585)\n	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1543)\n	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n	at java.lang.Thread.run(Thread.java:724)\nCaused by: java.util.concurrent.ExecutionException: java.io.EOFException\n	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase$FutureToSendHandler.get(WsRemoteEndpointImplBase.java:779)\n	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.startMessageBlock(WsRemoteEndpointImplBase.java:217)\n	... 14 common frames omitted\nCaused by: java.io.EOFException: null\n	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doClose(WsRemoteEndpointImplServer.java:126)\n	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.close(WsRemoteEndpointImplBase.java:531)\n	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.onWritePossible(WsRemoteEndpointImplServer.java:107)\n	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:71)\n	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:353)\n	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.startMessage(WsRemoteEndpointImplBase.java:254)\n	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.startMessageBlock(WsRemoteEndpointImplBase.java:211)\n	... 14 common frames omitted\n\n\nPresumably this is expected to be relatively normal, so I\'d expect a lot less noise (and no ERROR) in the log?','2013-07-27 11:07:08','Dave Syer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','d370084','Mark Emlyn David Thomas','2013-07-31 10:41:55','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55316 Log IO errors with client at debug. Client may simply have gone away.','java/org/apache/tomcat/websocket/WsSession.java'),(170,55314,'Bug 55314 – Provide option to allow programmatic deployment of server (WebSocket) endpoint at runtime','','2013-07-26 16:24:12','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','7ecee3f','Mark Emlyn David Thomas','2013-07-31 10:17:08','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55314 Provide a configuration option to bypass the specification restriction on not being able to add endpoints prgrammatically once the first endpoint has started a handshake.','java/org/apache/tomcat/websocket/Constants.java\njava/org/apache/tomcat/websocket/server/Constants.java\njava/org/apache/tomcat/websocket/server/WsServerContainer.java\nwebapps/docs/config/systemprops.xml\nwebapps/docs/web-socket-howto.xml'),(171,55312,'Bug 55312 – No SCI scan in embedded Tomcat','I like the fact that SCI scanning is off by default in a Tomcat embedded instance, but I\'d lik eto be able to switch it on. It might even be possible already, but the API is non-obvious.  Maybe a method in Tomcat or associated friendly helper?\n\nWould also be nice in Tomcat 7.','2013-07-26 15:37:46','Dave Syer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','7540e90','Mark Emlyn David Thomas','2013-07-31 09:13:10','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55312 Ensure that class path entries representing directories are always scanned for matches to @HandlesTypes','java/org/apache/tomcat/util/scan/StandardJarScanner.java\nwebapps/docs/config/jar-scan-filter.xml\nwebapps/docs/config/jar-scanner.xml'),(172,55309,'Bug 55309 – Concurrent issue of TagPluginManager','','2013-07-26 04:38:23','Sheldon Shao','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 regression','11c05b7','Mark Emlyn David Thomas','2013-07-29 16:55:45','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55309 Fix concurrency issue in TagPluginManager PageInfo should not be a field as it is per page and there will be conflicts with concurrent compilations. Patch provided by Sheldon Shao.','java/org/apache/jasper/compiler/TagPluginManager.java'),(173,55319,'Bug 55319 – FragmentJarScannerCallback does not set isWebapp','The callback that handles scanning files rather than JARs does not set isWebapp or delegate.','2013-07-28 23:26:00','Jeremy Boynes','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Util','P2 normal','ecec088','Jeremy Boynes','2013-07-28 19:45:37','Ensure the JasperInitializer is used when running tests. This led to discovery of 55319 but otherwise has no impact at this time. However, when we handle TLD processing from the SCI then this will be needed.','build.xml\ntest/META-INF/services/javax.servlet.ServletContainerInitializer\ntest/org/apache/jasper/servlet/TestJasperInitializer.java'),(174,55319,'Bug 55319 – FragmentJarScannerCallback does not set isWebapp','The callback that handles scanning files rather than JARs does not set isWebapp or delegate.','2013-07-28 23:26:00','Jeremy Boynes','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Util','P2 normal','85b8e1f','Jeremy Boynes','2013-07-28 19:38:09','Fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=55319','java/org/apache/tomcat/util/descriptor/web/FragmentJarScannerCallback.java'),(175,55287,'Bug 55287 – ServletContainerInitializer in parent classloader may not be found','To include the JasperInitializer in the test environment I added an entry in testclasses/META-INF/services. This is not picked up when the parent classloader is searched because this path is a directory not a JAR file. \n\nIt would be picked up if the \"scanAllDirectories\" extension was enabled but that should not be necessary if the search is to be semantically equivalent to j.u.ServiceLoader (which does locate it).','2013-07-21 20:44:47','Jeremy Boynes','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','6e514c0','Jeremy Boynes','2013-07-28 19:01:23','Fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=55287','java/org/apache/catalina/startup/ContextConfig.java\njava/org/apache/catalina/startup/WebappServiceLoader.java\ntest/org/apache/catalina/startup/TestWebappServiceLoader.java'),(176,55297,'Bug 55297 – Have daemon.sh look for jsvc in CATALINA_HOME as well as CATALINA_BASE','Since jsvc is a standard executable, it would be good if daemon.sh could search for it in its usual location in $CATALINA_HOME/bin/jsvc.  It currently looks for it in CATALINA_BASE only:\n\ntest \".$JSVC\" = . && JSVC=\"$CATALINA_BASE/bin/jsvc\"','2013-07-23 08:31:11','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Integration','P2 normal','47ba36d','Mark Emlyn David Thomas','2013-07-25 15:23:33','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55297 Look in CATALINA_HOME for jsvc if it isn\'t specified and isn\'t found in CATALINA_BASE','bin/daemon.sh'),(177,55267,'Bug 55267 – NIO thread locked','Did some load test and thread got stuck, see dump.\n\nBasically I just simulate 100 users that connect and disconnect.','2013-07-15 11:38:25','Pavel','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 normal','11bf498','Mark Emlyn David Thomas','2013-07-23 10:21:38','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55267 Separate read and write timeout for NIO and ensure that the write timeout is always the connection timeout configured in the connector. This prevents long Comet timeouts (which are intended for read operations) being used for writes which - particularly in error conditions - can cause long delays. Since only NIO supports comet timeouts this change is only required in NIO.','java/org/apache/coyote/ajp/AjpNioProcessor.java\njava/org/apache/coyote/http11/InternalNioOutputBuffer.java\njava/org/apache/coyote/http11/upgrade/NioServletOutputStream.java\njava/org/apache/tomcat/util/net/NioEndpoint.java'),(178,55268,'Bug 55268 – daemon.sh only waits for 10 seconds','I\'m trying to use daemon.sh to start tomcat, but it passes a wait value of 10 seconds to jsvc.  Tomcat does still start up ok, but the shell script\'s return code is 1, which is causing my puppet script to fail.\n\nIt would be useful if this could be parameterised so that I can choose a time suitable for my webapps.','2013-07-15 15:38:58','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','7bb0451','Christopher Schultz','2013-07-22 19:19:49','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55268 - Replace uses of \"test -z\" with \"test \".$FOO\" = .\" for better shell compatibility','bin/daemon.sh'),(179,55291,'Bug 55291 – Bug in WsServerContainer leading to NPE','','2013-07-22 13:33:53','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','ab6f21d','Violeta Georgieva Georgieva','2013-07-22 10:26:57','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55291 Avoid NPE when registering a session. Patch provided by rstoyanchev.','java/org/apache/tomcat/websocket/server/WsServerContainer.java'),(180,55262,'Bug 55262 – Duplicate preludes and codas in same <jsp-property-group> are ignored','If a <jsp-property-group> contains multiple <include-prelude> elements that happen to refer to the same file only one include is performed. The same applies to codas.\n\nThis happens because WebXml stores these in a LinkedHashSet rather than a List.\n\nWhen multiple <jsp-property-group>s are combined, JspConfig uses a Vector and so preserves duplicates as required by the JSP spec.\n\nI have a test case demonstrating this but before committing a fix I would like confirmation that WebXml\'s behaviour is incorrect.','2013-07-14 01:44:18','Jeremy Boynes','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Util','P2 minor','85f611e','Jeremy Boynes','2013-07-20 16:46:58','Fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=55262 Duplicate prelude and coda entries in same <jsp-property-group> are preserved.','java/org/apache/tomcat/util/descriptor/web/JspPropertyGroup.java\ntest/org/apache/jasper/compiler/TestCompiler.java\ntest/org/apache/jasper/servlet/TestJspCServletContext.java\ntest/org/apache/tomcat/util/descriptor/web/TestJspPropertyGroup.java\ntest/webapp/WEB-INF/web.xml\ntest/webapp/bug5nnnn/bug55262-coda.jspf\ntest/webapp/bug5nnnn/bug55262-prelude.jspf\ntest/webapp/bug5nnnn/bug55262.jsp'),(181,55285,'Bug 55285 – Collections returned from JspConfigDescriptor are not isolated','The JavaDoc for JspConfigDescriptor getTagLibs() and getJspPropertyGroups(0 requires \"Any changes to the returned Collection must not affect this JspConfigDescriptor.\" This also applies to Collections returned from these collections (e.g. preludes).\n\nTomcat returns a reference to the internal collection and mutations are not isolated.','2013-07-20 18:58:20','Jeremy Boynes','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','1fcd015','Jeremy Boynes','2013-07-20 16:22:41','Fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=55285 Have JspConfigDescriptor related classes clone collections when returning them to application code. As ContextConfig can no longer mutate the config stored in StandardContext, add a setter to Context to provide a fully configured JspConfigDescriptor','java/org/apache/catalina/Context.java\njava/org/apache/catalina/core/ApplicationContext.java\njava/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/startup/ContextConfig.java\njava/org/apache/catalina/startup/FailedContext.java\njava/org/apache/catalina/startup/TldConfig.java\njava/org/apache/tomcat/util/descriptor/web/JspConfigDescriptorImpl.java\njava/org/apache/tomcat/util/descriptor/web/JspPropertyGroupDescriptorImpl.java\njava/org/apache/tomcat/util/descriptor/web/WebXml.java\ntest/org/apache/catalina/core/TestApplicationContext.java\ntest/org/apache/catalina/core/TesterContext.java\ntest/org/apache/tomcat/util/descriptor/web/TestJspConfigDescriptorImpl.java\ntest/org/apache/tomcat/util/descriptor/web/TestJspPropertyGroupDescriptorImpl.java'),(182,55285,'Bug 55285 – Collections returned from JspConfigDescriptor are not isolated','The JavaDoc for JspConfigDescriptor getTagLibs() and getJspPropertyGroups(0 requires \"Any changes to the returned Collection must not affect this JspConfigDescriptor.\" This also applies to Collections returned from these collections (e.g. preludes).\n\nTomcat returns a reference to the internal collection and mutations are not isolated.','2013-07-20 18:58:20','Jeremy Boynes','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','a05ec14','Jeremy Boynes','2013-07-20 15:00:17','Add disabled testcase for #55285','test/org/apache/catalina/core/TestApplicationContext.java'),(183,55268,'Bug 55268 – daemon.sh only waits for 10 seconds','I\'m trying to use daemon.sh to start tomcat, but it passes a wait value of 10 seconds to jsvc.  Tomcat does still start up ok, but the shell script\'s return code is 1, which is causing my puppet script to fail.\n\nIt would be useful if this could be parameterised so that I can choose a time suitable for my webapps.','2013-07-15 15:38:58','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','7afad75','Christopher Schultz','2013-07-16 15:51:00','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55268','bin/daemon.sh'),(184,55259,'Bug 55259 – Unnecessary work in JspConfig','JspProperty is the same for all url patterns in a group; the current code creates a new one each iteration','2013-07-13 04:34:34','Jeremy Boynes','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Jasper','P2 trivial','c6a45a6','Jeremy Boynes','2013-07-13 18:07:49','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55259 JspProperty is the same for all patterns so only create once.','java/org/apache/jasper/compiler/JspConfig.java'),(185,55245,'Bug 55245 – Add test cases for JspC','The test suite should include tests for the JspC Ant task','2013-07-12 02:05:02','Jeremy Boynes','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Jasper','P2 enhancement','c0c5017','Mark Emlyn David Thomas','2013-07-12 04:58:10','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55245 Add JspC test cases. Patch by Jeremy Boynes.','test/org/apache/jasper/TestJspC.java\nwebapps/docs/changelog.xml'),(186,55250,'Bug 55250 – JspC does not initialize tldLocationsCache resulting in NPE','Change in how ServletContext was created missed initialization of tldLocationsCache','2013-07-12 03:37:02','Jeremy Boynes','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Jasper','P2 normal','186a782','Mark Emlyn David Thomas','2013-07-12 04:50:45','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55250 Fix JspC refactoring - tldLocationsCache not created Patch by Jeremy Boynes','java/org/apache/jasper/JspC.java'),(187,55244,'Bug 55244 – JspC throws ClassNotFoundException from Digester','','2013-07-12 02:01:45','Jeremy Boynes','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Jasper','P2 normal','8d6537d','Mark Emlyn David Thomas','2013-07-12 04:36:14','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55244 Fix ClassNotFoundException with JspC Patch provided by Jeremy Boynes','java/org/apache/jasper/servlet/JspCServletContext.java\njava/org/apache/tomcat/util/descriptor/web/WebXmlParser.java'),(188,55240,'Bug 55240 – [websocket] SOE in NioEndpoint','','2013-07-11 11:54:55','Niki Dokovski','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','68f6f6f','Mark Emlyn David Thomas','2013-07-11 14:08:17','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55240 Prevent looping after Poller stop and ensure that streams for upgraded connections are closed if possible.','java/org/apache/coyote/http11/upgrade/AbstractProcessor.java\njava/org/apache/coyote/http11/upgrade/AprProcessor.java\njava/org/apache/coyote/http11/upgrade/BioProcessor.java\njava/org/apache/coyote/http11/upgrade/LocalStrings.properties\njava/org/apache/coyote/http11/upgrade/NioProcessor.java\njava/org/apache/tomcat/util/net/NioEndpoint.java'),(189,55238,'Bug 55238 – [websocket] NPE in clearHandler(WsRemoteEndpointImplServer.java:156)','','2013-07-11 08:11:07','Niki Dokovski','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','4758796','Mark Emlyn David Thomas','2013-07-11 12:14:59','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55238 Avoid possible NPE. Patch by Niki Dokovski. Also added a check to onTimeout() to save creating an Exception unnecessarily','java/org/apache/tomcat/websocket/server/WsRemoteEndpointImplServer.java'),(190,55228,'Bug 55228 – AbstractHttp11Processor overwrites Date header, even when set by application','','2013-07-10 00:35:33','fern@alum.mit.edu','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 major','95ee699','Mark Emlyn David Thomas','2013-07-11 11:58:31','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55228 Allow applications to set the Date header.','java/org/apache/coyote/http11/AbstractHttp11Processor.java'),(191,55233,'Bug 55233 – [websocket] Problem reading many subsequent binary messages','I have a test client that receives many binary messages. The server sends thousands of binary messages with size 1024 with no delay between them. At some point of time, the client fails to read the message and the connection is closed. See some close reasons below.\n\nI am wondering whether there is some issue with the read buffers being modified from other threads. \nSeeing all close reasons below, there are two issues here:\n- why there is buffer overflow when there is plenty of space to store the incoming data (e.g. \"unwrapping [1,130] bytes into a [8,192]\")\n- why there are attempts to unwrap bigger buffer into smaller one. I thought this should not be possible (e.g. \"unwrapping [12,466] bytes into a [8,192]\")\n\n\nHere are some close reasons occurred during the test:\nEnding test thread as websocket session is closed\nConnection closed: Buffer overflow unwrapping [6,466] bytes into a [8,192] byte buffer that already contained [0] bytes.\nEnding test thread as websocket session is closed\nConnection closed: Buffer overflow unwrapping [1,130] bytes into a [8,192] byte buffer that already contained [0] bytes.\nEnding test thread as websocket session is closed\nConnection closed: Buffer overflow unwrapping [2,240] bytes into a [8,192] byte buffer that already contained [0] bytes.\nEnding test thread as websocket session is closed\nConnection closed: Buffer overflow unwrapping [12,466] bytes into a [8,192] byte buffer that already contained [0] bytes.\nEnding test thread as websocket session is closed\nConnection closed: Buffer overflow unwrapping [2,071] bytes into a [8,192] byte buffer that already contained [0] bytes.\nEnding test thread as websocket session is closed\nConnection closed: Buffer overflow unwrapping [12,466] bytes into a [8,192] byte buffer that already contained [0] bytes.\nEnding test thread as websocket session is closed\nConnection closed: Buffer overflow unwrapping [4,356] bytes into a [8,192] byte buffer that already contained [0] bytes.\nEnding test thread as websocket session is closed\nConnection closed: Buffer overflow unwrapping [14,059] bytes into a [8,192] byte buffer that already contained [0] bytes.\nEnding test thread as websocket session is closed\nConnection closed: Buffer overflow unwrapping [4,707] bytes into a [8,192] byte buffer that already contained [0] bytes.\nEnding test thread as websocket session is closed\nConnection closed: Buffer overflow unwrapping [10,041] bytes into a [8,192] byte buffer that already contained [0] bytes.\nEnding test thread as websocket session is closed\nConnection closed: Buffer overflow unwrapping [2,478] bytes into a [8,192] byte buffer that already contained [0] bytes.','2013-07-10 14:31:48','Stoyan Boshev','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 major','8496b90','Mark Emlyn David Thomas','2013-07-11 06:25:06','Add a test case for bug 55233 that also uncovered a couple of bugs in the batching code.','test/org/apache/tomcat/websocket/TestWebSocketFrameClient.java\ntest/org/apache/tomcat/websocket/TestWsPingPongMessages.java\ntest/org/apache/tomcat/websocket/TestWsRemoteEndpoint.java\ntest/org/apache/tomcat/websocket/TestWsSubprotocols.java\ntest/org/apache/tomcat/websocket/TestWsWebSocketContainer.java\ntest/org/apache/tomcat/websocket/TesterFirehoseServer.java\ntest/org/apache/tomcat/websocket/TesterMessageCountClient.java\ntest/org/apache/tomcat/websocket/TesterSingleMessageClient.java'),(192,55233,'Bug 55233 – [websocket] Problem reading many subsequent binary messages','I have a test client that receives many binary messages. The server sends thousands of binary messages with size 1024 with no delay between them. At some point of time, the client fails to read the message and the connection is closed. See some close reasons below.\n\nI am wondering whether there is some issue with the read buffers being modified from other threads. \nSeeing all close reasons below, there are two issues here:\n- why there is buffer overflow when there is plenty of space to store the incoming data (e.g. \"unwrapping [1,130] bytes into a [8,192]\")\n- why there are attempts to unwrap bigger buffer into smaller one. I thought this should not be possible (e.g. \"unwrapping [12,466] bytes into a [8,192]\")\n\n\nHere are some close reasons occurred during the test:\nEnding test thread as websocket session is closed\nConnection closed: Buffer overflow unwrapping [6,466] bytes into a [8,192] byte buffer that already contained [0] bytes.\nEnding test thread as websocket session is closed\nConnection closed: Buffer overflow unwrapping [1,130] bytes into a [8,192] byte buffer that already contained [0] bytes.\nEnding test thread as websocket session is closed\nConnection closed: Buffer overflow unwrapping [2,240] bytes into a [8,192] byte buffer that already contained [0] bytes.\nEnding test thread as websocket session is closed\nConnection closed: Buffer overflow unwrapping [12,466] bytes into a [8,192] byte buffer that already contained [0] bytes.\nEnding test thread as websocket session is closed\nConnection closed: Buffer overflow unwrapping [2,071] bytes into a [8,192] byte buffer that already contained [0] bytes.\nEnding test thread as websocket session is closed\nConnection closed: Buffer overflow unwrapping [12,466] bytes into a [8,192] byte buffer that already contained [0] bytes.\nEnding test thread as websocket session is closed\nConnection closed: Buffer overflow unwrapping [4,356] bytes into a [8,192] byte buffer that already contained [0] bytes.\nEnding test thread as websocket session is closed\nConnection closed: Buffer overflow unwrapping [14,059] bytes into a [8,192] byte buffer that already contained [0] bytes.\nEnding test thread as websocket session is closed\nConnection closed: Buffer overflow unwrapping [4,707] bytes into a [8,192] byte buffer that already contained [0] bytes.\nEnding test thread as websocket session is closed\nConnection closed: Buffer overflow unwrapping [10,041] bytes into a [8,192] byte buffer that already contained [0] bytes.\nEnding test thread as websocket session is closed\nConnection closed: Buffer overflow unwrapping [2,478] bytes into a [8,192] byte buffer that already contained [0] bytes.','2013-07-10 14:31:48','Stoyan Boshev','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 major','e1c15a2','Mark Emlyn David Thomas','2013-07-11 06:11:56','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55233 Fixed buffer overflow error when a client needs to unwrap more encrypted data than the read buffer has space for. The fix is to increase the read buffer to the current maximum size of output expected by the SSL engine.','java/org/apache/tomcat/websocket/AsyncChannelWrapperSecure.java\njava/org/apache/tomcat/websocket/ReadBufferOverflowException.java\njava/org/apache/tomcat/websocket/WsFrameClient.java'),(193,55207,'Bug 55207 – In XML syntax, jsp:text does not error on sub-elements from other namespaces','','2013-07-07 01:11:30','Jeremy Boynes','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Jasper','P2 normal','6c54031','Mark Emlyn David Thomas','2013-07-10 15:29:26','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55207 Enforce requirement that <jsp:text> elements do not contain any other elements. Fix a test that this change found. Patch by Jeremy Boynes.','java/org/apache/jasper/compiler/JspDocumentParser.java\ntest/webapp/WEB-INF/tags/bug55198.tagx'),(194,55233,'Bug 55233 – [websocket] Problem reading many subsequent binary messages','I have a test client that receives many binary messages. The server sends thousands of binary messages with size 1024 with no delay between them. At some point of time, the client fails to read the message and the connection is closed. See some close reasons below.\n\nI am wondering whether there is some issue with the read buffers being modified from other threads. \nSeeing all close reasons below, there are two issues here:\n- why there is buffer overflow when there is plenty of space to store the incoming data (e.g. \"unwrapping [1,130] bytes into a [8,192]\")\n- why there are attempts to unwrap bigger buffer into smaller one. I thought this should not be possible (e.g. \"unwrapping [12,466] bytes into a [8,192]\")\n\n\nHere are some close reasons occurred during the test:\nEnding test thread as websocket session is closed\nConnection closed: Buffer overflow unwrapping [6,466] bytes into a [8,192] byte buffer that already contained [0] bytes.\nEnding test thread as websocket session is closed\nConnection closed: Buffer overflow unwrapping [1,130] bytes into a [8,192] byte buffer that already contained [0] bytes.\nEnding test thread as websocket session is closed\nConnection closed: Buffer overflow unwrapping [2,240] bytes into a [8,192] byte buffer that already contained [0] bytes.\nEnding test thread as websocket session is closed\nConnection closed: Buffer overflow unwrapping [12,466] bytes into a [8,192] byte buffer that already contained [0] bytes.\nEnding test thread as websocket session is closed\nConnection closed: Buffer overflow unwrapping [2,071] bytes into a [8,192] byte buffer that already contained [0] bytes.\nEnding test thread as websocket session is closed\nConnection closed: Buffer overflow unwrapping [12,466] bytes into a [8,192] byte buffer that already contained [0] bytes.\nEnding test thread as websocket session is closed\nConnection closed: Buffer overflow unwrapping [4,356] bytes into a [8,192] byte buffer that already contained [0] bytes.\nEnding test thread as websocket session is closed\nConnection closed: Buffer overflow unwrapping [14,059] bytes into a [8,192] byte buffer that already contained [0] bytes.\nEnding test thread as websocket session is closed\nConnection closed: Buffer overflow unwrapping [4,707] bytes into a [8,192] byte buffer that already contained [0] bytes.\nEnding test thread as websocket session is closed\nConnection closed: Buffer overflow unwrapping [10,041] bytes into a [8,192] byte buffer that already contained [0] bytes.\nEnding test thread as websocket session is closed\nConnection closed: Buffer overflow unwrapping [2,478] bytes into a [8,192] byte buffer that already contained [0] bytes.','2013-07-10 14:31:48','Stoyan Boshev','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 major','29a20ca','Mark Emlyn David Thomas','2013-07-10 15:03:59','Further improvements to error message to aid debugging https://issues.apache.org/bugzilla/show_bug.cgi?id=55233','java/org/apache/tomcat/websocket/AsyncChannelWrapperSecure.java\njava/org/apache/tomcat/websocket/LocalStrings.properties'),(195,55231,'Bug 55231 – NPE and incorrect version detection in JspC','JspC\'s JspConfig now reads version and jsp-config information from the ServletContext. \n\nIt uses getMajorVersion() which returns the maximum version supported by the container. It should use getEffectiveVersion() to use the version of the web application.\n\nServletContext.getJspConfigDescriptor() can return null if there is no <jsp-config> in the web.xml. JspConfig does not allow for this and will throw a NPE e.g. if there is no web.xml in the application.','2013-07-10 04:10:10','Jeremy Boynes','Tomcat Developers Mailing List','CLOSED FIXED','Tomcat 8','Jasper','P2 normal','c8376e8','Mark Emlyn David Thomas','2013-07-10 09:40:32','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55231 JSP capability should be based on effective version of webapp.','java/org/apache/jasper/compiler/JspConfig.java'),(196,55215,'Bug 55215 – Improvements to sample log4j configuration','','2013-07-08 17:58:14','Brian Burch','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Documentation','P2 minor','22a75f3','Mark Emlyn David Thomas','2013-07-10 07:53:43','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55215 Remove unnecessary period at the end of file names Use space around = in properties consistently. Based on a patch by Brian Burch.','webapps/docs/logging.xml'),(197,55221,'Bug 55221 – [websocket] Session is closed without notification','','2013-07-09 12:39:48','Stoyan Boshev','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','20cdbb1','Mark Emlyn David Thomas','2013-07-09 17:01:37','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55221 Truncate excessively long clean reasons before sending as control messages are strictly limited in length.','java/org/apache/tomcat/websocket/WsSession.java\ntest/org/apache/tomcat/websocket/TestWsSession.java'),(198,55221,'Bug 55221 – [websocket] Session is closed without notification','','2013-07-09 12:39:48','Stoyan Boshev','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','f9358ea','Mark Emlyn David Thomas','2013-07-09 16:21:35','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55221 Shorten message and make it more useful.','java/org/apache/tomcat/websocket/AsyncChannelWrapperSecure.java\njava/org/apache/tomcat/websocket/LocalStrings.properties'),(199,55171,'Bug 55171 – [jsr 356] All server threads become blocked after some websocket testing','','2013-07-01 11:52:32','Stoyan Boshev','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 critical','837e5c1','Mark Emlyn David Thomas','2013-07-09 16:08:08','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55171 Add a default timeout of 5s to all blocking writes and make the timeout user configurable.','java/org/apache/tomcat/websocket/WsRemoteEndpointImplBase.java\nwebapps/docs/web-socket-howto.xml'),(200,53737,'Bug 53737 – Use ServletContext.getJspConfigDescriptor() in Jasper instead of XML-parsing of merged web.xml','In Tomcat 7.0.29 in ContextConfig#webConfig() a merged web.xml file is serialized into String and is put as an attribute into ServletContext.\n\n[[[\n        String mergedWebXml = webXml.toXml();\n        sContext.setAttribute(\n               org.apache.tomcat.util.scan.Constants.MERGED_WEB_XML,\n               mergedWebXml);\n]]]\n\nThen in JspConfig#processWebDotXml() of Jasper it is parsed again from XML into objects.\n\nIt would be better to access the necessary configuration through Servlet 3.0 API methods such as ServletContext.getJspConfigDescriptor().','2012-08-18 00:54:55','Konstantin Kolinko','Tomcat Developers Mailing List','REOPENED','Tomcat 8','Jasper','P2 enhancement','4667010','Mark Emlyn David Thomas','2013-07-09 10:49:28','Fully fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53737 Enable Jasper to use information from the ServletContext rather than having to re-parse web.xml This commit re-adds the ability to parse web.xml to JspC but now using the same parser as Catalina. Includes extracts from patches by Jeremy Boynes and violetagg. Note: Fragment support is still TODO       The need for annotation support still needs to be reviewed.','java/org/apache/catalina/core/ApplicationJspConfigDescriptor.java\njava/org/apache/catalina/core/ApplicationJspPropertyGroupDescriptor.java\njava/org/apache/catalina/core/ApplicationTaglibDescriptor.java\njava/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/startup/ContextConfig.java\njava/org/apache/jasper/JspC.java\njava/org/apache/jasper/servlet/JspCServletContext.java\njava/org/apache/tomcat/util/descriptor/web/Constants.java\njava/org/apache/tomcat/util/descriptor/web/JspConfigDescriptorImpl.java\njava/org/apache/tomcat/util/descriptor/web/JspPropertyGroupDescriptorImpl.java\njava/org/apache/tomcat/util/descriptor/web/TaglibDescriptorImpl.java\nres/checkstyle/org-import-control.xml\ntest/org/apache/jasper/servlet/TestJspCServletContext.java'),(201,53737,'Bug 53737 – Use ServletContext.getJspConfigDescriptor() in Jasper instead of XML-parsing of merged web.xml','In Tomcat 7.0.29 in ContextConfig#webConfig() a merged web.xml file is serialized into String and is put as an attribute into ServletContext.\n\n[[[\n        String mergedWebXml = webXml.toXml();\n        sContext.setAttribute(\n               org.apache.tomcat.util.scan.Constants.MERGED_WEB_XML,\n               mergedWebXml);\n]]]\n\nThen in JspConfig#processWebDotXml() of Jasper it is parsed again from XML into objects.\n\nIt would be better to access the necessary configuration through Servlet 3.0 API methods such as ServletContext.getJspConfigDescriptor().','2012-08-18 00:54:55','Konstantin Kolinko','Tomcat Developers Mailing List','REOPENED','Tomcat 8','Jasper','P2 enhancement','5ef2855','Mark Emlyn David Thomas','2013-07-09 10:48:01','Re-apply r1377509 - the fix for bug 53737 that did not account for JspC','java/org/apache/jasper/compiler/JspConfig.java\njava/org/apache/jasper/compiler/TldLocationsCache.java\njava/org/apache/jasper/compiler/WebXml.java'),(202,55218,'Bug 55218 – Upgrade Digester to be based on DefaultHandler2 and use LexicalHandler to detect publicId','Digester uses SAX2 features but is still based the SAX1 DefaultHandler. By upgrading to DefaultHandler2 it would be able to handle baseURIs when resolving entities and would have a default implementation of a LexicalHandler.\n\nUsing LexicalHandler would allow it to respond directly to the startDTD event that reports the DOCTYPE (if present) so that it would not need to infer that from the first attempt to resolve an entity.','2013-07-09 07:27:23','Jeremy Boynes','Tomcat Developers Mailing List','CLOSED FIXED','Tomcat 8','Catalina','P2 enhancement','aa7896b','Mark Emlyn David Thomas','2013-07-09 06:07:23','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55218 and https://issues.apache.org/bugzilla/show_bug.cgi?id=55219 Upgrade digester to use DefaultHandler2 and use LexicalHandler to detect publicId. Simplify web application version detection in web.xml Extracted from a patch by Jeremy Boynes.','java/org/apache/catalina/core/StandardContext.java\njava/org/apache/tomcat/util/descriptor/web/LocalStrings.properties\njava/org/apache/tomcat/util/descriptor/web/WebXml.java\njava/org/apache/tomcat/util/digester/Digester.java\ntest/javax/servlet/resources/TestSchemaValidation.java\ntest/org/apache/tomcat/util/descriptor/web/TestWebXml.java'),(203,55219,'Bug 55219 – Simplify version detection in WebXml','WebXml has two ways of detecting the version of the web application. \n\nsetPublicId() handles all versions but only actually needs to deal with the DTD-based descriptors (2.2 and 2.3).\n\nsetVersion() treats the version attribute as a numeric value and parse out major and minor based on decimal values. However, each version of the spec defines a literal String that could be matched directly instead. It also only needs to handle XSD-based descriptors (2.4 and later).\n\nAs a minor note, the string id \"webxml.unrecognisedPublicId\" is inconsistent with other values (it has a lower case X)','2013-07-09 07:38:52','Jeremy Boynes','Tomcat Developers Mailing List','CLOSED FIXED','Tomcat 8','Catalina','P2 enhancement','aa7896b','Mark Emlyn David Thomas','2013-07-09 06:07:23','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55218 and https://issues.apache.org/bugzilla/show_bug.cgi?id=55219 Upgrade digester to use DefaultHandler2 and use LexicalHandler to detect publicId. Simplify web application version detection in web.xml Extracted from a patch by Jeremy Boynes.','java/org/apache/catalina/core/StandardContext.java\njava/org/apache/tomcat/util/descriptor/web/LocalStrings.properties\njava/org/apache/tomcat/util/descriptor/web/WebXml.java\njava/org/apache/tomcat/util/digester/Digester.java\ntest/javax/servlet/resources/TestSchemaValidation.java\ntest/org/apache/tomcat/util/descriptor/web/TestWebXml.java'),(204,55217,'Bug 55217 – Common EntityResolver that can be used by Catalina and Jasper','Duplicate functionality exists in both SchemaResolver and ParserUtils.MyEntityResolver. There\'s also a basic version in Digester.','2013-07-09 07:09:00','Jeremy Boynes','Tomcat Developers Mailing List','CLOSED FIXED','Tomcat 8','Catalina','P2 enhancement','5344de0','Mark Emlyn David Thomas','2013-07-09 04:51:17','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55217 Implement a common EntityResolver that can be used by Catalina and Jasper. Patch provided by Jeremy Boynes.','java/org/apache/tomcat/util/descriptor/LocalResolver.java\njava/org/apache/tomcat/util/descriptor/XmlIdentifiers.java\ntest/org/apache/tomcat/util/descriptor/TestLocalResolver.java'),(205,55166,'Bug 55166 – schemaLocation references between servlet and jsp XSDs are invalid','The javax/servlet/resources package does not contain the JSP specification XSDs. These are referenced from the web-app or web-common xsds and define elements like <jsp-config>.','2013-06-30 20:03:24','Jeremy Boynes','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 enhancement','f554475','Mark Emlyn David Thomas','2013-07-08 05:33:59','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55166 Move the JSP descriptor and tag library descriptor schema defintion files from jsp-api.jar to servlet-api.jar so relative includes between the J2EE, Servlet and JSP schemas are correctly resolved.','build.xml\njava/javax/servlet/jsp/resources/jsp_2_0.xsd\njava/javax/servlet/jsp/resources/jsp_2_1.xsd\njava/javax/servlet/jsp/resources/jsp_2_2.xsd\njava/javax/servlet/jsp/resources/jsp_2_3.xsd\njava/javax/servlet/jsp/resources/web-jsptaglibrary_1_1.dtd\njava/javax/servlet/jsp/resources/web-jsptaglibrary_1_2.dtd\njava/javax/servlet/jsp/resources/web-jsptaglibrary_2_0.xsd\njava/javax/servlet/jsp/resources/web-jsptaglibrary_2_1.xsd\njava/javax/servlet/resources/jsp_2_0.xsd\njava/javax/servlet/resources/jsp_2_1.xsd\njava/javax/servlet/resources/jsp_2_2.xsd\njava/javax/servlet/resources/jsp_2_3.xsd\njava/javax/servlet/resources/web-jsptaglibrary_1_1.dtd\njava/javax/servlet/resources/web-jsptaglibrary_1_2.dtd\njava/javax/servlet/resources/web-jsptaglibrary_2_0.xsd\njava/javax/servlet/resources/web-jsptaglibrary_2_1.xsd\njava/org/apache/catalina/startup/Constants.java\nres/META-INF/jsp-api.jar.license\nres/META-INF/jsp-api.jar.notice\nres/maven/tomcat-jsp-api.pom\nres/maven/tomcat-servlet-api.pom\nwebapps/docs/changelog.xml'),(206,55210,'Bug 55210 – SEVERE: The ServletContentInitializer [# Licensed to the Apache Software Foundation (ASF) under one or more] could not be created','','2013-07-07 21:44:14','Nick Williams','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 critical','b932ace','Violeta Georgieva Georgieva','2013-07-08 02:53:50','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55210 When searching for ServletContainerInitializer, ignore comments in the provider-configuration file. Support multiple ServletContainerInitializer in the provider-configuration file. Patch is provided by Nick Williams.','java/org/apache/catalina/startup/ContextConfig.java'),(207,55211,'Bug 55211 – Test tld descriptors do not validate','','2013-07-07 22:55:39','Jeremy Boynes','Tomcat Developers Mailing List','CLOSED FIXED','Tomcat 8','Catalina','P2 trivial','8c49d81','Violeta Georgieva Georgieva','2013-07-08 00:20:38','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55211 Fix namespace. Rename \"tagclass\" to \"tag-class\" in various tests tld files so that they become valid against the dtd/schema. Patch provided by Jeremy Boynes.','test/webapp-2.3/WEB-INF/tags12.tld\ntest/webapp-2.3/WEB-INF/tags20.tld\ntest/webapp-2.3/WEB-INF/tags21.tld\ntest/webapp-2.4/WEB-INF/tags20.tld\ntest/webapp-2.4/WEB-INF/tags21.tld\ntest/webapp-2.5/WEB-INF/tags20.tld\ntest/webapp-2.5/WEB-INF/tags21.tld\ntest/webapp-3.0/WEB-INF/tags20.tld\ntest/webapp-3.0/WEB-INF/tags21.tld\ntest/webapp-3.1/WEB-INF/tags20.tld\ntest/webapp-3.1/WEB-INF/tags21.tld'),(208,55205,'Bug 55205 – test/webapp web.xml does not validate','','2013-07-06 21:20:05','Jeremy Boynes','Tomcat Developers Mailing List','CLOSED FIXED','Tomcat 8','Catalina','P2 normal','e8dcbea','Violeta Georgieva Georgieva','2013-07-07 03:25:43','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55205 Reorder web.xml elements so that it becomes valid against the schema. Patch is provided by Jeremy Boynes.','test/webapp/WEB-INF/web.xml'),(209,55204,'Bug 55204 – Incorrect namespace URI test webapp','','2013-07-06 20:51:24','Jeremy Boynes','Tomcat Developers Mailing List','CLOSED FIXED','Tomcat 8','Catalina','P2 minor','0f2c930','Violeta Georgieva Georgieva','2013-07-07 01:36:33','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55204 Fix namespace. Patch provided by Jeremy Boynes','test/webapp-2.4/WEB-INF/web.xml'),(210,55200,'Bug 55200 – [websocket] Problem writing many subsequent binary messages','I see sometimes failing connections due to IOException (see below).\nThis happens when trying to send thousands of binary messages (1024 bytes each) without any delay between the subsequent messages.\n\nHaving look at the code in AsyncChannelWrapperSecure$WriteTask.run(219), I think it is not correct to assume that if not all of the bytes in the buffer are written, this shall produce IOException. I think in this case, there shall be an attempt to write the rest of the bytes in a cycle.\n\n\nHere one exception I got during the test:\nException is :java.io.IOException: java.util.concurrent.ExecutionException: java.io.IOException: Only wrote [460] of [1,098] bytes\n	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.startMessageBlock(WsRemoteEndpointImplBase.java:204)\n	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendBytes(WsRemoteEndpointImplBase.java:113)\n	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendBinary(WsRemoteEndpointBasic.java:43)\n	at WebsocketsTestManager$TestThread.run(WebsocketsTestManager.java:271)\nCaused by: java.util.concurrent.ExecutionException: java.io.IOException: Only wrote [460] of [1,098] bytes\n	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase$FutureToSendHandler.get(WsRemoteEndpointImplBase.java:729)\n	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.startMessageBlock(WsRemoteEndpointImplBase.java:202)\n	... 3 more\nCaused by: java.io.IOException: Only wrote [460] of [1,098] bytes\n	at org.apache.tomcat.websocket.AsyncChannelWrapperSecure$WriteTask.run(AsyncChannelWrapperSecure.java:220)\n	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n	at java.lang.Thread.run(Thread.java:789)','2013-07-05 14:27:48','Stoyan Boshev','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 major','00e4f3f','Mark Emlyn David Thomas','2013-07-05 13:22:06','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55200 It is possible that more than one write will be required to empty the buffer.','java/org/apache/tomcat/websocket/AsyncChannelWrapperSecure.java\njava/org/apache/tomcat/websocket/LocalStrings.properties'),(211,55198,'Bug 55198 – Quote entity in html element attribute evaluated in tagx if attribute contains EL expression','','2013-07-05 04:32:38','Evan Greensmith','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','8ec0d3b','Mark Emlyn David Thomas','2013-07-05 12:33:06','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55198 ELInterpreter needs to know if page was originally in XML','java/org/apache/jasper/compiler/Generator.java\ntest/org/apache/jasper/compiler/TestParser.java\ntest/webapp/WEB-INF/tags/bug55198.tagx\ntest/webapp/bug5nnnn/bug55198.jsp'),(212,55186,'Bug 55186 – useIPVHosts=true , incorrect to get Request.localName','','2013-07-03 00:54:24','Roger Wang','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 normal','2eb065f','Mark Emlyn David Thomas','2013-07-05 09:34:16','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55186 Ensure local name is recycled between requests so IP virtual hosting works correctly.','java/org/apache/coyote/Request.java'),(213,55184,'Bug 55184 – NPE in PojoMethodMapping getMessageHandler','','2013-07-02 13:14:35','Niki Dokovski','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','a267dbf','Mark Emlyn David Thomas','2013-07-02 12:45:16','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55184 Avoid NPE. Patch provided by Niki Dokovski.','java/org/apache/tomcat/websocket/pojo/PojoMethodMapping.java'),(214,55183,'Bug 55183 – Missing WS Protocol Header in session negotiatedHeaders','','2013-07-02 12:04:47','Niki Dokovski','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','a634d85','Mark Emlyn David Thomas','2013-07-02 12:13:13','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55183 Header names are case insensitive Based on a patch by Niki Dokovski.','java/org/apache/tomcat/websocket/Constants.java\njava/org/apache/tomcat/websocket/WsWebSocketContainer.java\ntest/org/apache/tomcat/websocket/TestWsSubprotocols.java'),(215,55171,'Bug 55171 – [jsr 356] All server threads become blocked after some websocket testing','','2013-07-01 11:52:32','Stoyan Boshev','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 critical','22b8c22','Mark Emlyn David Thomas','2013-07-02 09:27:46','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55171 If the client closed the connection, the write of any remainign data in the buffer in AbstractServletOutputStream would fail but the remote endpoint was not notified. This meant that blocking writes would block for ever eventually locking up the entire server.','java/org/apache/coyote/http11/upgrade/AbstractServletOutputStream.java\njava/org/apache/tomcat/websocket/WsRemoteEndpointImplBase.java\njava/org/apache/tomcat/websocket/server/WsHttpUpgradeHandler.java\njava/org/apache/tomcat/websocket/server/WsRemoteEndpointImplServer.java'),(216,55165,'Bug 55165 – subprotocols not available with  annotated serverendpoint','','2013-06-30 19:49:03','Niki Dokovski','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','b069c78','Mark Emlyn David Thomas','2013-07-02 05:40:26','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55165 Ensure sub-protocols are processed for annotated endpoint. Patch provided by Niki Dokovski.','java/org/apache/tomcat/websocket/server/WsServerContainer.java'),(217,55162,'Bug 55162 – Incorrect namespace URI test webapp','The test/webapp web.xml is using the Sun namespace for a 3.1 web-app rather than the JCP namespace.','2013-06-29 22:27:47','Jeremy Boynes','Tomcat Developers Mailing List','CLOSED FIXED','Tomcat 8','Catalina','P2 minor','bd47844','Mark Emlyn David Thomas','2013-07-02 05:35:07','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55162 Fix namespace Patch provided by Jeremy Boynes','test/webapp/WEB-INF/web.xml'),(218,55181,'Bug 55181 – Ping and Pong messages should have identical application data','','2013-07-02 08:01:55','Niki Dokovski','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','19c0bd3','Mark Emlyn David Thomas','2013-07-02 04:26:28','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55181 Protect against clients that ignore the limit of the byte buffer','java/org/apache/tomcat/websocket/WsPongMessage.java\ntest/org/apache/tomcat/websocket/TestWsPingPongMessages.java'),(219,55180,'Bug 55180 – connectionTimeout=\"-1\" causes timeout can\'t be negative','I configured server.xml like this:\nconnectionTimeout=\"-1\" disableUploadTimeout=\"false\" connectionUploadTimeout=\"200\"\n(maybe it is stupid to configure like this,if connectionTimeout=-1,can i make disableUploadTimeout=false?).\nIt will cause :\n\njava.lang.IllegalArgumentException: timeout can\'t be negative\n	at sun.nio.ch.SocketAdaptor.setSoTimeout(SocketAdaptor.java:361)\n	at org.apache.coyote.http11.Http11NioProcessor.setSocketTimeout(Http11NioProcessor.java:251)\n......\nbecause of :\n      if (!disableUploadTimeout) {\n//endpoint.getSoTimeout()=-1.\n           setSocketTimeout(endpoint.getSoTimeout());\n       }\n\n~~~~~~~~~~~~~~~~~~~~~~~~~\nanother thing:\nif i configure connectionTimeout=\"0\". \nin NioBlockingSelector.read(ByteBuffer buf, NioChannel socket, long readTimeout),readTimeout = 0, in case socket.read(buf) == 0, it make timeout=true.\nif (readTimeout >= 0 && (keycount == 0))\n    timedout = (System.currentTimeMillis() - time) >= readTimeout;\nthen throw the SocketTimeoutException().\n\nthank you.','2013-07-02 00:01:40','Roger Wang','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 normal','4da2de0','Violeta Georgieva Georgieva','2013-07-02 03:15:30','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55180 Correctly handle infinite soTimeout when disableUploadTimeout is set to false. Patch provided by Roger Wang.','java/org/apache/coyote/http11/AbstractHttp11Processor.java'),(220,55174,'Bug 55174 – [jsr 356][websocket] MessageHandler never gets notified again after it throws exception','I have a test which adds a MessageHandler which gets notified on text messages. If its implementation method onMessage(String text) throws some exception (e.g. runtime exception), this MessageHandler will never ever be notified again for any new text messages received by the session.\n\nI suppose this happens because the exception actually kills the underlying thread in which the notification has happened. I think the client side implementation shall be more robust and expect and be prepared for exceptions coming from calls to user code.','2013-07-01 12:14:30','Stoyan Boshev','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 major','ddd73d0','Mark Emlyn David Thomas','2013-07-01 18:08:06','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55174 WebSocket 1.0 Javadoc for Endpoint.onError states that it should be called for runtime errors in message handlers.','java/org/apache/tomcat/websocket/WsFrameBase.java'),(221,55179,'Bug 55179 – Incorrect Parameter Name in RemoteIpValve Examples','','2013-07-01 20:54:45','Shelley','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 normal','21f0a5c','Mark Emlyn David Thomas','2013-07-01 17:25:05','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55179 Correct attribute name.','java/org/apache/catalina/valves/RemoteIpValve.java'),(222,55176,'Bug 55176 – SSI regular expressions parsing fails','','2013-07-01 17:08:30','David Reitter','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','2f550b8','Mark Emlyn David Thomas','2013-07-01 17:18:57','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55176 SSI expression parser failed to correctly handle the use of an \'=\' character inside a regular expression. Includes a test case.','java/org/apache/catalina/ssi/ExpressionTokenizer.java\ntest/org/apache/catalina/ssi/TestExpressionParseTree.java'),(223,55176,'Bug 55176 – SSI regular expressions parsing fails','','2013-07-01 17:08:30','David Reitter','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','fd4e86f','Mark Emlyn David Thomas','2013-07-01 17:00:09','Add some basic SSI unit tests as preparation for some unit tests for bug 55176.','test/org/apache/catalina/ssi/TestExpressionParseTree.java'),(224,55177,'Bug 55177 – connectionTimeout=-1 causes high CPU','','2013-07-01 19:49:21','Nick Bunn','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 minor','df6cee7','Mark Emlyn David Thomas','2013-07-01 16:28:01','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55177 Correctly handle infinite soTimeout for BIO HTTP connector. Based on a patch by Nick Bunn.','java/org/apache/coyote/http11/Http11Processor.java'),(225,53777,'Bug 53777 – Ability to bundle JAAS Configuration in Webappp','','2012-08-24 13:50:52','eolivelli','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','6871d4c','Mark Emlyn David Thomas','2013-07-01 10:57:05','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53777 Enable instances of the JAAS Realm to specify a dedicated configuration file. This is likely to be of particular use when the realm is specified at the Context level.','java/org/apache/catalina/realm/JAASRealm.java\nwebapps/docs/config/realm.xml'),(226,54013,'Bug 54013 – Catalina.sh force kill to wait till process exits completely','','2012-10-16 09:21:49','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','8ceae2e','Mark Emlyn David Thomas','2013-07-01 10:34:27','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54013 Give forced stop a short period (5s) to complete before returning.','bin/catalina.sh'),(227,55160,'Bug 55160 – NIO connectionUploadTimeout can\'t work','when i configure disableUploadTimeout=\"false\" and connectionTimeout=\"20000\" ,connectionUploadTimeout=\"30000\" .\nI found the connectionUploadTimeout doesn\'t work, because the code in internalNioInputBuffer.readSocket():\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~\ntry {\n                NioEndpoint.KeyAttachment att = (NioEndpoint.KeyAttachment)socket.getAttachment(false);\n                if ( att == null ) throw new IOException(\"Key must be cancelled.\");\n                nRead = pool.read(socket.getBufHandler().getReadBuffer(),socket,selector,att.getTimeout());\n            } catch ( EOFException eof ) {\n                nRead = -1;\n            } finally { \n                if ( selector != null ) pool.put(selector);\n            }\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\natt.getTimeout() is the connectionTimeout ,not the connectionUploadTimeout.\nso , in NioBlockingSelector.read(), the readTimeout is connectionTimeout','2013-06-29 21:35:09','Roger Wang','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 normal','9a01f2d','Mark Emlyn David Thomas','2013-07-01 10:26:13','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55160 Retrieve timeout the same way it is set so that connectionUploadTimeout is applied if configured.','java/org/apache/coyote/http11/InternalNioInputBuffer.java'),(228,55158,'Bug 55158 – Wasted work in AttributeNamesEnumerator constructor','','2013-06-29 18:55:30','Adrian Nistor','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','ca956bd','Violeta Georgieva Georgieva','2013-07-01 08:26:02','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55158 Small performance improvement Patch provided by Adrian Nistor','java/org/apache/catalina/core/ApplicationHttpRequest.java'),(229,55173,'Bug 55173 – [jsr 356] Exception message typo error','In the exception below, the exception message seems to have a small typo error. \n\nconenction -> connection\n\n\njavax.websocket.DeploymentException: The HTTP request to initiate the WebSocket conenction failed\n        at org.apache.tomcat.websocket.WsWebSocketContainer.connectToServer(WsWebSocketContainer.java:383)\n        at org.apache.tomcat.websocket.WsWebSocketContainer.connectToServer(WsWebSocketContainer.java:232)\n        at org.apache.tomcat.websocket.WsWebSocketContainer.connectToServer(WsWebSocketContainer.java:199)\n        at com.sap.cloud.sample.helloworld.WebsocketsTestManager$TestThread.run(WebsocketsTestManager.java:259)\nCaused by: java.util.concurrent.ExecutionException: java.util.concurrent.ExecutionException: java.io.IOException: The specified network name is no longer available.\n\n        at org.apache.tomcat.websocket.AsyncChannelWrapperSecure$WrapperFuture.get(AsyncChannelWrapperSecure.java:466)\n        at org.apache.tomcat.websocket.WsWebSocketContainer.processResponse(WsWebSocketContainer.java:593)\n        at org.apache.tomcat.websocket.WsWebSocketContainer.connectToServer(WsWebSocketContainer.java:366)\n        ... 3 more\nCaused by: java.util.concurrent.ExecutionException: java.io.IOException: The specified network name is no longer available.\n\n        at sun.nio.ch.PendingFuture.get(PendingFuture.java:185)\n        at org.apache.tomcat.websocket.AsyncChannelWrapperSecure$ReadTask.run(AsyncChannelWrapperSecure.java:253)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:722)\nCaused by: java.io.IOException: The specified network name is no longer available.\n\n        at sun.nio.ch.Iocp.translateErrorToIOException(Iocp.java:309)\n        at sun.nio.ch.Iocp.access$700(Iocp.java:46)\n        at sun.nio.ch.Iocp$EventHandlerTask.run(Iocp.java:399)\n        ... 1 more','2013-07-01 12:02:44','Stoyan Boshev','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 trivial','b9b7b7c','Violeta Georgieva Georgieva','2013-07-01 08:07:30','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55173 Fix typo','java/org/apache/tomcat/websocket/LocalStrings.properties'),(230,55159,'Bug 55159 – Wasted work in ErrorReportValve.getPartialServletStackTrace','','2013-06-29 19:12:03','Adrian Nistor','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','b7cad6b','Violeta Georgieva Georgieva','2013-07-01 07:01:38','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55159 Small performance improvement Patch provided by Adrian Nistor','java/org/apache/catalina/valves/ErrorReportValve.java'),(231,54086,'Bug 54086 – ConcurrentModificationException in NioReceiver on shutdown','','2012-11-01 13:32:28','Casey Lucas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Cluster','P2 normal','b09fead','Mark Emlyn David Thomas','2013-07-01 06:57:50','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54086 If stopListening is called while the thread is processing selector events it is possible for two threads to try to use the keys collection at the same time. Prevent the ConcurrentModificationException that can occur.','java/org/apache/catalina/tribes/transport/LocalStrings.properties\njava/org/apache/catalina/tribes/transport/nio/NioReceiver.java'),(232,55017,'Bug 55017 – Ability to configure RMI bind address','','2013-05-24 14:50:10','Alexey Noskov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','45f59bb','Mark Emlyn David Thomas','2013-07-01 05:50:38','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55017 Add the ability to configure the RMO bind address when using the JXM remote listener. Patch provided by Alexey Noskov.','java/org/apache/catalina/mbeans/JmxRemoteLifecycleListener.java\njava/org/apache/catalina/mbeans/LocalStrings.properties\nwebapps/docs/config/listeners.xml'),(233,55151,'Bug 55151 – Fix in MsgByte encoder and decoder TestEncodingDecoding websocket test','','2013-06-27 18:00:57','Niki Dokovski','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 minor','d71136a','Mark Emlyn David Thomas','2013-06-27 16:10:40','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55151 Fix bugs in test','test/org/apache/tomcat/websocket/pojo/TestEncodingDecoding.java'),(234,55143,'Bug 55143 – Unable to add programmatic message handler to an endpoint with custom decoder','','2013-06-25 12:48:34','Niki Dokovski','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','c08e146','Mark Emlyn David Thomas','2013-06-27 10:47:36','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55143 Add a test case. Patch provided by Niki Dokovski','test/org/apache/tomcat/websocket/pojo/TestEncodingDecoding.java'),(235,55143,'Bug 55143 – Unable to add programmatic message handler to an endpoint with custom decoder','','2013-06-25 12:48:34','Niki Dokovski','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','8a4eaab','Mark Emlyn David Thomas','2013-06-27 06:45:59','More changes for BZ 55143. @OnMessage may need multiple message handlers depending on the decoders present','java/org/apache/tomcat/websocket/Util.java\njava/org/apache/tomcat/websocket/pojo/PojoMethodMapping.java'),(236,55143,'Bug 55143 – Unable to add programmatic message handler to an endpoint with custom decoder','','2013-06-25 12:48:34','Niki Dokovski','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','c7a67b2','Mark Emlyn David Thomas','2013-06-26 18:14:57','Rename prior to some more BZ 55143 related changes','java/org/apache/tomcat/websocket/pojo/PojoMethodMapping.java'),(237,55143,'Bug 55143 – Unable to add programmatic message handler to an endpoint with custom decoder','','2013-06-25 12:48:34','Niki Dokovski','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','8d7a5e7','Mark Emlyn David Thomas','2013-06-26 08:45:47','BZ 55143 Handle removal of listeners that might have been wrapped','java/org/apache/tomcat/websocket/WsSession.java\njava/org/apache/tomcat/websocket/pojo/PojoMessageHandlerBase.java'),(238,55143,'Bug 55143 – Unable to add programmatic message handler to an endpoint with custom decoder','','2013-06-25 12:48:34','Niki Dokovski','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','b696517','Mark Emlyn David Thomas','2013-06-26 08:36:58','More work for BZ 55143 Add support for byte[], InopuStream and Reader message handlers','java/org/apache/tomcat/websocket/Util.java\njava/org/apache/tomcat/websocket/pojo/PojoMessageHandlerWholeBinary.java\njava/org/apache/tomcat/websocket/pojo/PojoMessageHandlerWholeText.java\njava/org/apache/tomcat/websocket/pojo/PojoMethodMapping.java\ntest/org/apache/tomcat/websocket/TestWsWebSocketContainer.java\ntest/org/apache/tomcat/websocket/TesterEchoServer.java'),(239,55143,'Bug 55143 – Unable to add programmatic message handler to an endpoint with custom decoder','','2013-06-25 12:48:34','Niki Dokovski','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','dc80771','Mark Emlyn David Thomas','2013-06-26 07:54:31','Further refactoring towards a fix for BZ 55143','java/org/apache/tomcat/websocket/LocalStrings.properties\njava/org/apache/tomcat/websocket/Util.java\njava/org/apache/tomcat/websocket/WsSession.java\njava/org/apache/tomcat/websocket/pojo/PojoMessageHandlerWholeBinary.java\njava/org/apache/tomcat/websocket/pojo/PojoMessageHandlerWholeText.java\njava/org/apache/tomcat/websocket/pojo/PojoMethodMapping.java'),(240,55143,'Bug 55143 – Unable to add programmatic message handler to an endpoint with custom decoder','','2013-06-25 12:48:34','Niki Dokovski','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','b1faf57','Mark Emlyn David Thomas','2013-06-26 05:19:02','Refactoring in support of fixing BZ 55143','java/org/apache/tomcat/websocket/LocalStrings.properties\njava/org/apache/tomcat/websocket/MessageHandlerResult.java\njava/org/apache/tomcat/websocket/MessageHandlerResultType.java\njava/org/apache/tomcat/websocket/Util.java\njava/org/apache/tomcat/websocket/WsSession.java'),(241,55102,'Bug 55102 – Add ability to report time taken to prepare response','','2013-06-15 17:09:47','Jeremy Boynes','Tomcat Developers Mailing List','CLOSED FIXED','Tomcat 8','Catalina','P2 enhancement','7aea9cb','Mark Emlyn David Thomas','2013-06-23 16:22:25','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55102 Add support for time to first byte to the AccessLog','java/org/apache/catalina/valves/AccessLogValve.java\njava/org/apache/coyote/Response.java\nwebapps/docs/config/valve.xml'),(242,55125,'Bug 55125 – Tomcat does not shut down if LifecycleListener throws an exception','','2013-06-21 11:23:54','Glyn Normington','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','3a36a8f','Mark Emlyn David Thomas','2013-06-23 15:47:39','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55125 No point starting a process if the Server container fails to start.','java/org/apache/catalina/core/StandardService.java\njava/org/apache/catalina/startup/Catalina.java\njava/org/apache/catalina/startup/LocalStrings.properties'),(243,55127,'Bug 55127 – Encoders init and destroy methods are never called','','2013-06-22 06:04:48','Niki Dokovski','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','93bcdde','Mark Emlyn David Thomas','2013-06-22 10:09:34','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55127 Encoders have init() and destroy() methdos that need to be called. Based on a patch provided by Niki Dokovski.','java/org/apache/tomcat/websocket/WsRemoteEndpointImplBase.java\njava/org/apache/tomcat/websocket/WsRemoteEndpointImplClient.java\njava/org/apache/tomcat/websocket/WsSession.java\njava/org/apache/tomcat/websocket/WsWebSocketContainer.java\njava/org/apache/tomcat/websocket/server/WsHttpUpgradeHandler.java\njava/org/apache/tomcat/websocket/server/WsRemoteEndpointImplServer.java\ntest/org/apache/tomcat/websocket/pojo/TestEncodingDecoding.java'),(244,55126,'Bug 55126 – IAE is thrown during deployment of ServerEndPoint having multiple text decoders','','2013-06-21 13:16:22','Niki Dokovski','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','366ddff','Mark Emlyn David Thomas','2013-06-21 17:07:06','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55126 For methods annotated with @onMessage It is OK for multiple decoders to match a single message parameter It is not OK for multiple parameters within a method to be possible message parameters.','java/org/apache/tomcat/websocket/pojo/PojoMethodMapping.java'),(245,55120,'Bug 55120 – ISA exception is thrown during application start when there is annotated ServerEndpoint POJO','','2013-06-19 10:10:35','Niki Dokovski','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','e59382c','Mark Emlyn David Thomas','2013-06-20 18:24:25','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55120 @OnOpen needs to support an optional EndpointConfig parameter. Based on a patch by Niki Dokovski.','java/org/apache/tomcat/websocket/pojo/PojoEndpointBase.java\njava/org/apache/tomcat/websocket/pojo/PojoMethodMapping.java\ntest/org/apache/tomcat/websocket/pojo/TestPojoEndpointBase.java\nwebapps/docs/changelog.xml'),(246,55120,'Bug 55120 – ISA exception is thrown during application start when there is annotated ServerEndpoint POJO','','2013-06-19 10:10:35','Niki Dokovski','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','45affed','Mark Emlyn David Thomas','2013-06-20 17:58:25','Refactor in preparation for fixing BZ 55120','java/org/apache/tomcat/websocket/pojo/PojoMethodMapping.java'),(247,55101,'Bug 55101 – BasicAuthenticator parser and associated unit tests','','2013-06-15 15:01:40','Brian Burch','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 enhancement','c4a50f5','Mark Emlyn David Thomas','2013-06-20 16:36:08','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55101 Make BASIC auth parsing more tolerant of whitespace.','java/org/apache/catalina/authenticator/BasicAuthenticator.java\ntest/org/apache/catalina/authenticator/TestBasicAuthParser.java\ntest/org/apache/catalina/authenticator/TestNonLoginAndBasicAuthenticator.java\nwebapps/docs/changelog.xml'),(248,55071,'Bug 55071 – try finally catch structure masks original exception in JDBCRealm.getPassword()','I have run into a mysterious apparent SQL exception in JDBCRealm.getPassword().\n\nPresumably, line 557 \"stmt.executeQuery()\" occasionally fails. I\'m not sure why and would like to know why. \n\nHowever, the finally block contains dbConnection.commit() (line 579). This throws an exception (Connection Closed) which is then logged on line 585. \n\nIn summary, line 579 should be surrounded by a try catch.','2013-06-06 22:26:48','bruce weertman','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','a120c16','Mark Emlyn David Thomas','2013-06-20 16:01:07','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55071 Remove unnecessary call to commit(). The rs.close() just above will commit anything that needs to be committed.','java/org/apache/catalina/realm/JDBCRealm.java'),(249,54745,'Bug 54745 – Tomcat JarScanning does not work when Tomcat started with Java Web Start','','2013-03-22 23:07:06','Nick Williams','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 enhancement','c7c30b6','Mark Emlyn David Thomas','2013-06-20 11:07:55','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54745 Fix JarScanning when Tomcat is started via Java WebStart. Patch provided by Nick Williams.','java/org/apache/tomcat/util/scan/StandardJarScanner.java'),(250,53665,'Bug 53665 – Minor JNDI Howto document enhancement concerning mail properties','','2012-08-06 20:06:36','Mark Eggers','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 enhancement','fc61196','Mark Emlyn David Thomas','2013-06-20 10:24:34','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53665 Document when a javax.mail.Authenticator is configured.','webapps/docs/jndi-resources-howto.xml'),(251,53987,'Bug 53987 – Log uncovered HTTP methods in combined security constraints','It is usually an error (and a security hole) if security constraints are defined for some but not all HTTP methods for a given URL. If such a situation is detected on web application start, log it.','2012-10-09 19:02:28','Mark Thomas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 enhancement','f78c1a4','Mark Emlyn David Thomas','2013-06-19 17:43:26','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53987 Servlet 3.1. Log uncovered HTTP methods.','java/org/apache/catalina/core/LocalStrings.properties\njava/org/apache/catalina/core/StandardContext.java'),(252,55073,'Bug 55073 – wasted work in ValidateVisitor.isExpression()','','2013-06-07 14:23:24','Adrian Nistor','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','3e2ceee','Mark Emlyn David Thomas','2013-06-18 03:57:32','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55073 Small performance improvement Patch provided by Adrian Nistor','java/org/apache/jasper/compiler/Validator.java'),(253,55108,'Bug 55108 – Wasted work in \"AbstractReplicatedMap.excludeFromSet\"','','2013-06-17 18:12:00','Adrian Nistor','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','4979721','Mark Emlyn David Thomas','2013-06-18 03:32:42','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55108 Small performance improvement Patch provided by Adrian Nistor','java/org/apache/catalina/tribes/tipis/AbstractReplicatedMap.java'),(254,55109,'Bug 55109 – Wasted work in \"WebdavServlet.isLocked\"','','2013-06-17 18:24:46','Adrian Nistor','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','82bccd2','Mark Emlyn David Thomas','2013-06-18 03:27:26','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55109 Small performance improvement Patch provided by Adrian Nistor','java/org/apache/catalina/servlets/WebdavServlet.java'),(255,55110,'Bug 55110 – Wasted work in \"TestNonLoginAndBasicAuthenticator.doTestBasic\"','','2013-06-17 18:37:18','Adrian Nistor','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','c48a2ed','Mark Emlyn David Thomas','2013-06-18 03:18:09','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55110 Small performance improvements Patch provided by Adrian Nistor','test/org/apache/catalina/authenticator/TestNonLoginAndBasicAuthenticator.java\ntest/org/apache/tomcat/websocket/TestWsWebSocketContainer.java'),(256,54939,'Bug 54939 – No useful logging when maxHeaderCount hit','Recent versions of tomcat 6 & 7 added the maxHeaderCount parameter to the connector configuration with a default value of 100. When this limit is hit Tomcat returns a HTTP 400 response with a blank page and in the default configuration nothing is logged by the server. The org.apache.coyote.ajp.AjpProcessor class logs the error at DEBUG level but that doesn\'t get written anywhere using the default configuration.\n\nThe use case for more than 100 headers is the use of SSO systems that provide user attributes via HTTP headers. The Internet2 Shibboleth project is one good example, it is quite common to have well over 100 headers getting passed to Tomcat when using these systems.\n\nI\'d like to propose one of the following fixes:\n\n- Write a message to the response explaining why the 400 response was returned. This would make it much easier for application deployers to determine the cause of the non-functional application.\n\n- Have a default logger setup for the AJP connector and change the log level to INFO. Perhaps this gets treated as a one time warning and the first request that hits this limit is logged as WARN and the subsequent requests are logged at DEBUG to avoid log clutter.\n\n- Increase the default value of maxHeaderCount to 1000 which would more easily accommodate the use of HTTP headers to pass user attributes.\n\n\n\nI\'d be happy to provide a patch for any of these solutions or other proposed ideas.','2013-05-08 14:21:16','Eric Dalquist','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 normal','fdc733d','Konstantin Kolinko','2013-06-04 17:15:12','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54939 Follow-up to r1489444: Update description of UserDataHelper uses in documentation. Corrected a typo s/to/too/.','webapps/docs/config/systemprops.xml'),(257,54939,'Bug 54939 – No useful logging when maxHeaderCount hit','Recent versions of tomcat 6 & 7 added the maxHeaderCount parameter to the connector configuration with a default value of 100. When this limit is hit Tomcat returns a HTTP 400 response with a blank page and in the default configuration nothing is logged by the server. The org.apache.coyote.ajp.AjpProcessor class logs the error at DEBUG level but that doesn\'t get written anywhere using the default configuration.\n\nThe use case for more than 100 headers is the use of SSO systems that provide user attributes via HTTP headers. The Internet2 Shibboleth project is one good example, it is quite common to have well over 100 headers getting passed to Tomcat when using these systems.\n\nI\'d like to propose one of the following fixes:\n\n- Write a message to the response explaining why the 400 response was returned. This would make it much easier for application deployers to determine the cause of the non-functional application.\n\n- Have a default logger setup for the AJP connector and change the log level to INFO. Perhaps this gets treated as a one time warning and the first request that hits this limit is logged as WARN and the subsequent requests are logged at DEBUG to avoid log clutter.\n\n- Increase the default value of maxHeaderCount to 1000 which would more easily accommodate the use of HTTP headers to pass user attributes.\n\n\n\nI\'d be happy to provide a patch for any of these solutions or other proposed ideas.','2013-05-08 14:21:16','Eric Dalquist','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 normal','5d4b84d','Mark Emlyn David Thomas','2013-06-04 09:24:12','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54939 Log errors parsing HTTP request headers.','java/org/apache/coyote/http11/AbstractHttp11Processor.java\njava/org/apache/coyote/http11/LocalStrings.properties'),(258,55052,'Bug 55052 – [JULI] Make ClassLoaderLogManager.getProperty() to try unprefixed property if prefixed one does not exist','','2013-06-03 13:08:20','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','99562d3','Mark Emlyn David Thomas','2013-06-04 08:19:29','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55052 Fall back to un-prefixed property if a prefixed one is not present','java/org/apache/juli/ClassLoaderLogManager.java'),(259,55046,'Bug 55046 – CORS Filter','','2013-06-02 00:48:49','Mohit Soni','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 enhancement','72edec7','Mark Emlyn David Thomas','2013-06-04 06:51:31','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55046 Add a Filter that implements CORS (http://www.w3.org/TR/cors/) Based on a patch by Mohit Soni.','java/org/apache/catalina/filters/CorsFilter.java\njava/org/apache/catalina/filters/LocalStrings.properties\ntest/org/apache/catalina/filters/TestCorsFilter.java\ntest/org/apache/catalina/filters/TesterFilterChain.java\ntest/org/apache/catalina/filters/TesterFilterConfigs.java\ntest/org/apache/catalina/filters/TesterHttpServletRequest.java\ntest/org/apache/catalina/filters/TesterHttpServletResponse.java\ntest/org/apache/catalina/filters/TesterServletContext.java\nwebapps/docs/config/filter.xml'),(260,55035,'Bug 55035 – Deploy ROOT webapp with version through text manager using Ant','Currently Ant \"deploy\" task does not support separate parameter \"version\" and, thanks to URLEncoder, there is no workaround for that.\n\nBut for apps with not empty context it\'s possible to define version using ##, like setting path to \"/someContext#someVersion\".\n\nFor apps with empty context we receive error:\n\nCase #1:\n<deploy url=\"{tomcat.manager}/text\" username=\"${username}\", password=\"${password}\" path=\"/ROOT##12345\" war=\"${pathtowar}\" />\n\nResult:\nFailed to deploy application at context path /ROOT##12345\n\nCase #1:\n<deploy url=\"{tomcat.manager}/text\" username=\"${username}\", password=\"${password}\" path=\"/##12345\" war=\"${pathtowar}\" />\n\nResult:\nFailed to deploy application at context path /##12345','2013-05-31 16:05:20','Sergey Tcherednichenko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Manager','P2 major','712a351','Mark Emlyn David Thomas','2013-06-03 16:58:17','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=55035 Add support for the version parameter to the deploy Ant task. Patch provided by Sergey Tcherednichenko.','java/org/apache/catalina/ant/DeployTask.java'),(261,54999,'Bug 54999 – JSESSIONIDSSO not re-created upon re-authentication on the same request - logout() and login(username,password)','In testing I found that the JSESSIONIDSSO was not re-created upon re-authentication via logout() and login(username,password) in the same request.  The problem stemmed from the REQ_SSOID_NOTE that was was not reset upon request.logout(), whereas the documentation indicates that a logout() from any web-app should logout() from all web-apps.  When the REQ_SSOID_NOTE is not removed upon logout(), a subsequent login(username,password) on the same request will re-create a JSESSIONID for the current web-app but fails to re-create a JSESSIONIDSSO since the REQ_SSO_ID_NOTE still lingers on the request.\n\nAuthenticatorBase.java adjustment for logout(request) that removes the REQ_SSOID_NOTE so that a subsequent login(username,password) will work on the same request:\n\n    @Override\n    public void logout(Request request) throws ServletException {\n        register(request, request.getResponse(), null,\n                null, null, null);\n    	request.removeNote(Constants.REQ_SSOID_NOTE);\n    }\n\nI\'ll upload a diff-patch against the trunk and for 7.0.40.','2013-05-21 19:50:48','Keith Mashinter','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','6d789fe','Mark Emlyn David Thomas','2013-05-30 09:49:40','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54999 Fix JSESSIONIDSSO not recreated when a logout and login occur in the same request. Patch provided by Keith Mashinter','java/org/apache/catalina/authenticator/AuthenticatorBase.java'),(262,54997,'Bug 54997 – SSL Handshake implementation in AsycnChannelWrapperSecure does not handle SSLEngineResult.Status.BUFFER_UNDERFLOW and SSLEngineResult.Status.BUFFER_OVERFLOW states','','2013-05-21 07:22:32','Niki Dokovski','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','6c6b25c','Mark Emlyn David Thomas','2013-05-29 06:17:20','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54997 Handle BUFFER_UNDERFLOW during SSL handshake.','java/org/apache/tomcat/websocket/AsyncChannelWrapperSecure.java'),(263,54971,'Bug 54971 – javax.servlet.http.Part.write(String fileName) is not properly implemented','1. fileName parameter / relative vs absolute\nfilaName parameter specification in\n<1><JSR-000315 Java Servlet 3.0 Final Release javadocs>\nis different from the <2><javax API tomcat refers to>.\n\n<1> <JSR-000315 Java Servlet 3.0 Final Release javadocs>\n\nParameters:fileName - the name of the file to which the stream will be written. The file is created relative to the location as specified in the MultipartConfig\n\n<2> javax. API tomcat refers to\n\n * @param fileName  The location into which the uploaded part should be\n     *                  stored. Relative locations are relative to {@link\n     *                  javax.servlet.MultipartConfigElement#getLocation()}\n\n\nTomcat is implemented as specified in <2> so that it can process \"absolute path\",\nbut it should only accept \"relative path\" as specified in <1>\n<JSR-000315 Java Servlet 3.0 Final Release javadocs>\n\n2.\nIf MultiPartConfig.location is not set,\nwrite( String relative path ) throws FileNotFound Exception.\nA default location needs to be set in order to avoid such exception.\n\nexample) os: windows8\n\npart.write(\"/test\");\n\njava.io.IOException: java.io.FileNotFoundException: \\test (Access is denied)\n	at org.apache.catalina.core.ApplicationPart.write(ApplicationPart.java:123)\n	at servlet.multipart.MultipleUploadServlet.doPost(MultipleUploadServlet.java:76)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:647)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:728)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:222)\n	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)\n	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)\n	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:171)\n	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99)\n	at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:947)\n	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)\n	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:408)\n	at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1009)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:589)\n	at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:312)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:895)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:918)\n	at java.lang.Thread.run(Thread.java:662)','2013-05-15 02:16:03','Daniel Koh','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','cccd0ac','Mark Emlyn David Thomas','2013-05-28 10:37:50','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54971 Pass the calculated location to AplicationPart rather than it having to recalculate it every time. Now correctly handles relative locations.','java/org/apache/catalina/connector/Request.java\njava/org/apache/catalina/core/ApplicationPart.java'),(264,54964,'Bug 54964 – Class loading issue of \"TagPlugin\" in TagPluginManager','','2013-05-14 06:57:34','Sheldon Shao','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','65ab66e','Mark Emlyn David Thomas','2013-05-28 07:54:49','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54964 Enable tag plug-ins to be packaged with a web application. Patch by Sheldon Shao.','java/org/apache/jasper/compiler/TagPluginManager.java'),(265,54963,'Bug 54963 – Concurrent issue of Spdy/NetSupportSocket','','2013-05-14 06:50:20','Sheldon Shao','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Connectors','P2 normal','6272fca','Mark Emlyn David Thomas','2013-05-28 07:46:56','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54963 Fix concurrent issue of Spdy/NetSupportSocket Patch provided by Sheldon Shao','java/org/apache/tomcat/spdy/NetSupportSocket.java'),(266,54961,'Bug 54961 – Make \"compress\" configurable in SpdyProxyProtocol','','2013-05-14 02:56:42','Sheldon Shao','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Connectors','P2 enhancement','c25112b','Mark Emlyn David Thomas','2013-05-28 07:41:57','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54961 Make \"compress\" configurable in SpdyProxyProtocol. Patch by Sheldon Shao','java/org/apache/coyote/spdy/SpdyProxyProtocol.java\nwebapps/docs/changelog.xml'),(267,54947,'Bug 54947 – Http11NioProtocol generates HTTP 505 responses on valid requests if request is split across multiple packets','If an HTTP request is broken up across multiple packets *and* the first packet contains a GET request up to \"\\r\" AND the \"\\n\" terminating the first line of the request is included in the next packet Tomcat incorrectly throws an HTTP \"505 Version Not Supported\" response.  This is with the Http11NioProtocol connector only - the default HTTP/1.1 connector does not exhibit this problem.\n\nAn example request:\nPacket 1: GET / HTTP/1.1\\r\nPacket 2: \\nHost: localhost\\r\\n\nPacket 3: Connection: Close\\r\\n\\r\\n\n\nResponse:\nHTTP/1.1 505 HTTP Version Not Supported\nServer: Apache-Coyote/1.1\nDate: Thu, 09 May 2013 20:23:58 GMT\nConnection: close\n\nThe following Python program reproduces the problem for me in both Tomcat 6.0.37 and Tomcat 7.0.39:\n\"\"\"\n#!/usr/bin/python\n\nimport socket\nimport time\n\ns = socket.socket()\ns.connect((\"localhost\",8080))\ns.sendall(\"GET / HTTP/1.1\\r\")\ntime.sleep(1.5) # make sure the above goes out in its own packet\ns.sendall(\"\\nHost: localhost\\r\\n\")\ns.sendall(\"Connection: close\\r\\n\\r\\n\")\nprint s.makefile().read()\n\"\"\"\n\nMoving the \"\\n\" to from the second sendall to the end of the first sendall causes Tomcat to respond correctly.','2013-05-09 20:27:01','Greg Harris','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 normal','f763975','Mark Emlyn David Thomas','2013-05-28 07:26:20','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54947 NIO connector incorrectly rejects a request if the CRLF terminating the request line is split across multiple packets. Patch for the fix by Konstantin Preißer. I added a test case.','java/org/apache/coyote/http11/InternalNioInputBuffer.java\ntest/org/apache/catalina/startup/SimpleHttpClient.java\ntest/org/apache/coyote/http11/TestInternalInputBuffer.java'),(268,54944,'Bug 54944 – Enhancements to TestFormAuthenticator','','2013-05-09 14:33:23','Brian Burch','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 enhancement','0de078e','Mark Emlyn David Thomas','2013-05-28 06:53:41','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54944 Enhancements to TestFormAuthenticator. Patch by Brian Burch','test/org/apache/catalina/authenticator/TestFormAuthenticator.java'),(269,54931,'Bug 54931 – Updates to windows-service-howto to include support for installing multiple windows services','','2013-05-06 11:10:15','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 minor','61c4b97','Mark Emlyn David Thomas','2013-05-28 05:36:11','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54931 Add information on creating multiple services. Based on a patch by Chris Derham','webapps/docs/windows-service-howto.xml'),(270,55019,'Bug 55019 – <jsp:include page=\"blabla\" flush=\"true\"/> failed to compile under security manager','','2013-05-27 12:55:28','jfclere','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','76a7098','Remy Maucherat','2013-05-27 11:15:32','https://issues.apache.org/bugzilla/show_bug.cgi?id=55019 Preload the Constants class during connector init.','java/org/apache/coyote/http11/AbstractOutputBuffer.java'),(271,54984,'Bug 54984 – multipart/form-data is not always read with correct encoding','The bug occurs when form data is posted as multipart/form-data and using Servlet 3 API to get posted files.\nIn a servlet, if we set the encoding:\n\nrequest.setCharacterEncoding(\"UTF-8\");\n\nThen invoke:\n\nrequest.getParts()\n\nAnd then invoke:\n\nString text = request.getParameter(\"sometextfield\");\n\nUTF-8 characters in the text have been garbled.\n\nOrder of method calls are significant, if a getParameter is called before getParts, the correct encoding will be used.\nHowever, the order which you invoke the methods should not matter.','2013-05-16 11:15:20','Per Holmberg','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','7558546','Violeta Georgieva Georgieva','2013-05-24 13:46:27','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54984 Ensure that the correct encoding will be used when processing the multipart data.','java/org/apache/catalina/connector/Request.java\ntest/org/apache/catalina/connector/TestRequest.java'),(272,54928,'Bug 54928 – IllegalStateException: Calling [asyncError()] is not valid for a request with Async state [COMPLETING]','In an async scenario (request.startAsync), when the client goes away, trying to write to the response raises an IOException. If I then call asyncContext.complete() in order to finalize and clean up the request, soon after the following exception occurs:\n\njava.lang.IllegalStateException: Calling [asyncError()] is not valid for a request with Async state [COMPLETING]\n        at org.apache.coyote.AsyncStateMachine.asyncError(AsyncStateMachine.java:304)\n        at org.apache.coyote.http11.AbstractHttp11Processor.action(AbstractHttp11Processor.java:793)\n        at org.apache.coyote.Request.action(Request.java:373)\n        at org.apache.catalina.core.AsyncContextImpl.setErrorState(AsyncContextImpl.java:441)\n        at org.apache.catalina.connector.CoyoteAdapter.asyncDispatch(CoyoteAdapter.java:312)\n        at org.apache.coyote.http11.AbstractHttp11Processor.asyncDispatch(AbstractHttp11Processor.java:1509)\n        at org.apache.coyote.http11.Http11NioProcessor.asyncDispatch(Http11NioProcessor.java:221)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:619)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1581)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1540)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)\n        at java.lang.Thread.run(Thread.java:722)\n\nIt looks like an attempt to maybe to send an error event to AsyncListener\'s but asyncContext.complete has already been called.\n\nIs calling asyncContext.complete() a reasonable way to handle an IOException from the response in order to finalize the request and release any resorces associated with it?','2013-05-04 12:41:30','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','3960b22','Mark Emlyn David Thomas','2013-05-24 10:09:55','Add a test case for bug 54928','test/org/apache/catalina/connector/TestCoyoteAdapter.java'),(273,54955,'Bug 54955 – Mapping to application context root returns 404 after reload','','2013-05-13 03:50:12','Zheng Yang','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','cdbf6b0','Violeta Georgieva Georgieva','2013-05-20 16:51:02','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54955 During reloading the application, the context root Wrapper is not removed correctly. This causes 404 to be returned later on when the context root is requested.','java/org/apache/catalina/mapper/Mapper.java'),(274,54899,'Bug 54899 – Initial support for netbeans ide','','2013-04-28 14:17:47','Brian Burch','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Packaging','P2 enhancement','15824e7','Konstantin Kolinko','2013-05-20 09:00:18','Further followup for Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54899 Correct product names','build.xml\nres/ide-support/netbeans/nb-tomcat-build.properties\nres/ide-support/netbeans/nb-tomcat-project.properties\nres/ide-support/netbeans/nb-tomcat.xml\nres/ide-support/netbeans/project.xml'),(275,54899,'Bug 54899 – Initial support for netbeans ide','','2013-04-28 14:17:47','Brian Burch','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Packaging','P2 enhancement','3548b60','Konstantin Kolinko','2013-05-20 08:40:18','Followup for Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54899 Rename the file, so that it is picked by \"text.files\" pattern in build.xml. As such its end-of-lines would be properly converted when packing the sources.','res/ide-support/netbeans/README\nres/ide-support/netbeans/README.txt'),(276,54899,'Bug 54899 – Initial support for netbeans ide','','2013-04-28 14:17:47','Brian Burch','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Packaging','P2 enhancement','4de5672','Mark Emlyn David Thomas','2013-05-20 05:53:25','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54899 Provide an initial implementation of NetBeans support. Patch provided by Brian Burch.','build.xml\nres/ide-support/netbeans/README\nres/ide-support/netbeans/nb-tomcat-build.properties\nres/ide-support/netbeans/nb-tomcat-project.properties\nres/ide-support/netbeans/nb-tomcat.xml\nres/ide-support/netbeans/project.xml\nwebapps/docs/changelog.xml'),(277,54981,'Bug 54981 – ServletContext.getJspConfigDescriptor() should return null when there is no jsp configuration','According to Servlet 3.0 javadoc ServletContext.getJspConfigDescriptor() must return NULL when there is no jsp configuration:\n\n\"\nReturns:\nthe <jsp-config> related configuration that was aggregated from the web.xml and web-fragment.xml descriptor files of the web application represented by this ServletContext, or null if no such configuration exists\n\"','2013-05-16 08:02:36','Violeta Georgieva','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','aabef09','Violeta Georgieva Georgieva','2013-05-16 04:07:24','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54981 ServletContext.getJspConfigDescriptor() must return NULL when there is no jsp configuration','java/org/apache/catalina/core/ApplicationContext.java\ntest/org/apache/catalina/core/TestApplicationContext.java'),(278,54932,'Bug 54932 – Broken link to Tribes documentation','','2013-05-06 14:06:58','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 minor','1d840cb','Violeta Georgieva Georgieva','2013-05-15 09:01:08','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54932 Fixed a broken link to Tribes documentation.','webapps/docs/project.xml\nwebapps/docs/tribes/project.xml'),(279,54974,'Bug 54974 – SessionCookieConfig.setXXX methods must throw IllegalStateException when invoked after initialization phase','According to Servlet 3.0 javadoc \njavax.servlet.SessionCookieConfig setter methods must throw IllegalStateException when invoked after initialization phase\n\nsetComment(String) \nsetDomain(String)\nsetHttpOnly(boolean)\nsetMaxAge(int)\nsetName(String) \nsetPath(String)\nsetSecure(boolean)\n\n\"\nThrows: java.lang.IllegalStateException - if the ServletContext from which this SessionCookieConfig was acquired has already been initialized\n\"','2013-05-15 08:23:39','Violeta Georgieva','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','41462ca','Violeta Georgieva Georgieva','2013-05-15 04:31:32','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54974 SessionCookieConfig.setXXX methods will throw IllegalStateException if the ServletContext from which this SessionCookieConfig was acquired has already been initialized.','java/org/apache/catalina/core/ApplicationContext.java\njava/org/apache/catalina/core/ApplicationSessionCookieConfig.java\njava/org/apache/catalina/core/LocalStrings.properties\ntest/org/apache/catalina/core/TestApplicationSessionCookieConfig.java'),(280,51294,'Bug 51294 – Since 7.0.12 do not work option unpackWARs=true for WARs outside appBase','In 7.0.12 was added in Changelog this line:\n--\nDon\'t unpack WAR files if they are not located in the Host\'s appBase. (markt)\n--\nIt\'s change method of deployment from older versions of Tomcat (5.5, 6.0, 7.0.11) and forced to change logics on early configured servers.\n\nMay be need to add new parameter like \'unpackExternalWARs=true\' to be able to configure this? (Why outside WARs is worse than inside?)','2011-05-30 13:04:34','Andrey M','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','1cde68d','Mark Emlyn David Thomas','2013-05-14 06:31:32','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51294 This is an initial implementation that includes some but not all the anticipated test cases. It is expected that as the test cases are expanded, further changes will required. Remove the comments from the context.xml files that have been replaced by using the sessionCookieName.','java/org/apache/catalina/startup/ContextConfig.java\ntest/deployment/context.war\ntest/deployment/context.xml\ntest/deployment/dirContext/META-INF/context.xml\ntest/org/apache/catalina/startup/TestHostConfigAutomaticDeployment.java'),(281,54703,'Bug 54703 – Nullpointer exception in HttpParser.parseMediaType','input for parseMediaType() is\n\n----------\nmultipart/signed; protocol=\"application/pkcs7-signature\"; micalg=sha-256; \n	boundary=\"----=_Part_121_929034657.1363355797756\"\n----------\n\nexception trace\n\njava.lang.NullPointerException\n        at org.apache.tomcat.util.http.parser.HttpParser.parseMediaType(HttpParser.java:215)\n        at org.apache.tomcat.util.http.parser.MediaTypeCache.parse(MediaTypeCache.java:54)\n        at org.apache.catalina.connector.Response.setContentType(Response.java:806)\n        at org.apache.catalina.connector.Response.checkSpecialHeader(Response.java:1119)\n        at org.apache.catalina.connector.Response.setHeader(Response.java:1446)\n        at org.apache.catalina.connector.ResponseFacade.setHeader(ResponseFacade.java:535)','2013-03-15 14:09:19','Sandy Meier','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','7aeab0e','Mark Emlyn David Thomas','2013-05-07 11:51:22','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54703 Be tolerant of applications that pass CR or LF in setHeader() values. Fix some whitespace parsing issues idnetifed by the extended test cases in readTokenOrQuotedString()','java/org/apache/tomcat/util/http/parser/HttpParser.java\ntest/org/apache/tomcat/util/http/parser/TestMediaType.java'),(282,54906,'Bug 54906 – WebappClassLoader.loadedByThisOrChild can throw ConcurrentModificationException','','2013-04-29 19:25:04','NateC','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 enhancement','c06707c','Mark Emlyn David Thomas','2013-05-04 16:59:07','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54906 Better error message for ConcurrentModificationException when checking for memory leaks and continue with remaining checks. Based on a patch by NateC.','java/org/apache/catalina/loader/LocalStrings.properties\njava/org/apache/catalina/loader/WebappClassLoader.java'),(283,54926,'Bug 54926 – WsFilter performs handshake validation even if it doesn\'t have a mapped endpoint','WsFilter performs several validations on WebSocket requests before checking if there is a registered Endpoint. I think the check for registered Endponts (and delegation to the next Filter) should take place first and the filter should do no further processing if there is mapped Endpoint for that URL.\n\nFor example a SockJS protocol test send a POST request with a connection and upgrade headers but no ws version header and expects back a 405 (invalid HTTP method) where WsFilter sends 426 even though it has no Endpoint mapped at that URL.','2013-05-04 01:23:20','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','2df191f','Mark Emlyn David Thomas','2013-05-04 05:09:39','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54926 Re-order the validation checks. Order is now: - Is this a WebSocket upgrade? - Is there a matching endpoint? - Validate remaining headers','java/org/apache/tomcat/websocket/server/WsFilter.java'),(284,54888,'Bug 54888 – TagPlugin \"ForEach\" doesn\'t support CSV items','','2013-04-24 16:49:45','Sheldon Shao','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','d440ae2','Mark Emlyn David Thomas','2013-04-29 09:24:36','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54888 Support a csv list with the ForEach tag plugin Based on a patch provided by Sheldon Shao','java/org/apache/jasper/tagplugins/jstl/core/ForEach.java\ntest/org/apache/jasper/tagplugins/jstl/core/TestForEach.java\ntest/webapp-3.0/bug5nnnn/bug54888.jsp'),(285,54801,'Bug 54801 – EL-like expressions in jsp:scriptlet break compilation of JSP XML documents','','2013-04-04 22:24:00','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','1631be1','Mark Emlyn David Thomas','2013-04-25 09:16:45','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54801 and https://issues.apache.org/bugzilla/show_bug.cgi?id=54821 Don\'try to parse EL expressions if EL is disabled or inside scriptlets. Based on patches by kkolinko','java/org/apache/jasper/compiler/JspDocumentParser.java\ntest/org/apache/jasper/compiler/TestJspDocumentParser.java\ntest/webapp-3.0/bug5nnnn/bug54801a.jspx\ntest/webapp-3.0/bug5nnnn/bug54801b.jspx\ntest/webapp-3.0/bug5nnnn/bug54821a.jspx\ntest/webapp-3.0/bug5nnnn/bug54821b.jspx'),(286,54821,'Bug 54821 – Error trying to parse EL in JSP XML documents when isELIgnored = true','','2013-04-09 22:41:24','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','1631be1','Mark Emlyn David Thomas','2013-04-25 09:16:45','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54801 and https://issues.apache.org/bugzilla/show_bug.cgi?id=54821 Don\'try to parse EL expressions if EL is disabled or inside scriptlets. Based on patches by kkolinko','java/org/apache/jasper/compiler/JspDocumentParser.java\ntest/org/apache/jasper/compiler/TestJspDocumentParser.java\ntest/webapp-3.0/bug5nnnn/bug54801a.jspx\ntest/webapp-3.0/bug5nnnn/bug54801b.jspx\ntest/webapp-3.0/bug5nnnn/bug54821a.jspx\ntest/webapp-3.0/bug5nnnn/bug54821b.jspx'),(287,54791,'Bug 54791 – No TLD files were found in tools.jar when tools.jar is explicitly added to $CLASSPATH','','2013-04-02 20:08:28','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','b843a02','Mark Emlyn David Thomas','2013-04-24 16:14:20','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54791 Restore tools.jar entry in jarsToSkip','conf/catalina.properties'),(288,54178,'Bug 54178 – [CVE-2013-2071] runtime exception in onComplete of AsyncListener, will make org.apache.catalina.connector.Request not recycled (orginally reported MESSAGE POST to tomcat, but it called doGet)','one HTTP request use POST method, but in tomcat it calls doGet() what is really strage.\n\nas I only tested in 7.0.23, and 7.0.32. in 7.0.32, 7.0.32 is more reproduceable than 7.0.23.\n\nI know it must be a very strange issue, as tomcat has so many release. I can\'t believe it if I didn\'t see it with my own eyes.\n\nso I attache the image.','2012-11-21 08:22:00','Leigh Anderson','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','4171baf','Mark Emlyn David Thomas','2013-04-24 07:27:11','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54178 Protect against AsyncListeners that throw RuntimeExceptions (they should normally only throw IOExceptions). Includes a test case.','java/org/apache/catalina/core/AsyncContextImpl.java\ntest/org/apache/catalina/core/TestAsyncContextImpl.java'),(289,54708,'Bug 54708 – Use base file name (\"ROOT\") as the work directory for the default webapp instead of \"_\"','','2013-03-15 22:22:13','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 enhancement','59a0676','Mark Emlyn David Thomas','2013-04-23 16:06:02','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54708 Handle ROOT##version as well Suggestion by kkolinko','java/org/apache/catalina/core/StandardContext.java'),(290,54781,'Bug 54781 – NPE in WsServerContainer if there is no matching path','','2013-04-01 19:32:18','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','67ed3e7','Mark Emlyn David Thomas','2013-04-23 15:58:34','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54781 Fix NPE if no matching Endpoint is found. Handle forwarded requests as well.','java/org/apache/tomcat/websocket/server/WsFilter.java\njava/org/apache/tomcat/websocket/server/WsServerContainer.java'),(291,54792,'Bug 54792 – IllegalStateException with chat sample','This looks related to 54659 and 54724 but possibly a new issue. To reproduce, open the chat sample page, send a message or two, and then close the browser tab. The following exception appears in the log and it doesn\'t seem to step from anything done in the application:\n\njava.lang.IllegalStateException: The WebSocket session has been closed and no method (apart from close()) may be called on a closed session\n        at org.apache.tomcat.websocket.WsSession.checkState(WsSession.java:516)\n        at org.apache.tomcat.websocket.WsSession.getMessageHandlers(WsSession.java:191)\n        at org.apache.tomcat.websocket.pojo.PojoEndpointBase.onClose(PojoEndpointBase.java:113)\n        at org.apache.tomcat.websocket.WsSession.fireEndpointOnClose(WsSession.java:392)\n        at org.apache.tomcat.websocket.WsSession.onClose(WsSession.java:370)\n        at org.apache.tomcat.websocket.server.WsHttpUpgradeHandler.close(WsHttpUpgradeHandler.java:166)\n        at org.apache.tomcat.websocket.server.WsHttpUpgradeHandler.access$200(WsHttpUpgradeHandler.java:44)\n        at org.apache.tomcat.websocket.server.WsHttpUpgradeHandler$WsReadListener.onDataAvailable(WsHttpUpgradeHandler.java:192)\n        at org.apache.coyote.http11.upgrade.AbstractServletInputStream.onDataAvailable(AbstractServletInputStream.java:169)\n        at org.apache.coyote.http11.upgrade.AbstractProcessor.upgradeDispatch(AbstractProcessor.java:94)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:618)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1581)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1537)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)\n        at java.lang.Thread.run(Thread.java:722)','2013-04-02 20:54:28','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','e26d61d','Mark Emlyn David Thomas','2013-04-23 12:34:04','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54792 Application shouldn\'t be trying to close the session in an @onClose method.','webapps/examples/WEB-INF/classes/websocket/chat/ChatAnnotation.java'),(292,54800,'Bug 54800 – Possible thread/memory leak with use of WebSocketContainer','Whenever WebSocketContainer is used to connect to a server endpoint, the following message appears when Tomcat shuts down:\n\nSEVERE: The web application [/websocket-test] appears to have started a thread named [Thread-4] but has failed to stop it. This is very likely to create a memory leak.\n\nThe message is repeated for 6 different threads. I don\'t have proof this is caused by the use of WebSocketContainer but the messages don\'t appear when it isn\'t used.\n\nThe Endpoint used to connect is very simple. It sends a message when the session is opened to the EchoEndpoint on the server side, and prints the response and closes when the message is echoed back.','2013-04-04 21:47:00','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','d2630df','Mark Emlyn David Thomas','2013-04-23 12:23:20','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54800 Fix memory leaks when using WebSocket client triggered by JVM created threads not having the correct context class loader set.','java/org/apache/tomcat/websocket/LocalStrings.properties\njava/org/apache/tomcat/websocket/WsWebSocketContainer.java'),(293,54872,'Bug 54872 – Receiver\'s value of autoBind is \"less than\", not \"not greater than\"','/tomcat-7.0-doc/config/cluster-receiver.html :\n\nIn the section \"Attributes -- Common Attributes\", the description of Attribute \"port\" is slightly diffrent to the facts.\n\nIt says \"port &lt;= bindPort &lt;= port+autoBind\", but this should be written \n\"port &lt;= bindPort &lt; port+autoBind\".\nAnd \"port in the range 4000-4100.\" also shoud be written \"port in the range 4000-4099.\"\n\nFor example, I try (port=4000, and autoBind=10), then the receiver tried to open port in the range of 4000-4009. It didn\'t try port 4010.','2013-04-20 14:06:39','Yusuke OSUMI','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 trivial','a5f369a','Violeta Georgieva Georgieva','2013-04-22 03:28:02','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54872 https://issues.apache.org/bugzilla/show_bug.cgi?id=54872 Correct the range for the bindPort of the cluster receiver object. Correct the example.','webapps/docs/config/cluster-receiver.xml'),(294,54872,'Bug 54872 – Receiver\'s value of autoBind is \"less than\", not \"not greater than\"','/tomcat-7.0-doc/config/cluster-receiver.html :\n\nIn the section \"Attributes -- Common Attributes\", the description of Attribute \"port\" is slightly diffrent to the facts.\n\nIt says \"port &lt;= bindPort &lt;= port+autoBind\", but this should be written \n\"port &lt;= bindPort &lt; port+autoBind\".\nAnd \"port in the range 4000-4100.\" also shoud be written \"port in the range 4000-4099.\"\n\nFor example, I try (port=4000, and autoBind=10), then the receiver tried to open port in the range of 4000-4009. It didn\'t try port 4010.','2013-04-20 14:06:39','Yusuke OSUMI','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 trivial','a5f369a','Violeta Georgieva Georgieva','2013-04-22 03:28:02','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54872 https://issues.apache.org/bugzilla/show_bug.cgi?id=54872 Correct the range for the bindPort of the cluster receiver object. Correct the example.','webapps/docs/config/cluster-receiver.xml'),(295,54807,'Bug 54807 – [jsr356] java.lang.ClassCastException: org.apache.tomcat.websocket.server.WsServerContainer$TemplatePathMatch','Caused by: java.lang.ClassCastException: org.apache.tomcat.websocket.server.WsServerContainer$TemplatePathMatch cannot be cast to java.lang.Comparable\n	at java.util.TreeMap.compare(TreeMap.java:1188)\n	at java.util.TreeMap.put(TreeMap.java:531)\n	at java.util.TreeSet.add(TreeSet.java:255)\n	at org.apache.tomcat.websocket.server.WsServerContainer.addEndpoint(WsServerContainer.java:144)\n	at org.apache.tomcat.websocket.server.WsSci.onStartup(WsSci.java:118)\n	at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5195)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)\n	... 11 more\n\nReproducible when a path is defined as {path}. For example:\n\n    @Override\n    public Set<ServerEndpointConfig> getEndpointConfigs(Set<Class<? extends Endpoint>> endpointClasses) {\n        logger.debug(\"{} detected\", JSR356ServerEndpointConfig.class.getName());\n        return new HashSet<ServerEndpointConfig>() {{\n            add(ServerEndpointConfig.Builder.create(JSR356Endpoint.class, \"/{path}\").configurator(c).build());\n        }};\n    }','2013-04-05 15:38:39','Jean-Francois Arcand','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','0339fec','Mark Emlyn David Thomas','2013-04-19 15:25:49','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54807 Forgot to create TreeSet with correct Comparator. Add a test case that checks the context starts correctly.','java/org/apache/tomcat/websocket/server/WsServerContainer.java\ntest/org/apache/tomcat/websocket/server/TestWebSocketServerContainer.java'),(296,54822,'Bug 54822 – URL with Query String can\'t work over SPDY','','2013-04-10 07:13:22','Sheldon Shao','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Connectors','P2 normal','3da2133','Mark Emlyn David Thomas','2013-04-19 11:20:53','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54822 Fix handling of query strings with SPDY. Based on a patch by Sheldon Shao.','java/org/apache/coyote/spdy/SpdyProcessor.java'),(297,54851,'Bug 54851 – Folder without web-fragment.xml should not impact the status of distributable','','2013-04-16 08:47:44','Trask Stalnaker','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','e97e158','Violeta Georgieva Georgieva','2013-04-16 09:51:06','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54851 Directories without any web.xml fragments should not impact the status of distributable. Patch provided by Trask Stalnaker.','java/org/apache/catalina/startup/ContextConfig.java'),(298,54802,'Bug 54802 – Provide location information for exceptions thrown by JspDocumentParser','','2013-04-04 22:41:48','Konstantin Kolinko','Tomcat Developers Mailing List','NEW','Tomcat 7','Jasper','P2 enhancement','ca5db71','Konstantin Kolinko','2013-04-09 12:35:03','For https://issues.apache.org/bugzilla/show_bug.cgi?id=54802 Provide location information for exceptions thrown by JspDocumentParser','java/org/apache/jasper/compiler/ErrorDispatcher.java\njava/org/apache/jasper/compiler/JspDocumentParser.java\njava/org/apache/jasper/resources/LocalStrings.properties'),(299,54802,'Bug 54802 – Provide location information for exceptions thrown by JspDocumentParser','','2013-04-04 22:41:48','Konstantin Kolinko','Tomcat Developers Mailing List','NEW','Tomcat 7','Jasper','P2 enhancement','2c4fc00','Konstantin Kolinko','2013-04-04 19:00:53','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54802 Provide location information for exceptions thrown by JspDocumentParser','java/org/apache/jasper/compiler/JspDocumentParser.java'),(300,54755,'Bug 54755 – Type-based Endpoint\'s cannot be deployed by instance','For type-based Endpoint\'s, WsServlet instantiates the Endpoint via reflection instead of using the Configurator as is done in PojoEndpointServer:\n\nsec.getConfigurator().getEndpointInstance(sec.getEndpointClass())','2013-03-26 14:52:29','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','d025179','Mark Emlyn David Thomas','2013-03-26 17:19:51','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54755 Endpoint instantiation should be via Configurator Patch provided by rstoyanchev','java/org/apache/tomcat/websocket/server/WsServlet.java'),(301,54748,'Bug 54748 – IOException in echo WebSocket example','The IOException \"New frame received after a close control frame\" is raised after pressing Disconnect. The exception can be detected by adding an onError method to EchoEndpoint.','2013-03-25 09:23:09','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','cf0c064','Mark Emlyn David Thomas','2013-03-25 17:54:33','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54748 Don\'t generate an error during a normal close that there is more data to read when there isn\'t.','java/org/apache/tomcat/websocket/WsFrameBase.java\njava/org/apache/tomcat/websocket/WsFrameClient.java\njava/org/apache/tomcat/websocket/server/WsFrameServer.java'),(302,54740,'Bug 54740 – Aggressive scan for ServerEndpointConfig','The SCI scan picks up a ServerEndpointConfig declaration even if is package private, a private inner class, or an anonymous class. This may not be specifically related to the websocket support but rather to the way the SCI scan works. Either way there doesn\'t seem to be a way to \"hide\" a class from the scan short of turning it off completely. Is it by design? I could not find any references to that level of detail in the spec. It seems rather aggressive.','2013-03-21 19:24:48','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','65bfedf','Mark Emlyn David Thomas','2013-03-25 15:58:57','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54740 Fix @HandlesTypes','java/org/apache/tomcat/websocket/server/WsSci.java'),(303,54746,'Bug 54746 – Cannot obtain idempotent information from Session in onError method after session closed','See the exception below. I attempted to call getUserProperties() in a method annotated @OnClose. Here is what the WebSocket spec says about this:\n\n[quote]Once the session is closed, it is no longer valid for use by applications. Calling any of its methods (with the exception of the close() methods) once the session has been closed will result in an {@link java.lang.IllegalStateException} being thrown. Developers should retrieve any information from the session during the {@link Endpoint#onClose } method.[/quote]\n\nThis clearly indicates that it is valid to \"retrieve any information from the session\" DURING the call to onClose. Therefore, this exception should not have been thrown.\n\nSEVERE: Failed to call onError method of POJO end point for POJO of type [com.wrox.chat.ChatEndpoint]\njava.lang.reflect.InvocationTargetException\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n	at java.lang.reflect.Method.invoke(Method.java:487)\n	at org.apache.tomcat.websocket.pojo.PojoEndpointBase.onError(PojoEndpointBase.java:127)\n	at org.apache.tomcat.websocket.server.WsHttpUpgradeHandler.onError(WsHttpUpgradeHandler.java:139)\n	at org.apache.tomcat.websocket.server.WsHttpUpgradeHandler.access$300(WsHttpUpgradeHandler.java:42)\n	at org.apache.tomcat.websocket.server.WsHttpUpgradeHandler$WsReadListener.onError(WsHttpUpgradeHandler.java:197)\n	at org.apache.tomcat.websocket.server.WsHttpUpgradeHandler$WsReadListener.onDataAvailable(WsHttpUpgradeHandler.java:183)\n	at org.apache.coyote.http11.upgrade.AbstractServletInputStream.onDataAvailable(AbstractServletInputStream.java:169)\n	at org.apache.coyote.http11.upgrade.AbstractProcessor.upgradeDispatch(AbstractProcessor.java:94)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:618)\n	at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1581)\n	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1537)\n	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)\n	at java.lang.Thread.run(Thread.java:722)\nCaused by: java.lang.IllegalStateException: The WebSocket session has been closed and no method (apart from close()) may be called on a closed session\n	at org.apache.tomcat.websocket.WsSession.checkState(WsSession.java:504)\n	at org.apache.tomcat.websocket.WsSession.getUserProperties(WsSession.java:455)\n	at com.wrox.chat.ChatEndpoint.onError(ChatEndpoint.java:154)\n	... 18 more','2013-03-24 01:37:16','Nick Williams','Tomcat Developers Mailing List','RESOLVED WONTFIX','Tomcat 8','Catalina','P2 major','8c990cb','Mark Emlyn David Thomas','2013-03-25 13:50:00','Code review while looking at https://issues.apache.org/bugzilla/show_bug.cgi?id=54746 No need for this. The container handles it (and now protects against recursive calls if an endpoint does do this).','webapps/examples/WEB-INF/classes/websocket/echo/EchoEndpoint.java'),(304,54746,'Bug 54746 – Cannot obtain idempotent information from Session in onError method after session closed','See the exception below. I attempted to call getUserProperties() in a method annotated @OnClose. Here is what the WebSocket spec says about this:\n\n[quote]Once the session is closed, it is no longer valid for use by applications. Calling any of its methods (with the exception of the close() methods) once the session has been closed will result in an {@link java.lang.IllegalStateException} being thrown. Developers should retrieve any information from the session during the {@link Endpoint#onClose } method.[/quote]\n\nThis clearly indicates that it is valid to \"retrieve any information from the session\" DURING the call to onClose. Therefore, this exception should not have been thrown.\n\nSEVERE: Failed to call onError method of POJO end point for POJO of type [com.wrox.chat.ChatEndpoint]\njava.lang.reflect.InvocationTargetException\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n	at java.lang.reflect.Method.invoke(Method.java:487)\n	at org.apache.tomcat.websocket.pojo.PojoEndpointBase.onError(PojoEndpointBase.java:127)\n	at org.apache.tomcat.websocket.server.WsHttpUpgradeHandler.onError(WsHttpUpgradeHandler.java:139)\n	at org.apache.tomcat.websocket.server.WsHttpUpgradeHandler.access$300(WsHttpUpgradeHandler.java:42)\n	at org.apache.tomcat.websocket.server.WsHttpUpgradeHandler$WsReadListener.onError(WsHttpUpgradeHandler.java:197)\n	at org.apache.tomcat.websocket.server.WsHttpUpgradeHandler$WsReadListener.onDataAvailable(WsHttpUpgradeHandler.java:183)\n	at org.apache.coyote.http11.upgrade.AbstractServletInputStream.onDataAvailable(AbstractServletInputStream.java:169)\n	at org.apache.coyote.http11.upgrade.AbstractProcessor.upgradeDispatch(AbstractProcessor.java:94)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:618)\n	at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1581)\n	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1537)\n	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)\n	at java.lang.Thread.run(Thread.java:722)\nCaused by: java.lang.IllegalStateException: The WebSocket session has been closed and no method (apart from close()) may be called on a closed session\n	at org.apache.tomcat.websocket.WsSession.checkState(WsSession.java:504)\n	at org.apache.tomcat.websocket.WsSession.getUserProperties(WsSession.java:455)\n	at com.wrox.chat.ChatEndpoint.onError(ChatEndpoint.java:154)\n	... 18 more','2013-03-24 01:37:16','Nick Williams','Tomcat Developers Mailing List','RESOLVED WONTFIX','Tomcat 8','Catalina','P2 major','56770ff','Mark Emlyn David Thomas','2013-03-25 13:49:08','Code review while looking at https://issues.apache.org/bugzilla/show_bug.cgi?id=54746 Prevent recursive close calls.','java/org/apache/tomcat/websocket/WsSession.java'),(305,54740,'Bug 54740 – Aggressive scan for ServerEndpointConfig','The SCI scan picks up a ServerEndpointConfig declaration even if is package private, a private inner class, or an anonymous class. This may not be specifically related to the websocket support but rather to the way the SCI scan works. Either way there doesn\'t seem to be a way to \"hide\" a class from the scan short of turning it off completely. Is it by design? I could not find any references to that level of detail in the spec. It seems rather aggressive.','2013-03-21 19:24:48','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','e1998a0','Mark Emlyn David Thomas','2013-03-25 11:01:41','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54740 Update SCI scan to reflect changes in spec','java/org/apache/tomcat/websocket/server/WsSci.java'),(306,54734,'Bug 54734 – Tomcat Servlet 3.1 API needs to be synchronized with Proposed Final Draft','','2013-03-20 18:50:43','Nick Williams','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Specification APIs','P2 major','0f83d0b','Mark Emlyn David Thomas','2013-03-25 10:20:35','Partial fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=54734 Implement new method ServletContext#getgetVirtualServerName()','java/javax/servlet/ServletContext.java\njava/org/apache/catalina/core/ApplicationContext.java\njava/org/apache/catalina/core/ApplicationContextFacade.java\njava/org/apache/jasper/servlet/JspCServletContext.java'),(307,54734,'Bug 54734 – Tomcat Servlet 3.1 API needs to be synchronized with Proposed Final Draft','','2013-03-20 18:50:43','Nick Williams','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Specification APIs','P2 major','f03c170','Mark Emlyn David Thomas','2013-03-25 10:05:25','Partial fox for https://issues.apache.org/bugzilla/show_bug.cgi?id=54734 Add new throws Based on a patch by Nick Williams','java/javax/servlet/ReadListener.java\njava/javax/servlet/WriteListener.java\njava/org/apache/catalina/core/AsyncContextImpl.java\njava/org/apache/coyote/http11/upgrade/AbstractServletInputStream.java\njava/org/apache/coyote/http11/upgrade/AbstractServletOutputStream.java'),(308,54732,'Bug 54732 – StatementCache interceptor does not forward calls to Statement.close() which causes memory leaks','','2013-03-20 16:09:31','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 major','8cf47b4','Konstantin Kolinko','2013-03-22 09:44:00','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54732 Fix leak of statements in StatementCache interceptor.','modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/interceptor/StatementCache.java\nmodules/jdbc-pool/src/test/java/org/apache/tomcat/jdbc/pool/interceptor/StatementCounterInterceptor.java\nmodules/jdbc-pool/src/test/java/org/apache/tomcat/jdbc/test/TestStatementCache.java'),(309,54599,'Bug 54599 – DataSource password is exposed to applications via toString method','On the server side, create a DataSource using \"org.apache.tomcat.jdbc.pool.DataSourceFactory\".\n\nEx:\n\n        <Resource auth=\"Container\"\n                  description=\"\"\n                  name=\"jdbc/testTomcatJdbc\"\n                  factory=\"org.apache.tomcat.jdbc.pool.DataSourceFactory\"\n                  type=\"javax.sql.DataSource\"\n                  username=\"sa\"\n                  password=\"super-secret\"\n                  driverClassName=\"org.h2.Driver\"\n                  url=\"jdbc:h2:mem:test\"\n                  minIdle=\"1\"\n                  initialSize=\"1\" />\n\nIn a web application, create a JSP file, add the following:\n\n<%@ page import=\"javax.naming.*\" session=\"false\" %>\n<!DOCTYPE HTML>\n<html>\n\n<head>\n    <title>Display Password!</title>\n</head>\n<body>\n    <h1>toString for Tomcat JDBC</h1>\n    <%\n      dataSource = (javax.sql.DataSource) ctx.lookup(\"java:/comp/env/jdbc/testTomcatJdbc\");\n      out.println(\"<p>\" + dataSource.toString() + \"</p>\");\n    %>\n</body>\n</html>\n\nAccess the JSP in your browser.  The output from toString on the DataSource will display the password that was configured in the <Resource/> tag.\n\nExample Output:\n\ntoString for Tomcat JDBC\n\norg.apache.tomcat.jdbc.pool.DataSource@75cae120{ConnectionPool[defaultAutoCommit=null; defaultReadOnly=null; defaultTransactionIsolation=-1; defaultCatalog=null; driverClassName=org.h2.Driver; maxActive=100; maxIdle=100; minIdle=1; initialSize=1; maxWait=30000; testOnBorrow=false; testOnReturn=false; timeBetweenEvictionRunsMillis=5000; numTestsPerEvictionRun=0; minEvictableIdleTimeMillis=60000; testWhileIdle=false; testOnConnect=false; password=super-secret; url=jdbc:h2:mem:test; username=sa; validationQuery=null; validatorClassName=null; validationInterval=30000; accessToUnderlyingConnectionAllowed=true; removeAbandoned=false; removeAbandonedTimeout=60; logAbandoned=false; connectionProperties=null; initSQL=null; jdbcInterceptors=null; jmxEnabled=true; fairQueue=true; useEquals=true; abandonWhenPercentageFull=0; maxAge=0; useLock=false; dataSource=null; dataSourceJNDI=null; suspectTimeout=0; alternateUsernameAllowed=false; commitOnReturn=false; rollbackOnReturn=false; useDisposableConnectionFacade=true; logValidationErrors=false; propagateInterruptState=false; }','2013-02-22 16:37:23','Daniel Mikusa','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 minor','8445d9a','Konstantin Kolinko','2013-03-22 05:16:06','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54599 jdbc-pool: Do not expose connection password via DataSource.toString(). Based on a patch by Daniel Mikusa','modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/PoolProperties.java'),(310,54734,'Bug 54734 – Tomcat Servlet 3.1 API needs to be synchronized with Proposed Final Draft','','2013-03-20 18:50:43','Nick Williams','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Specification APIs','P2 major','4596307','Mark Emlyn David Thomas','2013-03-21 09:09:41','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54734 Partial fix javax.servlet.http.WebConnection needs to extend AutoCloseable Based on a patch by Nick Williams','java/javax/servlet/http/WebConnection.java\njava/org/apache/coyote/http11/upgrade/AbstractProcessor.java\njava/org/apache/tomcat/websocket/server/LocalStrings.properties\njava/org/apache/tomcat/websocket/server/WsHttpUpgradeHandler.java'),(311,54726,'Bug 54726 – JAR file META-INF/services resources missing for WebSocket in latest tomcat-embed-core-8.0 snapshot artifact','','2013-03-19 17:31:44','Nick Williams','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Packaging','P2 major','0799df3','Mark Emlyn David Thomas','2013-03-19 16:34:48','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54726 Include WebSocket META-INF files in core embedded JAR','build.xml'),(312,54716,'Bug 54716 – WebSocket implementation \"freaks out\" if Session closed or exception thrown from onOpen method','If Session#close() is called from an onOpen method, the container throws a NullPointerException, as evidenced below:\n\nMar 17, 2013 10:57:50 PM org.apache.coyote.AbstractProtocol$AbstractConnectionHandler process\nSEVERE: Error reading request, ignored\njava.lang.IllegalArgumentException: Failed to call onOpen method of POJO end point for POJO of type [com.wrox.chat.ChatEndpoint]\n	at org.apache.tomcat.websocket.pojo.PojoEndpointBase.doOnOpen(PojoEndpointBase.java:54)\n	at org.apache.tomcat.websocket.pojo.PojoEndpointServer.onOpen(PojoEndpointServer.java:69)\n	at org.apache.tomcat.websocket.server.WsProtocolHandler.init(WsProtocolHandler.java:107)\n	at org.apache.coyote.http11.upgrade.AbstractProcessor.<init>(AbstractProcessor.java:51)\n	at org.apache.coyote.http11.upgrade.NioProcessor.<init>(NioProcessor.java:31)\n	at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.createUpgradeProcessor(Http11NioProtocol.java:309)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:634)\n	at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1581)\n	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1540)\n	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)\n	at java.lang.Thread.run(Thread.java:722)\nCaused by: java.lang.reflect.InvocationTargetException\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n	at java.lang.reflect.Method.invoke(Method.java:487)\n	at org.apache.tomcat.websocket.pojo.PojoEndpointBase.doOnOpen(PojoEndpointBase.java:51)\n	... 12 more\nCaused by: java.lang.NullPointerException\n	at org.apache.tomcat.websocket.BackgroundProcessManager.unregister(BackgroundProcessManager.java:75)\n	at org.apache.tomcat.websocket.WsWebSocketContainer.unregisterSession(WsWebSocketContainer.java:283)\n	at org.apache.tomcat.websocket.server.WsServerContainer.unregisterSession(WsServerContainer.java:283)\n	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:357)\n	at org.apache.tomcat.websocket.WsSession.close(WsSession.java:305)\n	at com.wrox.chat.ChatEndpoint.onOpen(ChatEndpoint.java:54)\n	... 17 more\n\nIf this or any other exceptions are thrown from an onOpen method, even if the session isn\'t closed, Tomcat starts randomly rejecting a handful of requests with no explanation in the logs, and on shut down dozens of these errors appear on stderr:\n\nMar 17, 2013 11:22:11 PM org.apache.tomcat.util.modeler.Registry unregisterComponent\nSEVERE: Error unregistering mbean \njavax.management.RuntimeOperationsException: Object name cannot be null\n	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.isRegistered(DefaultMBeanServerInterceptor.java:569)\n	at com.sun.jmx.mbeanserver.JmxMBeanServer.isRegistered(JmxMBeanServer.java:628)\n	at org.apache.tomcat.util.modeler.Registry.unregisterComponent(Registry.java:420)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.unregister(AbstractProtocol.java:768)\n	at org.apache.coyote.AbstractProtocol$RecycledProcessors.clear(AbstractProtocol.java:820)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.recycle(AbstractProtocol.java:578)\n	at org.apache.tomcat.util.net.NioEndpoint.releaseCaches(NioEndpoint.java:318)\n	at org.apache.tomcat.util.net.NioEndpoint.unbind(NioEndpoint.java:481)\n	at org.apache.tomcat.util.net.AbstractEndpoint.destroy(AbstractEndpoint.java:675)\n	at org.apache.coyote.AbstractProtocol.destroy(AbstractProtocol.java:522)\n	at org.apache.catalina.connector.Connector.destroyInternal(Connector.java:1020)\n	at org.apache.catalina.util.LifecycleBase.destroy(LifecycleBase.java:305)\n	at org.apache.catalina.core.StandardService.destroyInternal(StandardService.java:584)\n	at org.apache.catalina.util.LifecycleBase.destroy(LifecycleBase.java:305)\n	at org.apache.catalina.core.StandardServer.destroyInternal(StandardServer.java:835)\n	at org.apache.catalina.util.LifecycleBase.destroy(LifecycleBase.java:305)\n	at org.apache.catalina.startup.Catalina.stop(Catalina.java:719)\n	at org.apache.catalina.startup.Catalina.start(Catalina.java:680)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n	at java.lang.reflect.Method.invoke(Method.java:487)\n	at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:357)\n	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:491)\nCaused by: java.lang.IllegalArgumentException: Object name cannot be null\n	... 24 more','2013-03-18 05:48:12','Nick Williams','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 major','8fdcf63','Mark Emlyn David Thomas','2013-03-19 15:58:34','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54716 Additional fix. Avoid NPE on session de-registration. Based on a patch by Nick Williams.','java/org/apache/tomcat/websocket/BackgroundProcessManager.java\njava/org/apache/tomcat/websocket/WsWebSocketContainer.java'),(313,54724,'Bug 54724 – WsSession does not throw IllegalStateException if closed when methods on it are called','Spec JavaDoc says:\n\n\"Once the session is closed, it is no longer valid for use by applications. Calling any of its methods once the session has been closed will result in an IllegalStateException being thrown. Developers should retrieve any information from the session during the Endpoint.onClose(Session, CloseReason) method.\"\n\nOf course, the rules of Closeable also apply here, and calling Session#close(...) more than once should have no effect subsequent times.\n\nThere are actually three problems here:\n\n1) None of the methods throw IllegalStateException if the session is closed. Instead, they return things (like the basic remote, for example), and some methods in the endpoint implementation will not notice concurrent exceptions from the socket and then block forever waiting four the Countdown to clear.\n\n2) The Session#state is never actually changed to State.CLOSED unless Session#onClose is called. However, Session#onClose is never actually called that I can find (though I will look harder before I make changes).\n\n3) Even in Session#onClose, the state is incorrectly changed to State.CLOSED BEFORE Endpoint#onClose is called, when it should be changed AFTER.\n\nI\'m working on a patch for this.','2013-03-19 13:22:56','Nick Williams','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 major','12f89ff','Mark Emlyn David Thomas','2013-03-19 15:49:51','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54724 Session should throw IllegalStateException if closed when methods on it are called','java/org/apache/tomcat/websocket/LocalStrings.properties\njava/org/apache/tomcat/websocket/WsSession.java\ntest/org/apache/tomcat/websocket/TestWsWebSocketContainer.java'),(314,54721,'Bug 54721 – RemoteEndpoint blocks indefinitely if sendObject called with BinaryStream of TextStream encoders','','2013-03-18 22:01:43','Nick Williams','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 critical','80ef59a','Mark Emlyn David Thomas','2013-03-19 10:26:49','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54721 RemoteEndpoint blocks indefinitely if sendObject called with BinaryStream of TextStream encoders Patch provided by Nick Williams.','java/org/apache/tomcat/websocket/WsRemoteEndpointImplBase.java'),(315,54716,'Bug 54716 – WebSocket implementation \"freaks out\" if Session closed or exception thrown from onOpen method','If Session#close() is called from an onOpen method, the container throws a NullPointerException, as evidenced below:\n\nMar 17, 2013 10:57:50 PM org.apache.coyote.AbstractProtocol$AbstractConnectionHandler process\nSEVERE: Error reading request, ignored\njava.lang.IllegalArgumentException: Failed to call onOpen method of POJO end point for POJO of type [com.wrox.chat.ChatEndpoint]\n	at org.apache.tomcat.websocket.pojo.PojoEndpointBase.doOnOpen(PojoEndpointBase.java:54)\n	at org.apache.tomcat.websocket.pojo.PojoEndpointServer.onOpen(PojoEndpointServer.java:69)\n	at org.apache.tomcat.websocket.server.WsProtocolHandler.init(WsProtocolHandler.java:107)\n	at org.apache.coyote.http11.upgrade.AbstractProcessor.<init>(AbstractProcessor.java:51)\n	at org.apache.coyote.http11.upgrade.NioProcessor.<init>(NioProcessor.java:31)\n	at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.createUpgradeProcessor(Http11NioProtocol.java:309)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:634)\n	at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1581)\n	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1540)\n	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)\n	at java.lang.Thread.run(Thread.java:722)\nCaused by: java.lang.reflect.InvocationTargetException\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n	at java.lang.reflect.Method.invoke(Method.java:487)\n	at org.apache.tomcat.websocket.pojo.PojoEndpointBase.doOnOpen(PojoEndpointBase.java:51)\n	... 12 more\nCaused by: java.lang.NullPointerException\n	at org.apache.tomcat.websocket.BackgroundProcessManager.unregister(BackgroundProcessManager.java:75)\n	at org.apache.tomcat.websocket.WsWebSocketContainer.unregisterSession(WsWebSocketContainer.java:283)\n	at org.apache.tomcat.websocket.server.WsServerContainer.unregisterSession(WsServerContainer.java:283)\n	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:357)\n	at org.apache.tomcat.websocket.WsSession.close(WsSession.java:305)\n	at com.wrox.chat.ChatEndpoint.onOpen(ChatEndpoint.java:54)\n	... 17 more\n\nIf this or any other exceptions are thrown from an onOpen method, even if the session isn\'t closed, Tomcat starts randomly rejecting a handful of requests with no explanation in the logs, and on shut down dozens of these errors appear on stderr:\n\nMar 17, 2013 11:22:11 PM org.apache.tomcat.util.modeler.Registry unregisterComponent\nSEVERE: Error unregistering mbean \njavax.management.RuntimeOperationsException: Object name cannot be null\n	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.isRegistered(DefaultMBeanServerInterceptor.java:569)\n	at com.sun.jmx.mbeanserver.JmxMBeanServer.isRegistered(JmxMBeanServer.java:628)\n	at org.apache.tomcat.util.modeler.Registry.unregisterComponent(Registry.java:420)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.unregister(AbstractProtocol.java:768)\n	at org.apache.coyote.AbstractProtocol$RecycledProcessors.clear(AbstractProtocol.java:820)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.recycle(AbstractProtocol.java:578)\n	at org.apache.tomcat.util.net.NioEndpoint.releaseCaches(NioEndpoint.java:318)\n	at org.apache.tomcat.util.net.NioEndpoint.unbind(NioEndpoint.java:481)\n	at org.apache.tomcat.util.net.AbstractEndpoint.destroy(AbstractEndpoint.java:675)\n	at org.apache.coyote.AbstractProtocol.destroy(AbstractProtocol.java:522)\n	at org.apache.catalina.connector.Connector.destroyInternal(Connector.java:1020)\n	at org.apache.catalina.util.LifecycleBase.destroy(LifecycleBase.java:305)\n	at org.apache.catalina.core.StandardService.destroyInternal(StandardService.java:584)\n	at org.apache.catalina.util.LifecycleBase.destroy(LifecycleBase.java:305)\n	at org.apache.catalina.core.StandardServer.destroyInternal(StandardServer.java:835)\n	at org.apache.catalina.util.LifecycleBase.destroy(LifecycleBase.java:305)\n	at org.apache.catalina.startup.Catalina.stop(Catalina.java:719)\n	at org.apache.catalina.startup.Catalina.start(Catalina.java:680)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n	at java.lang.reflect.Method.invoke(Method.java:487)\n	at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:357)\n	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:491)\nCaused by: java.lang.IllegalArgumentException: Object name cannot be null\n	... 24 more','2013-03-18 05:48:12','Nick Williams','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 major','ccb4f38','Mark Emlyn David Thomas','2013-03-19 10:22:33','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54716 Make Calling on POJO method more robust if those methods throw an exception.','java/org/apache/tomcat/websocket/pojo/LocalStrings.properties\njava/org/apache/tomcat/websocket/pojo/PojoEndpointBase.java\ntest/org/apache/tomcat/websocket/pojo/TestPojoEndpointBase.java'),(316,54710,'Bug 54710 – Java WebSocket specification says @OnMessage methods can have InputStream/Reader parameters; @OnClose can have CloseReason parameters','','2013-03-17 09:59:10','Nick Williams','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 critical','06800eb','Mark Emlyn David Thomas','2013-03-18 17:47:02','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54710 Add support for InputStream and Reader to OnMessage Add support for CloseReason to OnClose Based on a patch by Nick Williams','java/org/apache/tomcat/websocket/pojo/LocalStrings.properties\njava/org/apache/tomcat/websocket/pojo/PojoEndpointBase.java\njava/org/apache/tomcat/websocket/pojo/PojoMessageHandlerBase.java\njava/org/apache/tomcat/websocket/pojo/PojoMessageHandlerPartialBase.java\njava/org/apache/tomcat/websocket/pojo/PojoMessageHandlerPartialBinary.java\njava/org/apache/tomcat/websocket/pojo/PojoMessageHandlerPartialText.java\njava/org/apache/tomcat/websocket/pojo/PojoMessageHandlerWholeBase.java\njava/org/apache/tomcat/websocket/pojo/PojoMessageHandlerWholeBinary.java\njava/org/apache/tomcat/websocket/pojo/PojoMessageHandlerWholePong.java\njava/org/apache/tomcat/websocket/pojo/PojoMessageHandlerWholeText.java\njava/org/apache/tomcat/websocket/pojo/PojoMethodMapping.java'),(317,54711,'Bug 54711 – Strange problem with WsOutputStream; cannot write to it, Session gets closed instead','','2013-03-17 10:34:28','Nick Williams','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 blocker','0c5ff5d','Mark Emlyn David Thomas','2013-03-18 16:56:39','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54711 Fix multiple issues with OutputStream and Writer Based on a patch by Nick Williams','java/org/apache/tomcat/websocket/WsRemoteEndpointImplBase.java'),(318,54711,'Bug 54711 – Strange problem with WsOutputStream; cannot write to it, Session gets closed instead','','2013-03-17 10:34:28','Nick Williams','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 blocker','e54b701','Mark Emlyn David Thomas','2013-03-18 16:45:58','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54711 Part of https://issues.apache.org/bugzilla/show_bug.cgi?id=54711 Use timeout value to ensure infinite write timeouts are supported for clients.','java/org/apache/tomcat/websocket/WsRemoteEndpointImplClient.java'),(319,54711,'Bug 54711 – Strange problem with WsOutputStream; cannot write to it, Session gets closed instead','','2013-03-17 10:34:28','Nick Williams','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 blocker','e54b701','Mark Emlyn David Thomas','2013-03-18 16:45:58','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54711 Part of https://issues.apache.org/bugzilla/show_bug.cgi?id=54711 Use timeout value to ensure infinite write timeouts are supported for clients.','java/org/apache/tomcat/websocket/WsRemoteEndpointImplClient.java'),(320,54609,'Bug 54609 – Running service install on 7.0.37 on Windows 2008 adds unexpected characters to service executable path','','2013-02-25 21:08:01','Clark','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Packaging','P2 major','8481588','Konstantin Kolinko','2013-03-18 16:25:36','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54609 Update to Commons Daemon 1.0.14 (Already done in TC7 with r1457889 )','build.properties.default'),(321,54709,'Bug 54709 – Official schemes for WebSocket are \"ws\"/\"wss\"; WsWebSocketContainer only allows \"http\"/\"https\"','','2013-03-17 08:54:31','Nick Williams','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 critical','ad148dd','Mark Emlyn David Thomas','2013-03-17 14:49:45','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54709 http  -> ws https -> wss','java/org/apache/tomcat/websocket/WsWebSocketContainer.java\ntest/org/apache/tomcat/websocket/TestWsRemoteEndpoint.java\ntest/org/apache/tomcat/websocket/TestWsWebSocketContainer.java\ntest/org/apache/tomcat/websocket/pojo/TestEncodingDecoding.java\ntest/org/apache/tomcat/websocket/pojo/TestPojoMethodMapping.java'),(322,54712,'Bug 54712 – Prefer Locale.ENGLISH over Locale.US for case conversion','','2013-03-17 12:54:09','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','dc16474','Mark Emlyn David Thomas','2013-03-17 10:07:25','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54712 Code clean-up. Use Locale.ENGLISH consistently for upper/lower case conversions.','java/org/apache/catalina/connector/Connector.java\njava/org/apache/tomcat/util/buf/B2CConverter.java\njava/org/apache/tomcat/util/http/parser/HttpParser.java\njava/org/apache/tomcat/util/http/parser/MediaType.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/PoolProperties.java\ntest/org/apache/catalina/startup/SimpleHttpClient.java'),(323,54707,'Bug 54707 – Buggy Perl http clients cause tomcat digest auth to fail due to quoted nc values (e.g. nc=\"00000001\")','','2013-03-15 17:41:24','bruce weertman','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','b3f5177','Konstantin Kolinko','2013-03-16 22:30:49','https://issues.apache.org/bugzilla/show_bug.cgi?id=54707 Review of r1457303: 1) Correct comments. 2) In readLhex(..): Document lowercase conversion. It was documented before r1457303 and I think it is in line with support for incorrect values implemented in response to BZ 54707. Convert digits to lowercase on the fly, instead of relying on String.toLowerCase() call. This should generate less garbage for GC.','java/org/apache/tomcat/util/http/parser/HttpParser.java\ntest/org/apache/tomcat/util/http/parser/TestAuthorizationDigest.java'),(324,54707,'Bug 54707 – Buggy Perl http clients cause tomcat digest auth to fail due to quoted nc values (e.g. nc=\"00000001\")','','2013-03-15 17:41:24','bruce weertman','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','b3f5177','Konstantin Kolinko','2013-03-16 22:30:49','https://issues.apache.org/bugzilla/show_bug.cgi?id=54707 Review of r1457303: 1) Correct comments. 2) In readLhex(..): Document lowercase conversion. It was documented before r1457303 and I think it is in line with support for incorrect values implemented in response to BZ 54707. Convert digits to lowercase on the fly, instead of relying on String.toLowerCase() call. This should generate less garbage for GC.','java/org/apache/tomcat/util/http/parser/HttpParser.java\ntest/org/apache/tomcat/util/http/parser/TestAuthorizationDigest.java'),(325,54707,'Bug 54707 – Buggy Perl http clients cause tomcat digest auth to fail due to quoted nc values (e.g. nc=\"00000001\")','','2013-03-15 17:41:24','bruce weertman','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','db68cf2','Mark Emlyn David Thomas','2013-03-16 16:02:37','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54707 Relax parsing of LHEX and <\">LHEX<\"> to allow either whenever one is expected Additionally:  - improve comments  - move back one char when parsing in a consistent manner  - fix edge case bug if first character of quoted token was not valid (it was incorrectly accepted)','java/org/apache/tomcat/util/http/parser/HttpParser.java'),(326,54631,'Bug 54631 – @PathParam is not working with @OnMessage','I have defined server end-point as:\n\n@ServerEndpoint(value = \"/ws/{mid}/{rid}/{uid}\")\n\nWhen using @PathParam with @OnMessage, values are null. Other annotations like @OnOpen and @OnClose print values specified in URL.\n\n@OnMessage\npublic void onTextMessage(@PathParam(\"mid\") Long mid, @PathParam(\"rid\") Integer rid, @PathParam(\"uid\") Long uid, Session session, String message, boolean pair) {\n	log.debug(\"[TEXT]\" + \" : \" + mid + \" : \" + rid + \" : \" + uid + message + \" : \" + session.getRequestURI());\n}','2013-03-04 05:03:35','Rahul','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Specification APIs','P2 normal','7fd7279','Mark Emlyn David Thomas','2013-03-15 16:41:58','Add a test that confirms BZ 54631 is not an issue. An added bonus was that this test found the close process was not correct. That has now been fixed.','test/org/apache/tomcat/websocket/pojo/TestPojoMethodMapping.java'),(327,54702,'Bug 54702 – File descriptor leak at web.xml loading','Hello\n\nI think I\'ve found a file descriptor leak in file /tomcat/trunk/java/org/apache/catalina/startup/ContextConfig.java (method getGlobalWebXmlSource).\n\nA stream is from file \"web.xml\" is not closed.\n\nprivate WebXml getDefaultWebXmlFragment() {\n... \n\n1284	        InputSource globalWebXml = getGlobalWebXmlSource();\n...\n1337	            // Parse global web.xml if present\n1338	            if (globalWebXml == null) {\n1339	                // This is unusual enough to log\n1340	                log.info(sm.getString(\"contextConfig.defaultMissing\"));\n1341	            } else {\n1342	                parseWebXml(globalWebXml, webXmlDefaultFragment, false);\n1343	            }\n\nHere is the full stack trace\n\n[java.io.FileInputStream.<init>(FileInputStream.java:109)] [org.apache.catalina.startup.ContextConfig.getWebXmlSource(ContextConfig.java:1837)] [org.apache.catalina.startup.ContextConfig.getGlobalWebXmlSource(ContextConfig.java:1744)] [org.apache.catalina.startup.ContextConfig.getDefaultWebXmlFragment(ContextConfig.java:1417)] [org.apache.catalina.startup.ContextConfig.webConfig(ContextConfig.java:1253)] [org.apache.catalina.startup.ContextConfig.configureStart(ContextConfig.java:878)] [org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:369)] [org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)] [org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90)] [org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5173)] [org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)] [org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:901)] [org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:877)] [org.apache.catalina.core.StandardHost.addChild(StandardHost.java:633)] [org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:977)] [org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:542)] [org.apache.catalina.startup.HostConfig.check(HostConfig.java:1462)] [sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)] [sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)] [sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)] [java.lang.reflect.Method.invoke(Method.java:597)] [org.apache.tomcat.util.modeler.BaseModelMBean.invoke(BaseModelMBean.java:301)] [com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:836)] [com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:761)] [org.apache.catalina.manager.ManagerServlet.check(ManagerServlet.java:1445)] [org.apache.catalina.manager.HTMLManagerServlet.upload(HTMLManagerServlet.java:301)] [org.apache.catalina.manager.HTMLManagerServlet.doPost(HTMLManagerServlet.java:208)] [javax.servlet.http.HttpServlet.service(HttpServlet.java:647)] [javax.servlet.http.HttpServlet.service(HttpServlet.java:728)] [org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)] [org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)] [org.apache.catalina.filters.CsrfPreventionFilter.doFilter(CsrfPreventionFilter.java:213)] [org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)] [org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)] [org.apache.catalina.filters.SetCharacterEncodingFilter.doFilter(SetCharacterEncodingFilter.java:108)] [org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)] [org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)] [org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:222)] [org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)] [org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:581)] [org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:171)] [org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99)] [org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:931)] [org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)] [org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)] [org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1004)] [org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:589)] [org.apache.tomcat.util.net.AprEndpoint$SocketProcessor.run(AprEndpoint.java:1822)] [java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)] [java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)] [java.lang.Thread.run(Thread.java:662)]','2013-03-15 08:53:36','Jean-Marie LAMARE','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','7c88af9','Violeta Georgieva Georgieva','2013-03-15 09:57:19','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54702 Close the stream at the end of the parse operation.','java/org/apache/catalina/startup/ContextConfig.java'),(328,54658,'Bug 54658 – Implement Part#getSubmittedFileName from SERVLET_SPEC-57','','2013-03-09 21:46:36','Nick Williams','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Specification APIs','P2 normal','ca205c1','Mark Emlyn David Thomas','2013-03-14 16:34:32','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54658 Servlet 3.1: Implement getSubmittedFileName() Patch provided by Nick Williams','java/javax/servlet/http/Part.java\njava/org/apache/catalina/connector/Request.java\njava/org/apache/catalina/core/ApplicationPart.java\njava/org/apache/catalina/manager/HTMLManagerServlet.java'),(329,54660,'Bug 54660 – AccessLogValve fileDateFormat can not be changed through JMX','When an AccessLogValve is added to a catalina host with the JMX addVale() operation on the Host object name, the valve will start with the default fileDateFormat.\n\nChanging the attribute on the valve through it\'s JMX object name has no effect because the valve is already started.\n\nExecuting a rotate() operation on the valve does also have no effect.\n\nSteps to Reproduce:\n- Start tomcat server\n- Add Host using JMX\n- Add valve to Host using JMX\n- Set valve attribute fileDateFormat to something else than yyyy-MM-dd, for example yy-MM\n\nActual Results:\nThe access log file format will include the default fileDateFormat of yyyy-MM-dd\n\nExpected Results:\nThe access log file format with yy-MM, as from the example.','2013-03-10 07:09:11','Arnaud Kleinveld','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','2a03ca6','Mark Emlyn David Thomas','2013-03-14 11:47:24','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54660 Allow the AccessLogValve file data format to be changed via JMX. The change takes effect as soon as the next message is logged.','java/org/apache/catalina/valves/AccessLogValve.java'),(330,54690,'Bug 54690 – HTTPS BIO/NIO connector does not enable TLS 1.1 and TLS 1.2 by default','','2013-03-13 17:07:20','Ognjen Blagojevic','Tomcat Developers Mailing List','CLOSED FIXED','Tomcat 7','Connectors','P2 normal','fedf189','Mark Emlyn David Thomas','2013-03-14 10:41:51','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54690 Use server defaults not client defaults for SSL protocols and ciphers if none are defined for the connector.','java/org/apache/tomcat/util/net/jsse/JSSESocketFactory.java'),(331,52318,'Bug 52318 – Version in tomcat-jdbc POM is conflicted with Version in MANIFEST for JULI JAR','<groupId>org.apache.tomcat</groupId>\n<artifactId>tomcat-jdbc</artifactId>\n<version>7.0.22</version>\n\nhas dependenca to apache-juli\n\nMANIFEST:\norg.apache.juli.logging;version=\"[6.0.18, 7.0.0)\"\n\nBUT in POM:\n    <dependency>\n      <groupId>org.apache.tomcat</groupId>\n      <artifactId>tomcat-juli</artifactId>\n      <version>7.0.22</version>\n      <scope>compile</scope>\n    </dependency>\n\nWHY????????','2011-12-11 19:49:02','pan4o','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 critical','cecb131','Violeta Georgieva Georgieva','2013-03-13 10:50:17','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52318 The version for imported package \'org.apache.juli.logging\' is extended to include 7.0.x versions. Patch provided by Martin Lichtin.','modules/jdbc-pool/resources/MANIFEST.MF'),(332,54684,'Bug 54684 – PoolProperties.toString() causes NoClassDefFoundError exception','When turning on DEBUG logging, toString() causes the following exception.\nIt happens in an OSGi environment.\n\nSLF4J: Failed toString() invocation on an object of type [org.apache.tomcat.jdbc.pool.DataSource]\n2013-03-12 14:17:13,612 | DEBUG | Blueprint Extender: 1    | ServiceRecipe                    | lueprint.container.ServiceRecipe  276 | 7 - org.apache.aries.blueprint.core - 1.1.0 | Creating service instance\njava.lang.NoClassDefFoundError: javax/naming/spi/ObjectFactory\n    at java.lang.ClassLoader.defineClass1(Native Method)\n    at java.lang.ClassLoader.defineClass(ClassLoader.java:791)\n    at org.apache.felix.framework.BundleWiringImpl$BundleClassLoader.findClass(BundleWiringImpl.java:2128)\n    at org.apache.felix.framework.BundleWiringImpl.findClassOrResourceByDelegation(BundleWiringImpl.java:1432)\n    at org.apache.felix.framework.BundleWiringImpl.access$400(BundleWiringImpl.java:72)\n    at org.apache.felix.framework.BundleWiringImpl$BundleClassLoader.loadClass(BundleWiringImpl.java:1843)\n    at java.lang.ClassLoader.loadClass(ClassLoader.java:356)\n    at org.apache.tomcat.jdbc.pool.PoolProperties.toString(PoolProperties.java:804)\n    at java.lang.String.valueOf(String.java:2854)\n    at java.lang.StringBuilder.append(StringBuilder.java:128)\n    at org.apache.tomcat.jdbc.pool.DataSourceProxy.toString(DataSourceProxy.java:215)\n    at org.slf4j.helpers.MessageFormatter.safeObjectAppend(MessageFormatter.java:304)\n    at org.slf4j.helpers.MessageFormatter.deeplyAppendParameter(MessageFormatter.java:276)\n    at org.slf4j.helpers.MessageFormatter.arrayFormat(MessageFormatter.java:230)\n    at org.slf4j.helpers.MessageFormatter.format(MessageFormatter.java:124)\n    at org.ops4j.pax.logging.slf4j.Slf4jLogger.debug(Slf4jLogger.java:280)\n    at org.apache.aries.blueprint.container.ServiceRecipe.createService(ServiceRecipe.java:302)\n    at org.apache.aries.blueprint.container.ServiceRecipe.internalGetService(ServiceRecipe.java:249)\n    at org.apache.aries.blueprint.container.ServiceRecipe.internalCreate(ServiceRecipe.java:146)\n    at org.apache.aries.blueprint.di.AbstractRecipe$1.call(AbstractRecipe.java:79)\n    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)\n    at java.util.concurrent.FutureTask.run(FutureTask.java:166)\n    at org.apache.aries.blueprint.di.AbstractRecipe.create(AbstractRecipe.java:88)\n    at org.apache.aries.blueprint.container.BlueprintRepository.createInstances(BlueprintRepository.java:245)\n    at org.apache.aries.blueprint.container.BlueprintRepository.createAll(BlueprintRepository.java:183)\n    at org.apache.aries.blueprint.container.BlueprintContainerImpl.instantiateEagerComponents(BlueprintContainerImpl.java:668)\n    at org.apache.aries.blueprint.container.BlueprintContainerImpl.doRun(BlueprintContainerImpl.java:370)\n    at org.apache.aries.blueprint.container.BlueprintContainerImpl.run(BlueprintContainerImpl.java:261)\n    at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)\n    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)\n    at java.util.concurrent.FutureTask.run(FutureTask.java:166)\n    at org.apache.aries.blueprint.container.ExecutorServiceWrapper.run(ExecutorServiceWrapper.java:106)\n    at org.apache.aries.blueprint.utils.threading.impl.DiscardableRunnable.run(DiscardableRunnable.java:48)\n    at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)\n    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)\n    at java.util.concurrent.FutureTask.run(FutureTask.java:166)\n    at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:178)\n    at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:292)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n    at java.lang.Thread.run(Thread.java:722)\nCaused by: java.lang.ClassNotFoundException: javax.naming.spi.ObjectFactory not found by org.apache.tomcat.jdbc [165]\n    at org.apache.felix.framework.BundleWiringImpl.findClassOrResourceByDelegation(BundleWiringImpl.java:1460)\n    at org.apache.felix.framework.BundleWiringImpl.access$400(BundleWiringImpl.java:72)\n    at org.apache.felix.framework.BundleWiringImpl$BundleClassLoader.loadClass(BundleWiringImpl.java:1843)\n    at java.lang.ClassLoader.loadClass(ClassLoader.java:356)\n    ... 41 more','2013-03-13 08:39:00','Martin Lichtin','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','6600a52','Violeta Georgieva Georgieva','2013-03-13 05:57:37','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54684 Added \'javax.naming.spi\' to the header \'Import-Package\'','modules/jdbc-pool/resources/MANIFEST.MF'),(333,54671,'Bug 54671 – Spec says ServerContainerProvider#getServerContainer() should be public, but implemented package-private in Tomcat 8.0','','2013-03-11 22:31:14','Nick Williams','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Specification APIs','P2 critical','28c599f','Mark Emlyn David Thomas','2013-03-11 18:48:07','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54671 Align implementation with spec','java/javax/websocket/server/ServerContainerProvider.java'),(334,54628,'Bug 54628 – there is something wrong when send binary data by websocket.','there is something wrong when send binary data by websocket.\n\nsee org.apache.catalina.websocket.WsOutbound.doWriteBytes(ByteBuffer, boolean)\n\nI think \n\n// Write the content\n        upgradeOutbound.write(buffer.array(), 0, buffer.limit());\n        upgradeOutbound.flush();\n\nshould change to :\n\n// Write the content\n        upgradeOutbound.write(buffer.array(), buffer.arrayOffset(), buffer.limit());\n        upgradeOutbound.flush();\n\n\nFor example:\nbyte[] bts = new byte[]{1,2,3,4,5}\nByteBuffer bf = ByteBuffer.wrap(bts, 2, 2);\nout.writeBinaryMessage(bf);\n\nI mean write [3,4] to the client, but in fact [1,2,3,4] be sent;','2013-03-02 08:37:25','blee','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 major','e1d16fd','Mark Emlyn David Thomas','2013-03-06 15:52:19','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54628 Only write data from start position in array rather than start of array. Patch provide by blee.','java/org/apache/catalina/websocket/WsOutbound.java'),(335,54624,'Bug 54624 – Form authenticator hangs on re-authentication of POST request behind mod_proxy_ajp','Setup: Tomcat AJP connector behind mod_proxy_ajp, form-based authentication.\n\nWhen session expires and a POST request is submitted, Tomcat shows login form, user logs in, authenticator tries to restore the original POST request. Doing that, it tries to swallow the AJP message body before replacing the body of the request with the original POST request body. It tries to read the first 4 bytes of the AJP message (the message length) and blocks forever waiting for those 4 bytes.','2013-02-28 21:44:55','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 normal','c9e056c','Mark Emlyn David Thomas','2013-03-06 15:45:28','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54624 Read request body before content length header is restored for the old request as AJP connector uses this to determine how many bytes to read (and it will block until they are read)','java/org/apache/catalina/authenticator/FormAuthenticator.java'),(336,54612,'Bug 54612 – Fatal Error when trying to send data to WebSocket with conection closed','','2013-02-27 06:32:43','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 major','1255d32','Mark Emlyn David Thomas','2013-03-06 12:23:57','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54612 Check if socket is closed before trying to write a message to it. Also, flush any partial buffered data before closing the socket.','java/org/apache/catalina/websocket/WsOutbound.java'),(337,54638,'Bug 54638 – /manager/status?XML=true','Hi all,\nin /manager/status?XML=true, informations about memory pools are incorrect.\nfor every row all the values (initial,committed,maximum,used) are the same:\n\nMemory Pools\nName:Eden Space	Type:Heap memory	Initial:143130624	Committed:143130624	Maximum:143130624	Used:143130624\nName:Survivor Space	Type:Heap memory	Initial:17891328	Committed:17891328	Maximum:17891328	Used:17891328\nName:Tenured Gen	Type:Heap memory	Initial:357957632	Committed:357957632	Maximum:357957632	Used:357957632\nName:Code Cache	Type:Non-heap memory	Initial:163840	Committed:8421376	Maximum:33554432	Used:163840\nName:Perm Gen	Type:Non-heap memory	Initial:12582912	Committed:23330816	Maximum:67108864	Used:12582912\nName:Perm Gen [shared-ro]	Type:Non-heap memory	Initial:10485760	Committed:10485760	Maximum:10485760	Used:10485760\nName:Perm Gen [shared-rw]	Type:Non-heap memory	Initial:12582912	Committed:12582912	Maximum:12582912	Used:12582912\n\n\nInstead in the gui page values are correct.','2013-03-05 12:29:57','luca andreoli','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Manager','P2 minor','78b3c10','Konstantin Kolinko','2013-03-05 19:40:04','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54638 The status page of manager webapp was reporting wrong value for \"Used\" memory in XML mode.','java/org/apache/catalina/manager/StatusTransformer.java'),(338,54585,'Bug 54585 – WebappLoader doesn\'t honor delegate attr while constructing jsp_classpath','If custom WebappClassLoader is created with delegate=true then parent-first classloading model is used. Everything works here as expected. However jsp_classpath is always constructed in the following manner:\ncustomWebappClassLoader.urls;parent.urls;parent...parent.urls\nWhereas it is expected to me that if delegate=true then parent\'s urls should come first.','2013-02-19 20:50:13','Eugene Makar','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','9ad4904','Mark Emlyn David Thomas','2013-02-27 19:36:50','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54585 Take account of setting of delegate when building the class path that is passed to Jasper','java/org/apache/catalina/loader/WebappLoader.java'),(339,54601,'Bug 54601 – catalina.sh should not modify $JAVA_OPTS to add $LOGGING_MANAGER','','2013-02-22 17:24:27','Jesse Glick','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Native:Integration','P2 enhancement','7e448a3','Konstantin Kolinko','2013-02-23 16:19:02','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54601 Pass LOGGING_MANAGER value as is, do not modify JAVA_OPTS variable.','bin/catalina.sh'),(340,54602,'Bug 54602 – B2CConverter character decode underflow leaves bytes in buffer','If a request contains a uri that ends in a multi byte character which is missing a byte the extra bytes are left in a buffer which is reused by a future request.\n\nThe problem comes from two different things:\n1) If B2CConverter tries to convert a ByteChunk which ends in a character underflow it does not convert that last character and it is left in a buffer in B2CConver.\n\n2) The B2CConverter in org.apache.catalina.connector.Request is not recycled with the rest of the objects. It looks like this is done intentionally based on the comment above it\'s declaration.\n\nThe issue with B2CConverter can be demonstrated with the code below, which is a simplification of what is done inside of CoyoteAdapter.convertURI():\n\n<code>\nB2CConverter conv = new B2CConverter(\"UTF-8\");\nByteChunk bc = new ByteChunk();\nCharChunk cc = new CharChunk();\nbyte[] bytes = { 0x61, 0x62, 0x63, 0x64, -8, -69, -73, -77 };\n\nbc.append(bytes, 0, bytes.length);\ncc.allocate(bc.getLength(), -1);\nconv.convert(bc, cc, cc.getBuffer().length - cc.getEnd());\nSystem.out.println(cc);\n\ncc.recycle();\nbc.recycle();\n\nbc.append(bytes, 0, bytes.length);\ncc.allocate(bc.getLength(), -1);\nconv.convert(bc, cc, cc.getBuffer().length - cc.getEnd());\nSystem.out.println(cc);\n</code>\n\nIf the B2CConverter was recycled with everything else in Request this would prevent a previous request from corrupting the next request but it doesn\'t fix the issue that a character is dropped from the initial decode.\n\nI tried playing with B2CConverter and the only way I could get the convert to get everything was by ignoring the limit argument and reading to the end of the stream. It looks like tomcat8 is moving in this direction with the move to NIO, however I tried playing with the latest B2CConverter and was still seeing issues with the given byte sequence.','2013-02-22 20:06:36','NateC','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','b2f0e7c','Remy Maucherat','2013-02-22 16:38:20','I forgot to port a portion of my patch, that 54602 had me look at what called recycle.','java/org/apache/catalina/connector/CoyoteAdapter.java'),(341,53871,'Bug 53871 – java.lang.StackOverflowError on deploying a web application','When starting Tomcat 7.0.29 and 7.0.30, and automatically deploying a war file from webapps the following error is thrown:\n14:01:06,380 ERROR [HostConfig:576] Error waiting for multi-thread deployment of context descriptors to complete java.util.concurrent.ExecutionException: java.lang.StackOverflowError\n    at java.util.concurrent.FutureTask$Sync.innerGet(FutureTask.java:252)\n    at java.util.concurrent.FutureTask.get(FutureTask.java:111)\n    at org.apache.catalina.startup.HostConfig.deployDescriptors(HostConfig.java:574)\n    at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:470)\n    at org.apache.catalina.startup.HostConfig.start(HostConfig.java:1413)\n    at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:313)\n    at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\n    at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90)\n    at org.apache.catalina.util.LifecycleBase.setStateInternal(LifecycleBase.java:401)\n    at org.apache.catalina.util.LifecycleBase.setState(LifecycleBase.java:346)\n    at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:1140)\n    at org.apache.catalina.core.StandardHost.startInternal(StandardHost.java:785)\n    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)\n    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1559)\n    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1549)\n    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)\n    at java.util.concurrent.FutureTask.run(FutureTask.java:166)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)\n    at java.lang.Thread.run(Thread.java:722)\n\nCaused by: java.lang.StackOverflowError at java.util.HashSet.(HashSet.java:103) at org.apache.catalina.startup.ContextConfig.populateSCIsForCacheEntry(ContextConfig.java:2243) at org.apache.catalina.startup.ContextConfig.populateSCIsForCacheEntry(ContextConfig.java:2260) at org.apache.catalina.startup.ContextConfig.populateSCIsForCacheEntry(ContextConfig.java:2260)\n...(and many more identical lines)...\n\nHowever this works fine in 7.0.28.','2012-09-14 12:40:44','Robert Pasztor','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','1d5f6d0','Mark Emlyn David Thomas','2013-02-19 11:20:32','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53871 Add the class hierarchy that triggered the StackOverflowError to the error message to aid debugging.','java/org/apache/catalina/startup/ContextConfig.java\njava/org/apache/catalina/startup/LocalStrings.properties'),(342,54203,'Bug 54203 – Part class missing documentation','','2012-11-25 09:02:17','Alan Eliasen','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 enhancement','81eaf63','Mark Emlyn David Thomas','2013-02-13 04:50:21','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54203 Complete Part javadoc. Content copied from Commons FileUpload with minor changes as necessary.','java/javax/servlet/http/Part.java'),(343,54552,'Bug 54552 – Completed Servlet 3.1 spec for changeSessionId, HttpSessionIdListener','','2013-02-12 13:56:32','Nick Williams','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','c11952d','Mark Emlyn David Thomas','2013-02-13 04:28:58','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54552 Servlet 3.1 Implement HttpSessionIdListener and HttpServletRequest#changeSessionId() Patch provided by Nick Williams.','java/javax/servlet/http/HttpServletRequest.java\njava/javax/servlet/http/HttpServletRequestWrapper.java\njava/javax/servlet/http/HttpSessionIdListener.java\njava/org/apache/catalina/connector/LocalStrings.properties\njava/org/apache/catalina/connector/Request.java\njava/org/apache/catalina/connector/RequestFacade.java\njava/org/apache/catalina/core/ApplicationContext.java\njava/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/ha/session/DeltaManager.java\njava/org/apache/catalina/session/ManagerBase.java\njava/org/apache/catalina/websocket/WsHttpServletRequestWrapper.java\nwebapps/docs/changelog.xml'),(344,54536,'Bug 54536 – ErrorReportValve doesn\'t respect HttpServletResponse.sendError(int sc, String msg)','','2013-02-07 12:33:41','Yannis Thanasoulas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','ef9ed07','Mark Emlyn David Thomas','2013-02-12 15:06:11','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54536 If a custom error status is used and a message is provided, display that message via the default error page.','java/org/apache/catalina/valves/ErrorReportValve.java\njava/org/apache/catalina/valves/LocalStrings.properties\ntest/org/apache/catalina/valves/TestErrorReportValve.java'),(345,54239,'Bug 54239 – Extensible EL Interpreter','','2012-12-04 06:56:18','Sheldon Shao','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 enhancement','f8ac6a0','Mark Emlyn David Thomas','2013-02-12 09:50:39','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54239 Enable applications to use a custom EL interpreter. Based on a patch by Sheldon Shao.','java/org/apache/jasper/compiler/ELInterpreter.java\njava/org/apache/jasper/compiler/ELInterpreterFactory.java\njava/org/apache/jasper/compiler/Generator.java\njava/org/apache/jasper/resources/LocalStrings.properties\njava/org/apache/jasper/resources/LocalStrings_es.properties\njava/org/apache/jasper/resources/LocalStrings_fr.properties\njava/org/apache/jasper/resources/LocalStrings_ja.properties\ntest/org/apache/jasper/compiler/TestELInterpreterFactory.java\nwebapps/docs/jasper-howto.xml'),(346,54505,'Bug 54505 – Resource \'closeMethod\' is only documented under <Context> documentation','','2013-01-29 17:04:01','Christopher Schultz','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 enhancement','0565e90','Mark Emlyn David Thomas','2013-02-12 06:50:14','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54505 Clearer links to Tomcat specific options for JNDI resources','webapps/docs/jndi-resources-howto.xml'),(347,54456,'Bug 54456 – ChunkedInputFilter returning EOF when client closes connection without sending end chunk','','2013-01-21 16:45:51','Sudhan Moghe','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','cc2f8db','Mark Emlyn David Thomas','2013-02-07 06:55:36','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54456 If the client aborts the request, make sure this is communicated to the application reading the request body.','java/org/apache/coyote/http11/filters/ChunkedInputFilter.java'),(348,54521,'Bug 54521 – DigestAuthenticator: nonceCountValid() fails in case of simultaneous asynchronous requests of the same client','Concerned components:\norg.apache.catalina.authenticator.DigestAuthenticator\norg.apache.catalina.authenticator.DigestAuthenticator.NonceInfo\n\nScenario:\nA multithreaded client sends two requests within one millisecond. The DigestAuthenticator creates for each request a nonce as well as a NonceInfo instance. The two nonces are equal, as they were created within the same millisecond. When writing data into the cache (method generateNonce()), the second NonceInfo instance overwrites the first one (same key!).\n\nProblem:\nThe two client threads then send a second request with a digest authentication header. In both requests, “nc” (nonce count) is equal “1”, as the nonce has been newly created. In the NonceInfo of the first request, array “seen” is set to “true” for index ((nonceCount + offset) % seen.length). In the second request the same NonceInfo instance is used, as the instance is retrieved from map “nonces” using “nonce” as a key, that is, in both requests the same key is used. Consequently, method “nonceCountValid()“ returns „false“, as  seen[(nonceCount + offset) % seen.length)] has already been set to „true“.  Therefore the authentication fails, although the client has sent a valid digest authentication header.\n\nConclusion:\nWorking with multi-threaded clients with many requests, digest authentication does not function reliably.','2013-02-04 10:54:16','Sven Stieber','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','b68bbb8','Mark Emlyn David Thomas','2013-02-07 06:00:57','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54521 Ensure concurrent requests that require DIGEST auth receive unique nonces.','java/org/apache/catalina/authenticator/DigestAuthenticator.java\ntest/org/apache/catalina/authenticator/TestDigestAuthenticator.java'),(349,54534,'Bug 54534 – JMX connection may load servlet with invalid ClassLoader','','2013-02-06 19:14:48','Robby Morgan','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','a993d7c2','Mark Emlyn David Thomas','2013-02-07 03:34:16','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54534 Ensure that when loading Servlet instances the correct class loader is used.','java/org/apache/catalina/core/StandardWrapper.java'),(350,54513,'Bug 54513 – NullPointerException in AprEndpoint$Poller.run','Trunk at r1441188, running the test suite with APR connector, Native 1.1.26 Windows 32-bit with JDK 7u11.\n\nI encountered the following when running org.apache.catalina.loader.TestVirtualContext test\n\nOn second re-run of the test the same issue happened, so it is as if there is something specific here. I have not encountered the issue with the rest of testsuite yet.\n\n[[[\nFeb 01, 2013 2:07:26 AM org.apache.tomcat.util.net.AprEndpoint$Poller run\nWARNING: Unexpected poller error\njava.lang.NullPointerException\n	at org.apache.tomcat.util.net.AprEndpoint$AprSocketWrapper.access$200(AprEndpoint.java:2198)\n	at org.apache.tomcat.util.net.AprEndpoint$Poller.run(AprEndpoint.java:1632)\n	at java.lang.Thread.run(Thread.java:722)\n]]]\n\nThe code at AprEndpoint$Poller.run(AprEndpoint.java:1632) is\n\n1628 for (int n = 0; n < rv; n++) {\n1629  timeouts.remove(desc[n*2+1]);\n1630  AprSocketWrapper wrapper = connections.get(\n1631          Long.valueOf(desc[n*2+1]));\n1632  wrapper.pollerFlags = wrapper.pollerFlags & ~((int) desc[n*2]);\n\nI suspect that \"wrapper\" is null here.\n\nThe above code is specific to Tomcat trunk and is not present in 7.0.x.\n\n\nWhen this happened, the test hung for 15 minutes (1000 secs) waiting on a socket read. When time out passed, it continued to run all the other tests.\n\n[[[\nTestcase: testAdditionalWebInfClassesPaths took 1 006,735 sec\n	Caused an ERROR\nRead timed out\njava.net.SocketTimeoutException: Read timed out\n	at java.net.SocketInputStream.socketRead0(Native Method)\n	at java.net.SocketInputStream.read(SocketInputStream.java:150)\n	at java.net.SocketInputStream.read(SocketInputStream.java:121)\n	at java.io.BufferedInputStream.fill(BufferedInputStream.java:235)\n	at java.io.BufferedInputStream.read1(BufferedInputStream.java:275)\n	at java.io.BufferedInputStream.read(BufferedInputStream.java:334)\n	at sun.net.www.http.HttpClient.parseHTTPHeader(HttpClient.java:633)\n	at sun.net.www.http.HttpClient.parseHTTP(HttpClient.java:579)\n	at sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1322)\n	at java.net.HttpURLConnection.getResponseCode(HttpURLConnection.java:468)\n	at org.apache.catalina.startup.TomcatBaseTest.methodUrl(TomcatBaseTest.java:247)\n	at org.apache.catalina.startup.TomcatBaseTest.getUrl(TomcatBaseTest.java:219)\n	at org.apache.catalina.startup.TomcatBaseTest.getUrl(TomcatBaseTest.java:213)\n	at org.apache.catalina.startup.TomcatBaseTest.getUrl(TomcatBaseTest.java:202)\n	at org.apache.catalina.loader.TestVirtualContext.assertPageContains(TestVirtualContext.java:326)\n	at org.apache.catalina.loader.TestVirtualContext.assertPageContains(TestVirtualContext.java:320)\n	at org.apache.catalina.loader.TestVirtualContext.testAdditionalWebInfClassesPaths(TestVirtualContext.java:311)\n]]]','2013-01-31 23:15:59','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Connectors','P2 normal','bbb13f6','Mark Emlyn David Thomas','2013-02-02 15:38:29','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54513 Multiple bugs in the new Poller implementation (r1433976) when the endpoint is stopped and then started  - Ensure old Poller thread stops  - Ensure old AsyncTimeout thread stops  - Ensure old sendfile thread stops  - Ensure sockets in keep-alive are closed','java/org/apache/tomcat/util/net/AprEndpoint.java'),(351,54497,'Bug 54497 – RuntimeException in WebappClassLoader.checkThreadLocalMapForLeaks() causes LifecycleException','Observed this when testing Tomcat trunk at r1438747, at WinXP 32-bit, JDK 7u11.\n(running TestWsWebSocketContainer with APR, Tomcat-Native 1.1.26 RC)\n\nThere occurred an NPE in WebappClassLoader.checkThreadLocalMapForLeaks(). It was uncaught and caused LifecycleException and ultimately a failure to stop Tomcat.\n\n===============\nIn stderr:\nSEVERE: A child container failed during stop\njava.util.concurrent.ExecutionException: org.apache.catalina.LifecycleException: Failed to stop component [StandardEngine[Tomcat].StandardHost[localhost].StandardContext[]]\n	at java.util.concurrent.FutureTask$Sync.innerGet(FutureTask.java:252)\n	at java.util.concurrent.FutureTask.get(FutureTask.java:111)\n	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:974)\n	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:232)\n	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1404)\n	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1393)\n	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)\n	at java.util.concurrent.FutureTask.run(FutureTask.java:166)\n	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)\n	at java.lang.Thread.run(Thread.java:722)\nCaused by: org.apache.catalina.LifecycleException: Failed to stop component [StandardEngine[Tomcat].StandardHost[localhost].StandardContext[]]\n	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:236)\n	... 7 more\nCaused by: org.apache.catalina.LifecycleException: Failed to stop component [WebappLoader[]]\n	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:236)\n	at org.apache.catalina.core.StandardContext.stopInternal(StandardContext.java:5365)\n	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:232)\n	... 7 more\nCaused by: java.lang.NullPointerException\n	at sun.reflect.UnsafeFieldAccessorImpl.ensureObj(UnsafeFieldAccessorImpl.java:54)\n	at sun.reflect.UnsafeObjectFieldAccessorImpl.get(UnsafeObjectFieldAccessorImpl.java:36)\n	at java.lang.reflect.Field.get(Field.java:372)\n	at org.apache.catalina.loader.WebappClassLoader.checkThreadLocalMapForLeaks(WebappClassLoader.java:2247)\n	at org.apache.catalina.loader.WebappClassLoader.checkThreadLocalsForLeaks(WebappClassLoader.java:2188)\n	at org.apache.catalina.loader.WebappClassLoader.clearReferences(WebappClassLoader.java:1731)\n	at org.apache.catalina.loader.WebappClassLoader.stop(WebappClassLoader.java:1641)\n	at org.apache.catalina.loader.WebappLoader.stopInternal(WebappLoader.java:491)\n	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:232)\n	... 9 more\n===============\nIn testcase:\nTestcase: testSmallTextBufferClientTextMessage took 2,328 sec\n	Caused an ERROR\nFailed to stop component [StandardServer[-1]]\norg.apache.catalina.LifecycleException: Failed to stop component [StandardServer[-1]]\n	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:236)\n	at org.apache.catalina.startup.Tomcat.stop(Tomcat.java:336)\n	at org.apache.catalina.startup.TomcatBaseTest.tearDown(TomcatBaseTest.java:163)\nCaused by: org.apache.catalina.LifecycleException: Failed to stop component [StandardService[Tomcat]]\n	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:236)\n	at org.apache.catalina.core.StandardServer.stopInternal(StandardServer.java:766)\n	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:232)\nCaused by: org.apache.catalina.LifecycleException: Failed to stop component [StandardEngine[Tomcat]]\n	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:236)\n	at org.apache.catalina.core.StandardService.stopInternal(StandardService.java:501)\n	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:232)\nCaused by: org.apache.catalina.LifecycleException: A child container failed during stop\n	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:981)\n	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:232)\n===============\n\nThoughts:\n1. We should catch throwables in those checkFor**Leaks methods. It should not cause a \"failed to stop component\" failure.\n2. In that method there are many calls to \"table[j]\". The array member should be evaluated only once, so that it does not become null unexpectedly.','2013-01-25 23:16:17','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Catalina','P2 normal','ea16bda','Mark Emlyn David Thomas','2013-02-01 07:45:41','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54497 Make error handling more robust so an error in the leak detection code doesn\'t prevent the Context from stopping unless the error is fatal to the JVM','java/org/apache/catalina/loader/WebappClassLoader.java'),(352,54507,'Bug 54507 – Notification for expired session sent to still initializing servlet context','The Tomcat backgroundprocess for expiring sessions does not wait for the servlet context (application loaded by a filter) to be fully initialized. The following stacktrace happens while Filter.init is still being executed (hence the application is only partly initialized and shouldn\'t receive any work):\n\n        at org.apache.wicket.protocol.http.WebApplication.sessionUnbound(WebApplication.java:552)\n        at org.apache.wicket.session.HttpSessionStore$SessionBindingListener.valueUnbound(HttpSessionStore.java:465)\n        at org.apache.catalina.session.StandardSession.removeAttributeInternal(StandardSession.java:1800)\n        at org.apache.catalina.session.StandardSession.expire(StandardSession.java:865)\n        at org.apache.catalina.session.StandardSession.isValid(StandardSession.java:658)\n        at org.apache.catalina.session.ManagerBase.processExpires(ManagerBase.java:534)\n        at org.apache.catalina.session.ManagerBase.backgroundProcess(ManagerBase.java:519)\n        at org.apache.catalina.core.ContainerBase.backgroundProcess(ContainerBase.java:1352)\n        at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1530)\n        at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1540)\n        at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1540)\n        at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.run(ContainerBase.java:1519)\n        at java.lang.Thread.run(Thread.java:722)','2013-01-31 07:59:11','boschman','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','2f88987','Mark Emlyn David Thomas','2013-02-01 07:10:22','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54507 Don\'t run background processing if the context isn\'t started.','java/org/apache/catalina/core/StandardContext.java'),(353,54507,'Bug 54507 – Notification for expired session sent to still initializing servlet context','The Tomcat backgroundprocess for expiring sessions does not wait for the servlet context (application loaded by a filter) to be fully initialized. The following stacktrace happens while Filter.init is still being executed (hence the application is only partly initialized and shouldn\'t receive any work):\n\n        at org.apache.wicket.protocol.http.WebApplication.sessionUnbound(WebApplication.java:552)\n        at org.apache.wicket.session.HttpSessionStore$SessionBindingListener.valueUnbound(HttpSessionStore.java:465)\n        at org.apache.catalina.session.StandardSession.removeAttributeInternal(StandardSession.java:1800)\n        at org.apache.catalina.session.StandardSession.expire(StandardSession.java:865)\n        at org.apache.catalina.session.StandardSession.isValid(StandardSession.java:658)\n        at org.apache.catalina.session.ManagerBase.processExpires(ManagerBase.java:534)\n        at org.apache.catalina.session.ManagerBase.backgroundProcess(ManagerBase.java:519)\n        at org.apache.catalina.core.ContainerBase.backgroundProcess(ContainerBase.java:1352)\n        at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1530)\n        at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1540)\n        at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1540)\n        at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.run(ContainerBase.java:1519)\n        at java.lang.Thread.run(Thread.java:722)','2013-01-31 07:59:11','boschman','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','d2f6a67','Mark Emlyn David Thomas','2013-02-01 06:55:20','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54507 Don\'t start expiring sessions until the web application is fully started. Stop expiring sessions as soon as the web application is stopped.','java/org/apache/catalina/core/StandardContext.java'),(354,54496,'Bug 54496 – ..tribes.membership.MemberImpl.toString() might be better using .getClass().getName()','public String toString()  {\n StringBuilder buf = new  \n StringBuilder(\"org.apache.catalina.tribes.membership.MemberImpl[\");\n\nMight be better to use .getClass().getName() to cover StaticMember and any other sub-classes that might arise.','2013-01-25 18:34:53','vince stewart','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 trivial','e1e4e4e','Mark Emlyn David Thomas','2013-01-28 10:18:04','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54496 Don\'t use hard-coded class name in toString()','java/org/apache/catalina/tribes/membership/MemberImpl.java'),(355,54060,'Bug 54060 – DigestAuthenticator doesn\'t parse Authorization header correctly','','2012-10-28 21:36:52','Mark Thornton','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','d3f8168','Mark Emlyn David Thomas','2013-01-28 10:07:53','Follow-up to https://issues.apache.org/bugzilla/show_bug.cgi?id=54060 More buggy client implementations of DIGEST auth. This time it is the JDK (Oracle 6.x, Oracle 7.x, OpenJDK 7.*)','java/org/apache/tomcat/util/http/parser/HttpParser.java'),(356,53869,'Bug 53869 – Performance tuning solution to resolve too many cascaded JspContextWrapper issue','','2012-09-13 13:56:24','Sheldon Shao','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 enhancement','ce55f25','Mark Emlyn David Thomas','2013-01-25 07:06:04','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53869 Performance improvement for pages with lots of heavily nested tags. Retain a reference to the root JSP context rather than traversing the hierarchy on every call. Based on a patch suggested by Sheldon Shao.','java/org/apache/jasper/runtime/JspContextWrapper.java'),(357,54483,'Bug 54483 – error in translation','in the file LocalStrings_es.properties under org/apache/catalina/core, the property standardContext.reloadingCompleted has the value \"Se ha completado la Regarga de este Contexto\". \nIt should be \"Se ha completado la recarga de este contexto\".\n\nregarga != recarga\n\n\ngreetings.','2013-01-25 08:07:20','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 trivial','f939dac','Mark Emlyn David Thomas','2013-01-25 05:09:05','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54483 Fix translation s/recycling/reloading/','java/org/apache/catalina/core/LocalStrings_es.properties'),(358,54476,'Bug 54476 – incorrect param specification in javadoc ...tribes.group.GroupChannel send methods','* @param destination Member[] - destination.length > 1\n\nI believe this should be:\n\n    * @param destination Member[] - destination.length > 0','2013-01-23 20:05:14','vince stewart','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','6647531','Mark Emlyn David Thomas','2013-01-24 03:52:26','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54476 Fix Javadoc. destination has minimum length of 1, not 2','java/org/apache/catalina/tribes/group/GroupChannel.java'),(359,54466,'Bug 54466 – No file name information in detail error when compiling the java file generated from a tag file','','2013-01-22 09:07:46','Sheldon Shao','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','d7f744c','Mark Emlyn David Thomas','2013-01-23 14:40:40','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54466 Improve error message by including the name of the file when the java file generated from a tag file cannot be compiled. Based on a patch by Sheldon Shao.','java/org/apache/jasper/compiler/DefaultErrorHandler.java\njava/org/apache/jasper/resources/LocalStrings.properties\njava/org/apache/jasper/resources/LocalStrings_es.properties'),(360,54461,'Bug 54461 – JSP compiler init parameter documented as \"compiler\", actually \"compilerClassName\"','','2013-01-22 03:03:35','Nick Williams','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 major','4f52d27','Mark Emlyn David Thomas','2013-01-23 14:19:34','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54461 Improve the documentation for the compiler attribute in the Jasper how-to','webapps/docs/jasper-howto.xml'),(361,54458,'Bug 54458 – DataSourceRealm should provide more info on SQLException','The getPassword() method of the DataSourceRealm does not log enough information when it encounters an SQL error.  The catch block is:\n\n        } catch(SQLException e) {\n            containerLog.error(\n                    sm.getString(\"dataSourceRealm.getPassword.exception\",\n                                 username));\n        } finally {\n\nit would be really helpful to have some details of what the SQLException is.  I am getting this intermittently, and have resorted to subclassing getPassword() in an attempt to figure out what is going wrong.','2013-01-21 21:56:02','Violeta Georgieva','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','07a930d','Mark Emlyn David Thomas','2013-01-23 10:55:17','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54458 Include exception in error log message Patch provided by Violeta Georgieva','java/org/apache/catalina/realm/DataSourceRealm.java'),(362,54450,'Bug 54450 – Injection fails when part of the servlet properties uses @Resource and the other uses \'injection-target\'','Hi,\n\nI have a servlet with:\n- annotated properties\n- and injection-target declarations in web.xml\n\nWhen I try to request this servlet I receive:\n\n\njavax.naming.NameNotFoundException: Name [envEntry1] is not bound in this Context. Unable to find [envEntry1].\n	at org.apache.naming.NamingContext.lookup(NamingContext.java:820)\n	at org.apache.naming.NamingContext.lookup(NamingContext.java:154)\n	at org.apache.naming.NamingContext.lookup(NamingContext.java:831)\n	at org.apache.naming.NamingContext.lookup(NamingContext.java:168)\n	at org.apache.catalina.core.DefaultInstanceManager.lookupMethodResource(DefaultInstanceManager.java:622)\n	at org.apache.catalina.core.DefaultInstanceManager.processAnnotations(DefaultInstanceManager.java:466)\n	at org.apache.catalina.core.DefaultInstanceManager.newInstance(DefaultInstanceManager.java:157)\n	at org.apache.catalina.core.DefaultInstanceManager.newInstance(DefaultInstanceManager.java:138)\n	at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1137)\n	at org.apache.catalina.core.StandardWrapper.allocate(StandardWrapper.java:858)\n	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:136)\n	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)\n	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)\n	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:171)\n	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99)\n	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)\n	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)\n	at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1004)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:589)\n	at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:310)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n	at java.lang.Thread.run(Thread.java:680)\n\n\nThe problem is that when the application uses \'injection-target\' declarations in \n\norg.apache.catalina.core.DefaultInstanceManager.populateAnnotationsCache(Class<?>, Map<String, String>)\n\nonly the first setter method is evaluated and the rest are skipped.\n\n\nI would like to propose a patch and test case.\n\nI\'m looking forward to your comments.\n\nRegards\nVioleta','2013-01-18 18:18:08','Violeta Georgieva','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','ac78456','Mark Emlyn David Thomas','2013-01-23 05:57:27','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54450 Correctly handle resource injection when part of the servlet properties uses @Resource and the other uses \'injection-target\' Includes test case Patch provided by  Violeta Georgieva.','java/org/apache/catalina/core/DefaultInstanceManager.java\ntest/org/apache/catalina/startup/TestContextConfig.java\ntest/org/apache/catalina/startup/TesterServletWithAnnotations.java\ntest/webapp-3.0-fragments/WEB-INF/web.xml'),(363,54448,'Bug 54448 – Field of primitive type, annotated with @Resource is not recognized as env entry','Hi,\n\nI have a servlet with one field of primitive type.\nThe field is annotated with @Resource.\n\n\npublic class MyServlet extends HttpServlet {\n\n    @Resource(mappedName = \"1\")\n    private int envEntry;\n\n    protected void doGet(HttpServletRequest req, HttpServletResponse resp)\n            throws ServletException, IOException {\n        ...\n    }\n}\n\n\nWhen I request this servlet I receive the following exception:\n\n\nSEVERE: Allocate exception for servlet MyServlet\njavax.naming.NamingException: Cannot create resource instance\n	at org.apache.naming.factory.ResourceEnvFactory.getObjectInstance(ResourceEnvFactory.java:117)\n	at javax.naming.spi.NamingManager.getObjectInstance(NamingManager.java:304)\n	at org.apache.naming.NamingContext.lookup(NamingContext.java:843)\n	at org.apache.naming.NamingContext.lookup(NamingContext.java:154)\n	at org.apache.naming.NamingContext.lookup(NamingContext.java:831)\n	at org.apache.naming.NamingContext.lookup(NamingContext.java:168)\n	at org.apache.catalina.core.DefaultInstanceManager.lookupFieldResource(DefaultInstanceManager.java:581)\n	at org.apache.catalina.core.DefaultInstanceManager.processAnnotations(DefaultInstanceManager.java:470)\n	at org.apache.catalina.core.DefaultInstanceManager.newInstance(DefaultInstanceManager.java:157)\n	at org.apache.catalina.core.DefaultInstanceManager.newInstance(DefaultInstanceManager.java:138)\n	at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1137)\n	at org.apache.catalina.core.StandardWrapper.allocate(StandardWrapper.java:858)\n	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:136)\n	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)\n	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)\n	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:171)\n	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99)\n	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)\n	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)\n	at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1004)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:589)\n	at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:310)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n	at java.lang.Thread.run(Thread.java:680)\n\n\nThat\'s because in the method below the primitive types are not \'converted\' to their corresponding wrappers and this field is interpreted not as env entry but as resource env ref. org.apache.catalina.startup.WebAnnotationSet.addResource(Context, Resource, \nString, String)\n\n\nI\'m attaching a patch that solves this issue and a test case.\n\nI\'m looking forward to your comments.\n\nRegards\nVioleta','2013-01-17 21:48:35','Violeta Georgieva','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','74f5b3a','Mark Emlyn David Thomas','2013-01-23 05:09:03','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54448 Correctly handle @Resource annotations on primitives. Includes test case. Patch provided by Violeta Georgieva.','java/org/apache/catalina/deploy/NamingResources.java\njava/org/apache/catalina/startup/WebAnnotationSet.java\njava/org/apache/catalina/util/Introspection.java\ntest/org/apache/catalina/startup/TestContextConfig.java\ntest/org/apache/catalina/startup/TesterServletWithAnnotations.java'),(364,54324,'Bug 54324 – Support is required to disable TLS compression to prevent against CRIME attacks','','2012-12-18 21:51:15','Maik Hemani','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Native','Library','P2 major','ab44514','Christopher Schultz','2013-01-17 15:03:00','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54324','java/org/apache/coyote/http11/Http11AprProtocol.java\njava/org/apache/tomcat/jni/SSL.java\njava/org/apache/tomcat/util/net/AprEndpoint.java\njava/org/apache/tomcat/util/net/res/LocalStrings.properties\nwebapps/docs/config/http.xml'),(365,54438,'Bug 54438 – Bug fix 52953 introduces NullPointerException in RealmBase.java line 409 when user not found in JDBC','','2013-01-16 21:14:31','bruce weertman','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','c8d5d88','Mark Emlyn David Thomas','2013-01-17 09:30:39','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54438 Fix a regression in the fix for BZ 52953 that triggered an NPE when digested passwords were used and an authentication attempt was made for a user that did not exist in the realm.','java/org/apache/catalina/realm/RealmBase.java'),(366,52953,'Bug 52953 – Unlike BASIC Authentication, DIGEST mode does not work if the hash is stored in uppercase.','','2012-03-21 04:39:32','Neale Rudd','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','c8d5d88','Mark Emlyn David Thomas','2013-01-17 09:30:39','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54438 Fix a regression in the fix for BZ 52953 that triggered an NPE when digested passwords were used and an authentication attempt was made for a user that did not exist in the realm.','java/org/apache/catalina/realm/RealmBase.java'),(367,54440,'Bug 54440 – TagPluginManager.init() throws NPE when used in Ant <jasper> task','','2013-01-17 03:29:19','Sean Owen','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','297b26a','Mark Emlyn David Thomas','2013-01-17 08:17:42','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54440 Fix a regression caused by the changes for https://issues.apache.org/bugzilla/show_bug.cgi?id=54240 that broke compilation with JspC','java/org/apache/jasper/JspC.java\njava/org/apache/jasper/servlet/JspCServletContext.java'),(368,54240,'Bug 54240 – Configurable system level tagPlugins.xml','','2012-12-04 07:31:23','Sheldon Shao','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 enhancement','297b26a','Mark Emlyn David Thomas','2013-01-17 08:17:42','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54440 Fix a regression caused by the changes for https://issues.apache.org/bugzilla/show_bug.cgi?id=54240 that broke compilation with JspC','java/org/apache/jasper/JspC.java\njava/org/apache/jasper/servlet/JspCServletContext.java'),(369,54406,'Bug 54406 – NIO and BIO connectors handle unsupported SSL ciphers and sslEnabledProtocols differently','The NIO and BIO connectors share (most of) a JSSE based SSLImplementation, but differ in their handling of the ciphers and sslEnabledProtocols attributes.\n\nThe NIO connector sets the configured values for both attributes directly on the SSLEngine, which will fail immediately if any of them are unsupported. This makes creating a portable/superset collection of ciphers impossible - i.e. IBM JDKs do not support many of the cipher suite names used by JSSE and vice versa (usually TLS_ vs SSL_ prefixes differ) and the supported options differ between Java 6/7 etc.\n\nThe BIO connector attempts to filter the specified values down to those supported by the SSL implementation, but has issues as well: if none of the specified ciphers/protocols are supported it will silently use the defaults of the SSL implementation, which can lead to unexpectedly (and unwittingly) insecure configurations.\n\nI propose to:\n - modify the NIO connector to use the same logic as the BIO connector to filter requested ciphers/protocols to supported values (by placing these operations on the SSLUtil interface). \n - modify the ciphers/protocols filtering logic to treat an explicit list of unsupported options as setting no supported ciphers/protocols and warn when this is done (it will also fail visibly with errors if SSL connections are attempted).','2013-01-10 21:09:19','Tim Whittington','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 major','9f657ac','Tim Whittington','2013-01-13 17:04:31','Fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=54406.','java/org/apache/tomcat/util/net/NioEndpoint.java\njava/org/apache/tomcat/util/net/SSLUtil.java\njava/org/apache/tomcat/util/net/jsse/JSSESocketFactory.java\njava/org/apache/tomcat/util/net/jsse/res/LocalStrings.properties\nwebapps/docs/config/http.xml'),(370,54391,'Bug 54391 – Provide value for javax.servlet.context.orderedLibs attribute','In Servlet spec 3.0 Rev. a at the end of chapter 8.3 the following is written\n(page #87 (109/230)):\n\n[quote]\nIn addition, a Servlet 3.0 compliant Servlet container must provide a\nServletContext attribute with name javax.servlet.context.orderedLibs,\nwhose value (of type java.util.List<java.lang.String>) contains the list of\nnames of JAR files in the WEB-INF/lib directory of the application represented by\nthe ServletContext, ordered by their web fragment names (with possible\nexclusions if fragment JAR files have been excluded from absolute-ordering), or\nnull if the application does not specify any absolute or relative ordering.\n[/quote]\n\nIn the source code there is a constant ServletContext.ORDERED_LIBS, but I see no code where it were used.\n\nMy understanding is that the list should contain just the jar names, e.g. [\"foo.jar\", \"bar.jar\"] and be absent if there is no ordering.','2013-01-08 22:56:18','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','18a6a59','Konstantin Kolinko','2013-01-10 07:10:50','Tests for https://issues.apache.org/bugzilla/show_bug.cgi?id=54391','test/org/apache/catalina/core/TestStandardContextResources.java'),(371,54387,'Bug 54387 – Having servlets with same url should at least cause warning','I\'ve found this interesting \"mal functioning\" in a application where I just copied the mapping portion of web.xml for a new created servlet, but forgot to change de URI.\n\nTomcat deployed the application without any warning, but when running the application only the last referenced servlet was working (like if the mapping of the first has been overwritten by the last in the XML file).\n\nI made additional tests using annotations in servlets, and the behavior of having more than one servlet with same mapping causes random access to one or another (I cannot determine a predictable way).\n\nIn order to prevent breaking existing applications, I would like to have just a \"big warning\" in the log at startup and/or deployment of the application that have more than one servlet mapped to same URL.\n\nExamples of the problem:\n\nExample 1: Web.xml\n...\n  <servlet>\n    <servlet-name>PrintDacteServlet</servlet-name>\n    <servlet-class>br.com.simfreteV1.web.PrintDacteServlet</servlet-class>\n  </servlet>\n  <servlet>\n    <servlet-name>CotacaoReportServlet</servlet-name>\n    <servlet-class>br.com.simfreteV1.web.CotacaoReportServlet</servlet-class>\n  </servlet>\n  <servlet-mapping>\n    <servlet-name>PrintDacteServlet</servlet-name>\n    <url-pattern>/secure/relatorios/Action</url-pattern>\n  </servlet-mapping>\n  <servlet-mapping>\n    <servlet-name>CotacaoReportServlet</servlet-name>\n    <url-pattern>/secure/relatorios/Action</url-pattern>\n  </servlet-mapping>\n...\n\n\nExample 2: annotations in java servlet files\n\n@WebServlet(name = \"PdfReportPrint\", urlPatterns = {\"/secure/relatorios/doReport\"})\npublic class PdfReportPrint extends AbstractBaseServlet {\n...\n\n\n@WebServlet(name = \"PrintBoletoServlet\", urlPatterns = {\"/secure/relatorios/doReport\"})\npublic class PrintBoletoServlet extends HttpServlet {\n...','2013-01-08 12:58:37','Edson Richter','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','334c466','Mark Emlyn David Thomas','2013-01-10 07:06:50','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54387 Multiple servlets may not be mapped to the same url-pattern','java/org/apache/catalina/deploy/LocalStrings.properties\njava/org/apache/catalina/deploy/WebXml.java\ntest/org/apache/catalina/deploy/TestWebXml.java'),(372,54379,'Bug 54379 – Implement support for post-construct and pre-destroy elements in web.xml','','2013-01-07 04:07:15','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','71d075e','Mark Emlyn David Thomas','2013-01-10 06:39:46','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54379 Implement support for post-construct and pre-destroy elements in web.xml Patch by  Violeta Georgieva.','java/org/apache/catalina/Context.java\njava/org/apache/catalina/core/DefaultInstanceManager.java\njava/org/apache/catalina/core/LocalStrings.properties\njava/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/deploy/WebXml.java\njava/org/apache/catalina/startup/FailedContext.java\njava/org/apache/catalina/startup/LocalStrings.properties\njava/org/apache/catalina/startup/WebRuleSet.java\njava/org/apache/catalina/util/Introspection.java\ntest/org/apache/catalina/core/TestStandardContext.java\ntest/org/apache/catalina/core/TesterContext.java\ntest/org/apache/catalina/deploy/TestWebXml.java\ntest/org/apache/catalina/startup/TestContextConfig.java\ntest/org/apache/catalina/startup/TestWebRuleSet.java\ntest/org/apache/catalina/startup/TesterServletWithLifeCycleMethods.java\ntest/org/apache/catalina/startup/web-1lifecyclecallback.xml\ntest/org/apache/catalina/startup/web-2lifecyclecallback.xml\ntest/webapp-3.0-fragments/WEB-INF/web.xml'),(373,54244,'Bug 54244 – HTTP Connector SSL support section should give examples for sslEnabledProtocols and sslProtocol','Neither of these two configuration attributes have any examples for valid values except for sslProtocol which specifies \"TLS\" as the default.\n\nAlso, it is unclear what the difference between these two attributes is: does setting the sslProtocol enable just a single protocol?\n\nOne of these attributes likely takes a value like SSLv2, SSLv3, TLSv1, etc. or maybe SSLv3+TLSv1 but it\'s not clear which one (or both).\n\nEven if the list of valid values is JVM-specific (e.g. not every JVM supports TLSv1.2), some examples should be given.','2012-12-04 17:36:18','Christopher Schultz','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 enhancement','d7b89cb','Mark Emlyn David Thomas','2013-01-09 10:57:48','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54244 Clarify documentation for BIO/NIO SSL config attributes sslEnabledProtocols and sslProtocol','webapps/docs/config/http.xml'),(374,54391,'Bug 54391 – Provide value for javax.servlet.context.orderedLibs attribute','In Servlet spec 3.0 Rev. a at the end of chapter 8.3 the following is written\n(page #87 (109/230)):\n\n[quote]\nIn addition, a Servlet 3.0 compliant Servlet container must provide a\nServletContext attribute with name javax.servlet.context.orderedLibs,\nwhose value (of type java.util.List<java.lang.String>) contains the list of\nnames of JAR files in the WEB-INF/lib directory of the application represented by\nthe ServletContext, ordered by their web fragment names (with possible\nexclusions if fragment JAR files have been excluded from absolute-ordering), or\nnull if the application does not specify any absolute or relative ordering.\n[/quote]\n\nIn the source code there is a constant ServletContext.ORDERED_LIBS, but I see no code where it were used.\n\nMy understanding is that the list should contain just the jar names, e.g. [\"foo.jar\", \"bar.jar\"] and be absent if there is no ordering.','2013-01-08 22:56:18','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','2892c56','Mark Emlyn David Thomas','2013-01-09 06:56:22','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54391 Provide a value for the javax.servlet.context.orderedLibs attribute','java/org/apache/catalina/deploy/WebXml.java\njava/org/apache/catalina/startup/ContextConfig.java\ntest/org/apache/catalina/deploy/TestWebXmlOrdering.java'),(375,54330,'Bug 54330 – Patch with some refactoring of Member.java','','2012-12-19 13:46:48','Greg Turnquist','Tomcat Developers Mailing List','NEW','Tomcat 7','Cluster','P2 enhancement','368f40e','Mark Emlyn David Thomas','2013-01-08 17:46:52','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54330 Refactor Member interface to reduce dependency on concrete implementation. Based on a patch by Greg Turnquist.','java/org/apache/catalina/tribes/Member.java\njava/org/apache/catalina/tribes/group/interceptors/DomainFilterInterceptor.java\njava/org/apache/catalina/tribes/group/interceptors/NonBlockingCoordinator.java\njava/org/apache/catalina/tribes/group/interceptors/TcpFailureDetector.java\njava/org/apache/catalina/tribes/io/ChannelData.java\njava/org/apache/catalina/tribes/membership/McastServiceImpl.java\njava/org/apache/catalina/tribes/membership/MemberImpl.java\njava/org/apache/catalina/tribes/membership/Membership.java\njava/org/apache/catalina/tribes/util/Arrays.java\ntest/org/apache/catalina/tribes/membership/TestMemberImplSerialization.java\ntest/org/apache/catalina/tribes/test/NioSenderTest.java'),(376,54390,'Bug 54390 – Use \'java_home\' on Mac OS X to auto-detect JAVA_HOME','Installing Java 7 on OSX does not force Tomcat to use newly installed active JDK, instead it is still using the old .../CurrentJDK/Home mechanism.\n\n\nJava 7 Installation on OSX does not reside on conventional location on file system , which is being used by tomcat setclasspath.sh script. \nExcerpt from setclasspath.sh\n\nif [ -d \"/System/Library/Frameworks/JavaVM.framework/Versions/CurrentJDK/Home\" ];         \n   then\n   export     \n  JAVA_HOME=\"/System/Library/Frameworks/JavaVM.framework/Versions/CurrentJDK/Home\"\n\nSolution to the problem is to update setclasspath.sh script to ;\n\n    if [ -d \"$(/usr/libexec/java_home)\" ]; then\n      export JAVA_HOME=$(/usr/libexec/java_home)','2013-01-08 18:13:08','Zafar Ali','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','2aa5b7a','Christopher Schultz','2013-01-08 17:05:46','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54390 Use /usr/libexec/java_home to determine JAVA_HOME on Mac OS X if it is available.','bin/setclasspath.sh'),(377,54382,'Bug 54382 – Nullpointer Exception after activating SSI and loading of any html-file with a specific comment','1. Activate SSI on Tomcat and restart Tomcat\n2. create an any html-file with a comment like this \"<!--#-->\" \n3. put this html-file to the webapp folder of tomcat\n4. when you now go to the html file via tomcat, you will get an Nullpointer Exception. The SSIServlet.class and other necessary SSI-classes cannot be found','2013-01-07 23:56:21','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','d83a5e5','Mark Emlyn David Thomas','2013-01-08 16:41:44','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54382 Avoid NPE with an empty SSI directive','java/org/apache/catalina/ssi/SSIProcessor.java'),(378,54381,'Bug 54381 – Websocket StreamInbound never reports receipt of a Pong','The tomcat websocket api now allows the send of a Ping frame by the server (as of 7.0.33), via WsOutbound, but never reports the receipt of a Pong. See StreamInbound in the onData() method...\n\n                } else if (opCode == Constants.OPCODE_PONG) {\n                    // NO-OP\n                }\n\nAs the intended use of Pings is for heartbeat messages, allowing a Ping without informing the server extension of the returned Pong leaves out half the utility.\n\nI would suggest these changes to StreamInbound as a fix...\n\n1) In the onData() method...\n\n                } else if (opCode == Constants.OPCODE_PONG) {\n                    onPong(frame.getPayLoad());\n                }\n\n2) Add a method onPong (ByteBuffer buffer)...\n\n    protected void onPong(ByteBuffer buffer) {\n        // NO-OP\n    }\n\n...which implementations may now override to handle Pong receipt and heartbeat logic. This is necessary as onData() is marked final, so there\'s no alternate workaround.','2013-01-07 19:44:37','David Berkman','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','5f7af1b','Mark Emlyn David Thomas','2013-01-08 15:44:30','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54381 Add support for receiving pong messages.','java/org/apache/catalina/websocket/StreamHandler.java'),(379,54377,'Bug 54377 – RemoteIpFilter does not correctly set request attributes for AccessLog','In RemoteIpFilter class, there is code that publishes the new request attributes to AccessLog (see below).\n\n821             if (requestAttributesEnabled) {\n822                 request.setAttribute(AccessLog.REMOTE_ADDR_ATTRIBUTE,\n823                         request.getRemoteAddr());\n824                 request.setAttribute(AccessLog.REMOTE_HOST_ATTRIBUTE,\n825                         request.getRemoteHost());\n826                 request.setAttribute(AccessLog.PROTOCOL_ATTRIBUTE,\n827                         request.getProtocol());\n828                 request.setAttribute(AccessLog.SERVER_PORT_ATTRIBUTE,\n829                         Integer.valueOf(request.getServerPort()));\n830             }\n\nThe problem is that the source values should come from xRequest, e.g. xRequest.getRemoteAddr() and xRequest.getRemoteHost(), etc.\n\nAs it is written above, RemoteIpFilter simply republishes the current values, and AccessLog therefore does not display the correct values.','2013-01-05 23:52:37','Greg Arakelian','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','95e6056','Mark Emlyn David Thomas','2013-01-08 15:24:10','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54377 Correctly set request attributes for AccessLog in RemoteIpFilter Patch by Violeta Georgieva','java/org/apache/catalina/filters/RemoteIpFilter.java\ntest/org/apache/catalina/filters/TestRemoteIpFilter.java\ntest/org/apache/catalina/valves/TestRemoteIpValve.java'),(380,54380,'Bug 54380 – In MapperListener.lifecycleEvent(..): check state of parent before calling registerWrapper()','','2013-01-07 12:37:27','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','3a9990b','Konstantin Kolinko','2013-01-08 01:52:50','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54380 - In MapperListener.lifecycleEvent(): call registerWrapper(), registerContext() only if the parent component has already been started.','java/org/apache/catalina/mapper/MapperListener.java'),(381,54248,'Bug 54248 – Retrieving content that contains a BOM via request.getReader() issue','If a request contains Content that includes the BOM - in my case Content-Type: application/xml; charset-utf-16 - and the content has a BOM (FF FE), when fetched utilizing the BufferedReader from getReader() - the first request serviced on the AJP thread works correctly (encoded correctly, only characters fetched), however, any subsequent request on the thread which includes the BOM has the BOM being delivered to the application. It appears via review of the Tomcat code, that the recycle() method in B2CConverter simply ensures the socket\'s data has been completely flushed and the underlying InputStream doesn\'t get reset (don\'t really know if there is a way to do this without re-instantiating it) to ensure subsequent requests BOM is consumed. I proved this as a test by adding a call to reset() within the recycle() method which re-instantiates the underlying InputStreams and the problem resolved itself. \n\nI\'ve temporarily resolved the issue in my application code by using request.getInputStream() and using request.getCharacterEncoding() and encoding the content inside my application.','2012-12-05 11:56:08','Dave Stewart','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','f7fc27a','Mark Emlyn David Thomas','2013-01-07 18:00:47','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54248 Need to reset the decoder when the N2C converter is recycled to ensure BOMs are correctly handled for those encodings that require them.','java/org/apache/tomcat/util/buf/B2CConverter.java\ntest/org/apache/tomcat/util/buf/TestB2CConverter.java'),(382,54284,'Bug 54284 – Util.objectNameValueNeedsQuote throws NPE for anonymous Filters','How to reproduce?\n\nFrom inside the contextInitialized-Method of an ServletContextListener instance, call\n\ncontext.addFilter(null,\n      new ArbitraryFilter(pathPrefix)).addMappingForUrlPatterns(null, false, pathPrefix);\n\nWhat happens?\n\nDec 12, 2012 3:59:03 PM org.apache.catalina.core.StandardContext filterStart\nSEVERE: Exception starting filter null\njava.lang.NullPointerException\n        at org.apache.tomcat.util.modeler.Util.objectNameValueNeedsQuote(Util.java:26)\n        at org.apache.catalina.core.ApplicationFilterConfig.registerJMX(ApplicationFilterConfig.java:421)\n        at org.apache.catalina.core.ApplicationFilterConfig.initFilter(ApplicationFilterConfig.java:282)\n        at org.apache.catalina.core.ApplicationFilterConfig.<init>(ApplicationFilterConfig.java:108)\n        at org.apache.catalina.core.StandardContext.filterStart(StandardContext.java:4650)\n        at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5306)\n        at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)\n        at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:901)\n        at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:877)\n        at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:633)\n        at org.apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.java:657)\n        at org.apache.catalina.startup.HostConfig$DeployDescriptor.run(HostConfig.java:1637)\n        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)\n        at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)\n        at java.util.concurrent.FutureTask.run(FutureTask.java:166)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)\n        at java.lang.Thread.run(Thread.java:722)\n\nDec 12, 2012 3:59:03 PM org.apache.catalina.core.StandardContext startInternal\nSEVERE: Error filterStart\nDec 12, 2012 3:59:03 PM org.apache.catalina.core.StandardContext startInternal\nSEVERE: Context [] startup failed due to previous errors\n\n\nWhat should happen?\nEither - if null is not an allowed filter name, throw a IllegalArgumentException on context.addFilter(...)\nOr, if it is an allowed filter name, handle null-values gracefully','2012-12-12 15:51:40','Violeta Georgieva','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','113c0bd','Mark Emlyn David Thomas','2013-01-07 14:08:58','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54284 As per clarification from the Servlet EG, anonymous Filters and Servlets are not permitted. Patch by Violeta Georgieva.','java/org/apache/catalina/core/ApplicationContext.java\njava/org/apache/catalina/core/LocalStrings.properties\njava/org/apache/catalina/deploy/FilterDef.java\njava/org/apache/catalina/deploy/LocalStrings.properties\njava/org/apache/catalina/deploy/ServletDef.java\ntest/org/apache/catalina/core/TestApplicationContext.java\ntest/org/apache/catalina/deploy/TestFilterDef.java\ntest/org/apache/catalina/deploy/TestServletDef.java'),(383,54262,'Bug 54262 – An empty <absolute-ordering /> should turn off all web-fragments','The use of an <absolute-ordering> element does disable ServletContainerInitializer classpath scanning as discussed also in issue 53619. However, it does seem to require having at least one web-fragment name to be listed. In other words I would this:\n\n<absolute-ordering />\n\nTo turn off all web-fragments since none are named. A workaround is to list a web-fragment even if it doesn\'t exist but that shouldn\'t be necessary.','2012-12-07 22:00:09','Violeta Georgieva','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','5418e2b','Mark Emlyn David Thomas','2013-01-07 13:44:22','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54262 An empty <absolute-ordering /> should turn off all web-fragments. Based on a patch by  Violeta Georgieva.','java/org/apache/catalina/deploy/WebXml.java\njava/org/apache/catalina/startup/WebRuleSet.java\ntest/org/apache/catalina/startup/TestContextConfig.java\ntest/webapp-3.0-fragments-empty-absolute-ordering/WEB-INF/lib/resources.jar\ntest/webapp-3.0-fragments-empty-absolute-ordering/WEB-INF/web.xml'),(384,54361,'Bug 54361 – Deploy release zip to Maven repository','','2012-12-31 00:13:18','dblevins','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Packaging','P2 normal','41a3de2','Mark Emlyn David Thomas','2013-01-07 10:19:20','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54361 Include the binary distributions when uploading artifacts to Maven repos','res/maven/mvn-pub.xml\nres/maven/mvn.properties.default\nres/maven/tomcat.pom'),(385,46243,'Bug 46243 – Filter init() fails, still put into service','Using securityfilter, I misconfigured the filter to use a non-existent class for my Realm. This causes a ClassNotFoundException in securityfilter\'s init() method.\n\nWhen attempting to authenticate, I get this error:\n\n2008-11-19 10:26:26,111 [TP-Processor8] ERROR org.apache.catalina.core.ContainerBase.[Catalina].[localhost].[/diagnosis].[default]- Servlet.service() for servlet default threw exception\njava.lang.NullPointerException\n        at org.securityfilter.filter.SecurityFilter.doFilter(SecurityFilter.java:125)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:215)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:188)\n        at org.securityfilter.filter.CheckIPAddressFilter.doFilter(CheckIPAddressFilter.java:130)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:215)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:188)\n        at org.childhealthcare.diagnosis.servlet.BrokenLocaleFilter.doFilter(BrokenLocaleFilter.java:115)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:215)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:188)\n        at org.childhealthcare.diagnosis.servlet.EncodingFilter.doFilter(EncodingFilter.java:64)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:215)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:188)\n        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:213)\n        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:174)\n        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)\n        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:117)\n        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:108)\n        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:174)\n        at org.apache.jk.server.JkCoyoteHandler.invoke(JkCoyoteHandler.java:200)\n        at org.apache.jk.common.HandlerRequest.invoke(HandlerRequest.java:283)\n        at org.apache.jk.common.ChannelSocket.invoke(ChannelSocket.java:773)\n        at org.apache.jk.common.ChannelSocket.processConnection(ChannelSocket.java:703)\n        at org.apache.jk.common.ChannelSocket$SocketConnection.runIt(ChannelSocket.java:895)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:689)\n        at java.lang.Thread.run(Thread.java:595)\n\nNow, the exception itself is legitimate: there\'s an uninitialized object in the filter that\'s being dereferenced, and an NPE is thrown.\n\nThe problem is that Tomcat should be successfully initializing the filter /before/ the doFilter method is ever called. Since init() will always fail given my configuration, the filter should never come into service, and the NPE should not be observed.\n\nSection 6.2.1 of the 2.4 servlet spec states:\n\n\"\nThe container must ensure that it has instantiated a filter of the appropriate class for each filter in the list, and called its init(FilterConfig config) method. The filter may throw an exception to indicate that it cannot function properly. If the exception is of type UnavailableException, the container may examine the isPermanent attribute of the exception and may choose to retry the filter at some later time.\n\"\n\nWhile not explicitly stated here, it seems that the call to init() should be successful (i.e. no exceptions are thrown) before the filter is put into service -- similar to the way a servlet is handled. Filters should be able to rely on objects being properly initialized in init().','2008-11-19 09:20:32','Christopher Schultz','Tomcat Developers Mailing List','CLOSED INVALID','Tomcat 5','Catalina','P2 normal','13d969d','Konstantin Kolinko','2013-01-07 05:50:11','Amend the test for bug 46243: Test that a context can be started again after a failed start. There is no need to redeploy it.','test/org/apache/catalina/core/TestStandardContext.java\ntest/org/apache/catalina/startup/TomcatBaseTest.java'),(386,54338,'Bug 54338 – Class cast exception in tagPlugin Set generated code','','2012-12-21 12:00:09','Sheldon Shao','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','b73c014','Mark Emlyn David Thomas','2013-01-04 17:05:02','Test case for bug 54338','test/org/apache/jasper/tagplugins/jstl/core/TestSet.java\ntest/webapp-3.0/bug5nnnn/bug54338.jsp'),(387,54338,'Bug 54338 – Class cast exception in tagPlugin Set generated code','','2012-12-21 12:00:09','Sheldon Shao','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','6fdaef3','Mark Emlyn David Thomas','2013-01-04 17:04:04','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54338 Correctly coerce the value to the expected type when using the tag plug-in for the JSTL set tag','java/org/apache/jasper/tagplugins/jstl/core/Set.java'),(388,54370,'Bug 54370 – NPE mapping method in EL','','2013-01-03 14:20:38','Remy Maucherat','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','5361e86','Mark Emlyn David Thomas','2013-01-03 10:38:00','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54370 Improve handling of nulls when trying to match sets of parameters to a method in EL.','java/org/apache/el/util/ReflectionUtil.java\ntest/org/apache/el/util/TestReflectionUtil.java\ntest/org/apache/el/util/Tester.java'),(389,54260,'Bug 54260 – JSP unloading - NullPointerException when using \".tag\" files','','2012-12-07 17:58:25','Laszlo Keszthelyi','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','94da507','Mark Emlyn David Thomas','2013-01-03 09:18:01','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54260 Avoid NPE when using JSP unloading and tag files.','java/org/apache/jasper/util/FastRemovalDequeue.java'),(390,54256,'Bug 54256 – Enhance Exception reporting on JAR file error','(I posted this to the mailing list on Oct 28, 2011, but didn\'t end up creating a report on it until now.  I have the same error with Tomcat 7.)\n\nPROBLEM DESCRIPTION:\n\nI have an exception (appended below), and I think it would be nice to have more information about what is going on.\n\nIf I had more context, it would help me find the cause of my problem much more quickly.  For example, if the exception indicated what the file/resource that was having the problem was, it would speed up troubleshooting immensely.\n\nHOW TO REPRODUCE:\n\nIn a JAR file contained in WAR file\'s WEB-INF/lib folder:  Change the MANIFEST.MF file in the JAR file.  Put in a line with ONLY \"Class-Path:\".  Note there is no space after the period, which is what causes the error.  During load of the application, the exception which I have appended at the end of this message will show up.\n\nSUGGESTED IMPROVEMENT:\n\nMy suggestion would be to modify ExtensionValidator.validateApplication(...), around line 195.  This is the location that actually knows about what the resource is.  It would be nice if the IOException was caught, and information about the Resource was added to the exception, probably by wrapping the exception.\n\nBecause I have not gone through the overhead of getting a version of Tomcat running from source, these changes have not been compiled and tested, but I think the suggestion is relatively straight-forward.\n\nHere are the suggested code changes:\n\nFirst code change - move the definition of \"resource\" outside of the try/catch:\n\n         // Locate the Manifests for all bundled JARs\n         Resource resource = null; // ADDED\n         NamingEnumeration<Binding> ne = null;\n\nSecond code change - make the existing declaration of \"resource\" just an assignment:\n\n                 resource = (Resource) obj; // MODIFIED\n                 inputStream = resource.streamContent();\n                 Manifest jmanifest = getManifest(inputStream);\n\nThird code change: add a catch clause and re-throw:\n\n         } catch (NamingException nex) {\n             // Jump out of the check for this application because it\n             // has no resources\n         } catch (IOException ioex) { // ADDED\n             throw new IOException(\"validation problem in \" + resource.toString(), ioex); // ADDED\n         } finally {\n\nThe problem is that the resource may not have a proper toString().  I would suggest changing FileDirContext:898 (inner class=FileResource) to have a toString method, something along the lines of:\n\n         public String toString() { // ADDED\n             return file == null ? \"null\" : file.toString(); // ADDED\n         } // ADDED\n\nNote: about this, in the original email thread, Konstantin Kolinko said:\n\"Not sure about FileResource.toString(), but adding a catch for IOException looks like doable.\"\n\n\nFinally, here\'s the exception:\n\n28-Oct-2011 11:03:03 AM org.apache.catalina.core.StandardContext startInternal\nSEVERE: Error in dependencyCheck\njava.io.IOException: invalid header field\n     at java.util.jar.Attributes.read(Attributes.java:410)\n     at java.util.jar.Manifest.read(Manifest.java:199)\n     at java.util.jar.JarInputStream.<init>(JarInputStream.java:83)\n     at java.util.jar.JarInputStream.<init>(JarInputStream.java:60)\n     at org.apache.catalina.util.ExtensionValidator.getManifest(ExtensionValidator.java:394)\n     at org.apache.catalina.util.ExtensionValidator.validateApplication(ExtensionValidator.java:195)\n     at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5037)\n     at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:148)\n     at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:1033)\n     at org.apache.catalina.core.StandardHost.startInternal(StandardHost.java:774)\n     at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:148)\n     at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:1033)\n     at org.apache.catalina.core.StandardEngine.startInternal(StandardEngine.java:291)\n     at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:148)\n     at org.apache.catalina.core.StandardService.startInternal(StandardService.java:443)\n     at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:148)\n     at org.apache.catalina.core.StandardServer.startInternal(StandardServer.java:727)\n     at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:148)\n     at org.apache.catalina.startup.Catalina.start(Catalina.java:621)\n     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n     at java.lang.reflect.Method.invoke(Method.java:616)\n     at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:322)\n     at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:450)\n\n(And if only java.util.jar.Attributes.read reported WHICH attribute had the problem, we\'d really be in business.)','2012-12-06 20:44:32','Chris Dailey','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','0ae2f34','Mark Emlyn David Thomas','2013-01-02 16:48:09','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54256 Give the developer a hint as to which JAR file has the broken manifest','java/org/apache/catalina/util/ExtensionValidator.java'),(391,54247,'Bug 54247 – Exception in JmxRemoteLifecycleListener.destroyServer','','2012-12-05 10:00:36','Benoît REY','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','29c4a0e','Mark Emlyn David Thomas','2013-01-02 15:37:16','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54247 Prevent ClassNotFoundExceptions on stop when running as a service','java/org/apache/catalina/startup/Bootstrap.java'),(392,54242,'Bug 54242 – NPE in tagPlugins:ForEach','','2012-12-04 08:12:05','Sheldon Shao','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','3ae40f8','Mark Emlyn David Thomas','2013-01-02 11:23:02','Test case for https://issues.apache.org/bugzilla/show_bug.cgi?id=54242','test/org/apache/jasper/tagplugins/jstl/core/TestForEach.java\ntest/webapp-3.0/bug5nnnn/bug54242.jsp'),(393,54242,'Bug 54242 – NPE in tagPlugins:ForEach','','2012-12-04 08:12:05','Sheldon Shao','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','86be1eb','Mark Emlyn David Thomas','2013-01-02 11:22:05','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54242 Fix NPE in tagPlugins:ForEach when iteration is null. JSTL spec says it should be treated like an empty iteration.','java/org/apache/jasper/tagplugins/jstl/core/ForEach.java'),(394,54241,'Bug 54241 – NPE in BodyContentImpl','','2012-12-04 07:53:25','Sheldon Shao','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 major','ffc4525','Mark Emlyn David Thomas','2013-01-02 09:47:01','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54241 Revert the fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=35410 as it is not specification compliant Remove the remainder of the write(String) method as well as it serves no purpose since it is identical to the method it overrides. Add some test cases to confirm the expected/correct behaviour Note: BZ 35410 claims there is no requirement for Object.toString() to be non-null. Many have argued (and I agree) that null is not a String representation and therefore not a valid return value for Object.toString().','java/org/apache/jasper/runtime/JspWriterImpl.java\ntest/org/apache/jasper/runtime/TestJspWriterImpl.java\ntest/webapp-3.0/bug5nnnn/bug54241a.jsp\ntest/webapp-3.0/bug5nnnn/bug54241b.jsp'),(395,35410,'Bug 35410 – NullPointerException when using out scriptlet (<%= obj %>) on object with toString() returning null','Here is a simple test case to reproduce the bug:\n\n	<%!\n	 class MyTestClass {\n	   public String toString() {\n	     return null;\n	   }\n	 }\n	%>\n	<%\n	  String nullString = null;\n	  MyTestClass test = new MyTestClass();\n	%>\n	<%= (Object) null %><%-- works well --%>\n	<%= nullString %><%-- works well --%>\n	<%= test %> <%-- crash --%>\n\nthis leads to:\njava.lang.NullPointerException\n	org.apache.jasper.runtime.JspWriterImpl.write(JspWriterImpl.java:337)\n	org.apache.jasper.runtime.JspWriterImpl.print(JspWriterImpl.java:475)\n	org.apache.jsp.test_jsp._jspService(test_jsp.java:65)\n\nI consider this to be a bug cause nowhere in the behaviour of toString it is\nspecified it should not return null. Therefore, it should not crash like that.','2005-06-18 08:33:01','Olivier Jaquemet','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P3 normal','ffc4525','Mark Emlyn David Thomas','2013-01-02 09:47:01','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54241 Revert the fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=35410 as it is not specification compliant Remove the remainder of the write(String) method as well as it serves no purpose since it is identical to the method it overrides. Add some test cases to confirm the expected/correct behaviour Note: BZ 35410 claims there is no requirement for Object.toString() to be non-null. Many have argued (and I agree) that null is not a String representation and therefore not a valid return value for Object.toString().','java/org/apache/jasper/runtime/JspWriterImpl.java\ntest/org/apache/jasper/runtime/TestJspWriterImpl.java\ntest/webapp-3.0/bug5nnnn/bug54241a.jsp\ntest/webapp-3.0/bug5nnnn/bug54241b.jsp'),(396,35410,'Bug 35410 – NullPointerException when using out scriptlet (<%= obj %>) on object with toString() returning null','Here is a simple test case to reproduce the bug:\n\n	<%!\n	 class MyTestClass {\n	   public String toString() {\n	     return null;\n	   }\n	 }\n	%>\n	<%\n	  String nullString = null;\n	  MyTestClass test = new MyTestClass();\n	%>\n	<%= (Object) null %><%-- works well --%>\n	<%= nullString %><%-- works well --%>\n	<%= test %> <%-- crash --%>\n\nthis leads to:\njava.lang.NullPointerException\n	org.apache.jasper.runtime.JspWriterImpl.write(JspWriterImpl.java:337)\n	org.apache.jasper.runtime.JspWriterImpl.print(JspWriterImpl.java:475)\n	org.apache.jsp.test_jsp._jspService(test_jsp.java:65)\n\nI consider this to be a bug cause nowhere in the behaviour of toString it is\nspecified it should not return null. Therefore, it should not crash like that.','2005-06-18 08:33:01','Olivier Jaquemet','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P3 normal','ffc4525','Mark Emlyn David Thomas','2013-01-02 09:47:01','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54241 Revert the fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=35410 as it is not specification compliant Remove the remainder of the write(String) method as well as it serves no purpose since it is identical to the method it overrides. Add some test cases to confirm the expected/correct behaviour Note: BZ 35410 claims there is no requirement for Object.toString() to be non-null. Many have argued (and I agree) that null is not a String representation and therefore not a valid return value for Object.toString().','java/org/apache/jasper/runtime/JspWriterImpl.java\ntest/org/apache/jasper/runtime/TestJspWriterImpl.java\ntest/webapp-3.0/bug5nnnn/bug54241a.jsp\ntest/webapp-3.0/bug5nnnn/bug54241b.jsp'),(397,54170,'Bug 54170 – JMX ObjectName for Filters: names used without quoting (escaping)','How to reproduce:\nExecute \n\ncontext.addFilter(\"deprecatedApiReporterFilterFor/myAPI/v2/*, new ArbitraryServletFilter()).addMappingForUrlPatterns(null, false, \"/myAPI/v2/*\");\n\nfrom inside the contextInitialized-Method of an ServletContextListener.\n\n\nWhat happens:\nNov 19, 2012 6:01:34 PM org.apache.catalina.core.ApplicationFilterConfig registerJMX\nInformation: JMX registration failed for filter of type [ArbitraryServletFilter] and name [deprecatedApiReporterFilterFor/myAPI/v2/*]\njavax.management.RuntimeOperationsException\n	at com.sun.jmx.mbeanserver.Repository.addMBean(Repository.java:411)\n	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.registerWithRepository(DefaultMBeanServerInterceptor.java:1898)\n	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.registerDynamicMBean(DefaultMBeanServerInterceptor.java:966)\n	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.registerObject(DefaultMBeanServerInterceptor.java:900)\n	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.registerMBean(DefaultMBeanServerInterceptor.java:324)\n	at com.sun.jmx.mbeanserver.JmxMBeanServer.registerMBean(JmxMBeanServer.java:512)\n	at org.apache.tomcat.util.modeler.Registry.registerComponent(Registry.java:742)\n	at org.apache.catalina.core.ApplicationFilterConfig.registerJMX(ApplicationFilterConfig.java:432)\n	at org.apache.catalina.core.ApplicationFilterConfig.initFilter(ApplicationFilterConfig.java:281)\n	at org.apache.catalina.core.ApplicationFilterConfig.<init>(ApplicationFilterConfig.java:107)\n	at org.apache.catalina.core.StandardContext.filterStart(StandardContext.java:4638)\n	at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5294)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)\n	at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:895)\n	at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:871)\n	at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:615)\n	at org.apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.java:649)\n	at org.apache.catalina.startup.HostConfig$DeployDescriptor.run(HostConfig.java:1581)\n	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)\n	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)\n	at java.util.concurrent.FutureTask.run(FutureTask.java:166)\n	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)\n	at java.lang.Thread.run(Thread.java:722)\nCaused by: java.lang.IllegalArgumentException: Repository: cannot add mbean for pattern name Catalina:j2eeType=Filter,name=deprecatedApiReporterFilterFor/myAPI/v2/*,WebModule=//localhost/,J2EEApplication=none,J2EEServer=none\n	... 24 more\n\nWhy does it happen:\n\nBecause ApplicationFilterConfig constructs the ObjectName by String concatenation, without escaping the filterName using ObjectName.quote(String s)\n\nI was able to reproduce it using Catalina 7.0.26.','2012-11-19 17:08:42','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','cb79f6b','Konstantin Kolinko','2012-12-04 17:29:35','Review of r1412576, which was a fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=54170 Reduce GC. There is no need to copy characters into a new char[] array here.','java/org/apache/tomcat/util/modeler/Util.java'),(398,54245,'Bug 54245 – TomcatRepo\\build.xml:2668: TomcatRepo\\output\\manifests\\default does not exist','','2012-12-04 20:25:33','Violeta Georgieva','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Packaging','P2 trivial','544d0c6','Mark Emlyn David Thomas','2012-12-04 17:08:26','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54245 Keep git happy about a currently empty directory','build.xml\nres/META-INF/default/.gitignore'),(399,54194,'Bug 54194 – NPE in DataSource.registerJmx() although DataSource is created with setJmxEnabled(false)','','2012-11-23 14:35:58','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 minor','1c61fb1','Keiichi Fujino','2012-12-04 01:31:27','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54194 Make sure that connection pool mbean is not registered when jmxEnabled is false.','modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/DataSource.java'),(400,54150,'Bug 54150 – SlowQueryReportJmx mbean deregistration failure due to NPE - properties not set during pool close callback','Found while debugging version 7.0.29\n\nI found that our SlowQueryReportJmx mbean was not being deregistered during webapp shutdown.  I tracked this down to a NPE.  The interceptor properties are not being set (as is done in setupConnection) prior to the pool close callback.\n\nConnectionPool.close(boolean) poolClosed callback produces NPE in SlowQueryReportJmx.\n{code}\n        PoolProperties.InterceptorDefinition[] proxies = getPoolProperties().getJdbcInterceptorsAsArray();\n        for (int i=0; i<proxies.length; i++) {\n            try {\n                proxies[i].getInterceptorClass().newInstance().poolClosed(this);\n            }catch (Exception x) {\n                log.debug(\"Unable to inform interceptor of pool closure.\",x);\n            }\n        }\n...\n{code}\n\nNPE in SlowQueryReportJmx - null.containsKey\n\n{code}\n    public ObjectName getObjectName(Class<?> clazz, String poolName) throws MalformedObjectNameException {\n... NPE\n        if (getProperties().containsKey(objectNameAttribute)) {\n...\n{code}\n\nSounds reasonable to set properties any time you need to instantiate interceptors.\nAs is done in ConnectionPool.init(PoolConfiguration)\n\n{code}\n                JdbcInterceptor interceptor = proxies[i].getInterceptorClass().newInstance();\n                interceptor.setProperties(proxies[i].getProperties());\n                interceptor.poolStarted(this);\n{code}','2012-11-15 18:38:29','Alex Franken','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','b021a22','Keiichi Fujino','2012-12-04 01:03:27','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54150 Make sure that SlowQueryReportJmx mbean deregistered during webapp shutdown.','modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java'),(401,54220,'Bug 54220 – ErrorReportValve invoked on non-error responses too','','2012-11-28 20:19:49','Michael Osipov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','a2d1441','Mark Emlyn David Thomas','2012-12-03 09:19:39','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54220 The ErrorReportValve should only generate an error response if the error flag on the response is true.','java/org/apache/catalina/valves/ErrorReportValve.java\ntest/org/apache/catalina/valves/TestErrorReportValve.java'),(402,53871,'Bug 53871 – java.lang.StackOverflowError on deploying a web application','When starting Tomcat 7.0.29 and 7.0.30, and automatically deploying a war file from webapps the following error is thrown:\n14:01:06,380 ERROR [HostConfig:576] Error waiting for multi-thread deployment of context descriptors to complete java.util.concurrent.ExecutionException: java.lang.StackOverflowError\n    at java.util.concurrent.FutureTask$Sync.innerGet(FutureTask.java:252)\n    at java.util.concurrent.FutureTask.get(FutureTask.java:111)\n    at org.apache.catalina.startup.HostConfig.deployDescriptors(HostConfig.java:574)\n    at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:470)\n    at org.apache.catalina.startup.HostConfig.start(HostConfig.java:1413)\n    at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:313)\n    at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\n    at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90)\n    at org.apache.catalina.util.LifecycleBase.setStateInternal(LifecycleBase.java:401)\n    at org.apache.catalina.util.LifecycleBase.setState(LifecycleBase.java:346)\n    at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:1140)\n    at org.apache.catalina.core.StandardHost.startInternal(StandardHost.java:785)\n    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)\n    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1559)\n    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1549)\n    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)\n    at java.util.concurrent.FutureTask.run(FutureTask.java:166)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)\n    at java.lang.Thread.run(Thread.java:722)\n\nCaused by: java.lang.StackOverflowError at java.util.HashSet.(HashSet.java:103) at org.apache.catalina.startup.ContextConfig.populateSCIsForCacheEntry(ContextConfig.java:2243) at org.apache.catalina.startup.ContextConfig.populateSCIsForCacheEntry(ContextConfig.java:2260) at org.apache.catalina.startup.ContextConfig.populateSCIsForCacheEntry(ContextConfig.java:2260)\n...(and many more identical lines)...\n\nHowever this works fine in 7.0.28.','2012-09-14 12:40:44','Robert Pasztor','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','c7021cc','Mark Emlyn David Thomas','2012-12-03 08:18:34','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53871 Improve error message for StackOverflowError','java/org/apache/catalina/startup/ContextConfig.java\njava/org/apache/catalina/startup/LocalStrings.properties'),(403,54190,'Bug 54190 – TestNonLoginAndBasicAuthenticator does not test session timeout properly','','2012-11-22 13:10:23','Brian Burch','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P4 minor','a3bd28b','Mark Emlyn David Thomas','2012-12-03 07:10:05','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54190 Speed up unit test. Patch provided by Brian Burch.','test/org/apache/catalina/authenticator/TestNonLoginAndBasicAuthenticator.java'),(404,54217,'Bug 54217 – JDBC connection pool runs out of connections when Context reload=“true” is enabled in Tomcat','','2012-11-28 10:35:43','Levan','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','a81538d','Mark Emlyn David Thomas','2012-12-03 06:45:47','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54217 Prevent PoolCleaner instances retaining references to the ConnectionPool which  may result in a memory leak.','modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java'),(405,54190,'Bug 54190 – TestNonLoginAndBasicAuthenticator does not test session timeout properly','','2012-11-22 13:10:23','Brian Burch','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P4 minor','46d69fc','Mark Emlyn David Thomas','2012-11-29 09:21:45','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54190 Improve unit tests. Patch by Brian Burch.','test/org/apache/catalina/authenticator/TestNonLoginAndBasicAuthenticator.java'),(406,54207,'Bug 54207 – javaURLContextFactory javadoc refers to defunct package names in initial context properties','Javadoc for org.apache.naming.java.javaURLContextFactory:\n\n/**\n * Context factory for the \"java:\" namespace.\n * <p>\n * <b>Important note</b> : This factory MUST be associated with the \"java\" URL\n * prefix, which can be done by either :\n * <ul>\n * <li>Adding a \n * java.naming.factory.url.pkgs=org.apache.catalina.util.naming property\n * to the JNDI properties file</li>\n * <li>Setting an environment variable named Context.URL_PKG_PREFIXES with \n * its value including the org.apache.catalina.util.naming package name. \n * More detail about this can be found in the JNDI documentation : \n * {@link javax.naming.spi.NamingManager#getURLContext(java.lang.String, java.util.Hashtable)}.</li>\n * </ul>\n * \n * @author Remy Maucherat\n * @version $Id$\n */\n\norg.apache.catalina.util.naming is a very old package name.  The correct name for both TC6 and TC7 is org.apache.naming .','2012-11-26 02:10:22','Brett Randall','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 trivial','d6b4740','Mark Emlyn David Thomas','2012-11-26 06:29:15','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54207 Correct package name in Javadoc','java/org/apache/naming/java/javaURLContextFactory.java'),(407,54198,'Bug 54198 – Improve HttpServletResponse#sendError(int) JavaDoc description','This methods calls sendError(int, null) internally. Thus generating a HTML page without a message. This is not mentioned in the docs. One could assume that the response will be empty.\n\nOne could duplicate the first paragraph of the sendError(int,String) method and alter it to \"The server defaults to creating the response to look like an HTML-formatted server error page with any specific message, setting the content type to \"text/html\",...\" further \"If an error-page declaration has been made for the web application corresponding to the status code passed in, it will be served back.\" (Might need improvement in this case, I am not a native speaker).\n\nMoreover, I would add \"This method is effectively the same as calling sendError(int, null)\". Plus add @see #sendError(int,String).\n\nThough the JavaDocs seems to be a verbatim copy of Oracle\'s Servlet API, it does not reveal this information explicitly.\n\nShould I provide a patch if that doc is available in svn.apache.org?','2012-11-23 22:33:12','Michael Osipov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Servlet & JSP API','P2 enhancement','3c13e90','Mark Emlyn David Thomas','2012-11-26 06:08:02','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54198 Clarify that sendError(int) results in an HTML response.','java/javax/servlet/http/HttpServletResponse.java'),(408,54170,'Bug 54170 – JMX ObjectName for Filters: names used without quoting (escaping)','How to reproduce:\nExecute \n\ncontext.addFilter(\"deprecatedApiReporterFilterFor/myAPI/v2/*, new ArbitraryServletFilter()).addMappingForUrlPatterns(null, false, \"/myAPI/v2/*\");\n\nfrom inside the contextInitialized-Method of an ServletContextListener.\n\n\nWhat happens:\nNov 19, 2012 6:01:34 PM org.apache.catalina.core.ApplicationFilterConfig registerJMX\nInformation: JMX registration failed for filter of type [ArbitraryServletFilter] and name [deprecatedApiReporterFilterFor/myAPI/v2/*]\njavax.management.RuntimeOperationsException\n	at com.sun.jmx.mbeanserver.Repository.addMBean(Repository.java:411)\n	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.registerWithRepository(DefaultMBeanServerInterceptor.java:1898)\n	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.registerDynamicMBean(DefaultMBeanServerInterceptor.java:966)\n	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.registerObject(DefaultMBeanServerInterceptor.java:900)\n	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.registerMBean(DefaultMBeanServerInterceptor.java:324)\n	at com.sun.jmx.mbeanserver.JmxMBeanServer.registerMBean(JmxMBeanServer.java:512)\n	at org.apache.tomcat.util.modeler.Registry.registerComponent(Registry.java:742)\n	at org.apache.catalina.core.ApplicationFilterConfig.registerJMX(ApplicationFilterConfig.java:432)\n	at org.apache.catalina.core.ApplicationFilterConfig.initFilter(ApplicationFilterConfig.java:281)\n	at org.apache.catalina.core.ApplicationFilterConfig.<init>(ApplicationFilterConfig.java:107)\n	at org.apache.catalina.core.StandardContext.filterStart(StandardContext.java:4638)\n	at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5294)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)\n	at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:895)\n	at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:871)\n	at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:615)\n	at org.apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.java:649)\n	at org.apache.catalina.startup.HostConfig$DeployDescriptor.run(HostConfig.java:1581)\n	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)\n	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)\n	at java.util.concurrent.FutureTask.run(FutureTask.java:166)\n	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)\n	at java.lang.Thread.run(Thread.java:722)\nCaused by: java.lang.IllegalArgumentException: Repository: cannot add mbean for pattern name Catalina:j2eeType=Filter,name=deprecatedApiReporterFilterFor/myAPI/v2/*,WebModule=//localhost/,J2EEApplication=none,J2EEServer=none\n	... 24 more\n\nWhy does it happen:\n\nBecause ApplicationFilterConfig constructs the ObjectName by String concatenation, without escaping the filterName using ObjectName.quote(String s)\n\nI was able to reproduce it using Catalina 7.0.26.','2012-11-19 17:08:42','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','49ff6f0','Mark Emlyn David Thomas','2012-11-22 09:58:51','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54170 Ensure correct registration of Filters and Servlets in the JMX registry if the Filter or Servlet name includes a character that must be quoted if used in an ObjectName value.','TOMCAT-NEXT.txt\njava/org/apache/catalina/core/ApplicationFilterConfig.java\njava/org/apache/catalina/core/StandardWrapper.java\njava/org/apache/tomcat/util/modeler/Util.java\ntest/org/apache/catalina/core/TestApplicationFilterConfig.java'),(409,54144,'Bug 54144 – Processing of java.io.Reader in \"Out\" tagplugin','','2012-11-14 08:38:29','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 minor','7c4a841','Mark Emlyn David Thomas','2012-11-16 18:56:12','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54144 Add required behaviour for Reader objects when used with c:out','java/org/apache/jasper/tagplugins/jstl/Util.java\njava/org/apache/jasper/tagplugins/jstl/core/Out.java\ntest/org/apache/jasper/tagplugins/jstl/core/TestOut.java\ntest/webapp-3.0/bug54144.jsp'),(410,54011,'Bug 54011 – Code generation error in jstl tagPlugin \"Out\" when has \"escapeXml\" on the tagPlugin','','2012-10-16 07:31:26','Sheldon Shao','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','d23fd5f','Mark Emlyn David Thomas','2012-11-16 17:45:28','Follow up on the fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=54011 Need to use the body as the default if no default attribute is defined','java/org/apache/jasper/tagplugins/jstl/core/Out.java\ntest/org/apache/jasper/tagplugins/jstl/core/TestOut.java'),(411,54143,'Bug 54143 – Add display of PermGen memory pool usage to the Status page of the Manager webapp','','2012-11-13 22:39:44','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Manager','P2 enhancement','9998c80','Konstantin Kolinko','2012-11-13 17:49:52','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54143 Add display of memory pools usage (including PermGen) to the Status page of the Manager web application.','java/org/apache/catalina/manager/StatusTransformer.java\nwebapps/manager/xform.xsl'),(412,54141,'Bug 54141 – Configuration does not allow Realms to be nested more than 2 levels deep','','2012-11-13 01:55:35','Christopher Schultz','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','2ed3d7d','Mark Emlyn David Thomas','2012-11-13 09:17:42','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54141 Increase the maximum number of supported nested realm levels from 2 to 3 and make the maximum configurable via a system property.','java/org/apache/catalina/startup/RealmRuleSet.java\nwebapps/docs/config/systemprops.xml'),(413,53960,'Bug 53960 – Extensions to HttpClient test helper class','','2012-10-03 16:51:24','Brian Burch','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','a956a12','Konstantin Kolinko','2012-11-12 19:33:25','For https://issues.apache.org/bugzilla/show_bug.cgi?id=53960 Review of r1402846: If someone needs the extractUriElements() method, one has to call it explicitly. So that a) we do not waste time in 90% of tests where this info is not needed, b) we do not waste time if the response is not HTML.','test/org/apache/catalina/startup/SimpleHttpClient.java'),(414,54044,'Bug 54044 – AccessLogValve using stale date/time with SimpleDateFormat','We are noticing old/stale date/times in out access logs. I copied (and scrubbed) the entries below from an access log from 2012-10-22.\n\n...,2012-10-15 18:00:56.705-0500,\"GET ...\n...,2012-10-22 10:29:01.801-0500,\"GET ...\n...,2012-10-22 10:29:01.802-0500,\"GET ...\n...,2012-10-22 10:29:01.803-0500,\"GET ...\n...,2012-10-22 10:29:01.804-0500,\"GET ...\n...,2012-10-15 18:00:56.804-0500,\"GET ...\n...,2012-10-15 18:00:56.857-0500,\"GET ...\n\nWe use using the SimpleDateFormat functionality and the beginTime prefix.  Our \"pattern\" is:\n\n%{X-Tomcat-Session}i,%S,%{X-Forwarded-For}i,%h,%u,%{begin:yyyy-MM-dd HH:mm:ss.SSSZ}t,&quot;%r&quot;,%s,%b,%p,%{Referer}i,&quot;%{User-Agent}i&quot;,%T\"\n\nIn the example above, jvm/tomcat instance was started on 2012-10-15 at 18:00:41 (a few seconds before the stuck time in the access log) so the  2012-10-15 18:00:56 times are likely related to some caching issues/problems.  We also occasionally see other log entries with incorrect (but not startup) dates/times.  For, example, we sometimes see yesterday\'s date in the access log.\n\nAlso, note that the millisecond times do appear to be correct in that they increase in a reasonable way and are unrelated to the date and second-truncated time.','2012-10-23 15:38:56','Casey Lucas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','641155e','Konstantin Kolinko','2012-11-12 15:17:58','For https://issues.apache.org/bugzilla/show_bug.cgi?id=54044 Add test for org.apache.juli.DateFormatCache. It is port of the test of AccessLogValve.DateFormatCache. I am using reflection to get interesting fields, so no need to change field visibilities.','test/org/apache/catalina/valves/TestAccessLogValve.java\ntest/org/apache/juli/TestDateFormatCache.java'),(415,54087,'Bug 54087 – HTTP Connector incorrectly throws Exception on Invalid If-Modified-Since Header','','2012-11-01 16:10:42','George Sexton','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 normal','810732d','Mark Emlyn David Thomas','2012-11-12 06:32:26','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54087 Ignore invalid If-Modified-Since header as per RFC2616-14.25.a','java/javax/servlet/http/HttpServlet.java'),(416,54115,'Bug 54115 – Minor enhancements to HttpClient test helper class','','2012-11-07 17:10:11','Brian Burch','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','8f53c89','Mark Emlyn David Thomas','2012-11-11 18:47:34','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54115 Minor enhancements to HttpClient test helper class Patch by Brian Burch','test/org/apache/catalina/startup/SimpleHttpClient.java'),(417,54124,'Bug 54124 – wrong javax.servlet.async.request_uri information and javax.servlet.async.path_info is missing','As it is clearly shown that\n\norg.apache.catalina.core.AsyncContextImpl.dispatch(ServletContext, String)\n\n    @Override\n    public void dispatch(ServletContext context, String path) {\n        if (log.isDebugEnabled()) {\n            logDebug(\"dispatch   \");\n        }\n        check();\n        if (request.getAttribute(ASYNC_REQUEST_URI)==null) {\n            request.setAttribute(ASYNC_REQUEST_URI, request.getRequestURI()+\"?\"+request.getQueryString());\n            request.setAttribute(ASYNC_CONTEXT_PATH, request.getContextPath());\n            request.setAttribute(ASYNC_SERVLET_PATH, request.getServletPath());\n            request.setAttribute(ASYNC_QUERY_STRING, request.getQueryString());\n        }\n        ....\n    }\n\nthe value of ASYNC_REQUEST_URI is not the same as request.getRequestURI().\nThey must be equal to each other as defined by Servlet 3.0, 9.7.2\nDispatched Request Parameters.\n\nAnd ASYNC_PATH_INFO is missing.','2012-11-09 10:42:29','Eugene Chung (TmaxSoft)','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','76f84eb','Mark Emlyn David Thomas','2012-11-11 18:43:18','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54124 Correct ASYNC_REQUEST_URI. Addition of query string appears to be left over debug code Add missing ASYNC_PATH_INFO which appears to be an oversight.','java/org/apache/catalina/core/AsyncContextImpl.java'),(418,54123,'Bug 54123 – servlet 3.0 spec violation in async timeout processing','','2012-11-09 10:30:48','Eugene Chung (TmaxSoft)','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 major','14637ef','Mark Emlyn David Thomas','2012-11-11 18:26:55','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54123 There are two things going on here: 1. The reported bug. If there is a async timeout and no async listeners, trigger a 500 response. 2. Implement \"error dispatch\". This is used a couple of times in the spec without any definition. The implication from the part of the spec quoted in the bug report is:    - The standard error page mechanism should be used to identify the page    - An async request that has been started should be left in async mode when forwarding to the error page    - The error page may call complete() or dispatch() This commit hooks into the StandardHostValve to access the error page mechanism. I could have copied and pasted but I preferred the dependency on StandardHostValve Because the error page may do a dispatch(), need to ensure that when running the dispatch(), the error page mechanism is not triggered a second time. Depending on what emerges running the full unit tests and the TCK, I mat still decide to copy the error page code to AsyncContextImpl','java/org/apache/catalina/core/AsyncContextImpl.java\njava/org/apache/catalina/core/StandardHostValve.java\njava/org/apache/coyote/AsyncStateMachine.java\ntest/org/apache/catalina/core/TestAsyncContextImpl.java'),(419,54127,'Bug 54127 – WsOutbound is missing a ping method','','2012-11-09 20:23:13','Sean Winterberger','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','8fea85c','Mark Emlyn David Thomas','2012-11-09 15:32:01','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54127 Add support for sending a WebSocket ping Patch provided by Sean Winterberger','java/org/apache/catalina/websocket/WsOutbound.java'),(420,54096,'Bug 54096 – env-entry rejects legal types','In servlet 3.0 the type in an env-entry can be any type which has a public constructor taking a single String (or character) as an argument. Tomcat only accepts a fixed list of types (see NamingContextListener from line 813).\n\nThis is legal in web.xml but not accepted by tomcat:\n\n<env-entry>\n  <env-entry-name>location</env-entry-name>\n  <env-entry-type>java.io.File</env-entry-type>\n  <env-entry-value>/var/lib/tomcat</env-entry-value>\n</env-entry>','2012-11-04 18:43:14','Mark Thornton','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','48314f9','Mark Emlyn David Thomas','2012-11-09 14:31:07','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54096 env-entry can use any type that has a String or char constructor','java/org/apache/catalina/core/NamingContextListener.java\ntest/org/apache/catalina/core/TestNamingContextListener.java'),(421,54086,'Bug 54086 – ConcurrentModificationException in NioReceiver on shutdown','','2012-11-01 13:32:28','Casey Lucas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Cluster','P2 normal','7bddff0','Mark Emlyn David Thomas','2012-11-04 19:20:24','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54086 Ensure only a single thread tries to close the selector. Prior to this change both the NioReceiverThread and the thread that stops it called closeSelector() I also reviewed all other accesses to this.selector and fixed a handful of other potential threading issues.','java/org/apache/catalina/tribes/transport/ReceiverBase.java\njava/org/apache/catalina/tribes/transport/nio/NioReceiver.java'),(422,54076,'Bug 54076 – SPNEGO authenticator\'s stateless-ness incompatible with stateful clients','','2012-10-30 13:49:27','Michael Osipov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 major','9f65875','Mark Emlyn David Thomas','2012-11-03 18:32:33','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54076 Work-around that enables HTTP keep-alive to be deisabled for specified user agents using SPNEGO.','java/org/apache/catalina/authenticator/SpnegoAuthenticator.java\nwebapps/docs/config/valve.xml'),(423,54060,'Bug 54060 – DigestAuthenticator doesn\'t parse Authorization header correctly','','2012-10-28 21:36:52','Mark Thornton','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','8e20fbf','Mark Emlyn David Thomas','2012-11-03 10:59:13','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54060 Use new HTTP header parser to address issues in current regular expression based parser. This roughly twice as fast and generates about a third of the garbage (based on profiling the load unit test)','java/org/apache/catalina/authenticator/DigestAuthenticator.java'),(424,54060,'Bug 54060 – DigestAuthenticator doesn\'t parse Authorization header correctly','','2012-10-28 21:36:52','Mark Thornton','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','0a2de1a','Mark Emlyn David Thomas','2012-11-01 17:29:16','Initial implementation of a possible solution for BZ 54060. TODO before using this solution:  - lots more test cases  - check performance','java/org/apache/tomcat/util/http/parser/HttpParser2.java\ntest/org/apache/tomcat/util/http/parser/TestHttpParser2.java'),(425,54068,'Bug 54068 – Web fragment sorting incorrectly detects circular reference','','2012-10-30 05:30:27','Dennis Homann','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','07d343a','Mark Emlyn David Thomas','2012-10-31 17:57:26','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54068 Re-write the fragment ordering algorithm to over come multiple problems. Expand the unit tests to cover the identified issues.','java/org/apache/catalina/deploy/WebXml.java\ntest/org/apache/catalina/deploy/TestWebXmlOrdering.java'),(426,54067,'Bug 54067 – Upgrade Response with Transfer-Encoding: chunked invalid','','2012-10-29 17:23:09','Joakim Erdfelt','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Examples','P2 normal','9308b3f','Mark Emlyn David Thomas','2012-10-29 15:47:26','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54067 1xx response codes do not have an entity body. Prior to this fix 101 responses (HTTP upgrade) included \"Transfer-encoding: chunked\" which does not make much sense.','java/org/apache/coyote/http11/AbstractHttp11Processor.java'),(427,53867,'Bug 53867 – Performance tuning solution for PageContextImpl.XmlEscape','','2012-09-13 13:33:48','Sheldon Shao','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 enhancement','c40ca99','Mark Emlyn David Thomas','2012-10-28 17:51:02','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53867 Improve performance of XML escaping Based on a patch by Sheldon Shao','java/org/apache/jasper/runtime/PageContextImpl.java\ntest/org/apache/jasper/runtime/TesterPageContextImpl.java'),(428,53960,'Bug 53960 – Extensions to HttpClient test helper class','','2012-10-03 16:51:24','Brian Burch','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','e4a903e','Mark Emlyn David Thomas','2012-10-27 14:32:02','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53960 Extensions to HttpClient test helper class Patch by Brian Burch','test/org/apache/catalina/startup/SimpleHttpClient.java'),(429,54054,'Bug 54054 – 2 CGIServlet\'s with different Parameter passShellEnvironment','','2012-10-26 07:24:33','Claus Rieber','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','05fe671','Mark Emlyn David Thomas','2012-10-26 15:58:57','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54054 Shell environment should not be static','java/org/apache/catalina/servlets/CGIServlet.java'),(430,54044,'Bug 54044 – AccessLogValve using stale date/time with SimpleDateFormat','We are noticing old/stale date/times in out access logs. I copied (and scrubbed) the entries below from an access log from 2012-10-22.\n\n...,2012-10-15 18:00:56.705-0500,\"GET ...\n...,2012-10-22 10:29:01.801-0500,\"GET ...\n...,2012-10-22 10:29:01.802-0500,\"GET ...\n...,2012-10-22 10:29:01.803-0500,\"GET ...\n...,2012-10-22 10:29:01.804-0500,\"GET ...\n...,2012-10-15 18:00:56.804-0500,\"GET ...\n...,2012-10-15 18:00:56.857-0500,\"GET ...\n\nWe use using the SimpleDateFormat functionality and the beginTime prefix.  Our \"pattern\" is:\n\n%{X-Tomcat-Session}i,%S,%{X-Forwarded-For}i,%h,%u,%{begin:yyyy-MM-dd HH:mm:ss.SSSZ}t,&quot;%r&quot;,%s,%b,%p,%{Referer}i,&quot;%{User-Agent}i&quot;,%T\"\n\nIn the example above, jvm/tomcat instance was started on 2012-10-15 at 18:00:41 (a few seconds before the stuck time in the access log) so the  2012-10-15 18:00:56 times are likely related to some caching issues/problems.  We also occasionally see other log entries with incorrect (but not startup) dates/times.  For, example, we sometimes see yesterday\'s date in the access log.\n\nAlso, note that the millisecond times do appear to be correct in that they increase in a reasonable way and are unrelated to the date and second-truncated time.','2012-10-23 15:38:56','Casey Lucas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','0746c41','Mark Emlyn David Thomas','2012-10-26 14:13:51','Add test case for BZ 54044','test/org/apache/catalina/valves/TestAccessLogValve.java'),(431,54044,'Bug 54044 – AccessLogValve using stale date/time with SimpleDateFormat','We are noticing old/stale date/times in out access logs. I copied (and scrubbed) the entries below from an access log from 2012-10-22.\n\n...,2012-10-15 18:00:56.705-0500,\"GET ...\n...,2012-10-22 10:29:01.801-0500,\"GET ...\n...,2012-10-22 10:29:01.802-0500,\"GET ...\n...,2012-10-22 10:29:01.803-0500,\"GET ...\n...,2012-10-22 10:29:01.804-0500,\"GET ...\n...,2012-10-15 18:00:56.804-0500,\"GET ...\n...,2012-10-15 18:00:56.857-0500,\"GET ...\n\nWe use using the SimpleDateFormat functionality and the beginTime prefix.  Our \"pattern\" is:\n\n%{X-Tomcat-Session}i,%S,%{X-Forwarded-For}i,%h,%u,%{begin:yyyy-MM-dd HH:mm:ss.SSSZ}t,&quot;%r&quot;,%s,%b,%p,%{Referer}i,&quot;%{User-Agent}i&quot;,%T\"\n\nIn the example above, jvm/tomcat instance was started on 2012-10-15 at 18:00:41 (a few seconds before the stuck time in the access log) so the  2012-10-15 18:00:56 times are likely related to some caching issues/problems.  We also occasionally see other log entries with incorrect (but not startup) dates/times.  For, example, we sometimes see yesterday\'s date in the access log.\n\nAlso, note that the millisecond times do appear to be correct in that they increase in a reasonable way and are unrelated to the date and second-truncated time.','2012-10-23 15:38:56','Casey Lucas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','f6f1df0','Mark Emlyn David Thomas','2012-10-26 14:10:33','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54044 Fix off-by-one errors and ensure offset is set when requested value is within cacheSize of the current cache range.','java/org/apache/catalina/valves/AccessLogValve.java'),(432,54022,'Bug 54022 – CometEvent.END event is not sent on a suspended socket disconnect when running with Tomcat Native (tcnative-1.dll) on Windows Vista / Windows Server 2008 or newer.','','2012-10-17 18:18:23','Douglas Beachy','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 blocker','874c332','Mark Emlyn David Thomas','2012-10-25 18:12:33','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54022 Ensure Comet END event is triggered on client disconnect with APR/native on Windows Vista/2k8 or later. Patch provided by Douglas Beachy.','java/org/apache/coyote/AbstractProtocol.java'),(433,54017,'Bug 54017 – new String instance is generated for constant string in Generator.convertString','If the target class is \"Object.class\", the generator generates\n        \"new String(\" + quoted + \")\";\nas attribute value for Tag Handler.\n\nHow about using quoted directly same as when the target class is \"Object.class\"?\n\nCreating a String instance will cause some overhead from memory allocation and hash code recaluation when it is used as a key on HashMap.\n\n\nHere is the detail code,\n\n        /*\n         * @param c The target class to which to coerce the given string @param\n         * s The string value @param attrName The name of the attribute whose\n         * value is being supplied @param propEditorClass The property editor\n         * for the given attribute @param isNamedAttribute true if the given\n         * attribute is a named attribute (that is, specified using the\n         * jsp:attribute standard action), and false otherwise\n         */\n        private String convertString(Class<?> c, String s, String attrName,\n                Class<?> propEditorClass, boolean isNamedAttribute) {\n\n            String quoted = s;\n            if (!isNamedAttribute) {\n                quoted = quote(s);\n            }\n\n            if (propEditorClass != null) {\n                String className = c.getCanonicalName();\n                return \"(\"\n                        + className\n                        + \")org.apache.jasper.runtime.JspRuntimeLibrary.getValueFromBeanInfoPropertyEditor(\"\n                        + className + \".class, \\\"\" + attrName + \"\\\", \" + quoted\n                        + \", \" + propEditorClass.getCanonicalName() + \".class)\";\n            } else if (c == String.class) {\n                return quoted;\n            } else if (c == boolean.class) {\n                return JspUtil.coerceToPrimitiveBoolean(s, isNamedAttribute);\n            } else if (c == Boolean.class) {\n                return JspUtil.coerceToBoolean(s, isNamedAttribute);\n            } else if (c == byte.class) {\n                return JspUtil.coerceToPrimitiveByte(s, isNamedAttribute);\n            } else if (c == Byte.class) {\n                return JspUtil.coerceToByte(s, isNamedAttribute);\n            } else if (c == char.class) {\n                return JspUtil.coerceToChar(s, isNamedAttribute);\n            } else if (c == Character.class) {\n                return JspUtil.coerceToCharacter(s, isNamedAttribute);\n            } else if (c == double.class) {\n                return JspUtil.coerceToPrimitiveDouble(s, isNamedAttribute);\n            } else if (c == Double.class) {\n                return JspUtil.coerceToDouble(s, isNamedAttribute);\n            } else if (c == float.class) {\n                return JspUtil.coerceToPrimitiveFloat(s, isNamedAttribute);\n            } else if (c == Float.class) {\n                return JspUtil.coerceToFloat(s, isNamedAttribute);\n            } else if (c == int.class) {\n                return JspUtil.coerceToInt(s, isNamedAttribute);\n            } else if (c == Integer.class) {\n                return JspUtil.coerceToInteger(s, isNamedAttribute);\n            } else if (c == short.class) {\n                return JspUtil.coerceToPrimitiveShort(s, isNamedAttribute);\n            } else if (c == Short.class) {\n                return JspUtil.coerceToShort(s, isNamedAttribute);\n            } else if (c == long.class) {\n                return JspUtil.coerceToPrimitiveLong(s, isNamedAttribute);\n            } else if (c == Long.class) {\n                return JspUtil.coerceToLong(s, isNamedAttribute);\n            } else if (c == Object.class) {\n                return \"new String(\" + quoted + \")\";\n            } else {\n                String className = c.getCanonicalName();\n                return \"(\"\n                        + className\n                        + \")org.apache.jasper.runtime.JspRuntimeLibrary.getValueFromPropertyEditorManager(\"\n                        + className + \".class, \\\"\" + attrName + \"\\\", \" + quoted\n                        + \")\";\n            }\n        }','2012-10-17 08:47:42','Sheldon Shao','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','095a403','Mark Emlyn David Thomas','2012-10-25 08:14:09','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54017 Simplify and reduce GC.','java/org/apache/jasper/compiler/Generator.java'),(434,54012,'Bug 54012 – No \"pageContext\" in tag files\' generated java code when using code generation by JSTL tagplugin \"Set\"','','2012-10-16 09:01:56','Sheldon Shao','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','a0ff3f9','Mark Emlyn David Thomas','2012-10-25 07:57:13','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54012 Enable the tag plug-in for c:set to work in tag files. Based on a patch by Sheldon Shao.','java/org/apache/jasper/compiler/Compiler.java\njava/org/apache/jasper/compiler/PageInfo.java\njava/org/apache/jasper/compiler/TagPluginManager.java\njava/org/apache/jasper/compiler/tagplugin/TagPluginContext.java\njava/org/apache/jasper/tagplugins/jstl/core/Set.java'),(435,54045,'Bug 54045 – ReplicatedMap don\'t like TcpFailureDetector in static configuration','Tribes stack using:\n* TcpPingInterceptor\n* TcpFailureDetector\n* MessageDispatchInterceptor\n* StaticMembershipInterceptor\nDo not work well in static cluster.\n\nFirst side (ie one thread):\n* call to TcpFailureDetector.heartbeat()\n* call to checkMembers(false)\n* call to performBasicCheck() in synchronized(membership)\n* in performBasicCheck, for a missing static node:\n*   add \"missing\" member to membership with membership.memberAlive(m)\n*       HERE THE SECOND THREAD HAVE SOME TIME TO WORK\n*   check it with memberAlive(m)\n*   remove it since if it doesn\'t exist\n\nSecond side (ie another thread):\n* some call to channel.getMembers() like what the done by AbstractReplicatedMap\n* this call will call the TcpFailureDetector.getMembers()\n* this one could return a wrong value since it can contains unavailable nodes\n\nNote:\n* synchronize on membership isn\'t use by TcpFailureDetector in getMember(), getMembers(), hasMembers(), neither in Membership equivalent method (maybe because it\'s too heavy to lock every thread while the TcpFailureDetector check if node are alive).\n\nIt must not be an issue for AbstractReplicatedMap since with or without TcpFailureDetector a node could disapear while replicated map try to use it.\nBut ReplicatedMap use always Channel.SEND_OPTIONS_DEFAULT where the value is Channel.SEND_OPTIONS_USE_ACK. So a message sent to a missing node will fail with an exception.\n\nPersonnaly I override TcpFailureDetector.heartbeat() to avoid performBasicCheck() if I use a static configuration (TcpPingInterceptor call performForcedCheck()).\nBut this doesn\'t fix ReplicatedMap issue.\n\nBetter fix could avoid adding missing member to membership list:\n* Add a method like memberAlive(MemberImpl) to Membership without side effect (add the member)\n* in TcpFailureDetector.performBasicCheck(): check this new method before adding the node\n\n\nThis doesn\'t fix the AbstractReplicatedMap issue which work always with acknoledge from other nodes.\n\n\nSame code for Tomcat 6.\n\n\nbest regards\nF.Arnoud','2012-10-23 16:03:53','F.Arnoud','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Cluster','P2 major','d2b41b5','Keiichi Fujino','2012-10-25 07:51:10','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54045. Make sure getMembers() returns available member when TcpFailureDetector works in static cluster.','java/org/apache/catalina/tribes/group/interceptors/TcpFailureDetector.java'),(436,54011,'Bug 54011 – Code generation error in jstl tagPlugin \"Out\" when has \"escapeXml\" on the tagPlugin','','2012-10-16 07:31:26','Sheldon Shao','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','8ea0bc5','Mark Emlyn David Thomas','2012-10-24 14:32:56','Follow up to https://issues.apache.org/bugzilla/show_bug.cgi?id=54011 Simplify code. Based on a patch by Sheldon Shao','java/org/apache/jasper/tagplugins/jstl/core/Out.java'),(437,54011,'Bug 54011 – Code generation error in jstl tagPlugin \"Out\" when has \"escapeXml\" on the tagPlugin','','2012-10-16 07:31:26','Sheldon Shao','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','7a6d782','Mark Emlyn David Thomas','2012-10-24 14:20:25','Test case for https://issues.apache.org/bugzilla/show_bug.cgi?id=54011 Note: This uses the new Resources API so can\'t be directly back-ported to 7.0.x.','test/org/apache/jasper/tagplugins/jstl/core/TestOut.java\ntest/webapp-3.0/bug54011.jsp'),(438,54011,'Bug 54011 – Code generation error in jstl tagPlugin \"Out\" when has \"escapeXml\" on the tagPlugin','','2012-10-16 07:31:26','Sheldon Shao','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','ba1d538','Mark Emlyn David Thomas','2012-10-24 14:19:16','Remainder of fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=54011 Value is coerced to boolean in ctx.generateAttribute() so no need for additional conversion Based on a patch by Sheldon Shao','java/org/apache/jasper/tagplugins/jstl/core/Out.java'),(439,54011,'Bug 54011 – Code generation error in jstl tagPlugin \"Out\" when has \"escapeXml\" on the tagPlugin','','2012-10-16 07:31:26','Sheldon Shao','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','953da09','Mark Emlyn David Thomas','2012-10-24 13:34:14','Partial fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=54011 Fix copy/paste error and use correct attribute name Based on a patch by Sheldon Shao','java/org/apache/jasper/tagplugins/jstl/core/Out.java'),(440,54010,'Bug 54010 – Suggestion for code improvement (avoiding potential bug)','In connectors/jk/java/org/apache/jk/common/HandlerRequest.java\n\ncoyote.Request\'s schemeMB is assigned in 2 places.\n\n1st place: \n400         boolean isSSL = msg.getByte() != 0;\n401         if( isSSL ) {\n402             // XXX req.setSecure( true );\n403             req.scheme().setString(\"https\");\n404         }\n\n2nd place:\n518             case AjpConstants.SC_A_SSL_CERT     :\n519                 req.scheme().setString( \"https\" );\nand similar assignments for SC_A_SSL_CIPHER and SC_A_SSL_SESSION cases below.\n\nIt seems they do not make sense because the packet\'s 8-bit field is designated for telling whether it\'s SSL or not. So the 1st place is enough. Adding the 2nd place may pose potential bug in that a packet with the 8-bit SSL field being 0 and suffixes of SC_A_SSL_* key-value pairs can later incorrect trigger a wrong redirection message pointing to a https location.\n\nA simple correction is to honor the 8-bit SSL-field in packet and delete the 3 lines of 2nd place assigning \"https\". \n\nEven though the chances of such spurious packet is low, but it\'s best we can have threat-free, semantic-correct tomcat code.\n\nThe same lines of code remain in 6.0 and 7.0.\n\nBut maybe I misunderstand the code, in which case please kindly point out. Thanks.','2012-10-16 02:20:47','Dongcai Shen','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Connectors','P2 enhancement','9f04094','Mark Emlyn David Thomas','2012-10-22 18:48:38','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=54010 Remove some unnecessary code (duplicate calls to configure the scheme as https for AJP requests originally received over HTTPS).','java/org/apache/coyote/ajp/AbstractAjpProcessor.java\nwebapps/docs/changelog.xml'),(441,53993,'Bug 53993 – NPE in AccessLogValve','During a load test of tomcat 7.0.30, we occasionally see NPEs from the AccessLogValve.  Some of the requests that are being executed as part of the load test call HttpSession.invalidate.  I mention this because the code in question appears to be susceptible to multithreaded manipulation of the session.  I think the fix should be as simple as a check for null on the return value of request.getSessionInternal.\n\nOf course, our access log pattern includes logging the session id.\n\njava.lang.NullPointerException \n    org.​apache.​catalina.​valves.​AccessLogValve$​SessionIdElement.​addElement(​AccessLogValve.java:1733) \n    org.apache.catalina.valves.AccessLogValve.log(AccessLogValve.java:955) \n    org.apache.catalina.core.AccessLogAdapter.log(AccessLogAdapter.java:51) \n    org.apache.catalina.core.StandardEngine.logAccess(StandardEngine.java:332) \n    org.apache.catalina.core.ContainerBase.logAccess(ContainerBase.java:1270) \n    org.apache.catalina.core.ContainerBase.logAccess(ContainerBase.java:1270) \n    org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:441) \n    org.​apache.​coyote.​http11.​AbstractHttp11Processor.​process(​AbstractHttp11Processor.java:1002) \n    org.​apache.​coyote.​AbstractProtocol$​AbstractConnectionHandler.​process(​AbstractProtocol.java:585) \n    org.​apache.​tomcat.​util.​net.​JIoEndpoint$​SocketProcessor.​run(​JIoEndpoint.​java:​312)​ \n    java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110) \n    java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603) \n    java.lang.Thread.run(Thread.java:722)\n\nexisting code for convenience:\n\n    protected static class SessionIdElement implements AccessLogElement {\n        @Override\n        public void addElement(StringBuilder buf, Date date, Request request,\n                Response response, long time) {\n            if (request != null) {\n                if (request.getSession(false) != null) {\n                    buf.append(request.getSessionInternal(false) // LINE 1733\n                            .getIdInternal());\n                } else {\n                    buf.append(\'-\');\n                }\n            } else {\n                buf.append(\'-\');\n            }\n        }\n    }\n\n\npossible fix:\n\n...\n                if (request.getSession(false) != null) {\n                    Session internalSession = request.getSessionInternal(false);\n                    if (internalSession != null) {\n                        buf.append(internalSession.getIdInternal());\n                    } else {\n                        buf.append(\'-\');\n                    }\n                } else {\n                    buf.append(\'-\');\n                }','2012-10-11 19:56:38','Casey Lucas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','39c4270','Mark Emlyn David Thomas','2012-10-13 11:56:21','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53993 Avoid NPE when the session is invalidated','java/org/apache/catalina/valves/AccessLogValve.java'),(442,53986,'Bug 53986 – Comment end tag preceded directly by a dash causes JSP fail compilation','','2012-10-09 18:40:08','Steve Ratay','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','88d8dd5','Mark Emlyn David Thomas','2012-10-10 10:19:40','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53986 Ensure current and reset Mark are always separate objects. Corrects issue with parsing JSP comments that end with \"---%>\".','java/org/apache/jasper/compiler/JspReader.java\ntest/org/apache/jasper/compiler/TestJspReader.java\ntest/webapp-3.0/bug53986.jsp'),(443,53854,'Bug 53854 – DefaultServlet directory listings for aliased directories do not seem to work','','2012-09-11 20:28:09','Daniel Mikusa','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','a3e0f09','Mark Emlyn David Thomas','2012-09-30 15:45:00','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53854 Get directory listings working with aliases','java/org/apache/naming/resources/BaseDirContext.java\njava/org/apache/naming/resources/FileDirContext.java\njava/org/apache/naming/resources/WARDirContext.java'),(444,53843,'Bug 53843 – isAsyncStarted may return false in thread that started async processing','After async processing starts in some container thread A, subsequent calls to request.isAsyncStarted() return true as expected.\n\nHowever as soon as an application thread B calls asyncContext.dispatch(), isAsyncStarted() begins to return false even if the actual dispatch has not yet occurred. For this case the spec says: \"the dispatch operation will be delayed until after the container-initiated dispatch has returned to the container.\"\n\nFor the brief period after dispatch() is called but before the actual dispatch begins (and DispatcherType becomes ASYNC), isAsyncStarted should return true. Without that, the return value of isAsyncStarted() may suddenly change while thread A is still exiting causing it to not recognize that async processing started and that it needs to exit as quickly as possible.','2012-09-08 00:42:57','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','bae31e8','Mark Emlyn David Thomas','2012-09-20 05:55:04','Correct fix for BZ 53843 that triggered a TCK failure','java/org/apache/coyote/AsyncStateMachine.java'),(445,53863,'Bug 53863 – Unable to override default servlet when using Tomcat in embedded mode','An implementation of ServletContainerInitializer can\'t add a mapping to \"/\" because the default servlet is loaded first, as first reported in 51278:\n\npublic final class SampleServletContainerInitializer implements ServletContainerInitializer {\n\n  public void onStartup(final Set<Class<?>> c, final ServletContext ctx) throws ServletException {\n    final XmlWebApplicationContext appCtx = new XmlWebApplicationContext();\n\n    appCtx.setConfigLocation(\"/WEB-INF/DispatcherServlet-servlet.xml\");\n\n    final ServletRegistration.Dynamic dispatcher = ctx.addServlet(\"DispatcherServlet\", new DispatcherServlet(appCtx));\n\n    dispatcher.setLoadOnStartup(1);\n\n    final Set<String> conflictSet = dispatcher.addMapping(\"/\");\n\n    for (final String conflict : conflictSet)\n      out.println(conflict); // prints \"/\"\n\n  }\n\n}\n\nA test case follows attached.','2012-09-13 03:44:28','Fernando Ribeiro','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 critical','7f6f99e','Mark Emlyn David Thomas','2012-09-16 14:15:21','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53863 Ensure implicit Servlets (JSP, default) are marked as override-able when using embedded mode.','java/org/apache/catalina/startup/Tomcat.java'),(446,52777,'Bug 52777 – Automatically shut down old versions in parallel deployment','Under parallel deployment, when an older version in an application has zero sessions, shut it down automatically to release tomcat and JVM resources.\n\nChristopher Schultz suggested these approaches might be possible (on the Tomcat user list):\n\n1. Modify the parallel deployment code to register an MBean\nNotificationListener that filters for useful events (such as expiring\nsession notifications on the outgoing webapp).\n\n2. When the listener receives a notification, check the current state\n(e.g. session count=0; or, I suppose you could make this a part of\nyour filter in step #1). If session count = 0, start a new thread that\nstops the outgoing webapp and de-registers the listener.\n\nOr.\n\n1. Install a SessionEventListener that counts-down the sessions\n(you\'ll have to get the count from JMX, I suppose) until they equal 0,\nthen starts a new thread that ... etc.\n\nOr.\n\n1. Install a Timer thread that polls at intervals (1 minute?) to see\nif all the sessions are dead and then starts a thread ... etc.\n\nThe first idea seems the cleanest, though Tomcat might not actually\nfire MBean events for things like session count changing.','2012-02-27 03:30:27','Ari Maniatis','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','97cefcc','Mark Emlyn David Thomas','2012-09-08 17:00:32','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52777 Implement optional automatic removal of old applications where parallel deployment has been used.','java/org/apache/catalina/Host.java\njava/org/apache/catalina/core/StandardHost.java\njava/org/apache/catalina/core/mbeans-descriptors.xml\njava/org/apache/catalina/startup/HostConfig.java\njava/org/apache/catalina/startup/LocalStrings.properties\njava/org/apache/catalina/startup/mbeans-descriptors.xml\nwebapps/docs/config/context.xml\nwebapps/docs/config/host.xml'),(447,53843,'Bug 53843 – isAsyncStarted may return false in thread that started async processing','After async processing starts in some container thread A, subsequent calls to request.isAsyncStarted() return true as expected.\n\nHowever as soon as an application thread B calls asyncContext.dispatch(), isAsyncStarted() begins to return false even if the actual dispatch has not yet occurred. For this case the spec says: \"the dispatch operation will be delayed until after the container-initiated dispatch has returned to the container.\"\n\nFor the brief period after dispatch() is called but before the actual dispatch begins (and DispatcherType becomes ASYNC), isAsyncStarted should return true. Without that, the return value of isAsyncStarted() may suddenly change while thread A is still exiting causing it to not recognize that async processing started and that it needs to exit as quickly as possible.','2012-09-08 00:42:57','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','ed7aae4','Mark Emlyn David Thomas','2012-09-08 11:08:40','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53843 request.isAsyncStarted() must continue to return true until the dispatch/complete actually happens (which at the earliest isn\'t until the thread where startAsync() was called returns to the container).','java/org/apache/coyote/AsyncStateMachine.java\ntest/org/apache/catalina/core/TestAsyncContextImpl.java'),(448,53713,'Bug 53713 – Performance tuning solution for JspReader','','2012-08-14 06:28:58','Sheldon Shao','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 enhancement','5fccf68','Mark Emlyn David Thomas','2012-09-05 18:06:32','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53713 Performance improvement (up to four times faster parsing) for JSP processing. Patch provided by Sheldon Shao.','java/org/apache/jasper/compiler/JspReader.java\njava/org/apache/jasper/compiler/Mark.java'),(449,53828,'Bug 53828 – StreamInbound.closeOutboundConnection(WsFrame) closes with an opcode instead of status','201	private void closeOutboundConnection(WsFrame frame) throws IOException {\n202	  try {\n203	    getWsOutbound().close(frame);\n204	  } finally {\n205	    doOnClose(Constants.OPCODE_CLOSE);\n206	  }\n207	}\n\nLine 205 uses the close opcode instead of a valid status (Constants.STATUS_*).\n\nNot sure of the exact context of this called but it seems to only be called when the last frame from the client was a close frame, thus a Constants.STATUS_NORMAL may be in order.\n\nIf not, the frame\'s opcode could be inspected and mapped to an appropriate status (normal, shutdown, etc...).\n\nThanks,\nMichael','2012-09-04 16:55:42','Michael Newcomb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','a81d941','Mark Emlyn David Thomas','2012-09-04 16:03:25','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53828 Use the correct status code','java/org/apache/catalina/websocket/StreamInbound.java'),(450,53801,'Bug 53801 – Nondeterministic behaviour of security constraints','','2012-08-30 09:14:42','Matteo Casalino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 normal','95d7a0f','Mark Emlyn David Thomas','2012-08-30 18:55:20','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53801 Overlapping URL patterns were sometimes merged incorrectly in security constraints leading to incorrect 401 responses. Note: it was possible for access to be denied when it should have been granted but it was not possible for access to be granted when it should have been denied.','java/org/apache/catalina/realm/RealmBase.java'),(451,53677,'Bug 53677 – ArrayIndexOutOfBoundsException when response header exceeds maxHttpHeaderSize','','2012-08-07 23:28:11','Dan Henry','Tomcat Developers Mailing List','NEW','Tomcat 6','Catalina','P2 normal','28ee7c1','Mark Emlyn David Thomas','2012-08-30 17:57:15','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53677 Ensure a 500 response of the HTTP headers exceed the size limit','java/org/apache/coyote/http11/AbstractHttp11Processor.java\njava/org/apache/coyote/http11/AbstractOutputBuffer.java\njava/org/apache/coyote/http11/HeadersTooLargeException.java\ntest/org/apache/coyote/http11/TestAbstractHttp11Processor.java'),(452,53792,'Bug 53792 – EL: AstValue.getTarget() mistakes a method invocation for a property access','Trying to evaluate the method expression #{beanFactory.loginBean().init}\n\nExpected behavior: lookup beanFactory, invoke its loginBean method and on its return value, invoke the init method.\n\nActual behavior: the following exception is thrown: \njavax.el.PropertyNotFoundException: /LoginView.xhtml @9,101 listener=\"#{viewBeanFactory.loginBean().initIfGetRequest}\": Property \'loginBean\' not found on type ch.bedag.redacted.InteractionLayer$$EnhancerByCGLIB$$1ea36cb9\n\nLooking at the source, AstValue.getTarget(EvaluationContext) only checks whether the last child is an instanceof AstMethodParameters, but in this expression there is an additional method invocation expression before that ...\n\nPresumably, the while loop \n\n            while (base != null && i < propCount) {\n                property = this.children[i].getValue(ctx);\n                ctx.setPropertyResolved(false);\n                base = resolver.getValue(ctx, base, property);\n                i++;\n            }\n\nshould be something like:\n\n            while (base != null && i < propCount) {\n                if (i + 1 < propCount && this.children[i + 1] instanceof AstMethodParameters) {\n                    base = // result of method invocation\n                    i += 2;\n                } else {\n                    property = this.children[i].getValue(ctx);\n                    ctx.setPropertyResolved(false);\n                    base = resolver.getValue(ctx, base, property);\n                    i++;\n                }\n            }','2012-08-28 20:24:06','Adrian Moos','Tomcat Developers Mailing List','CLOSED FIXED','Tomcat 7','Jasper','P2 normal','251317f','Mark Emlyn David Thomas','2012-08-30 15:43:26','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53792 Support method expressions that include a method call that is not at the end of the expression','java/org/apache/el/parser/AstValue.java\ntest/org/apache/el/TestMethodExpressionImpl.java'),(453,53800,'Bug 53800 – Infinte loop cause by FileDirContext in a CDI/Weld project when using Eclipse\'s \"Server modules without publishing\"','','2012-08-30 06:19:19','Kevin Wooten','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','44eabba','Konstantin Kolinko','2012-08-30 02:43:52','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53800 FileDirContext.list() did not provide correct paths for subdirectories. Patch provided by Kevin Wooten.','java/org/apache/naming/resources/FileDirContext.java'),(454,53792,'Bug 53792 – EL: AstValue.getTarget() mistakes a method invocation for a property access','Trying to evaluate the method expression #{beanFactory.loginBean().init}\n\nExpected behavior: lookup beanFactory, invoke its loginBean method and on its return value, invoke the init method.\n\nActual behavior: the following exception is thrown: \njavax.el.PropertyNotFoundException: /LoginView.xhtml @9,101 listener=\"#{viewBeanFactory.loginBean().initIfGetRequest}\": Property \'loginBean\' not found on type ch.bedag.redacted.InteractionLayer$$EnhancerByCGLIB$$1ea36cb9\n\nLooking at the source, AstValue.getTarget(EvaluationContext) only checks whether the last child is an instanceof AstMethodParameters, but in this expression there is an additional method invocation expression before that ...\n\nPresumably, the while loop \n\n            while (base != null && i < propCount) {\n                property = this.children[i].getValue(ctx);\n                ctx.setPropertyResolved(false);\n                base = resolver.getValue(ctx, base, property);\n                i++;\n            }\n\nshould be something like:\n\n            while (base != null && i < propCount) {\n                if (i + 1 < propCount && this.children[i + 1] instanceof AstMethodParameters) {\n                    base = // result of method invocation\n                    i += 2;\n                } else {\n                    property = this.children[i].getValue(ctx);\n                    ctx.setPropertyResolved(false);\n                    base = resolver.getValue(ctx, base, property);\n                    i++;\n                }\n            }','2012-08-28 20:24:06','Adrian Moos','Tomcat Developers Mailing List','CLOSED FIXED','Tomcat 7','Jasper','P2 normal','a570fc7','Mark Emlyn David Thomas','2012-08-29 16:49:02','Add some tests for Bug 53792','test/org/apache/el/TestMethodExpressionImpl.java'),(455,53793,'Bug 53793 – Change webapp links in Manager to point to /appname/ instead of /appname','The first column of the table that lists Web Applications in Tomcat Manager webapp contains links to those applications, e.g.\n\n  <a href=\"/examples\">/examples</a>\n\nWhen the link is clicked and browser navigates to \"/examples\", it results in 302 redirect to \"/examples/\".\n\nIt would be better to change that link to point directly to \"/examples/\".\n\n  <a href=\"/examples/\">/examples</a>\n\nI am changing the link address only, but not the text on it. That is because the \"Path\" of the web application displayed in that column (and used in Manager commands elsewhere) does not have the additional \'/\'.','2012-08-28 21:50:21','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Manager','P2 enhancement','fcc3d65','Konstantin Kolinko','2012-08-28 18:03:33','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53793 Change webapp links in Manager to point to /appname/ instead of /appname','java/org/apache/catalina/manager/HTMLManagerServlet.java'),(456,42181,'Bug 42181 – ArrayIndexOutOfBoundsException in parseChunkHeader','Apr 22, 2007 11:53:32 AM org.apache.coyote.http11.Http11Processor process\nSEVERE: Error finishing request\njava.lang.ArrayIndexOutOfBoundsException: -28\n        at\norg.apache.coyote.http11.filters.ChunkedInputFilter.parseChunkHeader(ChunkedInputFilter.java:256)\n        at\norg.apache.coyote.http11.filters.ChunkedInputFilter.doRead(ChunkedInputFilter.java:129)\n        at\norg.apache.coyote.http11.filters.ChunkedInputFilter.end(ChunkedInputFilter.java:179)\n        at\norg.apache.coyote.http11.InternalInputBuffer.endRequest(InternalInputBuffer.java:368)\n        at\norg.apache.coyote.http11.Http11Processor.process(Http11Processor.java:894)\n        at\norg.apache.coyote.http11.Http11BaseProtocol$Http11ConnectionHandler.processConnection(Http11BaseProtocol.java:664)\n        at\norg.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:527)\n        at\norg.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:80)\n        at\norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:684)\n        at java.lang.Thread.run(Thread.java:595)','2007-04-21 22:48:21','Nana','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Connector:Coyote','P2 normal','cd05aa1','Konstantin Kolinko','2012-08-27 19:04:11','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=42181 Better handling of edge conditions in chunk header processing.','java/org/apache/coyote/http11/filters/ChunkedInputFilter.java\njava/org/apache/tomcat/util/buf/HexUtils.java\ntest/org/apache/tomcat/util/buf/TestHexUtils.java'),(457,53783,'Bug 53783 – Static resources and jsp files under WEB-INF/lib/*.jar!/META-INF/resources are not found','','2012-08-27 13:32:16','Violeta Georgieva','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','6b934d8','Mark Emlyn David Thomas','2012-08-27 14:40:09','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53783 Handle case where tool generating JARs does not generate entries for directories.','java/org/apache/catalina/startup/ContextConfig.java'),(458,53267,'Bug 53267 – The JreMemoryLeakPreventionListener causes a full GC every hour when gcDaemonProtection=true','','2012-05-21 14:41:43','Pid','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','a32ebd1','Filip Hanik','2012-08-26 19:48:01','don\'t hard code values, no need to https://issues.apache.org/bugzilla/show_bug.cgi?id=53267','java/org/apache/catalina/core/JreMemoryLeakPreventionListener.java\nwebapps/docs/config/systemprops.xml'),(459,53758,'Bug 53758 – Dynamic Filter Registration mapping logic inverted','In the class org.apache.catalina.core.ApplicationFilterRegistration, the methods addMappingForServletNames and addMappingForUrlPatterns have inverted logic on how to register the filter to the context.\n\nIf the parameter isMatchAfter is passed as true, the filter is placed in the context using the addFilterMapBefore method.\n\nif (isMatchAfter) {\n    context.addFilterMapBefore(filterMap);\n} else {\n    context.addFilterMap(filterMap);\n}\n\nThe logic should ultimate be (in both methods):\n\nif (!isMatchAfter) {\n    context.addFilterMapBefore(filterMap);\n} else {\n    context.addFilterMap(filterMap);\n}\n\nor\n\nif (isMatchAfter) {\n    context.addFilterMap(filterMap);\n} else {\n    context.addFilterMapBefore(filterMap);\n}\n\n\n\nsvn rev on trunk is 1375614','2012-08-21 19:59:03','David Graff','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 major','8f169e4','Mark Emlyn David Thomas','2012-08-26 18:29:04','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53758 Fix Dynamic Filter Registration mapping logic inverted','java/org/apache/catalina/core/ApplicationFilterRegistration.java'),(461,53737,'Bug 53737 – Use ServletContext.getJspConfigDescriptor() in Jasper instead of XML-parsing of merged web.xml','In Tomcat 7.0.29 in ContextConfig#webConfig() a merged web.xml file is serialized into String and is put as an attribute into ServletContext.\n\n[[[\n        String mergedWebXml = webXml.toXml();\n        sContext.setAttribute(\n               org.apache.tomcat.util.scan.Constants.MERGED_WEB_XML,\n               mergedWebXml);\n]]]\n\nThen in JspConfig#processWebDotXml() of Jasper it is parsed again from XML into objects.\n\nIt would be better to access the necessary configuration through Servlet 3.0 API methods such as ServletContext.getJspConfigDescriptor().','2012-08-18 00:54:55','Konstantin Kolinko','Tomcat Developers Mailing List','REOPENED','Tomcat 8','Jasper','P2 enhancement','11c3bce','Mark Emlyn David Thomas','2012-08-26 16:25:30','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53737 Access JSP configuration information via the ServletContext rather than re-parsing web.xml','java/org/apache/jasper/compiler/JspConfig.java\njava/org/apache/jasper/compiler/TldLocationsCache.java\njava/org/apache/jasper/compiler/WebXml.java'),(462,53047,'Bug 53047 – JDBCRealm allRolesMode=\"authOnly\" still needs role table','When a JDBCRealm is created with the allRolesMode attribute set to \"authOnly\" a role table is still needed even though the documentation states: \"The alternative values are authOnly which means that the user must be authenticated but no check is made for assigned roles\". No check implies no role table needed. Hint: JDBCRealm.hasRole should probably always return true if the allRolesMode is set to \"authOnly\". The current workaround is to create a view over the user table with a fixed role name.','2012-04-08 11:18:56','Dennis Verbeek','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 minor','a9d5974','Konstantin Kolinko','2012-08-26 10:01:57','For https://issues.apache.org/bugzilla/show_bug.cgi?id=53047 Update documentation. Thanks to the changes introduced by implementing BZ 53047, the roleNameCol and userRoleTable attributes in JDBCRealm and DataSourceRealm became optional ones.','webapps/docs/config/realm.xml'),(463,53047,'Bug 53047 – JDBCRealm allRolesMode=\"authOnly\" still needs role table','When a JDBCRealm is created with the allRolesMode attribute set to \"authOnly\" a role table is still needed even though the documentation states: \"The alternative values are authOnly which means that the user must be authenticated but no check is made for assigned roles\". No check implies no role table needed. Hint: JDBCRealm.hasRole should probably always return true if the allRolesMode is set to \"authOnly\". The current workaround is to create a view over the user table with a fixed role name.','2012-04-08 11:18:56','Dennis Verbeek','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 minor','a9d5974','Konstantin Kolinko','2012-08-26 10:01:57','For https://issues.apache.org/bugzilla/show_bug.cgi?id=53047 Update documentation. Thanks to the changes introduced by implementing BZ 53047, the roleNameCol and userRoleTable attributes in JDBCRealm and DataSourceRealm became optional ones.','webapps/docs/config/realm.xml'),(464,53725,'Bug 53725 – Some GZipped responses result in java.io.IOException: Corrupt GZIP trailer during gunzip.','','2012-08-15 18:28:36','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 critical','3dff241','Mark Emlyn David Thomas','2012-08-25 16:06:59','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53725 Fix corruption in some GZIP\'d content','java/org/apache/coyote/http11/filters/FlushableGZIPOutputStream.java'),(465,53714,'Bug 53714 – misleading log output when jarsToSkip cointains web-fragments','I have a jar which contains a web-fragment and no TLDs. When starting the server I get the Message:\n\norg.apache.jasper.compiler.TldLocationsCache tldScanJar\nINFO: At least one JAR was scanned for TLDs yet contained no TLDs. Enable debug logging for this logger for a complete list of JARs that were scanned but no TLDs were found in them. Skipping unneeded JARs during scanning can improve startup time and JSP compilation time.\n\nso far so good.\n\nWhen adding it to the tomcat.util.scan.DefaultJarScanner.jarsToSkip property the web-fragment won\'t be scanned either.\n\nThe log message should only be printed when no TLDs and web-fragments could be found in the jar.','2012-08-14 09:13:38','Volker Krebs','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 minor','15e8d8e','Mark Emlyn David Thomas','2012-08-24 16:05:41','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53714 Provide a means of excluding JARs from pluggability scans, TLD scans or all scans.','conf/catalina.properties\njava/org/apache/catalina/startup/Constants.java\njava/org/apache/catalina/startup/ContextConfig.java\njava/org/apache/catalina/startup/TldConfig.java\njava/org/apache/jasper/Constants.java\njava/org/apache/jasper/compiler/TldLocationsCache.java\njava/org/apache/jasper/resources/LocalStrings.properties\nwebapps/docs/config/systemprops.xml'),(466,53697,'Bug 53697 – java.lang.NullPointerException at org.apache.coyote.http11.Http11AprProcessor.actionInternal(Http11AprProcessor.java:277)','I hit tomcat with ~20 different urls in ~2 seconds, test some functionality, wait ~3 minutes, then do it again and I always get this exception and then I get (intermitent) connection interrupted messages in the browser.  Here\'s the full trace:\n\nAug 10, 2012 6:33:14 PM org.apache.catalina.connector.CoyoteAdapter event\nSEVERE: null\nAug 10, 2012 6:33:14 PM org.apache.catalina.connector.CoyoteAdapter event\njava.lang.NullPointerException\n	at org.apache.coyote.http11.Http11AprProcessor.actionInternal(Http11AprProcessor.java:277)\n	at org.apache.coyote.http11.AbstractHttp11Processor.action(AbstractHttp11Processor.java:846)\n	at org.apache.coyote.Response.action(Response.java:172)\n	at org.apache.catalina.connector.CoyoteAdapter.event(CoyoteAdapter.java:229)\n	at org.apache.coyote.http11.Http11AprProcessor.event(Http11AprProcessor.java:133)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:581)\n	at org.apache.tomcat.util.net.AprEndpoint$SocketProcessor.run(AprEndpoint.java:1770)\n	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)\n	at java.lang.Thread.run(Thread.java:722)\n\nAug 10, 2012 6:33:14 PM org.apache.coyote.http11.Http11AprProcessor event\nSEVERE: Error processing request\njava.lang.NullPointerException\n	at org.apache.coyote.http11.Http11AprProcessor.actionInternal(Http11AprProcessor.java:277)\n	at org.apache.coyote.http11.AbstractHttp11Processor.action(AbstractHttp11Processor.java:846)\n	at org.apache.coyote.Request.action(Request.java:346)\n	at org.apache.catalina.connector.Request.getRemoteAddr(Request.java:1281)\n	at org.apache.catalina.connector.Request.getRemoteHost(Request.java:1296)\n	at org.apache.catalina.valves.AccessLogValve$HostElement.addElement(AccessLogValve.java:1327)\n	at org.apache.catalina.valves.AccessLogValve.log(AccessLogValve.java:953)\n	at org.apache.catalina.core.AccessLogAdapter.log(AccessLogAdapter.java:51)\n	at org.apache.catalina.core.ContainerBase.logAccess(ContainerBase.java:1263)\n	at org.apache.catalina.core.ContainerBase.logAccess(ContainerBase.java:1270)\n	at org.apache.catalina.connector.CoyoteAdapter.event(CoyoteAdapter.java:250)\n	at org.apache.coyote.http11.Http11AprProcessor.event(Http11AprProcessor.java:133)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:581)\n	at org.apache.tomcat.util.net.AprEndpoint$SocketProcessor.run(AprEndpoint.java:1770)\n	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)\n	at java.lang.Thread.run(Thread.java:722)\n\nAdditional information:\n - hp Proliant DL360 with two 3ghz processors\n - CentOS 6.3\n - One app runs websockets under bleading edge Atmosphere and Grails\n - the 20 urls come from chrome and firefox, simulatneously','2012-08-11 08:33:54','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 normal','6c13431','Mark Emlyn David Thomas','2012-08-15 18:45:51','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53697 Fix a regression in the fix for BZ 51881 that mean that in some circumstances the isComet flag was not reset on the HttpAprProcessor. This caused problems when the Processor was re-used for a new connection.','java/org/apache/coyote/http11/AbstractHttp11Processor.java\njava/org/apache/coyote/http11/Http11NioProcessor.java'),(467,51881,'Bug 51881 – Server incorrectly parses incoming HTTP requests and loses them','We are developing Comet-based web application with native Tomcat Comet support via Atmosphere framework. We use HTTP streaming for transferring data from our servlet to the client. In our scenario, the user connects to the server with XMLHTTPRequest sending GET. In response, we suspend his connection and then, when needed, send data back to him. When the user opens another browser tab and connects to our web application, our web application should close the connection in the first (previously opened) tab and then suspend and use connection from the second. So, my serlvet detect that another GET is incoming in the same session, finds previous connection and closes it (internally using CometEvent.close()). This works as intended. However, the next HTTP request to the web server is not correctly handled, and in my servlet I receive the strange HttpServletRequest with previous GET query string and duplicate request headers from initial GET and the following request. I traced through the Tomcat code, and noticed, that in org.apache.coyote.http11.Http11Processor.process() request field is usually empty (contains no HTTP method, request headers, etc.) However, after Comet closing this object is not empty and contain previoud HTTP request. Later the request headers are parsed and appended to the fields existed in previous request object. After that, this invalid object is passed to my Servlet.\nI suppose, that clearing request object when closing comet event and all assosiated data in Http11NioProcessor.actionInternal() can solve this issue.','2011-09-23 11:55:42','Edward Alexandrov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 critical','6c13431','Mark Emlyn David Thomas','2012-08-15 18:45:51','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53697 Fix a regression in the fix for BZ 51881 that mean that in some circumstances the isComet flag was not reset on the HttpAprProcessor. This caused problems when the Processor was re-used for a new connection.','java/org/apache/coyote/http11/AbstractHttp11Processor.java\njava/org/apache/coyote/http11/Http11NioProcessor.java'),(468,53702,'Bug 53702 – Only the last url-pattern from jsp-property-group is processed','','2012-08-12 14:54:17','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','e38a097','Mark Emlyn David Thomas','2012-08-15 16:32:44','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53702 <jsp-property-group> may contain multiple <url-pattern>','java/org/apache/catalina/core/ApplicationJspPropertyGroupDescriptor.java\njava/org/apache/catalina/deploy/JspPropertyGroup.java\njava/org/apache/catalina/deploy/WebXml.java\njava/org/apache/catalina/startup/WebRuleSet.java'),(469,53654,'Bug 53654 – JSP file is always recompiled for using file based TLD URL','Now, in Jasper codes, it only supports jar URL and relative URL, that may be enough for common web applications. While, it is possible that the third-party uses other protocol URL, like file: protocol based URL. So, the JSP files will be always recompiled for each access for the target page.\nThe codes are located in Compiler.isOutDated() method.\nIs it possible to provide more generic handlering for the URL ?','2012-08-05 14:47:43','Ivan','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','1efc23d','Mark Emlyn David Thomas','2012-08-15 12:01:19','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53654 Support file:// URLs for JSP dependencies','java/org/apache/jasper/compiler/Compiler.java'),(470,53624,'Bug 53624 – sendRedirect doesn\'t work after a dispatch through the AsyncContext','','2012-07-30 19:07:39','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','e37b01e','Mark Emlyn David Thomas','2012-08-14 18:14:39','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53624 Remove some include specific code from dispatch, copied when the doDispatch() method was created. Note that this bug report pre-dates that copy. At the time of the bug report dispatch was implemented by calling include()','java/org/apache/catalina/core/ApplicationDispatcher.java'),(471,53623,'Bug 53623 – Incorrect request properties after AsyncContext.dispatch','','2012-07-30 18:51:54','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','fd75a51','Mark Emlyn David Thomas','2012-08-14 16:49:49','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53623 Async dispatches require similar handling to RequestDispatcher.include() hence the implementation of async dispatch uses RequestDispatcher.include() However, since RequestDispatcher provides no API for differentiating between and INCLUDE and DISPATCH some form of trickery has to be used. The previous implementation worked in most cases but failed in some cases (multiple forwards prior to dispatch, wrapping the request). This alternative implementation calls a specific method on the RequestDispatcher implementation (we have to access the implementation class since we can\'t modify the servlet API) which removes any ambiguity and allows the correct handling in all cases.','java/org/apache/catalina/AsyncDispatcher.java\njava/org/apache/catalina/core/ApplicationDispatcher.java\njava/org/apache/catalina/core/AsyncContextImpl.java\njava/org/apache/catalina/core/LocalStrings.properties'),(472,53701,'Bug 53701 – Javadoc fixes','','2012-08-12 12:25:04','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','2a3b42d','Mark Emlyn David Thomas','2012-08-14 14:14:42','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53701 Javadoc fixes provided by Sebb.','java/javax/servlet/ServletInputStream.java\njava/javax/servlet/ServletOutputStream.java\njava/javax/servlet/jsp/JspException.java\njava/org/apache/catalina/Executor.java\njava/org/apache/catalina/Manager.java\njava/org/apache/catalina/tribes/ErrorHandler.java\njava/org/apache/naming/SelectorContext.java\njava/org/apache/tomcat/util/http/fileupload/FileItem.java\nwebapps/examples/WEB-INF/classes/compressionFilters/CompressionResponseStream.java'),(473,53700,'Bug 53700 – InternalNioOutputBuffer unused (debug?) code','The class InternalNioOutputBuffer includes the field:\n\nint total = 0;\n\nThis is currently defined at line 227, which is between the Javadoc and method body to which the Javadoc applies, i.e. private synchronized int writeToSocket.\n\nThis invalidates the method Javadoc.\n\nThe field is used to keep a running total of bytes written by the method; however the field is not actually referenced - the System.out.println statement is commented out.\n\nThe field and associated code shcould probably be deleted.\n\nIf the field is to be kept, it should be private, and it should probably be changed to long, and of course should be moved so it does not invalidate the method Javadoc.','2012-08-12 11:17:07','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 8','Connectors','P2 minor','a2ca744','Mark Emlyn David Thomas','2012-08-14 14:00:44','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53700 Remove unused code that also broke some Javadoc','java/org/apache/coyote/http11/InternalNioOutputBuffer.java'),(474,53584,'Bug 53584 – Forms authentication without cookies requires double submission in 6.0.33','','2012-07-22 23:28:24','b.mason@adinstruments.com','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','7da043c','Mark Emlyn David Thomas','2012-08-13 08:25:57','Additional fix for http://issues.apache.org/bugzilla/show_bug.cgi?id=53584 Store decoded and original request URI. Restore both. Use decoded for matching.','java/org/apache/catalina/authenticator/FormAuthenticator.java\njava/org/apache/catalina/authenticator/SavedRequest.java'),(475,53623,'Bug 53623 – Incorrect request properties after AsyncContext.dispatch','','2012-07-30 18:51:54','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','657b4cb','Mark Emlyn David Thomas','2012-08-12 13:33:31','Add additional check on current behaviour to try and catch any regressions in the fix for 53623','test/org/apache/catalina/core/TestAsyncContextImpl.java'),(476,53071,'Bug 53071 – ErrorReportValve ignores message from throwable','','2012-04-13 09:34:03','Michael Osipov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','f964ec7','Mark Emlyn David Thomas','2012-08-12 11:39:24','Additional fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=53071 Trim long exception messages','java/org/apache/catalina/valves/ErrorReportValve.java'),(477,53574,'Bug 53574 – metadata-complete=\"true\" and servlet defined as jsp not working','We have a servlet defined as \n\n<servlet>\n        <servlet-name>VersionInfoServlet</servlet-name>\n        <jsp-file>/WEB-INF/svnrevision.jsp</jsp-file>\n</servlet>\n\nand mapped as \n\n<servlet-mapping>\n        <servlet-name>VersionInfoServlet</servlet-name>\n        <url-pattern>/svnrevision</url-pattern>\n</servlet-mapping>\n\n\n\nIt worked fine. Then we changed metadata-complete to \"true\", and from now on we receive \n\nINFO: Marking servlet VersionInfoServlet as unavailable\nlip 20, 2012 11:05:36 AM org.apache.catalina.core.StandardWrapperValve invoke\nSEVERE: Allocate exception for servlet VersionInfoServlet\njavax.servlet.ServletException: No servlet class has been specified for servlet VersionInfoServlet\n        at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1130)\n        at org.apache.catalina.core.StandardWrapper.allocate(StandardWrapper.java:857)\n        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:136)\n        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)\n        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)\n        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)\n        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)\n        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)\n        at org.apache.coyote.ajp.AjpNioProcessor.process(AjpNioProcessor.java:184)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:585)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1653)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)\n        at java.lang.Thread.run(Thread.java:722)','2012-07-20 09:35:23','Mirek','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','f9b0182','Mark Emlyn David Thomas','2012-08-11 14:54:53','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53574 Ensure Servlets defined using jsp-file are available when metadata-complete is true.','java/org/apache/catalina/startup/ContextConfig.java\ntest/org/apache/catalina/startup/TestContextConfig.java\ntest/webapp-3.0/WEB-INF/jsp/bug53574.jsp\ntest/webapp-3.0/WEB-INF/web.xml'),(478,53545,'Bug 53545 – jsp:forward action to static resources causes IllegalStateException when inside classic custom tag','','2012-07-13 07:53:20','Radu Gancea','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 major','5a6b27b','Mark Emlyn David Thomas','2012-08-11 05:43:19','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53545 Ensure buffered data is cleared when using a jsp:forward action to a static resource inside classic a custom tag','java/org/apache/jasper/runtime/PageContextImpl.java\ntest/org/apache/jasper/runtime/TestPageContextImpl.java\ntest/org/apache/tomcat/unittest/tags/Bug53545.java\ntest/webapp-3.0/WEB-INF/bug53545.tld\ntest/webapp-3.0/bug53545.html\ntest/webapp-3.0/bug53545.jsp'),(479,53541,'Bug 53541 – Bug in virtual webapp feature. Custom tags badly supported. Error is \"org.apache.jasper.JasperException: The absolute uri: http://java.sun.com/jsp/jstl/core cannot be resolved in either web.xml or the jar files deployed with this application','','2012-07-12 18:16:08','Philip','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 major','432bd0f','Mark Emlyn David Thomas','2012-08-10 15:41:27','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53541 Fix JAR scanning when WEB-INF/lib is provided via VirtualDirContext Patch provided by Philip Zuev','java/org/apache/naming/resources/VirtualDirContext.java'),(480,53653,'Bug 53653 – Allow for wrapped source code example in config/context.html','','2012-08-05 05:56:00','Terence Bandoian','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 enhancement','7cbf46d','Christopher Schultz','2012-08-09 13:44:01','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53653 Allow for wrapped source code example in config/context.html','webapps/docs/config/context.xml\nwebapps/docs/tomcat-docs.xsl'),(481,53481,'Bug 53481 – Support SSL_OP_CIPHER_SERVER_PREFERENCE / SSLHonorCipherOrder','','2012-06-28 14:27:30','Mike Noordermeer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Native','Library','P2 normal','82e5dce','Christopher Schultz','2012-08-09 12:17:01','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53481 Added support for SSL_OP_CIPHER_SERVER_PREFERENCE / SSLHonorCipherOrder.','java/org/apache/coyote/http11/Http11AprProtocol.java\njava/org/apache/tomcat/util/net/AprEndpoint.java\njava/org/apache/tomcat/util/net/res/LocalStrings.properties\nwebapps/docs/config/http.xml'),(482,53641,'Bug 53641 – Wrong websocket\'s subprotocol implementation','According to RFC6455 Section 4.3. the handling of subprotocol requests is not correct.\nIt must be checked for \"Sec-WebSocket-Protocol\" instead of \"Sec-WebSocket-Protocol-Client\" in WebSocketServlet class.','2012-08-02 12:52:08','Stephan Wolf','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','af45441','Mark Emlyn David Thomas','2012-08-07 17:51:30','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53641 Correct name of HTTP header used in WebSocket handshake for listing the preferred protocols','java/org/apache/catalina/websocket/WebSocketServlet.java'),(483,53584,'Bug 53584 – Forms authentication without cookies requires double submission in 6.0.33','','2012-07-22 23:28:24','b.mason@adinstruments.com','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','cfb0487','Mark Emlyn David Thomas','2012-08-07 17:29:18','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53584 Ignore path parameters when comparing URIs for FORM authentication. This prevents users being prompted twice for passwords when logging in when session IDs are being encoded as path parameters.','java/org/apache/catalina/authenticator/FormAuthenticator.java'),(484,53649,'Bug 53649 – build jdbc-pool: bootstrap class path not set in conjunction with -source 1.5','After converting to java 1.7, I did an ant clean (not clean-depend) and the ant deploy.\n\nThe verbose messages begin as follows:\n\nApache Ant(TM) version 1.8.2 compiled on December 3 2011\nTrying the default build file: build.xml\nBuildfile: /home/brian/sandboxApache/tomcat8/trunk/build.xml\nDetected Java version: 1.7 in: /usr/lib/jvm/java-7-openjdk-i386/jre\nDetected OS: Linux\nparsing buildfile /home/brian/sandboxApache/tomcat8/trunk/build.xml with URI = file:/home/brian/sandboxApache/tomcat8/trunk/build.xml\n\nDuring the deploy target, at around this point...\n\n    <!-- build the jdbc-pool jar and source jar-->\n    <echo message=\"Building Tomcat JDBC pool libraries\"/>\n    <ant antfile=\"${tomcat.jdbc.dir}/build.xml\" dir=\"${tomcat.jdbc.dir}\" inheritall=\"false\" target=\"build\">\n\nI noticed the following messages leading to a warning in the build:\n\n      [ant] Entering /home/brian/sandboxApache/tomcat8/trunk/modules/jdbc-pool/build.xml...\n\n [property] Loading /home/brian/sandboxApache/tomcat8/trunk/modules/jdbc-pool/build.properties.default\n\n    [javac] warning: [options] bootstrap class path not set in conjunction with -source 1.5\n\n\nI will attach a trivial fix, after which the build completes without the warning.','2012-08-03 11:39:00','Brian Burch','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','51c630f','Filip Hanik','2012-08-06 16:14:13','https://issues.apache.org/bugzilla/show_bug.cgi?id=53649 fix compiler warnings','modules/jdbc-pool/build.properties.default'),(485,53607,'Bug 53607 – No message set for PING: TcpPingInterceptor fail with NullPointerException in ChannelData.getDataPackageLength()','I added \n        data.setMessage(new XByteBuffer(TCP_PING_DATA, false));\n\nto TcpPingInterceptor send ping message function by:\n\n    protected void sendPingMessage(Member[] members) {\n        if ( members == null || members.length == 0 ) return;\n        ChannelData data = new ChannelData(true);//generates a unique Id\n        data.setAddress(getLocalMember(false));\n        data.setTimestamp(System.currentTimeMillis());\n        data.setOptions(getOptionFlag());\n        data.setMessage(new XByteBuffer(TCP_PING_DATA, false));\n        try {\n            super.sendMessage(members, data, null);\n        }catch (ChannelException x) {\n            log.warn(\"Unable to send TCP ping.\",x);\n        }\n    }\n\n\nerror also for Tomcat 6\nregards\nfred','2012-07-26 18:33:54','F.Arnoud','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Cluster','P2 normal','57b56f2','Keiichi Fujino','2012-07-31 04:21:40','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53607. To avoid NPE, set TCP PING data to ChannelMessage.','java/org/apache/catalina/tribes/group/interceptors/TcpPingInterceptor.java'),(486,53606,'Bug 53606 – NullPointerException in TcpPingInterceptor','start(int) method initializes failureDetector (resp. staticMembers) only if TcpFailureDetector (resp. StaticMembershipInterceptor) was found in channel interceptors stack.\n\nWithout TcpFailureDetector (resp. StaticMembershipInterceptor), futur calls to sendPing() will fail because failureDetector (resp. staticMembers) wasn\'t initialized at least to new WeakReference<StaticMembershipInterceptor>(null).\n\nFix:\nv1) initializes weak references containers:\nReplace:\n    WeakReference<TcpFailureDetector> failureDetector = null;\n    WeakReference<StaticMembershipInterceptor> staticMembers = null;\nfor:\n    WeakReference<TcpFailureDetector> failureDetector = new WeakReference<TcpFailureDetector>();\n    WeakReference<StaticMembershipInterceptor> staticMembers = new WeakReference<StaticMembershipInterceptor>();\n\nv2) checks field before dereferencing it:\nsendPing becomes:\n    protected void sendPing() {\n        if (failureDetector!=null && failureDetector.get()!=null) {\n            //we have a reference to the failure detector\n            //piggy back on that dude\n            failureDetector.get().checkMembers(true);\n        }else {\n            if (staticOnly && staticMembers!=null && staticMembers.get()!=null) {\n                sendPingMessage(staticMembers.get().getMembers());\n            } else {\n                sendPingMessage(getMembers());\n            }\n        }\n    }\n\n\n\naffect also tomcat 6\nregards\nfred arnoud','2012-07-26 16:15:05','F.Arnoud','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Cluster','P2 normal','eb9f94e','Mark Emlyn David Thomas','2012-07-29 17:47:24','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53606 Fix possible NPE when sending pings between cluster nodes Based on a patch by F.Arnoud','java/org/apache/catalina/tribes/group/interceptors/TcpPingInterceptor.java'),(487,53535,'Bug 53535 – Out of memory while performing ContextConfig.webConfig','','2012-07-11 10:29:10','Cedomir Igaly','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','7db08d3','Mark Emlyn David Thomas','2012-07-29 17:21:08','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53535 Reduce memory footprint when performing class scanning on Context start. Patch provided by Cedomir Igaly','java/org/apache/catalina/startup/ContextConfig.java'),(488,53469,'Bug 53469 – possible bug in Response.normalize(CharChunk cc)','The Response.normalize(CharChunk cc) introduced in 7.0.28 introduced a bug.\nSee Bug ID 53062\n\nThe URL that is being encoded is:\n../../resources/org.apache.wicket.markup.html.WicketEventReference/wicket-event.js?w:lm=1340711670\nwhich causes a IllegalArgumentException in this method\n\njava.lang.IllegalArgumentException\n	at org.apache.catalina.connector.Response.normalize(Response.java:1799)\n	at org.apache.catalina.connector.Response.toAbsolute(Response.java:1732)\n	at org.apache.catalina.connector.Response.encodeURL(Response.java:1242)\n	at org.apache.catalina.connector.ResponseFacade.encodeURL(ResponseFacade.java:406)\n	at org.apache.wicket.protocol.http.WebResponse.encodeURL(WebResponse.java:149)\n	at org.apache.wicket.protocol.http.request.WebRequestCodingStrategy.encode(WebRequestCodingStrategy.java:387)\n\nRunning the same application in tomcat 7.0.27 and 6.0.18 works without issue','2012-06-26 12:45:09','Thyzz','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 normal','9a80d06','Mark Emlyn David Thomas','2012-07-29 16:29:20','Partial fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=53469 If the relative URL can\'t be made absolute, do not encode it and return it as is','java/org/apache/catalina/connector/Response.java\ntest/org/apache/catalina/connector/TestResponse.java'),(489,53529,'Bug 53529 – Call interrupt() after InterruptedException instead interrupted()','In class:\n\norg\\apache\\catalina\\tribes\\group\\GroupChannel.java\n    line 692\norg\\apache\\catalina\\tribes\\group\\interceptors\\NonBlockingCoordinator.java\n    line 228\norg\\apache\\catalina\\tribes\\group\\interceptors\\TcpPingInterceptor.java\n    line 173\norg\\apache\\catalina\\tribes\\membership\\McastServiceImpl.java\n    line 542\norg\\apache\\juli\\AsyncFileHandler.java\n    line 124\n    line 146\norg\\apache\\tomcat\\util\\net\\AprEndpoint.java\n    line 640\norg\\apache\\tomcat\\util\\net\\NioBlockingSelector.java\n    line 112\n    line 177\norg\\apache\\tomcat\\util\\threads\\ThreadPoolExecutor.java\n    line 187\n\n\nAffect 7.0.29 (and previous release) but affect also Tomcat 6.','2012-07-10 11:27:42','F.Arnoud','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','3ea8285','Mark Emlyn David Thomas','2012-07-27 19:12:55','Fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=53529 Improve the handling of InterruptedException - Provide a specific message if thread was interrupted rather than the wait timing out - Remove unnecessary code - Remove unnecessary attemps to clear the interrupt flag','java/org/apache/catalina/tribes/group/GroupChannel.java\njava/org/apache/catalina/tribes/group/interceptors/NonBlockingCoordinator.java\njava/org/apache/catalina/tribes/group/interceptors/TcpPingInterceptor.java\njava/org/apache/catalina/tribes/membership/McastServiceImpl.java\njava/org/apache/juli/AsyncFileHandler.java\njava/org/apache/tomcat/util/net/AprEndpoint.java\njava/org/apache/tomcat/util/net/NioBlockingSelector.java\njava/org/apache/tomcat/util/threads/ThreadPoolExecutor.java\nwebapps/docs/changelog.xml'),(490,53524,'Bug 53524 – Typo in cluster-howto.html','tomcat-7.0-doc/cluster-howto.html:\n\nIn the section \"Configuration Example\", at the paragraph of \"Membership\", \n\n---\n... be on a separate multicast address/port combination the the production cluster.\n---\n\nThis \"the the\" may be a typo.','2012-07-09 11:48:35','Yusuke OSUMI','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 trivial','982cbf1','Mark Emlyn David Thomas','2012-07-11 18:45:15','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53524 Fix typo','webapps/docs/cluster-howto.xml'),(491,53526,'Bug 53526 – .ConnectionPool.terminateTransaction unsafe == check of Boolean','The method ConnectionPool.terminateTransaction(PooledConnection con) uses == to check the value of a Boolean, viz:\n\nif (con.getPoolProperties().getDefaultAutoCommit()==Boolean.FALSE) {\n\nThis is not 100% safe - if the user sets the property as follows:\n\nString value; // e.g. derived from property file\n...\nsetDefaultAutoCommit(new Boolean(value));\n\nthen the condition will never be true, even if value=\"false\".\n\nAlthough it is better to use Boolean.valueOf(value), which would not have the same problem, the code ought to work regardless.','2012-07-09 20:08:39','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','eac6366','Filip Hanik','2012-07-10 10:47:07','https://issues.apache.org/bugzilla/show_bug.cgi?id=53526 Use proper comparison of objects','modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java'),(492,53523,'Bug 53523 – rollbackOnReturn/commitOnReturn does not work without defaultAutoCommit=false','Hi,\n\nThe properties rollbackOnReturn and commitOnReturn, which are critical for cleaning up connections after they are used and returned to the pool, does not work when the defaultAutoCommit property is not set or when it is set to true. The code segment at ConnectionPool class has this,\n\n   protected boolean terminateTransaction(PooledConnection con) {\n        try {\n            if (con.getPoolProperties().getDefaultAutoCommit()==Boolean.FALSE) {\n            ....\n\nThe full logic is wrapped in that first if statement, and as I see, that is not correct. Because, the actual default auto commit value when we don\'t set this property can either be autoCommit true or false, which depends on the database driver. And also, even when we have a default setting provided, the user has the freedom to change the autoCommit flag to either true or false at the beginning when they get the connection from the pool. So we should not be reading the pool properties in this place, but just check the current live connection\'s autoCommit value and act accordingly. So I suppose the fix should be to simply remove the outer if statement. \n\nCheers,\nAnjana.','2012-07-09 11:21:38','Anjana Fernando','Tomcat Developers Mailing List','RESOLVED WONTFIX','Tomcat Modules','jdbc-pool','P2 critical','f54bb45','Filip Hanik','2012-07-09 15:39:51','fix doc according to https://issues.apache.org/bugzilla/show_bug.cgi?id=53523','modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/PoolConfiguration.java'),(493,53062,'Bug 53062 – Tomcat doesn\'t normalize absolute urls for redirect','','2012-04-11 12:42:29','mgrigorov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 normal','f83120a','Mark Emlyn David Thomas','2012-07-09 15:09:50','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53062 Correctly handle case where redirect URL includes a query string (with test cases)','java/org/apache/catalina/connector/Response.java\ntest/org/apache/catalina/connector/TestResponse.java'),(494,53513,'Bug 53513 – Race condition / out of order operation in session replication at node startup','My configuration:\n\n2 nodes running Tomcat 7.0.26\nUsing a custom session manager, which extends the DeltaManager\n\nMy startInternal() method first calls super.startInternal(), then performs a few additional initializations.\n\nI reviewed the code of DeltaManager.startInternal(), and it calls getAllClusterSessions() which in turn calls waitForSendAllSessions(), which requires either getStateTransfered() to return true, or a timeout.\n\nSo by this, I should be able to trust that as the second node starts, the initial sync up of all session data from the first node has completed prior to the startInternal() method exiting (and thus prior to my initializations).\n\nThis is, however, not the case!  I can confirm this by repeatedly logging the value of findSessions().length during my inializations, and see that number going up!\n\nThere appears to be a race condition between the processing of the message containing the actual session data & the \"transfer complete\" message.  After tracing this through a little further, I see the stateTransfered is set to true in the handleALL_SESSION_TRANSFERCOMPLETE() callback method.  And that callback is being called PRIOR to the session data itself even being received!\n\nHere is the debug logging output (slightly scrubbed) which shows this out of order messaging:\n\nJul 5, 2012 4:20:41 PM org.apache.catalina.ha.session.DeltaManager getAllClusterSessions\nINFO: Manager [wwwtest#], requesting session state from org.apache.catalina.tribes.membership.MemberImpl[...].\nThis operation will timeout if no session state has been received within 60 seconds.\n\nJul 5, 2012 4:20:41 PM org.apache.catalina.ha.session.DeltaManager messageReceived\nFINE: Manager [wwwtest#]: Received SessionMessage of type=(SESSION-STATE-TRANSFERED) from [org.apache.catalina.tribes.membership.MemberImpl[...]\n\nJul 5, 2012 4:20:41 PM org.apache.catalina.ha.session.DeltaManager handleALL_SESSION_TRANSFERCOMPLETE\nFINE: Manager [wwwtest#] received from node [[B@6789b939:4,000] session state transfered.\n\nJul 5, 2012 4:20:41 PM org.apache.catalina.ha.session.DeltaManager messageReceived\nFINE: Manager [wwwtest#]: Received SessionMessage of type=(ALL-SESSION-DATA) from [org.apache.catalina.tribes.membership.MemberImpl[...]\n\nJul 5, 2012 4:20:41 PM org.apache.catalina.ha.session.DeltaManager handleALL_SESSION_DATA\nFINE: Manager [wwwtest#]: received session state data','2012-07-05 21:56:22','David Johle','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Cluster','P2 major','4c03dff','Keiichi Fujino','2012-07-09 06:43:30','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53513. Fix race condition between the processing of session sync message and transfer complete message.','java/org/apache/catalina/ha/tcp/SimpleTcpCluster.java'),(495,53498,'Bug 53498 – Atomicity violation bugs because of misusing concurrent collections','','2012-07-02 21:19:45','Yu Lin','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','4aef8e3','Mark Emlyn David Thomas','2012-07-04 17:03:46','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53498 Fix atomicity bugs in use of concurrent collections. Based on a patch by Yu Lin.','java/org/apache/catalina/core/ApplicationContext.java\njava/org/apache/catalina/ha/context/ReplicatedContext.java'),(496,53505,'Bug 53505 – Documentation specifies to use old JSTL version','','2012-07-04 03:27:34','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 minor','29d01b7','Mark Emlyn David Thomas','2012-07-04 16:53:06','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53505 Update JSTL version info','webapps/docs/jndi-datasource-examples-howto.xml'),(497,45995,'Bug 45995 – RFE - MIME type extension not case sensitive','Hi,\n\nOn the dev-tomcat list I described in the topic \"Byte Serving and PDFs with the DefaultServlet\" an issue that I had with Tomcat to serve PDFs.\n\nAnalysing the answers I could find that the matter was related to the case of the file extension. Today Tomcat is case sensitive for MIME type extensions.\n\nSo the solution for me was enter two MIME specifications on the web.xml file. One is for \"pdf\" and another one for \"PDF\".\n\nThis way I would like to ask for and request for enhancement to make Tomcat be able to, due a setup on configuration file, consider or not case for MIME type extensions.\n\nRegards,\n\nVitor','2008-10-13 04:32:38','Vitor Swaid','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P5 enhancement','f8e173b','Mark Emlyn David Thomas','2012-07-02 05:41:23','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45995 Align Tomcat with Apache httpd and perform MIME type mapping based on file extension in a case insensitive manner.','conf/web.xml\njava/org/apache/catalina/core/StandardContext.java\nwebapps/docs/changelog.xml'),(498,52135,'Bug 52135 – Global error page is not handled','The new Servlet 3.0 global error page\n\n    <error-page>\n        <location>/error.jsp</location>\n    </error-page>\n\nis not handled in Tomcat 7.\n\nOn Glassfish 3 for example, it works fine.','2011-11-04 14:15:58','balusc','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 enhancement','6213b38','Mark Emlyn David Thomas','2012-06-30 09:06:27','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52135 Implement support for a default error page. It appears that this was meant to be in the 3.0 spec but got left out in error.','java/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/core/StandardHostValve.java\njava/org/apache/catalina/deploy/ErrorPage.java\ntest/org/apache/catalina/core/TestStandardHostValve.java'),(499,53454,'Bug 53454 – Default doHead implementation overrides \'Content-Length\' header','','2012-06-22 15:33:22','Nikita Skvortsov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Servlet & JSP API','P2 normal','ad5fad1','Mark Emlyn David Thomas','2012-06-28 04:26:50','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53454 Additional ways content length may be set','java/javax/servlet/http/HttpServlet.java'),(500,53454,'Bug 53454 – Default doHead implementation overrides \'Content-Length\' header','','2012-06-22 15:33:22','Nikita Skvortsov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Servlet & JSP API','P2 normal','fea60be','Mark Emlyn David Thomas','2012-06-28 03:55:13','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53454 Return correct content-length header for HEAD requests when value is > 2GB','java/javax/servlet/http/HttpServlet.java\ntest/javax/servlet/http/TestHttpServlet.java\ntest/org/apache/catalina/startup/TomcatBaseTest.java'),(501,53473,'Bug 53473 – Error in isVirtualWebappRelative param configuration','The docs for the \'isVirtualWebappRelative\' param configuration state that \'0\' or \'1\' is the accepted setting:\n\nweb.xml and ssi-howto:\n<!--   isVirtualWebappRelative                                            -->\n<!--                       Should \"virtual\" paths be interpreted as       -->\n<!--                       relative to the context root, instead of       -->\n<!--                       the server root?  (0=false, 1=true) [0]        -->\n\nbut the code that reads the parameter is:\n\norg/apache/catalina/ssi/SSIServlet.java: \nisVirtualWebappRelative = Boolean.parseBoolean(config.getInitParameter(\"isVirtualWebappRelative\"));\n\n\norg/apache/catalina/ssi/SSIFilter.java:\nisVirtualWebappRelative = Boolean.parseBoolean(getServletConfig().getInitParameter(\"isVirtualWebappRelative\"));\n\nAs of that code, the only working configuration to set the \'isVirtualWebappRelative\' to true is:\n\n<init-param>\n          <param-name>isVirtualWebappRelative</param-name>\n          <param-value>true</param-value>\n</init-param>\n\nand not\n\n<init-param>\n          <param-name>isVirtualWebappRelative</param-name>\n          <param-value>1</param-value>\n</init-param>','2012-06-27 08:35:42','Giorgio Giudetti','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 minor','41bade3','Mark Emlyn David Thomas','2012-06-27 15:37:19','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53473 Correct documentation and web.xml comments for SSI isVirtualWebappRelative option since the allowed values are true or false','conf/web.xml\nwebapps/docs/ssi-howto.xml'),(502,53467,'Bug 53467 – 7.0.28 will no longer accept our jsp filenames','','2012-06-25 21:56:46','Nate Carlson','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','4de4325','Mark Emlyn David Thomas','2012-06-27 14:50:50','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53467 Use more explicit URI constructor to ensure components are correctly encoded.','java/org/apache/catalina/core/ApplicationContext.java\ntest/org/apache/catalina/core/TestApplicationContext.java\ntest/webapp-3.0/bug53467].jsp'),(503,53416,'Bug 53416 – Two datasources with the same name in different web applications results in javax.management.InstanceAlreadyExistsException','Deploy two different web applications onto Tomcat.\n\nEach web application has a resource that:\n\n* uses the Use Tomcat JDBC Connection Pool\n* has an identical name to the other one\n\n<Resource name=\"jdbc/collision\" factory=\"org.apache.tomcat.jdbc.pool.DataSourceFactory\" ... />\n\nWhen starting the server you get a non fatal error in the logs InstanceAlreadyExistsException.  Both applications appear to still work OK\n\nERROR org.apache.tomcat.jdbc.pool.DataSource - Unable to register JDBC pool with JMX\njavax.management.InstanceAlreadyExistsException: tomcat.jdbc:name=\"jdbc/soscvuk\",context=/,type=ConnectionPool,host=localhost,class=org.apache.tomcat.jdbc.pool.\nDataSource\n	at com.sun.jmx.mbeanserver.Repository.addMBean(Repository.java:453) ~[na:1.6.0_32]\n	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.internal_addObject(DefaultMBeanServerInterceptor.java:1484) [na:1.6.0_32]\n	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.registerDynamicMBean(DefaultMBeanServerInterceptor.java:963) [na:1.6.0_32]\n	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.registerObject(DefaultMBeanServerInterceptor.java:917) [na:1.6.0_32]\n	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.registerMBean(DefaultMBeanServerInterceptor.java:312) [na:1.6.0_32]\n	at com.sun.jmx.mbeanserver.JmxMBeanServer.registerMBean(JmxMBeanServer.java:482) [na:1.6.0_32]\n	at org.apache.tomcat.jdbc.pool.DataSource.registerJmx(DataSource.java:135) [tomcat-jdbc.jar:na]\n	at org.apache.tomcat.jdbc.pool.DataSource.preRegister(DataSource.java:102) [tomcat-jdbc.jar:na]\n	at org.apache.tomcat.util.modeler.BaseModelMBean.preRegister(BaseModelMBean.java:1132) [tomcat-coyote.jar:7.0.27]\n	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.preRegisterInvoke(DefaultMBeanServerInterceptor.java:1010) [na:1.6.0_32]\n	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.registerDynamicMBean(DefaultMBeanServerInterceptor.java:938) [na:1.6.0_32]\n	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.registerObject(DefaultMBeanServerInterceptor.java:917) [na:1.6.0_32]\n	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.registerMBean(DefaultMBeanServerInterceptor.java:312) [na:1.6.0_32]\n	at com.sun.jmx.mbeanserver.JmxMBeanServer.registerMBean(JmxMBeanServer.java:482) [na:1.6.0_32]\n	at org.apache.tomcat.util.modeler.Registry.registerComponent(Registry.java:742) [tomcat-coyote.jar:7.0.27]\n	at org.apache.catalina.core.NamingContextListener.addResource(NamingContextListener.java:1062) [catalina.jar:7.0.27]\n	at org.apache.catalina.core.NamingContextListener.createNamingContext(NamingContextListener.java:671) [catalina.jar:7.0.27]\n	at org.apache.catalina.core.NamingContextListener.lifecycleEvent(NamingContextListener.java:270) [catalina.jar:7.0.27]\n	at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119) [catalina.jar:7.0.27]\n	at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90) [catalina.jar:7.0.27]\n	at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5161) [catalina.jar:7.0.27]\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150) [catalina.jar:7.0.27]\n	at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:895) [catalina.jar:7.0.27]\n	at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:871) [catalina.jar:7.0.27]\n	at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:615) [catalina.jar:7.0.27]\n	at org.apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.java:649) [catalina.jar:7.0.27]\n	at org.apache.catalina.startup.HostConfig$DeployDescriptor.run(HostConfig.java:1585) [catalina.jar:7.0.27]\n	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441) [na:1.6.0_32]\n	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303) [na:1.6.0_32]\n	at java.util.concurrent.FutureTask.run(FutureTask.java:138) [na:1.6.0_32]\n	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) [na:1.6.0_32]\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) [na:1.6.0_32]\n	at java.lang.Thread.run(Thread.java:662) [na:1.6.0_32]','2012-06-14 13:37:06','Anthony Gerrard','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','ff9a272','Filip Hanik','2012-06-27 13:36:05','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53416 Make sure we retain the domain if the registration comes from Tomcat','modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/DataSource.java'),(504,53465,'Bug 53465 – mapped-name is read when in @Resource, but not when in web.xml','','2012-06-25 20:31:48','Violeta Georgieva','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','7ecd402','Mark Emlyn David Thomas','2012-06-26 18:02:04','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53465 Populate mapped-name property for resources defined in web.xml Based on a patch by Violeta Georgieva','java/org/apache/catalina/startup/WebRuleSet.java\ntest/org/apache/naming/resources/TestNamingContext.java\ntest/webapp-3.0/WEB-INF/web.xml'),(505,53460,'Bug 53460 – Use error handling when TooManyActiveSessionsException happens in JSP','','2012-06-23 14:02:41','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','294c52b','Mark Emlyn David Thomas','2012-06-26 15:57:07','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53460 There are two parts to this fix: - don\'t swallow exceptions when the PageContext can\'t be created - if the PageContext is null when an error occurs (and therefore can\'t be used to handle the error) propagate the exception wrapped in a ServletException and let the container handle it. Note: This is the version of the fix for back-porting to 7.0.x. There is some obvious but API changing clean-up that can simplify this in trunk.','java/org/apache/jasper/compiler/Generator.java\njava/org/apache/jasper/runtime/JspFactoryImpl.java'),(506,53445,'Bug 53445 – Support consistent Jmx object naming strategy across managed resources','Tomcat JDBC Pool Versions tested: 7.0.27 & 7.0.28\nMore of an inquiry.  Let me preface by saying we have recently adopted this pool and are very pleased so far.\n\nCurrently, Jmx managed resources like ConnectionPool and SlowQueryReportJmx are registered under the same domain (i.e. tomcat.jdbc).  Some users may want to employ an alternate object naming strategy.  With DataSource#createObjectName it is relatively easy to change the ConnectionPool ObjectName (i.e. subclass).  However, with SlowQueryReportJmx, due to a static getObjectName method, it requires overriding additional methods which is less desirable.\nIt appears that ConnectionPool has a constant POOL_JMX_TYPE_PREFIX.  SlowQueryReportJmx appears to use this but DataSource does not? \n\nIs there any reason that the SlowQueryReportJmx#getObjectName method is static?\nWhat about registering an object naming strategy with the pool that the various components would use, facilitating consistency?  This would mitigate the need to override just to alter the ObjectName.\n\nReference: Spring MBean exporters and their ObjectNamingStrategy interface.\n\nThanks.','2012-06-20 19:20:53','Alex Franken','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 enhancement','4e010fc','Filip Hanik','2012-06-26 15:08:27','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53445 by allowing  a) override the getObjectName method of the SlowQueryReportJmx class  b) specify the objectName=xxx attribute in the configuration','modules/jdbc-pool/doc/jdbc-pool.xml\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/DataSource.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/interceptor/SlowQueryReportJmx.java\nmodules/jdbc-pool/src/test/java/org/apache/tomcat/jdbc/test/TestSlowQueryReport.java'),(507,53464,'Bug 53464 – Tomcat installation instructions reference init.d file that does not exist / document init.d','','2012-06-25 11:10:51','Anthony Gerrard','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 normal','a8e251e','Mark Emlyn David Thomas','2012-06-26 15:02:55','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53464 Correct file location (it was moved from Commons Daemon to bin/)','webapps/docs/setup.xml'),(508,53459,'Bug 53459 – clientAuth=\"optional\" not documented - is it valid?','The file ssl-howto.xml includes the line\n\n  clientAuth=\"optional\" SSLProtocol=\"TLSv1\"/&gt;\n\nHowever, the corresponding description of the clientAuth parameter in config/http.xml does not mention \"optional\" as a possible parameter value, only \"true\", \"false\", \"want\".\n\nThe code in util.net.jsse.JSSESocketFactory only checks for\n\n\"true\", \"yes\" and \"want\"; AFAICT everthing else is treated as \"false\".\n\nIt looks like the entry in ssl-howto.xml is wrong.\n\nAlso, perhaps the description in http.xml should include \"yes\" as an alias for \"true\".','2012-06-23 13:55:53','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 normal','2d4cd34','Mark Emlyn David Thomas','2012-06-25 15:27:52','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53459 Fix SSLVerifyClient option in APR SSL example and further clarify how to modify server.xml based on the desired connector implementation.','webapps/docs/ssl-howto.xml'),(509,53456,'Bug 53456 – Minor tweaks to config/http.html','','2012-06-22 17:47:25','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 normal','9feda83','Mark Emlyn David Thomas','2012-06-25 10:41:36','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53456 Minor fixes to the HTTP docs. Patch provided by sebb.','webapps/docs/config/http.xml'),(510,53430,'Bug 53430 – JVM crash at startup if TC-Native version is too old','','2012-06-17 10:16:07','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 normal','553259c','Mark Emlyn David Thomas','2012-06-25 08:53:27','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53430 Fix problems with missing / wrong version of APR/native library when APR connector is explicitly configured. Protocol now declares if it needs the library and the connector ensures it is available if required.','java/org/apache/catalina/connector/Connector.java\njava/org/apache/catalina/connector/LocalStrings.properties\njava/org/apache/coyote/AbstractProtocol.java\njava/org/apache/coyote/ProtocolHandler.java\njava/org/apache/coyote/ajp/AjpAprProtocol.java\njava/org/apache/coyote/http11/Http11AprProtocol.java'),(511,53421,'Bug 53421 – BeanELResolver\'s inner class BeanProperty throws incorrect message while PropertyNotFound','BeanELResolver\'s inner class BeanProperty(line: 264) has two methods (write, read) that will throw PropertyNotFoundException. And there current implementation are wrong:\n\n  throw new PropertyNotFoundException(message(ctx,\n                            \"propertyNotWritable\", new Object[] {\n                                    type.getName(), descriptor.getName() }));\n\nit should use owner.getName() instead of type.getName() because the assembled message will be:\n\nProperty \'[descriptor.getName()]\' not readable on type [type.getName()]\n\nHere the descriptor.getName() means the property name, type.getName() means the property type\'s name and the owner.getName() means the property owner - bean\'s type name.\n\nOf course we developer would prefer to receive a message that tells us which bean type doesn\'t contain such property because this is a PropertyNotFoundException.','2012-06-15 13:54:17','Ian YT Tsai','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','8a13b39','Mark Emlyn David Thomas','2012-06-23 09:17:06','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53421 Provide more useful error message when bean property getter/setter cannot be found.','java/javax/el/BeanELResolver.java\ntest/javax/el/TestBeanELResolver.java'),(512,53450,'Bug 53450 – Deployment of an application with \'ROOT\' context hangs forever','Hi,\n\nThe scenario is the following:\n- I have running Tomcat 7.0.28\n- I deploy an application with \'ROOT\' context\n- The deployment hangs forever. When taking a tread dump, the following is suspicious:\n\n\"localhost-startStop-2\" daemon prio=6 tid=0x0000000006607800 nid=0x2560 waiting on condition [0x0000000009ebf000]\n   java.lang.Thread.State: WAITING (parking)\n        at sun.misc.Unsafe.park(Native Method)\n        - parking to wait for  <0x00000007d80f0108> (a java.util.concurrent.locks.ReentrantReadWriteLock$NonfairSync)\n        at java.util.concurrent.locks.LockSupport.park(LockSupport.java:158)\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(AbstractQueuedSynchronizer.java:811)\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireQueued(AbstractQueuedSynchronizer.java:842)\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquire(AbstractQueuedSynchronizer.java:1178)\n        at java.util.concurrent.locks.ReentrantReadWriteLock$WriteLock.lock(ReentrantReadWriteLock.java:807)\n        at org.apache.catalina.core.ContainerBase.removeContainerListener(ContainerBase.java:1071)\n        at org.apache.catalina.core.StandardEngine$AccessLogListener.uninstall(StandardEngine.java:463)\n        at org.apache.catalina.core.StandardEngine$AccessLogListener.containerEvent(StandardEngine.java:505)\n        at org.apache.catalina.core.ContainerBase.fireContainerEvent(ContainerBase.java:1431)\n        at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:907)\n        at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:875)\n        at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:618)\n        at org.apache.catalina.startup.HostConfig.deployDirectory(HostConfig.java:1100)\n        at org.apache.catalina.startup.HostConfig$DeployDirectory.run(HostConfig.java:1618)\n        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)\n        at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)\n        at java.util.concurrent.FutureTask.run(FutureTask.java:138)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n        at java.lang.Thread.run(Thread.java:662)\n\n\n\nAs you can see\n- A read lock is acquired at org.apache.catalina.core.ContainerBase.fireContainerEvent(ContainerBase.java:1425)\n- Then every listener is invoked to process the container event\n- Then AccessLogListener is invoked org.apache.catalina.core.StandardEngine$AccessLogListener.uninstall(StandardEngine.java:463)\n- The latter causes a call for a write lock org.apache.catalina.core.ContainerBase.removeContainerListener(ContainerBase.java:1071)\n- Unfortunately in the ReentrantReadWriteLock it is stated that upgrade from read to write lock is not possible\n\"Reentrancy also allows downgrading from the write lock to a read lock, by acquiring the write lock, then the read lock and then releasing the write lock. However, upgrading from a read lock to the write lock is not possible.\"\n\nRegards\nVioleta Georgieva','2012-06-21 18:22:10','Violeta Georgieva','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','91a13d2','Mark Emlyn David Thomas','2012-06-21 15:55:06','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53450 Correct regression in fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=52999 that was likely to cause a deadlock when deploying a ROOT web application.','java/org/apache/catalina/core/ContainerBase.java'),(513,52999,'Bug 52999 – Performance issue with locking in ContainerBase.fireContainerEvent()','','2012-03-28 21:31:42','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','91a13d2','Mark Emlyn David Thomas','2012-06-21 15:55:06','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53450 Correct regression in fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=52999 that was likely to cause a deadlock when deploying a ROOT web application.','java/org/apache/catalina/core/ContainerBase.java'),(514,50306,'Bug 50306 – Detect stuck threads','Feature request : \nregularly scan worker threads and if one has been processing the same request for longer than a configurable delay, log a warning with the stack trace of that thread.\nThis would allow to detect very long running threads, usually the ones that are stuck in a network call or in a deadlock.','2010-11-19 18:09:10','Sylvain Laurent','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','caa39e1','Konstantin Kolinko','2012-06-20 04:44:31','For https://issues.apache.org/bugzilla/show_bug.cgi?id=50306 Followup to r1351991: Update Spanish LocalStrings file as well.','java/org/apache/catalina/valves/LocalStrings_es.properties'),(515,50306,'Bug 50306 – Detect stuck threads','Feature request : \nregularly scan worker threads and if one has been processing the same request for longer than a configurable delay, log a warning with the stack trace of that thread.\nThis would allow to detect very long running threads, usually the ones that are stuck in a network call or in a deadlock.','2010-11-19 18:09:10','Sylvain Laurent','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','0f3dee4','Konstantin Kolinko','2012-06-20 04:36:07','For https://issues.apache.org/bugzilla/show_bug.cgi?id=50306 Improve StuckThreadDetectionValve: - Add getStuckThreadNames() method, callable through JMX - Add thread ids to the log messages','java/org/apache/catalina/valves/LocalStrings.properties\njava/org/apache/catalina/valves/StuckThreadDetectionValve.java\njava/org/apache/catalina/valves/mbeans-descriptors.xml\nwebapps/docs/config/valve.xml'),(516,53173,'Bug 53173 – maxConnections feature hangs the system','','2012-05-01 13:54:22','Filip Hanik','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 normal','aabc238','Mark Emlyn David Thomas','2012-06-13 14:29:07','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53173 Remove some duplicate calls to countDownConnection() While the connector is running, destroySocket() will call countDownConnection() Once the connector is stopped, the latch is removed so it does not matter that destroySocket() does not call countDownConnection() in that case','java/org/apache/tomcat/util/net/AprEndpoint.java'),(517,53406,'Bug 53406 – Stack overflow in connector','found against trunk on Jun 18, 2012\n\nSEVERE:\njava.lang.StackOverflowError\n        at org.apache.catalina.core.StandardContextValve.event(StandardContextValve.java:128)\n        at org.apache.catalina.valves.ValveBase.event(ValveBase.java:204)\n        at org.apache.catalina.core.StandardHostValve.event(StandardHostValve.java:223)\n        at org.apache.catalina.valves.ValveBase.event(ValveBase.java:204)\n        at org.apache.catalina.valves.ValveBase.event(ValveBase.java:204)\n        at org.apache.catalina.core.StandardEngineValve.event(StandardEngineValve.java:110)\n        at org.apache.catalina.connector.CoyoteAdapter.event(CoyoteAdapter.java:209)\n        at org.apache.coyote.http11.Http11NioProcessor.event(Http11NioProcessor.java:124)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:569)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1653)\n        at org.apache.tomcat.util.net.NioEndpoint.processSocket(NioEndpoint.java:730)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:1008)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:999)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.longPoll(Http11NioProtocol.java:277)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:596)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1653)\n        at org.apache.tomcat.util.net.NioEndpoint.processSocket(NioEndpoint.java:730)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:1008)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:999)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.longPoll(Http11NioProtocol.java:277)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:596)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1653)\n        at org.apache.tomcat.util.net.NioEndpoint.processSocket(NioEndpoint.java:730)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:1008)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:999)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.longPoll(Http11NioProtocol.java:277)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:596)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1653)\n        at org.apache.tomcat.util.net.NioEndpoint.processSocket(NioEndpoint.java:730)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:1008)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:999)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.longPoll(Http11NioProtocol.java:277)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:596)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1653)\n        at org.apache.tomcat.util.net.NioEndpoint.processSocket(NioEndpoint.java:730)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:1008)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:999)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.longPoll(Http11NioProtocol.java:277)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:596)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1653)\n        at org.apache.tomcat.util.net.NioEndpoint.processSocket(NioEndpoint.java:730)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:1008)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:999)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.longPoll(Http11NioProtocol.java:277)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:596)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1653)\n        at org.apache.tomcat.util.net.NioEndpoint.processSocket(NioEndpoint.java:730)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:1008)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:999)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.longPoll(Http11NioProtocol.java:277)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:596)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1653)\n        at org.apache.tomcat.util.net.NioEndpoint.processSocket(NioEndpoint.java:730)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:1008)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:999)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.longPoll(Http11NioProtocol.java:277)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:596)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1653)\n        at org.apache.tomcat.util.net.NioEndpoint.processSocket(NioEndpoint.java:730)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:1008)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:999)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.longPoll(Http11NioProtocol.java:277)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:596)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1653)\n        at org.apache.tomcat.util.net.NioEndpoint.processSocket(NioEndpoint.java:730)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:1008)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:999)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.longPoll(Http11NioProtocol.java:277)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:596)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1653)\n        at org.apache.tomcat.util.net.NioEndpoint.processSocket(NioEndpoint.java:730)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:1008)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:999)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.longPoll(Http11NioProtocol.java:277)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:596)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1653)\n        at org.apache.tomcat.util.net.NioEndpoint.processSocket(NioEndpoint.java:730)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:1008)\n        at org.apache.tomcat.util.net.NioEndpoint$Poller.add(NioEndpoint.java:999)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.longPoll(Http11NioProtocol.java:277)\n        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:596)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:223)','2012-06-13 03:51:40','Filip Hanik','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 normal','ce24a10','Mark Emlyn David Thomas','2012-06-13 11:46:30','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53406 Fix possible stack overflow on connection close when using Comet (fhanik)','java/org/apache/coyote/http11/Http11AprProcessor.java\njava/org/apache/coyote/http11/Http11NioProcessor.java'),(518,53403,'Bug 53403 – Reference to 2.2/2.3 servlet container in Tomcat 7 docs','','2012-06-12 15:59:07','Anthony Gerrard','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 trivial','a2fc874','Mark Emlyn David Thomas','2012-06-13 10:47:14','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53403 Correct specification version reference to include new specification versions','webapps/docs/appdev/deployment.xml'),(519,50182,'Bug 50182 – Contributing back enhancements to CompressionFilter','','2010-10-29 15:45:38','David Becker','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Examples','P2 enhancement','ddf4651','Konstantin Kolinko','2012-06-12 17:19:50','For https://issues.apache.org/bugzilla/show_bug.cgi?id=50182 Review of r1349477: use more simple code when converting a list of mime types into array and ignore empty strings.','webapps/examples/WEB-INF/classes/compressionFilters/CompressionFilter.java'),(520,50182,'Bug 50182 – Contributing back enhancements to CompressionFilter','','2010-10-29 15:45:38','David Becker','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Examples','P2 enhancement','a07eb6c','Mark Emlyn David Thomas','2012-06-12 14:57:00','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50182 Various improvements to the compression filter example. Patch by David Becker','webapps/examples/WEB-INF/classes/compressionFilters/CompressionFilter.java\nwebapps/examples/WEB-INF/classes/compressionFilters/CompressionFilterTestServlet.java\nwebapps/examples/WEB-INF/classes/compressionFilters/CompressionResponseStream.java\nwebapps/examples/WEB-INF/classes/compressionFilters/CompressionServletResponseWrapper.java\nwebapps/examples/WEB-INF/web.xml'),(521,52954,'Bug 52954 – Allowing for broken android HTTP DIGEST support','','2012-03-21 06:53:16','Neale Rudd','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','bf41254','Mark Emlyn David Thomas','2012-06-12 09:23:53','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52954 Be tolerant of slightly broken Android implementation of DIGEST auth. Security is not impacted.','java/org/apache/catalina/authenticator/DigestAuthenticator.java'),(522,52999,'Bug 52999 – Performance issue with locking in ContainerBase.fireContainerEvent()','','2012-03-28 21:31:42','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','1f340e3','Mark Emlyn David Thomas','2012-06-12 08:38:20','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52999 Remove synchronization bottleneck in container event handling','java/org/apache/catalina/core/ContainerBase.java'),(523,48870,'Bug 48870 – avoid parallel arrays of base types','','2010-03-08 06:55:57','Ralf Hauser','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P4 enhancement','919d42e','Mark Emlyn David Thomas','2012-06-12 08:01:21','Refactoring has been completed in fix for BZ 48870','res/findbugs/filter-post-7.0.x-fixes.xml'),(524,53266,'Bug 53266 – ServletContainerInitializer will crash catalina if dependcy is not present.','When using a ServletContainerInitializer with a HandlesTypes annotation if any of the classes specified in the HandlesTypes annotation are not available due to a missing jar file catalina will crash with a \"java.lang.ArrayStoreException: sun.reflect.annotation.TypeNotPresentExceptionProxy\".\n\nCaused by: java.lang.ArrayStoreException: sun.reflect.annotation.TypeNotPresentExceptionProxy\n	at sun.reflect.annotation.AnnotationParser.parseClassArray(AnnotationParser.java:653)\n	at sun.reflect.annotation.AnnotationParser.parseArray(AnnotationParser.java:460)\n	at sun.reflect.annotation.AnnotationParser.parseMemberValue(AnnotationParser.java:286)\n	at sun.reflect.annotation.AnnotationParser.parseAnnotation(AnnotationParser.java:222)\n	at sun.reflect.annotation.AnnotationParser.parseAnnotations2(AnnotationParser.java:69)\n	at sun.reflect.annotation.AnnotationParser.parseAnnotations(AnnotationParser.java:52)\n	at java.lang.Class.initAnnotationsIfNecessary(Class.java:3070)\n	at java.lang.Class.getAnnotation(Class.java:3029)\n	at org.apache.catalina.startup.ContextConfig.processServletContainerInitializers(ContextConfig.java:1546)\n	at org.apache.catalina.startup.ContextConfig.webConfig(ContextConfig.java:1222)\n	at org.apache.catalina.startup.ContextConfig.configureStart(ContextConfig.java:855)\n	at org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:345)\n	at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\n	at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90)\n	at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5161)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)\n	... 7 more\n\nLine where exception is thrown: \"HandlesTypes ht = sci.getClass().getAnnotation(HandlesTypes.class);\"','2012-05-20 14:32:34','Kevin Rose','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','37e8c59','Mark Emlyn David Thomas','2012-06-11 16:57:26','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53266 Handle missing classes defined in @HandlesTypes more gracefully - the specification requires it should not stop the web application from loading','java/org/apache/catalina/startup/ContextConfig.java\njava/org/apache/catalina/startup/LocalStrings.properties'),(525,53398,'Bug 53398 – Incorrect tag on XML response when calling \'manager/status?XML=true\'','','2012-06-11 16:39:14','Albertico','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Manager','P2 normal','2bf1556','Mark Emlyn David Thomas','2012-06-11 16:09:20','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53398 recieved->received','java/org/apache/catalina/manager/StatusTransformer.java\nwebapps/docs/manager-howto.xml\nwebapps/manager/status.xsd'),(526,53391,'Bug 53391 – CometEvent.close() doesn\'t close socket when called from different thread','','2012-06-09 06:02:47','Lawrence Kesteloot','Tomcat Developers Mailing List','RESOLVED INVALID','Tomcat 7','Connectors','P2 normal','31e981d','Mark Emlyn David Thomas','2012-06-11 10:19:19','Additional Comet tests to confirm / deny the behaviour claimed in https://issues.apache.org/bugzilla/show_bug.cgi?id=53391 The bug report is incorrect','test/org/apache/catalina/comet/TestCometProcessor.java'),(527,53071,'Bug 53071 – ErrorReportValve ignores message from throwable','','2012-04-13 09:34:03','Michael Osipov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','aa69db5','Mark Emlyn David Thomas','2012-06-11 05:24:53','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53071 Stepping through the code, light dawns as to what the bug report was getting at. Use the message from the Throwable for the error report if none was specified via sendError()','java/org/apache/catalina/valves/ErrorReportValve.java\ntest/org/apache/catalina/valves/TestErrorReportValve.java'),(528,53071,'Bug 53071 – ErrorReportValve ignores message from throwable','','2012-04-13 09:34:03','Michael Osipov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','f200788','Mark Emlyn David Thomas','2012-06-11 04:50:42','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53071 Add a test case that confirms this issue does not occur in trunk','test/org/apache/catalina/valves/TestErrorReportValve.java'),(529,53047,'Bug 53047 – JDBCRealm allRolesMode=\"authOnly\" still needs role table','When a JDBCRealm is created with the allRolesMode attribute set to \"authOnly\" a role table is still needed even though the documentation states: \"The alternative values are authOnly which means that the user must be authenticated but no check is made for assigned roles\". No check implies no role table needed. Hint: JDBCRealm.hasRole should probably always return true if the allRolesMode is set to \"authOnly\". The current workaround is to create a view over the user table with a fixed role name.','2012-04-08 11:18:56','Dennis Verbeek','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 minor','7fefc08','Mark Emlyn David Thomas','2012-06-09 16:30:44','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53047 If the Realm is configured for an authentication only all roles mode and no role table or column is defined, don\'t populate the Principal\'s roles','java/org/apache/catalina/realm/DataSourceRealm.java\njava/org/apache/catalina/realm/JDBCRealm.java'),(530,52955,'Bug 52955 – Add a ThreadFactory implementation to the ExecutorService used to deploy applications','','2012-03-21 07:55:31','Pid','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','d73c07a','Konstantin Kolinko','2012-06-09 09:11:57','Review of r1345026, comparing it with proposed patch for BZ 52955: Add final modifiers to improve thread safety','java/org/apache/catalina/core/ContainerBase.java'),(531,53374,'Bug 53374 – DataSourceFactory does not support commitOnReturn property','DataSourceFactory does not support commitOnReturn property.\nDataSourceFactory.ALL_PROPERTIES and DataSourceFactory.parsePoolProperties() omit commitOnReturn property.','2012-06-06 20:56:47','Suresh Avadhanula','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','0290e57','Konstantin Kolinko','2012-06-08 09:08:14','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53374 Fix support for the following properties in DataSourceFactory: commitOnReturn rollbackOnReturn useDisposableConnectionFacade logValidationErrors propagateInterruptState','modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/DataSourceFactory.java'),(532,53057,'Bug 53057 – Add OpenSSL version number to INFO log message when initializing','It would be nice to see a message confirming the initialization of OpenSSL including its version number.','2012-04-10 21:35:43','Christopher Schultz','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','6780daf','Konstantin Kolinko','2012-06-07 13:55:38','For https://issues.apache.org/bugzilla/show_bug.cgi?id=53057 Better wording for OpenSSL version number message that was added in r1312006. This is because OpenSSL version number includes name of the library.','java/org/apache/catalina/core/LocalStrings.properties\njava/org/apache/catalina/core/LocalStrings_es.properties'),(533,53373,'Bug 53373 – Allow whitespace around delimiters in <Context> aliases for readability','','2012-06-06 20:01:27','Christopher Schultz','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','cf703d2','Christopher Schultz','2012-06-06 16:05:05','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53373 Trim whitespace from around <Context> aliases delimiters (,=) to improve readability of many aliases.','java/org/apache/naming/resources/BaseDirContext.java\ntest/org/apache/naming/resources/TestNamingContext.java\nwebapps/docs/config/context.xml'),(534,53368,'Bug 53368 – Running with SecurityManager: WebSocket examples need accessClassInPackage permission','','2012-06-06 01:13:06','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','212f112','Mark Emlyn David Thomas','2012-06-06 14:45:50','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53368 Make WebSocket play nicely with a security manager (kkolinko)','conf/catalina.policy'),(535,53366,'Bug 53366 – Running with SecurityManager: protected/index.jsp returns blank page when it is the first page accessed','','2012-06-06 00:51:35','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','0a1123a','Mark Emlyn David Thomas','2012-06-06 14:29:53','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53366 New http header parser needs to be pre-loaded when running under a security manager','java/org/apache/catalina/security/SecurityClassLoad.java'),(536,48097,'Bug 48097 – NoClassDefFoundError on first access of first jsp','','2009-11-01 11:06:06','Amichai','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','d407e23','Konstantin Kolinko','2012-06-06 09:34:54','https://issues.apache.org/bugzilla/show_bug.cgi?id=48097#c7 https://issues.apache.org/bugzilla/show_bug.cgi?id=53366#c1 If _jspService() cannot properly handle an exception because _jspx_page_context initialization failed, write it to the logs instead of silent swallowing.','java/org/apache/jasper/compiler/Generator.java'),(537,53366,'Bug 53366 – Running with SecurityManager: protected/index.jsp returns blank page when it is the first page accessed','','2012-06-06 00:51:35','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','d407e23','Konstantin Kolinko','2012-06-06 09:34:54','https://issues.apache.org/bugzilla/show_bug.cgi?id=48097#c7 https://issues.apache.org/bugzilla/show_bug.cgi?id=53366#c1 If _jspService() cannot properly handle an exception because _jspx_page_context initialization failed, write it to the logs instead of silent swallowing.','java/org/apache/jasper/compiler/Generator.java'),(538,53367,'Bug 53367 – Database failure may cause pool to hang','during the \n con.connect(); \ncall in the method \n\nprotected PooledConnection borrowConnection(long now, PooledConnection con, String username, String password) in ConnectionPool.java\n\nThere is no counting down the size of the pool. This means, if a connection failure happens here, the pool size remains the same. This means that \'size\' will show the pool as full, but in reality the pool is empty','2012-06-06 01:01:10','Filip Hanik','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 critical','1412935','Filip Hanik','2012-06-05 21:02:41','https://issues.apache.org/bugzilla/show_bug.cgi?id=53367 Avoid pool hanging when database fails','modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/PooledConnection.java'),(539,53032,'Bug 53032 – Ant Jasper task fails to run when using XML namespaces; no output; no errors','','2012-04-03 21:41:35','Nick Williams','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','957d33b','Mark Emlyn David Thomas','2012-06-05 18:56:40','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53032 Modify JspC to extend o.a.tools.ant.Task so it works with name spaces The main change is that execute() no longer throws JasperException so it matches the signature for Task.execute(). This required a small change to main()','java/org/apache/jasper/JspC.java'),(540,53230,'Bug 53230 – Allow custom error mapping when Manager\'s maxActiveSessions is exceeded','','2012-05-14 17:09:13','Thomas Rohde','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','ea77dfb','Christopher Schultz','2012-06-05 17:46:21','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53230 Changed exception type thrown when session manager exceeds active session limit.','java/org/apache/catalina/session/ManagerBase.java\njava/org/apache/catalina/session/TooManyActiveSessionsException.java'),(541,53356,'Bug 53356 – Mapping a servlet to the applicatio​n\'s context root results in IAE','','2012-06-04 19:29:25','Violeta Georgieva','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','7e1c6d7','Mark Emlyn David Thomas','2012-06-05 16:56:27','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53356 Additional fix. Correct context & servlet paths','java/org/apache/tomcat/util/http/mapper/Mapper.java\ntest/org/apache/tomcat/util/http/mapper/TestMapperContextRoot.java'),(542,53356,'Bug 53356 – Mapping a servlet to the applicatio​n\'s context root results in IAE','','2012-06-04 19:29:25','Violeta Georgieva','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','6a870a2','Mark Emlyn David Thomas','2012-06-05 14:17:58','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53356 Add support for an explicit mapping of a servlet to the context root','java/org/apache/catalina/core/StandardContext.java\njava/org/apache/tomcat/util/http/mapper/Mapper.java\ntest/org/apache/tomcat/util/http/mapper/TestMapperContextRoot.java'),(543,53119,'Bug 53119 – java.nio.BufferOverflowException in AjpAprProcessor.output() when AJP client disconnects','','2012-04-21 11:51:17','Konstantin Preißer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 minor','a707357','Konstantin Kolinko','2012-06-05 08:13:07','For https://issues.apache.org/bugzilla/show_bug.cgi?id=53119 Port r1344253 to AjpNioProcessor','java/org/apache/coyote/ajp/AjpNioProcessor.java'),(544,53333,'Bug 53333 – NPE is thrown for env-entry without env-entry-type but with injection-target specified','','2012-05-30 19:28:00','Violeta Georgieva','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','5cb3eb2','Mark Emlyn David Thomas','2012-06-04 15:38:00','Rework fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=53333','java/org/apache/catalina/deploy/NamingResources.java'),(545,53354,'Bug 53354 – <filter-mapping> doesn\'t find the @WebFilter(filterName)','As it\'s not possible to specify the invocation order in a @WebFilter, users are forced to explicitly specify <filter-mapping> in web.xml. This works in combination with a @WebFilter(filterName) in Glassfish and JBoss AS as follows:\n\n@WebFilter(filterName=\"filter1\")\npublic class Filter1 implements Filter {}\n\n@WebFilter(filterName=\"filter2\")\npublic class Filter2 implements Filter {}\n\nwith\n\n<filter-mapping>\n    <filter-name>filter1</filter-name>\n    <url-pattern>/url1/*</url-pattern>\n</filter-mapping>\n<filter-mapping>\n    <filter-name>filter2</filter-name>\n    <url-pattern>/url2/*</url-pattern>\n</filter-mapping>\n\nHowever it fails in Tomcat 7.0.27 with the following confusing exception (the <url-pattern> *is* been set)\n\nCaused by: java.lang.IllegalArgumentException: Filter mapping must specify either a <url-pattern> or a <servlet-name>\n	at org.apache.catalina.core.StandardContext.validateFilterMap(StandardContext.java:3009)\n	at org.apache.catalina.core.StandardContext.addFilterMap(StandardContext.java:2968)\n	at org.apache.catalina.deploy.WebXml.configureContext(WebXml.java:1207)\n	at org.apache.catalina.startup.ContextConfig.webConfig(ContextConfig.java:1294)\n	at org.apache.catalina.startup.ContextConfig.configureStart(ContextConfig.java:855)\n	at org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:345)\n	at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\n	at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90)\n	at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5161)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)\n	... 7 more','2012-06-03 19:16:25','balusc','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 normal','b82c47e','Mark Emlyn David Thomas','2012-06-03 17:16:25','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53354 Don\'t add empty filter mappings to the set of mappings - they\'ll fail validation','java/org/apache/catalina/startup/ContextConfig.java'),(546,53353,'Bug 53353 – Malformed contentType attribute results in two charset values','','2012-06-03 17:55:37','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','060fe08','Mark Emlyn David Thomas','2012-06-03 16:03:30','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53353 Additional fix','java/org/apache/tomcat/util/http/parser/AstMediaType.java'),(547,53353,'Bug 53353 – Malformed contentType attribute results in two charset values','','2012-06-03 17:55:37','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','bc9cd75','Mark Emlyn David Thomas','2012-06-03 15:55:33','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53353 Make the HTTP header parser for ContentType tolerant of invalid parameters with names but no values. The invalid parameters are available in the collection of output nodes but skipped by the various toString() methods.','java/org/apache/tomcat/util/http/parser/AstMediaType.java\njava/org/apache/tomcat/util/http/parser/AstParameter.java\njava/org/apache/tomcat/util/http/parser/HttpParser.java\njava/org/apache/tomcat/util/http/parser/HttpParser.jjt\ntest/org/apache/tomcat/util/http/parser/TestMediaType.java'),(548,53339,'Bug 53339 – ClassNotFoundException when using WebSocketServlet','I\'m trying to do a JNDI lookup inside the \"onOpen\" method of my StreamInbound class, but it gives me the exception below.  The code works if I move my JNP JARs to the server lib instead of the webapp lib.  The code also works fine from anywhere else, like in the \"doGet\" method.\n\n\nERROR http-bio-8080-exec-3 Test \njavax.naming.NoInitialContextException: Cannot instantiate class: org.jnp.interfaces.NamingContextFactory [Root exception is java.lang.ClassNotFoundException: org.jnp.interfaces.NamingContextFactory]\n	at javax.naming.spi.NamingManager.getInitialContext(NamingManager.java:657)\n	at javax.naming.InitialContext.getDefaultInitCtx(InitialContext.java:288)\n	at javax.naming.InitialContext.init(InitialContext.java:223)\n	at javax.naming.InitialContext.<init>(InitialContext.java:197)\n	at Test$TestStreamInbound.onOpen(Test.java:103)\n	at org.apache.catalina.websocket.StreamInbound.onUpgradeComplete(StreamInbound.java:180)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:579)\n	at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:307)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n	at java.lang.Thread.run(Thread.java:662)','2012-05-31 18:20:53','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','d713894','Mark Emlyn David Thomas','2012-06-03 14:47:25','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53339 Ensure WebSocket event calls are made using the web application\'s class loader. Includes a test case.','java/org/apache/catalina/websocket/StreamInbound.java\ntest/org/apache/catalina/websocket/TestWebSocket.java'),(549,53008,'Bug 53008 – New test case for Basic Authenticator','','2012-03-30 12:21:42','Brian Burch','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','a1c6165','Mark Emlyn David Thomas','2012-06-03 12:44:49','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53008 Extend test cases for BASIC auth and RFC2617 compliance','test/org/apache/catalina/authenticator/TestNonLoginAndBasicAuthenticator.java'),(550,53337,'Bug 53337 – IllegalStateException when trying to render a JSP after startAsync','','2012-05-31 17:06:36','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','c6b691d','Mark Emlyn David Thomas','2012-06-03 11:50:50','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53337 Fix RequestDispatcher.forward() to an async servlet','java/org/apache/catalina/core/ApplicationDispatcher.java\ntest/org/apache/catalina/core/TestAsyncContextImpl.java'),(551,53333,'Bug 53333 – NPE is thrown for env-entry without env-entry-type but with injection-target specified','','2012-05-30 19:28:00','Violeta Georgieva','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','b7924f0','Mark Emlyn David Thomas','2012-06-02 17:18:53','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53333 Validate JNDI resource types against injection target types and use target types when no type is specified for the resource. Based on a patch by Violeta Georgieva.','java/org/apache/catalina/deploy/LocalStrings.properties\njava/org/apache/catalina/deploy/NamingResources.java'),(552,53333,'Bug 53333 – NPE is thrown for env-entry without env-entry-type but with injection-target specified','','2012-05-30 19:28:00','Violeta Georgieva','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','ae32d1d','Mark Emlyn David Thomas','2012-06-01 18:03:10','Refactor some duplicate code into an new utility class with an eye to the proposed patch for BZ 53333','java/org/apache/catalina/core/DefaultInstanceManager.java\njava/org/apache/catalina/core/LocalStrings.properties\njava/org/apache/catalina/startup/ContextConfig.java\njava/org/apache/catalina/startup/LocalStrings.properties\njava/org/apache/catalina/startup/WebAnnotationSet.java\njava/org/apache/catalina/util/Introspection.java\njava/org/apache/catalina/util/LocalStrings.properties'),(553,53257,'Bug 53257 – getLastModified() of compilation context returns negative number','','2012-05-18 06:24:44','A. Etzlstorfer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','7ae8155','Konstantin Kolinko','2012-06-01 17:33:19','For https://issues.apache.org/bugzilla/show_bug.cgi?id=53257 Review of r1344902: Restore passing DirContextURLStreamHandler instance into the new URL.','java/org/apache/catalina/core/ApplicationContext.java'),(554,53257,'Bug 53257 – getLastModified() of compilation context returns negative number','','2012-05-18 06:24:44','A. Etzlstorfer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','8ad4264','Konstantin Kolinko','2012-06-01 14:02:56','One more test, to be sure https://issues.apache.org/bugzilla/show_bug.cgi?id=53257','test/org/apache/jasper/compiler/TestCompiler.java'),(555,53301,'Bug 53301 – Servlet init method called twice with embedded Tomcat','When using embedded Tomcat, the servlet init method is called twice by the container. This has been seen with an Apache DirectMemory unit test. I have checked with a normal Tomcat launched by the Tomcat Maven plugin (mvn tomcat7:run) and in this case, the init method is correctly called once.','2012-05-26 21:36:56','Jeff MAURY','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 normal','6ce3128','Mark Emlyn David Thomas','2012-06-01 06:16:50','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53301 Prevent double initialisation of servlets when using existing servlet instances with embedded Tomcat','java/org/apache/catalina/startup/Tomcat.java\ntest/org/apache/catalina/startup/TestTomcat.java'),(556,53285,'Bug 53285 – Web app configuration fails when security-role-ref does not contain role-link','','2012-05-24 04:52:55','Stephen Davies','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','ad3b503','Mark Emlyn David Thomas','2012-06-01 05:40:59','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53285 Modify how the digester processes security-role-ref since link is optional and null parameters are not handled by IntrospectionUtils','java/org/apache/catalina/deploy/ServletDef.java\njava/org/apache/catalina/startup/WebRuleSet.java'),(557,53342,'Bug 53342 – If starting immediately after Tomcat stop fail, BindException will throw.','e.g.\nWhen Context#stop throw LifecycleException, the main thread stops, \nbut startStopThreads of Host/Engine will remain for a while. \nBecause, startStopThreads is not a demon thread. \n\nAs a result, \neven if a main thread stops, Acceptor Threads of 8080/8009 is not stopped. \n\nkeepAliveTime for 10 seconds is set up now. \n===\nstartStopExecutor = new ThreadPoolExecutor(\n            getStartStopThreadsInternal(),\n            getStartStopThreadsInternal(), 10, TimeUnit.SECONDS,\n            startStopQueue);\n===\n\nTherefore, in order to avoid BindException, the waiting for 10 seconds is required. \n\nI think that I need to make startStopThreads into a demon thread. \n\nBest Regards.','2012-06-01 09:34:18','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','84342f5','Keiichi Fujino','2012-06-01 05:38:31','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53342 To avoid BindException, make startStopThreads into a demon thread.','java/org/apache/catalina/core/ContainerBase.java'),(558,53257,'Bug 53257 – getLastModified() of compilation context returns negative number','','2012-05-18 06:24:44','A. Etzlstorfer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','b4650d8','Mark Emlyn David Thomas','2012-05-31 16:18:49','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53257 BZ 53257 is partially a regression caused by r1152593 (the fix for BZ 51584) and partially an existing issue that had always been present. This patch: - reverts r1152593 - extends the test cases to cover BZ 53257 & BZ 51584 - correctly fixes BZ 53257 & BZ 51584 - fixes the additional issues the unit tests uncovered','java/org/apache/catalina/core/ApplicationContext.java\njava/org/apache/naming/resources/DirContextURLConnection.java\nres/checkstyle/org-import-control.xml\ntest/org/apache/jasper/compiler/TestCompiler.java\ntest/webapp-3.0/bug53257/foo#bar\ntest/webapp-3.0/bug53257/foo#bar.txt\ntest/webapp-3.0/bug53257/foo&bar\ntest/webapp-3.0/bug53257/foo&bar.txt\ntest/webapp-3.0/bug53257/foo+bar\ntest/webapp-3.0/bug53257/foo+bar.txt\ntest/webapp-3.0/bug53257/foo;bar\ntest/webapp-3.0/bug53257/foo;bar.txt\ntest/webapp-3.0/bug53257/index.jsp'),(559,53257,'Bug 53257 – getLastModified() of compilation context returns negative number','','2012-05-18 06:24:44','A. Etzlstorfer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','b4650d8','Mark Emlyn David Thomas','2012-05-31 16:18:49','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53257 BZ 53257 is partially a regression caused by r1152593 (the fix for BZ 51584) and partially an existing issue that had always been present. This patch: - reverts r1152593 - extends the test cases to cover BZ 53257 & BZ 51584 - correctly fixes BZ 53257 & BZ 51584 - fixes the additional issues the unit tests uncovered','java/org/apache/catalina/core/ApplicationContext.java\njava/org/apache/naming/resources/DirContextURLConnection.java\nres/checkstyle/org-import-control.xml\ntest/org/apache/jasper/compiler/TestCompiler.java\ntest/webapp-3.0/bug53257/foo#bar\ntest/webapp-3.0/bug53257/foo#bar.txt\ntest/webapp-3.0/bug53257/foo&bar\ntest/webapp-3.0/bug53257/foo&bar.txt\ntest/webapp-3.0/bug53257/foo+bar\ntest/webapp-3.0/bug53257/foo+bar.txt\ntest/webapp-3.0/bug53257/foo;bar\ntest/webapp-3.0/bug53257/foo;bar.txt\ntest/webapp-3.0/bug53257/index.jsp'),(560,51584,'Bug 51584 – Crash (infinite loop) when files starting with \'#\' are in the library tree','','2011-07-29 15:34:27','Steven R. Loomis','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 major','b4650d8','Mark Emlyn David Thomas','2012-05-31 16:18:49','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53257 BZ 53257 is partially a regression caused by r1152593 (the fix for BZ 51584) and partially an existing issue that had always been present. This patch: - reverts r1152593 - extends the test cases to cover BZ 53257 & BZ 51584 - correctly fixes BZ 53257 & BZ 51584 - fixes the additional issues the unit tests uncovered','java/org/apache/catalina/core/ApplicationContext.java\njava/org/apache/naming/resources/DirContextURLConnection.java\nres/checkstyle/org-import-control.xml\ntest/org/apache/jasper/compiler/TestCompiler.java\ntest/webapp-3.0/bug53257/foo#bar\ntest/webapp-3.0/bug53257/foo#bar.txt\ntest/webapp-3.0/bug53257/foo&bar\ntest/webapp-3.0/bug53257/foo&bar.txt\ntest/webapp-3.0/bug53257/foo+bar\ntest/webapp-3.0/bug53257/foo+bar.txt\ntest/webapp-3.0/bug53257/foo;bar\ntest/webapp-3.0/bug53257/foo;bar.txt\ntest/webapp-3.0/bug53257/index.jsp'),(561,53257,'Bug 53257 – getLastModified() of compilation context returns negative number','','2012-05-18 06:24:44','A. Etzlstorfer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','b4650d8','Mark Emlyn David Thomas','2012-05-31 16:18:49','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53257 BZ 53257 is partially a regression caused by r1152593 (the fix for BZ 51584) and partially an existing issue that had always been present. This patch: - reverts r1152593 - extends the test cases to cover BZ 53257 & BZ 51584 - correctly fixes BZ 53257 & BZ 51584 - fixes the additional issues the unit tests uncovered','java/org/apache/catalina/core/ApplicationContext.java\njava/org/apache/naming/resources/DirContextURLConnection.java\nres/checkstyle/org-import-control.xml\ntest/org/apache/jasper/compiler/TestCompiler.java\ntest/webapp-3.0/bug53257/foo#bar\ntest/webapp-3.0/bug53257/foo#bar.txt\ntest/webapp-3.0/bug53257/foo&bar\ntest/webapp-3.0/bug53257/foo&bar.txt\ntest/webapp-3.0/bug53257/foo+bar\ntest/webapp-3.0/bug53257/foo+bar.txt\ntest/webapp-3.0/bug53257/foo;bar\ntest/webapp-3.0/bug53257/foo;bar.txt\ntest/webapp-3.0/bug53257/index.jsp'),(562,51584,'Bug 51584 – Crash (infinite loop) when files starting with \'#\' are in the library tree','','2011-07-29 15:34:27','Steven R. Loomis','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 major','b4650d8','Mark Emlyn David Thomas','2012-05-31 16:18:49','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53257 BZ 53257 is partially a regression caused by r1152593 (the fix for BZ 51584) and partially an existing issue that had always been present. This patch: - reverts r1152593 - extends the test cases to cover BZ 53257 & BZ 51584 - correctly fixes BZ 53257 & BZ 51584 - fixes the additional issues the unit tests uncovered','java/org/apache/catalina/core/ApplicationContext.java\njava/org/apache/naming/resources/DirContextURLConnection.java\nres/checkstyle/org-import-control.xml\ntest/org/apache/jasper/compiler/TestCompiler.java\ntest/webapp-3.0/bug53257/foo#bar\ntest/webapp-3.0/bug53257/foo#bar.txt\ntest/webapp-3.0/bug53257/foo&bar\ntest/webapp-3.0/bug53257/foo&bar.txt\ntest/webapp-3.0/bug53257/foo+bar\ntest/webapp-3.0/bug53257/foo+bar.txt\ntest/webapp-3.0/bug53257/foo;bar\ntest/webapp-3.0/bug53257/foo;bar.txt\ntest/webapp-3.0/bug53257/index.jsp'),(563,53257,'Bug 53257 – getLastModified() of compilation context returns negative number','','2012-05-18 06:24:44','A. Etzlstorfer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','b4650d8','Mark Emlyn David Thomas','2012-05-31 16:18:49','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53257 BZ 53257 is partially a regression caused by r1152593 (the fix for BZ 51584) and partially an existing issue that had always been present. This patch: - reverts r1152593 - extends the test cases to cover BZ 53257 & BZ 51584 - correctly fixes BZ 53257 & BZ 51584 - fixes the additional issues the unit tests uncovered','java/org/apache/catalina/core/ApplicationContext.java\njava/org/apache/naming/resources/DirContextURLConnection.java\nres/checkstyle/org-import-control.xml\ntest/org/apache/jasper/compiler/TestCompiler.java\ntest/webapp-3.0/bug53257/foo#bar\ntest/webapp-3.0/bug53257/foo#bar.txt\ntest/webapp-3.0/bug53257/foo&bar\ntest/webapp-3.0/bug53257/foo&bar.txt\ntest/webapp-3.0/bug53257/foo+bar\ntest/webapp-3.0/bug53257/foo+bar.txt\ntest/webapp-3.0/bug53257/foo;bar\ntest/webapp-3.0/bug53257/foo;bar.txt\ntest/webapp-3.0/bug53257/index.jsp'),(564,51584,'Bug 51584 – Crash (infinite loop) when files starting with \'#\' are in the library tree','','2011-07-29 15:34:27','Steven R. Loomis','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 major','b4650d8','Mark Emlyn David Thomas','2012-05-31 16:18:49','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53257 BZ 53257 is partially a regression caused by r1152593 (the fix for BZ 51584) and partially an existing issue that had always been present. This patch: - reverts r1152593 - extends the test cases to cover BZ 53257 & BZ 51584 - correctly fixes BZ 53257 & BZ 51584 - fixes the additional issues the unit tests uncovered','java/org/apache/catalina/core/ApplicationContext.java\njava/org/apache/naming/resources/DirContextURLConnection.java\nres/checkstyle/org-import-control.xml\ntest/org/apache/jasper/compiler/TestCompiler.java\ntest/webapp-3.0/bug53257/foo#bar\ntest/webapp-3.0/bug53257/foo#bar.txt\ntest/webapp-3.0/bug53257/foo&bar\ntest/webapp-3.0/bug53257/foo&bar.txt\ntest/webapp-3.0/bug53257/foo+bar\ntest/webapp-3.0/bug53257/foo+bar.txt\ntest/webapp-3.0/bug53257/foo;bar\ntest/webapp-3.0/bug53257/foo;bar.txt\ntest/webapp-3.0/bug53257/index.jsp'),(565,53115,'Bug 53115 – catalina.bat run does not work if TEMP contains spaces','Under clean Windows XP, under Administrator account. \nDefault temp dir is like c:\\Documents and Settings\\Admin\\Local Settings\\TEMP\n\nIn catalina.bat there is a temp dir check:\nif \"\"%TEMP%\"\" == \"\"\"\" goto mainEntry\n\nActually, this command does not work if TEMP contains spaces. \nThe right line is:\nif \"\"%TEMP%\"\" == \"\"\"\" goto mainEntry\n\ni.e. to avoid double quoting','2012-04-20 18:25:41','Eugene Petrenko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','77e943b','Konstantin Kolinko','2012-05-31 09:59:13','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53115 Allow \"catalina.bat run\" to work even if %TEMP% contains spaces. Note that - It affects \"run\" command only. For all other commands that code is skipped, thanks to [if not \"\"%1\"\" == \"\"run\"\"] jump. - Single doublequotes are already used in \"%TEMP%\\%~nx0.run\". The %TEMP% value cannot be quoted.','bin/catalina.bat'),(566,53225,'Bug 53225 – IllegalStateException \"zip file closed\" with resource from webfragment jar if JreMemoryLeakPreventionListener is removed','','2012-05-12 20:32:50','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','e90cd4b','Mark Emlyn David Thomas','2012-05-31 05:58:56','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53225 Fix ISE \"zip file closed\" when urlCacheProtection=\"false\" in the JreMemoryLeakPreventionListener','java/org/apache/tomcat/util/scan/FileUrlJar.java'),(567,53169,'Bug 53169 – [patch] don\'t do chunking with Connection: close','','2012-05-01 09:35:06','Philippe Marschall','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','280beac','Mark Emlyn David Thomas','2012-05-30 10:11:49','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53169 Allow servlets to opt to avoid chunked encoding with a response of unknown length by setting the Connection: close header. Based on a patch suggested by Philippe Marschall.','java/org/apache/coyote/http11/AbstractHttp11Processor.java\ntest/org/apache/coyote/http11/TestAbstractHttp11Processor.java'),(568,53119,'Bug 53119 – java.nio.BufferOverflowException in AjpAprProcessor.output() when AJP client disconnects','','2012-04-21 11:51:17','Konstantin Preißer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 minor','fc1baad','Mark Emlyn David Thomas','2012-05-30 09:31:51','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53119 Make sure the buffer is cleared on any error to prevent any possible overflow if it is written to again before the connection is closed. I can\'t reproduce the error with the provided test case but based on code inspection this should fix it.','java/org/apache/coyote/ajp/AjpAprProcessor.java'),(569,53322,'Bug 53322 – Odd decapitalization when inferring JavaBean property from setter name for an injection target','','2012-05-30 01:22:25','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','13100e9','Konstantin Kolinko','2012-05-29 21:30:58','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53322 Follow JavaBeans specification when converting setter method name into property name for resource injection.','java/org/apache/catalina/core/DefaultInstanceManager.java'),(570,53267,'Bug 53267 – The JreMemoryLeakPreventionListener causes a full GC every hour when gcDaemonProtection=true','','2012-05-21 14:41:43','Pid','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','c9763de','Mark Emlyn David Thomas','2012-05-29 14:22:50','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53267 Stop the JreMemoryLeakPreventionListener triggering a full GC every hour','java/org/apache/catalina/core/JreMemoryLeakPreventionListener.java'),(571,53180,'Bug 53180 – DefaultInstanceManager#populateAnnotationsCache - incomplete check is used when validating for a setter method','','2012-05-02 20:27:25','Violeta Georgieva','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','39c8e18','Mark Emlyn David Thomas','2012-05-29 09:33:40','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53180 Add additional checks when looking for a setter method. Patch provided by Violeta Georgieva.','java/org/apache/catalina/core/DefaultInstanceManager.java'),(572,53081,'Bug 53081 – WebappClassLoader causes java.lang.OutOfMemoryError in findResourceInternal()','','2012-04-13 21:46:53','Dmitry','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','5d12129','Mark Emlyn David Thomas','2012-05-29 09:06:24','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53081 Do not always cache resources loaded by the web application class loader','java/org/apache/catalina/loader/WebappClassLoader.java'),(573,53090,'Bug 53090 – Servlet superclass injection targets are ignored','','2012-04-17 08:07:14','Borislav Kapukaranov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','de1f763','Mark Emlyn David Thomas','2012-05-28 17:16:29','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53090 Include superclasses when considering injection targets Patch provided by Borislav Kapukaranov','java/org/apache/catalina/core/DefaultInstanceManager.java'),(574,52055,'Bug 52055 – ChunkedInputFilter is not recycled for servlet 3.0 asynchronous request','I\'m using the standard servlet 3.0 async APIs with tomcat 7.0.22. The server side code is something like the following:\n\n        final AsyncContext asyncContext = request.startAsync();\n\n        ... // in a processing thread\n        asyncContext.getRequest().getInputStream();\n        ... read the input stream\n        asyncContext.complete();\n\nThe InputStream returns 0 bytes for the HTTP post with chunking. \n\nAfter debugging, I found that the ChunkedInputFilter is reused by org.apache.coyote.http11.AbstractInputBuffer. But it has never been recycled (nextRequest()?) before the reuse for another request. As a result, the endChunk flag is always true after the first request. And it always return immediately without reading more from the buffer.','2011-10-18 21:53:21','Raymond Feng','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 critical','c80a1fe','Mark Emlyn David Thomas','2012-05-25 16:17:33','Further fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=52055. Ensure ChunkedInputFilter is correctly recycled.','java/org/apache/coyote/http11/filters/ChunkedInputFilter.java'),(575,53074,'Bug 53074 – [websocket] java.net.SocketTimeoutException: Read timed caused by server.xml\' connectTimeout','The default connectTimeout value is set to 20000 and cause issue with WebSocket connection\n\njava.net.SocketTimeoutException: Read timed out\n    at java.net.SocketInputStream.socketRead0(Native Method)\n    at java.net.SocketInputStream.read(SocketInputStream.java:129)\n    at org.apache.coyote.http11.upgrade.UpgradeBioProcessor.read(UpgradeBioProcessor.java:75)\n    at org.apache.catalina.websocket.WsFrame.nextFrame(WsFrame.java:213)\n    at org.apache.catalina.websocket.WsInputStream.nextFrame(WsInputStream.java:68)\n    at org.apache.catalina.websocket.StreamInbound.onData(StreamInbound.java:143)\n    at org.apache.coyote.http11.upgrade.UpgradeProcessor.upgradeDispatch(UpgradeProcessor.java:83)\n    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:563)\n    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:307)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n    at java.lang.Thread.run(Thread.java:680)\n\nIncreasing the value delay the issue (but the timeout should not occurs)','2012-04-13 13:45:11','Jean-Francois Arcand','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','098a647','Mark Emlyn David Thomas','2012-05-25 12:39:46','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53074 Make WebSocket connections use infinite read timeouts by default.','java/org/apache/catalina/websocket/StreamInbound.java\njava/org/apache/coyote/ajp/AjpAprProtocol.java\njava/org/apache/coyote/http11/Http11AprProtocol.java\njava/org/apache/coyote/http11/upgrade/UpgradeAprProcessor.java\njava/org/apache/coyote/http11/upgrade/UpgradeBioProcessor.java\njava/org/apache/coyote/http11/upgrade/UpgradeInbound.java\njava/org/apache/coyote/http11/upgrade/UpgradeNioProcessor.java\njava/org/apache/tomcat/util/net/AprEndpoint.java'),(576,53289,'Bug 53289 – Clarify ResourceLink example that uses getConnection(username, password)','','2012-05-24 13:58:15','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 enhancement','5dd53a9','Konstantin Kolinko','2012-05-25 02:10:23','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53289 Clarify ResourceLink example that uses getConnection(username, password)','webapps/docs/config/context.xml'),(577,52858,'Bug 52858 – High CPU load in the NIO connector, when a client breaks connection unexpectedly','','2012-03-08 15:06:51','Dmitry Kukushkin','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 major','f7fcd24','Filip Hanik','2012-05-18 15:23:12','https://issues.apache.org/bugzilla/show_bug.cgi?id=52858 https://issues.apache.org/bugzilla/show_bug.cgi?id=53138 Fix broken NIO sendfile download Fix high CPU usage due to registered OP_READ for sendfile processes','java/org/apache/tomcat/util/net/NioEndpoint.java'),(578,53138,'Bug 53138 – Not able to download a file size of 740KB using NIO connector in tomcat version 7.0.27. But with the same configuration I was able to download that in tomcat 7.0.26.','','2012-04-24 11:53:11','prakash','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 blocker','f7fcd24','Filip Hanik','2012-05-18 15:23:12','https://issues.apache.org/bugzilla/show_bug.cgi?id=52858 https://issues.apache.org/bugzilla/show_bug.cgi?id=53138 Fix broken NIO sendfile download Fix high CPU usage due to registered OP_READ for sendfile processes','java/org/apache/tomcat/util/net/NioEndpoint.java'),(579,53254,'Bug 53254 – Support for purging connection pool','It is a common function of a connection pool to support \"purging\" the pool of all current connections and getting all fresh connections.  Oracle UCP and Websphere pools are two such examples.  It would be great if this pool supported such an operation as well.\n\nIt would be useful if the operation were exposed through JMX too.','2012-05-17 17:59:28','Mike Youngstrom','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','f170929','Filip Hanik','2012-05-18 12:28:33','Add in ability to purge the pool https://issues.apache.org/bugzilla/show_bug.cgi?id=53254','modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/DataSourceProxy.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/PooledConnection.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/jmx/ConnectionPool.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/jmx/ConnectionPoolMBean.java\nmodules/jdbc-pool/src/test/java/org/apache/tomcat/jdbc/test/PoolPurgeTest.java'),(580,53067,'Bug 53067 – WebSocket implementation issue with wrapped requests','','2012-04-12 17:56:58','Jean-Francois Arcand','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','111dc8e','Mark Emlyn David Thomas','2012-05-12 16:51:24','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53067 Make sure request is unwrapped before we cast it to the internal Tomcat implementation','java/org/apache/catalina/websocket/WebSocketServlet.java'),(581,53203,'Bug 53203 – Incorrect document of ajp connectionTimeout.','','2012-05-08 01:46:43','Tatsuya Bessho','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 normal','c7d986c','Konstantin Kolinko','2012-05-12 11:34:31','https://issues.apache.org/bugzilla/show_bug.cgi?id=53203 Correct documentation of default value of connectionTimeout for AJP protocol. See org.apache.coyote.ajp.Constants.DEFAULT_CONNECTION_TIMEOUT','webapps/docs/config/ajp.xml'),(582,53063,'Bug 53063 – Inconsistency in documentation regarding Connector\'s maxConnections property','','2012-04-11 13:14:14','Daniel Mikusa','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 minor','be365e5','Mark Emlyn David Thomas','2012-05-10 17:07:22','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53063 When using an Executor with BIO, use the executor\'s maxThreads as the default for maxConnections','java/org/apache/tomcat/util/net/AbstractEndpoint.java\njava/org/apache/tomcat/util/net/JIoEndpoint.java\nwebapps/docs/config/ajp.xml\nwebapps/docs/config/http.xml'),(583,53062,'Bug 53062 – Tomcat doesn\'t normalize absolute urls for redirect','','2012-04-11 12:42:29','mgrigorov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 normal','cd9229e','Mark Emlyn David Thomas','2012-05-10 16:06:15','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53062 Normalize redirect URLs constructed from relative paths','java/org/apache/catalina/connector/Response.java\njava/org/apache/tomcat/util/buf/CharChunk.java\ntest/org/apache/catalina/connector/TestResponse.java\ntest/org/apache/catalina/connector/TestResponsePerformance.java'),(584,53034,'Bug 53034 – apache tomcat deployed pom does not contain url or license','Even though Apache Tomcat doesn\'t manage itself with Apache Maven, it is really great that the project deploys artifacts for user consumption.\n\nUnfortunately, these artifacts are missing some important pieces of information that are really important for working in big organizations: there is no project.url defined, and there is no project.licenses section. Adding both of these would play nicely in automated systems which need to have that license available to produce a proper \"Bill of Materials\".','2012-04-04 12:35:36','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Packaging','P2 trivial','4081859','Mark Emlyn David Thomas','2012-05-08 15:34:10','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53034 Add project.url and project.licenses setions to all the POMs','res/maven/tomcat-annotations-api.pom\nres/maven/tomcat-api.pom\nres/maven/tomcat-catalina-ant.pom\nres/maven/tomcat-catalina-ha.pom\nres/maven/tomcat-catalina-jmx-remote.pom\nres/maven/tomcat-catalina-ws.pom\nres/maven/tomcat-catalina.pom\nres/maven/tomcat-coyote.pom\nres/maven/tomcat-dbcp.pom\nres/maven/tomcat-el-api.pom\nres/maven/tomcat-embed-core.pom\nres/maven/tomcat-embed-jasper.pom\nres/maven/tomcat-embed-logging-juli.pom\nres/maven/tomcat-embed-logging-log4j.pom\nres/maven/tomcat-extras-juli-adapters.pom\nres/maven/tomcat-extras-juli.pom\nres/maven/tomcat-i18n-es.pom\nres/maven/tomcat-i18n-fr.pom\nres/maven/tomcat-i18n-ja.pom\nres/maven/tomcat-jasper-el.pom\nres/maven/tomcat-jasper.pom\nres/maven/tomcat-jdbc.pom\nres/maven/tomcat-jni.pom\nres/maven/tomcat-jsp-api.pom\nres/maven/tomcat-juli.pom\nres/maven/tomcat-servlet-api.pom\nres/maven/tomcat-spdy.pom\nres/maven/tomcat-tribes.pom\nres/maven/tomcat-util.pom'),(585,52853,'Bug 52853 – @HandlesTypes not resolving classes when added as repository directory','','2012-03-08 02:55:40','Benjamin Muschko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','379be94','Mark Emlyn David Thomas','2012-05-07 09:57:41','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52853 Clarify how JarScanner handles directories.','webapps/docs/config/jar-scanner.xml'),(586,52055,'Bug 52055 – ChunkedInputFilter is not recycled for servlet 3.0 asynchronous request','I\'m using the standard servlet 3.0 async APIs with tomcat 7.0.22. The server side code is something like the following:\n\n        final AsyncContext asyncContext = request.startAsync();\n\n        ... // in a processing thread\n        asyncContext.getRequest().getInputStream();\n        ... read the input stream\n        asyncContext.complete();\n\nThe InputStream returns 0 bytes for the HTTP post with chunking. \n\nAfter debugging, I found that the ChunkedInputFilter is reused by org.apache.coyote.http11.AbstractInputBuffer. But it has never been recycled (nextRequest()?) before the reuse for another request. As a result, the endChunk flag is always true after the first request. And it always return immediately without reading more from the buffer.','2011-10-18 21:53:21','Raymond Feng','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 critical','b2ff3dd','Mark Emlyn David Thomas','2012-05-06 17:27:55','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52055 Ensure input filters are recycled when the request is recycled for all connectors.','java/org/apache/coyote/http11/AbstractInputBuffer.java\njava/org/apache/coyote/http11/InternalNioInputBuffer.java'),(587,53173,'Bug 53173 – maxConnections feature hangs the system','','2012-05-01 13:54:22','Filip Hanik','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 normal','72aab30','Filip Hanik','2012-05-02 13:12:48','https://issues.apache.org/bugzilla/show_bug.cgi?id=53173 Properly handle count down of maxConnections latch when entering edge cases.','java/org/apache/coyote/AbstractProtocol.java\njava/org/apache/tomcat/util/net/AbstractEndpoint.java\njava/org/apache/tomcat/util/net/AprEndpoint.java\njava/org/apache/tomcat/util/net/JIoEndpoint.java\njava/org/apache/tomcat/util/net/NioEndpoint.java\njava/org/apache/tomcat/util/threads/LimitLatch.java\nwebapps/docs/changelog.xml\nwebapps/docs/config/ajp.xml\nwebapps/docs/config/http.xml'),(588,53158,'Bug 53158 – Wrong default values indicated for the evictor service','','2012-04-28 11:15:00','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P2 normal','e692450','Rainer Jung','2012-04-28 10:03:39','BZ 53158: Fix documented defaults for DBCP. Patch provided by ph.dezanneau at gmail.com.','webapps/docs/jndi-resources-howto.xml'),(589,53085,'Bug 53085 – [perf] [concurrency] DefaultInstanceManager.annotationCache is not optimal for more threads','','2012-04-16 18:42:12','Martin Kočí','Tomcat Developers Mailing List','NEW','Tomcat 7','Catalina','P3 enhancement','de82eab','Konstantin Kolinko','2012-04-19 08:04:35','For https://issues.apache.org/bugzilla/show_bug.cgi?id=53085 Implement ConcurrentHashMap with weak keys.','java/org/apache/tomcat/util/collections/ManagedConcurrentWeakHashMap.java'),(590,53087,'Bug 53087 – BackupManager does not replicate session access time.','','2012-04-17 05:44:46','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Cluster','P2 normal','48b9153','Keiichi Fujino','2012-04-17 02:06:51','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53087. In order to avoid that a backup node expire a session, replicate session access time in BackupManager.','java/org/apache/catalina/ha/session/DeltaSession.java\njava/org/apache/catalina/tribes/tipis/AbstractReplicatedMap.java\njava/org/apache/catalina/tribes/tipis/ReplicatedMapEntry.java'),(591,53057,'Bug 53057 – Add OpenSSL version number to INFO log message when initializing','It would be nice to see a message confirming the initialization of OpenSSL including its version number.','2012-04-10 21:35:43','Christopher Schultz','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','9801641','Christopher Schultz','2012-04-10 17:38:35','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53057 Add OpenSSL version number to INFO log message when initializing','java/org/apache/catalina/core/AprLifecycleListener.java\njava/org/apache/catalina/core/LocalStrings.properties\njava/org/apache/catalina/core/LocalStrings_es.properties'),(592,53056,'Bug 53056 – Add APR version number to tcnative version INFO log message','When tcnative starts, it emits information like this to catalina.out:\n\npr 10, 2012 4:54:55 PM org.apache.catalina.core.AprLifecycleListener init\nINFO: Loaded APR based Apache Tomcat Native library 1.1.23.\nApr 10, 2012 4:54:55 PM org.apache.catalina.core.AprLifecycleListener init\nINFO: APR capabilities: IPv6 [true], sendfile [true], accept filters [false], random [true].\n\nIt would be nice if the APR version in use could also be displayed as well as the tcnative version. Maybe the OpenSSL version, too.','2012-04-10 20:58:50','Christopher Schultz','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','df88ecb','Christopher Schultz','2012-04-10 17:16:01','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53056 Add APR version number to tcnative version INFO log message','java/org/apache/catalina/core/AprLifecycleListener.java\njava/org/apache/catalina/core/LocalStrings.properties\njava/org/apache/catalina/core/LocalStrings_es.properties'),(593,50864,'Bug 50864 – Reconfigure pool on the fly using JMX','','2011-03-03 11:15:31','Filip Hanik','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','518662f','Filip Hanik','2012-04-10 12:29:42','https://issues.apache.org/bugzilla/show_bug.cgi?id=50864 Add in the ability to configure most pool properties even while the pool is running','modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/PoolProperties.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/jmx/ConnectionPool.java'),(594,51741,'Bug 51741 – Eclipse WTP \"Serve modules without publishing\" broken with tc7, needs patch in tomcat','','2011-08-29 21:29:56','Sylvain Laurent','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','4fa4f90','Konstantin Kolinko','2012-03-30 16:28:50','Followup to https://issues.apache.org/bugzilla/show_bug.cgi?id=51741 Remove wrong call. The tests pass for me with this call being removed. If allowLinking feature is really needed, it should be configured explicitly.','java/org/apache/naming/resources/VirtualDirContext.java'),(595,52998,'Bug 52998 – Performance issue with ExpressionFactory.newInstance()','','2012-03-28 21:16:03','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','7da5fa9','Mark Emlyn David Thomas','2012-03-30 16:10:48','Remainder of fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=52998 Cache ExpressionFactory class per class loader (kkolinko)','java/javax/el/ExpressionFactory.java'),(596,53001,'Bug 53001 – Behaviour of ResourceBundleELResolver','','2012-03-29 09:41:39','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','1aced29','Mark Emlyn David Thomas','2012-03-30 12:31:10','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=53001 Add a test case','test/javax/el/TestResourceBundleELResolver.java'),(597,46915,'Bug 46915 – Unable to get ResourceBundle keys in Tomcat 6','','2009-03-26 03:27:15','Kapil','Tomcat Developers Mailing List','RESOLVED INVALID','Tomcat 6','Servlet & JSP API','P2 normal','0df4b49','Mark Emlyn David Thomas','2012-03-30 12:30:37','Revert r758664 and the fix for bug 46915 since the bug is invalid since the EL specification requires the behaviour that bug objects to.','java/javax/el/ResourceBundleELResolver.java'),(598,52974,'Bug 52974 – NameNotFoundException is thrown when field/method is annotated with @Resource annotation','','2012-03-22 20:43:20','Violeta Georgieva','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','67a926c','Mark Emlyn David Thomas','2012-03-27 15:20:10','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52974 Fix NameNotFoundException when field/method is annotated with @Resource annotation Patch provided by Violet Agg.','java/org/apache/catalina/startup/WebAnnotationSet.java'),(599,52833,'Bug 52833 – NPE with 7.0.26','Upgrading the maven plugin 7.0.26, the goal which runs tomcat with a conf dir (not the embed version) generate the following NPE \nLog:\n	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:236)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:141)\n	at org.apache.catalina.startup.Catalina.start(Catalina.java:645)\n	at org.apache.tomcat.maven.plugin.tomcat7.run.AbstractRunMojo.startContainer(AbstractRunMojo.java:679)\n	at org.apache.tomcat.maven.plugin.tomcat7.run.AbstractRunMojo.execute(AbstractRunMojo.java:365)\n	at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:101)\n	at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:209)\n	at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:153)\n	at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:145)\n	at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:84)\n	at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:59)\n	at org.apache.maven.lifecycle.internal.LifecycleStarter.singleThreadedBuild(LifecycleStarter.java:183)\n	at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:161)\n	at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:320)\n	at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:156)\n	at org.apache.maven.cli.MavenCli.execute(MavenCli.java:544)\n	at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:197)\n	at org.apache.maven.cli.MavenCli.main(MavenCli.java:141)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n	at java.lang.reflect.Method.invoke(Method.java:597)\n	at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:290)\n	at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:230)\n	at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:409)\n	at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:352)','2012-03-05 23:28:06','olamy','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 regression','6a8e480','Mark Emlyn David Thomas','2012-03-27 14:28:35','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52833 Fix NPE in some embedded / osgi scenarios where the class loader my not have the system class loader as a parent.','java/org/apache/catalina/core/StandardServer.java'),(600,52066,'Bug 52066 – ConnectionPool.borrowConnection swallows interrupt state.','In this code snippet starting on line 6.15 of ConnectionPool.java version 7.0.22\n\n    try {\n        //retrieve an existing connection\n        con = idle.poll(timetowait, TimeUnit.MILLISECONDS);\n    } catch (InterruptedException ex) {\n        Thread.interrupted();//clear the flag, and bail out\n        SQLException sx = new SQLException(\"Pool wait interrupted.\");\n        sx.initCause(ex);\n        throw sx;\n    } finally {\n        waitcount.decrementAndGet();\n    }\n\nThe line marked \'//clear the flag, and bail out\' is wrong, because after that there is no way for calling code to find out that the thread has been interrupted.\n\nThe correct behavior should be\n\n    Thread.currentThread( ).interrupt( );\n\nHere is the excerpt from the Biran Goetz\'s \"Java Concurrency in Practice\" chapter 5.4.\n\n<!START QUOTATION>\nFor library code there are basically two choices:\n\n-- Propagate the InterruptedException. This is often the most sensible policy if you can get away with it -- just propagate the InterruptedException to your caller.  This could involve not catching InterruptedException, or catching it and throwing it again after performing some brief activity-specific cleanup. \n\n-- Restore the interrupt. Sometimes you cannot throw InterruptedException, for instance when your code is part of a Runnable. In these situations, you must catch InterruptedException and restore the interrupted status by calling interrupt on the current thread, so that code higher up the call stack can see that an interrupt was issued.\n<!END QUOTATION>\n\nIn the case of borrowConnection, #1 is not really a choice, as it is running in the confines of JDBC interface.  But it can definitely restore the interrupt status of the thread.','2011-10-20 19:28:24','Alexander Pogrebnyak','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','fe16ac2','Filip Hanik','2012-03-27 13:55:41','https://issues.apache.org/bugzilla/show_bug.cgi?id=52066 Add in a configuration attribute to allow a thread interrupt state to be retained for the calling library to see','modules/jdbc-pool/doc/jdbc-pool.xml\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/DataSourceProxy.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/PoolConfiguration.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/PoolProperties.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/jmx/ConnectionPool.java'),(601,52002,'Bug 52002 – Pool re-opens and re-issues closed connection','','2011-10-10 13:42:25','Kevin Greiner','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','04d3b9a','Filip Hanik','2012-03-27 11:05:31','https://issues.apache.org/bugzilla/show_bug.cgi?id=52002 Documentation change to reflect the new default value','modules/jdbc-pool/doc/jdbc-pool.xml'),(602,52002,'Bug 52002 – Pool re-opens and re-issues closed connection','','2011-10-10 13:42:25','Kevin Greiner','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','354cde4','Filip Hanik','2012-03-27 11:04:29','https://issues.apache.org/bugzilla/show_bug.cgi?id=52002 Improvements to the pool - the default should be that multi thread close should not affect the connection isValid should return false if a connection has been closed','modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/DisposableConnectionFacade.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/JdbcInterceptor.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/PoolProperties.java'),(603,52970,'Bug 52970 – MethodNotFoundException when using enum as one of method arguments','Consider this JSF view snippet:\n\n----------------------------------------------------------------------\n<h:form>\n    <h:commandButton value=\"submit\" action=\"#{bean.submit(\'FOO\')}\" />\n</h:form>\n----------------------------------------------------------------------\n\nAnd this JSF bean snippet:\n\n----------------------------------------------------------------------\n@ManagedBean\n@RequestScoped\npublic class Bean {\n    public enum Type { FOO, BAR }\n\n    public void submit(Type type) {\n        System.out.println(type);\n    }\n}\n----------------------------------------------------------------------\n\nThis results in a javax.el.MethodNotFoundException. It works in Glassfish 3. EL 2.2 spec 1.18.6 tells that a string must be coerced to enum of type T.','2012-03-22 12:28:52','balusc','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 normal','db7d936','Mark Emlyn David Thomas','2012-03-24 17:30:46','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52970 Take account of coercion rules when invoking methods','java/org/apache/el/parser/AstValue.java\njava/org/apache/el/util/ReflectionUtil.java'),(604,52970,'Bug 52970 – MethodNotFoundException when using enum as one of method arguments','Consider this JSF view snippet:\n\n----------------------------------------------------------------------\n<h:form>\n    <h:commandButton value=\"submit\" action=\"#{bean.submit(\'FOO\')}\" />\n</h:form>\n----------------------------------------------------------------------\n\nAnd this JSF bean snippet:\n\n----------------------------------------------------------------------\n@ManagedBean\n@RequestScoped\npublic class Bean {\n    public enum Type { FOO, BAR }\n\n    public void submit(Type type) {\n        System.out.println(type);\n    }\n}\n----------------------------------------------------------------------\n\nThis results in a javax.el.MethodNotFoundException. It works in Glassfish 3. EL 2.2 spec 1.18.6 tells that a string must be coerced to enum of type T.','2012-03-22 12:28:52','balusc','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 normal','1127691','Mark Emlyn David Thomas','2012-03-24 17:29:11','Add test case for bug 52970. Need to apply coercion rules to method invocation','test/org/apache/el/TestMethodExpressionImpl.java\ntest/org/apache/el/TesterBeanEnum.java'),(605,52830,'Bug 52830 – DataSource JNDI lookup with javax.naming.Name failed','','2012-03-05 15:25:49','moogle','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','7121925','Konstantin Kolinko','2012-03-23 12:38:43','https://issues.apache.org/bugzilla/show_bug.cgi?id=52830#c6 Alternative implementation of the fix, which does not require that name were an instance of CompositeName.','java/org/apache/naming/SelectorContext.java'),(606,52957,'Bug 52957 – ClassCastException while removing Valve','','2012-03-21 12:47:49','Violeta Georgieva','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','d5cee34','Mark Emlyn David Thomas','2012-03-22 10:35:02','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52957 Ensure Valve implements Lifecycle before calling Lifecycle methods','java/org/apache/catalina/core/StandardPipeline.java'),(607,52953,'Bug 52953 – Unlike BASIC Authentication, DIGEST mode does not work if the hash is stored in uppercase.','','2012-03-21 04:39:32','Neale Rudd','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','ba8a1aa','Mark Emlyn David Thomas','2012-03-21 06:00:52','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52953 When using DIGEST auth, digests are always represented using lower case hex characters','java/org/apache/catalina/realm/RealmBase.java'),(608,52839,'Bug 52839 – New unit test for DigestAuthenticator and SingleSignOn','','2012-03-06 16:12:53','Brian Burch','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','c0f1bb9','Mark Emlyn David Thomas','2012-03-20 17:34:06','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52839 New unit test for DigestAuthenticator and SingleSignOn Patch provided by Brian Burch','test/org/apache/catalina/authenticator/TestSSOnonLoginAndDigestAuthenticator.java'),(609,50860,'Bug 50860 – In case of invalid or empty slqQuery connection are always invalidated without usefull information','The code is (in PooledConnection.java#validate(int validateAction,String sql) )\n        Statement stmt = null;\n        try {\n            stmt = connection.createStatement();\n            stmt.execute(query);\n            stmt.close();\n            this.lastValidated = now;\n            return true;\n        } catch (Exception ignore) {\n            if (log.isDebugEnabled())\n                log.debug(\"Unable to validate object:\",ignore);\n            if (stmt!=null)\n                try { stmt.close();} catch (Exception ignore2){/*NOOP*/}\n        }\n        return false;\n\nSo in the case of null or invalid query (connection is always invalidated : seems normal :-) ).\nBut without any usefull message (except if you use debug : but seems complicated in a production env).\nSo IMHO adding a log.warning in case of null query could be usefull.','2011-03-03 06:51:14','olamy','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','e092870','Filip Hanik','2012-03-20 13:32:47','https://issues.apache.org/bugzilla/show_bug.cgi?id=50860 add option to log validation errors','modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/DataSourceProxy.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/PoolConfiguration.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/PoolProperties.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/PooledConnection.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/jmx/ConnectionPool.java'),(610,52518,'Bug 52518 – Documentation enhancements','','2012-01-24 18:54:29','Felix Schumacher','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 trivial','e31cf47','Filip Hanik','2012-03-20 12:48:20','https://issues.apache.org/bugzilla/show_bug.cgi?id=52518','modules/jdbc-pool/doc/jdbc-pool.xml'),(611,51893,'Bug 51893 – JMX notification/Exception for empty/exhausted connection pool','Currently, if there is an error getting a connection from the pool, a generic SQLException is thrown.  The only way to determine if the problem is a result of the connection pool being exhausted is to catch the SQLException and parse the message (i.e. look for \"Pool empty\" in ex.getMessage()).  Would like to see the following:\n\n1) A subclass of SQLException thrown in the case of an empty pool\n2) A JMX notification sent in the case of an empty pool (e.g. [POOL EXHAUSTED])','2011-09-26 14:49:49','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','9d687eb','Filip Hanik','2012-03-20 12:44:17','https://issues.apache.org/bugzilla/show_bug.cgi?id=51893 add notification that the pool has been exhausted','modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/PoolExhaustedException.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/jmx/ConnectionPool.java'),(612,52654,'Bug 52654 – Incomplete documentation about DataSource JMX registration outside a container','','2012-02-13 16:02:13','guenther','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','62386d7','Filip Hanik','2012-03-20 12:24:13','https://issues.apache.org/bugzilla/show_bug.cgi?id=52654','modules/jdbc-pool/doc/jdbc-pool.xml'),(613,52327,'Bug 52327 – DataSourceProxy is not thread-safe','DataSourceProxy is not thread-safe - the poolProperties field is mutable, but access is not synchronised, and the field is not volatiel.\n\nSo changes to the field are not guaranteed to be published to all threads.','2011-12-14 09:11:15','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','655fcc3','Filip Hanik','2012-03-20 12:16:00','https://issues.apache.org/bugzilla/show_bug.cgi?id=52327','modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/DataSourceProxy.java'),(614,52327,'Bug 52327 – DataSourceProxy is not thread-safe','DataSourceProxy is not thread-safe - the poolProperties field is mutable, but access is not synchronised, and the field is not volatiel.\n\nSo changes to the field are not guaranteed to be published to all threads.','2011-12-14 09:11:15','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','730939b','Filip Hanik','2012-03-20 12:14:07','https://issues.apache.org/bugzilla/show_bug.cgi?id=52327','modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/DataSourceProxy.java'),(615,52002,'Bug 52002 – Pool re-opens and re-issues closed connection','','2011-10-10 13:42:25','Kevin Greiner','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','24a0488','Filip Hanik','2012-03-20 11:45:19','https://issues.apache.org/bugzilla/show_bug.cgi?id=52002 add in ability to configure pool so that connections can not be reused','modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/DataSourceProxy.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/DisposableConnectionFacade.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/JdbcInterceptor.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/PoolConfiguration.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/PoolProperties.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/jmx/ConnectionPool.java\nmodules/jdbc-pool/src/test/java/org/apache/tomcat/jdbc/test/MultipleCloseTest.java'),(616,51237,'Bug 51237 – SlowQueryReport interceptor does not log anything','','2011-05-20 22:01:35','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','0eb38b8','Filip Hanik','2012-03-20 10:02:18','fix bug https://issues.apache.org/bugzilla/show_bug.cgi?id=51237 align implementation with the documentation','modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/interceptor/SlowQueryReport.java'),(617,52926,'Bug 52926 – NPE in processSocket','We have sporadic issues triggering 502 proxy errors using the NIO connector behind Nginx, caused by dropped connections/end of streams in Tomcat. The Tomcat log shows:\n\nSEVERE: Error allocating socket processor\njava.lang.NullPointerException \nat org.apache.tomcat.util.net.NioEndpoint.processSocket(NioEndpoint.java:721)\nat org.apache.tomcat.util.net.NioEndpoint$Poller.cancelledKey(NioEndpoint.java:1048)\nat org.apache.tomcat.util.net.NioEndpoint$Poller.timeout(NioEndpoint.java:1392)\nat org.apache.tomcat.util.net.NioEndpoint$Poller.run(NioEndpoint.java:1174)\nat java.lang.Thread.run(Thread.java:662)\n\nLooking at the code in processSocket I see the line in NioEndpoint(721): \nattachment.setCometNotify(false); //will get reset upon next reg\n\nAttachment is fetched in line 720:\nKeyAttachment attachment = (KeyAttachment)socket.getAttachment(false);\n\nLooking at socket.getAttachement() method I see that this method is indeed capable of returning null, but no null-check for this is done (although it is in multiple other locations, so it seems inconsistent).','2012-03-16 08:19:25','Morten Haraldsen','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 critical','dcb8808','Mark Emlyn David Thomas','2012-03-20 07:07:21','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52926 Protect against a NPE if the socket has been closed on another thread','java/org/apache/tomcat/util/net/NioEndpoint.java'),(618,52858,'Bug 52858 – High CPU load in the NIO connector, when a client breaks connection unexpectedly','','2012-03-08 15:06:51','Dmitry Kukushkin','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 major','3c5c41e','Mark Emlyn David Thomas','2012-03-15 08:07:52','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52858 Fix high CPU load caused by tight(ish) loop when client doesn\'t read any data','java/org/apache/tomcat/util/net/NioEndpoint.java'),(619,52811,'Bug 52811 – HttpServletResponse.setContentType() parses the content type incorrectly','When creating the HttpServletResponse the setContentType(type) is used for setting the content type and character encoding.\nIf the type is for example:\n\nmultipart/related;boundary=1_4F50BD36_CDF8C28;Start=\"<31671603.smil>\";Type=\"application/smil;charset=UTF-8\"\n\nit is parsed and the content type is set to:\n\nmultipart/related;boundary=1_4F50BD36_CDF8C28;Start=\"<31671603.smil>\";Type=\"application/smil\n\nand character encoding to:\n\nUTF-8\n\nI believe it is incorrect, the content type should be:\n\nmultipart/related;boundary=1_4F50BD36_CDF8C28;Start=\"<31671603.smil>\";Type=\"application/smil;charset=UTF-8\"\n\nand the character encoding should be set to default (ISO-8859-1).','2012-03-02 12:56:46','Martin Havel','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Servlet & JSP API','P2 normal','e4b0347','Mark Emlyn David Thomas','2012-03-13 10:41:27','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52811 Make use of the newly added HttpParser to correctly process Content-Type headers As well as the problem identified in the bug report, this fixes a couple of related issues: - setting the content type via (set|add)Header bypassed some checks - avoids parsing the content-type header multiple times','java/org/apache/catalina/connector/Response.java\ntest/org/apache/catalina/connector/TestResponse.java'),(620,52811,'Bug 52811 – HttpServletResponse.setContentType() parses the content type incorrectly','When creating the HttpServletResponse the setContentType(type) is used for setting the content type and character encoding.\nIf the type is for example:\n\nmultipart/related;boundary=1_4F50BD36_CDF8C28;Start=\"<31671603.smil>\";Type=\"application/smil;charset=UTF-8\"\n\nit is parsed and the content type is set to:\n\nmultipart/related;boundary=1_4F50BD36_CDF8C28;Start=\"<31671603.smil>\";Type=\"application/smil\n\nand character encoding to:\n\nUTF-8\n\nI believe it is incorrect, the content type should be:\n\nmultipart/related;boundary=1_4F50BD36_CDF8C28;Start=\"<31671603.smil>\";Type=\"application/smil;charset=UTF-8\"\n\nand the character encoding should be set to default (ISO-8859-1).','2012-03-02 12:56:46','Martin Havel','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Servlet & JSP API','P2 normal','8e8701c','Mark Emlyn David Thomas','2012-03-13 10:39:24','Add an HTTP header parser. The driver for this was an attempt to fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52811','.gitignore\nbuild.xml\njava/org/apache/coyote/Response.java\njava/org/apache/tomcat/util/http/parser/AstAttribute.java\njava/org/apache/tomcat/util/http/parser/AstMediaType.java\njava/org/apache/tomcat/util/http/parser/AstParameter.java\njava/org/apache/tomcat/util/http/parser/AstSubType.java\njava/org/apache/tomcat/util/http/parser/AstType.java\njava/org/apache/tomcat/util/http/parser/AstValue.java\njava/org/apache/tomcat/util/http/parser/HttpParser.java\njava/org/apache/tomcat/util/http/parser/HttpParser.jjt\njava/org/apache/tomcat/util/http/parser/HttpParserConstants.java\njava/org/apache/tomcat/util/http/parser/HttpParserTokenManager.java\njava/org/apache/tomcat/util/http/parser/HttpParserTreeConstants.java\njava/org/apache/tomcat/util/http/parser/JJTHttpParserState.java\njava/org/apache/tomcat/util/http/parser/Node.java\njava/org/apache/tomcat/util/http/parser/ParseException.java\njava/org/apache/tomcat/util/http/parser/SimpleCharStream.java\njava/org/apache/tomcat/util/http/parser/SimpleNode.java\njava/org/apache/tomcat/util/http/parser/Token.java\njava/org/apache/tomcat/util/http/parser/TokenMgrError.java\ntest/org/apache/tomcat/util/http/parser/TestMediaType.java'),(621,52723,'Bug 52723 – An incomplete fix for the resource leak bugs in StandardManager.java','','2012-02-21 10:22:02','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED WONTFIX','Tomcat 6','Catalina','P2 trivial','9f8c8d6','Mark Emlyn David Thomas','2012-03-09 15:32:50','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52723 Clean-up','java/org/apache/catalina/session/StandardManager.java'),(622,52850,'Bug 52850 – Various miscellaneous fixes to Tomcat Memory Leak Detection code','Problem Description - \n----------------------\nTomcat memory leak detection has the following issues\n- Most of the detection and fixing code has been tested ONLY on Sun JVMs. A lot of  the reflection based code does not work with the IBM JDK. \n- Tests in tomcat7.source\\test\\org\\apache\\catalina\\loader do not seem to run successfully and are incomplete for all the protection that Tomcat provides for classloader memory leaks.\n- For some categories of threadlocal memory leaks the key and value are not displayed correctly in the warning messages; particularly ones dealing with indirect references to threadlocals\n-  org.apache.catalina.loader.WebappClassLoader.loadedByThisOrChild(Object) incorrectly traverses the object classloader hierarchy instead of the current (this) classloader hierarchy\n\nProblem Conclusion - \n--------------------\n- After extensive testing with the IBM JDKs, I have cleaned up and sanitized some of the reflection code to stop executors, timers, threads etc on the IBM JDK\n- Added new tests for detecting threadlocal leaks and thread leaks\n- Better ThreadLocal leak reporting with corrected loadedByThisOrChild method and addition of expungeStaleEntries method\n- Make code more resilient in certain leak detection scenarios.','2012-03-07 14:57:15','Rohit Kelapure','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','adbf442','Mark Emlyn David Thomas','2012-03-09 14:08:49','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52850 Enable the memoey leak protection code to play nicely with IBM JVMs as well as Oracle JVMs. Extend test case coverage of memory leak protection. Patch provided by Rohit Kelapure.','java/org/apache/catalina/loader/WebappClassLoader.java\ntest/org/apache/catalina/loader/TestWebappClassLoaderExecutorMemoryLeak.java\ntest/org/apache/catalina/loader/TestWebappClassLoaderThreadLocalMemoryLeak.java'),(623,52776,'Bug 52776 – Generator\'s JspFragment.invoke implementation does not reset ELContext[JspContext.class]','If a developer captures a JspFragment themselves and calls invoke on it, the JspContext.class attribute in the enclosing pageContext\'s ELContext is set by the generated JspFragment subclass, but not reset to its original value afterwards. Therefore after invoking a JspContext any EL expressions will be searching the wrong jspContext for attribute values.\n\norg.apache.jasper.compiler.Generator is responsible for creating the JspFragment subclass to represent the compiled fragment. The generatePostamble() method emits generated code to set the JspContext attribute in the ELContext:\n\nout.printil(\"this.jspContext.getELContext().putContext(javax.servlet.jsp.JspContext.class,this.jspContext);\");\n\nHowever it doesn\'t later put back the original value.\n\nIf you are using the <jsp:invoke> tag to invoke the fragment (which is undoubtedly what most people are doing) then the code generated by visit(Node.InvokeAction n) in Generator explicitly restores the EL context:\n\nout.printil(\"jspContext.getELContext().putContext(javax.servlet.jsp.JspContext.class,getJspContext());\");\n\nHowever if you call invoke(Writer) on the JspFragment yourself you don\'t get that tidy up code.\n\nI suggest the resolution is to have the JspFragment.invoke method tidy up after itself. It \"puts\" the change to the JspContext.class attribute so it should also re\"put\" it. Then there shouldn\'t be any need to restore the EL context in the generated <jsp:invoke> code.\n\nI have tested this solution successfully.','2012-02-27 00:46:22','Karl von Randow','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','faf26da','Mark Emlyn David Thomas','2012-03-09 06:51:42','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52776 Refactor the code so JspFragment.invoke cleans up after itself. Patch provided by Karl von Randow.','java/org/apache/jasper/compiler/Generator.java'),(624,52830,'Bug 52830 – DataSource JNDI lookup with javax.naming.Name failed','','2012-03-05 15:25:49','moogle','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','d7606c9','Mark Emlyn David Thomas','2012-03-08 17:36:04','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52830 Align parseName(Name) with parseName(String) so both have the same behaviour','java/org/apache/naming/SelectorContext.java'),(625,52830,'Bug 52830 – DataSource JNDI lookup with javax.naming.Name failed','','2012-03-05 15:25:49','moogle','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','0616262','Mark Emlyn David Thomas','2012-03-08 17:35:55','Add test case for BZ 52830','test/org/apache/naming/resources/TestNamingContext.java'),(626,52500,'Bug 52500 – Improve client certificate authentication','','2012-01-23 13:02:04','Michael','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','401c703','Christopher Schultz','2012-03-08 12:22:29','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52500 Added configurable mechanism to retrieve user names from X509 client certificates. Based on a patch provided by Michael Furman.','java/org/apache/catalina/realm/LocalStrings.properties\njava/org/apache/catalina/realm/RealmBase.java\njava/org/apache/catalina/realm/X509SubjectDnRetriever.java\njava/org/apache/catalina/realm/X509UsernameRetriever.java\nwebapps/docs/config/realm.xml'),(627,52719,'Bug 52719 – An incomplete fix for the resource leak bug in WebappClassLoader.java','','2012-02-21 09:37:53','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 trivial','78c02a7','Mark Emlyn David Thomas','2012-03-07 16:45:27','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52719 Correct theoretical resource leak during Jar validation','java/org/apache/catalina/loader/WebappClassLoader.java'),(628,52792,'Bug 52792 – Incomplete error message when lookup a resource that is not bound in the naming','','2012-02-28 20:30:12','Violeta Georgieva','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 trivial','7cec4ff','Mark Emlyn David Thomas','2012-03-07 16:11:01','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52792 More informative error message when something in JNDI can\'t be found.','java/org/apache/naming/LocalStrings.properties\njava/org/apache/naming/NamingContext.java'),(629,52772,'Bug 52772 – JspC : checking uriRoot option validness','In org.apache.jasper.JspC#execute() method,\nif uriRoot is not null,\nit scans all jsp files under uriRoot,\nand then checks if uriRoot is a directory.\n\nIt should be more desirable to check if uriRoot is a directory or not first and then scanning it.\n\n\nHere are my suggestion.\n\n            if (uriRoot == null) {\n                throw new JasperException(\n                    Localizer.getMessage(\"jsp.error.jspc.no_uriroot\"));\n            }\n\n            File uriRootF = new File(uriRoot);\n            if (!uriRootF.exists() || !uriRootF.isDirectory()) {\n                throw new JasperException(\n                    Localizer.getMessage(\"jsp.error.jspc.uriroot_not_dir\"));\n            }\n\n            if( context==null ) {\n                initServletContext();\n            }\n\n            // No explicit pages, we\'ll process all .jsp in the webapp\n            if (pages.size() == 0) {\n                scanFiles(uriRootF);\n            }','2012-02-26 07:41:43','Eugene Chung (TmaxSoft)','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 trivial','35958df','Mark Emlyn David Thomas','2012-03-07 10:09:07','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52772 Re-order checks for uriRoot validity and ensure that all the checks are completed before it is used.','java/org/apache/jasper/JspC.java'),(630,52770,'Bug 52770 – Potential Bug or Inconsistency in NioBlockingSelector.java','This is Ken Cheung, a Computer Science M.Phil. student. I observed some\ncode clones in Tomcat and found inconsistent code:\n\n/tomcat/trunk/java/org/apache/tomcat/util/net/NioBlockingSelector.java\n\n103	                try {\n104	                    if ( att.getWriteLatch()==null || att.getWriteLatch().getCount()==0) att.startWriteLatch(1);\n105	                    poller.add(att,SelectionKey.OP_WRITE,reference);\n106	                    att.awaitWriteLatch(writeTimeout,TimeUnit.MILLISECONDS);\n107	                }catch (InterruptedException ignore) {\n108	                    Thread.interrupted();\n109	                }\n110	                if ( att.getWriteLatch()!=null && att.getWriteLatch().getCount()> 0) {\n111	                    //we got interrupted, but we haven\'t received notification from the poller.\n112	                    keycount = 0;\n113	                }else {\n114	                    //latch countdown has happened\n115	                    keycount = 1;\n116	                    att.resetWriteLatch();\n117	                }\n118	\n119	                if (writeTimeout > 0 && (keycount == 0))\n120	                    timedout = (System.currentTimeMillis() - time) >= writeTimeout;\n\n/tomcat/trunk/java/org/apache/tomcat/util/net/NioBlockingSelector.java\n\n164	                try {\n165	                    if ( att.getReadLatch()==null || att.getReadLatch().getCount()==0) att.startReadLatch(1);\n166	                    poller.add(att,SelectionKey.OP_READ, reference);\n167	                    if (readTimeout < 0) {\n168	                        att.awaitReadLatch(Long.MAX_VALUE, TimeUnit.MILLISECONDS);\n169	                    } else {\n170	                        att.awaitReadLatch(readTimeout, TimeUnit.MILLISECONDS);\n171	                    }\n172	                }catch (InterruptedException ignore) {\n173	                    Thread.interrupted();\n174	                }\n175	                if ( att.getReadLatch()!=null && att.getReadLatch().getCount()> 0) {\n176	                    //we got interrupted, but we haven\'t received notification from the poller.\n177	                    keycount = 0;\n178	                }else {\n179	                    //latch countdown has happened\n180	                    keycount = 1;\n181	                    att.resetReadLatch();\n182	                }\n183	                if (readTimeout >= 0 && (keycount == 0))\n184	                    timedout = (System.currentTimeMillis() - time) >= readTimeout;\n\nQuick description of the inconsistency\nTwo code snippets are very similar code, but as you see, the first code does not check \"if (readTimeout < 0)\" while the second code has the checker.\n\nWe thought it could be a potential bug or inconsistency. Hope this helps.','2012-02-25 15:04:31','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','4f75b2d','Mark Emlyn David Thomas','2012-03-07 09:34:59','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52770 Fixes very rarely (if ever) used infinite timeouts on write','java/org/apache/tomcat/util/net/NioBlockingSelector.java'),(631,52767,'Bug 52767 – Potential Bug or Inconsistency in JDBCRealm.java and JDBCAccessLogValve.java','This is Ken Cheung, a Computer Science M.Phil. student. I observed some\ncode clones in Tomcat and found inconsistent code:\n\n/tomcat/trunk/java/org/apache/catalina/realm/JDBCRealm.java\n\n676	        if (driver == null) {\n677	            try {\n678	                Class<?> clazz = Class.forName(driverName);\n679	                driver = (Driver) clazz.newInstance();\n680	            } catch (Throwable e) {\n681	                ExceptionUtils.handleThrowable(e);\n682	                throw new SQLException(e.getMessage(), e);\n683	            }\n684	        }\n685	\n686	        // Open a new connection\n687	        Properties props = new Properties();\n688	        if (connectionName != null)\n689	            props.put(\"user\", connectionName);\n690	        if (connectionPassword != null)\n691	            props.put(\"password\", connectionPassword);\n692	        dbConnection = driver.connect(connectionURL, props);\n\n/tomcat/trunk/java/org/apache/catalina/valves/JDBCAccessLogValve.java\n\n566	        if (driver == null) {\n567	            try {\n568	                Class<?> clazz = Class.forName(driverName);\n569	                driver = (Driver) clazz.newInstance();\n570	            } catch (Throwable e) {\n571	                ExceptionUtils.handleThrowable(e);\n572	                throw new SQLException(e.getMessage(), e);\n573	            }\n574	        }\n575	\n576	        // Open a new connection\n577	        Properties props = new Properties();\n578	        props.put(\"autoReconnect\", \"true\");\n579	        if (connectionName != null) {\n580	            props.put(\"user\", connectionName);\n581	        }\n582	        if (connectionPassword != null) {\n583	            props.put(\"password\", connectionPassword);\n584	        }\n585	        conn = driver.connect(connectionURL, props);\n\nQuick description of the inconsistency\nTwo code snippets are very similar code, but as you see, in JDBCRealm.java does not use \"props.put(\"autoReconnect\", \"true\")\" while JDBCAccessLogValve.java has.\n\nWe thought it could be a potential bug or inconsistency. Hope this helps.','2012-02-25 14:32:33','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','1f4663d','Mark Emlyn David Thomas','2012-03-07 08:24:45','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52767 Remoev reference to MySQL specific autoReconnect property','java/org/apache/catalina/valves/JDBCAccessLogValve.java\nwebapps/docs/changelog.xml'),(632,52846,'Bug 52846 – Programmatic login using UserDatabaseRealm returns 403 error.','IMHO,HttpServletRequest#login does not need to define a <login-config>.\nNonLoginAuthenticator is used when <login-config> is not specified in HttpServletRequest#login. \n\nWhen UserDatabaseRealm is used, not GenericPrincipal but Memory User is set to a session.\nIn AuthenticatorBase#invoke, principal registered into a session is set to a request. \nBecause MemoryUser is set to a request as principal, RealmBase#hasRole always returns false. \nAs a result, 403 error is returned.','2012-03-07 08:40:46','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','a01418d','Keiichi Fujino','2012-03-07 04:20:48','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52846.','java/org/apache/catalina/authenticator/NonLoginAuthenticator.java'),(633,52842,'Bug 52842 – MBeanDumper dumpBeans SEVERE: Error getting attribute while using JMXProxy servlet','','2012-03-06 23:33:46','Jonathan Hodges','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Manager','P2 minor','c19bbd5','Rainer Jung','2012-03-06 20:02:28','BZ 52842: Exception in MBeanDumper.','java/org/apache/catalina/core/mbeans-descriptors.xml'),(634,52732,'Bug 52732 – An incomplete fix for the resource leak bug in ExpressionFactory.java','','2012-02-21 12:22:44','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Integration','P2 enhancement','6399c83','Mark Emlyn David Thomas','2012-03-06 17:56:31','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52732 Clean-up code. Fixes potential resource leak although the problems that would trigger the leak are far more serious than the leak.','java/javax/el/ExpressionFactory.java'),(635,52731,'Bug 52731 – An incomplete fix for the resource leak bug in JDTCompiler.java','','2012-02-21 12:16:28','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 enhancement','2b1d195','Mark Emlyn David Thomas','2012-03-06 17:39:33','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52731 Clean-up code. Fixes potential resource leak although the problems that would trigger the leak are far more serious than the leak.','java/org/apache/jasper/compiler/JDTCompiler.java'),(636,52729,'Bug 52729 – An incomplete fix for the resource leak bug in CometConnectionManagerValve.java','','2012-02-21 12:01:25','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','683d5c1','Mark Emlyn David Thomas','2012-03-06 16:26:11','https://issues.apache.org/bugzilla/show_bug.cgi?id=52729 Even if the end event fails, try and perform the close.','java/org/apache/catalina/valves/CometConnectionManagerValve.java'),(637,52727,'Bug 52727 – An incomplete fix for the resource leak bug in HostConfig.java','','2012-02-21 11:58:35','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','8293a6e','Mark Emlyn David Thomas','2012-03-06 16:15:26','https://issues.apache.org/bugzilla/show_bug.cgi?id=52727 Code clean-up','java/org/apache/catalina/startup/HostConfig.java'),(638,52726,'Bug 52726 – An incomplete fix for the resource leak bug in MemoryUserDatabase.java','','2012-02-21 11:50:36','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 critical','a30ce07','Mark Emlyn David Thomas','2012-03-06 15:56:10','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52726 Clean-up. Avoid unlikely fd leak.','java/org/apache/catalina/users/MemoryUserDatabase.java'),(639,52725,'Bug 52725 – org.apache.jasper.compiler.JspUtil#getTagHandlerClassName() does not use org.apache.jasper.Constants.TAG_FILE_PACKAGE_NAME','In the class org.apache.jasper.compiler.JspUtil, its method \n\n    public static String getTagHandlerClassName(String path, String urn,\n            ErrorDispatcher err) throws JasperException {\n        ...\n    }\n\nuses the string constants directly like \"org.apache.jsp.tag.web.\", \"org.apache.jsp.tag.meta.\".\n\nBut you know there is TAG_FILE_PACKAGE_NAME field in the class org.apache.jasper.Constants.\n\n\nThe code should be adjusted like below :\n\nConstants.TAG_FILE_PACKAGE_NAME + \".web\"\nConstants.TAG_FILE_PACKAGE_NAME + \".meta\"','2012-02-21 11:28:46','Eugene Chung (TmaxSoft)','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','bf0287e','Mark Emlyn David Thomas','2012-03-05 15:20:00','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52725 Use constant rather than hard-coded package name since package name is meant to be configurable.','java/org/apache/jasper/compiler/JspUtil.java'),(640,52724,'Bug 52724 – An incomplete fix for the resource leak bugs in Catalina.java','','2012-02-21 10:35:32','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','7c51f61','Mark Emlyn David Thomas','2012-03-05 15:10:32','Code clean-up. Add some finally blocks to close resources. Not really necessary since JVM is shutting down. BZ 52724.','java/org/apache/catalina/startup/Catalina.java'),(641,51197,'Bug 51197 – sendError/sendRedirect don\'t work with AsyncContext','','2011-05-13 12:50:26','Dan Checkoway','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 major','2d30290','Mark Emlyn David Thomas','2012-03-05 07:05:25','Further fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=51197 Allow the ErrorReportValve to write a response body if sendError() is called during an async request if it is being handled on a container thread. As per SRV 10.9.2, if an error occurs during an async request on an application thread, writing the response body - if any - is entirely an application responsibility.','java/org/apache/catalina/valves/ErrorReportValve.java\ntest/org/apache/catalina/core/TestAsyncContextImpl.java'),(642,52804,'Bug 52804 – Make PoolProperties implement Cloneable.','It would be very useful to have the PoolProperties class implement the java.lang.Cloneable interface. \n\nWe have many databases that share the same schema, username, password, configuration etc but differ only in their URL. Implementing a routing datasource based on something like org.springframework.jdbc.datasource.AbstractDataSource can then just clone a PoolProperties object and set the one or two properties that differ in the clone. In a spring project the properties that are common across all the datasources are only supplied once.','2012-03-01 17:18:03','Colin McFarlane','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 enhancement','55baca6','Filip Hanik','2012-03-01 15:15:24','https://issues.apache.org/bugzilla/show_bug.cgi?id=52804 Implement useful interfaces for storing and copying the properties','modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/PoolProperties.java'),(643,52760,'Bug 52760 – Mime type for javascript incorrect  in documentation','','2012-02-24 13:35:39','Chris Barran','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 normal','833e6b1','Rainer Jung','2012-02-26 08:29:48','BZ 52760: Fix expires filter mime type in javascript examples.','java/org/apache/catalina/filters/ExpiresFilter.java\nwebapps/docs/config/filter.xml'),(644,52758,'Bug 52758 – Jasper illegally implements org.eclipse.jdt.internal.compiler.env.ICompilationUnit from Eclipse','','2012-02-24 04:21:56','Michael Rennie','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','2e7f5ab','Mark Emlyn David Thomas','2012-02-24 05:04:05','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52758 Implement additional method added to JDT interface but not yet released','java/org/apache/jasper/compiler/JDTCompiler.java'),(645,52671,'Bug 52671 – NIO Connector: Exception invoking method readBufSize / writeBufSize in the JMX Proxy Servlet','','2012-02-15 11:47:03','Sven Woltmann','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 normal','3fe64a5','Mark Emlyn David Thomas','2012-02-15 15:58:16','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52671 Log NPEs for attributes that are not set at debug.','java/org/apache/catalina/mbeans/MBeanDumper.java'),(646,52669,'Bug 52669 – Annotation processing, in WEB-INF/classes, for Servlets/Listeners/Filters is skipped when the web app is not extracted, classes do not have packages and for some embedded scenarios','','2012-02-14 21:39:46','Violeta Georgieva','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','34b1a7e','Mark Emlyn David Thomas','2012-02-15 15:57:36','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52669 Correct regression introduced by the invalid assumptions made in the hack for Eclipse to address https://issues.apache.org/bugzilla/show_bug.cgi?id=51741','java/org/apache/catalina/startup/ContextConfig.java\njava/org/apache/catalina/startup/LocalStrings.properties'),(647,51741,'Bug 51741 – Eclipse WTP \"Serve modules without publishing\" broken with tc7, needs patch in tomcat','','2011-08-29 21:29:56','Sylvain Laurent','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','34b1a7e','Mark Emlyn David Thomas','2012-02-15 15:57:36','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52669 Correct regression introduced by the invalid assumptions made in the hack for Eclipse to address https://issues.apache.org/bugzilla/show_bug.cgi?id=51741','java/org/apache/catalina/startup/ContextConfig.java\njava/org/apache/catalina/startup/LocalStrings.properties'),(648,52666,'Bug 52666 – EL should coerce String to Integer in equals operation','','2012-02-14 12:55:34','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','bf9bf39','Mark Emlyn David Thomas','2012-02-15 11:26:08','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52666 Correct coercion order in EL for A {==,!=,eq,ne} B','java/org/apache/el/lang/ELSupport.java\ntest/org/apache/el/lang/TestELSupport.java'),(649,51582,'Bug 51582 – NPE in SlowQueryReport','java.lang.NullPointerException\n	at java.util.concurrent.ConcurrentHashMap.get(ConcurrentHashMap.java:768)\n	at org.apache.tomcat.jdbc.pool.interceptor.SlowQueryReport.getQueryStats(SlowQueryReport.java:156)\n	at org.apache.tomcat.jdbc.pool.interceptor.SlowQueryReport.reportFailedQuery(SlowQueryReport.java:85)\n	at org.apache.tomcat.jdbc.pool.interceptor.SlowQueryReportJmx.reportFailedQuery(SlowQueryReportJmx.java:147)\n	at org.apache.tomcat.jdbc.pool.interceptor.AbstractQueryReport$StatementProxy.invoke(AbstractQueryReport.java:236)','2011-07-29 08:07:18','Patric Rufflar','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 major','9784a5e','Filip Hanik','2012-02-13 14:07:30','Fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=51582','modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/interceptor/SlowQueryReport.java\nmodules/jdbc-pool/src/test/java/org/apache/tomcat/jdbc/bugs/Bug51582.java\nmodules/jdbc-pool/src/test/java/org/apache/tomcat/jdbc/pool/interceptor/InduceSlowQuery.java'),(650,52641,'Bug 52641 – Remove mentioning of ldap.jar','','2012-02-11 09:34:32','Felix Schumacher','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 trivial','f3fcb1c','Rainer Jung','2012-02-11 06:50:20','BZ 52641: Remove mentioning of ldap.jar','webapps/docs/realm-howto.xml'),(651,52634,'Bug 52634 – Typos in Examples','','2012-02-09 19:08:18','Felix Schumacher','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Examples','P2 trivial','b12ff3f','Rainer Jung','2012-02-09 14:56:54','BZ 52634: Typos in Examples.','webapps/examples/jsp/jsp2/el/implicit-objects.jsp\nwebapps/examples/jsp/tagplugin/howto.html\nwebapps/examples/jsp/tagplugin/notes.html'),(652,52607,'Bug 52607 – It is not well defined how \"Dependencies on extensions\" mechanism can be used in Tomcat','','2012-02-05 22:19:35','Violeta Georgieva','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','4b6d583','Mark Emlyn David Thomas','2012-02-08 16:15:07','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52607 The ExtensionValidator needs to be aware of the classes in the shared and common loaders.','java/org/apache/catalina/core/StandardServer.java\njava/org/apache/catalina/util/ExtensionValidator.java'),(653,52606,'Bug 52606 – FORM authentication POST replay broken for AJP','','2012-02-05 18:10:19','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 regression','6f766be','Mark Emlyn David Thomas','2012-02-08 12:12:08','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52606 Ensure replayed POST bodies are available when using AJP','java/org/apache/coyote/ajp/AbstractAjpProcessor.java'),(654,52591,'Bug 52591 – UnsupportedOperationException logged when fetching BasicDataSource \'loginTimeout\'','With a BasicDataSource configured (using a <Resource>), simply list the available MBeans and this exception will be emitted to stdout:\n\nSEVERE: Error getting attribute Catalina:type=DataSource,context=/context,host=localhost,class=javax.sql.DataSource,name=\"jdbc/myDataSource\" loginTimeout\njavax.management.RuntimeOperationsException: Exception invoking method loginTimeout\n        at org.apache.tomcat.util.modeler.BaseModelMBean.getAttribute(BaseModelMBean.java:197)\n        at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.getAttribute(DefaultMBeanServerInterceptor.java:666)\n        at com.sun.jmx.mbeanserver.JmxMBeanServer.getAttribute(JmxMBeanServer.java:638)\n        at org.apache.catalina.mbeans.MBeanDumper.dumpBeans(MBeanDumper.java:81)\n        at org.apache.catalina.manager.JMXProxyServlet.listBeans(JMXProxyServlet.java:166)\n        at org.apache.catalina.manager.JMXProxyServlet.doGet(JMXProxyServlet.java:121)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:621)\n[...]\nCaused by: java.lang.UnsupportedOperationException: Not supported by BasicDataSource\n        at org.apache.tomcat.dbcp.dbcp.BasicDataSource.getLoginTimeout(BasicDataSource.java:1083)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\n\nThis exception does not cause the request to fail, but definitely puts an ugly stack trace in catalina.out. It might be better to catch UnsupportedOperationException and emit a one-line error message -- one that isn\'t SEVERE.','2012-02-03 14:43:28','Christopher Schultz','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Manager','P2 minor','fbf9166','Mark Emlyn David Thomas','2012-02-08 09:33:23','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52591 Skip attributes where getters throw UnsupportedOperationException','java/org/apache/catalina/mbeans/MBeanDumper.java'),(655,52586,'Bug 52586 – When requests are forwarded, the request attribute javax.servlet.forward.path_info is assigned an incorrect value.','As per the servlet spec, the values for:\n\njavax.servlet.forward.request_uri\njavax.servlet.forward.context\njavax.servlet.forward.servlet_path\njavax.servlet.forward.path_info\njavax.servlet.forward.query_string\n\nMUST be set to the values from the very first servlet that serviced the current request.  However, it seems that Tomcat is populating path_info with the value of the LAST path_info serviced in the request (i.e. the final servlet that serviced the request).  It\'s possible the other value assignments are afflicted by similar defects, I\'ve not explicitly tested for this.\n\nBecause of this issue, it\'s impossible to correctly reconstruct the original request\'s URI piecemeal by concatenating context+servlet_path+path_info+?+query_string, since path_info will contain the path to another servlet and thus this concatenation will produce a probably invalid URI target.\n\nTherefore, creating \"click here to retry\" links is impossible without workaround code.\n\nThe critical issue here is the deviation from the servlet spec, which spells out the behavior of those attributes.','2012-02-02 18:49:59','diego.rivera.cr@gmail.com','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 major','660513c','Mark Emlyn David Thomas','2012-02-05 16:54:30','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52586 Remove hack that changes path info when forwarding to an error page','java/org/apache/catalina/core/StandardHostValve.java'),(656,52577,'Bug 52577 – Response output written in filter can be truncated','Due to changes 1229726, 1229727 and 1229728 output written to response in the filter can be truncated up to 8192 bytes. Consider the following scenario:\n\n- you have a filter that invoke getWriter() before chain.doFilter(request, responseWrapper)\n\n\n- responseWrapper overrides getWriter() method and returns some\n  buffered writer, not the real one\n\n\n- during execution of chain.doFilter there is a forward\n\n\nBefore the forward ApplicationDispather calls resetBuffer on response, which in turn calls reset() on OutputBuffer, which sets gotEnc field to false. This field is initialized in the setConverter() method which is called from response.getWriter(), but since our wrapperResponse overrides getWriter(), OutputBuffer.setConverter() never called and OutputBuffer still has gotEnc = false.\n\n\nResponse\'s close() and flushBuffer() methods call OutputBuffer\'s flush(), but since gotEnc == false, conv.flushBuffer() is not called:\n\n\nif (gotEnc && conv != null) {\n    conv.flushBuffer();\n}\n\n\nA workaround for us is to implement getWriter() method in responseWrapper like this:\n\n\npublic Writer getWriter() {\n  Writer originalWriter = originalResponse.getWriter();//save for future processing\n  return ourWriter;\n}\n\n\nMaybe you should change flushing to something like that:\n\n\nif (conv != null) {\n    conv.flushBuffer();\n}\n\n\nbecause you invoke conv.convert() without any checks in the write*() methods and it seems like conv is never null.','2012-02-02 07:45:44','Dmitry Neverov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','2fd117b','Mark Emlyn David Thomas','2012-02-05 16:12:42','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52577 Only reset the encoder information when the \'has getWriter()\' been called flag is reset. Includes a simple test case','java/org/apache/catalina/connector/OutputBuffer.java\njava/org/apache/catalina/connector/Response.java\ntest/org/apache/catalina/connector/TestOutputBuffer.java'),(657,52587,'Bug 52587 – NPE in authenticator when no realm/resource is defined','When no Realm is available to authenticate against, an NPE is thrown.\n\nSTR:\n\n1. Start with a stock 7.0.25 and modify server.xml:\n2. Comment-out <Resource> in <GlobalNamingResources>\n3. Comment-out <Realm> in <Engine>\n4. Deploy manager app and try to log in\n\njava.lang.NullPointerException\n	org.apache.catalina.realm.RealmBase.authenticate(RealmBase.java:340)\n	org.apache.catalina.authenticator.BasicAuthenticator.authenticate(BasicAuthenticator.java:158)\n	org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:544)\n	org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)\n	org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)\n	org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:987)\n	org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:579)\n	org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1600)\n	java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n	java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n	java.lang.Thread.run(Thread.java:680)\n\n\nClearly, this is a pathological setup, but it might be nice to get a decent error message instead of an NPE.','2012-02-02 20:00:01','Christopher Schultz','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','49a52cb','Mark Emlyn David Thomas','2012-02-05 15:12:26','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52587 Ensure that if it is necessary to fall back to the default NullRealm, the NullRealm instance is created early enough for it to be correctly initialised.','java/org/apache/catalina/core/StandardEngine.java'),(658,52444,'Bug 52444 – Classloading-based ServletContainerInitializer @HandlesTypes processing can result in long startup times','See 52326 for background, noting particularly the following:\n\n\"As long as SCI processing involves expensive classloading, larger applications will suffer from long startup times and thus be encouraged to \"shut off\" this functionality via metadata-complete=\'true\'.\"\n\nThis issue, then, is intended to address classloading-based approach to @HandlesTypes processing by replacing it with something faster and generally less problematic.  ASM would be one way to get it done.','2012-01-09 17:11:12','Chris Beams','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','f4896de','Mark Emlyn David Thomas','2012-01-30 06:14:06','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52444 Remove need to load classes unless they actually match an HandlesTypes entry','java/org/apache/catalina/startup/ContextConfig.java\njava/org/apache/tomcat/util/bcel/classfile/JavaClass.java\ntest/org/apache/catalina/startup/TestContextConfigAnnotation.java'),(659,52547,'Bug 52547 – incorrect byeswritten log after completed async request under http1.0','','2012-01-27 19:43:42','David','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 normal','f2edc92','Mark Emlyn David Thomas','2012-01-28 15:28:18','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52547 Ensure byteCount is reset at the end of a HTTP 1.0 request','java/org/apache/coyote/http11/AbstractOutputBuffer.java'),(660,52543,'Bug 52543 – Exception','SEVERE: Error finishing response\njava.lang.ArrayIndexOutOfBoundsException\n	at java.lang.System.arraycopy(Native Method)\n	at org.apache.coyote.http11.AbstractOutputBuffer.write(AbstractOutputBuffer.java:495)\n	at org.apache.coyote.http11.AbstractOutputBuffer.sendStatus(AbstractOutputBuffer.java:337)\n	at org.apache.coyote.http11.AbstractHttp11Processor.prepareResponse(AbstractHttp11Processor.java:1418)\n	at org.apache.coyote.http11.AbstractHttp11Processor.action(AbstractHttp11Processor.java:756)\n	at org.apache.coyote.Response.action(Response.java:168)\n	at org.apache.coyote.http11.AbstractOutputBuffer.endRequest(AbstractOutputBuffer.java:310)\n	at org.apache.coyote.http11.InternalOutputBuffer.endRequest(InternalOutputBuffer.java:158)\n	at org.apache.coyote.http11.AbstractHttp11Processor.endRequest(AbstractHttp11Processor.java:1586)\n	at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1022)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:579)\n	at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:307)\n	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)\n	at java.lang.Thread.run(Thread.java:722)\n\nbig application i dont know why its happens\nmay be due to the fact that twice as add some cookie','2012-01-27 11:18:09','Evgeny','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','ee0562d','Mark Emlyn David Thomas','2012-01-28 14:40:43','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52543 Provide a meaningful error message when writing more response headers than permitted','java/org/apache/coyote/http11/AbstractOutputBuffer.java\njava/org/apache/coyote/http11/LocalStrings.properties'),(661,52515,'Bug 52515 – Digest auth specifically requires digested passwords to hashed with MD5','','2012-01-24 11:27:38','David Powell','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 normal','f438f51','Mark Emlyn David Thomas','2012-01-27 17:51:08','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52515 Note that DIGEST auth requires MD5 digests','webapps/docs/realm-howto.xml'),(662,52511,'Bug 52511 – Exception logged in annotation scanning for web apps without /WEB-INF/classes','','2012-01-23 21:02:08','Jess Holle','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 regression','3277494','Mark Emlyn David Thomas','2012-01-27 17:06:05','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52511 Don\'t log an exception just because WEB-INF/classes does not exist','java/org/apache/catalina/startup/ContextConfig.java\nwebapps/docs/WEB-INF/web.xml'),(663,52474,'Bug 52474 – Do not load listeners declared with blank spaces on tld file.','','2012-01-17 05:41:49','Helio Frota','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','2dd8a40','Mark Emlyn David Thomas','2012-01-20 16:16:41','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52474 Ensure leading and trailing white space is removed from lister class names extracted from TLD files.','java/org/apache/catalina/startup/TldRuleSet.java'),(664,51408,'Bug 51408 – String.getBytes() and new String(byte[]) use default charset - may cause problems in some Locales','There seem to be rather a lot of instances where Strings and bytes are cconverted using the default charset.\n\nSince the default charset is unknown, its behaviour cannot be relied on.','2011-06-21 15:47:16','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','9722128','Mark Emlyn David Thomas','2012-01-19 10:04:34','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51408 Don\'t use Charset.defaultCharset(). Use ISO-8859-1 charset explicitly.','java/org/apache/catalina/ant/AbstractCatalinaTask.java\njava/org/apache/catalina/authenticator/DigestAuthenticator.java\njava/org/apache/catalina/realm/JNDIRealm.java\njava/org/apache/catalina/realm/RealmBase.java\njava/org/apache/catalina/servlets/WebdavServlet.java\njava/org/apache/catalina/util/RequestUtil.java\njava/org/apache/catalina/valves/AccessLogValve.java\njava/org/apache/catalina/valves/SSLValve.java\njava/org/apache/coyote/http11/filters/BufferedInputFilter.java\njava/org/apache/coyote/http11/filters/ChunkedInputFilter.java\njava/org/apache/coyote/http11/filters/IdentityInputFilter.java\njava/org/apache/coyote/http11/filters/VoidInputFilter.java\njava/org/apache/jasper/Constants.java\njava/org/apache/jasper/compiler/SmapUtil.java\njava/org/apache/naming/resources/Constants.java\njava/org/apache/naming/resources/ProxyDirContext.java\njava/org/apache/tomcat/util/buf/MessageBytes.java'),(665,52480,'Bug 52480 – TC7 + AntCompiler problems with whitespace in pathname','','2012-01-18 00:28:00','ekp','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 major','b553519','Mark Emlyn David Thomas','2012-01-18 06:51:53','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52480 When converting class path entries from URLs to files/directories, ensure that any URL encoded characters are converted. Fixes JSP compilation with javac when Tomcat is installed at a path that includes spaces.','java/org/apache/catalina/loader/WebappLoader.java'),(666,38216,'Bug 38216 – Extend Jmxproxy to allow call of MBean Operations','Currently one can only query Beans or set/get Attributes of them. It would be\ngood if a certain operation of a MBean could be called by the Jmxproxy Servlet.','2006-01-10 18:01:22','Christopher Hlubek','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Manager','P2 enhancement','bd478e5','Mark Emlyn David Thomas','2012-01-15 16:37:18','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=38216 Add the ability to invoke MBean operations through the JMXProxy Based on a patch by Christopher Hlubek Also improved error reporting to help debugging.','java/org/apache/catalina/manager/JMXProxyServlet.java\nwebapps/docs/manager-howto.xml'),(667,52461,'Bug 52461 – java.lang.IllegalArgumentException: URI scheme is not \"file\" is thrown in ContextConfig.getDefaultWebXmlFragment','','2012-01-12 20:34:28','Violeta Georgieva','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','53615e5','Mark Emlyn David Thomas','2012-01-13 15:45:16','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52461 Don\'t assume file based URLs when checking last modified times for global and host level web.xml files Patch provided by violetagg','java/org/apache/catalina/startup/ContextConfig.java'),(668,52445,'Bug 52445 – Methodexpression with arguments fails on nested properties','','2012-01-10 03:25:21','balusc','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 normal','3c8f40f','Mark Emlyn David Thomas','2012-01-13 15:29:13','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52445 Do not assume method expressions have exactly three elements Includes a test case','java/org/apache/el/parser/AstValue.java\ntest/org/apache/el/TestMethodExpressionImpl.java'),(669,52443,'Bug 52443 – Tomcat#defaultRealm shares Realm instance between web applications, resulting in INFO log message from lifecycle','','2012-01-09 16:43:35','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','c38ed95','Mark Emlyn David Thomas','2012-01-12 15:35:19','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52443 Move the default Realm for the embedded case to the Engine','java/org/apache/catalina/startup/Tomcat.java\ntest/org/apache/catalina/mbeans/TestRegistration.java'),(670,52245,'Bug 52245 – Add detection of EL Jar to WebappClassLoader','The EL API is not currently detected by the code in WebappClassLoader.\nApplications containing el-api.jar will not start.\n\n(patch to follow).','2011-11-25 15:13:41','Pid','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','ee2a461','Mark Emlyn David Thomas','2012-01-12 14:47:52','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52245 Don\'t allow webapps to package javax.el classes','java/org/apache/catalina/loader/WebappClassLoader.java'),(671,52440,'Bug 52440 – Wrong getValueReference behaviour with Facelets parameter expressions','ValueExpression method getValueReference should return base object and property. But it returns null if ValueExpression is Facelets parameter.\nExample:\n\nsomeVar = #{concreteObject.property}\n\nValueExpression for #{someVar} return null from method getValueReference (guess because it is simple expression #{someVar}), but logicaly it should return parent expressions ValueReference (need hierachical ValueReference lookup).\n\nI made workaround with Java Reflect API in my code and it illustrates problem:\n\nELContext elContext = FacesContext.getCurrentInstance().getELContext();\nValueReference reference = exp.getValueReference(elContext);\n        \nif (reference == null && exp instanceof TagValueExpressionUEL) {\n	ValueExpressionImpl origExp = (ValueExpressionImpl) ((TagValueExpressionUEL) exp).getWrapped();\n            \n	// TODO: JR: find better way to get base and property. ! Code is not portable because uses Tomcat EL implementation details. ! \n	Field field = ReflectionUtils.findField(origExp.getClass(), EL_IMPL_VAR_PROPERTY);\n	field.setAccessible(true);\n	VariableMapper varMapper = (VariableMapper) ReflectionUtils.getField(field, origExp);\n    field = ReflectionUtils.findField(origExp.getClass(), EL_IMPL_NODE_PROPERTY);\n    field.setAccessible(true);\n    SimpleNode node = (SimpleNode) ReflectionUtils.getField(field, origExp);\n\n    if (varMapper != null && node != null) {\n		ValueExpression parentExp = varMapper.resolveVariable(node.getImage());\n        if (parentExp != null) {\n			try {\n				reference = parentExp.getValueReference(elContext);\n\n                if (reference == null) {\n					reference = getValueReference(parentExp);\n                }\n            } catch (PropertyNotFoundException e) {\n				LOG.warn(\"Property not found: \" + e.getMessage());\n            }\n        }\n    }\n}','2012-01-09 09:11:20','JustasR','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 normal','f277b14','Mark Emlyn David Thomas','2012-01-12 14:33:17','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52440 Need to resolve EL variables when returning ValueReferences Includes a new test case.','java/org/apache/el/parser/AstIdentifier.java\ntest/org/apache/el/TestValueExpressionImpl.java'),(672,52328,'Bug 52328 – Massive garbage production observed when using the response writer','In our application we used to use Tomcat 5, by writing our content directly to the response writer in our servlet:\n\nWriter w = response.getWriter();\nw.append(...)\n\n\nWe have regularly measured performance of our application under stress with multiple simultaneous requests per second.\n\nWe recently upgraded to Tomcat 7, and immediately observed a performance degradation of 10% on the request roundtrip on the same machine and the same tests, compared to our application deployed on Tomcat 5.\n\nProfiling with JProfiler showed that we got massive amount of transient objects {{java.nio.HeapCharBuffer}} produced - 400Mb+ within a few minutes.\n\nThe way we are writing the response is by multiple statements of {{append}} of small strings or single chars, which used to work properly. For experiment, we wrapped the response writer with a {{BufferedWriter}} with a buffer of 64k. This brought our application\'s performance back to normal.\n\nWe see this as either a:\n- anti-pattern usage since Tomcat 6/7, in which case please provide some documentation about that.\n- bug in the C2BConverter that is applied per every call to the CoyoteWriter write methods, which generates the garbage buffers per every call.\n\nWe know that the response stream has a 8k buffer by default. Nevertheless, this buffer comes after the encoding step and as such it is too late to help with the garbage. Perhaps Tomcat can buffer before it encodes?\n\nStill, so much transient objects for just a pattern of eligible use of the servlet API seems a bug to me.','2011-12-14 11:03:38','Nikolay Diakov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 regression','9c7ec4c','Mark Emlyn David Thomas','2012-01-10 15:59:27','First pass at a fix for BZ 52328','java/org/apache/catalina/connector/OutputBuffer.java'),(673,52237,'Bug 52237 – build.xml file improvement to allow not just plaintext junit logs.','','2011-11-24 11:30:21','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Packaging','P2 normal','391089a','Konstantin Kolinko','2012-01-09 14:17:34','Further improve Fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=52237 Make \"usefile\" flag of junit formatter configurable as well. The default value is \"true\".','build.xml'),(674,52405,'Bug 52405 – Update to Servlet 3.0 Rev A','','2011-12-31 14:20:25','Mark Thomas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 normal','3ea93af','Mark Emlyn David Thomas','2012-01-02 16:33:03','https://issues.apache.org/bugzilla/show_bug.cgi?id=52405 Servlet 3.0 Rev A updates Item 20 of 20 Ensure underlying collections are immutable','java/javax/servlet/ServletSecurityElement.java'),(675,52405,'Bug 52405 – Update to Servlet 3.0 Rev A','','2011-12-31 14:20:25','Mark Thomas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 normal','e276239','Mark Emlyn David Thomas','2012-01-02 15:42:11','https://issues.apache.org/bugzilla/show_bug.cgi?id=52405 Servlet 3.0 Rev A updates Item 13 of 20 Injection targets are now always merged','java/org/apache/catalina/deploy/WebXml.java'),(676,52405,'Bug 52405 – Update to Servlet 3.0 Rev A','','2011-12-31 14:20:25','Mark Thomas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 normal','8c501e1','Mark Emlyn David Thomas','2012-01-02 15:15:31','https://issues.apache.org/bugzilla/show_bug.cgi?id=52405 Servlet 3.0 Rev A updates Item 12 of 20 Identical resources in fragments are retained','java/org/apache/catalina/deploy/WebXml.java'),(677,52405,'Bug 52405 – Update to Servlet 3.0 Rev A','','2011-12-31 14:20:25','Mark Thomas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 normal','6c17007','Mark Emlyn David Thomas','2011-12-31 17:29:36','https://issues.apache.org/bugzilla/show_bug.cgi?id=52405 Servlet 3.0 Rev A updates Item 5 of 20 Tighter control of web.xml elements (name, ordering, absolute-ordering)','java/org/apache/catalina/startup/LocalStrings.properties\njava/org/apache/catalina/startup/WebRuleSet.java\ntest/org/apache/catalina/startup/TestWebRuleSet.java\ntest/org/apache/catalina/startup/web-1ordering.xml\ntest/org/apache/catalina/startup/web-2ordering.xml\ntest/org/apache/catalina/startup/web-fragment-1name.xml\ntest/org/apache/catalina/startup/web-fragment-1ordering.xml\ntest/org/apache/catalina/startup/web-fragment-2name.xml\ntest/org/apache/catalina/startup/web-fragment-2ordering.xml'),(678,52405,'Bug 52405 – Update to Servlet 3.0 Rev A','','2011-12-31 14:20:25','Mark Thomas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 normal','bc8f9d6','Mark Emlyn David Thomas','2011-12-31 13:28:41','https://issues.apache.org/bugzilla/show_bug.cgi?id=52405 Servlet 3.0 Rev A updates Item 2 of 20 javax.servlet.annotation.MultipartConfig.location may be relative and if it is, it is relatve to TEMPDIR','java/org/apache/catalina/connector/Request.java'),(679,52405,'Bug 52405 – Update to Servlet 3.0 Rev A','','2011-12-31 14:20:25','Mark Thomas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 normal','1911c81','Mark Emlyn David Thomas','2011-12-31 13:28:31','https://issues.apache.org/bugzilla/show_bug.cgi?id=52405 Servlet 3.0 Rev A updates Item 3 of 20 maxActiveInterval <= 0 means never expire - previously 0 meant expire immediately','java/javax/servlet/http/HttpSession.java\njava/org/apache/catalina/ha/session/DeltaSession.java\njava/org/apache/catalina/session/StandardSession.java'),(680,52387,'Bug 52387 – org.catalina.tomcat.startup.Tomcat#silence method doesn\'t use the host where we add the applications','','2011-12-27 01:48:16','David Calavera','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','3787242','Mark Emlyn David Thomas','2011-12-31 06:38:30','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52387 Silence logging for correct host Patch provided by David Calavera','java/org/apache/catalina/startup/Tomcat.java'),(681,52326,'Bug 52326 – Lower log level for failed class loading','','2011-12-13 18:47:41','Filip Hanik','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','addd522','Mark Emlyn David Thomas','2011-12-29 15:06:45','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52326 Log all classloading errors during HandlesTypes processing at debug','java/org/apache/catalina/startup/ContextConfig.java'),(682,52316,'Bug 52316 – AccessLog does not log size for files sent with sendfile','','2011-12-09 22:23:47','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','9f52382','Mark Emlyn David Thomas','2011-12-28 16:21:31','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52316 Improve response length logging when sendfile is being used','java/org/apache/catalina/valves/AccessLogValve.java\nwebapps/docs/config/valve.xml'),(683,52303,'Bug 52303 – NonLoginAuthenticator does not honour session timeout with SingleSignOn Valve','','2011-12-08 09:35:59','Brian Burch','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','8b6d341','Mark Emlyn David Thomas','2011-12-27 15:17:00','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52303 Allow web applications that do not have a login configuration to participate in a SSO session. Patch provided by Brian Burch.','java/org/apache/catalina/authenticator/NonLoginAuthenticator.java'),(684,52184,'Bug 52184 – Reduce log level for invalid cookies','','2011-11-14 22:26:00','Filip Hanik','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 normal','cb2637a','Konstantin Kolinko','2011-12-27 08:55:41','Further fixing https://issues.apache.org/bugzilla/show_bug.cgi?id=52184 Apply a separate instance of UserDataHelper to the \"maxParameterCount reached\" message, so that its threshold is calculated independently of other parameter errors.','java/org/apache/tomcat/util/http/LocalStrings.properties\njava/org/apache/tomcat/util/http/Parameters.java'),(685,52243,'Bug 52243 – Documentation of Service-Installer missing one information','','2011-11-25 09:03:49','Christian Kütbach','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 trivial','5d31b75','Mark Emlyn David Thomas','2011-12-26 15:22:54','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52243 Clarify how to include # or ; in an environment value','webapps/docs/windows-service-howto.xml'),(686,52384,'Bug 52384 – URL parameter without value should be parsed successfully when logging level = DEBUG','','2011-12-24 18:16:23','KDV','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','34b011b','Konstantin Kolinko','2011-12-25 18:25:51','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52384 Do not fail in Parameter parsing when debug logging is enabled. Also do no flag extra \'&\' as errors.','java/org/apache/tomcat/util/http/LocalStrings.properties\njava/org/apache/tomcat/util/http/Parameters.java'),(687,52356,'Bug 52356 – Prevent potential data races on \"org.apache.catalina.tribes.transport.bio.util.FastQueue.size\".','','2011-12-18 23:41:25','Mohsen Vakilian','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','6f3cafe','Mark Emlyn David Thomas','2011-12-23 16:20:46','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52356 size needs to be volatile','java/org/apache/catalina/tribes/transport/bio/util/FastQueue.java'),(688,52354,'Bug 52354 – Protect concurrent accesses to field \"org.apache.catalina.tribes.transport.bio.util.FastQueue.inRemove\"','','2011-12-18 23:04:53','Mohsen Vakilian','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','8983419','Mark Emlyn David Thomas','2011-12-23 16:11:49','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52354 Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52355 Make debug flags volatile as they are accessed by multiple threads','java/org/apache/catalina/tribes/transport/bio/util/FastQueue.java'),(689,52355,'Bug 52355 – Synchronize possible concurrent accesses to field \"org.apache.catalina.tribes.transport.bio.util.FastQueue.checkLock\".','','2011-12-18 23:34:54','Mohsen Vakilian','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','8983419','Mark Emlyn David Thomas','2011-12-23 16:11:49','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52354 Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52355 Make debug flags volatile as they are accessed by multiple threads','java/org/apache/catalina/tribes/transport/bio/util/FastQueue.java'),(690,52213,'Bug 52213 – Field \"org.apache.catalina.tribes.transport.bio.util.FastQueue.enabled\" should be volatile.','','2011-11-18 23:29:32','Mohsen Vakilian','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','d69fb8e','Mark Emlyn David Thomas','2011-12-23 16:11:04','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52213 enabled should be volatile','java/org/apache/catalina/tribes/transport/bio/util/FastQueue.java'),(691,52293,'Bug 52293 – antiResourceLocking and unpackWARs','','2011-12-06 18:54:27','Justin Miller','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','33e48db','Mark Emlyn David Thomas','2011-12-21 14:25:43','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52293 Correctly handle Context.antiResourceLocking when HOst.unpackWARs=false','java/org/apache/catalina/startup/ContextConfig.java'),(692,52366,'Bug 52366 – Problem with the Loader Component documentation','The documentation on VirtualWebappLoader provides the following example:\nvirtualClasspath=\"${catalina_base}/myapp_config\" which doesn\'t work and should be:\nvirtualClasspath=\"${catalina.base}/myapp_config\" - mind the dot (and not underscore).\nThis is annoying because one can spend 2 hours not having a clue that the path is wrong because there is not validation that the path exists at class load.\nIt would be nice if the class verified the existence of the path at start-up and printed a warning in case it doesn\'t exist...','2011-12-19 16:27:26','StasG','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 normal','ee020ab','Rainer Jung','2011-12-19 19:18:30','BZ 52366: Fix typo in VirualWebappLoader documentation (configuration example).','webapps/docs/config/loader.xml'),(693,52335,'Bug 52335 – Tomcat escapes all the \\% in Template Text as %.','hi,\n\nI noticed that there is a problem at the % escape on Tomcat 5.5.34.\n\n(1)The problem\n    The JSP Specification 2.0 says:\n    ------\n    JSP.1.6 Quoting and Escape Conventions\n    → Quoting in Template Text\n     　・A literal <% is quoted by <\\%\n    ------\n\n    But the result of the % escape on Tomcat 5.5.34 is :\n    ------\n    Not only the \\% of <\\% is escaped as %.\n    All the \\% in Template Text is escaped as %.\n    ------\n\n    If I want to show \\% on the HTML page, it is needed to write \\\\% in a JSP file.\n\n    The problem  also occurs on Tomcat 5.5.23 or Tomcat7.0.8.\n    And it seems that the problem has already occured on Tomcat 5.5.0.\n\n(2)The reason\n    The reason of the problem is that the following method is not implemented\n    according to JSP Specification.\n         ・The class:\n                org.apache.jasper.compiler.Parser\n         ・The method:\n               void parseTemplateText(Node parent)\n         ・The part of source:\n           ------\n           else if (ch == \'\\\\\') {\n                if (!reader.hasMoreInput()) {\n                    ttext.write(\'\\\\\');\n                    break;\n                }\n                // Look for \\% or \\$\n                // Only recognize \\$ if isELIgnored is false\n                char next = (char)reader.peekChar();\n                if (next == \'%\' || (next == \'$\' && !pageInfo.isELIgnored())) { ▲\n                    ch = reader.nextChar();\n                }\n            }\n           ------\n\nIs it a bug?','2011-12-15 00:35:51','zhanglili','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 normal','b06520e','Mark Emlyn David Thomas','2011-12-16 08:13:36','Better fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=52335','java/org/apache/jasper/compiler/Parser.java'),(694,52335,'Bug 52335 – Tomcat escapes all the \\% in Template Text as %.','hi,\n\nI noticed that there is a problem at the % escape on Tomcat 5.5.34.\n\n(1)The problem\n    The JSP Specification 2.0 says:\n    ------\n    JSP.1.6 Quoting and Escape Conventions\n    → Quoting in Template Text\n     　・A literal <% is quoted by <\\%\n    ------\n\n    But the result of the % escape on Tomcat 5.5.34 is :\n    ------\n    Not only the \\% of <\\% is escaped as %.\n    All the \\% in Template Text is escaped as %.\n    ------\n\n    If I want to show \\% on the HTML page, it is needed to write \\\\% in a JSP file.\n\n    The problem  also occurs on Tomcat 5.5.23 or Tomcat7.0.8.\n    And it seems that the problem has already occured on Tomcat 5.5.0.\n\n(2)The reason\n    The reason of the problem is that the following method is not implemented\n    according to JSP Specification.\n         ・The class:\n                org.apache.jasper.compiler.Parser\n         ・The method:\n               void parseTemplateText(Node parent)\n         ・The part of source:\n           ------\n           else if (ch == \'\\\\\') {\n                if (!reader.hasMoreInput()) {\n                    ttext.write(\'\\\\\');\n                    break;\n                }\n                // Look for \\% or \\$\n                // Only recognize \\$ if isELIgnored is false\n                char next = (char)reader.peekChar();\n                if (next == \'%\' || (next == \'$\' && !pageInfo.isELIgnored())) { ▲\n                    ch = reader.nextChar();\n                }\n            }\n           ------\n\nIs it a bug?','2011-12-15 00:35:51','zhanglili','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 normal','2bcc59b','Mark Emlyn David Thomas','2011-12-16 08:13:00','Revert fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=52335','java/org/apache/jasper/compiler/Parser.java'),(695,52335,'Bug 52335 – Tomcat escapes all the \\% in Template Text as %.','hi,\n\nI noticed that there is a problem at the % escape on Tomcat 5.5.34.\n\n(1)The problem\n    The JSP Specification 2.0 says:\n    ------\n    JSP.1.6 Quoting and Escape Conventions\n    → Quoting in Template Text\n     　・A literal <% is quoted by <\\%\n    ------\n\n    But the result of the % escape on Tomcat 5.5.34 is :\n    ------\n    Not only the \\% of <\\% is escaped as %.\n    All the \\% in Template Text is escaped as %.\n    ------\n\n    If I want to show \\% on the HTML page, it is needed to write \\\\% in a JSP file.\n\n    The problem  also occurs on Tomcat 5.5.23 or Tomcat7.0.8.\n    And it seems that the problem has already occured on Tomcat 5.5.0.\n\n(2)The reason\n    The reason of the problem is that the following method is not implemented\n    according to JSP Specification.\n         ・The class:\n                org.apache.jasper.compiler.Parser\n         ・The method:\n               void parseTemplateText(Node parent)\n         ・The part of source:\n           ------\n           else if (ch == \'\\\\\') {\n                if (!reader.hasMoreInput()) {\n                    ttext.write(\'\\\\\');\n                    break;\n                }\n                // Look for \\% or \\$\n                // Only recognize \\$ if isELIgnored is false\n                char next = (char)reader.peekChar();\n                if (next == \'%\' || (next == \'$\' && !pageInfo.isELIgnored())) { ▲\n                    ch = reader.nextChar();\n                }\n            }\n           ------\n\nIs it a bug?','2011-12-15 00:35:51','zhanglili','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 normal','302e113','Mark Emlyn David Thomas','2011-12-15 11:50:25','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52335 % is only escaped as <\\%, not \\%','java/org/apache/jasper/compiler/Parser.java\ntest/org/apache/jasper/compiler/TestParser.java\ntest/webapp-3.0/bug52335.jsp'),(696,52321,'Bug 52321 – coda/prelude order not respected','','2011-12-13 00:13:28','romain.manni-bucau','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 critical','22e7e15','Mark Emlyn David Thomas','2011-12-13 15:17:39','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52321 Used LinkedHashSet rather than HashSet to preserve order','java/org/apache/catalina/core/ApplicationJspConfigDescriptor.java\njava/org/apache/catalina/deploy/WebXml.java'),(697,52208,'Bug 52208 – NullPointerException in tribes.transport.nio.NioReceiver.listen() in test run','','2011-11-18 10:37:32','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Cluster','P2 minor','9403e4f','Mark Emlyn David Thomas','2011-12-08 15:54:46','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52208 Avoid possible NPEs if stopListening is called in a different thread','java/org/apache/catalina/tribes/transport/nio/NioReceiver.java'),(698,52184,'Bug 52184 – Reduce log level for invalid cookies','','2011-11-14 22:26:00','Filip Hanik','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 normal','fe60dca','Mark Emlyn David Thomas','2011-12-08 15:33:56','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52184 Add a helper class that provides options (via system properties) for controlling how errors triggered by invalid input data are handled. Currently only addresses invalid cookies but can be used elsewhere as the need arises.','java/org/apache/juli/logging/DirectJDKLog.java\njava/org/apache/juli/logging/UserDataHelper.java\njava/org/apache/tomcat/util/http/Cookies.java\nwebapps/docs/config/systemprops.xml'),(699,52184,'Bug 52184 – Reduce log level for invalid cookies','','2011-11-14 22:26:00','Filip Hanik','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 normal','2a27bcd','Mark Emlyn David Thomas','2011-12-08 15:32:55','Clean-up in preparation for a fix for bug 52184','java/org/apache/juli/logging/DirectJDKLog.java\njava/org/apache/tomcat/util/http/Cookies.java'),(700,51741,'Bug 51741 – Eclipse WTP \"Serve modules without publishing\" broken with tc7, needs patch in tomcat','','2011-08-29 21:29:56','Sylvain Laurent','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','cd3f3fe','Sylvain Laurent','2011-12-02 17:16:33','bug 51741: Eclipse WTP \"Serve modules without publishing\" broken with tc7, needs patch in tomcat https://issues.apache.org/bugzilla/show_bug.cgi?id=51741','.gitignore\ntest/org/apache/catalina/loader/TestVirtualContext.java\ntest/webapp-3.0-virtual-library/target/classes/META-INF/C.tld\ntest/webapp-3.0-virtual-library/target/classes/META-INF/resources/rsrc/resourceE.properties\ntest/webapp-3.0-virtual-library/target/classes/rsrc/resourceC.properties\ntest/webapp-3.0-virtual-webapp/src/main/webapp/META-INF/context.xml\ntest/webapp-3.0-virtual-webapp/src/main/webapp/WEB-INF/web.xml\ntest/webapp-3.0-virtual-webapp/src/main/webapp/contextGetResource.jsp\ntest/webapp-3.0-virtual-webapp/src/main/webapp/contextGetResourcePaths.jsp\ntest/webapp-3.0-virtual-webapp/src/main/webapp2/rsrc/resourceF.properties\ntest/webapp-3.0-virtual-webapp/target/classes/rsrc/resourceB.properties\nwebapps/docs/config/context.xml\nwebapps/docs/config/resources.xml'),(701,51741,'Bug 51741 – Eclipse WTP \"Serve modules without publishing\" broken with tc7, needs patch in tomcat','','2011-08-29 21:29:56','Sylvain Laurent','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','cd3f3fe','Sylvain Laurent','2011-12-02 17:16:33','bug 51741: Eclipse WTP \"Serve modules without publishing\" broken with tc7, needs patch in tomcat https://issues.apache.org/bugzilla/show_bug.cgi?id=51741','.gitignore\ntest/org/apache/catalina/loader/TestVirtualContext.java\ntest/webapp-3.0-virtual-library/target/classes/META-INF/C.tld\ntest/webapp-3.0-virtual-library/target/classes/META-INF/resources/rsrc/resourceE.properties\ntest/webapp-3.0-virtual-library/target/classes/rsrc/resourceC.properties\ntest/webapp-3.0-virtual-webapp/src/main/webapp/META-INF/context.xml\ntest/webapp-3.0-virtual-webapp/src/main/webapp/WEB-INF/web.xml\ntest/webapp-3.0-virtual-webapp/src/main/webapp/contextGetResource.jsp\ntest/webapp-3.0-virtual-webapp/src/main/webapp/contextGetResourcePaths.jsp\ntest/webapp-3.0-virtual-webapp/src/main/webapp2/rsrc/resourceF.properties\ntest/webapp-3.0-virtual-webapp/target/classes/rsrc/resourceB.properties\nwebapps/docs/config/context.xml\nwebapps/docs/config/resources.xml'),(702,51741,'Bug 51741 – Eclipse WTP \"Serve modules without publishing\" broken with tc7, needs patch in tomcat','','2011-08-29 21:29:56','Sylvain Laurent','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','c56bdf0','Sylvain Laurent','2011-12-02 15:49:50','bug 51741: Eclipse WTP \"Serve modules without publishing\" broken with tc7, needs patch in tomcat https://issues.apache.org/bugzilla/show_bug.cgi?id=51741','java/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/loader/WebappClassLoader.java\njava/org/apache/catalina/startup/ContextConfig.java\njava/org/apache/naming/resources/VirtualDirContext.java\ntest/org/apache/catalina/loader/EchoTag.java\ntest/org/apache/catalina/loader/MyAnnotatedServlet.java\ntest/org/apache/catalina/loader/TestVirtualContext.java\ntest/webapp-3.0-virtual-webapp/src/main/lib/META-INF/B.tld\ntest/webapp-3.0-virtual-webapp/src/main/lib/rsrc/resourceD.properties\ntest/webapp-3.0-virtual-webapp/src/main/misc/resourceI.properties\ntest/webapp-3.0-virtual-webapp/src/main/webapp/META-INF/context.xml\ntest/webapp-3.0-virtual-webapp/src/main/webapp/WEB-INF/A.tld\ntest/webapp-3.0-virtual-webapp/src/main/webapp/WEB-INF/classes/rsrc/resourceA.properties\ntest/webapp-3.0-virtual-webapp/src/main/webapp/WEB-INF/lib/rsrc.jar\ntest/webapp-3.0-virtual-webapp/src/main/webapp/WEB-INF/web.xml\ntest/webapp-3.0-virtual-webapp/src/main/webapp/classpathGetResourceAsStream.jsp\ntest/webapp-3.0-virtual-webapp/src/main/webapp/classpathGetResourceUrlThenGetStream.jsp\ntest/webapp-3.0-virtual-webapp/src/main/webapp/classpathGetResources.jsp\ntest/webapp-3.0-virtual-webapp/src/main/webapp/contextGetRealPath.jsp\ntest/webapp-3.0-virtual-webapp/src/main/webapp/contextGetResource.jsp\ntest/webapp-3.0-virtual-webapp/src/main/webapp/contextGetResourcePaths.jsp\ntest/webapp-3.0-virtual-webapp/src/main/webapp/rsrc/resourceF.properties\ntest/webapp-3.0-virtual-webapp/src/main/webapp/testTlds.jsp\ntest/webapp-3.0-virtual-webapp/src/main/webapp2/WEB-INF/D.tld\ntest/webapp-3.0-virtual-webapp/src/main/webapp2/WEB-INF/classes/rsrc/resourceG.properties\ntest/webapp-3.0-virtual-webapp/src/main/webapp2/WEB-INF/classes/rsrc2/resourceK.properties\ntest/webapp-3.0-virtual-webapp/src/main/webapp2/rsrc/resourceF.properties\ntest/webapp-3.0-virtual-webapp/src/main/webapp2/rsrc/resourceH.properties\ntest/webapp-3.0-virtual-webapp/src/main/webapp2/rsrc2/resourceJ.properties\nwebapps/docs/config/context.xml\nwebapps/docs/config/resources.xml'),(703,51741,'Bug 51741 – Eclipse WTP \"Serve modules without publishing\" broken with tc7, needs patch in tomcat','','2011-08-29 21:29:56','Sylvain Laurent','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','c56bdf0','Sylvain Laurent','2011-12-02 15:49:50','bug 51741: Eclipse WTP \"Serve modules without publishing\" broken with tc7, needs patch in tomcat https://issues.apache.org/bugzilla/show_bug.cgi?id=51741','java/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/loader/WebappClassLoader.java\njava/org/apache/catalina/startup/ContextConfig.java\njava/org/apache/naming/resources/VirtualDirContext.java\ntest/org/apache/catalina/loader/EchoTag.java\ntest/org/apache/catalina/loader/MyAnnotatedServlet.java\ntest/org/apache/catalina/loader/TestVirtualContext.java\ntest/webapp-3.0-virtual-webapp/src/main/lib/META-INF/B.tld\ntest/webapp-3.0-virtual-webapp/src/main/lib/rsrc/resourceD.properties\ntest/webapp-3.0-virtual-webapp/src/main/misc/resourceI.properties\ntest/webapp-3.0-virtual-webapp/src/main/webapp/META-INF/context.xml\ntest/webapp-3.0-virtual-webapp/src/main/webapp/WEB-INF/A.tld\ntest/webapp-3.0-virtual-webapp/src/main/webapp/WEB-INF/classes/rsrc/resourceA.properties\ntest/webapp-3.0-virtual-webapp/src/main/webapp/WEB-INF/lib/rsrc.jar\ntest/webapp-3.0-virtual-webapp/src/main/webapp/WEB-INF/web.xml\ntest/webapp-3.0-virtual-webapp/src/main/webapp/classpathGetResourceAsStream.jsp\ntest/webapp-3.0-virtual-webapp/src/main/webapp/classpathGetResourceUrlThenGetStream.jsp\ntest/webapp-3.0-virtual-webapp/src/main/webapp/classpathGetResources.jsp\ntest/webapp-3.0-virtual-webapp/src/main/webapp/contextGetRealPath.jsp\ntest/webapp-3.0-virtual-webapp/src/main/webapp/contextGetResource.jsp\ntest/webapp-3.0-virtual-webapp/src/main/webapp/contextGetResourcePaths.jsp\ntest/webapp-3.0-virtual-webapp/src/main/webapp/rsrc/resourceF.properties\ntest/webapp-3.0-virtual-webapp/src/main/webapp/testTlds.jsp\ntest/webapp-3.0-virtual-webapp/src/main/webapp2/WEB-INF/D.tld\ntest/webapp-3.0-virtual-webapp/src/main/webapp2/WEB-INF/classes/rsrc/resourceG.properties\ntest/webapp-3.0-virtual-webapp/src/main/webapp2/WEB-INF/classes/rsrc2/resourceK.properties\ntest/webapp-3.0-virtual-webapp/src/main/webapp2/rsrc/resourceF.properties\ntest/webapp-3.0-virtual-webapp/src/main/webapp2/rsrc/resourceH.properties\ntest/webapp-3.0-virtual-webapp/src/main/webapp2/rsrc2/resourceJ.properties\nwebapps/docs/config/context.xml\nwebapps/docs/config/resources.xml'),(704,52237,'Bug 52237 – build.xml file improvement to allow not just plaintext junit logs.','','2011-11-24 11:30:21','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Packaging','P2 normal','cd05245','Mark Emlyn David Thomas','2011-11-30 15:53:03','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52237 Allow configuration of junit log output format. Defaults unchanged. Patch provided by M Hasko','build.xml'),(705,52259,'Bug 52259 – synchonization issues and dead lock if no realm is presented in configuration','','2011-11-28 19:32:12','John','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 major','779464a','Mark Emlyn David Thomas','2011-11-29 16:20:21','Fix copy paste error in BZ 52259 fix','java/org/apache/catalina/core/ContainerBase.java'),(706,52259,'Bug 52259 – synchonization issues and dead lock if no realm is presented in configuration','','2011-11-28 19:32:12','John','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 major','80a7aff','Mark Emlyn David Thomas','2011-11-29 14:48:04','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52259 Regression caused by bug 46264. Prevent deadlock if no Realm is configured.','java/org/apache/catalina/core/ContainerBase.java\njava/org/apache/catalina/core/StandardContext.java'),(707,46264,'Bug 46264 – Shutting down tomcat with large number of contexts is slow','Shutting down tomcat with large number of contexts is slow\n\nOn some of our sandbox testing environments, we have tomcat loaded with 30-40 contexts, and run a very large heap (2-3GB).  Most of these contexts are large applications which take anywhere from 5-10 seconds to shutdown each.  Most of the time spent shutting down each application is not spent using the local app server CPU, but shutting down remote resources (Announcing the application is going down over JMS, flushing write buffers, closing DB connections, closing JMS connections, closing log connections, etc.).  Shutting down tomcat typically takes minutes, because it shuts down one context at a time.','2008-11-21 08:52:10','Joe Kislo','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 enhancement','80a7aff','Mark Emlyn David Thomas','2011-11-29 14:48:04','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52259 Regression caused by bug 46264. Prevent deadlock if no Realm is configured.','java/org/apache/catalina/core/ContainerBase.java\njava/org/apache/catalina/core/StandardContext.java'),(708,52028,'Bug 52028 – Embeded Tomcat using a Connector with a random port (port 0)','','2011-10-14 12:27:22','olamy','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 enhancement','63f708a','Mark Emlyn David Thomas','2011-11-28 18:16:42','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52028 Add support for automatic selection of a free port for a connector when the special value of zero is used','java/org/apache/catalina/connector/Connector.java\njava/org/apache/catalina/connector/mbeans-descriptors.xml\njava/org/apache/coyote/AbstractProtocol.java\njava/org/apache/tomcat/util/net/AbstractEndpoint.java\njava/org/apache/tomcat/util/net/AprEndpoint.java\njava/org/apache/tomcat/util/net/JIoEndpoint.java\njava/org/apache/tomcat/util/net/NioEndpoint.java\ntest/org/apache/catalina/authenticator/TestFormAuthenticator.java\ntest/org/apache/catalina/connector/TestConnector.java\ntest/org/apache/catalina/connector/TestRequest.java\ntest/org/apache/catalina/core/TestStandardContext.java\ntest/org/apache/catalina/core/TestSwallowAbortedUploads.java\ntest/org/apache/catalina/filters/TestExpiresFilter.java\ntest/org/apache/catalina/filters/TestRemoteIpFilter.java\ntest/org/apache/catalina/mbeans/TestRegistration.java\ntest/org/apache/catalina/servlets/TestDefaultServlet.java\ntest/org/apache/catalina/startup/SimpleHttpClient.java\ntest/org/apache/catalina/startup/TomcatBaseTest.java\ntest/org/apache/coyote/http11/TestAbstractHttp11Processor.java\ntest/org/apache/coyote/http11/TestInternalInputBuffer.java\ntest/org/apache/coyote/http11/filters/TestChunkedInputFilter.java\ntest/org/apache/tomcat/util/http/TestCookiesAllowEquals.java\ntest/org/apache/tomcat/util/http/TestCookiesAllowHttpSeps.java\ntest/org/apache/tomcat/util/http/TestCookiesAllowNameOnly.java\ntest/org/apache/tomcat/util/http/TestCookiesDisallowEquals.java\ntest/org/apache/tomcat/util/net/TestXxxEndpoint.java\nwebapps/docs/config/ajp.xml\nwebapps/docs/config/http.xml'),(709,52225,'Bug 52225 – Adding Alias for existing host on running Tomcat causes ClassCastException','','2011-11-22 07:14:09','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','f3a7cd9','Konstantin Kolinko','2011-11-22 03:34:06','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52225 Fix ClassCastException in Alias added for existing host via JMX','java/org/apache/tomcat/util/http/mapper/Mapper.java\ntest/org/apache/tomcat/util/http/mapper/TestMapper.java'),(710,52173,'Bug 52173 – Add a drop of additional clarification to doc on the delegate setting of the WebappClassLoader','','2011-11-13 14:59:57','bmargulies','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','574af73','Mark Emlyn David Thomas','2011-11-14 17:13:32','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52173 Improve Javadoc for delgate attribute of WebappClassLoader Based on a patch by bmargulies','java/org/apache/catalina/loader/WebappClassLoader.java'),(711,52172,'Bug 52172 – The build instructions could be a trifle clearer about /usr/share/java','','2011-11-13 14:46:13','bmargulies','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Webapps:Documentation','P2 normal','7610577','Konstantin Kolinko','2011-11-13 21:17:52','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52172 Make build instructions clearer about /usr/bin/java Based on the patch by bimargulies','BUILDING.txt\nwebapps/docs/building.xml'),(712,50570,'Bug 50570 – Allow explicit use of FIPS mode in APR lifecycle listener','','2011-01-11 12:27:44','Christopher Schultz','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 enhancement','c2001ce','Christopher Schultz','2011-11-09 16:34:31','Fixed bug #50570 - Allow explicit use of FIPS mode in APR lifecycle listener - Added \"FIPSMode\" attribute to AprLifecycleListener that causes OpenSSL to go into FIPS mode','java/org/apache/catalina/core/AprLifecycleListener.java\njava/org/apache/catalina/core/LocalStrings.properties\njava/org/apache/tomcat/jni/SSL.java'),(713,52156,'Bug 52156 – ServletContext.getResource(path) doesn\'t accept \"..\" anymore','','2011-11-08 18:59:53','Arnaud','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','b7f5c7e','Mark Emlyn David Thomas','2011-11-08 18:28:59','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52156 Need to use normalised path to look up resource in DirContext','java/org/apache/catalina/core/ApplicationContext.java'),(714,52148,'Bug 52148 – Missing jars in catalina-tasks.xml','When importing catalina-task.xml and running the list task I get an\njava.lang.NoClassDefFoundError: org/apache/tomcat/util/buf/B2CConverter\n\ntomcat-coyote.jar is missing in the classpath.\n\nSolution:\nAdd\n<fileset file=\"${catalina.home}/lib/tomcat-coyote.jar\"/>\nto taskdef classpath in catalina-task.xml','2011-11-07 15:09:13','Volker Krebs','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Packaging','P2 minor','f342a6b','Mark Emlyn David Thomas','2011-11-08 18:02:24','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52148 Ant tasks require tomcat-coyote.jar Patch provided by Volker Krebs','bin/catalina-tasks.xml'),(715,52121,'Bug 52121 – corrupt gzip output when compression=on in server.xml','','2011-11-01 22:15:16','David Marcks','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 normal','e1cd8b5','Konstantin Kolinko','2011-11-03 21:29:44','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52121 FlushableGZIPOutputStream produces corrupted output on some input sequences The fix is to do not restore compression level right before the end of the stream. Restore it only before writing the next portion of data.','java/org/apache/coyote/http11/filters/FlushableGZIPOutputStream.java'),(716,52121,'Bug 52121 – corrupt gzip output when compression=on in server.xml','','2011-11-01 22:15:16','David Marcks','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 normal','92b1af5','Mark Emlyn David Thomas','2011-11-03 19:05:46','Test case for bug 52121','test/org/apache/coyote/http11/filters/TesterFlushableGZIPOutputStream.java\ntest/org/apache/coyote/http11/filters/bug52121-part1\ntest/org/apache/coyote/http11/filters/bug52121-part2'),(717,52113,'Bug 52113 – Tomcat reports missing context xml at wrong location on JMX deployment','Hello, \n\nI\'m using Tomcat JMX interface to deploy apps as follows:\n1) call MBeanFactory#createStandardContext, where MBeanFactory is \"Catalina:type=MBeanFactory\", with parameters: parent = \"Catalina:type=Host,host=localhost\", path = \"/w1\", docBase = <my path to the app>\n2) call <my app>#start, where <my app> is \"Catalina:j2eeType=WebModule,name=//localhost/w1,J2EEApplication=none,J2EEServer=none\"\n\nAs result, my app _is succesfully deployed (its context is available)_, but nevertheless I see the following exceptions in the server console (full stacktraces are skipped, to be attached next comment):\n\n31 ???? 2011 14:05:53 org.apache.catalina.startup.ContextConfig\nprocessContextConfig\nSEVERE: Missing context.xml: file:/C:/<my Tomcat base\nfolder>/conf/Catalina/localhost/w1.xml\njava.io.FileNotFoundException: C:\\<my Tomcat base\nfolder>\\conf\\Catalina\\localhost\\w1.xml\n\n31 ???? 2011 14:05:53 org.apache.catalina.startup.ContextConfig\nprocessContextConfig\nSEVERE: Parse error in context.xml for /w1\njava.io.FileNotFoundException: C:\\<my Tomcat base\nfolder>\\conf\\Catalina\\localhost\\w1.xml\n\n31 ???? 2011 14:05:53 org.apache.catalina.startup.ContextConfig configureStart\nSEVERE: Marking this application unavailable due to previous error(s)\n\n31 ???? 2011 14:05:53 org.apache.catalina.core.StandardContext startInternal\nSEVERE: Error getConfigured\n\n31 ???? 2011 14:05:53 org.apache.catalina.core.StandardContext startInternal\nSEVERE: Context [/w1] startup failed due to previous errors\n\nThe exceptions looks strange to me, since I don\'t understand why Tomcat searches for a context xml file during the jmx deploy.\n\nDo I do something wrong in the deployment workflow?\n\nRegards, \nMichael','2011-10-31 14:09:21','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','d7af36d','Mark Emlyn David Thomas','2011-11-01 17:51:32','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52113 Don\'t assume presence of context.xml file with JMX deployment','java/org/apache/catalina/mbeans/MBeanFactory.java'),(718,52091,'Bug 52091 – TagHandlerPool is slow when high concurrently','TagHandlerPool is slow when I ran stress test my web application using tomcat7.\nIt occured in 7.0.19.\nProfiler said that it causes are followings:\n\n 1. Lock of log instance at org.apache.jasper.runtime.TagHandlerPool.\n\n 2. Lock of parameters field at org.apache.catalina.core.StandardWrapper.getInitParameter.\n\nAn attached patch resolve this issue in my environment.\nIt makes following changes:\n\n 1. Makes log field to static.\n\n 2. At StandardWrapper, changes lock policy from synchronized block to ReentrantReadWriteLock.','2011-10-26 10:39:01','Taiki Sugawara','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','432fe09','Mark Emlyn David Thomas','2011-10-28 11:11:14','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52091 Address performance issues related to lock contention in StandardWrapper Patch provided by Taiki Sugawara.','java/org/apache/catalina/core/StandardWrapper.java'),(719,52091,'Bug 52091 – TagHandlerPool is slow when high concurrently','TagHandlerPool is slow when I ran stress test my web application using tomcat7.\nIt occured in 7.0.19.\nProfiler said that it causes are followings:\n\n 1. Lock of log instance at org.apache.jasper.runtime.TagHandlerPool.\n\n 2. Lock of parameters field at org.apache.catalina.core.StandardWrapper.getInitParameter.\n\nAn attached patch resolve this issue in my environment.\nIt makes following changes:\n\n 1. Makes log field to static.\n\n 2. At StandardWrapper, changes lock policy from synchronized block to ReentrantReadWriteLock.','2011-10-26 10:39:01','Taiki Sugawara','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','e149398','Mark Emlyn David Thomas','2011-10-28 11:07:48','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52091 Address performance issues related to log creation TagHandlerPool. Patch provided by Taiki Sugawara.','java/org/apache/jasper/runtime/TagHandlerPool.java'),(720,51744,'Bug 51744 – JNDI Lookup Error after a Context is closed','I was integrating Atomikos into Tomcat to register the transaction manager, and the lookup for the transaction manager works fine in JNDI, unless someone else, looks up a JNDI context and closes it. And subsequent calls to lookup the transaction manager also fails saying java:comp is not found. I went through the code and found the problem at \"org.apache.naming.SelectorContext\". When methods of that class is calls, those are delegated to a Context received through \"getBoundContext()\", which returns a \"org.apache.naming.NamingContext\" object. And these are stored in a map in ContextBindings class. So the getBoundContext checks this cache, and if it\'s found it returns it or else, create a new object and store it and returns it. So the problem happens, if someone calls \"close()\" in the NamingContext object. Then it\'s implemented in the following way,\n\n   public void close()\n        throws NamingException {\n        env.clear();\n    }\n\nWhich just clears the environment, but it doesn\'t in no way invalidate that cache in the ContextBindings class to remove its entry. So in the next time also when getBoundContext is called to get the same context, it will return the earlier \'closed\' context without creating a new one. And the environment it has would be cleared and subsequent lookups done from that will fail. \n\nSo I guess the proper fix would be to remove that context from ContextBinding\'s cache when its close method is closed.\n\nCheers,\nAnjana.','2011-08-30 08:43:40','Anjana Fernando','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 critical','1eb39d0','Mark Emlyn David Thomas','2011-10-28 10:14:22','Merge branch \'bug51744\' into trunk','java/org/apache/catalina/core/NamingContextListener.java\njava/org/apache/catalina/core/StandardContext.java\njava/org/apache/naming/NamingContext.java\ntest/org/apache/naming/resources/TestNamingContext.java\nwebapps/docs/config/context.xml'),(721,46264,'Bug 46264 – Shutting down tomcat with large number of contexts is slow','Shutting down tomcat with large number of contexts is slow\n\nOn some of our sandbox testing environments, we have tomcat loaded with 30-40 contexts, and run a very large heap (2-3GB).  Most of these contexts are large applications which take anywhere from 5-10 seconds to shutdown each.  Most of the time spent shutting down each application is not spent using the local app server CPU, but shutting down remote resources (Announcing the application is going down over JMS, flushing write buffers, closing DB connections, closing JMS connections, closing log connections, etc.).  Shutting down tomcat typically takes minutes, because it shuts down one context at a time.','2008-11-21 08:52:10','Joe Kislo','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 enhancement','d6f68b1','Mark Emlyn David Thomas','2011-10-28 03:37:34','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46264 Implement threaded start/stop for containers','java/org/apache/catalina/Container.java\njava/org/apache/catalina/Host.java\njava/org/apache/catalina/core/ContainerBase.java\njava/org/apache/catalina/core/LocalStrings.properties\njava/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/core/StandardHost.java\njava/org/apache/catalina/core/mbeans-descriptors.xml\njava/org/apache/catalina/startup/ContextConfig.java\njava/org/apache/catalina/startup/HostConfig.java\njava/org/apache/catalina/startup/LocalStrings.properties\njava/org/apache/coyote/AbstractProtocol.java\njava/org/apache/tomcat/util/threads/DedicatedThreadExecutor.java\ntest/org/apache/tomcat/util/threads/DedicatedThreadExecutorTest.java\nwebapps/docs/config/engine.xml\nwebapps/docs/config/host.xml'),(722,51582,'Bug 51582 – NPE in SlowQueryReport','java.lang.NullPointerException\n	at java.util.concurrent.ConcurrentHashMap.get(ConcurrentHashMap.java:768)\n	at org.apache.tomcat.jdbc.pool.interceptor.SlowQueryReport.getQueryStats(SlowQueryReport.java:156)\n	at org.apache.tomcat.jdbc.pool.interceptor.SlowQueryReport.reportFailedQuery(SlowQueryReport.java:85)\n	at org.apache.tomcat.jdbc.pool.interceptor.SlowQueryReportJmx.reportFailedQuery(SlowQueryReportJmx.java:147)\n	at org.apache.tomcat.jdbc.pool.interceptor.AbstractQueryReport$StatementProxy.invoke(AbstractQueryReport.java:236)','2011-07-29 08:07:18','Patric Rufflar','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 major','989985d','Filip Hanik','2011-10-27 15:56:30','https://issues.apache.org/bugzilla/show_bug.cgi?id=51582 Fix NPE when the query is not available. This is a temporary work around until we know why SQL is null','modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/interceptor/SlowQueryReport.java'),(723,52049,'Bug 52049 – Incorrect setup instructions','Hi,\n\nin chapter 2 setup of the documentation of at least Tomcat 6 and Tomcat 7 for the windows installation the following item is mentioned:\n\n\"Java location: The installer will use the registry or the JAVA_HOME environment variable to determine the base path of a J2SE 5 JRE.\"\n\nI think that JAVA_HOME should/must be replaced by JRE_HOME. If the variable JAVA_HOME is exported Tomcat seems to expect a valid base path of a J2SE 5 JDK (or J2SE 6 JDK for Tomcat 7). \n\nI would like to ask for an update of the corresponding manual pages. Thanks in advance!','2011-10-18 13:55:18','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P2 normal','20bcb6c','Mark Emlyn David Thomas','2011-10-20 13:31:31','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52049 Improve setup instructions for running as a Windows service - remove references to specific Windows OSes - it easily gets dated - correct info on how a JRE is identified / selected','webapps/docs/setup.xml'),(724,52059,'Bug 52059 – Windows Registry are not removed after uninstall','The keys in the Windows Registry (= HKEY_LOCAL_MACHINE\\SOFTWARE\\Apache Software Foundation\\Tomcat\\7.0\\Tomcat7) are not removed after an uninstall of Tomcat 7.0.22.','2011-10-19 15:56:23','greg7635','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Native:Packaging','P2 normal','d7e1ede','Konstantin Kolinko','2011-10-20 08:36:07','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52059 Delete Tomcat key from HKLM branch of Windows Registry on deinstallation. The bug affects 32-bit systems only. The code for 64-bit registry a few lines below is OK.','res/tomcat.nsi'),(725,51940,'Bug 51940 – Form Authentication Valve should restore request body on PUT method','','2011-10-03 16:15:05','Nicholas Sushkin','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','9242b2e','Konstantin Kolinko','2011-10-20 07:56:54','Expand the test to cover regression fixed in 7.0.23: check that parameters in the original request have reached the protected page. https://issues.apache.org/bugzilla/show_bug.cgi?id=51940#c9','test/org/apache/catalina/authenticator/TestFormAuthenticator.java'),(726,51940,'Bug 51940 – Form Authentication Valve should restore request body on PUT method','','2011-10-03 16:15:05','Nicholas Sushkin','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','7e7da2b','Konstantin Kolinko','2011-10-20 06:18:40','https://issues.apache.org/bugzilla/show_bug.cgi?id=51940#c9 Restore original method name when forward to the login page returns','java/org/apache/catalina/authenticator/FormAuthenticator.java'),(727,52055,'Bug 52055 – ChunkedInputFilter is not recycled for servlet 3.0 asynchronous request','I\'m using the standard servlet 3.0 async APIs with tomcat 7.0.22. The server side code is something like the following:\n\n        final AsyncContext asyncContext = request.startAsync();\n\n        ... // in a processing thread\n        asyncContext.getRequest().getInputStream();\n        ... read the input stream\n        asyncContext.complete();\n\nThe InputStream returns 0 bytes for the HTTP post with chunking. \n\nAfter debugging, I found that the ChunkedInputFilter is reused by org.apache.coyote.http11.AbstractInputBuffer. But it has never been recycled (nextRequest()?) before the reuse for another request. As a result, the endChunk flag is always true after the first request. And it always return immediately without reading more from the buffer.','2011-10-18 21:53:21','Raymond Feng','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 critical','4af706d','Mark Emlyn David Thomas','2011-10-19 16:51:08','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52055 Buffers not correctly reset between keep-alive requests when using async','java/org/apache/coyote/http11/AbstractHttp11Processor.java'),(728,52051,'Bug 52051 – NullPointerException when Jasper tries to compile a directory','','2011-10-18 19:33:51','Christopher Schultz','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','62ff013','Mark Emlyn David Thomas','2011-10-19 11:09:07','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52051 Return a 404 if an attempt is made to process a resource that does not exist','java/org/apache/jasper/JspCompilationContext.java\njava/org/apache/jasper/compiler/JspUtil.java'),(729,52042,'Bug 52042 – Possible NullPointerException in DefaultInstanceManager#processAnnotations','NullPointerException exception is thrown randomly from \"DefaultInstanceManager#processAnnotations\" method on the following lines,\n\n List<AnnotationCacheEntry> annotations;\n            synchronized (annotationCache) {\n                annotations = annotationCache.get(clazz).get();\n            }\n\n            //Null Pointer Exception is thrown, because annotations is NULL\n            for (AnnotationCacheEntry entry : annotations) {\n\n\nFor example, I have a JSF Managed Bean \n\npublic class X extends Y{\n}\n\nOpen JSF page that contains managed bean X. Randomly opening the same page throws NullPointerException because for superclass Y \"annotations = annotationCache.get(clazz).get();\" returns null.\n\nUsing WeakHashMap on \"annotationCache\" field may be the reason of exception.','2011-10-17 14:39:00','Gurkan Erdogdu','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 critical','82dd643','Mark Emlyn David Thomas','2011-10-19 05:16:26','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52042 Correct threading issue in annotation caching that could lead to an NPE if multiple threads were processing the same class hierarchy for annotations','java/org/apache/catalina/core/DefaultInstanceManager.java'),(730,52042,'Bug 52042 – Possible NullPointerException in DefaultInstanceManager#processAnnotations','NullPointerException exception is thrown randomly from \"DefaultInstanceManager#processAnnotations\" method on the following lines,\n\n List<AnnotationCacheEntry> annotations;\n            synchronized (annotationCache) {\n                annotations = annotationCache.get(clazz).get();\n            }\n\n            //Null Pointer Exception is thrown, because annotations is NULL\n            for (AnnotationCacheEntry entry : annotations) {\n\n\nFor example, I have a JSF Managed Bean \n\npublic class X extends Y{\n}\n\nOpen JSF page that contains managed bean X. Randomly opening the same page throws NullPointerException because for superclass Y \"annotations = annotationCache.get(clazz).get();\" returns null.\n\nUsing WeakHashMap on \"annotationCache\" field may be the reason of exception.','2011-10-17 14:39:00','Gurkan Erdogdu','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 critical','1e742d0','Mark Emlyn David Thomas','2011-10-18 13:06:05','Fix possible small memory leak when investigating https://issues.apache.org/bugzilla/show_bug.cgi?id=52042','java/org/apache/jasper/util/FastRemovalDequeue.java\ntest/org/apache/jasper/util/TestFastRemovalDequeue.java'),(731,52045,'Bug 52045 – Document the default Manager configuration.','','2011-10-17 23:09:18','Basil Bourque','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 enhancement','cb63698','Konstantin Kolinko','2011-10-18 07:45:54','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52045 Better document what \"default\" Manager implementation is. Also added a separate section about the pathname=\"\" trick that is used to disable session persistence.','webapps/docs/config/manager.xml'),(732,52025,'Bug 52025 – 7.0.21 and newer break the JDK 6 Service provider mechanism for loading JDBC Drivers','In Tomcat 6 and Tomcat 7.0.20 and earlier, JDBC drivers in a web app\'s classpath would automatically be loaded using the JDK\'s service provider mechanisms.  Starting with Tomcat 7.0.21, this no longer works.  I suspect is has something to do with the classloader that is in effect at the time of this initialization, but not certain. It is difficult to debug, because the actual loading occurs in a Sun class sun.misc.Service, for which source is very hard to find!','2011-10-13 21:19:49','Rick Bullotta','Tomcat Developers Mailing List','RESOLVED INVALID','Tomcat 7','Catalina','P2 regression','fea5bf6','Mark Emlyn David Thomas','2011-10-16 16:03:59','Add additional information in light of https://issues.apache.org/bugzilla/show_bug.cgi?id=52025','webapps/docs/jndi-datasource-examples-howto.xml'),(733,52009,'Bug 52009 – NPE exception in org.apache.catalina.connector.CoyoteAdapter.service','','2011-10-11 08:06:49','viola.lu','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 major','b90c0a1','Mark Emlyn David Thomas','2011-10-14 16:50:57','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=52009 Fix the NPE if an error occurs during comet processing Add test cases for errors during comet processing Ensure access log entries are made if an error occurs','java/org/apache/catalina/connector/CoyoteAdapter.java\ntest/org/apache/catalina/comet/TestCometProcessor.java'),(734,50923,'Bug 50923 – Difficult to pick out valid values from config descriptions','','2011-03-13 20:51:35','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 enhancement','9eee196','Konstantin Kolinko','2011-10-14 08:26:04','https://issues.apache.org/bugzilla/show_bug.cgi?id=50923 Documentation: Use default color, but lightcyan background for code tags. Based on a suggestion by sebb. Properties table (e.g. config/systemprops.html) needs the same handling as attributes table.','webapps/docs/tomcat-docs.xsl'),(735,51940,'Bug 51940 – Form Authentication Valve should restore request body on PUT method','','2011-10-03 16:15:05','Nicholas Sushkin','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','f6268e3','Mark Emlyn David Thomas','2011-10-10 11:44:14','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51940 Don\'t limit saving of request bodies during FORM authentication to POST requests since any HTTP method may include a body. Based on a patch by Nicholas Sushkin','java/org/apache/catalina/authenticator/FormAuthenticator.java\njava/org/apache/catalina/authenticator/LocalStrings.properties'),(736,51972,'Bug 51972 – sendRedirect does not support protocol relative URLs','','2011-10-05 21:31:50','Heikki Vesalainen','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','e70797e','Mark Emlyn David Thomas','2011-10-10 08:10:53','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51972 Add support for handling scheme/protocol relative URLs for redirects','java/org/apache/catalina/connector/Response.java'),(737,51952,'Bug 51952 – IllegalStateException using CompressionFilter with Tomcat 7.0.21/22','','2011-10-04 15:36:57','Kari Scott','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','3ab3757','Mark Emlyn David Thomas','2011-10-07 18:00:06','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51952 Make inclusion of a response body for redirects optional as it may cause issues and is only SHOULD in RFC2616. See also https://issues.apache.org/bugzilla/show_bug.cgi?id=41718','java/org/apache/catalina/Context.java\njava/org/apache/catalina/connector/Response.java\njava/org/apache/catalina/core/StandardContext.java\nwebapps/docs/config/context.xml'),(738,41718,'Bug 41718 – Status 302 response to GET request has no body when calling sendRedirect','RFC2616 (10.3.3 302 Found) says as follows:\n\n  Unless the request method was HEAD, the entity of the\n  response SHOULD contain a short hypertext note with a hyperlink to\n  the new URI(s).\n\nIn case HTTP redirect response is created without sendRedirect,\nservlet developers are responsible for its header and body.\nHowever, when calling sendRedirect, body with a hyperlink\nshould be included in the response.','2007-02-27 17:27:49','Minehiko IIDA','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Connector:Coyote','P2 enhancement','3ab3757','Mark Emlyn David Thomas','2011-10-07 18:00:06','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51952 Make inclusion of a response body for redirects optional as it may cause issues and is only SHOULD in RFC2616. See also https://issues.apache.org/bugzilla/show_bug.cgi?id=41718','java/org/apache/catalina/Context.java\njava/org/apache/catalina/connector/Response.java\njava/org/apache/catalina/core/StandardContext.java\nwebapps/docs/config/context.xml'),(739,51956,'Bug 51956 – RemoteAddrFilter uses remote host (not address) in doFilterEvent','public void doFilterEvent(CometEvent event, CometFilterChain chain)\n            throws IOException, ServletException {\n        processCometEvent(event.getHttpServletRequest().getRemoteHost(),\n                event, chain);        \n    }\n\nUse of getRemoteHost should be getRemoteAddr.','2011-10-04 21:58:18','Christopher Schultz','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','d6d1c6f','Christopher Schultz','2011-10-04 17:59:20','Fixed bug #51956: RemoteAddrFilter uses remote host (not address) in doFilterEvent','java/org/apache/catalina/filters/RemoteAddrFilter.java'),(740,51630,'Bug 51630 – java.lang.IllegalStateException: Calling [asyncComplete()]','example:\n\nwebapps\\examples\\WEB-INF\\classes\\async\\Async0.java\n\n\nlog file: logs\\localhost.2011-08-07.log\n=============================================\njava.lang.IllegalStateException: Calling [asyncComplete()] is not valid for a request with Async state [DISPATCHED]\n	at org.apache.coyote.AsyncStateMachine.asyncComplete(AsyncStateMachine.java:221)\n	at org.apache.coyote.http11.Http11Processor.actionInternal(Http11Processor.java:525)\n	at org.apache.coyote.http11.AbstractHttp11Processor.action(AbstractHttp11Processor.java:773)\n	at org.apache.coyote.Request.action(Request.java:344)\n	at org.apache.catalina.core.AsyncContextImpl.complete(AsyncContextImpl.java:89)\n	at async.Async0.service(Async0.java:42)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:304)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n	at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:684)\n	at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:593)\n	at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:530)\n	at org.apache.catalina.core.AsyncContextImpl$1.run(AsyncContextImpl.java:173)\n	at org.apache.catalina.core.AsyncContextImpl.doInternalDispatch(AsyncContextImpl.java:314)\n	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:219)\n	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)\n	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:462)\n	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:164)\n	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:100)\n	at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:851)\n	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)\n	at org.apache.catalina.connector.CoyoteAdapter.asyncDispatch(CoyoteAdapter.java:296)\n	at org.apache.coyote.http11.AbstractHttp11Processor.asyncDispatch(AbstractHttp11Processor.java:1220)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:511)\n	at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:302)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n	at java.lang.Thread.run(Thread.java:619)','2011-08-07 02:34:08','zhh','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Examples','P2 normal','b080c7e','Mark Emlyn David Thomas','2011-10-03 15:50:09','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51630 Correct bug in async examples. Remove unnecessary call to AsyncContext.complete() that triggered an ISE.','webapps/examples/WEB-INF/classes/async/Async0.java'),(741,51881,'Bug 51881 – Server incorrectly parses incoming HTTP requests and loses them','We are developing Comet-based web application with native Tomcat Comet support via Atmosphere framework. We use HTTP streaming for transferring data from our servlet to the client. In our scenario, the user connects to the server with XMLHTTPRequest sending GET. In response, we suspend his connection and then, when needed, send data back to him. When the user opens another browser tab and connects to our web application, our web application should close the connection in the first (previously opened) tab and then suspend and use connection from the second. So, my serlvet detect that another GET is incoming in the same session, finds previous connection and closes it (internally using CometEvent.close()). This works as intended. However, the next HTTP request to the web server is not correctly handled, and in my servlet I receive the strange HttpServletRequest with previous GET query string and duplicate request headers from initial GET and the following request. I traced through the Tomcat code, and noticed, that in org.apache.coyote.http11.Http11Processor.process() request field is usually empty (contains no HTTP method, request headers, etc.) However, after Comet closing this object is not empty and contain previoud HTTP request. Later the request headers are parsed and appended to the fields existed in previous request object. After that, this invalid object is passed to my Servlet.\nI suppose, that clearing request object when closing comet event and all assosiated data in Http11NioProcessor.actionInternal() can solve this issue.','2011-09-23 11:55:42','Edward Alexandrov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 critical','666deb7','Mark Emlyn David Thomas','2011-10-03 12:42:19','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51881 Don\'t mark processors handling comet requests as non-comet too early. Before this fix, finishing a comet request was processed as non-comet meaning the comet clean-up code was not executed which was likely to break processing of the next request on the connection.','java/org/apache/catalina/connector/CometEventImpl.java\njava/org/apache/catalina/connector/Request.java\njava/org/apache/coyote/http11/AbstractHttp11Processor.java\njava/org/apache/coyote/http11/Http11AprProcessor.java\njava/org/apache/coyote/http11/Http11NioProcessor.java\njava/org/apache/coyote/http11/Http11Processor.java\ntest/org/apache/catalina/comet/TestCometProcessor.java'),(742,50923,'Bug 50923 – Difficult to pick out valid values from config descriptions','','2011-03-13 20:51:35','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 enhancement','c8ec16a','Konstantin Kolinko','2011-10-02 13:53:04','https://issues.apache.org/bugzilla/show_bug.cgi?id=50923 Use more distinct color for <code> and add small spacing around it. Do not color attribute names (the names in the first column in attribute lists in Configuration reference).','webapps/docs/tomcat-docs.xsl'),(743,51910,'Bug 51910 – NPE in comet processing when shutting down Tomcat','','2011-09-28 12:05:19','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','a450d2c','Mark Emlyn David Thomas','2011-10-01 09:42:16','Merge branch \'bug51910\' into trunk','java/org/apache/catalina/core/StandardWrapperValve.java'),(744,51912,'Bug 51912 – IOOB exception in InternalNioInputBuffer when debug logging is enabled','I encountered the following while testing 7.0.22 RC.\n\nTo reproduce:\n1. Replace conf/logging.properties with the following:\n===============\nhandlers = 1catalina.org.apache.juli.FileHandler\n.handlers = 1catalina.org.apache.juli.FileHandler\n\n1catalina.org.apache.juli.FileHandler.level = FINE\n1catalina.org.apache.juli.FileHandler.directory = ${catalina.base}/logs\n1catalina.org.apache.juli.FileHandler.prefix = catalina.\n1catalina.org.apache.juli.FileHandler.bufferSize=20000\n\n.level=FINE\n===============\nNote that level=FINE enables debug logging.\n\n2. Run testsuite for NIO + org.apache.coyote.http11.TestInternalInputBuffer\nby adding the following to build.properties:\nexecute.test.bio=false\nexecute.test.nio=true\nexecute.test.apr=false\ntest.entry=org.apache.coyote.http11.TestInternalInputBuffer\n\n3. The test fails:\n==============\nTestsuite: org.apache.coyote.http11.TestInternalInputBuffer\nTests run: 7, Failures: 2, Errors: 0, Time elapsed: 50,357 sec\n\nTestcase: testBug48839 took 9,594 sec\nTestcase: testBug51557NoColon took 1,217 sec\n	FAILED\n\njunit.framework.AssertionFailedError: \n	at org.apache.coyote.http11.TestInternalInputBuffer.testBug51557NoColon(TestInternalInputBuffer.java:137)\n\nTestcase: testBug51557Separators took 22,807 sec\nTestcase: testBug51557Ctl took 13,104 sec\n	FAILED\n\njunit.framework.AssertionFailedError: \n	at org.apache.coyote.http11.TestInternalInputBuffer.doTestBug51557Char(TestInternalInputBuffer.java:216)\n	at org.apache.coyote.http11.TestInternalInputBuffer.testBug51557Ctl(TestInternalInputBuffer.java:160)\n\nTestcase: testBug51557Continuation took 1,248 sec\nTestcase: testBug51557BoundaryStart took 1,185 sec\nTestcase: testBug51557BoundaryEnd took 1,186 sec\n==============\n\n4. It is the only test in testsuite that is failing in this logging configuration. The rest of testsuite did run successfully.\nThis test also succeeds when it is run with BIO or APR. Only NIO fails.\n\n\nIn the log file the following exception occurs 3 times:\n==============\n28.09.2011 17:50:38 org.apache.coyote.http11.AbstractHttp11Processor process\nFINE: Error parsing HTTP request header\njava.lang.StringIndexOutOfBoundsException: String index out of range: -40\n	at java.lang.String.checkBounds(String.java:397)\n	at java.lang.String.<init>(String.java:482)\n	at org.apache.coyote.http11.InternalNioInputBuffer.skipLine(InternalNioInputBuffer.java:672)\n	at org.apache.coyote.http11.InternalNioInputBuffer.parseHeader(InternalNioInputBuffer.java:526)\n	at org.apache.coyote.http11.InternalNioInputBuffer.parseHeaders(InternalNioInputBuffer.java:435)\n	at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:905)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:515)\n	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1550)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n	at java.lang.Thread.run(Thread.java:662)\n==============\n\nIt is caused by debug logging in\norg.apache.coyote.http11.InternalNioInputBuffer.skipLine(InternalNioInputBuffer.java:672)\n\n671        if (log.isDebugEnabled()) {\n672            log.debug(sm.getString(\"iib.invalidheader\", new String(buf,\n673                    headerData.start,\n674                    headerData.lastSignificantChar - headerData.start + 1,\n675                    DEFAULT_CHARSET)));\n676        }\n\nInternalInputBuffer and InternalAprInputBuffer have similar debug logging in their skipLine() methods, but they do not fail.','2011-09-28 14:22:54','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 normal','571690b','Konstantin Kolinko','2011-09-29 00:33:26','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51912 Fix several small issues in Header processing in Nio HTTP connector: - Split HEADER_VALUE state into HEADER_VALUE_START and HEADER_VALUE. The first one skips leading whitespace, the second one - does not. - Trim trailing tabs as well as spaces. RFC-2616 Ch.4.2 says that both are LWS and both can be ignored. - Always trim whitespace from last line. - Fix initial value of lastSignificantChar when calling skipLine(). It fixes BZ 51912.','java/org/apache/coyote/http11/InternalNioInputBuffer.java'),(745,51912,'Bug 51912 – IOOB exception in InternalNioInputBuffer when debug logging is enabled','I encountered the following while testing 7.0.22 RC.\n\nTo reproduce:\n1. Replace conf/logging.properties with the following:\n===============\nhandlers = 1catalina.org.apache.juli.FileHandler\n.handlers = 1catalina.org.apache.juli.FileHandler\n\n1catalina.org.apache.juli.FileHandler.level = FINE\n1catalina.org.apache.juli.FileHandler.directory = ${catalina.base}/logs\n1catalina.org.apache.juli.FileHandler.prefix = catalina.\n1catalina.org.apache.juli.FileHandler.bufferSize=20000\n\n.level=FINE\n===============\nNote that level=FINE enables debug logging.\n\n2. Run testsuite for NIO + org.apache.coyote.http11.TestInternalInputBuffer\nby adding the following to build.properties:\nexecute.test.bio=false\nexecute.test.nio=true\nexecute.test.apr=false\ntest.entry=org.apache.coyote.http11.TestInternalInputBuffer\n\n3. The test fails:\n==============\nTestsuite: org.apache.coyote.http11.TestInternalInputBuffer\nTests run: 7, Failures: 2, Errors: 0, Time elapsed: 50,357 sec\n\nTestcase: testBug48839 took 9,594 sec\nTestcase: testBug51557NoColon took 1,217 sec\n	FAILED\n\njunit.framework.AssertionFailedError: \n	at org.apache.coyote.http11.TestInternalInputBuffer.testBug51557NoColon(TestInternalInputBuffer.java:137)\n\nTestcase: testBug51557Separators took 22,807 sec\nTestcase: testBug51557Ctl took 13,104 sec\n	FAILED\n\njunit.framework.AssertionFailedError: \n	at org.apache.coyote.http11.TestInternalInputBuffer.doTestBug51557Char(TestInternalInputBuffer.java:216)\n	at org.apache.coyote.http11.TestInternalInputBuffer.testBug51557Ctl(TestInternalInputBuffer.java:160)\n\nTestcase: testBug51557Continuation took 1,248 sec\nTestcase: testBug51557BoundaryStart took 1,185 sec\nTestcase: testBug51557BoundaryEnd took 1,186 sec\n==============\n\n4. It is the only test in testsuite that is failing in this logging configuration. The rest of testsuite did run successfully.\nThis test also succeeds when it is run with BIO or APR. Only NIO fails.\n\n\nIn the log file the following exception occurs 3 times:\n==============\n28.09.2011 17:50:38 org.apache.coyote.http11.AbstractHttp11Processor process\nFINE: Error parsing HTTP request header\njava.lang.StringIndexOutOfBoundsException: String index out of range: -40\n	at java.lang.String.checkBounds(String.java:397)\n	at java.lang.String.<init>(String.java:482)\n	at org.apache.coyote.http11.InternalNioInputBuffer.skipLine(InternalNioInputBuffer.java:672)\n	at org.apache.coyote.http11.InternalNioInputBuffer.parseHeader(InternalNioInputBuffer.java:526)\n	at org.apache.coyote.http11.InternalNioInputBuffer.parseHeaders(InternalNioInputBuffer.java:435)\n	at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:905)\n	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:515)\n	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1550)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n	at java.lang.Thread.run(Thread.java:662)\n==============\n\nIt is caused by debug logging in\norg.apache.coyote.http11.InternalNioInputBuffer.skipLine(InternalNioInputBuffer.java:672)\n\n671        if (log.isDebugEnabled()) {\n672            log.debug(sm.getString(\"iib.invalidheader\", new String(buf,\n673                    headerData.start,\n674                    headerData.lastSignificantChar - headerData.start + 1,\n675                    DEFAULT_CHARSET)));\n676        }\n\nInternalInputBuffer and InternalAprInputBuffer have similar debug logging in their skipLine() methods, but they do not fail.','2011-09-28 14:22:54','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 normal','571690b','Konstantin Kolinko','2011-09-29 00:33:26','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51912 Fix several small issues in Header processing in Nio HTTP connector: - Split HEADER_VALUE state into HEADER_VALUE_START and HEADER_VALUE. The first one skips leading whitespace, the second one - does not. - Trim trailing tabs as well as spaces. RFC-2616 Ch.4.2 says that both are LWS and both can be ignored. - Always trim whitespace from last line. - Fix initial value of lastSignificantChar when calling skipLine(). It fixes BZ 51912.','java/org/apache/coyote/http11/InternalNioInputBuffer.java'),(746,51905,'Bug 51905 – Infinite loop when shutting down AprEndpoint','','2011-09-28 09:20:16','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','136097e','Konstantin Kolinko','2011-09-28 05:35:59','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51905 Skip attempt to shutdown AprEndpoint acceptor threads if the server socket has been already forcefully closed. Reduce waiting timeout from 30s to 10s. I think if things go wrong 10s is enough to wait.','java/org/apache/tomcat/util/net/AprEndpoint.java'),(747,51872,'Bug 51872 – request.getRemoteAddr() sometimes returning IP address from the previous request','request.getRemoteAddr() sometimes returning IP address from the previous request.  We have compared the IP address returned from the getRemoteHost() and from the headers with getRemoteAddr() and getRemoteAddr is returning wrong IP address.  We believe that this may come from the \"pooled\" request objects where it is sometimes sees the previous value of the remote IP.  The problem doesn\'t occur all the time. \n\nWe are heavily relying on the getRemoteAddr to verify the remote client for some of our authentication.  Can this be fixed?\n\n2011-09-22 16:49:55,713 DEBUG [yjava.tomcat.valves.YahooConnectionValve] THREADID:1262 YahooConnectionValve invoked\n2011-09-22 16:49:55,826 DEBUG [yjava.tomcat.valves.YahooConnectionValve] THREADID:1262 YahooConnectionValve\nrequest.getInfo(): org.apache.coyote.catalina.CoyoteRequest/1.0\n2011-09-22 16:49:56,013 DEBUG [yjava.tomcat.valves.YahooConnectionValve] THREADID:1262 YahooConnectionValve\nrequest.getRemoteAddr(): 98.138.85.230\n2011-09-22 16:49:56,014 DEBUG [yjava.tomcat.valves.YahooConnectionValve] THREADID:1262 YahooConnectionValve\nrequest.getRemoteHost(): web120016.mail.ne1.yahoo.com\n\n   [][~]$ nslookup web120016.mail.ne1.yahoo.com\n   Server:              10.72.226.8\n   Address:     10.72.226.8#53\n\n   Name:        web120016.mail.ne1.yahoo.com\n   Address: 98.138.85.143\n\n2011-09-22 16:49:56,014 DEBUG [yjava.tomcat.valves.YahooConnectionValve] THREADID:1262 YahooConnectionValve\nrequest.getRequestedSessionId(): null\n2011-09-22 16:49:56,015 DEBUG [yjava.tomcat.valves.YahooConnectionValve] THREADID:1262 YahooConnectionValve\nrequest.getHeader(): accept:*/* host:ls100.mail.vip.ne1.yahoo.com:4080 content-type:application/x-ypy\nyahoo-app-auth:v=1;a=yahoo.mail.acl.yca.lsg-prod;h=98.138.85.143;t=1319282225;\ncontent-length:574\n2011-09-22 16:49:56,015 DEBUG [yjava.filter.address.RemoteIPTranslator] THREADID:1262 Got remote address\n\'98.138.85.230\' and port \'46663\'','2011-09-22 17:52:57','charlie','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 blocker','18792f4','Mark Emlyn David Thomas','2011-09-27 16:15:41','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51872 Ensure access log always logs the correct remote IP. Ensure requests with multiple errors do not result in multiple access log entries.','java/org/apache/catalina/connector/CoyoteAdapter.java\njava/org/apache/coyote/ajp/AbstractAjpProcessor.java\njava/org/apache/coyote/ajp/AjpAprProcessor.java\njava/org/apache/coyote/ajp/AjpNioProcessor.java\njava/org/apache/coyote/ajp/AjpProcessor.java\njava/org/apache/coyote/http11/AbstractHttp11Processor.java'),(748,51806,'Bug 51806 – Apache Tomact executables looks for 7.0.21 setclasspath.sh file','','2011-09-14 10:25:34','Yossi Shmulevitch','Tomcat Developers Mailing List','RESOLVED INVALID','Tomcat 6','Catalina','P2 major','d7faa44','Konstantin Kolinko','2011-09-26 07:14:23','Improve RUNNING.txt by adding the following: - Mention that CATALINA_HOME should have a correct value or be absent (BZ 51806) - Mention environment variables that are used by the scripts. - Document what is left in $CATALINA_HOME when $CATALINA_BASE is used. - Document setenv.* scripts.','RUNNING.txt'),(749,50923,'Bug 50923 – Difficult to pick out valid values from config descriptions','','2011-03-13 20:51:35','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 enhancement','95d2805','Konstantin Kolinko','2011-09-26 02:38:51','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50923 Use slightly different color for <code> tags','webapps/docs/tomcat-docs.xsl'),(750,51871,'Bug 51871 – Wrong transitive dependency listed in tomcat-jdbc maven pom','','2011-09-22 17:00:57','Mike Youngstrom','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','9106a2e','Konstantin Kolinko','2011-09-25 17:25:11','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51871 Wrong transitive dependency listed in tomcat-jdbc maven pom It should depend on tomcat-juli, not on itself.','res/maven/tomcat-jdbc.pom'),(751,51887,'Bug 51887 – Speedup sessionid generation when running testsuite','','2011-09-24 14:09:54','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','73a6e56','Mark Emlyn David Thomas','2011-09-24 13:20:21','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51887 Use an insecure random source for session ID generation during tests for speed. Based on kkolinko\'s suggestion.','test/org/apache/catalina/startup/FastNonSecureRandom.java\ntest/org/apache/catalina/startup/TomcatBaseTest.java'),(752,51862,'Bug 51862 – JreMemoryLeakPreventionListener enhancement to load configurable classes','Enhancement proposed : add a \"classesToInitialize\" parameter to JreMemoryLeakPreventionListener to provoke the loading of arbitrary classes.\nThis will allow users to tune the memory leak protection features to avoid leaks triggered when loading JRE classes not yet identified as leaky, or even third-party classes.\n\nI\'ll commit a patch in the next days...','2011-09-21 21:56:46','Sylvain Laurent','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','daac881','Sylvain Laurent','2011-09-22 16:01:52','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51862 bug 51862: JreMemoryLeakPreventionListener enhancement to load configurable classes https://issues.apache.org/bugzilla/show_bug.cgi?id=51862','java/org/apache/catalina/core/JreMemoryLeakPreventionListener.java\njava/org/apache/catalina/core/LocalStrings.properties\nwebapps/docs/config/listeners.xml'),(753,51862,'Bug 51862 – JreMemoryLeakPreventionListener enhancement to load configurable classes','Enhancement proposed : add a \"classesToInitialize\" parameter to JreMemoryLeakPreventionListener to provoke the loading of arbitrary classes.\nThis will allow users to tune the memory leak protection features to avoid leaks triggered when loading JRE classes not yet identified as leaky, or even third-party classes.\n\nI\'ll commit a patch in the next days...','2011-09-21 21:56:46','Sylvain Laurent','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','daac881','Sylvain Laurent','2011-09-22 16:01:52','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51862 bug 51862: JreMemoryLeakPreventionListener enhancement to load configurable classes https://issues.apache.org/bugzilla/show_bug.cgi?id=51862','java/org/apache/catalina/core/JreMemoryLeakPreventionListener.java\njava/org/apache/catalina/core/LocalStrings.properties\nwebapps/docs/config/listeners.xml'),(754,51862,'Bug 51862 – JreMemoryLeakPreventionListener enhancement to load configurable classes','Enhancement proposed : add a \"classesToInitialize\" parameter to JreMemoryLeakPreventionListener to provoke the loading of arbitrary classes.\nThis will allow users to tune the memory leak protection features to avoid leaks triggered when loading JRE classes not yet identified as leaky, or even third-party classes.\n\nI\'ll commit a patch in the next days...','2011-09-21 21:56:46','Sylvain Laurent','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','daac881','Sylvain Laurent','2011-09-22 16:01:52','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51862 bug 51862: JreMemoryLeakPreventionListener enhancement to load configurable classes https://issues.apache.org/bugzilla/show_bug.cgi?id=51862','java/org/apache/catalina/core/JreMemoryLeakPreventionListener.java\njava/org/apache/catalina/core/LocalStrings.properties\nwebapps/docs/config/listeners.xml'),(755,51860,'Bug 51860 – HTTP/SSL with NIO won\'t work','','2011-09-21 10:03:38','Roman Tsirulnikov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 normal','66f2d5b','Mark Emlyn David Thomas','2011-09-21 10:14:22','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51860 Fix issues when using NIO, SSL and a custom SSLImplementation. Based on a suggestion by Roman Tsirulnikov.','java/org/apache/tomcat/util/net/jsse/JSSEKeyManager.java'),(756,51852,'Bug 51852 – BeanELResolver varargs handling is broken in multiple ways','','2011-09-20 19:16:07','Matt Benson','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 normal','bfabec5','Mark Emlyn David Thomas','2011-09-21 09:33:51','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51852 Correct 2 issues in varargs handling  - Incorrectly constructed varargs arguments (resulting in ArrayIndexOutOfBoundsExceptions)  - Incorrectly detected matching varargs methods Patch (with a test case!) provided by Matt Benson','java/javax/el/BeanELResolver.java\ntest/javax/el/TestBeanELResolverVarargsInvocation.java'),(757,51580,'Bug 51580 – Severe error deploying WAR application (ExpandWar error)','','2011-07-28 22:41:57','Cleon','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','feff880','Christopher Schultz','2011-09-20 16:30:10','Fixed bug #51580: Severe error deploying WAR application (ExpandWar error) - Added error mesage when JarEntry InputStream cannot be found due to a broken WAR file','java/org/apache/catalina/startup/ExpandWar.java\njava/org/apache/catalina/startup/LocalStrings.properties'),(758,51687,'Bug 51687 – Improve JreMemoryLeakPreventionListener against leak caused by sun.java2d.Disposer','The sun.java2d.Disposer class, when loaded, starts an endless daemon thread that can inherit the WebappClassLoader as its context loader. This will cause a leak when the webapp is unloaded.\n\nIt would be useful if JreMemoryLeakPreventionListener could load this class to prevent the leak.','2011-08-19 14:41:36','Michał Politowski','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 enhancement','423fd89','Christopher Schultz','2011-09-20 16:17:23','Fixed bug #51687: Improve JreMemoryLeakPreventionListener against leak caused by sun.java2d.Disposer - Added (optional) protection against sun.java2d.Disposer thread pinning a WebappClassLoader into memory in the JreMemoryLeakPreventionListener.','java/org/apache/catalina/core/JreMemoryLeakPreventionListener.java\nwebapps/docs/config/listeners.xml'),(759,51811,'Bug 51811 – SSL configuration property name illegal','','2011-09-14 14:57:22','Roman Tsirulnikov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 normal','9425437','Rainer Jung','2011-09-18 08:22:39','BZ 51811: Fix typo in attribute name (sslImplementationName instead of  sslImplemenationName).','java/org/apache/coyote/http11/AbstractHttp11JsseProtocol.java\ntest/org/apache/tomcat/util/net/TestCustomSsl.java\nwebapps/docs/config/http.xml'),(760,51794,'Bug 51794 – Race condition in NioEndpoint$Poller causes socket to not be read until selectorTimeout','I\'m seeing an occasional race condition that happens between NioEndpoint$Poller#run and Http11NioProtocol finishing an event.\n\nWhat happens is that there is a race condition upon waking up the Selector that can cause a SelectionKey to not be marked with InterestOps.READ as soon as it could.  The race is on Poller.wakeupCounter.  These steps can occur which causes my SelectionKey to not have its interest ops reset soon and the Selector to not have wakeup() called on it.\n\n1. Poller0 - Starts processing its run loop and calls events().\n2. Poller0 - Checks the wakeupCounter.get() > 0 which evaluates to false (wakeupCounter is 0).\n3. Worker1 - Finishes an event and calls in to Poller#addEvent\n4. Worker1 - Enqueues the PollerEvent that will reset the interest ops.\n5. Worker1 - Calls wakeupCounter.incrementAndGet to increment and get wakeupCounter to 1.  This fails the check to call selector.wakeup();\n6. Poller0 - Calls wakeupCounter.set(-1)\n7. Poller0 - Calls selector.select(selectorTimeout) and blocks for either the full time out or until another unrelated SelectionKey is polled.\n8. Poller0 - Ultimately gets around to calling events() again which now resets the interest ops for the SelectionKey that was processed by Worker1.\n\nThe simple fix for this is to change this code:\n                            if (wakeupCounter.get() > 0) {\n                                //if we are here, means we have other stuff to do\n                                //do a non blocking select\n                                keyCount = selector.selectNow();\n                            } else {\n                                wakeupCounter.set(-1);\n                                keyCount = selector.select(selectorTimeout);\n                            }\n\nto this \n                            if (wakeupCounter.getAndSet(-1) > 0) {\n                                //if we are here, means we have other stuff to do\n                                //do a non blocking select\n                                keyCount = selector.selectNow();\n                            } else {\n                                keyCount = selector.select(selectorTimeout);\n                            }','2011-09-09 18:51:35','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','58429a8','Filip Hanik','2011-09-14 10:39:05','https://issues.apache.org/bugzilla/show_bug.cgi?id=51794 Fix race condition in selector potentially causing a delay in select operations','java/org/apache/tomcat/util/net/NioEndpoint.java'),(761,48392,'Bug 48392 – jdbc-pool is not returning the proxied connection in resultSet and statement','The proxy connection returned by the jdbc-pool is not proxying the resultSet and the statement so if the client gets access to the underlying connection through: \n\nresultSet.getStatement().getConnection()\n\nHe is able to close the physical connection due to both instances (resultSet and statement) were not proxied. \nIf this happens next time a client gets a connection from the jdbc-pool it will return a proxy with a physical connection closed.','2009-12-15 11:43:20','gfernandes','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 critical','9a4b541','Filip Hanik','2011-09-12 11:25:13','typo in decorator https://issues.apache.org/bugzilla/show_bug.cgi?id=48392','modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/interceptor/StatementDecoratorInterceptor.java'),(762,51744,'Bug 51744 – JNDI Lookup Error after a Context is closed','I was integrating Atomikos into Tomcat to register the transaction manager, and the lookup for the transaction manager works fine in JNDI, unless someone else, looks up a JNDI context and closes it. And subsequent calls to lookup the transaction manager also fails saying java:comp is not found. I went through the code and found the problem at \"org.apache.naming.SelectorContext\". When methods of that class is calls, those are delegated to a Context received through \"getBoundContext()\", which returns a \"org.apache.naming.NamingContext\" object. And these are stored in a map in ContextBindings class. So the getBoundContext checks this cache, and if it\'s found it returns it or else, create a new object and store it and returns it. So the problem happens, if someone calls \"close()\" in the NamingContext object. Then it\'s implemented in the following way,\n\n   public void close()\n        throws NamingException {\n        env.clear();\n    }\n\nWhich just clears the environment, but it doesn\'t in no way invalidate that cache in the ContextBindings class to remove its entry. So in the next time also when getBoundContext is called to get the same context, it will return the earlier \'closed\' context without creating a new one. And the environment it has would be cleared and subsequent lookups done from that will fail. \n\nSo I guess the proper fix would be to remove that context from ContextBinding\'s cache when its close method is closed.\n\nCheers,\nAnjana.','2011-08-30 08:43:40','Anjana Fernando','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 critical','e6f0fb1','Mark Emlyn David Thomas','2011-09-07 05:22:36','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51744 Use method Set rather than EnumSet since the method signature uses Set.','java/org/apache/catalina/core/ApplicationContextFacade.java'),(763,51550,'Bug 51550 – Empty response instead of error page for IllegalStateException','','2011-07-25 13:22:52','Mark Thomas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','92053af','Mark Emlyn David Thomas','2011-09-02 07:26:14','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51550 Use context error pages where possible e.g. for authenticator errors','java/org/apache/catalina/core/StandardHostValve.java'),(764,51653,'Bug 51653 – ServletRequestListener.requestDestroyed is called before request leaves a webapp','','2011-08-12 06:01:59','wheleph','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 major','7f69315','Mark Emlyn David Thomas','2011-09-02 06:45:26','Fix a regression with the fix for 51653 that broke custom error page handling for error status codes return by the authenticators. This moves error page handling back to the host valve and also moves request listener handling to the host valve. This ensures that everything at a context level happens inside the listeners and that custom error pages are available for all context errors.','java/org/apache/catalina/core/StandardContextValve.java\njava/org/apache/catalina/core/StandardHostValve.java'),(765,51741,'Bug 51741 – Eclipse WTP \"Serve modules without publishing\" broken with tc7, needs patch in tomcat','','2011-08-29 21:29:56','Sylvain Laurent','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','514d602','Sylvain Laurent','2011-08-31 16:38:53','bug 51741: Eclipse WTP \"Serve modules without publishing\" broken with tc7, needs patch in tomcat https://issues.apache.org/bugzilla/show_bug.cgi?id=51741',''),(766,51741,'Bug 51741 – Eclipse WTP \"Serve modules without publishing\" broken with tc7, needs patch in tomcat','','2011-08-29 21:29:56','Sylvain Laurent','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','514d602','Sylvain Laurent','2011-08-31 16:38:53','bug 51741: Eclipse WTP \"Serve modules without publishing\" broken with tc7, needs patch in tomcat https://issues.apache.org/bugzilla/show_bug.cgi?id=51741',''),(767,51741,'Bug 51741 – Eclipse WTP \"Serve modules without publishing\" broken with tc7, needs patch in tomcat','','2011-08-29 21:29:56','Sylvain Laurent','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','f6f1af0','Sylvain Laurent','2011-08-31 16:35:22','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51741 bug 51741: Eclipse WTP \"Serve modules without publishing\" broken with tc7, needs patch in tomcat','java/org/apache/catalina/loader/WebappClassLoader.java'),(768,51741,'Bug 51741 – Eclipse WTP \"Serve modules without publishing\" broken with tc7, needs patch in tomcat','','2011-08-29 21:29:56','Sylvain Laurent','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','f6f1af0','Sylvain Laurent','2011-08-31 16:35:22','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51741 bug 51741: Eclipse WTP \"Serve modules without publishing\" broken with tc7, needs patch in tomcat','java/org/apache/catalina/loader/WebappClassLoader.java'),(769,51744,'Bug 51744 – JNDI Lookup Error after a Context is closed','I was integrating Atomikos into Tomcat to register the transaction manager, and the lookup for the transaction manager works fine in JNDI, unless someone else, looks up a JNDI context and closes it. And subsequent calls to lookup the transaction manager also fails saying java:comp is not found. I went through the code and found the problem at \"org.apache.naming.SelectorContext\". When methods of that class is calls, those are delegated to a Context received through \"getBoundContext()\", which returns a \"org.apache.naming.NamingContext\" object. And these are stored in a map in ContextBindings class. So the getBoundContext checks this cache, and if it\'s found it returns it or else, create a new object and store it and returns it. So the problem happens, if someone calls \"close()\" in the NamingContext object. Then it\'s implemented in the following way,\n\n   public void close()\n        throws NamingException {\n        env.clear();\n    }\n\nWhich just clears the environment, but it doesn\'t in no way invalidate that cache in the ContextBindings class to remove its entry. So in the next time also when getBoundContext is called to get the same context, it will return the earlier \'closed\' context without creating a new one. And the environment it has would be cleared and subsequent lookups done from that will fail. \n\nSo I guess the proper fix would be to remove that context from ContextBinding\'s cache when its close method is closed.\n\nCheers,\nAnjana.','2011-08-30 08:43:40','Anjana Fernando','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 critical','fafbfec','Mark Emlyn David Thomas','2011-08-31 10:17:41','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51744 Don\'t allow user code to close the JNDI context while a web app is running','java/org/apache/naming/NamingContext.java\ntest/org/apache/naming/resources/TestNamingContext.java'),(770,51698,'Bug 51698 – ajp CPing/Forward-Request packet forgery, is a design decision? or a security vulnerability?','','2011-08-20 07:54:08','zhh','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 normal','a2538ce','Mark Emlyn David Thomas','2011-08-29 15:44:53','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51698 Fix CVE-2011-3190 Prevent AJP request forgery via unread request body packet','java/org/apache/coyote/ajp/AbstractAjpProcessor.java\njava/org/apache/coyote/ajp/AjpAprProcessor.java\njava/org/apache/coyote/ajp/AjpNioProcessor.java\njava/org/apache/coyote/ajp/AjpProcessor.java'),(771,51739,'Bug 51739 – If landingpage is a XHTML (JSF/CDI), nullpointer exception.','','2011-08-29 13:47:09','Flávio Henrique','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','3513acc','Mark Emlyn David Thomas','2011-08-29 14:28:28','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51739 Set the method when using a landing page','java/org/apache/catalina/authenticator/FormAuthenticator.java'),(772,51712,'Bug 51712 – Regression in cache-control headers for requests with security-constraints','','2011-08-23 20:55:25','Michael Zampani','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 regression','196a8f5','Mark Emlyn David Thomas','2011-08-29 10:40:27','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51712 Ensure cache control headers are sent even if request is secure. Patch provided by Michael Zampani','java/org/apache/catalina/authenticator/AuthenticatorBase.java'),(773,51736,'Bug 51736 – Make rpcTimeout configurable in BackupManager.','Default rpcTimeout that BackupManager sets to AbstractReplicatedMap is 15000 msec.\nThis is not configurable.\n\nWhen receiving MapMessage.MSG_START (and after a new member is added), \npublishEntryInfo is called for all sessions where primary and backup node are not included. \nAnd, the backup node is set to the session.\n\nWhen only one Tomcat starts in cluster, publishEntryInfo will be called for all sessions. \nAs a result, the RPC message has the possibility of the timeout. \n\nWhen acquiring session from restarting Tomcat, \nwarning of \"Unable to retrieve remote object for key:XXX\" is logged.\nAnd the session cannot be continued. \n\nI make rpcTimeout configurable in BackupManager.\nAdditionally, if RPC message timeouted in AbstractReplicatedMap#broadcast, add warning message.\n\nBest Regards.','2011-08-29 10:26:09','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Cluster','P2 enhancement','87a32d6','Keiichi Fujino','2011-08-29 06:30:38','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51736. Make rpcTimeout configurable in BackupManager.','java/org/apache/catalina/ha/session/BackupManager.java\njava/org/apache/catalina/ha/session/mbeans-descriptors.xml\njava/org/apache/catalina/tribes/tipis/AbstractReplicatedMap.java\nwebapps/docs/config/cluster-manager.xml'),(774,51704,'Bug 51704 – Dubious use of mkdirs() return code in juli FileHandler','','2011-08-22 13:17:27','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','4587f13','Mark Emlyn David Thomas','2011-08-26 13:08:17','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51704 Make calls to File.mkdirs() more robust and handle errors in a few places where they were ignored and should not have been.','java/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/loader/WebappClassLoader.java\njava/org/apache/catalina/loader/WebappLoader.java\njava/org/apache/catalina/manager/ManagerServlet.java\njava/org/apache/catalina/manager/host/HostManagerServlet.java\njava/org/apache/catalina/servlets/CGIServlet.java\njava/org/apache/catalina/session/FileStore.java\njava/org/apache/catalina/session/LocalStrings.properties\njava/org/apache/catalina/startup/ExpandWar.java\njava/org/apache/catalina/startup/HostConfig.java\njava/org/apache/catalina/startup/LocalStrings.properties\njava/org/apache/catalina/valves/AccessLogValve.java\njava/org/apache/jasper/JspCompilationContext.java\njava/org/apache/juli/FileHandler.java\ntest/org/apache/catalina/connector/TestCoyoteAdapter.java\ntest/org/apache/catalina/core/TestAsyncContextImpl.java\ntest/org/apache/catalina/core/TestStandardContext.java\ntest/org/apache/catalina/servlets/TestDefaultServlet.java\ntest/org/apache/catalina/startup/TomcatBaseTest.java'),(775,51558,'Bug 51558 – Tomcat Embedded: using tomcat.addWebapp always overrides programmatic context-settings with default values for the context at start of tomcat server','when i deploy an webapp with a tomcat server, i use the Function \"tomcat.addWebapp\". I looked into the code of this function and it makes the following call:\n\n     ctx.addLifecycleListener(new DefaultWebXmlListener());\n\nWhen i start tomcat, this DefaultWebXmlListener is activated automatically, and always does the following code, so the manager i set for my context gets overriden with this code:\n\n     public static void initWebappDefaults(Context ctx) {\n        ...\n        // Sessions\n        ctx.setManager( new StandardManager());\n        ctx.setSessionTimeout(30);\n        ...\n     }\n\nso when i set a StandardManager programatically, it gets overriden by this code. The workaround i used, is to unregister the DefaultWebXmlListener, and than add my own context.xml specific settings, like a custom manager for deactivating session persistance:\n\n     Context warContext = tomcat.addWebapp(warContextPath, warLocation);\n    \n     LifecycleListener[] lclisteners = warContext.findLifecycleListeners();\n     LifecycleListener defaultWebXMLListener = null;\n     for (int i=0; i < lclisteners.length; i++){\n       if (lclisteners[i] instanceof DefaultWebXmlListener){\n         defaultWebXMLListener = lclisteners[i];\n       }\n     }\n     warContext.removeLifecycleListener(defaultWebXMLListener);\n     ...\n     StandardManager manager = new StandardManager();\n     manager.setPathname(null); // disable session persistance:\n     //manager.setPathname(\"SESSIONS.ser\");     \n     warContext.setCookies(true);\n     warContext.setCrossContext(true);\n     warContext.setManager(manager);\n\ni think its a bug that using the \"tomcat.addWebapp\" method makes it impossible to set context.xml specific settings programmatically, because they always get overriden by default values at the tomcat start.','2011-07-26 10:11:48','bhuber','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','25f02b4','Mark Emlyn David Thomas','2011-08-26 12:03:57','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51558 No need to force the use of the StandardManager with addWebapp() since StandardContext will add it if it is not set.','java/org/apache/catalina/startup/Tomcat.java\ntest/org/apache/catalina/startup/TestTomcat.java'),(776,51583,'Bug 51583 – ConnectionPool.close() always waits one second unnecessarily','As discussed with Filip via mail: (just to do report it officially):\n\nI\'ve encountered an issue on closing the pool:\nClosing a ConnectionPool will always take at least one second if more than zero connections have been acquired.\nPlease have a look at ConnectionPool.java:367 :\n\n                    con = pool.poll(1000, TimeUnit.MILLISECONDS);\n\nImagine that we\'ve previously fetched the last connection out of the queue.\nIn this case the that command will cause that we\'ve to wait 1000ms (to return null).\n\nThe solution would be easy - just check prior to polling if the pool queue is empty.\n\nThe 1 second wait time is really annoying because I am creating and destroying the pool for each junit test which causes that each test will take more than 2 seconds (I am using two pools per test).','2011-07-29 08:10:00','Patric Rufflar','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','d858ed6','Konstantin Kolinko','2011-08-26 09:07:16','Followup for r1157874 which is a Fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=51583 Break loop immediately, because con is never set to null and you\'ll try releasing it twice.','modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java'),(777,50394,'Bug 50394 – InternalAprInputBuffer.fill() doesn\'t deal correctly with EOF','I\'m using tomcat-native-1.1.20 and tomcat-6.0.29 on CentOS 5.5, and I\'ve written a servlet that is sent large (gigabyte) streams of bytes over HTTP.\n\nFrom time to time it fails with the following stacktrace:\n\n\nCaused by: java.io.IOException\n        at org.apache.coyote.http11.InternalAprInputBuffer.fill(InternalAprInputBuffer.java:798)\n        at org.apache.coyote.http11.InternalAprInputBuffer$SocketInputBuffer.doRead(InternalAprInputBuffer.java:827)\n        at org.apache.coyote.http11.filters.IdentityInputFilter.doRead(IdentityInputFilter.java:116)\n        at org.apache.coyote.http11.InternalAprInputBuffer.doRead(InternalAprInputBuffer.java:738)\n        at org.apache.coyote.Request.doRead(Request.java:428)\n        at org.apache.catalina.connector.InputBuffer.realReadBytes(InputBuffer.java:304)\n        at org.apache.tomcat.util.buf.ByteChunk.substract(ByteChunk.java:403)\n        at org.apache.catalina.connector.InputBuffer.read(InputBuffer.java:327)\n        at org.apache.catalina.connector.CoyoteInputStream.read(CoyoteInputStream.java:193)\n        at java.io.BufferedInputStream.read1(BufferedInputStream.java:273)\n        at java.io.BufferedInputStream.read(BufferedInputStream.java:334)\n        at java.io.FilterInputStream.read(FilterInputStream.java:107)\n[...]\n\n\nUnfortunately, InternalAprInputBuffer throws away the error code on line 798, but I\'ve run it under a debugger and nRead was -70014.\n\nIf you look in the source of apr-1.3.8 at include/apr_errno.h, you\'ll see this is -APR_EOF.\n\nThe bug is in the implementation of recvbb at line 892 onwards in tomcat-native-1.1.20-src/jni/native/src/network.c. Specifically, at the end of the function we check for APR_SUCCESS, and assume all other codes are an error, returning -ss. It should also check for EOF (APR_STATUS_IS_EOF), and return zero. (Or at least, InternalAprInputBuffer assumes that a return code of 0 <=> EOF).\n\nIncidentally, apr-1.3.8/include/apr_network_io.h says in its comment on apr_socket_recv() that \"It is possible for both bytes to be received and an APR_EOF or other error to be returned.\". This is a lie. All provided implementations of apr_socket_recv return with *len == 0 in case of APR_EOF.','2010-12-01 11:38:03','Hugh Warrington','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Native','Library','P2 normal','44f3f4c','Konstantin Kolinko','2011-08-26 08:24:56','Make the fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=50394 done in r1148815 more explicit. No functional change.','java/org/apache/coyote/http11/InternalAprInputBuffer.java'),(778,51713,'Bug 51713 – Bad Connector protocol causes NullPointerException when using Executor','Under the following configuration, an NPE is thrown because _setExecutor() calls con.getProtocolHandler().getClass() when the protocol handler is null.\n\nIt would be nice to report a bad configuration instead of suffering an NPE.\n\nserver.xml:\n\n    <Executor name=\"tomcatThreadPool\" namePrefix=\"catalina-exec-\"\n        maxThreads=\"150\" minSpareThreads=\"4\"/>\n\n    <Connector port=\"12345\"\n               redirectPort=\"443\" protocol=\"HTTP\"\n               secure=\"true\" scheme=\"https\" proxyPort=\"80\"\n               URIEncoding=\"UTF-8\" executor=\"tomcatThreadPool\" />\n\ncatalina.out:\n\nAug 23, 2011 5:18:30 PM org.apache.catalina.connector.Connector <init>\nSEVERE: Protocol handler instantiation failed\nAug 23, 2011 5:18:30 PM org.apache.tomcat.util.digester.Digester startElement\nSEVERE: Begin event threw exception\njava.lang.NullPointerException\n        at org.apache.catalina.startup.ConnectorCreateRule._setExecutor(ConnectorCreateRule.java:69)\n        at org.apache.catalina.startup.ConnectorCreateRule.begin(ConnectorCreateRule.java:63)\n        at org.apache.tomcat.util.digester.Digester.startElement(Digester.java:1276)\n        at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.startElement(AbstractSAXParser.java:501)\n        at com.sun.org.apache.xerces.internal.parsers.AbstractXMLDocumentParser.emptyElement(AbstractXMLDocumentParser.java:179)\n        at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanStartElement(XMLDocumentFragmentScannerImpl.java:1343)\n        at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(XMLDocumentFragmentScannerImpl.java:2755)\n        at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:648)\n        at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:511)\n        at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:808)\n        at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:737)\n        at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:119)\n        at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(AbstractSAXParser.java:1205)\n        at com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(SAXParserImpl.java:522)\n        at org.apache.tomcat.util.digester.Digester.parse(Digester.java:1537)\n        at org.apache.catalina.startup.Catalina.load(Catalina.java:555)\n        at org.apache.catalina.startup.Catalina.load(Catalina.java:596)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at org.apache.catalina.startup.Bootstrap.load(Bootstrap.java:281)\n        at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:449)\n\n\nAug 23, 2011 5:18:30 PM org.apache.catalina.startup.Catalina load\nWARNING: Catalina.start using conf/server.xml: Error at (104, 66) : null\nAug 23, 2011 5:18:30 PM org.apache.catalina.connector.Connector <init>\nSEVERE: Protocol handler instantiation failed\nAug 23, 2011 5:18:30 PM org.apache.tomcat.util.digester.Digester startElement\nSEVERE: Begin event threw exception\njava.lang.NullPointerException\n        at org.apache.catalina.startup.ConnectorCreateRule._setExecutor(ConnectorCreateRule.java:69)\n        at org.apache.catalina.startup.ConnectorCreateRule.begin(ConnectorCreateRule.java:63)\n        at org.apache.tomcat.util.digester.Digester.startElement(Digester.java:1276)\n        at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.startElement(AbstractSAXParser.java:501)\n        at com.sun.org.apache.xerces.internal.parsers.AbstractXMLDocumentParser.emptyElement(AbstractXMLDocumentParser.java:179)\n        at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanStartElement(XMLDocumentFragmentScannerImpl.java:1343)\n        at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(XMLDocumentFragmentScannerImpl.java:2755)\n        at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:648)\n        at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:511)\n        at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:808)\n        at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:737)\n        at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:119)\n        at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(AbstractSAXParser.java:1205)\n        at com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(SAXParserImpl.java:522)\n        at org.apache.tomcat.util.digester.Digester.parse(Digester.java:1537)\n        at org.apache.catalina.startup.Catalina.load(Catalina.java:555)\n        at org.apache.catalina.startup.Catalina.start(Catalina.java:609)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:322)\n        at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:450)\nAug 23, 2011 5:18:31 PM org.apache.catalina.startup.Catalina load\nWARNING: Catalina.start using conf/server.xml: Error at (104, 66) : null\nAug 23, 2011 5:18:31 PM org.apache.catalina.startup.Catalina start\nSEVERE: Cannot start server. Server instance is not configured.','2011-08-23 21:44:53','Christopher Schultz','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','517fd9b','Konstantin Kolinko','2011-08-24 19:46:50','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51713 Improve message that is logged if there is a typo in the value of protocol in a <Connector> element.','java/org/apache/catalina/connector/Connector.java\njava/org/apache/catalina/connector/LocalStrings.properties'),(779,51688,'Bug 51688 – JreMemoryLeakPreventionListener should protect against AWT thread creation','Any webapp that calls java.awt.Toolkit.getDefaultToolkit will launch a new thread (AWT-Windows, AWT-XAWT, etc.) which will capture the ContextClassLoader, pinning the webapp in memory after an undeploy/redeploy.\n\nA simple addition to JreMemoryLeakPreventionListener can alleviate this condition.','2011-08-19 14:49:17','Christopher Schultz','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','0cdbfa6','Konstantin Kolinko','2011-08-24 18:25:03','Forward-port r1159673 and r1159680 from tc7.0.x Fixes http://issues.apache.org/bugzilla/show_bug.cgi?id=51688 JreMemoryLeakPreventionListener now protects against AWT thread creation. (schultz)','java/org/apache/catalina/core/JreMemoryLeakPreventionListener.java\nwebapps/docs/config/listeners.xml'),(780,49683,'Bug 49683 – Separate keep-alive and connection timeout with APR/native connector','','2010-08-01 15:40:53','Mark Thomas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 enhancement','bf4a544','Mark Emlyn David Thomas','2011-08-16 15:28:06','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49683 Use separate timeouts for socket  Timeout and keep-alive timeout','java/org/apache/coyote/ajp/AjpAprProtocol.java\njava/org/apache/coyote/http11/Http11AprProtocol.java\njava/org/apache/tomcat/util/net/AprEndpoint.java'),(781,51658,'Bug 51658 – Potential NPE in CoyoteAdapter.log','','2011-08-13 11:10:19','Felix Schumacher','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 trivial','5d55842','Mark Emlyn David Thomas','2011-08-16 04:46:07','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51658 Fix copy/paste error that could trigger an NPE. Based on a suggestion by Felix Schumacher','java/org/apache/catalina/connector/CoyoteAdapter.java'),(782,51654,'Bug 51654 – NullPointerException in startup (org.apache.catalina.startup.HostConfig.filterAppPaths) due to missing app base','A hard-to-diagnose NullPointerException at startup which can be bettered with an appropriate error message:\n\nINFO: Starting Servlet Engine: Apache Tomcat/7.0.19\njava.lang.NullPointerException\nat org.apache.catalina.startup.HostConfig.filterAppPaths(HostConfig.java:493)\nat org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:466)\nat org.apache.catalina.startup.HostConfig.start(HostConfig.java:1322)\nat org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:311)\nat org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\nat org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:89)\n\nOk, what\'s this about?\n\nIn \"protected String[] filterAppPaths(String[] unfilteredAppPaths)\"\nthe exception is raised at\n\n  for (String appPath : unfilteredAppPaths)\n\nWhich means the \"unfilteredAppPaths\" passed in is null. filterAppPaths does not check for that (shouldn\'t there be an assertion at least)\n\nThe problems comes from \"deployApps()\":\n\n    protected void deployApps() {\n\n        File appBase = appBase();\n        File configBase = configBase();\n        String[] filteredAppPaths = filterAppPaths(appBase.list()); <----\n        // Deploy XML descriptors from configBase\n        deployDescriptors(configBase, configBase.list());\n        // Deploy WARs, and loop if additional descriptors are found\n        deployWARs(appBase, filteredAppPaths);\n        // Deploy expanded folders\n        deployDirectories(appBase, filteredAppPaths);\n        \n    }\n\nWhere \"appBase.list()\" returns null. This must be because \"appBase\" does not actually denote a directory (A-HA!)\n\nIndeed, the server.xml points to a nonexisting appBase.\n\nSuggesting to add a check to \"deployApps\":\n\n    protected void deployApps() {\n\n        File appBase = appBase();\n        File configBase = configBase();\n\n        if (!appBase.exists() || appBase.list()==null) {\n            throw new IllegalArgumentException(\"The appBase \" + appBase + \" does not exist or cannot be listed\");\n        }\n\n        String[] filteredAppPaths = filterAppPaths(appBase.list()); <----\n        // Deploy XML descriptors from configBase\n        deployDescriptors(configBase, configBase.list());\n        // Deploy WARs, and loop if additional descriptors are found\n        deployWARs(appBase, filteredAppPaths);\n        // Deploy expanded folders\n        deployDirectories(appBase, filteredAppPaths);\n        \n    }\n\nThis probably violates some I18N requirement though.','2011-08-12 10:36:54','David Tonhofer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','c4d1631','Mark Emlyn David Thomas','2011-08-15 14:38:16','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51654 Log an error message if an appBase is specified that is not a directory and disable automatic deployment to prevent subsequent errors.','java/org/apache/catalina/startup/HostConfig.java\njava/org/apache/catalina/startup/LocalStrings.properties\njava/org/apache/catalina/startup/LocalStrings_es.properties\njava/org/apache/catalina/startup/LocalStrings_ja.properties'),(783,51583,'Bug 51583 – ConnectionPool.close() always waits one second unnecessarily','As discussed with Filip via mail: (just to do report it officially):\n\nI\'ve encountered an issue on closing the pool:\nClosing a ConnectionPool will always take at least one second if more than zero connections have been acquired.\nPlease have a look at ConnectionPool.java:367 :\n\n                    con = pool.poll(1000, TimeUnit.MILLISECONDS);\n\nImagine that we\'ve previously fetched the last connection out of the queue.\nIn this case the that command will cause that we\'ve to wait 1000ms (to return null).\n\nThe solution would be easy - just check prior to polling if the pool queue is empty.\n\nThe 1 second wait time is really annoying because I am creating and destroying the pool for each junit test which causes that each test will take more than 2 seconds (I am using two pools per test).','2011-07-29 08:10:00','Patric Rufflar','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','031beb4','Filip Hanik','2011-08-15 11:06:35','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51583','modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java'),(784,51653,'Bug 51653 – ServletRequestListener.requestDestroyed is called before request leaves a webapp','','2011-08-12 06:01:59','wheleph','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 major','685f4dc','Mark Emlyn David Thomas','2011-08-15 08:29:58','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51653 Move custom error handling from Host to Context.','java/org/apache/catalina/core/StandardContextValve.java\njava/org/apache/catalina/core/StandardHostValve.java\ntest/org/apache/catalina/core/TestStandardContextValve.java'),(785,51650,'Bug 51650 – possible nullpointer exception in RequestUtil.parseParameters','','2011-08-11 17:03:48','Felix Schumacher','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 trivial','7562fc1','Mark Emlyn David Thomas','2011-08-12 05:09:32','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51650 Code clean-up','java/org/apache/catalina/util/RequestUtil.java'),(786,51649,'Bug 51649 – Web documentation about listeners should mention ThreadLocalLeakPreventionListener','','2011-08-11 15:53:53','David Tonhofer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 normal','383702c','Mark Emlyn David Thomas','2011-08-12 05:00:24','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51649 Document ThreadLocalLeakPreventionListener','webapps/docs/config/listeners.xml'),(787,41718,'Bug 41718 – Status 302 response to GET request has no body when calling sendRedirect','RFC2616 (10.3.3 302 Found) says as follows:\n\n  Unless the request method was HEAD, the entity of the\n  response SHOULD contain a short hypertext note with a hyperlink to\n  the new URI(s).\n\nIn case HTTP redirect response is created without sendRedirect,\nservlet developers are responsible for its header and body.\nHowever, when calling sendRedirect, body with a hyperlink\nshould be included in the response.','2007-02-27 17:27:49','Minehiko IIDA','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Connector:Coyote','P2 enhancement','6a0244a','Mark Emlyn David Thomas','2011-08-11 04:13:56','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=41718 RFC2616 says redirects should include a response body.','java/org/apache/catalina/connector/LocalStrings.properties\njava/org/apache/catalina/connector/Response.java'),(788,41673,'Bug 41673 – Jasper output the message of compiling error using LF(\\n) on ANY OS.','Jasper output the message of compiling error using LF(\\n) on ANY OS.\nThis cannot be correctly displayed with Windows notepad.\n\nI think the line feed code along OS would be better, though I know other text \neditor solves this.','2007-02-21 17:37:02','Suzuki Yuichiro','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P5 enhancement','841e9fc','Mark Emlyn David Thomas','2011-08-10 14:37:56','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=41673 Use platform line endings when reporting error messages','java/org/apache/jasper/compiler/DefaultErrorHandler.java\njava/org/apache/jasper/compiler/ErrorDispatcher.java'),(789,51644,'Bug 51644 – Unable to deploy applications with the name a#b.xml','When I try to deploy a context with the name \"a#b.xml\" I get the following exception.\n\n\nSEVERE: Unable to process JNDI URL [jndi:/localhost/sample/one/WEB-INF/classes]\nfor annotations\njava.io.FileNotFoundException: jndi:/localhost/sample/one/WEB-INF/classes\n        at org.apache.naming.resources.DirContextURLConnection.list(DirContextUR\nLConnection.java:452)\n        at org.apache.catalina.startup.ContextConfig.processAnnotationsJndi(Cont\nextConfig.java:1901)\n        at org.apache.catalina.startup.ContextConfig.processAnnotationsUrl(Conte\nxtConfig.java:1828)\n        at org.apache.catalina.startup.ContextConfig.webConfig(ContextConfig.jav\na:1295)\n        at org.apache.catalina.startup.ContextConfig.configureStart(ContextConfi\ng.java:896)\n        at org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfi\ng.java:322)\n        at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(Lifecycl\neSupport.java:119)\n        at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBa\nse.java:89)\n        at org.apache.catalina.core.StandardContext.startInternal(StandardContex\nt.java:5103)\n        at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:145)\n        at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase\n.java:812)\n        at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:78\n7)\n        at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:607)\n\n        at org.apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.ja\nva:633)\n        at org.apache.catalina.startup.HostConfig.deployDescriptors(HostConfig.j\nava:558)\n        at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:468\n)\n        at org.apache.catalina.startup.HostConfig.check(HostConfig.java:1363)\n        at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java\n:294)\n        at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(Lifecycl\neSupport.java:119)\n        at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBa\nse.java:89)\n        at org.apache.catalina.core.ContainerBase.backgroundProcess(ContainerBas\ne.java:1233)\n        at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.p\nrocessChildren(ContainerBase.java:1391)\n        at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.p\nrocessChildren(ContainerBase.java:1401)\n        at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.r\nun(ContainerBase.java:1380)\n        at java.lang.Thread.run(Thread.java:619)\n\n\nI would have expected the application to be available in the URI a/b. The bug seems to be in the \"list()\" method \"of DirContextURLConnection.java. The method assumes that context name does not have any \"/\" characters in it. See the developer note just before the \"if\" block. I have added the \"else if\" condition that seems to have solved the problem for me.\n\n            try {\n                String file = getURL().getFile();\n                // This will be of the form /<hostname>/<contextpath>/file name\n                // if <contextpath> is not empty otherwise this will be of the\n                // form /<hostname>/file name\n                // Strip off the hostname and the contextpath\n                int start;\n                if(context instanceof ProxyDirContext &&\n                        \"\".equals(((ProxyDirContext)context).getContextPath())){\n                    start = file.indexOf(\'/\',1);\n                }\n                else if(context instanceof ProxyDirContext){\n                	start=\"/\".length()\n                			+((ProxyDirContext)context).getHostName().length()\n                			+((ProxyDirContext)context).getContextPath().length();\n                	/*\n                	 * Seems like a bug in Tomcat. below was the code in Tomcat.\n                	 * How can it handle contextpath like \"/sample/one\". It cannot\n                	 */\n                    //start = file.indexOf(\'/\', file.indexOf(\'/\', 1) + 1);\n                } else\n                	start = file.indexOf(\'/\', file.indexOf(\'/\', 1) + 1);\n                \n                NamingEnumeration<NameClassPair> enumeration =\n                    context.list(file.substring(start));\n                while (enumeration.hasMoreElements()) {\n                    NameClassPair ncp = enumeration.nextElement();\n                    result.addElement(ncp.getName());\n                }\n            } catch (NamingException e) {','2011-08-10 10:00:36','Suveer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 regression','bb7072c','Mark Emlyn David Thomas','2011-08-10 13:57:25','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51644 Annotation scanning was broken for contexts with a multi-level context path such as /a/b','java/org/apache/naming/resources/DirContextURLConnection.java'),(790,51640,'Bug 51640 – clearReferencesJdbc seems to be causing leaks with com.oracle.ojdbc5 driver','','2011-08-10 00:21:38','Patrick M','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','cd2fecd','Mark Emlyn David Thomas','2011-08-10 09:22:52','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51640 Improve memory leak protection for DriverManager','java/org/apache/catalina/core/JreMemoryLeakPreventionListener.java\nwebapps/docs/config/listeners.xml'),(791,51641,'Bug 51641 – Http11NioProcessor not correct release','org.apache.coyote.http11.Http11NioProtocol.Http11ConnectionHandler\n\ncode segment:\n==================================\n        @Override\n        public void release(SocketWrapper<NioChannel> socket) {\n            Http11NioProcessor processor = connections.remove(socket);\n            if (processor != null) {\n                processor.recycle();\n                recycledProcessors.offer(processor);\n            }\n        }\n==================================\n\nshould be:\n==================================\n        @Override\n        public void release(SocketWrapper<NioChannel> socket) {\n            Http11NioProcessor processor = connections.remove(socket.getSocket());\n            if (processor != null) {\n                processor.recycle();\n                recycledProcessors.offer(processor);\n            }\n        }\n==================================\n\ntype of connections is ConcurrentHashMap<NioChannel, Http11NioProcessor> ,\nnot ConcurrentHashMap<SocketWrapper<NioChannel>, Http11NioProcessor>.','2011-08-10 03:37:44','zhh','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 normal','7ffca5b','Mark Emlyn David Thomas','2011-08-10 07:43:09','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51641 Connections map uses NioChannel, not <SocketWrapper<NioChannel>','java/org/apache/coyote/http11/Http11NioProtocol.java'),(792,51621,'Bug 51621 – Missing jars in Deployer','I put to ANT classpath all jars included in \"apache-tomcat-7.0.19-deployer.zip\" (\"lib\" dir).\nTrying to run the Deployer ANT task \"undeploy\", I got:\n\njava.lang.NoClassDefFoundError: org/apache/tomcat/util/buf/B2CConverter\n\nI added to ANT classpath \"tomcat-coyote.jar\" from Tomcat core distribution (apache-tomcat-7.0.19-windows-x64.zip), and I got:\n\njava.lang.NoClassDefFoundError: org/apache/tomcat/util/res/StringManager\n\nI added to ANT classpath \"tomcat-util.jar\" from Tomcat core distribution (apache-tomcat-7.0.19-windows-x64.zip), and finally I got the task successfully executed.\n\nTherefore, I guess the Deployer distribution should include \"tomcat-coyote.jar\" and \"tomcat-util.jar\".','2011-08-05 10:33:26','Silvio Corciolani','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Packaging','P2 normal','242c572','Mark Emlyn David Thomas','2011-08-05 14:08:53','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51621 Add additional required JARs to the deployer distribution.','build.xml\nwebapps/docs/changelog.xml'),(793,51615,'Bug 51615 – Line 267 of \"org.apache.tomcat.jdbc.pool.PooledConnection\": double assignment typo','Nothing bad here, but my compiler lights up:\n\nconnection = connection = driver.connect(driverURL, properties);\n\nClearly, to be fixed.','2011-08-04 19:14:11','David Tonhofer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','8c41e9c','Mark Emlyn David Thomas','2011-08-05 13:17:48','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51615 Code clean-up.','modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/PooledConnection.java'),(794,51610,'Bug 51610 – Context fails to reload after an error in web.xml was corrected','With current trunk. Steps to reproduce:\n\n1. Start Tomcat 7\n\n2. Go to webapps/examples/WEB-INF/web.xml and uncomment <filter-mapping> for \"Timing Filter\" (line 75).\n\n3. Wait several seconds. The examples webapp is reloaded, but fails to start. \n\nThis happens because there is a typo. The <filter-name> value should be\ns/Timing Filter/Timing filter/.\n\nThere is stack trace in the logs:\n\n[[[\n04.08.2011 8:09:39 org.apache.catalina.startup.HostConfig checkResources\nWARNING: Error during context [/examples] restart\njava.lang.IllegalArgumentException: Filter mapping specifies an unknown filter name Timing Filter\n	at org.apache.catalina.core.StandardContext.validateFilterMap(StandardContext.java:2950)\n	at org.apache.catalina.core.StandardContext.addFilterMap(StandardContext.java:2915)\n	at org.apache.catalina.deploy.WebXml.configureContext(WebXml.java:1206)\n	at org.apache.catalina.startup.ContextConfig.webConfig(ContextConfig.java:1343)\n	at org.apache.catalina.startup.ContextConfig.configureStart(ContextConfig.java:896)\n	at org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:322)\n	at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\n	at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:89)\n	at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5103)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:145)\n	at org.apache.catalina.startup.HostConfig.checkResources(HostConfig.java:1279)\n	at org.apache.catalina.startup.HostConfig.check(HostConfig.java:1360)\n	at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:294)\n	at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\n	at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:89)\n	at org.apache.catalina.core.ContainerBase.backgroundProcess(ContainerBase.java:1240)\n	at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1398)\n	at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1408)\n	at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.run(ContainerBase.java:1387)\n	at java.lang.Thread.run(Thread.java:662)\n]]]\n\n4. Go to web.xml and edit it once again. E.g. re-comment the mapping, or correct the typo.\n\n5. Wait several seconds. Here is an issue:\n\nEXPECTED: The examples webapp should reload successfully.\nACTUAL: Reload fails. The following is printed in the logs:\n\n04.08.2011 8:09:59 org.apache.catalina.startup.HostConfig checkResources\nINFO: Reloading context [/examples]\n04.08.2011 8:09:59 org.apache.catalina.util.LifecycleBase start\nINFO: The start() method was called on component [StandardEngine[Catalina].StandardHost[localhost].StandardContext[/examples]] after start() had already been called. The second call will be ignored.\n\n\n6. Stop Tomcat. Here is the second issue:\n\nEXPECTED: Successful shutdown\nACTUAL: \n[[[\n04.08.2011 8:14:10 org.apache.catalina.startup.Catalina stop\nSEVERE: Catalina.stop\norg.apache.catalina.LifecycleException: An invalid Lifecycle transition was attempted ([before_stop]) for component [StandardEngine[Catalina].StandardHost[localhost].StandardContext[/examples]] in state [STARTING_PREP]\n	at org.apache.catalina.util.LifecycleBase.invalidTransition(LifecycleBase.java:387)\n	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:212)\n	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:1072)\n	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:225)\n	at org.apache.catalina.core.ContainerBase.stopInternal(ContainerBase.java:1072)\n	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:225)\n	at org.apache.catalina.core.StandardService.stopInternal(StandardService.java:502)\n	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:225)\n	at org.apache.catalina.core.StandardServer.stopInternal(StandardServer.java:748)\n	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:225)\n	at org.apache.catalina.startup.Catalina.stop(Catalina.java:694)\n	at org.apache.catalina.startup.Catalina$CatalinaShutdownHook.run(Catalina.java:847)\n]]]\n\nThis exception at shutdown happens only if examples webapp was correct when Tomcat started, but was broken afterwards. If it was already broken at startup time, nothing happens.\n\n7. Here is the third issue: when the above happens the shutdown sequence is apparently aborted abnormally.\n\nEXPECTED: \"INFO: Stopping ProtocolHandler [\"http-bio-8080\"]\" etc. messages\nACTUAL: There are no messages after the \"SEVERE: Catalina.stop\" one that I cited above.','2011-08-04 04:28:49','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','ed0588b','Mark Emlyn David Thomas','2011-08-05 12:29:58','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51610 Make lifecycle transitions more robust at handling unchecked exceptions','java/org/apache/catalina/util/LifecycleBase.java\njava/org/apache/catalina/util/LocalStrings.properties\nwebapps/docs/changelog.xml'),(795,51614,'Bug 51614 – PersistentManager loads session from Store and calls session.expire() twice.','To check whether session is loaded into  memory, StoreBase#processExpires calls findSession(id). \n\n=====\n...\nif (manager.findSession(keys[i]) != null) {\n    isLoaded = true;\n}\n...\n=====\n\nHowever, PersistentManager#findSession(id) loads session from Store when there is no session in memory. \nBecause session loaded from Store is an invalid session\nPersistentManager logs errorlog, calls session.expire(), and deletes session from Store. \n\nAs a result, findSession(id) returns null, and isLoaded becomes false. \nAnd, session.expire() is called again, and the session is deleted from Store.\n\nIf manager is PersistentManager, it is necessary to call PersistentManagerBase#isLoaded(id). \nHowever, to avoid regression of r1033024, other managers call findSession(id).\n\nBest regards.','2011-08-04 11:19:47','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','29e9966','Keiichi Fujino','2011-08-04 07:45:53','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51614 Avoid two times calls of store.load() and session.expire() in PersistentManager.','java/org/apache/catalina/session/StoreBase.java\nwebapps/docs/changelog.xml'),(796,51588,'Bug 51588 – Change access modifiers in AccessLogValve to make it easier to extend','I\'m adding some fields to a subclass of org.apache.catalina.valves.AccessLogValve but createLogElements() is the closest extension point available. Rather than reimplement the functionality there it would be preferable if both of the createAccessLogElement() methods were protected rather than private then it\'s a simple method of matching the char you want to use and falling back to super.createAccessLogElement().','2011-07-30 02:33:45','Rod','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 minor','77213bb','Mark Emlyn David Thomas','2011-07-31 13:39:25','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51588 Make it easier to extend the AccessLogValve to add support for custom elements.','java/org/apache/catalina/valves/AccessLogValve.java\nwebapps/docs/changelog.xml'),(797,51586,'Bug 51586 – ContextConfig.checkHandlesTypes() doesn\'t check for VerifyError when loading class','I\'ve recently upgraded to Tomcat 7 and used to run with metadata-complete=\"true\" in my web.xml.  With Servlet 3 I decided I\'d try some of the annotation features.  When I turned off metadata-complete I got a VerifyError trying to load one of my classes.  This class is meant to only work on Tomcat 6 so the fact Tomcat 7 cannot load this class is expected.  What is not expected is that Tomcat 7 doesn\'t just ignore the error and continue scanning for annotations.  Looking in ContextConfig.checkHandlesTypes() I checks for virtually every type of loading failure except VerifyError.  Perhaps VerifyError should be added to this list?\n\njava.lang.VerifyError: class org.lds.stack.tomcat.decrypt.DecryptingStandardContext overrides final method start.()V\n	at java.lang.ClassLoader.defineClass1(Native Method)\n	at java.lang.ClassLoader.defineClassCond(ClassLoader.java:631)\n	at java.lang.ClassLoader.defineClass(ClassLoader.java:615)\n	at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:141)\n	at java.net.URLClassLoader.defineClass(URLClassLoader.java:283)\n	at java.net.URLClassLoader.access$000(URLClassLoader.java:58)\n	at java.net.URLClassLoader$1.run(URLClassLoader.java:197)\n	at java.security.AccessController.doPrivileged(Native Method)\n	at java.net.URLClassLoader.findClass(URLClassLoader.java:190)\n	at java.lang.ClassLoader.loadClass(ClassLoader.java:306)\n	at java.lang.ClassLoader.loadClass(ClassLoader.java:247)\n	at java.lang.Class.forName0(Native Method)\n	at java.lang.Class.forName(Class.java:247)\n	at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1665)\n	at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1523)\n	at org.apache.catalina.startup.ContextConfig.checkHandlesTypes(ContextConfig.java:2006)\n	at org.apache.catalina.startup.ContextConfig.processAnnotationsStream(ContextConfig.java:1969)\n	at org.apache.catalina.startup.ContextConfig.processAnnotationsJar(ContextConfig.java:1858)\n	at org.apache.catalina.startup.ContextConfig.processAnnotationsUrl(ContextConfig.java:1826)\n	at org.apache.catalina.startup.ContextConfig.processAnnotations(ContextConfig.java:1812)\n	at org.apache.catalina.startup.ContextConfig.webConfig(ContextConfig.java:1306)\n	at org.apache.catalina.startup.ContextConfig.configureStart(ContextConfig.java:896)\n	at org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:322)\n	at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\n	at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:89)\n	at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5103)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:145)\n	at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:812)\n	at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:787)\n	at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:607)\n	at org.apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.java:633)\n	at org.apache.catalina.startup.HostConfig.deployDescriptors(HostConfig.java:558)\n	at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:468)\n	at org.apache.catalina.startup.HostConfig.start(HostConfig.java:1322)\n	at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:311)\n	at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\n	at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:89)\n	at org.apache.catalina.util.LifecycleBase.setStateInternal(LifecycleBase.java:379)\n	at org.apache.catalina.util.LifecycleBase.setState(LifecycleBase.java:324)\n	at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:1041)\n	at org.apache.catalina.core.StandardHost.startInternal(StandardHost.java:774)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:145)\n	at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:1033)\n	at org.apache.catalina.core.StandardEngine.startInternal(StandardEngine.java:291)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:145)\n	at org.apache.catalina.core.StandardService.startInternal(StandardService.java:443)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:145)\n	at org.apache.catalina.core.StandardServer.startInternal(StandardServer.java:727)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:145)\n	at org.apache.catalina.startup.Catalina.start(Catalina.java:621)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n	at java.lang.reflect.Method.invoke(Method.java:597)\n	at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:322)\n	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:450)','2011-07-29 19:25:49','Mike Youngstrom','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','0b340ac','Mark Emlyn David Thomas','2011-07-31 13:08:43','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51586 Expand error handling to cover anything that is recoverable (or might be recoverable) when loading classes during HandlesTypes processing.','java/org/apache/catalina/startup/ContextConfig.java\nwebapps/docs/changelog.xml'),(798,51584,'Bug 51584 – Crash (infinite loop) when files starting with \'#\' are in the library tree','','2011-07-29 15:34:27','Steven R. Loomis','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 major','838c2ee','Mark Emlyn David Thomas','2011-07-31 12:59:39','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51584 Ensure file paths are encoded/decoded when translated to/from URLs so special characters don\'t cause issues.','java/org/apache/naming/resources/DirContextURLConnection.java\nwebapps/docs/changelog.xml'),(799,51567,'Bug 51567 – Classloader docs don\'t address CATALINA_BASE','','2011-07-27 18:20:34','Jon Wilmoth','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 normal','3ddade6','Mark Emlyn David Thomas','2011-07-29 08:52:26','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51567 Update the class loading page of the documentation web application to include information on the search order for the common class loader when separate values are used for $CATALINA_HOME and $CATALINA_BASE.','webapps/docs/changelog.xml\nwebapps/docs/class-loader-howto.xml'),(800,48997,'Bug 48997 – enhance ssl-howto documentation','1) Please, briefly describe what a keystore is.\n\n2) typo: \"withinthe\" => \"within the\"\n\n3) Document that keystore password cannot be empty. Mention following scenarion in the Troubleshooting section:\n\nI created my keystore using \"openssl pkcs12 ...\" and entered an empty password. After restarting Tomcat, catalina log contained \"java.io.IOException: failed to decrypt safe contents entry: java.lang.ArithmeticException: / by zero\"','2010-03-26 16:14:47','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Webapps:Documentation','P2 enhancement','84d6296','Mark Emlyn David Thomas','2011-07-27 11:11:35','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48997 Fixed some typos and correct cross-referencing to the HTTP Connector documentation with the SSL How-To page of the documentation web application.','webapps/docs/changelog.xml\nwebapps/docs/ssl-howto.xml'),(801,49122,'Bug 49122 – Update of ROOT application index.html','The patch adds a new paragraph at the top of the page, recommending that users join the low volume Tomcat Announce list and adds a link to the appropriate subscription email address.\n\nThe patch also replaces the table based layout with a standards compliant CSS version, which is largely visually identical.','2010-04-14 09:40:44','Pid','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Examples','P2 enhancement','10feebb','Mark Emlyn David Thomas','2011-07-27 08:23:28','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49122 Layout improvements and tweaks','webapps/ROOT/index.jsp\nwebapps/ROOT/tomcat.css\nwebapps/docs/changelog.xml'),(802,51561,'Bug 51561 – Missing tomcat-coyote.jar from classpath requirement on Realm HowTo page, digested passwords section','','2011-07-26 16:48:01','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 normal','a929a8f','Mark Emlyn David Thomas','2011-07-27 05:13:36','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51561 Recommend the use of digest.[bat|sh] to generate digests rather than calling RealmBase directly.','webapps/docs/changelog.xml\nwebapps/docs/realm-howto.xml'),(803,51557,'Bug 51557 – Newline during a http header field name obscures next value','','2011-07-26 06:12:43','Henri Yandell','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 normal','6200dd9','Mark Emlyn David Thomas','2011-07-27 05:10:11','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51557 Ignore HTTP headers that do not comply with RFC 2616 and use header names that are not tokens.','java/org/apache/coyote/http11/AbstractInputBuffer.java\njava/org/apache/coyote/http11/InternalAprInputBuffer.java\njava/org/apache/coyote/http11/InternalInputBuffer.java\njava/org/apache/coyote/http11/InternalNioInputBuffer.java\njava/org/apache/coyote/http11/LocalStrings.properties\ntest/org/apache/coyote/http11/TestInternalInputBuffer.java\nwebapps/docs/changelog.xml'),(804,51545,'Bug 51545 – make threadname available in ExtendedAccessLogValve','','2011-07-23 09:07:02','Felix Schumacher','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','00a1fdf','Tim Whittington','2011-07-26 05:41:36','https://issues.apache.org/bugzilla/show_bug.cgi?id=51545','java/org/apache/catalina/valves/ExtendedAccessLogValve.java\nwebapps/docs/changelog.xml\nwebapps/docs/config/valve.xml'),(805,51555,'Bug 51555 – An invalid Lifecycle transition ([before_stop]) for component in state [INITIALIZED]: MapperListener','','2011-07-25 21:40:38','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','95d67fe','Mark Emlyn David Thomas','2011-07-26 04:25:46','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51555 Permit an additional lifecycle transition. Allow destroy() to be called on components that are initialized. This can occur in some start failure scenarios.','java/org/apache/catalina/Lifecycle.java\njava/org/apache/catalina/util/LifecycleBase.java\nwebapps/docs/changelog.xml'),(806,51550,'Bug 51550 – Empty response instead of error page for IllegalStateException','','2011-07-25 13:22:52','Mark Thomas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','50a7e22','Mark Emlyn David Thomas','2011-07-25 15:45:04','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51550 Stop the adaptor swallowing internal errors.','java/org/apache/catalina/connector/CoyoteAdapter.java\njava/org/apache/catalina/connector/LocalStrings.properties\njava/org/apache/catalina/connector/LocalStrings_es.properties\njava/org/apache/catalina/connector/LocalStrings_fr.properties\njava/org/apache/catalina/connector/LocalStrings_ja.properties\nwebapps/docs/changelog.xml'),(807,51544,'Bug 51544 – EL parser problem for EmptyList','When I return Collections.emptyList() and then use ${list.isEmpty()} in a JSP, a problem occurs (see below). It didn\'t occur in older Tomcat 7 versions (like 7.0.5).\n\n15:             ${user.names}<br />\n16:         </div>\n17:     </c:forEach>\n18:     <c:if test=\"${users.isEmpty()}\">\n19:         <div>${msg.noResults}</div>\n20:     </c:if>\n21: </div>\n\n\nStacktrace:] with root cause\njava.lang.IllegalAccessException: Class javax.el.BeanELResolver can not access a member of class java.util.Collections$EmptyList with modifiers \"public\"\n	at sun.reflect.Reflection.ensureMemberAccess(Reflection.java:95)\n	at java.lang.reflect.Method.invoke(Method.java:607)\n	at javax.el.BeanELResolver.invoke(BeanELResolver.java:467)\n	at javax.el.CompositeELResolver.invoke(CompositeELResolver.java:161)\n	at org.apache.el.parser.AstValue.getValue(AstValue.java:159)\n	at org.apache.el.ValueExpressionImpl.getValue(ValueExpressionImpl.java:189)\n	at org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate(PageContextImpl.java:985)\n	at org.apache.jsp.WEB_002dINF.jsp.externalUsers_jsp._jspx_meth_c_005fif_005f2(externalUsers_jsp.java:2060)\n	at org.apache.jsp.WEB_002dINF.jsp.externalUsers_jsp._jspService(externalUsers_jsp.java:396)\n	at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)\n	at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:433)\n	at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:389)\n	at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:333)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:304)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n	at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:684)\n	at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:471)\n	at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:402)\n	at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:329)\n	at org.springframework.web.servlet.view.InternalResourceView.renderMergedOutputModel(InternalResourceView.java:238)\n	at org.springframework.web.servlet.view.AbstractView.render(AbstractView.java:262)\n	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1120)\n	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:890)','2011-07-23 08:17:58','bozho','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','c8ac1a0','Mark Emlyn David Thomas','2011-07-25 12:23:39','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51544 Correctly resolve bean methods in EL so accessible methods that are overridden by inaccessible methods do not cause an IllegalAccessException. Modify test case to catch this problem on Oracle and OpenJDK JREs.','java/javax/el/BeanELResolver.java\ntest/org/apache/el/TestValueExpressionImpl.java\nwebapps/docs/changelog.xml'),(808,51544,'Bug 51544 – EL parser problem for EmptyList','When I return Collections.emptyList() and then use ${list.isEmpty()} in a JSP, a problem occurs (see below). It didn\'t occur in older Tomcat 7 versions (like 7.0.5).\n\n15:             ${user.names}<br />\n16:         </div>\n17:     </c:forEach>\n18:     <c:if test=\"${users.isEmpty()}\">\n19:         <div>${msg.noResults}</div>\n20:     </c:if>\n21: </div>\n\n\nStacktrace:] with root cause\njava.lang.IllegalAccessException: Class javax.el.BeanELResolver can not access a member of class java.util.Collections$EmptyList with modifiers \"public\"\n	at sun.reflect.Reflection.ensureMemberAccess(Reflection.java:95)\n	at java.lang.reflect.Method.invoke(Method.java:607)\n	at javax.el.BeanELResolver.invoke(BeanELResolver.java:467)\n	at javax.el.CompositeELResolver.invoke(CompositeELResolver.java:161)\n	at org.apache.el.parser.AstValue.getValue(AstValue.java:159)\n	at org.apache.el.ValueExpressionImpl.getValue(ValueExpressionImpl.java:189)\n	at org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate(PageContextImpl.java:985)\n	at org.apache.jsp.WEB_002dINF.jsp.externalUsers_jsp._jspx_meth_c_005fif_005f2(externalUsers_jsp.java:2060)\n	at org.apache.jsp.WEB_002dINF.jsp.externalUsers_jsp._jspService(externalUsers_jsp.java:396)\n	at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)\n	at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:433)\n	at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:389)\n	at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:333)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:304)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n	at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:684)\n	at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:471)\n	at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:402)\n	at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:329)\n	at org.springframework.web.servlet.view.InternalResourceView.renderMergedOutputModel(InternalResourceView.java:238)\n	at org.springframework.web.servlet.view.AbstractView.render(AbstractView.java:262)\n	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1120)\n	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:890)','2011-07-23 08:17:58','bozho','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','bccb43a','Mark Emlyn David Thomas','2011-07-24 07:12:58','Another test case for bug 51544','test/org/apache/el/TestELInJsp.java\ntest/webapp-3.0/bug51544.jsp'),(809,51544,'Bug 51544 – EL parser problem for EmptyList','When I return Collections.emptyList() and then use ${list.isEmpty()} in a JSP, a problem occurs (see below). It didn\'t occur in older Tomcat 7 versions (like 7.0.5).\n\n15:             ${user.names}<br />\n16:         </div>\n17:     </c:forEach>\n18:     <c:if test=\"${users.isEmpty()}\">\n19:         <div>${msg.noResults}</div>\n20:     </c:if>\n21: </div>\n\n\nStacktrace:] with root cause\njava.lang.IllegalAccessException: Class javax.el.BeanELResolver can not access a member of class java.util.Collections$EmptyList with modifiers \"public\"\n	at sun.reflect.Reflection.ensureMemberAccess(Reflection.java:95)\n	at java.lang.reflect.Method.invoke(Method.java:607)\n	at javax.el.BeanELResolver.invoke(BeanELResolver.java:467)\n	at javax.el.CompositeELResolver.invoke(CompositeELResolver.java:161)\n	at org.apache.el.parser.AstValue.getValue(AstValue.java:159)\n	at org.apache.el.ValueExpressionImpl.getValue(ValueExpressionImpl.java:189)\n	at org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate(PageContextImpl.java:985)\n	at org.apache.jsp.WEB_002dINF.jsp.externalUsers_jsp._jspx_meth_c_005fif_005f2(externalUsers_jsp.java:2060)\n	at org.apache.jsp.WEB_002dINF.jsp.externalUsers_jsp._jspService(externalUsers_jsp.java:396)\n	at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)\n	at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:433)\n	at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:389)\n	at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:333)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:304)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n	at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:684)\n	at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:471)\n	at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:402)\n	at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:329)\n	at org.springframework.web.servlet.view.InternalResourceView.renderMergedOutputModel(InternalResourceView.java:238)\n	at org.springframework.web.servlet.view.AbstractView.render(AbstractView.java:262)\n	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1120)\n	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:890)','2011-07-23 08:17:58','bozho','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','8f0bf12','Mark Emlyn David Thomas','2011-07-24 06:59:10','Add tests for bug 51544 (note tests pass - can\'t reproduce error yet)','test/org/apache/el/TesterBeanA.java'),(810,51544,'Bug 51544 – EL parser problem for EmptyList','When I return Collections.emptyList() and then use ${list.isEmpty()} in a JSP, a problem occurs (see below). It didn\'t occur in older Tomcat 7 versions (like 7.0.5).\n\n15:             ${user.names}<br />\n16:         </div>\n17:     </c:forEach>\n18:     <c:if test=\"${users.isEmpty()}\">\n19:         <div>${msg.noResults}</div>\n20:     </c:if>\n21: </div>\n\n\nStacktrace:] with root cause\njava.lang.IllegalAccessException: Class javax.el.BeanELResolver can not access a member of class java.util.Collections$EmptyList with modifiers \"public\"\n	at sun.reflect.Reflection.ensureMemberAccess(Reflection.java:95)\n	at java.lang.reflect.Method.invoke(Method.java:607)\n	at javax.el.BeanELResolver.invoke(BeanELResolver.java:467)\n	at javax.el.CompositeELResolver.invoke(CompositeELResolver.java:161)\n	at org.apache.el.parser.AstValue.getValue(AstValue.java:159)\n	at org.apache.el.ValueExpressionImpl.getValue(ValueExpressionImpl.java:189)\n	at org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate(PageContextImpl.java:985)\n	at org.apache.jsp.WEB_002dINF.jsp.externalUsers_jsp._jspx_meth_c_005fif_005f2(externalUsers_jsp.java:2060)\n	at org.apache.jsp.WEB_002dINF.jsp.externalUsers_jsp._jspService(externalUsers_jsp.java:396)\n	at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)\n	at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:433)\n	at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:389)\n	at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:333)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:304)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n	at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:684)\n	at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:471)\n	at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:402)\n	at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:329)\n	at org.springframework.web.servlet.view.InternalResourceView.renderMergedOutputModel(InternalResourceView.java:238)\n	at org.springframework.web.servlet.view.AbstractView.render(AbstractView.java:262)\n	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1120)\n	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:890)','2011-07-23 08:17:58','bozho','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','d89492e','Mark Emlyn David Thomas','2011-07-24 06:58:36','Add tests for bug 51544 (note tests pass - can\'t reproduce error yet) Fix some find bugs issues','test/org/apache/el/TestValueExpressionImpl.java'),(811,41709,'Bug 41709 – When calling the API that relates to the buffer after the response is committed, ISE with no messages is thrown.','After the response is committed, following API throws IllegalStateException.\nIt\'s O.K. but the message of the exception is not set.\n\n- HttpServletResponse#resetBuffer\n- HttpServletResponse#sendError\n- HttpServletResponse#sendRedirect\n- HttpServletResponse#setBufferSize\n\nTo understand the bug of the application, it is hoped that the message is set \nlike other exceptions.','2007-02-26 17:43:51','Suzuki Yuichiro','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P3 enhancement','8baaa98','Mark Emlyn David Thomas','2011-07-22 14:09:54','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=41709 Provide exception messages for ISEs when response is already committed','java/org/apache/catalina/connector/LocalStrings.properties\njava/org/apache/catalina/connector/ResponseFacade.java\nwebapps/docs/changelog.xml'),(812,41498,'Bug 41498 – allRolesMode Realm configuration option not documented','This option needs to be included in the Realm Configuration HOW-TO Common\nfeatures section and possibly in the specific Realm Element attributes tables.\n\nOptionally, the API should be made clearer about the linkage between the server\nXML attributes and properties.  This linkage is not obvious without a deep\nunderstanding of Tomcat internals. IMHO, the BaseRealm classes are designed for\n\"public\" consumption and the API docs should reflect that.','2007-01-30 09:39:15','G Monroe','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Webapps:Documentation','P2 enhancement','0f4c8d8','Mark Emlyn David Thomas','2011-07-22 08:09:13','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=41498 Add info for allRolesMode','webapps/docs/changelog.xml\nwebapps/docs/config/realm.xml'),(813,51056,'Bug 51056 – Disable / drop support for SSLv2','','2011-04-13 14:12:26','drazzib','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Native','Library','P2 normal','4d9fcc0','Jean-Frederic Clere','2011-07-21 05:40:03','Fix for 51056. remove SSLv2 from all. Needs native 1.1.21. Now to allow SSLv2 you have to use: SSLProtocol=\"SSLv2+SSLv3\" for example.','java/org/apache/tomcat/jni/SSL.java'),(814,51532,'Bug 51532 – Performance Issue when retriving JAR files during TLD file parsing.','','2011-07-19 21:47:15','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','bcee77d','Mark Emlyn David Thomas','2011-07-20 15:41:18','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51532 JSP files with dependencies in JARs were recompiled on every access leading to poor performance.','java/org/apache/jasper/compiler/Compiler.java\nwebapps/docs/changelog.xml'),(815,50394,'Bug 50394 – InternalAprInputBuffer.fill() doesn\'t deal correctly with EOF','I\'m using tomcat-native-1.1.20 and tomcat-6.0.29 on CentOS 5.5, and I\'ve written a servlet that is sent large (gigabyte) streams of bytes over HTTP.\n\nFrom time to time it fails with the following stacktrace:\n\n\nCaused by: java.io.IOException\n        at org.apache.coyote.http11.InternalAprInputBuffer.fill(InternalAprInputBuffer.java:798)\n        at org.apache.coyote.http11.InternalAprInputBuffer$SocketInputBuffer.doRead(InternalAprInputBuffer.java:827)\n        at org.apache.coyote.http11.filters.IdentityInputFilter.doRead(IdentityInputFilter.java:116)\n        at org.apache.coyote.http11.InternalAprInputBuffer.doRead(InternalAprInputBuffer.java:738)\n        at org.apache.coyote.Request.doRead(Request.java:428)\n        at org.apache.catalina.connector.InputBuffer.realReadBytes(InputBuffer.java:304)\n        at org.apache.tomcat.util.buf.ByteChunk.substract(ByteChunk.java:403)\n        at org.apache.catalina.connector.InputBuffer.read(InputBuffer.java:327)\n        at org.apache.catalina.connector.CoyoteInputStream.read(CoyoteInputStream.java:193)\n        at java.io.BufferedInputStream.read1(BufferedInputStream.java:273)\n        at java.io.BufferedInputStream.read(BufferedInputStream.java:334)\n        at java.io.FilterInputStream.read(FilterInputStream.java:107)\n[...]\n\n\nUnfortunately, InternalAprInputBuffer throws away the error code on line 798, but I\'ve run it under a debugger and nRead was -70014.\n\nIf you look in the source of apr-1.3.8 at include/apr_errno.h, you\'ll see this is -APR_EOF.\n\nThe bug is in the implementation of recvbb at line 892 onwards in tomcat-native-1.1.20-src/jni/native/src/network.c. Specifically, at the end of the function we check for APR_SUCCESS, and assume all other codes are an error, returning -ss. It should also check for EOF (APR_STATUS_IS_EOF), and return zero. (Or at least, InternalAprInputBuffer assumes that a return code of 0 <=> EOF).\n\nIncidentally, apr-1.3.8/include/apr_network_io.h says in its comment on apr_socket_recv() that \"It is possible for both bytes to be received and an APR_EOF or other error to be returned.\". This is a lie. All provided implementations of apr_socket_recv return with *len == 0 in case of APR_EOF.','2010-12-01 11:38:03','Hugh Warrington','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Native','Library','P2 normal','b84397e','Jean-Frederic Clere','2011-07-20 11:28:05','Improve fix for PR50394 Requires native 1.1.21','java/org/apache/coyote/http11/InternalAprInputBuffer.java'),(816,51516,'Bug 51516 – org.apache.catalina.SSO_SESSION_COOKIE_NAME vs org.apache.catalina.authenticator.Constants.SSO_SESSION_COOKIE_NAME','In Apache Tomcat Configuration Reference - System Properties document, It has been suggested to use system variable org.apache.catalina.SSO_SESSION_COOKIE_NAME to change single sign on session cookie name. It\'s not working.\n\n\nAfter analyzing tomcat source, Its found that, we have to use org.apache.catalina.authenticator.Constants.SSO_SESSION_COOKIE_NAME instead of org.apache.catalina.SSO_SESSION_COOKIE_NAME. Please correct Apache Tomcat Configuration Reference document.\n\n\nIn org.apache.catalina.authenticator.Constants.Java\n\npublic static final String SINGLE_SIGN_ON_COOKIE = System.getProperty(            \"org.apache.catalina.authenticator.Constants.SSO_SESSION_COOKIE_NAME\",\"JSESSIONIDSSO\");','2011-07-16 19:28:46','Mathan','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P2 normal','2de6b52','Mark Emlyn David Thomas','2011-07-19 15:19:45','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51516 Correct property to change SSO session cookie name','webapps/docs/changelog.xml\nwebapps/docs/config/systemprops.xml'),(817,51531,'Bug 51531 – Eclipse .classpath references old ECJ version','The ECJ version referenced by the current Eclipse .classpath resource on trunk is 3.6.2.  The reference Ant build uses ECJ 3.7.','2011-07-19 18:24:48','Ian Brandt','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Integration','P2 normal','f21d093','Mark Emlyn David Thomas','2011-07-19 14:49:03','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51531 Update for ecj 3.7','res/ide-support/eclipse/eclipse.classpath\nwebapps/docs/changelog.xml'),(818,51509,'Bug 51509 – Csrf Prevention Filter\'s LruCache is not thread save','The LruCache (org.apache.catalina.filters.CsrfPreventionFilter$LruCache) use by Csrf Prevention Filter is base on LinkedHashMap.\n\nFrom the LinkedHashMap Java Doc:\nNote that this implementation is not synchronized.\nIf multiple threads access a linked hash map concurrently, and at least one of the threads modifies the map structurally, it must be synchronized externally. ...\n\nBut the LruCache implementation does not synchronize the access to the map.','2011-07-14 14:54:22','Ralph','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 minor','400745e','Mark Emlyn David Thomas','2011-07-19 14:20:23','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51509 Fix potential concurrency issue in CSRF prevention filter that may lead to some requests failing that should not.','java/org/apache/catalina/filters/CsrfPreventionFilter.java\ntest/org/apache/catalina/filters/TestCsrfPreventionFilter2.java\nwebapps/docs/changelog.xml'),(819,51518,'Bug 51518 – \"/absolute-ordering/name/others\" should not include \"name\" element','method:\norg.apache.catalina.startup.WebRuleSet.addRuleInstances(Digester digester)\n\n\ncode:\n====================================================\ndigester.addCallMethod(fullPrefix + \"/absolute-ordering/name/others\",\n                                   \"addAbsoluteOrderingOthers\");\n====================================================\n\n\nweb-common_3_0.xsd\n====================================================\n <xsd:complexType name=\"absoluteOrderingType\">\n    <xsd:annotation>\n      <xsd:documentation>\n\n        Please see section 8.2.2 of the specification for details.\n        \n      </xsd:documentation>\n    </xsd:annotation>\n    <xsd:choice minOccurs=\"0\"\n                maxOccurs=\"unbounded\">\n      <xsd:element name=\"name\"\n                   type=\"javaee:java-identifierType\"\n                   minOccurs=\"0\"\n                   maxOccurs=\"unbounded\"/>\n      <xsd:element name=\"others\"\n                   type=\"javaee:ordering-othersType\"\n                   minOccurs=\"0\"\n                   maxOccurs=\"1\"/>\n    </xsd:choice>\n  </xsd:complexType>\n====================================================','2011-07-17 01:22:30','zhh','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','5de2739','Mark Emlyn David Thomas','2011-07-19 07:41:08','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51518 Correct error in web.xml parsing rules for the <others/> tag when using absolute ordering.','java/org/apache/catalina/startup/WebRuleSet.java\nwebapps/docs/changelog.xml'),(820,50394,'Bug 50394 – InternalAprInputBuffer.fill() doesn\'t deal correctly with EOF','I\'m using tomcat-native-1.1.20 and tomcat-6.0.29 on CentOS 5.5, and I\'ve written a servlet that is sent large (gigabyte) streams of bytes over HTTP.\n\nFrom time to time it fails with the following stacktrace:\n\n\nCaused by: java.io.IOException\n        at org.apache.coyote.http11.InternalAprInputBuffer.fill(InternalAprInputBuffer.java:798)\n        at org.apache.coyote.http11.InternalAprInputBuffer$SocketInputBuffer.doRead(InternalAprInputBuffer.java:827)\n        at org.apache.coyote.http11.filters.IdentityInputFilter.doRead(IdentityInputFilter.java:116)\n        at org.apache.coyote.http11.InternalAprInputBuffer.doRead(InternalAprInputBuffer.java:738)\n        at org.apache.coyote.Request.doRead(Request.java:428)\n        at org.apache.catalina.connector.InputBuffer.realReadBytes(InputBuffer.java:304)\n        at org.apache.tomcat.util.buf.ByteChunk.substract(ByteChunk.java:403)\n        at org.apache.catalina.connector.InputBuffer.read(InputBuffer.java:327)\n        at org.apache.catalina.connector.CoyoteInputStream.read(CoyoteInputStream.java:193)\n        at java.io.BufferedInputStream.read1(BufferedInputStream.java:273)\n        at java.io.BufferedInputStream.read(BufferedInputStream.java:334)\n        at java.io.FilterInputStream.read(FilterInputStream.java:107)\n[...]\n\n\nUnfortunately, InternalAprInputBuffer throws away the error code on line 798, but I\'ve run it under a debugger and nRead was -70014.\n\nIf you look in the source of apr-1.3.8 at include/apr_errno.h, you\'ll see this is -APR_EOF.\n\nThe bug is in the implementation of recvbb at line 892 onwards in tomcat-native-1.1.20-src/jni/native/src/network.c. Specifically, at the end of the function we check for APR_SUCCESS, and assume all other codes are an error, returning -ss. It should also check for EOF (APR_STATUS_IS_EOF), and return zero. (Or at least, InternalAprInputBuffer assumes that a return code of 0 <=> EOF).\n\nIncidentally, apr-1.3.8/include/apr_network_io.h says in its comment on apr_socket_recv() that \"It is possible for both bytes to be received and an APR_EOF or other error to be returned.\". This is a lie. All provided implementations of apr_socket_recv return with *len == 0 in case of APR_EOF.','2010-12-01 11:38:03','Hugh Warrington','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Native','Library','P2 normal','9ef3390','Jean-Frederic Clere','2011-07-19 05:36:08','Fix for PR50394','java/org/apache/coyote/http11/InternalAprInputBuffer.java'),(821,49595,'Bug 49595 – Tomcat crashes in tcnative-1.dll frequently','','2010-07-15 06:34:41','Anil Saraswathy','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Native','Library','P2 critical','a3f3379','Jean-Frederic Clere','2011-07-19 04:06:46','Fix for PR49595','java/org/apache/coyote/ajp/AjpAprProcessor.java'),(822,51503,'Bug 51503 – Additional error checking required for connector port attribute (e.g. for port=\"\")','With 7.0.18 packaged as a candidate for release and finally unreleased, when I stop the Tomcat service (only 1 war deployed), the service takes a lot of time to stop and finally was killed by system.\n\nHaving a look into the stderr log, I see it paused right after the folowing line :\n\nINFO: Stopping ProtocolHandler [http-apr-0]\n\nThen went into a slow loop and fill the log with these lines :\n\n13 juil. 2011 14:30:30 org.apache.tomcat.util.net.AprEndpoint stopInternal\nATTENTION: Acceptor thread [http-apr-0-Acceptor-0] failed to unlock. Forcing hard socket shutdown.\n13 juil. 2011 14:30:31 org.apache.tomcat.util.net.AprEndpoint stopInternal\nATTENTION: Acceptor thread [http-apr-0-Acceptor-0] failed to unlock. Forcing hard socket shutdown.\n13 juil. 2011 14:30:32 org.apache.tomcat.util.net.AprEndpoint stopInternal\nATTENTION: Acceptor thread [http-apr-0-Acceptor-0] failed to unlock. Forcing hard socket shutdown.\netc. (about 30 times before it was killed)\n\nI think there was no such issue with 7.0.16.','2011-07-13 12:40:11','Etienne Massip','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 normal','1e79993','Mark Emlyn David Thomas','2011-07-18 12:18:54','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51503 Add additional validation to Windows installer and Tomcat start for connector port numbers','java/org/apache/catalina/connector/Connector.java\njava/org/apache/catalina/connector/LocalStrings.properties\nres/tomcat.nsi\nwebapps/docs/changelog.xml'),(823,51477,'Bug 51477 – Support all protocol combinations in SSLProtocol of APR Connector','','2011-07-05 16:53:25','Marvin Addison','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Native','Library','P2 enhancement','6ee5a22','Rainer Jung','2011-07-11 11:44:10','BZ 51477: Support all SSL protocol combinations in the APR/native connector.','java/org/apache/tomcat/jni/Library.java\njava/org/apache/tomcat/util/net/AprEndpoint.java\nwebapps/docs/changelog.xml\nwebapps/docs/config/http.xml'),(824,46252,'Bug 46252 – Tomcat access log doesn\'t support Unicode','AccessLogValve, which is responsible for handling the access log uses FileWriter (that doesn\'t support Unicode). I guess that instantiating the writer like this would solve the case:\n\nwriter = new PrintWriter(new OutputStreamWriter(new FileOutputStream(pathname), \"UTF-8\"), true);','2008-11-20 11:18:55','Adam','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 enhancement','871dabd','Konstantin Kolinko','2011-07-11 11:13:13','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46252 Allow to specify character set to be used to write the access log in AccessLogValve.','java/org/apache/catalina/valves/AccessLogValve.java\njava/org/apache/catalina/valves/LocalStrings.properties\nwebapps/docs/changelog.xml\nwebapps/docs/config/valve.xml'),(825,51494,'Bug 51494 – NPE in StandardContextValve.invoke() when a webapp is redeployed while a request is still being processed','','2011-07-10 01:56:23','Konstantin Preißer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','3a95db4','Mark Emlyn David Thomas','2011-07-11 09:05:30','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51494 Prevent an NPE when a long running request completes if the associated web application was destroyed while the request was processing','java/org/apache/catalina/core/StandardContextValve.java\nwebapps/docs/changelog.xml'),(826,51475,'Bug 51475 – GzipInterceptor#decompress is not completly implemented','','2011-07-05 09:58:12','Christian Stöber','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Cluster','P2 normal','acc5619','Mark Emlyn David Thomas','2011-07-05 12:45:38','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51475 Handle messages larger than the buffer size. Expand test cases to cover this. Based on a patch by Christian Stöber.','java/org/apache/catalina/tribes/group/interceptors/GzipInterceptor.java\ntest/org/apache/catalina/tribes/group/interceptors/TestGzipInterceptor.java'),(827,51472,'Bug 51472 – Bugin ? in BeanELResolver.getMethod()','BeanResolver.getMethod() starts with:\n        if (m == null || Modifier.isPublic(type.getModifiers())) {\n            return m;\n        }\n\nThat tests method existence and whether Class has public modifier.\nI think that public Modifier of Method should be tested instead/or additionally.\n\nSo:\n        if (m == null || Modifier.isPublic(m.getModifiers())) {\n            return m;\n        }\n\nOr: \n        if (m == null || Modifier.isPublic(type.getModifiers()\n                      && Modifier.isPublic(m.getModifiers())) {\n            return m;\n        }\n\nRight ?','2011-07-05 02:49:05','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED INVALID','Tomcat 6','Jasper','P2 normal','d79376c','Mark Emlyn David Thomas','2011-07-05 06:03:06','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51472 Correctly test modifiers when resolving bean methods with the BeanELResolver. Patch provided by Friedhelm Kuehn.','java/javax/el/BeanELResolver.java\nwebapps/docs/changelog.xml'),(828,51473,'Bug 51473 – SecurityConfig，set \"package.definition\" security property to \"nullsun.,java.,...\"','','2011-07-05 05:37:09','zhh','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','ec00abf','Konstantin Kolinko','2011-07-05 03:10:31','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51473 Fix concatenation of values in SecurityConfig.setSecurityProperty() when the value provided by JRE is null.','java/org/apache/catalina/security/SecurityConfig.java\nwebapps/docs/changelog.xml'),(829,51467,'Bug 51467 – usage of method run instead of start to start a thread','In StandardContext method Thread#run is used. This is most probably a mistake, since a few lines below Thread#join is called to wait for the completion of the thread.\n\nSo we could either remove the join and get rid of the thread by using just a runnable, or start the thread.','2011-07-03 10:19:46','Felix Schumacher','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','eb98373','Mark Emlyn David Thomas','2011-07-04 08:50:24','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51467 start() not run() Patch provided by Felix Schumacher','java/org/apache/catalina/core/StandardContext.java\nwebapps/docs/changelog.xml'),(830,51466,'Bug 51466 – typos in comments of HostManagerServlet','','2011-07-02 14:09:02','Felix Schumacher','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Manager','P2 trivial','6020bf6','Mark Emlyn David Thomas','2011-07-04 08:43:19','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51466 Fix typos Patch by Felix Schumacher','java/org/apache/catalina/manager/host/HostManagerServlet.java\nwebapps/docs/changelog.xml'),(831,51453,'Bug 51453 – Requests to open URL that include an Authorization header do not reach servlet','In Tomcat 7, I\'ve noticed that a request to a URL that does not require authentication will get forwarded to the login page if the request contains an \"Authorization\" header.\n\nOur application expects these requests to be processed by the servlet.  The servlet parses the Authorization header and takes appropriate action (possibly redirecting to the login page or allowing the request if the headers contain an acceptible token).  This has worked in older versions of Tomcat.\n\nThe relevant part of our web.xml looks like:\n\n<security-constraint>\n\n  <web-resource-collection>\n    <web-resource-name>open</web-resource-name>\n    <url-pattern>/*</url-pattern>\n    <!-- several other url patterns -->\n  </web-resource-collection>\n\n  <user-data-constraint>\n    <transport-guarantee>CONFIDENTIAL</transport-guarantee>\n  </user-data-constraint>\n\n  <!-- Notice no auth-constraint element -->\n\n</security-constraint>\n\nI observed the behavior of org.apache.catalina.authenticator.AuthenticatorBase.invoke(), here\'s what I saw:\n\nThe constraints variable contains a single constraint that matches the security constraint from our web.xml above.\n\nOn line 520, authRequired is set to true because of the presence of the Authorization header.\n\nThe authenticate() call on line 535 fails and redirects to the login page.','2011-06-30 14:10:50','Craig Chaney','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 regression','df9bc17','Mark Emlyn David Thomas','2011-06-30 11:41:27','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51453 Fix a regression in the preemptive authentication support (enhancement <bug>12428</bug>) that could trigger authentication even if preemptive authentication was disabled.','java/org/apache/catalina/authenticator/AuthenticatorBase.java\nwebapps/docs/changelog.xml'),(832,12428,'Bug 12428 – request.getUserPrincipal(): Misinterpretation of specification?','When calling request.getUserPrincipal() from an unprotected resource, the method returns \nnull even when the user is actually authenticated.\n\nFrom Servlet 2.3 spec:\npublic \njava.security.Principal getUserPrincipal()\nReturns a java.security.Principal object \ncontaining the name of the current\nauthenticated user. If the user has not been authenticated, \nthe method returns\nnull.\n\nMy interpretation would be that once a user has been \nauthenticated, a call to getUserPrincipal() would always return the associated Principal \nobject whether it is from a protected or unprotected resource.','2002-09-09 09:28:17','Dylan van Iersel','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P3 enhancement','df9bc17','Mark Emlyn David Thomas','2011-06-30 11:41:27','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51453 Fix a regression in the preemptive authentication support (enhancement <bug>12428</bug>) that could trigger authentication even if preemptive authentication was disabled.','java/org/apache/catalina/authenticator/AuthenticatorBase.java\nwebapps/docs/changelog.xml'),(833,51445,'Bug 51445 – Tomcat 7 SingleThreadModel Problem','I have noticed that in tomcat 7 if we implement SingleThreadModel and initialize some variables into init(ServletConfig config) method, in that case values initialized in init(ServletConfig config) not reflected into service block.\n\nFor Example : Following code will print \"0\".\n\nimport java.io.IOException;\nimport java.io.PrintWriter;\nimport javax.servlet.ServletConfig;\nimport javax.servlet.ServletException;\nimport javax.servlet.SingleThreadModel;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\n\npublic class test extends HttpServlet implements SingleThreadModel\n{\n\n    int i = 0;\n\n    @Override\n    public void init(ServletConfig config) throws ServletException\n    {\n        super.init(config);\n        i = 10;\n    }\n    protected void processRequest(HttpServletRequest request, HttpServletResponse response)\n            throws ServletException, IOException\n    {\n        response.setContentType(\"text/html;charset=UTF-8\");\n        PrintWriter out = response.getWriter();\n        try\n        {\n            out.println(i);\n        }\n        finally\n        {\n            out.close();\n        }\n    }\n    @Override\n    protected void doGet(HttpServletRequest request, HttpServletResponse response)\n            throws ServletException, IOException\n    {\n        processRequest(request, response);\n    }\n    @Override\n    protected void doPost(HttpServletRequest request, HttpServletResponse response)\n            throws ServletException, IOException\n    {\n        processRequest(request, response);\n    }\n    @Override\n    public String getServletInfo()\n    {\n        return \"Short description\";\n    }\n}','2011-06-28 10:33:26','Mali','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','eb70ce5','Mark Emlyn David Thomas','2011-06-30 08:16:37','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51445 Correctly initialise all instances of Servlets that implement SingleThreadModel. Based on a patch by Felix Schumacher.','java/org/apache/catalina/core/StandardWrapper.java\ntest/org/apache/catalina/core/TestStandardWrapper.java\nwebapps/docs/changelog.xml'),(834,51450,'Bug 51450 – Spanish translation \"_es.properties\" files','Spanish translations for recent changed/added properties','2011-06-29 12:10:45','Jesus Marin','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Integration','P2 normal','9961310','Mark Emlyn David Thomas','2011-06-29 11:16:02','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51450 More Spanish translations. Based on a patch by Jesus Marin.','java/org/apache/catalina/core/LocalStrings_es.properties\njava/org/apache/tomcat/util/buf/LocalStrings_es.properties\nwebapps/docs/changelog.xml'),(835,51088,'Bug 51088 – ArrayIndexOutOfBoundsException from org.apache.el.parser.JJTELParserState','I found the following ArrayIndexOutOfBoundsException in my logfile.\nIt occurred directly after login into my webApp without any further user interaction. Unfortunately it is not reproducible at all.\n\nI am not sure whether Jasper is the right component. However the class  JJTELParserState is in the jasper-el.jar.\n\nEnvironment:\nTomcat 6.0.32 \nFacelets 1.1.14\nMyfaces 1.2.9\n\nSCHWERWIEGEND: Error Rendering View[/facelets/myview.xhtml]\njava.lang.ArrayIndexOutOfBoundsException: -1\n	at java.util.ArrayList.remove(ArrayList.java:390)\n	at org.apache.el.parser.JJTELParserState.closeNodeScope(JJTELParserState.java:108)\n	at org.apache.el.parser.ELParser.CompositeExpression(ELParser.java:74)\n	at org.apache.el.lang.ExpressionBuilder.createNodeInternal(ExpressionBuilder.java:115)\n	at org.apache.el.lang.ExpressionBuilder.build(ExpressionBuilder.java:172)\n	at org.apache.el.lang.ExpressionBuilder.createValueExpression(ExpressionBuilder.java:216)\n	at org.apache.el.ExpressionFactoryImpl.createValueExpression(ExpressionFactoryImpl.java:68)\n	at com.sun.facelets.el.ELText$ELTextVariable.apply(ELText.java:161)\n	at com.sun.facelets.compiler.AttributeInstruction.apply(AttributeInstruction.java:60)\n	at com.sun.facelets.compiler.UIInstructionHandler.apply(UIInstructionHandler.java:95)\n	at com.sun.facelets.tag.CompositeFaceletHandler.apply(CompositeFaceletHandler.java:47)\n	at com.sun.facelets.tag.jstl.core.IfHandler.apply(IfHandler.java:54)\n	at com.sun.facelets.tag.CompositeFaceletHandler.apply(CompositeFaceletHandler.java:47)\n	at com.sun.facelets.tag.jsf.ComponentHandler.applyNextHandler(ComponentHandler.java:360)\n	at com.sun.facelets.tag.jsf.ComponentHandler.apply(ComponentHandler.java:190)\n	at com.sun.facelets.tag.CompositeFaceletHandler.apply(CompositeFaceletHandler.java:47)\n	at com.sun.facelets.tag.jsf.ComponentHandler.applyNextHandler(ComponentHandler.java:360)\n	at com.sun.facelets.tag.jsf.ComponentHandler.apply(ComponentHandler.java:190)\n	at com.sun.facelets.tag.CompositeFaceletHandler.apply(CompositeFaceletHandler.java:47)\n	at com.sun.facelets.tag.jsf.ComponentHandler.applyNextHandler(ComponentHandler.java:360)\n	at org.apache.myfaces.custom.aliasbean.AliasBeansScopeTagHandler.applyNextHandler(AliasBeansScopeTagHandler.java:52)\n	at com.sun.facelets.tag.jsf.ComponentHandler.apply(ComponentHandler.java:190)\n	at com.sun.facelets.tag.CompositeFaceletHandler.apply(CompositeFaceletHandler.java:47)\n	at com.sun.facelets.tag.ui.CompositionHandler.apply(CompositionHandler.java:124)\n	at com.sun.facelets.compiler.NamespaceHandler.apply(NamespaceHandler.java:49)\n	at com.sun.facelets.compiler.EncodingHandler.apply(EncodingHandler.java:39)\n	at com.sun.facelets.impl.DefaultFacelet.include(DefaultFacelet.java:248)\n	at com.sun.facelets.impl.DefaultFacelet.include(DefaultFacelet.java:294)\n	at com.sun.facelets.impl.DefaultFacelet.include(DefaultFacelet.java:273)\n	at com.sun.facelets.impl.DefaultFaceletContext.includeFacelet(DefaultFaceletContext.java:140)\n	at com.sun.facelets.tag.ui.IncludeHandler.apply(IncludeHandler.java:66)\n	at com.sun.facelets.tag.ui.DefineHandler.applyDefinition(DefineHandler.java:64)\n	at com.sun.facelets.tag.ui.CompositionHandler.apply(CompositionHandler.java:136)\n	at com.sun.facelets.impl.DefaultFaceletContext$TemplateManager.apply(DefaultFaceletContext.java:337)\n	at com.sun.facelets.impl.DefaultFaceletContext.includeDefinition(DefaultFaceletContext.java:307)\n	at com.sun.facelets.tag.ui.InsertHandler.apply(InsertHandler.java:68)\n	at com.sun.facelets.tag.CompositeFaceletHandler.apply(CompositeFaceletHandler.java:47)\n	at com.sun.facelets.tag.jsf.ComponentHandler.applyNextHandler(ComponentHandler.java:360)\n	at com.sun.facelets.tag.jsf.ComponentHandler.apply(ComponentHandler.java:190)\n	at com.sun.facelets.tag.CompositeFaceletHandler.apply(CompositeFaceletHandler.java:47)\n	at com.sun.facelets.tag.jsf.ComponentHandler.applyNextHandler(ComponentHandler.java:360)\n	at com.sun.facelets.tag.jsf.ComponentHandler.apply(ComponentHandler.java:190)\n	at com.sun.facelets.tag.CompositeFaceletHandler.apply(CompositeFaceletHandler.java:47)\n	at com.sun.facelets.tag.ui.CompositionHandler.apply(CompositionHandler.java:124)\n	at com.sun.facelets.compiler.NamespaceHandler.apply(NamespaceHandler.java:49)\n	at com.sun.facelets.compiler.EncodingHandler.apply(EncodingHandler.java:39)\n	at com.sun.facelets.impl.DefaultFacelet.include(DefaultFacelet.java:248)\n	at com.sun.facelets.impl.DefaultFacelet.include(DefaultFacelet.java:294)\n	at com.sun.facelets.impl.DefaultFacelet.include(DefaultFacelet.java:273)\n	at com.sun.facelets.impl.DefaultFaceletContext.includeFacelet(DefaultFaceletContext.java:140)\n	at com.sun.facelets.tag.ui.CompositionHandler.apply(CompositionHandler.java:116)\n	at com.sun.facelets.compiler.NamespaceHandler.apply(NamespaceHandler.java:49)\n	at com.sun.facelets.compiler.EncodingHandler.apply(EncodingHandler.java:39)\n	at com.sun.facelets.impl.DefaultFacelet.apply(DefaultFacelet.java:95)\n	at com.sun.facelets.FaceletViewHandler.buildView(FaceletViewHandler.java:596)\n	at com.sun.facelets.FaceletViewHandler.renderView(FaceletViewHandler.java:651)\n	at org.ajax4jsf.application.ViewHandlerWrapper.renderView(ViewHandlerWrapper.java:100)\n	at org.ajax4jsf.application.AjaxViewHandler.renderView(AjaxViewHandler.java:176)\n	at org.apache.myfaces.lifecycle.RenderResponseExecutor.execute(RenderResponseExecutor.java:41)\n	at org.apache.myfaces.lifecycle.LifecycleImpl.render(LifecycleImpl.java:140)\n	at org.apache.myfaces.custom.ppr.PPRLifecycleWrapper.render(PPRLifecycleWrapper.java:84)\n	at javax.faces.webapp.FacesServlet.service(FacesServlet.java:187)\n	at com.foo..client.web.servlets.FacesServletWrapper.service(FacesServletWrapper.java:125)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n	at org.ajax4jsf.webapp.BaseXMLFilter.doXmlFilter(BaseXMLFilter.java:206)\n	at org.ajax4jsf.webapp.BaseFilter.handleRequest(BaseFilter.java:290)\n	at org.ajax4jsf.webapp.BaseFilter.processUploadsAndHandleRequest(BaseFilter.java:388)\n	at org.ajax4jsf.webapp.BaseFilter.doFilter(BaseFilter.java:515)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n	at org.apache.myfaces.webapp.filter.ExtensionsFilter.doFilter(ExtensionsFilter.java:392)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n	at com.foo..client.web.filters.LoginFilter.doFilter(LoginFilter.java:219)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n	at com.foo..client.web.filters.CacheFilter.doFilter(CacheFilter.java:110)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n	at com.foo..client.web.filters.EncodingFilter.doFilter(EncodingFilter.java:54)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n	at com.foo..client.web.filters.TimerFilter.doFilter(TimerFilter.java:80)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)\n	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)\n	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:470)\n	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)\n	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)\n	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:298)\n	at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:859)\n	at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:588)\n	at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)\n	at java.lang.Thread.run(Thread.java:662)','2011-04-20 05:42:42','Michael Heinen','Tomcat Developers Mailing List','RESOLVED WONTFIX','Tomcat 6','Jasper','P2 normal','92af111','Mark Emlyn David Thomas','2011-06-29 09:56:28','Better error handling that may help track down the cause of https://issues.apache.org/bugzilla/show_bug.cgi?id=51088','java/org/apache/el/Messages.properties\njava/org/apache/el/lang/ExpressionBuilder.java\nwebapps/docs/changelog.xml'),(836,50648,'Bug 50648 – RpcChannel improvements','','2011-01-25 09:38:16','Olivier Costet','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Cluster','P2 enhancement','c252929','Mark Emlyn David Thomas','2011-06-28 20:06:20','Fix what were originally typos Similar to https://issues.apache.org/bugzilla/show_bug.cgi?id=50648','java/org/apache/catalina/tribes/transport/ReceiverBase.java\njava/org/apache/catalina/tribes/transport/bio/util/SingleRemoveSynchronizedAddLock.java'),(837,50648,'Bug 50648 – RpcChannel improvements','','2011-01-25 09:38:16','Olivier Costet','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Cluster','P2 enhancement','c6bd6f4','Mark Emlyn David Thomas','2011-06-28 19:45:52','Fix what was originally a typo Similar to https://issues.apache.org/bugzilla/show_bug.cgi?id=50648','java/org/apache/catalina/tribes/transport/RxTaskPool.java'),(838,51443,'Bug 51443 – Cluster manager documentation gives invalid attribute name','','2011-06-28 09:21:43','Dmitry Mikhaylov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P2 minor','f8eb0ec','Mark Emlyn David Thomas','2011-06-28 15:35:06','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51443 Document the notifySessionListenersOnReplication attribute for the DeltaManager.','webapps/docs/changelog.xml\nwebapps/docs/config/cluster-manager.xml'),(839,51445,'Bug 51445 – Tomcat 7 SingleThreadModel Problem','I have noticed that in tomcat 7 if we implement SingleThreadModel and initialize some variables into init(ServletConfig config) method, in that case values initialized in init(ServletConfig config) not reflected into service block.\n\nFor Example : Following code will print \"0\".\n\nimport java.io.IOException;\nimport java.io.PrintWriter;\nimport javax.servlet.ServletConfig;\nimport javax.servlet.ServletException;\nimport javax.servlet.SingleThreadModel;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\n\npublic class test extends HttpServlet implements SingleThreadModel\n{\n\n    int i = 0;\n\n    @Override\n    public void init(ServletConfig config) throws ServletException\n    {\n        super.init(config);\n        i = 10;\n    }\n    protected void processRequest(HttpServletRequest request, HttpServletResponse response)\n            throws ServletException, IOException\n    {\n        response.setContentType(\"text/html;charset=UTF-8\");\n        PrintWriter out = response.getWriter();\n        try\n        {\n            out.println(i);\n        }\n        finally\n        {\n            out.close();\n        }\n    }\n    @Override\n    protected void doGet(HttpServletRequest request, HttpServletResponse response)\n            throws ServletException, IOException\n    {\n        processRequest(request, response);\n    }\n    @Override\n    protected void doPost(HttpServletRequest request, HttpServletResponse response)\n            throws ServletException, IOException\n    {\n        processRequest(request, response);\n    }\n    @Override\n    public String getServletInfo()\n    {\n        return \"Short description\";\n    }\n}','2011-06-28 10:33:26','Mali','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','7411fda','Mark Emlyn David Thomas','2011-06-28 14:00:50','Add a test case for https://issues.apache.org/bugzilla/show_bug.cgi?id=51445','test/org/apache/catalina/core/TestStandardWrapper.java'),(840,51436,'Bug 51436 – ServletRequestListener fails to access request parameters when an Expect-Header is sent','','2011-06-27 09:56:45','Simon Olofsson','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','6dffc54','Mark Emlyn David Thomas','2011-06-28 13:49:25','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51436 Send 100 (Continue) response earlier to enable ServletRequestListener implementations to read the request body. Based on a patch by Simon Olofsson.','java/org/apache/catalina/core/LocalStrings.properties\njava/org/apache/catalina/core/StandardContextValve.java\njava/org/apache/catalina/core/StandardWrapperValve.java\nwebapps/docs/changelog.xml'),(841,50353,'Bug 50353 – Calling asyncContext.getResponse() returns null after async timeout','If the async thread calls asyncContext.getResponse() after the async timeout, it gets a null reference. \nIn the following example, it leads to a NPE.\n\nThe servlet spec is not very clear on the behavior to adopt after a timeout, but I don\'t think null should be returned. Maybe an IllegalStateException instead ? It seems to be the case if complete() is called after the timeout.\n\npackage test;\n\nimport java.io.IOException;\nimport java.io.PrintWriter;\n\nimport javax.servlet.AsyncContext;\nimport javax.servlet.AsyncEvent;\nimport javax.servlet.AsyncListener;\nimport javax.servlet.ServletException;\nimport javax.servlet.ServletResponse;\nimport javax.servlet.annotation.WebServlet;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\n\n/**\n * Servlet implementation class MyServlet\n */\n@WebServlet(value = \"/MyServlet\", asyncSupported = true)\npublic class MyServlet extends HttpServlet implements AsyncListener {\n	private static final long serialVersionUID = 1L;\n\n	protected void doGet(HttpServletRequest request,\n			HttpServletResponse response) throws ServletException, IOException {\n		final AsyncContext asyncContext = request.startAsync(request, response);\n		asyncContext.addListener(this);\n		asyncContext.setTimeout(10*1000);\n\n		asyncContext.start(new Runnable() {\n\n			@Override\n			public void run() {\n				System.out.println(\"Entering async thread\");\n				try {\n					Thread.sleep(20 * 1000);\n					System.out.println(\"<Asyncthread> about to write response\");\n					ServletResponse response2 = asyncContext.getResponse();\n					PrintWriter writer = response2.getWriter();\n					writer.write(\"Hello world\");\n					System.out.println(\"<Asyncthread> about to complete\");\n					asyncContext.complete();\n				} catch (Exception e) {\n					e.printStackTrace();\n				}\n			}\n		});\n	}\n\n	@Override\n	public void onComplete(AsyncEvent evt) throws IOException {\n		System.out.println(\"onComplete \" + evt);\n	}\n\n	@Override\n	public void onError(AsyncEvent evt) throws IOException {\n		System.out.println(\"onError \" + evt);\n	}\n\n	@Override\n	public void onStartAsync(AsyncEvent evt) throws IOException {\n		System.out.println(\"onStartAsync \" + evt);\n	}\n\n	@Override\n	public void onTimeout(AsyncEvent evt) throws IOException {\n		System.out.println(\"onTimeout \" + evt);\n		evt.getAsyncContext().getResponse().getWriter().write(\"Timed out\");\n		evt.getAsyncContext().complete();\n	}\n}','2010-11-27 17:45:41','Sylvain Laurent','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','d36c5d9','Mark Emlyn David Thomas','2011-06-28 13:24:45','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50353 Rather than the eventual NPE, throw an ISE if an application attempts to access an AsyncContext after the request processing has ended.','java/org/apache/catalina/core/AsyncContextImpl.java\njava/org/apache/catalina/core/LocalStrings.properties'),(842,51447,'Bug 51447 – Session type changes from Backup to Primary','','2011-06-28 11:15:18','Eiji Takahashi','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Manager','P2 normal','3d85a85','Mark Emlyn David Thomas','2011-06-28 12:22:08','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51447 Viewing a back up session in the HTML Manager web application no longer changes the session to a primary session. Based on a patch provided by Eiji Takahashi.','java/org/apache/catalina/manager/HTMLManagerServlet.java\nwebapps/docs/changelog.xml'),(843,51400,'Bug 51400 – Use of \"new String(byte[] b, String enc)\" hits Sun JVM bottleneck','','2011-06-21 00:47:24','Dave Engberg','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 enhancement','cfc9d8f','Mark Emlyn David Thomas','2011-06-28 12:06:32','More https://issues.apache.org/bugzilla/show_bug.cgi?id=51400 related changes Based on a patch by Konstantin Preißer','java/org/apache/tomcat/util/buf/C2BConverter.java'),(844,36362,'Bug 36362 – missing check for Java reserved keywords in tag file processing','Tag file attribute names are used as identifiers in Java source code generated\nfrom the tag file without any mangling.  If the attribute name is a Java\nkeyword, this leads to a compilation error.  As an example, try to use the\nfollowing tag file, bug.tag\n\n<%@ tag isELIgnored=\"false\" %>\n<%@ attribute name=\"default\" %>\n${default}\n\nSomewhere during tag file processing, attribute names could be checked against\nthe list of Java keywords in org.apache.jasper.compiler.JspUtils','2005-08-25 21:35:27','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 normal','c1fe8f4','Mark Emlyn David Thomas','2011-06-28 11:56:23','Additional fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=36362 to address regression for attributes with names that include underscores','java/org/apache/jasper/compiler/Generator.java\njava/org/apache/jasper/compiler/JspUtil.java'),(845,50949,'Bug 50949 – Allow configuration of service name, AJP port, server port.','I am using Tomcat to deploy a software application. Some customers run Windows and want Tomcat to run servlets.\n\nFor this, we use the installer provided on the site. In two situations, the standard installer does not work well enough:\n\n1. The customer wants two installations on the same server, and therefore needs two services. For instance, one for development/test/acceptance and one for production. This can be achieved but requires manual interaction instead of just next, next, enter something finish.\n2. The customer installs software for Sonicwall, also based on Tomcat. They include the standard installer and just overwrite any current service name for Tomcat 6 or 7.\n\nTo solve these deployment issues, I would like to be able to configure:\n\n* The name and code of the Windows service to be created. For my own installations, I can then use something different of the standard name. That avoids that less intelligent installers hijack the service later, leading to a service request to me.\n* The port for AJP and server. Currently, you can enter the HTTP port. That is very handy when for instance IIS is also running on the same machine. But when two Tomcat instances are running, the AJP and server port in a standard installation must also differ.\n\nI have looked into res\\tomcat.nsi. It seems to be responsible for the creation of the service and files.\n\nIn trunk around line 202 and 306 I see that the service name and display name are currently hardcoded. That would require some form of adaption.\n\nThe additional ports can probably be handled by Function configure.\n\nI also saw that stuff is registered in the registry under SOFTWARE\\Apache Software Foundation\\Tomcat\\@VERSION_MAJOR_MINOR@. That probably would require adaptation too to allow multiple installs without interfering them with each other. I do not know to handle that.\n\nFor the two scenarios, I think I can ask one customer to invest some amount of money, because in the long run it would save him the effort to learn administrator to use tomcat*.exe with options such as //ms.','2011-03-20 11:40:49','Guido Leenders','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Native:Packaging','P2 enhancement','d1a354b','Mark Emlyn David Thomas','2011-06-24 12:43:40','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50949 Provide the ability to specify the AJP port and service name when installing Tomcat using the Windows installer. This permits multiple instances of the same Tomcat version to be installed side-by-side.','build.xml\nres/confinstall/server_2.xml\nres/confinstall/server_3.xml\nres/tomcat.nsi\nwebapps/docs/changelog.xml'),(846,50949,'Bug 50949 – Allow configuration of service name, AJP port, server port.','I am using Tomcat to deploy a software application. Some customers run Windows and want Tomcat to run servlets.\n\nFor this, we use the installer provided on the site. In two situations, the standard installer does not work well enough:\n\n1. The customer wants two installations on the same server, and therefore needs two services. For instance, one for development/test/acceptance and one for production. This can be achieved but requires manual interaction instead of just next, next, enter something finish.\n2. The customer installs software for Sonicwall, also based on Tomcat. They include the standard installer and just overwrite any current service name for Tomcat 6 or 7.\n\nTo solve these deployment issues, I would like to be able to configure:\n\n* The name and code of the Windows service to be created. For my own installations, I can then use something different of the standard name. That avoids that less intelligent installers hijack the service later, leading to a service request to me.\n* The port for AJP and server. Currently, you can enter the HTTP port. That is very handy when for instance IIS is also running on the same machine. But when two Tomcat instances are running, the AJP and server port in a standard installation must also differ.\n\nI have looked into res\\tomcat.nsi. It seems to be responsible for the creation of the service and files.\n\nIn trunk around line 202 and 306 I see that the service name and display name are currently hardcoded. That would require some form of adaption.\n\nThe additional ports can probably be handled by Function configure.\n\nI also saw that stuff is registered in the registry under SOFTWARE\\Apache Software Foundation\\Tomcat\\@VERSION_MAJOR_MINOR@. That probably would require adaptation too to allow multiple installs without interfering them with each other. I do not know to handle that.\n\nFor the two scenarios, I think I can ask one customer to invest some amount of money, because in the long run it would save him the effort to learn administrator to use tomcat*.exe with options such as //ms.','2011-03-20 11:40:49','Guido Leenders','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Native:Packaging','P2 enhancement','133f2e3','Mark Emlyn David Thomas','2011-06-23 19:24:36','Prep for fixing https://issues.apache.org/bugzilla/show_bug.cgi?id=50949 Use a variable for the service name and ensure the uninstaller still works','res/tomcat.nsi'),(847,40510,'Bug 40510 – installer does not create shortcuts for all users','The Windows installer only creates shortcuts for the installing user. It \nshould be creating shortcuts for all users.','2006-09-14 12:45:47','Brant Gurganus','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Native:Packaging','P2 enhancement','92de559','Mark Emlyn David Thomas','2011-06-23 18:01:41','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=40510 Provide an option to install shortcuts for the current user or all users. Also ensure registry is correctly cleaned on uninstall for 64-bit platforms.','res/tomcat.nsi\nwebapps/docs/changelog.xml'),(848,33262,'Bug 33262 – Service Manager autostart should check for administrative rights','I am running as a Power User and I can\'t start SM. It complains \"Application\nSystem Error. Access is denied. Unable to open the Service Manager. [OK]\"\nService Manager is autostarting from\n\"HKLM/Software/Microsoft/Windows/CurrentVersion/Run\", wich means it will be\nstarted at each logon, for all the users. There are users who might not have the\nright to control services. The solutions as I see it is that tomcat5w.exe should\ngraciously and silently exit if the user has no right to use it.\nPS. I have only this machine and I am not really sure that my error message\nisn\'t due to another causes. Those who know the source code might confirm or\ninfirm if tomcat5w isn\'t already working as requested.','2005-01-27 04:02:03','Luci Sandor','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Native:Integration','P2 enhancement','e24e367','Mark Emlyn David Thomas','2011-06-23 14:27:39','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=33262 Install monitor to auto-start for current user only rather than all users to be consistent with menu item creation.','res/tomcat.nsi\nwebapps/docs/changelog.xml'),(849,36362,'Bug 36362 – missing check for Java reserved keywords in tag file processing','Tag file attribute names are used as identifiers in Java source code generated\nfrom the tag file without any mangling.  If the attribute name is a Java\nkeyword, this leads to a compilation error.  As an example, try to use the\nfollowing tag file, bug.tag\n\n<%@ tag isELIgnored=\"false\" %>\n<%@ attribute name=\"default\" %>\n${default}\n\nSomewhere during tag file processing, attribute names could be checked against\nthe list of Java keywords in org.apache.jasper.compiler.JspUtils','2005-08-25 21:35:27','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 normal','33673a1','Mark Emlyn David Thomas','2011-06-23 11:51:55','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=36362 Handle the case where tag file attributes (which can use any valid XML name) have a name which is not a Java identifier.','java/org/apache/jasper/compiler/Generator.java\nwebapps/docs/changelog.xml'),(850,51425,'Bug 51425 – Spanish translation \"_es.properties\" files','','2011-06-23 08:16:32','Jesus Marin','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Integration','P2 enhancement','327e9a0','Mark Emlyn David Thomas','2011-06-23 08:18:20','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51425 Update Spanish translations. Based on a patch provided by Jesus Marin.','java/javax/el/LocalStrings_es.properties\njava/javax/servlet/LocalStrings_es.properties\njava/javax/servlet/http/LocalStrings_es.properties\njava/org/apache/catalina/authenticator/LocalStrings_es.properties\njava/org/apache/catalina/connector/LocalStrings_es.properties\njava/org/apache/catalina/core/LocalStrings_es.properties\njava/org/apache/catalina/filters/LocalStrings_es.properties\njava/org/apache/catalina/ha/session/LocalStrings_es.properties\njava/org/apache/catalina/loader/LocalStrings_es.properties\njava/org/apache/catalina/manager/LocalStrings_es.properties\njava/org/apache/catalina/manager/host/LocalStrings_es.properties\njava/org/apache/catalina/realm/LocalStrings_es.properties\njava/org/apache/catalina/security/LocalStrings_es.properties\njava/org/apache/catalina/servlets/LocalStrings_es.properties\njava/org/apache/catalina/startup/LocalStrings_es.properties\njava/org/apache/catalina/tribes/membership/LocalStrings_es.properties\njava/org/apache/catalina/tribes/transport/LocalStrings_es.properties\njava/org/apache/catalina/users/LocalStrings_es.properties\njava/org/apache/catalina/valves/LocalStrings_es.properties\njava/org/apache/coyote/ajp/LocalStrings_es.properties\njava/org/apache/coyote/http11/LocalStrings_es.properties\njava/org/apache/el/Messages_es.properties\njava/org/apache/jasper/resources/LocalStrings_es.properties\njava/org/apache/naming/LocalStrings_es.properties\njava/org/apache/naming/resources/LocalStrings_es.properties\njava/org/apache/tomcat/util/http/res/LocalStrings_es.properties\njava/org/apache/tomcat/util/net/jsse/res/LocalStrings_es.properties\njava/org/apache/tomcat/util/net/res/LocalStrings_es.properties\njava/org/apache/tomcat/util/threads/res/LocalStrings_es.properties\nwebapps/docs/changelog.xml\nwebapps/examples/WEB-INF/classes/LocalStrings_es.properties'),(851,51395,'Bug 51395 – First application that loads SAXParserFactory causes Class loader memory leak','Overview\nThe class org.apache.catalina.startup.ContextConfig has an array of org.apache.tomcat.util.digester.Digester objects. Each Digester has a field factory to refer to a SAXParserFactory. If that SAXParserFactory is loaded via a WebappClassLoader, that WebappClassLoader is stuck in memory.\n\nSteps to reproduce\nCreate a Web application that has xercesImpl.jar in its lib. (The Web application itself doesn\'t need to use any of the xerces classes.) Upload the application war file using Tomcat Manager. Verify that the application is loaded via Tomcat Manager -> List Applications\n\nRestart Tomcat. Via Tomcat Manager -> List Applications, verify that the application is running. Undeploy the application. Click on Find leaks. The message above shows the application as leaking.\n\nMake a memory dump using jmap, inspect the memory using jhat.\nThe WebappClassLoader for this application is still present. Its \"reference chains from rootset\" shows a chain like this:\nStatic reference from org.apache.catalina.startup.ContextConfig.webDigesters (from class org.apache.catalina.startup.ContextConfig) :\n--> [Lorg.apache.tomcat.util.digester.Digester;@0x78be4958 (24 bytes) (Element 0 of [Lorg.apache.tomcat.util.digester.Digester;@0x78be4958:)\n--> org.apache.tomcat.util.digester.Digester@0x78be3c50 (101 bytes) (field factory:)\n--> org.apache.xerces.jaxp.SAXParserFactoryImpl@0x78bf0b28 (20 bytes) (??:)\n--> class org.apache.xerces.jaxp.SAXParserFactoryImpl (84 bytes) (??:)\n--> org.apache.catalina.loader.WebappClassLoader@0x78be3ea0 (165 bytes)','2011-06-20 14:57:46','Arjen Knibbe','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','81bb49a','Mark Emlyn David Thomas','2011-06-23 05:26:10','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51395 Better fix for memory leak that aligns ContextConfig with TldConfig Fix part 3 of 3 for CVE-2011-2481','java/org/apache/catalina/startup/ContextConfig.java\njava/org/apache/catalina/startup/TldConfig.java'),(852,51418,'Bug 51418 – Allow more flexibility in adding webapps to org.apache.catalina.startup.Tomcat','','2011-06-22 15:54:00','bmargulies','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','f83c07e','Mark Emlyn David Thomas','2011-06-22 14:30:41','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51418 Provide more control over Context creation when embedding Tomcat. Based on a patch by Benson Margulies.','java/org/apache/catalina/startup/Tomcat.java\nwebapps/docs/changelog.xml'),(853,51400,'Bug 51400 – Use of \"new String(byte[] b, String enc)\" hits Sun JVM bottleneck','','2011-06-21 00:47:24','Dave Engberg','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 enhancement','f647e1f','Mark Emlyn David Thomas','2011-06-21 10:29:49','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51400 Avoid known bottleneck in JVM when converting between Strings and bytes by always providing a Charset rather than an encoding name. Based on a patch by Dave Engberg.','java/org/apache/catalina/ant/AbstractCatalinaTask.java\njava/org/apache/catalina/authenticator/DigestAuthenticator.java\njava/org/apache/catalina/connector/CoyoteAdapter.java\njava/org/apache/catalina/ha/backend/MultiCastSender.java\njava/org/apache/catalina/loader/WebappClassLoader.java\njava/org/apache/catalina/realm/JNDIRealm.java\njava/org/apache/catalina/realm/RealmBase.java\njava/org/apache/catalina/servlets/WebdavServlet.java\njava/org/apache/catalina/tribes/membership/Constants.java\njava/org/apache/catalina/tribes/tipis/AbstractReplicatedMap.java\njava/org/apache/catalina/tribes/util/Arrays.java\njava/org/apache/catalina/util/RequestUtil.java\njava/org/apache/catalina/valves/SSLValve.java\njava/org/apache/coyote/http11/InternalNioInputBuffer.java\njava/org/apache/coyote/http11/filters/BufferedInputFilter.java\njava/org/apache/coyote/http11/filters/ChunkedInputFilter.java\njava/org/apache/coyote/http11/filters/IdentityInputFilter.java\njava/org/apache/coyote/http11/filters/VoidInputFilter.java\njava/org/apache/jasper/compiler/PageDataImpl.java\njava/org/apache/jasper/compiler/SmapUtil.java\njava/org/apache/naming/resources/ProxyDirContext.java\njava/org/apache/tomcat/util/buf/B2CConverter.java\njava/org/apache/tomcat/util/buf/ByteChunk.java\njava/org/apache/tomcat/util/buf/MessageBytes.java\njava/org/apache/tomcat/util/http/Parameters.java\njava/org/apache/tomcat/util/http/fileupload/FileUploadBase.java\nwebapps/docs/changelog.xml'),(854,51403,'Bug 51403 – Avoid NullPointerException in JULI FileHandler if formatter is misconfigured','If formatter assigned to org.apache.juli.FileHandler in logging.properties is misconfigured and fails to load,\nthe FileHandler starts without formatter and fails with an NPE later.\n\nTo reproduce: assign some bogus value to\n1catalina.org.apache.juli.FileHandler.formatter\n\nWhen Tomcat starts, the following will be printed at the console:\n\njava.util.logging.ErrorManager: 4\njava.lang.NullPointerException\n        at org.apache.juli.FileHandler.openWriter(FileHandler.java:377)\n        at org.apache.juli.FileHandler.<init>(FileHandler.java:99)\n        at org.apache.juli.FileHandler.<init>(FileHandler.java:90)\n\n\nI think we can be more tolerant to this configuration error and fall back to the default formatter. I will commit a fix shortly.','2011-06-21 13:13:00','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','f2dd57b','Konstantin Kolinko','2011-06-21 09:24:44','Avoid NullPointerException in JULI FileHandler if formatter is misconfigured Fixes https://issues.apache.org/bugzilla/show_bug.cgi?id=51403','java/org/apache/juli/FileHandler.java\nwebapps/docs/changelog.xml'),(855,51401,'Bug 51401 – java.lang.IllegalArgumentException: <session-config> element is limited to 1 occurrence','','2011-06-21 01:36:08','Eiji Takahashi','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 major','7c274bb','Mark Emlyn David Thomas','2011-06-21 07:10:47','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51401 Correctly initialise shared WebRuleSet instance used by the digesters that parse web.xml and prevent incorrect warnings about multiple occurrences of elements that are only allowed to appear once in web.xml and web-fragment.xml. Patch by kfujino','java/org/apache/catalina/startup/WebRuleSet.java\nwebapps/docs/changelog.xml'),(856,51396,'Bug 51396 – Embedding class cannot launch a webapp with a jsp servlet','','2011-06-20 17:02:09','bmargulies','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 major','f75418b','Mark Emlyn David Thomas','2011-06-20 18:34:16','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51396 Correctly handle jsp-file entries in web.xml when the JSP servlet has been configured via code when embedding Tomcat.','java/org/apache/catalina/startup/ContextConfig.java\ntest/org/apache/catalina/startup/TestContextConfig.java\ntest/webapp-3.0-fragments/WEB-INF/web.xml\ntest/webapp-3.0-fragments/bug51396.jsp\nwebapps/docs/changelog.xml'),(857,51395,'Bug 51395 – First application that loads SAXParserFactory causes Class loader memory leak','Overview\nThe class org.apache.catalina.startup.ContextConfig has an array of org.apache.tomcat.util.digester.Digester objects. Each Digester has a field factory to refer to a SAXParserFactory. If that SAXParserFactory is loaded via a WebappClassLoader, that WebappClassLoader is stuck in memory.\n\nSteps to reproduce\nCreate a Web application that has xercesImpl.jar in its lib. (The Web application itself doesn\'t need to use any of the xerces classes.) Upload the application war file using Tomcat Manager. Verify that the application is loaded via Tomcat Manager -> List Applications\n\nRestart Tomcat. Via Tomcat Manager -> List Applications, verify that the application is running. Undeploy the application. Click on Find leaks. The message above shows the application as leaking.\n\nMake a memory dump using jmap, inspect the memory using jhat.\nThe WebappClassLoader for this application is still present. Its \"reference chains from rootset\" shows a chain like this:\nStatic reference from org.apache.catalina.startup.ContextConfig.webDigesters (from class org.apache.catalina.startup.ContextConfig) :\n--> [Lorg.apache.tomcat.util.digester.Digester;@0x78be4958 (24 bytes) (Element 0 of [Lorg.apache.tomcat.util.digester.Digester;@0x78be4958:)\n--> org.apache.tomcat.util.digester.Digester@0x78be3c50 (101 bytes) (field factory:)\n--> org.apache.xerces.jaxp.SAXParserFactoryImpl@0x78bf0b28 (20 bytes) (??:)\n--> class org.apache.xerces.jaxp.SAXParserFactoryImpl (84 bytes) (??:)\n--> org.apache.catalina.loader.WebappClassLoader@0x78be3ea0 (165 bytes)','2011-06-20 14:57:46','Arjen Knibbe','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','8fa2101','Mark Emlyn David Thomas','2011-06-20 15:26:45','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51395 Fix memory leak triggered when an application that includes a SAXParserFactory is the first web application to be loaded. Fix part 1 of 3 for CVE-2011-2481','java/org/apache/catalina/startup/ContextConfig.java\nwebapps/docs/changelog.xml'),(858,33453,'Bug 33453 – Jasper should recompile JSP files whose datestamps change in either direction (not just newer)','I\'ve noticed that Tomcat won\'t recompile a JSP file if the date stamp is changed\nto go back in time. This may seem like a strange case, but if you check an older\ncopy of a JSP page out of version control, it\'s different, and needs to be\nrecompiled. The assumption that all changes to a file involve a newer file\ndatestamp is an invalid one.\n\nI think I found the code that makes this decision, in\norg.apache.jasper.compiler.Compiler, in the isOutDated(boolean) method. The\ncondition is\n        if (targetLastModified < jspRealLastModified)\nbut it should be\n        if (targetLastModified != jspRealLastModified)\nin my opinion.\n\nAfter all, the logic should be that the file has changed, not that it\'s newer. I\ndon\'t think it\'s reasonable to expect that Jasper check the size and do an MD5\nchecksum to *really* see if the file has changed. :)\n\nObviously the workaround is to just to \"touch\" the file but this adds a lot of\noverhead (and one more thing to remember), compared to changing a > to a !=.','2005-02-08 22:50:23','Jamie Flournoy','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P3 enhancement','84e78cf','Mark Emlyn David Thomas','2011-06-20 14:02:25','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=33453 Recompile JSPs if last modified time of the source or any of its dependencies changes either forwards or backwards. Note that this introduces an incompatible change to the code generated for JSPs. Tomcat will automatically re-compile any JSPs and tag files found in the work directory when upgrading from 7.0.16 or earlier to 7.0.17 or later. If you later downgrade from 7.0.17 or later to 7.0.16 or earlier, you must empty the work directory as part of the downgrade process.','java/org/apache/catalina/loader/WebappClassLoader.java\njava/org/apache/jasper/JspCompilationContext.java\njava/org/apache/jasper/compiler/Compiler.java\njava/org/apache/jasper/compiler/Generator.java\njava/org/apache/jasper/compiler/ImplicitTagLibraryInfo.java\njava/org/apache/jasper/compiler/PageInfo.java\njava/org/apache/jasper/compiler/ParserController.java\njava/org/apache/jasper/compiler/TagFileProcessor.java\njava/org/apache/jasper/compiler/TagLibraryInfoImpl.java\njava/org/apache/jasper/runtime/JspSourceDependent.java\njava/org/apache/jasper/servlet/JspServletWrapper.java\nwebapps/docs/changelog.xml'),(859,51310,'Bug 51310 – Connector destroyInternal Execution','In Tomcat 7.0.12 Connector#destroyInternal method has never been called while server is under shutdown. Therefore NIOBlockingSelector#close is never called. Is it bug or else?','2011-06-01 15:58:45','Gurkan Erdogdu','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 normal','40d5a23','Mark Emlyn David Thomas','2011-06-20 12:38:40','The fix for bug 51310 caused a regression that re-introduced bug 49957 and deleted the contents of the work directory when Tomcat was shutdown. This fix ensures that that work directory for an application is not deleted when Tomcat is shutdown.','java/org/apache/catalina/startup/ContextConfig.java\nwebapps/docs/changelog.xml'),(860,49957,'Bug 49957 – Work directories of deployed webapps are deleted at shutdown','','2010-09-19 11:39:18','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 regression','40d5a23','Mark Emlyn David Thomas','2011-06-20 12:38:40','The fix for bug 51310 caused a regression that re-introduced bug 49957 and deleted the contents of the work directory when Tomcat was shutdown. This fix ensures that that work directory for an application is not deleted when Tomcat is shutdown.','java/org/apache/catalina/startup/ContextConfig.java\nwebapps/docs/changelog.xml'),(861,49165,'Bug 49165 – Enhancement - Allow %{TIME_FORMAT}t As Configuration for AccessLogValve','AccessLogValve.DateAndTimeElement() can currently be configured only with %t which output the date/time in Common Log Format.\n\nBy adding the capability to configure with %{TIME_FORMAT}, one could override (at least) the timeFormatter property of the class ... or it could go further and allow overriding of all the [day, month, year, time]Formatter properties.\n\nJustification for enhancement:  The log currenlty provide the ability to log processing time in millis (via %T), but an accurate log of the order in which requests are received cannot be determined without the capabilities of logging a  a format with milliseconds using the %t element.','2010-04-21 14:20:08','Jacob Zwiers','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','7d6c439','Rainer Jung','2011-06-19 06:58:02','BZ 49165 and more: - Allow any time stamp formats supported   by SimpleDateFormat in AccessLogValve. - Support logging begin and/or end of request.','java/org/apache/catalina/valves/AccessLogValve.java\nwebapps/docs/changelog.xml'),(862,51386,'Bug 51386 – @HandlingType not correctly handled at server startup leads to incorrect classes set passed to initializers','','2011-06-16 14:12:27','Etienne Massip','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 critical','9f8b983','Mark Emlyn David Thomas','2011-06-16 13:24:03','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51386 Correct code for processing @HandlesTypes annotations so only types of interest are reported to a ServletContainerInitializer.','java/org/apache/catalina/startup/ContextConfig.java\ntest/org/apache/catalina/startup/TestContextConfigAnnotation.java\nwebapps/docs/changelog.xml'),(863,48956,'Bug 48956 – SSI regular expressions not working','','2010-03-22 11:48:29','Albert Tumanov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 enhancement','874048a','Mark Emlyn David Thomas','2011-06-15 18:44:00','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48956 Implement regular expression support for SSI','java/org/apache/catalina/ssi/ExpressionParseTree.java\nwebapps/docs/changelog.xml'),(864,43538,'Bug 43538 – [patch] Show the hostname and IP address in the manager webapp','We have an environment with a couple of load-balanced Tomcats fronted by httpd.\nIf someone accesses the manager application through the load-balancer, they will\nnot know which of the load-balanced Tomcats they end up at. In these situations,\nand others as well, it would be nice if the manager could tell the hostname and\nIP address of the machine it is running on.','2007-10-02 14:42:39','Dennis Lundberg','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Webapps:Manager','P2 enhancement','2b8e6cf','Mark Emlyn David Thomas','2011-06-15 17:58:00','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=43538 Add host name and IP address to the HTML Manager application. Patch by Dennis Lundberg.','java/org/apache/catalina/manager/Constants.java\njava/org/apache/catalina/manager/HTMLManagerServlet.java\njava/org/apache/catalina/manager/LocalStrings.properties\njava/org/apache/catalina/manager/StatusManagerServlet.java\nwebapps/docs/changelog.xml'),(865,51376,'Bug 51376 – Dynamically added Servlet instances ignore setLoadOnStartup(), @ServletSecurity, etc','When a pre-existing instance of Servlet class is added dynamically by calling ServletContext.addServlet(String, Servlet) in ServletContainerInitializer, multiple problems arise:\n\n * setLoadOnStartup() is ignored\n * @ServletSecurity is ignored\n * destroy() can be called on non-initialized servlet\n\nAdding a servlet class (addServlet(String, String), addServlet(String, Class)) doesn\'t have this problems.\n\nIt happens because methods of org.apache.catalina.core.StandardWrapper treat presence of servlet instance as an indicator of the fact that servlet have been initialized, that is not true when addServlet(String, Servlet) is used.','2011-06-15 10:14:25','Artem Troitskiy','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','d6039f9','Mark Emlyn David Thomas','2011-06-15 16:32:14','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51376 Complete fix. Ensure Servlet.destroy() is only called if Servlet.init() was called.','java/org/apache/catalina/core/StandardWrapper.java\ntest/org/apache/catalina/core/TestStandardContext.java'),(866,50677,'Bug 50677 – Allow system property variables in catalina.properties','We currently have two hardcoded \"variables\" that we substitute in catalina.properties, ${catalina.base} and ${catalina.home}.  Is there value in expanding this functionality?  Here is my scenario:\n\nI have several apps, app1, app2, etc.  I have a shared lib directory of jars that the apps share.  In addition, the apps may have several instances running in different \"environments\" (prod, QA, dev, etc.), and each environment has a corresponding version of the lib directory.  The Tomcat configs for the apps (catalina.base) are version-controlled.\n\nNow, I want each instance of these apps (catalina.base) to be as portable as possible without having to make a bunch of changes for each environment.  So, I want to be able to copy the app1-prod catalina.base to app1-qa and not have to make a lot of local modifications to catalina.properties and friends to make it work.  My init script knows that app1-qa is a QA instance and needs to point to the lib-qa shared directory.  So, I set a system property in the init script via CATALINA_OPTS: -Dshared.lib.dir=/path/to/lib-qa for QA and -Dshared.lib.dir=/path/to/lib-prod for production.  What I would like to do is use this system property via ${property.name} in my common.loader in catalina.properties.  The result is that the catalina.base files are the exact same from a configuration perspective without a bunch of local modifications.\n\nI have created two proposed patches for this functionality.  Both work well, but each one has the potential for some slightly different behavior, so I would like to hear the thoughts of the developers on each.\n\n--\n\nProposal A (currently in production use for my environment):\n\nThe variable substitution takes place upon retrieval in CatalinaProperties.getProperty(), pulling in the current value of the system property.  This allows other properties defined in catalina.properties to be substituted.  The (potential) downside or risk is that the value of a catalina.property value may change over time if the system properties referenced in its value are changed by the code during the JVM\'s lifecycle.\n\n--\n\nProposal B:\n\nThe variable substitution takes place in the class initializer, loadProperties().  This means that every call to CatalinaProperties.getProperty() will return the same result, with system property variables replaced with their value at the time the class was loaded.  The downside of this is that properties set in catalina.properties cannot be used in other properties defined in that file, because they may not yet be set based on the order they are returned by the Enumeration.  This could be worked around, but it would probably take another iteration over the properties (not really a big deal).','2011-01-27 20:54:57','Jim Riggs','Tomcat Developers Mailing List','REOPENED','Tomcat 6','Catalina','P2 enhancement','699e3ae','Konstantin Kolinko','2011-06-15 09:51:03','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50677 Allow ANT style variables in the common.loader and other *.loader properties in conf/catalina.properties','java/org/apache/catalina/startup/Bootstrap.java\nwebapps/docs/changelog.xml'),(867,51376,'Bug 51376 – Dynamically added Servlet instances ignore setLoadOnStartup(), @ServletSecurity, etc','When a pre-existing instance of Servlet class is added dynamically by calling ServletContext.addServlet(String, Servlet) in ServletContainerInitializer, multiple problems arise:\n\n * setLoadOnStartup() is ignored\n * @ServletSecurity is ignored\n * destroy() can be called on non-initialized servlet\n\nAdding a servlet class (addServlet(String, String), addServlet(String, Class)) doesn\'t have this problems.\n\nIt happens because methods of org.apache.catalina.core.StandardWrapper treat presence of servlet instance as an indicator of the fact that servlet have been initialized, that is not true when addServlet(String, Servlet) is used.','2011-06-15 10:14:25','Artem Troitskiy','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','257d7fb','Mark Emlyn David Thomas','2011-06-15 09:21:16','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51376 Dynamically added Servlet instances were ignoring setLoadOnStartup(), @ServletSecurity, etc.:  When adding a Servlet via ServletContext#addServlet(String, Servlet), the Servlet was not initialized when the web application started and a load on startup value  was set.','java/org/apache/catalina/core/StandardWrapper.java\ntest/org/apache/catalina/core/TestStandardContext.java\nwebapps/docs/changelog.xml'),(868,51306,'Bug 51306 – NPE in DeltaRequest.writeExternal(DeltaRequest.java:267) when handling remote session expiration','Occasionally we got errors like following:\n======\n2011-05-30 03:40:17,697 ERROR [pool-1-thread-2] (org.apache.catalina.ha.session.DeltaManager) Manager [localhost#]: Unable to receive message through TCP channel\njava.lang.NullPointerException\nat java.io.ObjectOutputStream$BlockDataOutputStream.getUTFLength(ObjectOutputStream.java:2106)\nat java.io.ObjectOutputStream$BlockDataOutputStream.writeUTF(ObjectOutputStream.java:1977)\nat java.io.ObjectOutputStream.writeUTF(ObjectOutputStream.java:849)\nat org.apache.catalina.ha.session.DeltaRequest.writeExternal(DeltaRequest.java:267)\nat org.apache.catalina.ha.session.DeltaRequest.serialize(DeltaRequest.java:287)\nat org.apache.catalina.ha.session.DeltaManager.serializeDeltaRequest(DeltaManager.java:716)\nat org.apache.catalina.ha.session.DeltaManager.requestCompleted(DeltaManager.java:1224)\nat org.apache.catalina.ha.session.DeltaSession.expire(DeltaSession.java:403)\nat org.apache.catalina.ha.session.DeltaManager.handleSESSION_EXPIRED(DeltaManager.java:1546)\nat org.apache.catalina.ha.session.DeltaManager.messageReceived(DeltaManager.java:1452)\nat org.apache.catalina.ha.session.DeltaManager.messageDataReceived(DeltaManager.java:1173)\nat org.apache.catalina.ha.session.ClusterSessionListener.messageReceived(ClusterSessionListener.java:92)\nat org.apache.catalina.ha.tcp.SimpleTcpCluster.messageReceived(SimpleTcpCluster.java:901)\nat org.apache.catalina.ha.tcp.SimpleTcpCluster.messageReceived(SimpleTcpCluster.java:882)\nat org.apache.catalina.tribes.group.GroupChannel.messageReceived(GroupChannel.java:269)\nat org.apache.catalina.tribes.group.ChannelInterceptorBase.messageReceived(ChannelInterceptorBase.java:79)\nat org.apache.catalina.tribes.group.interceptors.TcpFailureDetector.messageReceived(TcpFailureDetector.java:110)\nat org.apache.catalina.tribes.group.ChannelInterceptorBase.messageReceived(ChannelInterceptorBase.java:79)\nat org.apache.catalina.tribes.group.ChannelInterceptorBase.messageReceived(ChannelInterceptorBase.java:79)\nat org.apache.catalina.tribes.group.ChannelCoordinator.messageReceived(ChannelCoordinator.java:241)\nat org.apache.catalina.tribes.transport.ReceiverBase.messageDataReceived(ReceiverBase.java:225)\nat org.apache.catalina.tribes.transport.nio.NioReplicationTask.drainChannel(NioReplicationTask.java:188)\nat org.apache.catalina.tribes.transport.nio.NioReplicationTask.run(NioReplicationTask.java:91)\nat java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\nat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\nat java.lang.Thread.run(Thread.java:662) \n\nIt looks like the functionality of Tomcat is not affected by this.\n\nThe NPE comes from trying to write null sessionId, but why does Tomcat try to send something from handling received authoritative SESSION_EXPIRED message?','2011-06-01 12:21:28','Dmitry Mikhaylov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Cluster','P2 normal','4e5571f','Keiichi Fujino','2011-06-13 05:44:33','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51306. Avoid NPE when handleSESSION_EXPIRED is processed while handleSESSION_CREATED is being processed.','java/org/apache/catalina/ha/session/DeltaManager.java\njava/org/apache/catalina/ha/session/DeltaSession.java\nwebapps/docs/changelog.xml'),(869,51348,'Bug 51348 – Potential NullPointerException in org.apache.catalina.servlets.WebdavServlet at line 1336','A WebDAV LOCK_REFRESH request may cause a NullPointerException because of an (IMHO) wrong check at line 1332 in  WebdavServlet.java 1056763 2011-01-08 18:56:57Z markt.\n\nI suggest line 1332 should be:\n...\n  if (toRenew != null) {\n...','2011-06-09 08:53:41','Klaus Mehling','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','71b18c8','Mark Emlyn David Thomas','2011-06-09 15:15:40','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51348 Prevent possible NPE when processing WebDAV locks.','java/org/apache/catalina/servlets/WebdavServlet.java\nwebapps/docs/changelog.xml'),(870,51344,'Bug 51344 – org.apache.catalina.startup.Embedded overrides Lifecycle incorrectly?','Not sure if this is a bug or just my mis-coding...\n\nI\'ve been using the Embedded component in Tomcat 6.0.29 for integration testing. Something like this:\n\n    server = new EmbeddedTomcat(\"/test\", 7890, \"JVM-1\");\n    PeerToPeerCacheLifecycleListener p2pListener = new PeerToPeerCacheLifecycleListener();\n    p2pListener.setProperty(\"mcast-port\", \"19991\");\n    server.getEmbedded().addLifecycleListener(p2pListener);\n    sessionManager = new DeltaSessionManager();\n    server.getRootContext().setManager(sessionManager);\n\nHere the EmbeddedTomcat class is simply a wrapper for Embedded - I\'m passing in the context, port and \'JVM route\' - nothing special. Then I add a listener which should be the programmatic equivalent of having the following server.xml snippet:\n\n<Server>\n    <Listener className=\"PeerToPeerCacheLifecycleListener\"/>\n</Server>\n\nDeltaSessionManager performs custom session management and thus extends ManagerBase and implements Lifecycle and SessionManager.\n\nDuring the start of DeltaSessionManager I initialize the listener by doing\n\n    this.lifecycle.fireLifecycleEvent(START_EVENT, null);\n\nThe listener picks up this event and starts.\n\nAll works nicely under Tomcat 6, but breaks under Tomcat 7.0.12. My initial investigation shows that the LifecycleEvent, being fired, is not reaching the Embedded component which is where the listener is registered.\n\nRemoving the overridden Lifecycle methods from Embedded (so that the Lifecyle processing happens in LifecycleBase) seems to work as the triggered event then reaches my listener.','2011-06-08 21:35:55','Jens Deppe','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 regression','4892b57','Mark Emlyn David Thomas','2011-06-09 15:04:37','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51344 Fix problem with Lifecycle re-factoring for deprecated embedded class that prevented events being triggered.','java/org/apache/catalina/startup/Embedded.java\nwebapps/docs/changelog.xml'),(871,51249,'Bug 51249 – JULI ClassLoaderLogManager doesn\'t properly handle ${} when replacing property values','when the LogManager does it\'s replace of ${property} it doesn\'t handle properly the fact that a } could exist before ${.\n\nThe indexOf for the char } should be relative to the start position of ${\n\nExample of string : %{custom.property.matching} ${system.property.tomcat}\n\nThis would throw an exception about the index } being before ${\n\nThis is valid for all the 7.* versions as well as all the 6.* versions (validated from 6.0.27 and above).\n\nThere is not even a way to \"escape\" the ${} chars if we\'d like to output them.','2011-05-23 21:54:38','Richard Lavoie','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 minor','2f0d9ca','Konstantin Kolinko','2011-06-09 09:20:09','https://issues.apache.org/bugzilla/show_bug.cgi?id=51249 Reimplement system properties replacement code in ClassLoaderLogManager of JULI 1. Do not use recursion. 2. Do not stop on the first unrecognized property, but continue with the rest of the string. 3. Do not call System.getProperty() on an empty key, because it throws IllegalArgumentException. Threat \"${}\" as unrecognized property.','java/org/apache/juli/ClassLoaderLogManager.java\ntest/org/apache/juli/TestClassLoaderLogManager.java\nwebapps/docs/changelog.xml'),(872,51340,'Bug 51340 – Intermittent java.lang.IllegalArgumentException: <session-config> element is limited to 1 occurrence','','2011-06-08 13:37:25','Glyn Normington','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','1fe28a6','Mark Emlyn David Thomas','2011-06-08 11:52:26','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51340 Fix thread-safety issue when parsing multiple web.xml files in parallel. Apache Tomcat does not do this but products that embed it may.','java/org/apache/catalina/startup/ContextConfig.java\nwebapps/docs/changelog.xml'),(873,51278,'Bug 51278 – Unable to override default servlet other than in main web.xml','The default web.xml gets merged into the application\'s web.xml before processing of fragments, annotations and ServletContextInitializers. This means it can only be overridden in the application\'s web.xml. It should be possible to override in fragments, annotations and ServletContextInitializers.','2011-05-28 07:12:37','Mark Thomas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','58e6e40','Mark Emlyn David Thomas','2011-06-07 19:48:17','Correct a regression in the fix for bug 51278 that prevented any web application from being marked as distributable. (kfujino)','java/org/apache/catalina/startup/ContextConfig.java\nwebapps/docs/changelog.xml'),(874,51264,'Bug 51264 – Context/Manager/Store configuration proposal','Why is it the Persistent Store Store element does not contain a means to reference a database link defined in the globalnamingresources, for example:\n\nThis is what is required\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<Context path=\"/App1\" docbase=\" App1\" reloadable=\"false\" crossContext=\"true\" debug=\"1\">\n    <Manager className=\"org.apache.catalina.session.PersistentManager\" distributable=\"true\" maxIdleBackup=\"5\">\n      <Store className=\"org.apache.catalina.session.JDBCStore\" connectionURL=\"jdbc:oracle:thin:username/password@servername:port:schema\"\n        driverName=\"oracle.jdbc.OracleDriver\" sessionAppCol=\"app_name\" sessionDataCol=\"session_data\" \n        sessionIdCol=\"session_id\" sessionLastAccessedCol=\"last_access\" sessionMaxInactiveCol=\"max_inactive\"\n        sessionTable=\"tomcat_sessions\" sessionValidCol=\"valid_session\" />\n    </Manager>\n    <ResourceLink global=\"jdbc/dbName\" name=\"jdbc/dbName\" type=\"javax.sql.DataSource\"/>\n</Context>\n\nBUT couldn’t the tomcat accept this?\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<Context path=\"/App1\" docbase=\" App1\" reloadable=\"false\" crossContext=\"true\" debug=\"1\">\n    <Manager className=\"org.apache.catalina.session.PersistentManager\" distributable=\"true\" maxIdleBackup=\"5\">\n      <Store className=\"org.apache.catalina.session.JDBCStore\" resourceLink=\"jdbc/dbName\"\n        resourceType=\"javax.sql.DataSource\" sessionAppCol=\"app_name\" sessionDataCol=\"session_data\" \n        sessionIdCol=\"session_id\" sessionLastAccessedCol=\"last_access\" sessionMaxInactiveCol=\"max_inactive\"\n        sessionTable=\"tomcat_sessions\" sessionValidCol=\"valid_session\" />\n    </Manager>\n    <ResourceLink global=\"jdbc/dbName\" name=\"jdbc/dbName\" type=\"javax.sql.DataSource\"/>\n</Context>\n\nThat way the application developer does not need to know the username and password to the production database server nor does it need to be packaged in his/her war file.','2011-05-25 10:48:09','Felix Schumacher','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','e61ac6f','Mark Emlyn David Thomas','2011-06-07 15:28:42','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51264 Improve fix to return connections to the pool when not in use. Patch provided by Felix Schumacher.','java/org/apache/catalina/session/JDBCStore.java\nwebapps/docs/changelog.xml\nwebapps/docs/config/manager.xml'),(875,51324,'Bug 51324 – When OutputBuffer.doFlush gets Exception, doFlush gets stuck to true','','2011-06-05 05:17:12','Bow Ruggeri','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 normal','1bbbdb2','Mark Emlyn David Thomas','2011-06-07 10:00:16','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51324 Improve handling of exceptions when flushing the response buffer to ensure that the doFlush flag does not get stuck in the enabled state. Patch provided by Jeremy Norris.','java/org/apache/catalina/connector/OutputBuffer.java\nwebapps/docs/changelog.xml'),(876,51323,'Bug 51323 – Svn property fixes','','2011-06-04 23:28:43','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','d9f60ce','Konstantin Kolinko','2011-06-06 06:05:11','Set svn:eol-style=native Fixes bug 51323 reported by sebb',''),(877,51251,'Bug 51251 – Patch to add version parameter to ant task','','2011-05-24 01:28:35','Eiji Takahashi','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Manager','P2 enhancement','d19daf5','Mark Emlyn David Thomas','2011-06-03 18:22:35','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51251 Add web application version support to the Ant tasks. Based on a patch provided by Eiji Takahashi.','java/org/apache/catalina/ant/AbstractCatalinaCommandTask.java\njava/org/apache/catalina/ant/ReloadTask.java\njava/org/apache/catalina/ant/SessionsTask.java\njava/org/apache/catalina/ant/StartTask.java\njava/org/apache/catalina/ant/StopTask.java\njava/org/apache/catalina/ant/UndeployTask.java\nwebapps/docs/changelog.xml'),(878,51264,'Bug 51264 – Context/Manager/Store configuration proposal','Why is it the Persistent Store Store element does not contain a means to reference a database link defined in the globalnamingresources, for example:\n\nThis is what is required\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<Context path=\"/App1\" docbase=\" App1\" reloadable=\"false\" crossContext=\"true\" debug=\"1\">\n    <Manager className=\"org.apache.catalina.session.PersistentManager\" distributable=\"true\" maxIdleBackup=\"5\">\n      <Store className=\"org.apache.catalina.session.JDBCStore\" connectionURL=\"jdbc:oracle:thin:username/password@servername:port:schema\"\n        driverName=\"oracle.jdbc.OracleDriver\" sessionAppCol=\"app_name\" sessionDataCol=\"session_data\" \n        sessionIdCol=\"session_id\" sessionLastAccessedCol=\"last_access\" sessionMaxInactiveCol=\"max_inactive\"\n        sessionTable=\"tomcat_sessions\" sessionValidCol=\"valid_session\" />\n    </Manager>\n    <ResourceLink global=\"jdbc/dbName\" name=\"jdbc/dbName\" type=\"javax.sql.DataSource\"/>\n</Context>\n\nBUT couldn’t the tomcat accept this?\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<Context path=\"/App1\" docbase=\" App1\" reloadable=\"false\" crossContext=\"true\" debug=\"1\">\n    <Manager className=\"org.apache.catalina.session.PersistentManager\" distributable=\"true\" maxIdleBackup=\"5\">\n      <Store className=\"org.apache.catalina.session.JDBCStore\" resourceLink=\"jdbc/dbName\"\n        resourceType=\"javax.sql.DataSource\" sessionAppCol=\"app_name\" sessionDataCol=\"session_data\" \n        sessionIdCol=\"session_id\" sessionLastAccessedCol=\"last_access\" sessionMaxInactiveCol=\"max_inactive\"\n        sessionTable=\"tomcat_sessions\" sessionValidCol=\"valid_session\" />\n    </Manager>\n    <ResourceLink global=\"jdbc/dbName\" name=\"jdbc/dbName\" type=\"javax.sql.DataSource\"/>\n</Context>\n\nThat way the application developer does not need to know the username and password to the production database server nor does it need to be packaged in his/her war file.','2011-05-25 10:48:09','Felix Schumacher','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','a9b519f','Mark Emlyn David Thomas','2011-06-03 18:13:09','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51264 Allow the JDBC persistent session store to use a JNDI datasource to define the database in which sessions are persisted. Patch provided by Felix Schumacher.','java/org/apache/catalina/session/JDBCStore.java\njava/org/apache/catalina/session/LocalStrings.properties\nwebapps/docs/changelog.xml\nwebapps/docs/config/manager.xml'),(879,51278,'Bug 51278 – Unable to override default servlet other than in main web.xml','The default web.xml gets merged into the application\'s web.xml before processing of fragments, annotations and ServletContextInitializers. This means it can only be overridden in the application\'s web.xml. It should be possible to override in fragments, annotations and ServletContextInitializers.','2011-05-28 07:12:37','Mark Thomas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','b7ef790','Mark Emlyn David Thomas','2011-06-03 14:07:24','Fix TCK failure exposed by the fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=51278 A previous change to ensure web.xml had precedence over fragments and annotations was not complete. It handled filter definitions and servlet definitions but not servlet mappings.','java/org/apache/catalina/deploy/WebXml.java'),(880,51278,'Bug 51278 – Unable to override default servlet other than in main web.xml','The default web.xml gets merged into the application\'s web.xml before processing of fragments, annotations and ServletContextInitializers. This means it can only be overridden in the application\'s web.xml. It should be possible to override in fragments, annotations and ServletContextInitializers.','2011-05-28 07:12:37','Mark Thomas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','ccfa4b8','Mark Emlyn David Thomas','2011-06-02 17:18:07','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51278 Changes required to original fix identified by TCK tests Need to merge defaults before JSP->Servlet conversion since defaults define JSP servlet.','java/org/apache/catalina/startup/ContextConfig.java'),(881,51309,'Bug 51309 – Patch to better stop support with CATALINA_PID','When using the CATALINA_PID variable the catalina.sh stop action verify if the PID file is empty (-s $CATALINA_PID) and after that verify if the file is a file (-f $CATALINA_PID). But if the file doesn\'t exist the \"test -s\" return 1 consequently the message \"\\$CATALINA_PID was set but the specified file does not exist. Is Tomcat running? Stop aborted.\" is never printed.\n\nI made a patch to fix this, but what you need to do is just invert \"-s\" and \"-f\".\n\n\nPATCH:\n--- catalina.sh.bkp	2011-06-01 12:02:07.541350449 -0300\n+++ catalina.sh	2011-06-01 12:02:37.916302955 -0300\n@@ -403,19 +403,19 @@\n   fi\n \n   if [ ! -z \"$CATALINA_PID\" ]; then\n-    if [ -s \"$CATALINA_PID\" ]; then\n-      if [ -f \"$CATALINA_PID\" ]; then\n+    if [ -f \"$CATALINA_PID\" ]; then\n+      if [ -s \"$CATALINA_PID\" ]; then\n         kill -0 `cat \"$CATALINA_PID\"` >/dev/null 2>&1\n         if [ $? -gt 0 ]; then\n           echo \"PID file found but no matching process was found. Stop aborted.\"\n           exit 1\n         fi\n       else\n-        echo \"\\$CATALINA_PID was set but the specified file does not exist. Is Tomcat running? Stop aborted.\"\n-        exit 1\n+        echo \"PID file is empty and has been ignored.\"\n       fi\n     else\n-      echo \"PID file is empty and has been ignored.\"\n+      echo \"\\$CATALINA_PID was set but the specified file does not exist. Is Tomcat running? Stop aborted.\"\n+      exit 1\n     fi\n   fi','2011-06-01 15:33:13','Caio Cezar','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Native:Integration','P2 normal','1b46858','Mark Emlyn David Thomas','2011-06-02 16:09:27','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51309 Correct logic in catalina.sh stop when using a PID file to ensure the correct message is shown. Patch provided by Caio Cezar.','bin/catalina.sh\nwebapps/docs/changelog.xml'),(882,51249,'Bug 51249 – JULI ClassLoaderLogManager doesn\'t properly handle ${} when replacing property values','when the LogManager does it\'s replace of ${property} it doesn\'t handle properly the fact that a } could exist before ${.\n\nThe indexOf for the char } should be relative to the start position of ${\n\nExample of string : %{custom.property.matching} ${system.property.tomcat}\n\nThis would throw an exception about the index } being before ${\n\nThis is valid for all the 7.* versions as well as all the 6.* versions (validated from 6.0.27 and above).\n\nThere is not even a way to \"escape\" the ${} chars if we\'d like to output them.','2011-05-23 21:54:38','Richard Lavoie','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 minor','b334d56','Mark Emlyn David Thomas','2011-06-02 12:11:16','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51249 Correct system property replacement code so properties of the form ${...}${...} can be used without error.','java/org/apache/juli/ClassLoaderLogManager.java\nwebapps/docs/changelog.xml'),(883,51278,'Bug 51278 – Unable to override default servlet other than in main web.xml','The default web.xml gets merged into the application\'s web.xml before processing of fragments, annotations and ServletContextInitializers. This means it can only be overridden in the application\'s web.xml. It should be possible to override in fragments, annotations and ServletContextInitializers.','2011-05-28 07:12:37','Mark Thomas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','055fbf5','Mark Emlyn David Thomas','2011-06-02 11:54:26','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51278 Allow ServletContainerInitializers to override settings in the global default web.xml and the host web.xml.','java/org/apache/catalina/Wrapper.java\njava/org/apache/catalina/core/ApplicationContext.java\njava/org/apache/catalina/core/ApplicationServletRegistration.java\njava/org/apache/catalina/core/StandardWrapper.java\njava/org/apache/catalina/deploy/ServletDef.java\njava/org/apache/catalina/deploy/WebXml.java\njava/org/apache/catalina/startup/ContextConfig.java\ntest/org/apache/catalina/startup/TestContextConfig.java\ntest/webapp-3.0/index.html\nwebapps/docs/changelog.xml'),(884,51310,'Bug 51310 – Connector destroyInternal Execution','In Tomcat 7.0.12 Connector#destroyInternal method has never been called while server is under shutdown. Therefore NIOBlockingSelector#close is never called. Is it bug or else?','2011-06-01 15:58:45','Gurkan Erdogdu','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 normal','3c34e54','Mark Emlyn David Thomas','2011-06-02 09:26:16','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51310 When stopping the Server object on shutdown call destroy() after calling stop().','java/org/apache/catalina/startup/Catalina.java\nwebapps/docs/changelog.xml'),(885,51294,'Bug 51294 – Since 7.0.12 do not work option unpackWARs=true for WARs outside appBase','In 7.0.12 was added in Changelog this line:\n--\nDon\'t unpack WAR files if they are not located in the Host\'s appBase. (markt)\n--\nIt\'s change method of deployment from older versions of Tomcat (5.5, 6.0, 7.0.11) and forced to change logics on early configured servers.\n\nMay be need to add new parameter like \'unpackExternalWARs=true\' to be able to configure this? (Why outside WARs is worse than inside?)','2011-05-30 13:04:34','Andrey M','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','c1ccddc','Mark Emlyn David Thomas','2011-06-02 09:10:01','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51294 Clarify docs for unpackWAR attribute of StandardContext','webapps/docs/changelog.xml\nwebapps/docs/config/context.xml'),(886,51276,'Bug 51276 – Startup time is too high if there are few JARs in \"lib/\" and a few webapps.','Startup time in tomcat 7.0.14 is 10x higher than 7.0.12, if there are a few shared JARs in tomcat/lib and a few webapps.\nThe issue is very simple to reproduce, simply add 10 empty directories in tomcat/webapps and (for example) the Metro webservices jars in tomcat/lib. On my machine the startup time increase from 0.5 secs (default installation) to 35.2 secs.\nWhen using tomcat 7.0.12 the startup time is about 3 secs on my machine in this test case.','2011-05-27 11:09:03','Alex Dupre','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 regression','5109678','Mark Emlyn David Thomas','2011-06-02 07:12:04','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51276 Provide an abstraction for accessing content in JARs so the most efficient method can be selected depending on the type of URL used to identify the JAR. This improves startup time when JARs are located in $CATALINA_BASE/lib.','java/org/apache/catalina/startup/ContextConfig.java\njava/org/apache/catalina/startup/TldConfig.java\njava/org/apache/jasper/compiler/TldLocationsCache.java\njava/org/apache/tomcat/util/scan/FileUrlJar.java\njava/org/apache/tomcat/util/scan/Jar.java\njava/org/apache/tomcat/util/scan/JarFactory.java\njava/org/apache/tomcat/util/scan/UrlJar.java\nwebapps/docs/changelog.xml'),(887,51277,'Bug 51277 – NPE during the form authentication when form-login-config is missed','','2011-05-27 12:04:07','Michael','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','5b0919c','Mark Emlyn David Thomas','2011-05-31 09:06:11','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51277 Improve error message if an application is deployed with an incomplete FORM authentication configuration.','java/org/apache/catalina/authenticator/FormAuthenticator.java\njava/org/apache/catalina/authenticator/LocalStrings.properties\nwebapps/docs/changelog.xml'),(888,51274,'Bug 51274 – Missing messages in PersistentManagerBase','','2011-05-27 07:46:30','Eiji Takahashi','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','d7a24ec','Mark Emlyn David Thomas','2011-05-28 14:45:51','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51274 Add missing i18n strings in PersistentManagerBase. Patch provided by Eiji Takahashi.','java/org/apache/catalina/session/LocalStrings.properties\nwebapps/docs/changelog.xml'),(889,51240,'Bug 51240 – maxConnections not honors config when acceptorThreadCount > 1','','2011-05-22 19:22:26','Guillermo Grandes','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 normal','73f9592','Mark Emlyn David Thomas','2011-05-26 11:27:52','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51240 Replace the more generic CounterLatch (that has concurrency issues) with a more specific LimitLatch that (mostly) only provides the functionality required by the connectors to implement maxConnections. It also adds support for dynamically modifying maxConnections.','java/org/apache/tomcat/util/net/AbstractEndpoint.java\njava/org/apache/tomcat/util/net/AprEndpoint.java\njava/org/apache/tomcat/util/net/JIoEndpoint.java\njava/org/apache/tomcat/util/net/NioEndpoint.java\njava/org/apache/tomcat/util/threads/CounterLatch.java\njava/org/apache/tomcat/util/threads/LimitLatch.java\ntest/org/apache/tomcat/util/threads/TestCounterLatch.java\ntest/org/apache/tomcat/util/threads/TestLimitLatch.java\nwebapps/docs/changelog.xml'),(890,51226,'Bug 51226 – [Patch] to add FindLeaks ant task','There is no ant task for FindLeaks.','2011-05-19 06:26:15','Eiji Takahashi','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Manager','P2 enhancement','1cd5e7b','Mark Emlyn David Thomas','2011-05-24 12:04:08','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51226 Add a findleaks Ant task for the Manager app. Based on a patch by Eiji Takahashi','java/org/apache/catalina/ant/FindLeaksTask.java\njava/org/apache/catalina/manager/HTMLManagerServlet.java\njava/org/apache/catalina/manager/LocalStrings.properties\njava/org/apache/catalina/manager/ManagerServlet.java\nwebapps/docs/manager-howto.xml'),(891,27122,'Bug 27122 – IE plugins cannot access components through Tomcat 5 over SSL','SSL seems to be failing when the Content-Type header is set to \"image/svg+xml\".\n\nI\'ve only seen this failure when SSL was running on a Solaris machine.  (uname\n-a: SunOS [hostname removed] 5.8 Generic_108528-18 sun4u sparc SUNW,Ultra-60) \nWhen attempted on Windows, we were unable to duplicate the error.  This reliably\nfails when attempted on this specific Solaris machine.  If I get a chance, I\'ll\ntry to create a test-case and see if I can reproduce this on other Solaris\nmachines.  Unfortunately, this was a show-stopper for a release that\'s being\nmade today so I\'m pressed for time.\n\nBasically, what happens is that we\'re using a JSP page to create an SVG file. \nBecause of this, we have to set the Content-Type header to \"image/svg+xml\". \nWhen the MIME type is set to this value, the page fails to load in Internet\nExplorer 6 (SP1) with a message of \"connection failed\" or something similar. \nWhen an attempt was made in Opera, Opera responded by crashing.  Mozilla\nsuccessfully downloaded the file, though.\n\nHowever, when resetting the MIME type in the page to \"text/plain\" all three\nbrowsers can access the page without failure.  By back-revving Tomcat to version\n4.1.29, we were able to resolve this issue and access the page in all three\nbrowsers.\n\nI\'ll try and create a test-case later today and verify that it isn\'t just our\nSVG JSP that\'s failing but any that creates SVG but I\'m currently pressed for\ntime - sorry.','2004-02-20 21:09:17','Daniel Potter','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Connector:HTTP','P3 enhancement','4161179','Mark Emlyn David Thomas','2011-05-22 18:54:15','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=27122 Remove a workaround for a very old and since fixed Mozilla bug and change the default value of the securePagesWithPragma attribute of the Authenticator Valves to false to reduce the likelihood of issues when downloading files with IE.','java/org/apache/catalina/authenticator/AuthenticatorBase.java\nwebapps/docs/changelog.xml\nwebapps/docs/config/valve.xml'),(892,51185,'Bug 51185 – Performance : DataSourceProxy#createPool should use more fine grained synchronisation','','2011-05-11 10:21:44','Philippe Mouawad','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 major','4bdd8d0','Filip Hanik','2011-05-20 18:03:39','https://issues.apache.org/bugzilla/show_bug.cgi?id=51185','modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/DataSourceProxy.java'),(893,35054,'Bug 35054 – warn if appBase is not existing as a File or directory','otherwise, it may very hard to find what is wrong','2005-05-25 10:03:08','Ralf Hauser','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 enhancement','9bb6e4f','Mark Emlyn David Thomas','2011-05-20 14:11:53','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=35054 Check that a file is not specified for a Host\'s appBase and log an error if it is.','java/org/apache/catalina/startup/HostConfig.java\nwebapps/docs/changelog.xml'),(894,33453,'Bug 33453 – Jasper should recompile JSP files whose datestamps change in either direction (not just newer)','I\'ve noticed that Tomcat won\'t recompile a JSP file if the date stamp is changed\nto go back in time. This may seem like a strange case, but if you check an older\ncopy of a JSP page out of version control, it\'s different, and needs to be\nrecompiled. The assumption that all changes to a file involve a newer file\ndatestamp is an invalid one.\n\nI think I found the code that makes this decision, in\norg.apache.jasper.compiler.Compiler, in the isOutDated(boolean) method. The\ncondition is\n        if (targetLastModified < jspRealLastModified)\nbut it should be\n        if (targetLastModified != jspRealLastModified)\nin my opinion.\n\nAfter all, the logic should be that the file has changed, not that it\'s newer. I\ndon\'t think it\'s reasonable to expect that Jasper check the size and do an MD5\nchecksum to *really* see if the file has changed. :)\n\nObviously the workaround is to just to \"touch\" the file but this adds a lot of\noverhead (and one more thing to remember), compared to changing a > to a !=.','2005-02-08 22:50:23','Jamie Flournoy','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P3 enhancement','f423c77','Mark Emlyn David Thomas','2011-05-19 12:27:42','More prep for BZ 33453. Include a comment header in generated Java files','java/org/apache/jasper/compiler/Generator.java\nwebapps/docs/changelog.xml'),(895,33453,'Bug 33453 – Jasper should recompile JSP files whose datestamps change in either direction (not just newer)','I\'ve noticed that Tomcat won\'t recompile a JSP file if the date stamp is changed\nto go back in time. This may seem like a strange case, but if you check an older\ncopy of a JSP page out of version control, it\'s different, and needs to be\nrecompiled. The assumption that all changes to a file involve a newer file\ndatestamp is an invalid one.\n\nI think I found the code that makes this decision, in\norg.apache.jasper.compiler.Compiler, in the isOutDated(boolean) method. The\ncondition is\n        if (targetLastModified < jspRealLastModified)\nbut it should be\n        if (targetLastModified != jspRealLastModified)\nin my opinion.\n\nAfter all, the logic should be that the file has changed, not that it\'s newer. I\ndon\'t think it\'s reasonable to expect that Jasper check the size and do an MD5\nchecksum to *really* see if the file has changed. :)\n\nObviously the workaround is to just to \"touch\" the file but this adds a lot of\noverhead (and one more thing to remember), compared to changing a > to a !=.','2005-02-08 22:50:23','Jamie Flournoy','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P3 enhancement','9b8e75c','Mark Emlyn David Thomas','2011-05-19 12:25:45','Refactoring in preparation for a fix for BZ 33453','java/org/apache/jasper/JspCompilationContext.java\njava/org/apache/jasper/compiler/Compiler.java\njava/org/apache/jasper/resources/LocalStrings.properties'),(896,51220,'Bug 51220 – Add system property that makes it possible for jsp pages with the extends page directive to take advantage of tag pooling','','2011-05-18 15:42:54','Daniel Mikusa','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 enhancement','c46e56c','Mark Emlyn David Thomas','2011-05-19 06:44:12','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51220 Add a system property to enable tag pooling with JSPs that use a custom base class. Based on a patch by Dan Mikusa.','java/org/apache/jasper/compiler/Generator.java\nwebapps/docs/changelog.xml\nwebapps/docs/config/systemprops.xml'),(897,51182,'Bug 51182 – Update to listeners.xml documentation to describe changes for 51119','','2011-05-10 16:22:31','Neil laurance','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 enhancement','4b3489d','Mark Emlyn David Thomas','2011-05-19 05:43:59','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51182 Better organisation of listeners doc Add JAAS/JMX listener info Patch provided by Neil Laurance','webapps/docs/changelog.xml\nwebapps/docs/config/listeners.xml'),(898,51221,'Bug 51221 – Wrong spelling in Spanish locale','','2011-05-18 17:54:56','Paco Soberón','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','fd357c9','Mark Emlyn David Thomas','2011-05-19 05:27:30','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51221 Correct Spanish translation of text used in a 302 response. Patch provided by Paco Soberón.','java/org/apache/tomcat/util/http/res/LocalStrings_es.properties\nwebapps/docs/changelog.xml'),(899,51229,'Bug 51229 – Some async examples are not work correctly','','2011-05-19 06:55:54','Eiji Takahashi','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Examples','P2 minor','55d8b72','Mark Emlyn David Thomas','2011-05-19 04:55:43','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51229 Fix bugs in the Servlet 3.0 asynchronous examples. Patch provided by Eiji Takahashi.','webapps/docs/changelog.xml\nwebapps/examples/WEB-INF/classes/async/Async0.java\nwebapps/examples/jsp/async/index.jsp'),(900,51230,'Bug 51230 – Some jmx attributes of ReplicationValve and JvmRouteBinderValve are unavailable','','2011-05-19 07:12:19','Eiji Takahashi','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Cluster','P2 minor','87125bc','Mark Emlyn David Thomas','2011-05-19 04:49:03','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51230 Add missing attributes to JMX for ReplicationValve and JvmRouteBinderValve. Patch provided by Eiji Takahashi.','java/org/apache/catalina/ha/session/mbeans-descriptors.xml\njava/org/apache/catalina/ha/tcp/mbeans-descriptors.xml\nwebapps/docs/changelog.xml'),(901,51212,'Bug 51212 – QueryStats has synchornisation issues','','2011-05-17 16:25:52','Philippe Mouawad','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 major','b24b17c','Filip Hanik','2011-05-18 13:46:01','make fields volatile https://issues.apache.org/bugzilla/show_bug.cgi?id=51212','modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/interceptor/SlowQueryReport.java'),(902,51197,'Bug 51197 – sendError/sendRedirect don\'t work with AsyncContext','','2011-05-13 12:50:26','Dan Checkoway','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 major','e96b90b','Mark Emlyn David Thomas','2011-05-18 13:25:28','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51197 Fix possible dropped connection when sendError or sendRedirst are used during async processing.','java/org/apache/catalina/connector/CoyoteAdapter.java\ntest/org/apache/catalina/core/TestAsyncContextImpl.java\nwebapps/docs/changelog.xml'),(903,51208,'Bug 51208 – SVN TRUNK : JDBC interceptor options are not taken into account','','2011-05-17 09:14:29','Philippe Mouawad','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 major','2bb247a','Filip Hanik','2011-05-17 10:41:09','https://issues.apache.org/bugzilla/show_bug.cgi?id=51208','modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/PoolProperties.java'),(904,47371,'Bug 47371 – EL expression parser error when getter methed return an empty string','There is a jsp file called test.jsp:\n<%@ page contentType=\"text/html; charset=UTF-8\" %>\n<jsp:directive.page import=\"java.util.Map\"/>\n<jsp:directive.page import=\"java.util.HashMap\"/>\n<%!public class CellAttributes{\n	private String cellValue;\n\n	public CellAttributes(String cellValue) {\n		this.cellValue = cellValue;\n	}\n	public String getCellValue() {\n		return cellValue;\n	}\n} %>\n<%Map<String,CellAttributes> currentRow = new HashMap<String, CellAttributes>();\n\ncurrentRow.put(\"a\",new CellAttributes(\"\"));\ncurrentRow.put(\"b\",new CellAttributes(\"1\"));\npageContext.setAttribute(\"currentRow\",currentRow);\n\n%>\n<Html>\n<BODY>\n${currentRow[\'a\'].cellValue+currentRow[\'b\'].cellValue}\n</BODY>\n</Html>\n\nthrows exception：\njava.lang.NumberFormatException: For input string: \"\"\n	java.lang.NumberFormatException.forInputString(NumberFormatException.java:48)\n	java.lang.Long.parseLong(Long.java:424)\n	java.lang.Long.<init>(Long.java:671)\n	org.apache.el.lang.ELArithmetic$LongDelegate.coerce(ELArithmetic.java:186)\n	org.apache.el.lang.ELArithmetic.coerce(ELArithmetic.java:357)\n	org.apache.el.lang.ELArithmetic.add(ELArithmetic.java:235)\n	org.apache.el.parser.AstPlus.getValue(AstPlus.java:40)\n	org.apache.el.ValueExpressionImpl.getValue(ValueExpressionImpl.java:186)\n	org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate(PageContextImpl.java:935)\n	org.apache.jsp.new_jsp._jspService(new_jsp.java:84)\n	org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)\n	javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n	org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:374)\n	org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:342)\n	org.apache.jasper.servlet.JspServlet.service(JspServlet.java:267)\n	javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n\nbut I think it should be \"1\"','2009-06-16 02:55:55','Wang','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P1 normal','31b145e','Konstantin Kolinko','2011-05-14 19:11:37','Additional tests for coercing of strings in EL arithmetic for https://issues.apache.org/bugzilla/show_bug.cgi?id=47371 All of them pass successfully.','test/org/apache/el/lang/TestELArithmetic.java'),(905,46451,'Bug 46451 – Configure svn:bugtraq properties','','2008-12-30 08:55:22','Marc Guillemot','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 enhancement','ba6d31f','Mark Emlyn David Thomas','2011-05-10 05:17:55','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46451 Configure svn:bugtraq properties for Tomcat trunk Based on a patch provided by Marc Guillemot','webapps/docs/changelog.xml'),(906,51177,'Bug 51177 – javax.el.MapELResolver getType returns class of kept object instead of Object.class','','2011-05-09 11:18:04','Fyodor Kravchenko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Servlet & JSP API','P2 major','e7c15c9','Mark Emlyn David Thomas','2011-05-09 14:44:11','Additional fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=51177 ListElResolver should also return Object.class for getType()','java/javax/el/ListELResolver.java\ntest/org/apache/el/TestValueExpressionImpl.java'),(907,51177,'Bug 51177 – javax.el.MapELResolver getType returns class of kept object instead of Object.class','','2011-05-09 11:18:04','Fyodor Kravchenko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Servlet & JSP API','P2 major','7eb45c8','Mark Emlyn David Thomas','2011-05-09 12:31:03','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51177 MapElResolver should always return Object.class for getType()','java/javax/el/MapELResolver.java\ntest/org/apache/el/TestValueExpressionImpl.java\nwebapps/docs/changelog.xml'),(908,51156,'Bug 51156 – \"Expire sessions\" button not visible for context configured in server.xml','If app is configured in server.xml like this:\n\n{code}\n  <Host name=\"www.myapp.pl\" appBase=\"/usr/lib/tomcat/webapps\"\n                unpackWARs=\"false\" autoDeploy=\"false\"\n              xmlValidation=\"false\" xmlNamespaceAware=\"false\"  >\n     <Context docBase=\"/var/www/myapp\" path=\"\" cacheMaxSize=\"5120\"\ncacheTTL=\"60000\" cachingAllowed=\"true\" >\n     </Context>\n     <Context path=\"/manager\"  privileged=\"true\"\ndocBase=\"/usr/lib/tomcat/webapps/manager\">\n     </Context>\n</Host>\n{code}\n\nIn Tomcat Manager, on the application list, there is a button \"Expire\nsessions\"  available only for \"/manager\" application.\nThere is no button \"Expire sessions\" for \"/\" path.\n\nI think bug is in HTMLManagerServlet.java in this part:\n\n{code}\n\n                if (context.getPath().equals(this.context.getPath())) {\n                    writer.print(MessageFormat.format(\n                        MANAGER_APP_ROW_BUTTON_SECTION, args));\n                } else if (context.getAvailable() && isDeployed) {\n                    writer.print(MessageFormat.format(\n                        STARTED_DEPLOYED_APPS_ROW_BUTTON_SECTION, args));\n                } else if (context.getAvailable() && !isDeployed) {\n                    writer.print(MessageFormat.format(\n                        STARTED_NONDEPLOYED_APPS_ROW_BUTTON_SECTION, args));\n                } else if (!context.getAvailable() && isDeployed) {\n                    writer.print(MessageFormat.format(\n                        STOPPED_DEPLOYED_APPS_ROW_BUTTON_SECTION, args));\n                } else {\n                    writer.print(MessageFormat.format(\n                        STOPPED_NONDEPLOYED_APPS_ROW_BUTTON_SECTION, args));\n                }\n{code}','2011-05-06 00:30:54','kubak','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Manager application','P2 normal','de7f0e1','Mark Emlyn David Thomas','2011-05-06 05:22:38','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51156 Expose session expiration option for apps defined in server.xml','java/org/apache/catalina/manager/HTMLManagerServlet.java\nwebapps/docs/changelog.xml'),(909,51155,'Bug 51155 – Missing @deprecated comments','','2011-05-05 19:36:28','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 normal','f477068','Mark Emlyn David Thomas','2011-05-06 04:05:42','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51155 Add missing comments to @deprecated code Patch provided by sebb','java/javax/servlet/jsp/el/ELException.java\njava/javax/servlet/jsp/el/ELParseException.java\njava/javax/servlet/jsp/el/Expression.java\njava/javax/servlet/jsp/el/ExpressionEvaluator.java\njava/javax/servlet/jsp/el/FunctionMapper.java\njava/javax/servlet/jsp/el/VariableResolver.java\nwebapps/docs/changelog.xml'),(910,51154,'Bug 51154 – Spurious @deprecated tags in ServletContext','','2011-05-05 19:33:18','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 normal','01e1850','Mark Emlyn David Thomas','2011-05-06 03:54:53','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51154 Remove duplicate @deprecated tags Patch provided by sebb','java/javax/servlet/ServletContext.java\nwebapps/docs/changelog.xml'),(911,47371,'Bug 47371 – EL expression parser error when getter methed return an empty string','There is a jsp file called test.jsp:\n<%@ page contentType=\"text/html; charset=UTF-8\" %>\n<jsp:directive.page import=\"java.util.Map\"/>\n<jsp:directive.page import=\"java.util.HashMap\"/>\n<%!public class CellAttributes{\n	private String cellValue;\n\n	public CellAttributes(String cellValue) {\n		this.cellValue = cellValue;\n	}\n	public String getCellValue() {\n		return cellValue;\n	}\n} %>\n<%Map<String,CellAttributes> currentRow = new HashMap<String, CellAttributes>();\n\ncurrentRow.put(\"a\",new CellAttributes(\"\"));\ncurrentRow.put(\"b\",new CellAttributes(\"1\"));\npageContext.setAttribute(\"currentRow\",currentRow);\n\n%>\n<Html>\n<BODY>\n${currentRow[\'a\'].cellValue+currentRow[\'b\'].cellValue}\n</BODY>\n</Html>\n\nthrows exception：\njava.lang.NumberFormatException: For input string: \"\"\n	java.lang.NumberFormatException.forInputString(NumberFormatException.java:48)\n	java.lang.Long.parseLong(Long.java:424)\n	java.lang.Long.<init>(Long.java:671)\n	org.apache.el.lang.ELArithmetic$LongDelegate.coerce(ELArithmetic.java:186)\n	org.apache.el.lang.ELArithmetic.coerce(ELArithmetic.java:357)\n	org.apache.el.lang.ELArithmetic.add(ELArithmetic.java:235)\n	org.apache.el.parser.AstPlus.getValue(AstPlus.java:40)\n	org.apache.el.ValueExpressionImpl.getValue(ValueExpressionImpl.java:186)\n	org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate(PageContextImpl.java:935)\n	org.apache.jsp.new_jsp._jspService(new_jsp.java:84)\n	org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)\n	javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n	org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:374)\n	org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:342)\n	org.apache.jasper.servlet.JspServlet.service(JspServlet.java:267)\n	javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n\nbut I think it should be \"1\"','2009-06-16 02:55:55','Wang','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P1 normal','d9b9505','Mark Emlyn David Thomas','2011-05-05 09:39:09','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47371 Correctly coerce the empty string to zero when used as an operand in EL arithmetic. Patch provided by gbt.','java/org/apache/el/lang/ELArithmetic.java\ntest/org/apache/el/lang/TestELArithmetic.java\nwebapps/docs/changelog.xml'),(912,50950,'Bug 50950 – NotSerializableException: org.apache.catalina.realm.GenericPrincipal','','2011-03-20 13:28:18','Ronald Klop','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Cluster','P2 normal','0559491','Mark Emlyn David Thomas','2011-05-05 08:38:44','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50950 Correct possible NotSerializableException for an authenticated session when running with a security manager.','java/org/apache/catalina/ha/session/DeltaSession.java\nwebapps/docs/changelog.xml'),(913,51099,'Bug 51099 – SPNEGO loginConfigName does not work','As reported by fhanik on the dev list:\n\n2. com.sun.security.jgss.krb5.accept is not configurable\nWhile the authenticator has the attribute loginConfigName, there seems to be a place in the code where it omits this entry.\nrenaming this entry in jaas.conf and setting the loginConfigName will fail to validate a ticket\n\nThe problem code is here:\n\n            gssContext = manager.createContext(manager.createCredential(null,\n                    GSSCredential.DEFAULT_LIFETIME,\n                    new Oid(\"1.3.6.1.5.5.2\"),\n                    GSSCredential.ACCEPT_ONLY));\n\nshould look like\n            final GSSManager manager = GSSManager.getInstance();\n            final PrivilegedExceptionAction<GSSCredential> action =\n                new PrivilegedExceptionAction<GSSCredential>() {\n                    public GSSCredential run() throws GSSException {\n                        return manager.createCredential(null,\n                                GSSCredential.DEFAULT_LIFETIME,\n                                new Oid(\"1.3.6.1.5.5.2\"),\n                                GSSCredential.ACCEPT_ONLY);\n                    }\n                };\n            gssContext = manager.createContext(Subject.doAs(lc.getSubject(), action));||\n\n\nbest\nFilip','2011-04-21 05:11:31','Mark Thomas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','343a609','Mark Emlyn David Thomas','2011-05-04 17:47:09','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51099 Get loginConfigName working with non-default values Patch by fhanik (plus some minor code clean-up)','java/org/apache/catalina/authenticator/LocalStrings.properties\njava/org/apache/catalina/authenticator/SpnegoAuthenticator.java\nwebapps/docs/changelog.xml'),(914,51119,'Bug 51119 – extras - JmxRemoteLifecycleListener does not support JAAS based authentication and authorisation','(Also true in Tomcat 7)\n\nThe JmxRemoteLifecycleListener does not support JAAS based authentication.\n\nThat is, when authentication is required, it only supports file based authentication.','2011-04-26 05:29:40','Neil laurance','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 enhancement','2ffa0f7','Mark Emlyn David Thomas','2011-05-04 16:22:08','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51119 Add JAAS authentication support to the JmxRemoteLifecycleListener Patch provided by Neil Laurance','java/org/apache/catalina/mbeans/JmxRemoteLifecycleListener.java\nwebapps/docs/changelog.xml'),(915,51124,'Bug 51124 – ArrayIndexOutOfBoundsException after setting org.apache.jasper.runtime.BodyContentImpl.LIMIT_BUFFER=true','First of all, I know that there has been a bug regarding a similar problem before and that it was fixed. But currently this bugs occurs even with tomcat version 6.0.32.\n\nWe have a problem with the tomcat runnign with the parameter org.apache.jasper.runtime.BodyContentImpl.LIMIT_BUFFER=true.\n\nAfter the tomcat has just started, everything is fine but after one or two days a lot of ArrayIndexOutOfBoundsException occur on random pages of the application.\n\nTomcats started without this parameter don\'t seem to have that problem.\n\nUnfortunately we weren\'t able reproduce the bug locally, It appears only on our production system.\n\nCould there be a concurrency problem, that only shows if a lot it going on on the platform?\n\nI can provide two small stackstraces that can show the classes where the problem occurs:\n\n1.\n\nCaused by: java.lang.ArrayIndexOutOfBoundsException\n        at org.apache.jasper.runtime.BodyContentImpl.write(Unknown Source)\n        at java.io.PrintWriter.write(PrintWriter.java:382)\n        at org.apache.jasper.runtime.JspWriterImpl.flushBuffer(Unknown Source)\n        at org.apache.jasper.runtime.PageContextImpl.release(Unknown Source)\n        at org.apache.jasper.runtime.JspFactoryImpl.internalReleasePageContext(Unknown Source)\n        at org.apache.jasper.runtime.JspFactoryImpl.releasePageContext(Unknown Source)\n        at org.apache.jsp.members.lists.short_.incomingShortList_jsp._jspService(incomingShortList_jsp.java:796)\n        at org.apache.jasper.runtime.HttpJspBase.service(Unknown Source)\n        at javax.servlet.http.HttpServlet.service(Unknown Source)\n\n2.\n\nCaused by: java.lang.ArrayIndexOutOfBoundsException\n        at java.lang.String.getChars(String.java:854)\n        at org.apache.jasper.runtime.BodyContentImpl.write(Unknown Source)\n        at org.apache.jasper.runtime.BodyContentImpl.write(Unknown Source)\n        at org.apache.jasper.runtime.BodyContentImpl.print(Unknown Source)\n        at org.apache.taglibs.standard.tag.common.fmt.MessageSupport.doEndTag(MessageSupport.java:203)\n        at org.apache.jsp.members.profiles.profile_jsp._jspx_meth_fmt_005fmessage_005f2(profile_jsp.java:4897)\n        at org.apache.jsp.members.profiles.profile_jsp._jspService(profile_jsp.java:481)\n        at org.apache.jasper.runtime.HttpJspBase.service(Unknown Source)\n        at javax.servlet.http.HttpServlet.service(Unknown Source)','2011-04-27 06:31:47','Juergen','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','2cdbcd5','Mark Emlyn David Thomas','2011-05-04 15:53:54','Re-factor to try and determine if the root cause of https://issues.apache.org/bugzilla/show_bug.cgi?id=51124 is an OOME or something else.','java/org/apache/jasper/runtime/BodyContentImpl.java\nwebapps/docs/changelog.xml'),(916,51135,'Bug 51135 – [Windows installer] Autoselect 32-bit JRE on 64-bit systems if 64-bit one is not available','','2011-04-28 17:57:17','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Packaging','P2 enhancement','e9c4dca','Mark Emlyn David Thomas','2011-05-04 06:14:19','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51135 Fix auto-detection of JAVA_HOME for 64-bit Windows platforms that only have a 32-bit JVM installed.','res/tomcat.nsi\nwebapps/docs/changelog.xml'),(917,51136,'Bug 51136 – Allow to set the context name through Tomcat\'s embeded class before adding it to the host','org.apache.catalina.startup.Tomcat creates contexts and add them to the host directly. It would be nice if we could set the name of the context before adding it to the host.\n\nI\'m including a patch that overloads the methods \"addWebapp\" and \"addContext\" to take that name as a parameter.','2011-04-29 16:18:31','David Calavera','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','2dc54c4','Mark Emlyn David Thomas','2011-05-04 04:48:26','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51136 Provide methods that enable the name of a Context on Context creation when using Tomcat in an embedded scenario. Based on a patch provided by David Calavera.','java/org/apache/catalina/startup/Tomcat.java\nwebapps/docs/changelog.xml');
INSERT INTO `bug_commit` VALUES (918,48817,'Bug 48817 – Skip validation query and use JDBC API for validation','The jdbc-pool should allow, if Java 6 is present, to not have to configure the validationQuery, but instead use the \njava.sql.Connection.isValid(int timeout)\nmethod call','2010-02-25 18:21:40','Filip Hanik','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','d7ba561','Filip Hanik','2011-05-02 13:16:45','Fix bug https://issues.apache.org/bugzilla/show_bug.cgi?id=48817','modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java'),(919,48817,'Bug 48817 – Skip validation query and use JDBC API for validation','The jdbc-pool should allow, if Java 6 is present, to not have to configure the validationQuery, but instead use the \njava.sql.Connection.isValid(int timeout)\nmethod call','2010-02-25 18:21:40','Filip Hanik','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','58d1860','Filip Hanik','2011-04-29 13:33:15','https://issues.apache.org/bugzilla/show_bug.cgi?id=48817 Add in setValidator to support dependency injection frameworks like Spring etc','modules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/DataSourceProxy.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/PoolConfiguration.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/PoolProperties.java\nmodules/jdbc-pool/src/main/java/org/apache/tomcat/jdbc/pool/jmx/ConnectionPool.java'),(920,51095,'Bug 51095 – NPE in AprEndpoint.java','','2011-04-20 12:51:05','Mike Glazer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','75d28d4','Mark Emlyn David Thomas','2011-04-23 17:57:58','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51095 Don\'t trigger a NullPointerException when the SSL handshake fails with the HTTP-APR connector. Patch provided by Mike Glazer.','java/org/apache/tomcat/util/net/AprEndpoint.java\nwebapps/docs/changelog.xml'),(921,49916,'Bug 49916 – use an init-param for jspFile on explicit jsp servlets','','2010-09-11 02:10:28','david jencks','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','18a51a1','Mark Emlyn David Thomas','2011-04-18 09:41:37','Correct a regression in the fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=49916 that resulted in JSPs being compiled twice rather than just once.','java/org/apache/jasper/servlet/JspServlet.java\nwebapps/docs/changelog.xml'),(922,50173,'Bug 50173 – JDBCSampler discards ResultSet from a PreparedStatement.','Hi,\n I am using JMeter with a Test Plan that uses a JDBC Request with a PreparedStatement query type.\n When running this I am getting the following error in the jmeter.log file\n\n2010/10/28 11:30:31 INFO  - jmeter.threads.JMeterThread: Thread started: JDBC Users 1-1 \n2010/10/28 12:13:38 ERROR - jmeter.threads.JMeterThread: Error while processing sampler \'PREPARED SELECT Customer JDBC Request\' : java.lang.NullPointerException\n	at org.apache.jmeter.protocol.jdbc.sampler.JDBCSampler.getStringFromResultSet(JDBCSampler.java:415)\n	at org.apache.jmeter.protocol.jdbc.sampler.JDBCSampler.resultSetsToString(JDBCSampler.java:268)\n	at org.apache.jmeter.protocol.jdbc.sampler.JDBCSampler.sample(JDBCSampler.java:208)\n	at org.apache.jmeter.threads.JMeterThread.process_sampler(JMeterThread.java:348)\n	at org.apache.jmeter.threads.JMeterThread.run(JMeterThread.java:243)\n	at java.lang.Thread.run(Thread.java:619)\n\n The query (below) can be expected to return a number of records \nSELECT * FROM Customer WHERE ID=?;\nthe param is set to 1\n\n If I use instead a SelectStatement results are returned so the query itself is not at fault.\n\n I have retrieved the code for the v2_4 tag to identify the root cause for the NPE and create a patch. This bug report includes a patch against trunk as the issue is also in trunk. \n The root cause is due to:\norg.apache.jmeter.protocol.jdbc.sampler.JDBCSampler.sample(Entry e)\n \n The code path for PreparedStatements types starting on line 204 has in it a call to\norg.hsqldb.jdbc.JDBCPreparedStatement.executeUpdate() \nwhich returns a ResultSet. The side effect of the call is to set the JDBCPreparedStatement.currentResultSet field member to null.\n JDBCSampler does not keep the ResultSet reference. Instead it is discarded.\n\n The call on the next line (208)\nString sb = resultSetsToString(pstmt,true,null)\n again tries to get the ResultSet on line 267. This causes a NullPointerException because the JDBCPreparedStatement.currentResultSet field was set to null earlier.\n\n Looking at the code path for a CALLABLE statement type (line 190) shows better handling for queries that return ResultSet.\n\n The two lines \n207,208\n\n replaced with\n                boolean hasResultSet = pstmt.execute();\n                String sb = resultSetsToString(pstmt,hasResultSet,null);\n                \n fixes the defect.\n\nRegards,\nJeremy Whiting\nRed Hat','2010-10-28 10:14:39','whitingjr','JMeter issues mailing list','RESOLVED FIXED','JMeter','Main','P2 normal','3a847c7','Mark Emlyn David Thomas','2011-04-16 20:02:29','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50173 Throw an exception and do not start the APR connector if it is configured for SSL and an invalid value is provided for SSLProtocol.','java/org/apache/tomcat/util/net/AprEndpoint.java\njava/org/apache/tomcat/util/net/res/LocalStrings.properties\nwebapps/docs/changelog.xml'),(923,50158,'Bug 50158 – Tomcat7.0.4 ROOT BUG','Recent projects encountered a BUG with Tomcat7.0.4\n   When a single operating system and start when the two TOMCAT. TOMCAT\'s ROOT directory for each deployment of a PROJECT,\n   At the same time using two different IE or FIREFOX to access the application, the test found that two applications of the session will be conflicts! When an application log, the other\n   Session of an application will fail, and when another application log, the first session of an application will be invalid.\n   Test environment:\n    Operating System: Centos5\n    Client: At the same tests using IE or firefox the same time with the test. If a use IE, another application with firefox. The problem does not occur\n    Server: TOMCAT7.0.4','2010-10-26 11:32:12','醉我行','Tomcat Developers Mailing List','RESOLVED INVALID','Tomcat 7','Catalina','P2 normal','fd9e112','Mark Emlyn David Thomas','2011-04-16 19:41:32','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50158 Ensure the asynchronous requests never timeout if the timeout is set to zero or less. Based on a patch provided by Chris.','java/org/apache/tomcat/util/net/AprEndpoint.java\njava/org/apache/tomcat/util/net/JIoEndpoint.java\njava/org/apache/tomcat/util/net/NioEndpoint.java\njava/org/apache/tomcat/util/net/SocketProperties.java\nwebapps/docs/changelog.xml'),(924,51050,'Bug 51050 – MIME types for m4a & m4v files','','2011-04-11 11:08:19','Cédrik LIME','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','9e86eb5','Mark Emlyn David Thomas','2011-04-16 18:50:05','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51050 Add additional common but non-standard file extension to MIME type mappings for MPEG 4 files. Based on a patch by Cédrik Lime.','conf/web.xml\nwebapps/docs/changelog.xml'),(925,51042,'Bug 51042 – HttpSessionListener.sessionCreated() is called a second time when user is authenticated with no matching sessionDestroyed() call.','When my web application has a HttpSessionListener configured in its web.xml, then that classes sessionCreated() is called when a user is assigned a new session.\n\nHowever, that method is *also* called when that user authenticates itself and the session is assigned a new ID (whether or not this is actually a \"new session\" can be disputed, but that\'s not the point of this bug).\n\nWhen the session is removed (due to a timeout, for example), then a single sessionDestroyed() call is executed.\n\nWhen the HttpSessionListener manages some kind of external resource, this behaviour leads to a resource leak, because sessionCreated() is called twice, while sessionRemoved() is only called once!\n\nI\'m aware of the reason for changing the session ID and (somehow) understand why sessionCreated() is called again (after all there\'s a new session ID), but there must be *some* way for the SessionListener to be notified that the \"old session\" no longer exists.\n\nThe same behaviour is seen in Tomcat 6.0 (and probably 5.5 as well, but I didn\'t test that).','2011-04-08 05:54:06','Joachim Sauer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','dc3758e','Mark Emlyn David Thomas','2011-04-16 18:25:28','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51042 Don\'t trigger session creation listeners when changing the session ID during authentication.','java/org/apache/catalina/Session.java\njava/org/apache/catalina/ha/session/DeltaManager.java\njava/org/apache/catalina/ha/session/DeltaSession.java\njava/org/apache/catalina/ha/session/JvmRouteBinderValve.java\njava/org/apache/catalina/manager/DummyProxySession.java\njava/org/apache/catalina/session/ManagerBase.java\njava/org/apache/catalina/session/StandardSession.java\nwebapps/docs/changelog.xml'),(926,51038,'Bug 51038 – No access logs for Servlet 3.0 async requests','Access logs written by org.apache.catalina.valves.AccessLogValve are not being written for servlet 3.0 async requests.\n\nTo reproduce:\n- Handle a request asynchronously by marking the servlet with @WebServlet(asyncSupported=true)\n- Send some traffic and notice that nothing is being written to the access logs.\n\nAccessLogValve.log() is called by org.apache.catalina.Context.logAccess().\nFrom the source for version 7.0.11, in org.apache.catalina.connector.CoyoteAdapter.java, line 416:\n\n            AsyncContextImpl asyncConImpl = (AsyncContextImpl)request.getAsyncContext();\n            if (asyncConImpl != null) {\n                async = true;\n            } else if (!comet) {\n                response.finishResponse();\n                if (postParseSuccess) {\n                    // Log only if processing was invoked.\n                    // If postParseRequest() failed, it has already logged it.\n                    ((Context) request.getMappingData().context).logAccess(\n                            request, response,\n                            System.currentTimeMillis() - req.getStartTime(),\n                            false);\n                }\n                req.action(ActionCode.POST_REQUEST , null);\n            }\n\nIn the async case logAccess() isn\'t called here. I\'ve searched through the code and don\'t see logAccess() being called anywhere else, except in error cases. So, it looks like the async case is missing a call to logAccess() somewhere.','2011-04-07 11:18:30','Chris','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','dc3dff4','Mark Emlyn David Thomas','2011-04-16 17:22:58','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=51038 Ensure async requests are included in access logs.','java/org/apache/catalina/connector/CoyoteAdapter.java\ntest/org/apache/catalina/core/TestAsyncContextImpl.java\ntest/org/apache/catalina/valves/TesterAccessLogValve.java\nwebapps/docs/changelog.xml'),(927,36362,'Bug 36362 – missing check for Java reserved keywords in tag file processing','Tag file attribute names are used as identifiers in Java source code generated\nfrom the tag file without any mangling.  If the attribute name is a Java\nkeyword, this leads to a compilation error.  As an example, try to use the\nfollowing tag file, bug.tag\n\n<%@ tag isELIgnored=\"false\" %>\n<%@ attribute name=\"default\" %>\n${default}\n\nSomewhere during tag file processing, attribute names could be checked against\nthe list of Java keywords in org.apache.jasper.compiler.JspUtils','2005-08-25 21:35:27','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 normal','374aa9a','Mark Emlyn David Thomas','2011-04-11 18:33:50','Revert fix https://issues.apache.org/bugzilla/show_bug.cgi?id=36362 JSP.8.3 does not limit the name of attributes defined in tag files','java/org/apache/jasper/compiler/Parser.java'),(928,50306,'Bug 50306 – Detect stuck threads','Feature request : \nregularly scan worker threads and if one has been processing the same request for longer than a configurable delay, log a warning with the stack trace of that thread.\nThis would allow to detect very long running threads, usually the ones that are stuck in a network call or in a deadlock.','2010-11-19 18:09:10','Sylvain Laurent','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','9c61159','Sylvain Laurent','2011-04-08 18:10:37','bug 50306: Detect stuck threads complement to changelog','webapps/docs/changelog.xml'),(929,50306,'Bug 50306 – Detect stuck threads','Feature request : \nregularly scan worker threads and if one has been processing the same request for longer than a configurable delay, log a warning with the stack trace of that thread.\nThis would allow to detect very long running threads, usually the ones that are stuck in a network call or in a deadlock.','2010-11-19 18:09:10','Sylvain Laurent','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','3f03631','Sylvain Laurent','2011-04-07 16:50:28','https://issues.apache.org/bugzilla/show_bug.cgi?id=50306 StuckThreadDetectionValve, based on code proposed by TomLu','java/org/apache/catalina/valves/LocalStrings.properties\njava/org/apache/catalina/valves/StuckThreadDetectionValve.java\njava/org/apache/catalina/valves/mbeans-descriptors.xml\nwebapps/docs/config/valve.xml'),(930,50957,'Bug 50957 – Blocking IO can serve wrong response data','','2011-03-22 18:09:35','Brad Plies','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 major','ccac8a9','Mark Emlyn David Thomas','2011-04-06 12:39:38','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50957 Fix regression in processing of pipe-lined requests.','java/org/apache/coyote/http11/Http11Processor.java\ntest/org/apache/coyote/http11/TestAbstractHttp11Processor.java\nwebapps/docs/changelog.xml'),(931,51028,'Bug 51028 – Build fails if Saxon 9 is on Ant\'s classpath','','2011-04-06 05:13:52','Michael Osipov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Packaging','P2 normal','78c5264','Konstantin Kolinko','2011-04-06 10:28:58','Fix \"bad character\" complaints by modern XSLT processors https://issues.apache.org/bugzilla/show_bug.cgi?id=51028','webapps/docs/changelog.xml'),(932,12428,'Bug 12428 – request.getUserPrincipal(): Misinterpretation of specification?','When calling request.getUserPrincipal() from an unprotected resource, the method returns \nnull even when the user is actually authenticated.\n\nFrom Servlet 2.3 spec:\npublic \njava.security.Principal getUserPrincipal()\nReturns a java.security.Principal object \ncontaining the name of the current\nauthenticated user. If the user has not been authenticated, \nthe method returns\nnull.\n\nMy interpretation would be that once a user has been \nauthenticated, a call to getUserPrincipal() would always return the associated Principal \nobject whether it is from a protected or unprotected resource.','2002-09-09 09:28:17','Dylan van Iersel','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P3 enhancement','b7b5c63','Mark Emlyn David Thomas','2011-04-01 06:49:43','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=12428 Add optional support for preemptive authentication on a per context basis Based on a patch suggested by Werner Donn This includes the fix for CVE-2011-1183','java/org/apache/catalina/Context.java\njava/org/apache/catalina/authenticator/AuthenticatorBase.java\njava/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/startup/ContextConfig.java\ntest/org/apache/catalina/core/TestStandardWrapper.java\ntest/webapp-3.0-servletsecurity2/WEB-INF/web.xml\ntest/webapp-3.0-servletsecurity2/protected.jsp\ntest/webapp-3.0-servletsecurity2/unprotected.jsp\nwebapps/docs/changelog.xml\nwebapps/docs/config/context.xml'),(933,50991,'Bug 50991 – Data source is closed before contextDestroyed is executed. tomcat 7.0.11','','2011-03-29 08:13:54','Mark Shifman','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','06a222c','Mark Emlyn David Thomas','2011-03-31 09:11:26','Feedback on https://issues.apache.org/bugzilla/show_bug.cgi?id=50991 No point trying to close a non-singleton resource','java/org/apache/catalina/deploy/NamingResources.java\nwebapps/docs/changelog.xml\nwebapps/docs/config/context.xml'),(934,50991,'Bug 50991 – Data source is closed before contextDestroyed is executed. tomcat 7.0.11','','2011-03-29 08:13:54','Mark Shifman','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','27c12ee','Mark Emlyn David Thomas','2011-03-31 09:02:20','Feedback on https://issues.apache.org/bugzilla/show_bug.cgi?id=50991 Change the default','java/org/apache/catalina/deploy/ContextResource.java\nwebapps/docs/changelog.xml\nwebapps/docs/config/context.xml'),(935,50997,'Bug 50997 – StandardJarScanner ignores web-fragment.xml files in unpacked jars if they are not ending with \".jar\"','','2011-03-30 11:57:49','Rodion Zhitomirsky','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','62ddb9e','Mark Emlyn David Thomas','2011-03-30 16:06:25','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50997 Relax the requirement that directories must have a name ending in .jar to be treated as an expanded JAR file by the default JarScanner. Based on patch by Rodion Zhitomirsky.','java/org/apache/catalina/startup/ContextConfig.java\njava/org/apache/tomcat/util/scan/StandardJarScanner.java\nwebapps/docs/changelog.xml'),(936,50984,'Bug 50984 – Manager application fails to report stranded artifacts when undeploying','','2011-03-28 03:42:36','Francis Galiegue','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Manager','P2 major','b134a62','Mark Emlyn David Thomas','2011-03-30 13:39:54','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50984 When using the Manager application ensure that undeployment is reported as failed if a file cannot be deleted.','java/org/apache/catalina/manager/LocalStrings.properties\njava/org/apache/catalina/manager/ManagerServlet.java\nwebapps/docs/changelog.xml'),(937,50984,'Bug 50984 – Manager application fails to report stranded artifacts when undeploying','','2011-03-28 03:42:36','Francis Galiegue','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Manager','P2 major','b12358e','Mark Emlyn David Thomas','2011-03-30 11:41:02','Fix Eclipse/FindBugs warnings apart from those that trigger bug 50984','java/org/apache/catalina/manager/Constants.java\njava/org/apache/catalina/manager/LocalStrings.properties\njava/org/apache/catalina/manager/ManagerServlet.java\njava/org/apache/catalina/manager/StatusManagerServlet.java\njava/org/apache/catalina/manager/host/Constants.java\njava/org/apache/catalina/manager/host/HTMLHostManagerServlet.java\njava/org/apache/catalina/manager/util/BaseSessionComparator.java\njava/org/apache/catalina/manager/util/ReverseComparator.java\nres/findbugs/filter-false-positives.xml'),(938,50991,'Bug 50991 – Data source is closed before contextDestroyed is executed. tomcat 7.0.11','','2011-03-29 08:13:54','Mark Shifman','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','5c56463','Mark Emlyn David Thomas','2011-03-30 08:48:13','Correct fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50991 Stop resource after app has finished with them but before they are unbound','java/org/apache/catalina/core/StandardContext.java'),(939,50991,'Bug 50991 – Data source is closed before contextDestroyed is executed. tomcat 7.0.11','','2011-03-29 08:13:54','Mark Shifman','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','b3d9ee8','Mark Emlyn David Thomas','2011-03-30 08:26:39','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50991 Stop the resources after they have been unbound rather than before','java/org/apache/catalina/core/StandardContext.java\nwebapps/docs/changelog.xml'),(940,50928,'Bug 50928 – [patch] JSSESocketFactory - wrong password in KeyManagerFactory.init','','2011-03-14 09:53:51','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','f06a5aa','Mark Emlyn David Thomas','2011-03-29 18:39:36','Correct fix for http://issues.apache.org/bugzilla/show_bug.cgi?id=50928 Default for keyPass is keystorePass','java/org/apache/tomcat/util/net/AbstractEndpoint.java'),(941,50957,'Bug 50957 – Blocking IO can serve wrong response data','','2011-03-22 18:09:35','Brad Plies','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 major','fd8a579','Mark Emlyn David Thomas','2011-03-28 15:19:23','Protect against things going wrong during access logging. An un-handled exception here could trigger some unexpected code paths. Possible contributing factor to https://issues.apache.org/bugzilla/show_bug.cgi?id=50957 ? This is part of the fix for CVE-2011-1475','java/org/apache/catalina/connector/CoyoteAdapter.java\njava/org/apache/catalina/connector/LocalStrings.properties'),(942,50957,'Bug 50957 – Blocking IO can serve wrong response data','','2011-03-22 18:09:35','Brad Plies','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 major','d2e8f2e','Mark Emlyn David Thomas','2011-03-28 15:15:06','Move the processor.recycle calls to just before the point where the processor is returned to the pool. This ensures returned processors are recycled (this could have been skipped on some exception paths) Possible contributing factor to https://issues.apache.org/bugzilla/show_bug.cgi?id=50957 ? This is part of the fix for CVE-2011-1475','java/org/apache/coyote/ajp/AjpAprProcessor.java\njava/org/apache/coyote/ajp/AjpAprProtocol.java\njava/org/apache/coyote/ajp/AjpProcessor.java\njava/org/apache/coyote/ajp/AjpProtocol.java\njava/org/apache/coyote/http11/Http11AprProcessor.java\njava/org/apache/coyote/http11/Http11AprProtocol.java\njava/org/apache/coyote/http11/Http11NioProcessor.java\njava/org/apache/coyote/http11/Http11Processor.java\njava/org/apache/coyote/http11/Http11Protocol.java'),(943,50957,'Bug 50957 – Blocking IO can serve wrong response data','','2011-03-22 18:09:35','Brad Plies','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 major','de8402d','Mark Emlyn David Thomas','2011-03-28 15:10:31','Always recycle unless it is an async request. Possible contributing factor to https://issues.apache.org/bugzilla/show_bug.cgi?id=50957 ?','java/org/apache/coyote/http11/Http11Processor.java'),(944,50927,'Bug 50927 – [patch] More specific error message for missing SSLCertificateFile','','2011-03-14 08:59:04','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 enhancement','e34f848','Mark Emlyn David Thomas','2011-03-16 05:30:10','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50927 Better error message if SSLCertificateFile not set','java/org/apache/tomcat/util/net/AprEndpoint.java\njava/org/apache/tomcat/util/net/res/LocalStrings.properties\nwebapps/docs/changelog.xml'),(945,50929,'Bug 50929 – [patch] Ensure rethrown exceptions retain the original cause','','2011-03-14 11:08:56','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','0c96676','Mark Emlyn David Thomas','2011-03-15 19:05:53','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50929 When wrapping an exception, set the root cause','java/javax/servlet/http/HttpUtils.java\njava/org/apache/catalina/connector/CoyoteInputStream.java\njava/org/apache/catalina/realm/JDBCRealm.java\njava/org/apache/catalina/valves/JDBCAccessLogValve.java\njava/org/apache/naming/resources/WARDirContext.java\njava/org/apache/tomcat/util/digester/NodeCreateRule.java\nwebapps/docs/changelog.xml'),(946,50925,'Bug 50925 – Key password no longer has to be same as keystore password','','2011-03-13 21:21:14','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 minor','5d05929','Mark Emlyn David Thomas','2011-03-15 19:00:54','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50925 Update docs for keyPass attribute','webapps/docs/changelog.xml\nwebapps/docs/ssl-howto.xml'),(947,50928,'Bug 50928 – [patch] JSSESocketFactory - wrong password in KeyManagerFactory.init','','2011-03-14 09:53:51','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','b8437cf','Mark Emlyn David Thomas','2011-03-15 18:51:10','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50928 Don\'t ignore keyPass attribute','java/org/apache/tomcat/util/net/jsse/JSSESocketFactory.java\ntest/org/apache/tomcat/util/net/TestSsl.java\ntest/org/apache/tomcat/util/net/TesterSupport.java\ntest/org/apache/tomcat/util/net/keystore-info.txt\ntest/org/apache/tomcat/util/net/localhost-copy1.jks\nwebapps/docs/changelog.xml'),(948,50903,'Bug 50903 – Current keep-alive request processed after connector.stop()','When the connector is stopped, if a connection is in a keep-alive state the next request received by that connection will be processed and then the connection will be closed. When the request is received, it should be rejected.\n\nOutstanding questions:\n- What return code (if any) should be sent back to the client?\n- If the reading of a request starts before the connector is stopped, should that request be allowed to complete or should it be rejected?','2011-03-09 14:34:53','Mark Thomas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 normal','c8ea62e','Mark Emlyn David Thomas','2011-03-15 13:48:15','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50903 If a connector is stopped, not not process any keep-alive connections. The exact behaviours are: - HTTP BIO - blocks until request line is read and then returns 503 - HTTP NIO - uses polling, so returns 503 immediately connector is stopped - HTTP APR - blocks until request line is read and then returns 503 - AJP BIO - blocks until request packet is received and then returns 503 - subsequent requests will timeout - AJP APR - no change - subsequent requests will timeout','java/org/apache/coyote/ajp/AjpProcessor.java\njava/org/apache/coyote/http11/Http11AprProcessor.java\njava/org/apache/coyote/http11/Http11NioProcessor.java\njava/org/apache/coyote/http11/Http11Processor.java\ntest/org/apache/catalina/connector/TestConnector.java\ntest/org/apache/catalina/startup/TesterServlet.java\ntest/org/apache/catalina/startup/TomcatBaseTest.java\nwebapps/docs/changelog.xml'),(949,50924,'Bug 50924 – Table does not mention Tomcat 7','','2011-03-13 21:15:53','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 minor','e6a2452','Mark Emlyn David Thomas','2011-03-14 08:39:01','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50924 Clean-up HTTP comparison table','webapps/docs/changelog.xml\nwebapps/docs/config/http.xml'),(950,50887,'Bug 50887 – Enhancement to set security-provider within AjpAprProcessor','','2011-03-08 04:49:48','Mark Thomas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','552c4b7','Mark Emlyn David Thomas','2011-03-13 10:01:34','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50887 Add support for configuring the JSSE provider used to convert client certificates. Based on a patch by pknopp.','java/org/apache/catalina/valves/LocalStrings.properties\njava/org/apache/catalina/valves/SSLValve.java\njava/org/apache/coyote/AbstractProtocolHandler.java\njava/org/apache/coyote/ajp/AbstractAjpProcessor.java\njava/org/apache/coyote/ajp/AjpAprProtocol.java\njava/org/apache/coyote/ajp/AjpProtocol.java\njava/org/apache/coyote/http11/Http11AprProcessor.java\njava/org/apache/coyote/http11/Http11AprProtocol.java\nwebapps/docs/changelog.xml\nwebapps/docs/config/ajp.xml\nwebapps/docs/config/http.xml'),(951,50911,'Bug 50911 – Quieten NSIS so errors and warnings can be seen','','2011-03-10 09:38:59','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Packaging','P2 enhancement','30c81c0','Mark Emlyn David Thomas','2011-03-11 12:38:19','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50911 Reduce noise generated during the build of the Windows installer so warnings are more obvious. Patch provided by sebb','build.xml\nwebapps/docs/changelog.xml'),(952,50895,'Bug 50895 – JSP compiler initializes classes during compile which can result in failures','','2011-03-08 15:27:00','Andy Wang','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','5d61212','Mark Emlyn David Thomas','2011-03-09 08:52:07','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50895 Don\'t initialize classes during compilation','java/org/apache/jasper/compiler/ELFunctionMapper.java\nwebapps/docs/changelog.xml'),(953,50893,'Bug 50893 – Extras etc documentation not easy to find','','2011-03-08 12:49:20','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Packaging','P2 normal','fe072dd','Mark Emlyn David Thomas','2011-03-09 08:05:05','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50893 Additional information for extras package','res/welcome.bin.html\nres/welcome.main.html\nwebapps/docs/changelog.xml\nwebapps/docs/extras.xml'),(954,50854,'Bug 50854 – Additional catalina.policy entries for when Security Manager enabled, for session display functionality','When running under a security manager, in 7.0.x (and also around 6.0.29+), the Sessions List options in the Tomcat Manager may display an error under certain conditions.\n\nCONDITION 1:\n\nAPR enabled, catalina.base == catalina.home:\n\n- Encountered exception org.apache.jasper.JasperException: javax.servlet.ServletException: java.lang.NoClassDefFoundError: org/apache/catalina/ha/session/DeltaSession\n\nThis permission is required:\n    permission java.lang.RuntimePermission \"accessClassInPackage.org.apache.catalina.ha.*\";\n\nCONDITION 2:\n\nRegardless of APR, if catalina.base != catalina.home and catalina.home is the location of the webapps/manager application, this error displays:\n\nFAIL - Encountered exception org.apache.jasper.JasperException: An exception occurred processing JSP page /WEB-INF/jsp/sessionsList.jsp at line 99\n\n96: 			<tbody>\n97: <% Iterator iter = activeSessions.iterator();\n98:    while (iter.hasNext()) {\n99:    	Session currentSession = (Session) iter.next();\n100:    	String currentSessionId = JspHelper.escapeXml(currentSession.getId());\n101: %>\n102: 				<tr>\n\nThis is because the policy file assumes there is a per-instance webapps/manager application in catalina.base, as opposed to a shared one in catalina.home.\n\nSuggested fix, in catalina.policy, replace ...\n\n// The Manager application needs access to the following packages to support the\n// session display functionality\ngrant codeBase \"file:${catalina.base}/webapps/manager/-\" {\n    permission java.lang.RuntimePermission \"accessClassInPackage.org.apache.catalina\";\n    permission java.lang.RuntimePermission \"accessClassInPackage.org.apache.catalina.manager\";\n    permission java.lang.RuntimePermission \"accessClassInPackage.org.apache.catalina.manager.util\";\n    permission java.lang.RuntimePermission \"accessClassInPackage.org.apache.catalina.ha.*\";\n};\n\n... with ...\n\n// The Manager application needs access to the following packages to support the\n// session display functionality\ngrant codeBase \"file:${catalina.home}/webapps/manager/-\" {\n    permission java.lang.RuntimePermission \"accessClassInPackage.org.apache.catalina\";\n    permission java.lang.RuntimePermission \"accessClassInPackage.org.apache.catalina.manager\";\n    permission java.lang.RuntimePermission \"accessClassInPackage.org.apache.catalina.manager.util\";\n    permission java.lang.RuntimePermission \"accessClassInPackage.org.apache.catalina.ha.*\";\n};\n\n// If using a per instance webapps directory, i.e. ${catalina.base}/webapps,\n// then the following permission will need to be uncommented\n// grant codeBase \"file:${catalina.base}/webapps/manager/-\" {\n//     permission java.lang.RuntimePermission \"accessClassInPackage.org.apache.catalina\";\n//     permission java.lang.RuntimePermission \"accessClassInPackage.org.apache.catalina.manager\";\n//     permission java.lang.RuntimePermission \"accessClassInPackage.org.apache.catalina.manager.util\";\n//     permission java.lang.RuntimePermission \"accessClassInPackage.org.apache.catalina.ha.*\";\n// };\n\n* In the above, I\'ve used the same commented-out approach as the one for the \"file:${catalina.base}/lib/-\" permissions for consistency, but the catalina.base permissions could also be left uncommented if most installations copy the default webapps folder into each instance and use it from there, to make larger deployments easier.\n\nBest Regards,\nNeale Rudd','2011-03-02 10:06:46','Neale Rudd','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Manager application','P2 normal','38f4711','Mark Emlyn David Thomas','2011-03-09 06:38:38','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50854 Add additional permissions required by the Manager application when running under a security Manager and support a shared Manager installation when $CATALINA_HOME != CATALINA_BASE.','conf/catalina.policy\nwebapps/docs/changelog.xml'),(955,25060,'Bug 25060 – Reloading context orphans currently open jndi datasource connections','I fiddled around with this a while and have determined to the best of my ability\nthat this is a real bug.  I have a jndi datasource connected to a postgresql\nserver.  I have two jndi resources (a reader and writer) so that later I can\nimplement a system with replication etc and deal with writes and reads to\ndifferent connections.  To summarize, after using the system, there are two\nconnections to postgres that get reused -- one reader and writer.  Under load,\nthis number increases and will slowly go back down.  I usually end up with two\nidle connections (one reader and one writer) left under no load.  If you reload\nthe context where the datasource is at (it\'s a context specific datasource), the\nnumber of connections will jump by two when used.  Each reload produces 2 more\nconnections min until I restart the server.  It appears that after a reload, the\n\'persisted connections\' get abandoned / orphaned.  Eventually, I hit my max\nconnections and cannot aquire any more and the system fails.  I have tried the\nabandond collection parameters and have added debug logging to my code to ensure\nthat I am indeed calling close on the connections I checkout, even on exceptions\nand error cases.  Under normal useage without reloads, no connection leakage\nhappens.\n\nThis is on a solaris 8 machine with the 4.1.27-hotfix-22096.tar.gz applied.  Let\nme know if more information is required.  I have this in a development\nenvironment and can let somone attach in jdb and hammer on the thing since it\'s\nnot a production system -- if that will help in getting a repro.\n\nWayne','2003-11-27 21:15:10','Wayne Schroeder','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 4','Unknown','P3 enhancement','1211dbe','Mark Emlyn David Thomas','2011-03-08 17:15:34','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=25060 When stopping naming resources look for DataSource resources with a zero-arg close() method and call it if one is found Works with Commons DBCP.','java/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/deploy/LocalStrings.properties\njava/org/apache/catalina/deploy/NamingResources.java\nwebapps/docs/changelog.xml'),(956,48208,'Bug 48208 – allow to configure a custom client certificate Trust Manager in server.xml per connector attribute \"trustManagerClassName\"','','2009-11-17 00:44:09','Ralf Hauser','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 enhancement','9011d1d','Mark Emlyn David Thomas','2011-03-08 10:19:19','Align SSL init for BIO and NIO. Fixes https://issues.apache.org/bugzilla/show_bug.cgi?id=48208 for NIO. Adds support for keyPass, truststoreProvider & keystoreProvider','java/org/apache/tomcat/util/net/NioEndpoint.java\njava/org/apache/tomcat/util/net/SSLUtil.java\njava/org/apache/tomcat/util/net/jsse/JSSESocketFactory.java'),(957,48208,'Bug 48208 – allow to configure a custom client certificate Trust Manager in server.xml per connector attribute \"trustManagerClassName\"','','2009-11-17 00:44:09','Ralf Hauser','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 enhancement','7266f3c','Mark Emlyn David Thomas','2011-03-08 06:15:37','Refactor to address https://issues.apache.org/bugzilla/show_bug.cgi?id=48208#c13 Don\'t configure a TrustManagerFactory instance if it isn\'t going to be used.','java/org/apache/tomcat/util/net/jsse/JSSESocketFactory.java'),(958,26701,'Bug 26701 – Enabling web applications to register their own stream handlers','A stream handler factory can be registered once per VM and tomcat registers the \nDirContextStreamHandlerFactory for the jndi protocol. However if there are web \napplications running inside that want to register handlers for custom scheme \ncurrently it is not possible.\n\nCan the DirContextStreamHandlerFactory be enhanced to allow applications to \nregister stream handler for custom schemes they might have. Or better can this \nbe a made a property in the context.xml file ?\n\nIs this already there - or can this enhanced in the future?','2004-02-05 21:30:18','Sankaranarayanan Ganapathy','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 4','Catalina','P3 enhancement','f622e3a','Mark Emlyn David Thomas','2011-03-06 17:12:10','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=26701 Provide a mechanism for users to register their own URLStreamHandlerFactory objects.','java/org/apache/catalina/loader/WebappLoader.java\njava/org/apache/naming/resources/Constants.java\njava/org/apache/naming/resources/DirContextURLStreamHandlerFactory.java\ntest/org/apache/naming/resources/TestDirContextURLStreamHandlerFactory.java\nwebapps/docs/changelog.xml'),(959,48208,'Bug 48208 – allow to configure a custom client certificate Trust Manager in server.xml per connector attribute \"trustManagerClassName\"','','2009-11-17 00:44:09','Ralf Hauser','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 enhancement','8368ce9','Mark Emlyn David Thomas','2011-03-06 04:33:26','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48208 Add custom trust manager support','java/org/apache/tomcat/util/net/AbstractEndpoint.java\njava/org/apache/tomcat/util/net/jsse/JSSESocketFactory.java\njava/org/apache/tomcat/util/net/jsse/res/LocalStrings.properties\ntest/org/apache/tomcat/util/net/TestCustomSsl.java\ntest/org/apache/tomcat/util/net/TesterSupport.java\nwebapps/docs/changelog.xml\nwebapps/docs/config/http.xml'),(960,50855,'Bug 50855 – NullPointerException thrown in AuthenticatorBase.register method for null principal','','2011-03-02 11:19:27','Dorin','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','b24b0c0','Mark Emlyn David Thomas','2011-03-06 02:33:58','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50855 Fix NPE on HttpServletRequest.logout() when debug logging is enabled.','java/org/apache/catalina/authenticator/AuthenticatorBase.java\nwebapps/docs/changelog.xml'),(961,50857,'Bug 50857 – Test failures on Windows 7, 24 thread system','testPoolThreads20Connections10FairAsync\n\n    [junit] java.sql.SQLException: [tomcat-pool-10] NoWait: Pool empty. Unable to fetch a connection, none available[10 in use].\n    [junit]     at org.apache.tomcat.jdbc.pool.ConnectionPool.borrowConnection(ConnectionPool.java:615)\n    [junit]     at org.apache.tomcat.jdbc.pool.ConnectionPool.getConnectionAsync(ConnectionPool.java:143)\n    [junit]     at org.apache.tomcat.jdbc.pool.DataSourceProxy.getConnectionAsync(DataSourceProxy.java:122)\n    [junit]     at org.apache.tomcat.jdbc.test.FairnessTest$TestThread.run(FairnessTest.java:231)','2011-03-02 15:50:18','Filip Hanik','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','ef547fb','Filip Hanik','2011-03-02 16:15:07','https://issues.apache.org/bugzilla/show_bug.cgi?id=50857 Timeouts have to be trapped, and properly handled','modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java'),(962,27988,'Bug 27988 – Unhelpful FileNotFoundException raised','org.apache.naming.resources.DirContextURLConnection raises FileNotFoundException\non lines 311, 344, 382 and 396.  It would be more helpful if these provided a\nmessage string.\n\nFor example, change line 344 to\n        throw new FileNotFoundException(getURL().getFile());\n\nThis would make it easier to diagnose mistakes in server configurations.','2004-03-26 17:01:25','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P3 enhancement','4a4d86e','Mark Emlyn David Thomas','2011-03-02 08:23:37','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=27988 Improve reporting of missing files','java/org/apache/naming/resources/DirContextURLConnection.java\nwebapps/docs/changelog.xml'),(963,48863,'Bug 48863 – Log directory misconfiguration for class loaders','When developing our tomcat applications with eclipse, doing out-rebuild/sysdeo plugin and have the class files written into TOMCAT_HOME/common/classes is an effective approach.\n\nFor manageability reasons, we need to split our code among several eclipse projects. The problem is if both are configured to place their .class files in TOMCAT_HOME/common/classes that when one project rebuilds, it will wipe the class files of the other one.\n\nA great efficiency gain for the development of multiple projects therefore would be to be able to specify additional classes folders in server.xml to be added to the corresponding class-loader','2010-03-05 09:04:04','Ralf Hauser','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 enhancement','07e69fb','Konstantin Kolinko','2011-03-01 18:59:36','Improve the fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=48863 1) Be more strict when ignoring the warning: ignore only when it is the \"lib\" directory and when it does not exist 2) Warn about JARs created from expanding the GLOB pattern as well 3) s/new File(f.getCanonicalPath())/f.getCanonicalFile()/ for efficiency','java/org/apache/catalina/startup/ClassLoaderFactory.java\nwebapps/docs/changelog.xml'),(964,28852,'Bug 28852 – failonerror attribute on Ant tasks','failonerror boolean attribute on manager Ant tasks would be a nice have to \nallow for more flexible operation within Ant build files.\n\nI will attach a patch next week that also fixes unecessary CRs during response \nread/print and missing url encoding in some tasks.','2004-05-08 20:23:38','Stephane Bailliez','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P3 enhancement','e1bf740','Mark Emlyn David Thomas','2011-02-28 13:15:48','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=28852 Add URL encoding where missing to parameters in URLs presented by Ant tasks to the Manager application. Based on a patch by Stephane Bailliez.','java/org/apache/catalina/ant/JMXGetTask.java\njava/org/apache/catalina/ant/JMXQueryTask.java\njava/org/apache/catalina/ant/JMXSetTask.java\njava/org/apache/catalina/ant/ResourcesTask.java\njava/org/apache/catalina/ant/UndeployTask.java\nwebapps/docs/changelog.xml'),(965,48863,'Bug 48863 – Log directory misconfiguration for class loaders','When developing our tomcat applications with eclipse, doing out-rebuild/sysdeo plugin and have the class files written into TOMCAT_HOME/common/classes is an effective approach.\n\nFor manageability reasons, we need to split our code among several eclipse projects. The problem is if both are configured to place their .class files in TOMCAT_HOME/common/classes that when one project rebuilds, it will wipe the class files of the other one.\n\nA great efficiency gain for the development of multiple projects therefore would be to be able to specify additional classes folders in server.xml to be added to the corresponding class-loader','2010-03-05 09:04:04','Ralf Hauser','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 enhancement','4334f83','Mark Emlyn David Thomas','2011-02-28 08:35:41','Improve fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=48863 - consistently pass absolute paths to validateFile() - handle non-absolute catalina home/base','java/org/apache/catalina/startup/ClassLoaderFactory.java'),(966,31027,'Bug 31027 – major error from minor whitespace error in properties file','A developer accidentally placed a tab character after the port number in the\nproperties file for a tomcat instance.  This prevented tomcat from listening on\nthat port, but it was difficult to track down whether tomcat was running.  Seems\nlike the properties-file reader could easily trim excess whitespace before\ntrying to use entries.','2004-09-02 22:36:52','Jim Eng','Tomcat Developers Mailing List','RESOLVED WONTFIX','Tomcat 5','Catalina','P3 enhancement','4b4ef0c','Mark Emlyn David Thomas','2011-02-27 08:19:22','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=31027 Trim whitespace from names and values obtained from $CATALINA_BASE/conf/catalina.properties to avoid hard to diagnose errors on startup.','java/org/apache/catalina/startup/CatalinaProperties.java\nwebapps/docs/changelog.xml'),(967,50836,'Bug 50836 – LifecycleState#isAvailable() to be more restrictive','I think some of the values returned by LifecycleState#isAvailable() are wrong.\n\n1. I am certain that MUST_DESTROY should return false, because it is a state that is later than stopped.\n2. I think that STOPPING_PREP should return false, because we can get there from the FAILED state.\n3. I think that STARTING should return false, because it is too early to return true there.\n\nAs a result, the following is the complete list of states are to return true in #isAvailable():\nSTARTED, MUST_STOP','2011-02-26 14:05:18','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','92ff888','Mark Emlyn David Thomas','2011-02-27 06:00:12','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50836 Better documentation of the meaning of Lifecycle.isAvailable() and correct a couple of cases where this could incorrectly return true.','java/org/apache/catalina/Lifecycle.java\njava/org/apache/catalina/LifecycleListener.java\njava/org/apache/catalina/LifecycleState.java\njava/org/apache/catalina/util/LifecycleBase.java\nwebapps/docs/changelog.xml'),(968,49284,'Bug 49284 – Implement SSL renegotiation for the NIO connector','Summary says it all. Entered as a reminder that it would be good to do this.','2010-05-12 19:06:24','Mark Thomas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 enhancement','dcda15d','Mark Emlyn David Thomas','2011-02-25 14:19:13','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49284 Support SSL re-negotiation in the HTTP NIO connector There is a fair amount of renaming in this patch. The real work is in the new rehandshake() method in the SecureNioChannel.','java/org/apache/coyote/http11/Http11NioProcessor.java\njava/org/apache/coyote/http11/LocalStrings.properties\njava/org/apache/tomcat/util/net/NioChannel.java\njava/org/apache/tomcat/util/net/SecureNioChannel.java\nwebapps/docs/changelog.xml'),(969,50826,'Bug 50826 – (Embedded) Tomcat.destroy() throws java.lang.IllegalArgumentException','Embedded Tomcat sometimes throws this exception when calling destroy() method:\n\njava.lang.IllegalArgumentException: null source\n	at java.util.EventObject.<init>(EventObject.java:56)\n	at javax.management.Notification.<init>(Notification.java:184)\n	at org.apache.catalina.core.StandardContext.destroyInternal(StandardContext.java:5433)\n	at org.apache.catalina.util.LifecycleBase.destroy(LifecycleBase.java:285)\n	at org.apache.catalina.core.ContainerBase.removeChild(ContainerBase.java:969)\n	at org.apache.catalina.core.ContainerBase.destroyInternal(ContainerBase.java:1108)\n	at org.apache.catalina.util.LifecycleBase.destroy(LifecycleBase.java:285)\n	at org.apache.catalina.core.ContainerBase.removeChild(ContainerBase.java:969)\n	at org.apache.catalina.core.ContainerBase.destroyInternal(ContainerBase.java:1108)\n	at org.apache.catalina.util.LifecycleBase.destroy(LifecycleBase.java:285)\n	at org.apache.catalina.core.StandardService.destroyInternal(StandardService.java:593)\n	at org.apache.catalina.util.LifecycleBase.destroy(LifecycleBase.java:285)\n	at org.apache.catalina.core.StandardServer.destroyInternal(StandardServer.java:786)\n	at org.apache.catalina.util.LifecycleBase.destroy(LifecycleBase.java:285)\n	at org.apache.catalina.startup.Tomcat.destroy(Tomcat.java:323)\n	at su.msk.jet.nioproxy.rule.config.EmbeddedWebserver.stop(EmbeddedWebserver.java:26)\n\nI think that StandardContext.destroyInternal() misses check that this.getObjectName()!=null','2011-02-24 08:47:47','Maxim Valyanskiy','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','9d542ed','Mark Emlyn David Thomas','2011-02-24 12:25:38','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50826 Avoid IAE when Tomcat instance is destroyed without every being started. Add a test case for this.','java/org/apache/catalina/core/StandardContext.java\ntest/org/apache/catalina/startup/TestTomcat.java\nwebapps/docs/changelog.xml'),(970,50805,'Bug 50805 – Leak & Performance issue of getConnectionAsync()','','2011-02-17 23:11:36','Eiji Takahashi','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','98b26a5','Filip Hanik','2011-02-22 17:45:43','doco update bug 50805','modules/jdbc-pool/doc/changelog.xml'),(971,50805,'Bug 50805 – Leak & Performance issue of getConnectionAsync()','','2011-02-17 23:11:36','Eiji Takahashi','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','58b7355','Filip Hanik','2011-02-22 17:42:44','https://issues.apache.org/bugzilla/show_bug.cgi?id=50805 Make sure we only call borrowConnection once per connection per checkout','modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java\nmodules/jdbc-pool/test/org/apache/tomcat/jdbc/test/Bug50805.java'),(972,21669,'Bug 21669 – JNDIRealm roleBase pattern enahncement','Currently the roleBase attribute must be a fxed location in the directory. A \nsimple change would allow the role base to be specified relative to the user \nDN. My enhancement suggestion would change the roleBase definition as follows:\n\nroleBase - the base entry for the role search. If not specified, the search \nbase is the top level directory context. If specified it may optionally include \npattern replacements \"{0}\"..\"{n}\" corrosponding to the name parts of the user\'s \ndistinguished name (as returned by javax.naming.Name.get()).\n\nFor example, in the <Realm> defintion in server.xml you could specify the \nroleBase as:\n\n    roleBase=\"ou=Groups,{1},{0}\"\n\nThe majority of the code to accomplish this would be in JNDIRealm.getRoles() \nand could look like this:\n\n	String base = null;\n	if ( roleBaseFormat != null )\n	{\n		NameParser np = context.getNameParser(\"\");\n		Name name = np.parse(dn);\n		String nameParts[] = new String[name.size()];\n		for ( int idx = 0 ; idx < name.size() ; idx++ )\n			nameParts[idx] = name.get(idx);\n       	base = roleBaseFormat.format(nameParts);\n	}\n\n        // Perform the configured search and process the results\n        if (debug >= 3) {\n            log(\"  Searching role base \'\" + base + \"\' for attribute \'\" +\n                roleName + \"\'\");\n            log(\"  With filter expression \'\" + filter + \"\'\");\n        }\n        NamingEnumeration results =\n            context.search(base, filter, controls);\n\nThank You,\nArt','2003-07-16 22:59:24','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 4','Catalina','P3 enhancement','f22600c','Mark Emlyn David Thomas','2011-02-22 06:48:09','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=21669 Add the ability to specify the roleBase for the JNDI Realm as relative to the users DN. Based on a patch by Art W.','java/org/apache/catalina/realm/JNDIRealm.java\nwebapps/docs/changelog.xml\nwebapps/docs/config/realm.xml'),(973,19444,'Bug 19444 – JNDI Authentication roles must be anonymous accessible','It appears that for the JNDIRealm to be able to locate roles, they must be \nanonymous accessible. I believe that for security purposes this should not be \nnecessary if we are validating the user by binding to the directory. In that \ncase the roles could be accessible to any bound user or that particular user. I \ndiscussed this very briefly on the Tomcat user list. It sounds like this had \nbeen discussed previously and for whatever reason, the idea rejected. Anyhow I \nsubmit that there is a bug, either in the code - which requires the roles to be \nanonymous, or in the documentation which does not make it clear that this is \nthe case (at least in \"Tomcat 4 Servlet/JSP Container - Realm Configuration HOW-\nTO). It seems reasonable to me that if we are binding to the directory to \nauthenticate, we would have that user\'s access to roles. Perhaps the \ndocumentation should more explicetly state that this is not the case.\n\nIn the hope that it would be accepted as an enhancement, I am going to attempt \nto attach a modified JNDIRealm that uses the authenticated connection to obtain \nthe roles.\n\nThank You,\nArt','2003-04-29 21:58:13','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 4','Catalina','P3 enhancement','a085c4a','Mark Emlyn David Thomas','2011-02-22 06:08:42','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=19444 Add an option to the JNDI realm to allow role searches to be performed by the authenticated user.','java/org/apache/catalina/realm/JNDIRealm.java\nwebapps/docs/changelog.xml\nwebapps/docs/config/realm.xml'),(974,48863,'Bug 48863 – Log directory misconfiguration for class loaders','When developing our tomcat applications with eclipse, doing out-rebuild/sysdeo plugin and have the class files written into TOMCAT_HOME/common/classes is an effective approach.\n\nFor manageability reasons, we need to split our code among several eclipse projects. The problem is if both are configured to place their .class files in TOMCAT_HOME/common/classes that when one project rebuilds, it will wipe the class files of the other one.\n\nA great efficiency gain for the development of multiple projects therefore would be to be able to specify additional classes folders in server.xml to be added to the corresponding class-loader','2010-03-05 09:04:04','Ralf Hauser','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 enhancement','b387244','Mark Emlyn David Thomas','2011-02-21 11:23:05','Smarter solution for bug 48863','java/org/apache/catalina/startup/ClassLoaderFactory.java'),(975,48870,'Bug 48870 – avoid parallel arrays of base types','','2010-03-08 06:55:57','Ralf Hauser','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P4 enhancement','77e6902','Mark Emlyn David Thomas','2011-02-18 16:44:13','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48870 Re-factor to remove parallel arrays. Modify fix for 48863 to remove use of StringManager as it is not available in Bootstrap','build.xml\njava/org/apache/catalina/startup/Bootstrap.java\njava/org/apache/catalina/startup/ClassLoaderFactory.java\njava/org/apache/catalina/startup/LocalStrings.properties\nwebapps/docs/changelog.xml'),(976,48863,'Bug 48863 – Log directory misconfiguration for class loaders','When developing our tomcat applications with eclipse, doing out-rebuild/sysdeo plugin and have the class files written into TOMCAT_HOME/common/classes is an effective approach.\n\nFor manageability reasons, we need to split our code among several eclipse projects. The problem is if both are configured to place their .class files in TOMCAT_HOME/common/classes that when one project rebuilds, it will wipe the class files of the other one.\n\nA great efficiency gain for the development of multiple projects therefore would be to be able to specify additional classes folders in server.xml to be added to the corresponding class-loader','2010-03-05 09:04:04','Ralf Hauser','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 enhancement','77e6902','Mark Emlyn David Thomas','2011-02-18 16:44:13','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48870 Re-factor to remove parallel arrays. Modify fix for 48863 to remove use of StringManager as it is not available in Bootstrap','build.xml\njava/org/apache/catalina/startup/Bootstrap.java\njava/org/apache/catalina/startup/ClassLoaderFactory.java\njava/org/apache/catalina/startup/LocalStrings.properties\nwebapps/docs/changelog.xml'),(977,48863,'Bug 48863 – Log directory misconfiguration for class loaders','When developing our tomcat applications with eclipse, doing out-rebuild/sysdeo plugin and have the class files written into TOMCAT_HOME/common/classes is an effective approach.\n\nFor manageability reasons, we need to split our code among several eclipse projects. The problem is if both are configured to place their .class files in TOMCAT_HOME/common/classes that when one project rebuilds, it will wipe the class files of the other one.\n\nA great efficiency gain for the development of multiple projects therefore would be to be able to specify additional classes folders in server.xml to be added to the corresponding class-loader','2010-03-05 09:04:04','Ralf Hauser','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 enhancement','5ce6d78','Mark Emlyn David Thomas','2011-02-18 15:58:16','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48863 Better logging when specifying an invalid directory for a class loader. Based on a patch by Ralf Hauser.','java/org/apache/catalina/startup/ClassLoaderFactory.java\njava/org/apache/catalina/startup/LocalStrings.properties\nwebapps/docs/changelog.xml'),(978,50743,'Bug 50743 – Cache results to speed up Checkstyle #build','','2011-02-09 05:43:49','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Packaging','P2 enhancement','3879dbf','Mark Emlyn David Thomas','2011-02-18 11:53:08','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50743 Cache CheckStyle results between builds to speed up validation. Patch provided by Oliver.','build.xml\nres/checkstyle/checkstyle.xml\nres/checkstyle/javax-checkstyle.xml\nres/checkstyle/org-checkstyle.xml\nwebapps/docs/changelog.xml'),(979,50189,'Bug 50189 – AJP connector sends GET BODY CHUNK when reading after response closed','If a servlet (probably incorrectly) closes the writer/outputstream of a response, and then attempts to read from the request, the AJP connector sends GET BODY CHUNK to the mod_jk worker.\n\nThis then starts a series of very confusing communication between the worker and tomcat.  The worker doesn\'t read it until it makes its next request.  After making its next request, it reads it, and then sends a response with 0 length.  At the same time, Tomcat responds to the request made by the worker with another GET BODY CHUNK, which the worker also responds with a message of 0 length.  Then the really weird thing happens, Tomcat replays the first request made by that worker.  At this point, based on what I\'m looking at with tcpdump, I get too confused to work out exactly what is happening.','2010-10-31 23:27:02','James Roper','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Connector:AJP','P2 normal','514e713','Mark Emlyn David Thomas','2011-02-18 11:24:36','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50189 Once the application has finished writing to the response, prevent further reads from the request since this causes various problems in the connectors which do not expect this.','java/org/apache/catalina/connector/OutputBuffer.java\nwebapps/docs/changelog.xml'),(980,50802,'Bug 50802 – Deviation from servlet3 spec concerning resource lookup from META-INF/resources','','2011-02-17 13:20:33','Sander Sõnajalg','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','a9c3193','Mark Emlyn David Thomas','2011-02-17 15:38:49','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50802 Ensure that ServletContext.getResourcePaths() includes static resources packaged in JAR files in its output.','java/org/apache/naming/resources/BaseDirContext.java\njava/org/apache/naming/resources/FileDirContext.java\njava/org/apache/naming/resources/VirtualDirContext.java\njava/org/apache/naming/resources/WARDirContext.java\nwebapps/docs/changelog.xml'),(981,50780,'Bug 50780 – AjpConnectionHandler keeps many connections causing memory leak','Hi,\n\nSorry for my english.\n\nI use Tomcat 7.0.6 with APR 1.1.20. \n\nI noticed (from heap dump) many org.apache.tomcat.util.net.SocketWrapper objects, which are kept by \"connections\" atribute in org.apache.coyote.ajp.AjpAprProtocol$AjpConnectionHandler object. I don\'t understand, why there are so many objects representing old connections which are not active. In my example it was 300000 objects created, after 7 days of Tomcat work. Has someone forgotten to clean this HashMap from time to time?\n\nbest regards\n\nSergiusz Brzezinski','2011-02-15 04:51:49','Sergiusz','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 normal','b56bf50','Mark Emlyn David Thomas','2011-02-17 11:08:08','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50780 Fix memory leak in APR implementation of AJP connector introduced by the refactoring for bug 49884','java/org/apache/coyote/ajp/AjpAprProtocol.java\nwebapps/docs/changelog.xml'),(982,49884,'Bug 49884 – NullPointerException in org.apache.catalina.core.AsyncContextImpl.doInternalComplete','','2010-09-04 23:16:09','Kevin','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','b56bf50','Mark Emlyn David Thomas','2011-02-17 11:08:08','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50780 Fix memory leak in APR implementation of AJP connector introduced by the refactoring for bug 49884','java/org/apache/coyote/ajp/AjpAprProtocol.java\nwebapps/docs/changelog.xml'),(983,50789,'Bug 50789 – custom error pages and CDI/weld problem','','2011-02-15 12:09:28','Gilles Harloux','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','3810b04','Mark Emlyn David Thomas','2011-02-17 05:32:07','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50789 Provide an option to enable ServletRequestListeners for forwards as required by some CDI frameworks.','java/org/apache/catalina/Context.java\njava/org/apache/catalina/core/ApplicationDispatcher.java\njava/org/apache/catalina/core/StandardContext.java\nwebapps/docs/changelog.xml\nwebapps/docs/config/context.xml'),(984,50790,'Bug 50790 – EL parser needs to be more dynamic','String.containes(CharSequence) is not being resolved correctly in the following situation:\n\n<span class=\"#{(facesContext.externalContext.request.requestURI.contains(item.url)) ? \'activepage\' : \'\'}\">#{template[item.labelKey]}</span>\n\nException:\n\n\njavax.el.ELException: /faces/template/mainLayout.xhtml: java.lang.NoSuchMethodException: java.lang.String.contains(java.lang.String)\n	at com.sun.faces.facelets.compiler.AttributeInstruction.write(AttributeInstruction.java:87)\n	at com.sun.faces.facelets.compiler.UIInstructions.encodeBegin(UIInstructions.java:75)\n	at com.sun.faces.renderkit.html_basic.HtmlBasicRenderer.encodeRecursive(HtmlBasicRenderer.java:285)\n	at com.sun.faces.renderkit.html_basic.OutputLinkRenderer.encodeChildren(OutputLinkRenderer.java:125)\n	at javax.faces.component.UIComponentBase.encodeChildren(UIComponentBase.java:848)\n	at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1613)\n	at com.sun.faces.facelets.component.RepeatRenderer.encodeChildren(RepeatRenderer.java:97)\n	at com.sun.faces.facelets.component.UIRepeat.process(UIRepeat.java:496)\n	at com.sun.faces.facelets.component.UIRepeat.encodeChildren(UIRepeat.java:926)\n	at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1613)\n	at javax.faces.render.Renderer.encodeChildren(Renderer.java:168)\n	at javax.faces.component.UIComponentBase.encodeChildren(UIComponentBase.java:848)\n	at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1613)\n	at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1616)\n	at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1616)\n	at com.sun.faces.application.view.FaceletViewHandlingStrategy.renderView(FaceletViewHandlingStrategy.java:380)\n	at com.sun.faces.application.view.MultiViewHandler.renderView(MultiViewHandler.java:126)\n	at com.ocpsoft.pretty.faces.application.PrettyViewHandler.renderView(PrettyViewHandler.java:157)\n	at com.sun.faces.lifecycle.RenderResponsePhase.execute(RenderResponsePhase.java:127)\n	at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)\n	at com.sun.faces.lifecycle.LifecycleImpl.render(LifecycleImpl.java:139)\n	at javax.faces.webapp.FacesServlet.service(FacesServlet.java:313)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:306)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n	at com.reardeninc.tigris.ui.facesutil.FacesFilter.doFilter(FacesFilter.java:86)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:244)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n	at org.primefaces.webapp.filter.FileUploadFilter.doFilter(FileUploadFilter.java:79)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:244)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n	at com.ocpsoft.pretty.PrettyFilter.doFilter(PrettyFilter.java:100)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:244)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)\n	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:240)\n	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:161)\n	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:496)\n	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:164)\n	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:100)\n	at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:541)\n	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)\n	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:383)\n	at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:243)\n	at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:188)\n	at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:288)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n	at java.lang.Thread.run(Thread.java:680)\nCaused by: java.lang.NoSuchMethodException: java.lang.String.contains(java.lang.String)\n	at java.lang.Class.getMethod(Class.java:1605)\n	at javax.el.BeanELResolver.invoke(BeanELResolver.java:405)\n	at javax.el.CompositeELResolver.invoke(CompositeELResolver.java:161)\n	at org.apache.el.parser.AstValue.getValue(AstValue.java:159)\n	at org.apache.el.parser.AstChoice.getValue(AstChoice.java:45)\n	at org.apache.el.ValueExpressionImpl.getValue(ValueExpressionImpl.java:189)\n	at com.sun.faces.facelets.el.ELText$ELTextVariable.toString(ELText.java:207)\n	at com.sun.faces.facelets.compiler.AttributeInstruction.write(AttributeInstruction.java:82)\n	... 46 more','2011-02-15 15:04:47','Jason Porter','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 critical','cfab791','Mark Emlyn David Thomas','2011-02-17 04:59:30','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50790 Improve method resolution in EL expressions Add test cases for this bug','java/javax/el/BeanELResolver.java\njava/org/apache/el/parser/AstValue.java\ntest/org/apache/el/TestMethodExpressionImpl.java\nwebapps/docs/changelog.xml'),(985,50793,'Bug 50793 – Invalid DispatchType in ServletRequestListener on async dispatch','If a ServletRequestListener is defined, when is invoked after a call to AsyncContext#dispatch() the DispatcherType returned from the ServletRequest is REQUEST rather than ASYNC. When the actual servlet is invoked, the type is correctly set to ASYNC.\n\nIf the listener is intended to be invoked for each dispatch, then the DispatcherType should match the value returned in the filter/servlet.','2011-02-15 22:47:30','Jeremy Boynes','Tomcat Developers Mailing List','CLOSED FIXED','Tomcat 7','Catalina','P2 normal','72418ba','Mark Emlyn David Thomas','2011-02-16 12:35:24','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50793 Correctly fire request init/destroy events for astnc requests','java/org/apache/catalina/connector/CoyoteAdapter.java\njava/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/core/StandardContextValve.java\ntest/org/apache/catalina/core/TestAsyncContextImpl.java\nwebapps/docs/changelog.xml'),(986,50713,'Bug 50713 – The \"roles\" command doesn\'t work','','2011-02-03 02:38:46','Eiji Takahashi','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Manager','P2 minor','4b21973','Mark Emlyn David Thomas','2011-02-16 08:43:39','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50713 Remove roles command from Manager application','java/org/apache/catalina/ant/RolesTask.java\njava/org/apache/catalina/ant/antlib.xml\njava/org/apache/catalina/ant/catalina.tasks\njava/org/apache/catalina/manager/LocalStrings.properties\njava/org/apache/catalina/manager/LocalStrings_de.properties\njava/org/apache/catalina/manager/LocalStrings_es.properties\njava/org/apache/catalina/manager/LocalStrings_fr.properties\njava/org/apache/catalina/manager/LocalStrings_ja.properties\njava/org/apache/catalina/manager/ManagerServlet.java\nwebapps/docs/changelog.xml\nwebapps/docs/html-manager-howto.xml\nwebapps/docs/manager-howto.xml\nwebapps/manager/WEB-INF/web.xml'),(987,50700,'Bug 50700 – Context parameters are being overridden with parameters from the web application deployment descriptor','Context parameters are being overridden with parameters from the web application deployment descriptor even through \"override\" attribute is set to \"false\"\n\nFor example:\nlines from context file\n<Context path=\"/path\" docBase=\"/path/to/docbase\" cookies=\"true\">\n    <Parameter name=\"parameter_name\" value=\"test1\" override=\"false\"/>\n....\n</Context>\n\nlines from web.xml\n    <context-param>\n        <description>default value for parameter_name</description>\n        <param-name>parameter_name</param-name>\n        <param-value>test2</param-value>\n    </context-param>\n\nNow servletContext.getInitParameter(\"parameter_name\") returns \"test2\"','2011-02-01 13:04:17','Sergey','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','a073ac8','Mark Emlyn David Thomas','2011-02-14 14:05:25','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50700 Ensure that the override attribute of context parameters is correctly followed.','java/org/apache/catalina/core/StandardContext.java\nwebapps/docs/changelog.xml'),(988,50771,'Bug 50771 – HttpServletRequest#getAuthType() returns null though the request is authenticated.','','2011-02-14 03:30:02','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina:Cluster','P2 normal','877a3df','Keiichi Fujino','2011-02-14 03:47:49','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50771 Ensure HttpServletRequest#getAuthType() returns the name of the authentication scheme if request has already been authenticated.','java/org/apache/catalina/ha/session/DeltaRequest.java\njava/org/apache/catalina/ha/session/DeltaSession.java\nwebapps/docs/changelog.xml'),(989,50726,'Bug 50726 – Jasper can generate uncompilable source code if genStringAsCharArray is turned on','Our jsp pages are compiled at build time. If I turn on genStringAsCharArray optimization switch, in some cases there will be longer lines in the generated java code than the javac compiler can process. It provides the following error message:\n\n[javac] Compiling 1609 source files to d:\\...\\jspc\\classes\n[javac] d:\\...\\jspc\\src\\org\\apache\\jsp\\WEB_002dINF\\..._005fAPP\\pages\\termsconditions\\TermsAndConditions_005fms_005fMY_jsp.java:96: constant string too long','2011-02-07 08:14:03','Róbert István','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','d0f3899','Mark Emlyn David Thomas','2011-02-12 14:35:26','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50726 Ensure that the use of the genStringAsCharArray does not result in String constants that are too long for valid Java code.','java/org/apache/jasper/compiler/Generator.java\nwebapps/docs/changelog.xml'),(990,50759,'Bug 50759 – ValidatorClassName Validation fails to set lastValidated timestamp','','2011-02-10 19:12:21','Dominic Tootell','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','50f16fe','Filip Hanik','2011-02-11 11:32:41','https://issues.apache.org/bugzilla/show_bug.cgi?id=50759 Update validation timestamp if using an external validator.','modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/PooledConnection.java'),(991,50737,'Bug 50737 – Error on .war deploy - archive malformed (on recent Tomcat releases) on IBM iSeries System i','On Tomcat 6.0.20 a .war file can be deployed just fine on an IBM iSeries (System i) at V6R1 of the OS.\n\nAfter installing Tomcat 6.0.29 (and 6.0.30 and 6.0.32), .war files no longer deploy.  See the stack trace at the bottom of this post.\n\nOn a Windows/7 machine this error does not occur with these Tomcat releases.  On OS400 (i5/OS) this does not happen at 6.0.20.  This error only occurs on the iSeries at Tomcat version 6.0.29+ (it may have started to occur between 6.0.20 and 6.0.29).  Note that it is the same .war file that is being deployed to each of these environments.\n\n              ---- Tomcat ----\n              6.0.20    6.0.32\n            +--------+---------+\nIBM iSeries |  OK    |  ERROR  |\n            +--------+---------|\nWindows/7   |  OK    |   OK    |\n            +------------------+\n\nIn troubleshooting, to make sure this is not an installation/configuration error the Tomcat 6.0.20 zip file was downloaded from the Apache site and re-installed on the iSeries.  The deploy works as before.  At 6.0.29, 6.0.30, and 6.0.32, the deploy produces the following error:\n\n\nFeb 8, 2011 2:52:07 PM org.apache.juli.logging.DirectJDKLog error\nSEVERE: ContainerBase.addChild: start: \nLifecycleException:  Error initializaing :  java.lang.IllegalArgumentException: The archive [jar:file:/apache/apache-tomcat-6.0.32/webapps/shopatron.war!/] is malformed and will be ignored: an entry contains an illegal path [META-INF/]\n	at java.lang.Throwable.<init>(Throwable.java:181)\n	at java.lang.Exception.<init>(Exception.java:29)\n	at org.apache.catalina.LifecycleException.<init>(LifecycleException.java:80)\n	at org.apache.catalina.core.StandardContext.start(StandardContext.java:4450)\n	at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:799)\n	at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:779)\n	at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:601)\n	at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:943)\n	at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:563)\n	at org.apache.catalina.startup.HostConfig.check(HostConfig.java:1397)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n	at java.lang.reflect.Method.invoke(Method.java:575)\n	at org.apache.tomcat.util.modeler.BaseModelMBean.invoke(BaseModelMBean.java:297)\n	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:836)\n	at com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:761)\n	at org.apache.catalina.manager.ManagerServlet.check(ManagerServlet.java:1500)\n	at org.apache.catalina.manager.HTMLManagerServlet.doPost(HTMLManagerServlet.java:252)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n	at org.apache.catalina.filters.CsrfPreventionFilter.doFilter(CsrfPreventionFilter.java:186)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)\n	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)\n	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:563)\n	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)\n	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)\n	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:298)\n	at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:859)\n	at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:588)\n	at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)\n	at java.lang.Thread.run(Thread.java:619)\nFeb 8, 2011 2:52:07 PM org.apache.juli.logging.DirectJDKLog error\nSEVERE: Error deploying web application archive shopatron.war\njava.lang.IllegalStateException: ContainerBase.addChild: start: LifecycleException:  Error initializaing :  java.lang.IllegalArgumentException: The archive [jar:file:/apache/apache-tomcat-6.0.32/webapps/shopatron.war!/] is malformed and will be ignored: an entry contains an illegal path [META-INF/]\n	at java.lang.Throwable.<init>(Throwable.java:196)\n	at java.lang.Exception.<init>(Exception.java:41)\n	at java.lang.RuntimeException.<init>(RuntimeException.java:43)\n	at java.lang.IllegalStateException.<init>(IllegalStateException.java:38)\n	at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:803)\n	at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:779)\n	at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:601)\n	at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:943)\n	at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:563)\n	at org.apache.catalina.startup.HostConfig.check(HostConfig.java:1397)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n	at java.lang.reflect.Method.invoke(Method.java:575)\n	at org.apache.tomcat.util.modeler.BaseModelMBean.invoke(BaseModelMBean.java:297)\n	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:836)\n	at com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:761)\n	at org.apache.catalina.manager.ManagerServlet.check(ManagerServlet.java:1500)\n	at org.apache.catalina.manager.HTMLManagerServlet.doPost(HTMLManagerServlet.java:252)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n	at org.apache.catalina.filters.CsrfPreventionFilter.doFilter(CsrfPreventionFilter.java:186)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)\n	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)\n	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:563)\n	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)\n	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)\n	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:298)\n	at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:859)\n	at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:588)\n	at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)\n	at java.lang.Thread.run(Thread.java:619)\n\n=====\n\nLet me know if I can do anything to help support this fix.\n- Jon','2011-02-08 17:59:01','Jon E.','Tomcat Developers Mailing List','RESOLVED INVALID','Tomcat 6','Catalina','P2 normal','fdea998','Mark Emlyn David Thomas','2011-02-11 10:21:54','Add additional information to assist with tracking down the root cause of https://issues.apache.org/bugzilla/show_bug.cgi?id=50737','java/org/apache/catalina/startup/ExpandWar.java\njava/org/apache/catalina/startup/LocalStrings.properties\nwebapps/docs/changelog.xml'),(992,50751,'Bug 50751 – JNDIRealm invokes getAttributes with no attribute ids. Prevents using DOMAIN\\{0} to login.','','2011-02-10 12:11:43','Brandon DuRette','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 minor','0313ded','Mark Emlyn David Thomas','2011-02-11 09:49:41','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50751 Don\'t try to retrieve attributes if we don\'t need to. If anonymous bind is not allowed, the login will always fail.','java/org/apache/catalina/realm/JNDIRealm.java\nwebapps/docs/changelog.xml'),(993,50752,'Bug 50752 – Typo in Embedded.java log message','There\'s a debug log message in Embedded.java with a typo in it:\n\n\"INITIAL_CONTEXT_FACTORY alread set \"\n\n\nAttached is a patch against the 6_0_29 tag, but the issue exists in tc6.0.x/trunk','2011-02-10 12:17:31','Brandon DuRette','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 trivial','272e30c','Mark Emlyn David Thomas','2011-02-11 07:24:47','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50752 Correct typo','java/org/apache/catalina/startup/Embedded.java\nwebapps/docs/changelog.xml'),(994,50753,'Bug 50753 – Asynchronous responses do not contain set response headers','Using a servlet with asynchronous support enabled and the response headers set just before AsyncContext.complete() method is called fails to send the headers over the wire. More precisely if the headers are set on the HttpServletRequest on a different thread than the request thread the headers are not sent. \n\nA simple test was devised to showcase the issue.\n\nSetting the headers on the request thread before or after the AsyncContext is acquired *succeeds* in sending the headers over the wire: \n\n    protected void doGet(HttpServletRequest request, final HttpServletResponse r) throws ServletException, IOException { \n       final AsyncContext ctx = request.startAsync(); \n        r.setHeader(\"A\", \"xyz\"); \n        r.setContentType(\"text/plain\"); \n        r.setContentLength(\"------\".getBytes().length); \n        r.getWriter().print(\"------\"); \n        ctx.start(new Runnable() { \n            public void run() { \n                try { \n                    Thread.sleep(5000); \n                    ctx.complete(); \n                } catch (Exception e) { \n                    e.printStackTrace();\n                } \n            } \n        }); \n    } \n\nSetting the headers just before the response is sent *does not succeed* in actually sending the headers over the wire: \n\n    protected void doGet(HttpServletRequest request, final HttpServletResponse r) throws ServletException, IOException { \n       final AsyncContext ctx = request.startAsync(); \n        ctx.start(new Runnable() { \n            public void run() { \n                try { \n                    Thread.sleep(5000); \n                    r.setHeader(\"A\", \"xyz\"); \n                    r.setContentType(\"text/plain\"); \n                    r.setContentLength(\"------\".getBytes().length); \n                    r.getWriter().print(\"------\"); \n                    ctx.complete(); \n                } catch (Exception e) { \n                    e.printStackTrace();\n                } \n            } \n        }); \n    }','2011-02-10 12:46:55','Mircea Toma','Tomcat Developers Mailing List','RESOLVED WORKSFORME','Tomcat 7','Catalina','P2 normal','e584cfe','Mark Emlyn David Thomas','2011-02-10 14:42:34','Add a test case (already passes) for bug50753','test/org/apache/catalina/core/TestAsyncContextImpl.java'),(995,50720,'Bug 50720 – When using jsp mapped as servlet in web.xml, cyrillic characters are not allowed in web.xml','','2011-02-04 09:07:57','Ruslan','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','e4bc803','Mark Emlyn David Thomas','2011-02-10 13:59:43','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50720 Ensure that the use of non-ISO-8859-1 character sets for web.xml does not trigger an error when Jasper parses the web.xml file.','java/org/apache/jasper/compiler/WebXml.java\nwebapps/docs/changelog.xml'),(996,50721,'Bug 50721 – RequestUtil.URLDecode() throws IllegalArgumentException for URLs with %xx-Code as last character','','2011-02-04 20:42:49','Christof Marti','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','5c9e352','Mark Emlyn David Thomas','2011-02-09 18:41:32','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50721 Correctly handle URL decoding where the URL ends in %nn. Patch (for fix) provided by Christof Marti. Additional test cases added.','java/org/apache/catalina/util/RequestUtil.java\ntest/org/apache/catalina/util/TestRequestUtil.java\nwebapps/docs/changelog.xml'),(997,50747,'Bug 50747 – CometProcessor does not flush and close HTTP/1.0 requests','','2011-02-09 14:16:29','Frank Schroeder','Tomcat Developers Mailing List','','Tomcat 7','Catalina','P2 normal','8520d2d','Mark Emlyn David Thomas','2011-02-09 16:56:14','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50747 Allow the content length header to be set up to the point the response is committed when a writer is used.','java/org/apache/catalina/connector/Response.java\nwebapps/docs/changelog.xml'),(998,50667,'Bug 50667 – Tribes | RpcChannel | Add a callback for cases when an error occured sending a reply to an RP call','The RpcChannel API user registers an RpcCallback to be notified of\ncommunication events. However, there is no callback method for the case where\nthe sending of a response message fails. This entry proposes the addition of a callback method for such cases.\n\nCAVEAT: this proposal modifies the RpcCallback interface. RpcCallback is currently implemented by at least four tomcat classes, EchoRpcTest in org.apache.catalina.tribes.demos, and AbstractReplicatedMap, ReplicatedMap ad LazyReplicatedMap in org.apache.catalina.tribes.tipis. The attached patch does not include the implementation of the additional interface method for those classes, as this coder did not feel qualified to tell how it should be implemented. They could probably simply be NOOPs, however.','2011-01-27 06:55:29','Olivier Costet','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Cluster','P2 enhancement','271c99e','Filip Hanik','2011-02-09 12:39:24','https://issues.apache.org/bugzilla/show_bug.cgi?id=50667 Move the callback outside try/catch to avoid duplicate callbacks','java/org/apache/catalina/tribes/group/RpcChannel.java'),(999,50667,'Bug 50667 – Tribes | RpcChannel | Add a callback for cases when an error occured sending a reply to an RP call','The RpcChannel API user registers an RpcCallback to be notified of\ncommunication events. However, there is no callback method for the case where\nthe sending of a response message fails. This entry proposes the addition of a callback method for such cases.\n\nCAVEAT: this proposal modifies the RpcCallback interface. RpcCallback is currently implemented by at least four tomcat classes, EchoRpcTest in org.apache.catalina.tribes.demos, and AbstractReplicatedMap, ReplicatedMap ad LazyReplicatedMap in org.apache.catalina.tribes.tipis. The attached patch does not include the implementation of the additional interface method for those classes, as this coder did not feel qualified to tell how it should be implemented. They could probably simply be NOOPs, however.','2011-01-27 06:55:29','Olivier Costet','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Cluster','P2 enhancement','80020a1','Filip Hanik','2011-02-08 15:18:19','https://issues.apache.org/bugzilla/show_bug.cgi?id=50667 Allow a replier to get confirmation if the reply message was sent successfully or if it failed','java/org/apache/catalina/tribes/group/ExtendedRpcCallback.java\njava/org/apache/catalina/tribes/group/RpcChannel.java'),(1000,50709,'Bug 50709 – Make class org.apache.catalina.core.ApplicationContextFacade non-final','Please make class org.apache.catalina.core.ApplicationContextFacade non-final so it can be subclassed.\nNeed to extend ApplicationContextFacade so Mobicents Sip Servlet, working on top of Tomcat 7, to integrate with Weld.\n\nThanks\nGeorge','2011-02-02 13:11:45','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','9f41c91','Mark Emlyn David Thomas','2011-02-04 05:30:36','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50709 Make ApplicationContextFacade non-final to enable extension.','java/org/apache/catalina/core/ApplicationContextFacade.java\nwebapps/docs/changelog.xml'),(1001,50673,'Bug 50673 – Error when stopping Tomcat using services.msc','When stopping Tomcat using services.msc, an error message is displayed: \"Windows could not stop the Apache Tomcat 7 service on Local Computer. Error 109: The pipe has been ended.\"\n\nDespite this error, Tomcat appears to stop normally.\n\nNo such problem was encountered in 6.0.29.','2011-01-27 10:09:50','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','6ac4a27','Konstantin Kolinko','2011-02-01 21:45:46','Fix http://issues.apache.org/bugzilla/show_bug.cgi?id=50673 Improve Catalina shutdown when running as a service. Do not call System.exit().','java/org/apache/catalina/core/StandardServer.java\njava/org/apache/catalina/startup/Catalina.java\nwebapps/docs/changelog.xml'),(1002,50631,'Bug 50631 – InternalNioInputBuffer should honor maxHttpHeadSize','InternalNioInputBuffer automatically expands its buffer while reading in request line, effectively ignoring the maxHttpHeaderSize setting.','2011-01-21 13:23:52','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 normal','0084470','Konstantin Kolinko','2011-02-01 02:55:45','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50631 InternalNioInputBuffer should honor maxHttpHeadSize This addresses CVE-2011-0534','java/org/apache/coyote/http11/InternalNioInputBuffer.java\nwebapps/docs/changelog.xml'),(1003,50325,'Bug 50325 – Update Tomcat to use JRE provided solutions for CVE-2009-3555 if available','','2010-11-24 05:38:15','Mark Thomas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Connector:HTTP','P2 enhancement','b4e9488','Mark Emlyn David Thomas','2011-01-31 18:43:38','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50325 Use JVM provided solutions to CVE-2009-3555 if available (i.e. RFC 5746 support)','java/org/apache/tomcat/util/net/jsse/JSSESocketFactory.java\nwebapps/docs/changelog.xml\nwebapps/docs/config/http.xml'),(1004,50683,'Bug 50683 – Servlet 3.0 annotations not scanned if unpackWars=\"false\"','','2011-01-28 18:36:29','kristof batizy','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','d21437e','Mark Emlyn David Thomas','2011-01-28 19:15:34','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50683 Scan annotations when unpackWars=false','java/org/apache/naming/resources/WARDirContext.java\nwebapps/docs/changelog.xml'),(1005,49978,'Bug 49978 – WebappLoader throws exception if workDir already exists (when unpackWARs=false)','In WebappLoader.setRepositories(), if the war is not unpacked, it tries to create a directory /WEB-INF/classes inside the workDir.  If that directory already exists, an error is thrown and the webapp does not start.\n\nThis is a change from 5.5, which didn\'t check the return value of classRepository.mkdirs().  mkdirs() returns false if the directories already exist.  I doubt it was the intention here.  Probably the intention was to throw an exception if the directory could not be created, rather than if it already existed.','2010-09-22 14:11:28','Jim Frederic','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','e657ea0','Mark Emlyn David Thomas','2011-01-28 19:00:50','Re-fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49978 Pre-existing dir should not break deployment','java/org/apache/catalina/loader/WebappLoader.java\nwebapps/docs/changelog.xml'),(1006,46819,'Bug 46819 – Remove redundant object instantiations in JspRuntimeLibrary','','2009-03-07 23:30:10','Anthony Whitford','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 enhancement','20ace41','Mark Emlyn David Thomas','2011-01-28 18:24:23','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46819 Remove redundant object instantiations in JspRuntimeLibrary. Patch provided by Anthony Whitford.','java/org/apache/jasper/runtime/JspRuntimeLibrary.java\nwebapps/docs/changelog.xml'),(1007,50680,'Bug 50680 – NPE in TagFileProcessor when tag file is in an expanded directory \"jar\"','','2011-01-28 09:03:07','Larry Isaacs','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','af4549f','Mark Emlyn David Thomas','2011-01-28 16:21:02','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50680 Prevent an NPE when using tag files from an exploded JAR file, e.g. from within an IDE. Patch provided by Larry Isaacs.','java/org/apache/jasper/compiler/TagFileProcessor.java\nwebapps/docs/changelog.xml'),(1008,50679,'Bug 50679 – FarmDeployer doesn\'t support parallel deployment','Version: Tomcat 7.0.6\nComponent: Catalina\nOS: Windows 7 64bit\n\nOverview:\n\nParallel deployment works like a charm in a non-clustered environment. But when deploying a versioned app (APPNAME##VERSION.war) to a farm deployer directory, it seems that the filename encoding of the ## delimiter is not translated correctly to identify the war file on the file system:\n\n## is translated to %23%23\n\nReproduce:\n\n1. Create a version app file\n2. Deploy file to watched farm deployer directory\n\nExpected result:\n- Versioned app is copyied to cluster members and deployed\n\nActual result:\n- Versioned app is NOT copyied to cluster members.\n\ncatalina.log displays the following error messages:\n\n\n[ContainerBackgroundProcessor[StandardEngine[Catalina]]] INFO  org.apache.catalina.ha.deploy.FarmWarDeployer- Installing webapp[/Shop##201101261] from C:\\Apache\\Tomcat7\\cluster\\webapps\\Shop##201101261.war\n\n[ContainerBackgroundProcessor[StandardEngine[Catalina]]] INFO  org.apache.catalina.ha.deploy.FarmWarDeployer- Cluster wide remove of web app /Shop##201101261\n\n[ContainerBackgroundProcessor[StandardEngine[Catalina]]] ERROR org.apache.catalina.ha.deploy.FarmWarDeployer- Unable to install WAR file\njava.io.FileNotFoundException: C:\\Apache\\Tomcat7\\cluster\\webapps\\Shop%23%23201101261.war (Das System kann die angegebene Datei nicht finden)\n        at java.io.FileInputStream.open(Native Method)\n        at java.io.FileInputStream.<init>(FileInputStream.java:106)\n        at org.apache.catalina.ha.deploy.FileMessageFactory.<init>(FileMessageFactory.java:152)\n        at org.apache.catalina.ha.deploy.FileMessageFactory.getInstance(FileMessageFactory.java:175)\n        at org.apache.catalina.ha.deploy.FarmWarDeployer.install(FarmWarDeployer.java:372)\n        at org.apache.catalina.ha.deploy.FarmWarDeployer.fileModified(FarmWarDeployer.java:468)\n        at org.apache.catalina.ha.deploy.WarWatcher.check(WarWatcher.java:95)\n        at org.apache.catalina.ha.deploy.FarmWarDeployer.backgroundProcess(FarmWarDeployer.java:591)\n        at org.apache.catalina.ha.tcp.SimpleTcpCluster.backgroundProcess(SimpleTcpCluster.java:627)\n        at org.apache.catalina.core.ContainerBase.backgroundProcess(ContainerBase.java:1200)\n        at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1393)\n        at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1403)\n        at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.run(ContainerBase.java:1382)\n        at java.lang.Thread.run(Thread.java:662)\n\n[ContainerBackgroundProcessor[StandardEngine[Catalina]]] INFO  org.apache.catalina.startup.HostConfig- Deploying web application archive Shop##201101261.war\n\nRelevant configuration in server.xml:\n\n...\n      <Host name=\"sbwebapp1\" appBase=\"${catalina.base}/cluster/webapps\"\n            unpackWARs=\"true\" autoDeploy=\"true\">\n\n	     <Cluster className=\"org.apache.catalina.ha.tcp.SimpleTcpCluster\"\n	               channelSendOptions=\"8\">\n	\n	        <Manager className=\"org.apache.catalina.ha.session.DeltaManager\"\n	                 expireSessionsOnShutdown=\"true\"\n	                 notifyListenersOnReplication=\"false\"\n									 stateTransferTimeout=\"5\"/>\n	\n	        <Channel className=\"org.apache.catalina.tribes.group.GroupChannel\">\n	          <Membership className=\"org.apache.catalina.tribes.membership.McastService\"\n	                      address=\"228.0.0.4\"\n	                      port=\"45564\"\n	                      frequency=\"500\"\n	                      dropTime=\"3000\"/>\n	          <Receiver className=\"org.apache.catalina.tribes.transport.nio.NioReceiver\"\n	                    address=\"192.168.222.220\"\n	                    port=\"4000\"\n	                    autoBind=\"100\"\n	                    selectorTimeout=\"5000\"\n	                    maxThreads=\"6\"/>\n	\n	          <Sender className=\"org.apache.catalina.tribes.transport.ReplicationTransmitter\">\n	            <Transport className=\"org.apache.catalina.tribes.transport.nio.PooledParallelSender\"/>\n	          </Sender>\n	          <Interceptor className=\"org.apache.catalina.tribes.group.interceptors.TcpFailureDetector\"/>\n	          <Interceptor className=\"org.apache.catalina.tribes.group.interceptors.MessageDispatch15Interceptor\"/>\n	          <Interceptor className=\"org.apache.catalina.tribes.group.interceptors.ThroughputInterceptor\"/>\n	        </Channel>\n	\n	        <Valve className=\"org.apache.catalina.ha.tcp.ReplicationValve\"\n	                 filter=\".*\\.gif;.*\\.js;.*\\.jpg;.*\\.png;.*\\.htm;.*\\.html;.*\\.css;.*\\.txt;.*\\.swf;.*\\.flv;\"/>\n	        <Valve className=\"org.apache.catalina.ha.session.JvmRouteBinderValve\"/>	        \n	\n	        <ClusterListener className=\"org.apache.catalina.ha.session.JvmRouteSessionIDBinderListener\"/>\n	        <ClusterListener className=\"org.apache.catalina.ha.session.ClusterSessionListener\"/>\n	        \n	        <Deployer className=\"org.apache.catalina.ha.deploy.FarmWarDeployer\"\n	                  tempDir=\"${catalina.base}/cluster/temp/\"\n	                  deployDir=\"${catalina.base}/cluster/webapps/\"\n	                  watchDir=\"${catalina.base}/cluster/deploy/\"\n	                  watchEnabled=\"true\"/>        \n	      </Cluster>\n\n        <!-- Access log processes all example.\n             Documentation at: /docs/config/valve.html\n             Note: The pattern used is equivalent to using pattern=\"common\" -->\n        <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"  \n               prefix=\"ajp_access_\" suffix=\".log\"\n               pattern=\"%h %l %u %t &quot;%r&quot; %s %b\" resolveHosts=\"false\"/>             \n\n      </Host>\n...','2011-01-28 03:22:33','Jan Rusch','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','2377f51','Mark Emlyn David Thomas','2011-01-28 16:04:55','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50679 Update the FarmWarDeployer to support parallel deployment. This deliberately breaks the API since the meaning of a number of method parameters has changed (context path -> context name).','java/org/apache/catalina/ha/ClusterDeployer.java\njava/org/apache/catalina/ha/deploy/FarmWarDeployer.java\njava/org/apache/catalina/ha/deploy/FileMessage.java\njava/org/apache/catalina/ha/deploy/FileMessageFactory.java\njava/org/apache/catalina/ha/deploy/UndeployMessage.java\nwebapps/docs/changelog.xml'),(1009,50642,'Bug 50642 – keepAliveProtection doesn\'t work','','2011-01-24 10:45:14','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','5c13d8c','Mark Emlyn David Thomas','2011-01-28 08:03:57','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50642 Better fix for HttpClient keep-alive thread triggered memory leaks','java/org/apache/catalina/core/JreMemoryLeakPreventionListener.java\njava/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/loader/LocalStrings.properties\njava/org/apache/catalina/loader/WebappClassLoader.java\njava/org/apache/catalina/loader/WebappLoader.java\nwebapps/docs/changelog.xml\nwebapps/docs/config/context.xml\nwebapps/docs/config/listeners.xml'),(1010,50646,'Bug 50646 – Tribes ByteMessage will get corrupted if message size exceeds the underlying buffer size','The Tribes ByteMessage class is used to transfer byte payloads in the context of the tribes communication framework.\n\nDue to how the message is deserialized, there will be data loss (and hence corruption) if the message size exceeds the underlying buffer size.\n\nThe solution is to replace an ObjectInput#read(byte[]) call by ObjectInput#readFully(byte[]).\n\nFix is attached.','2011-01-25 07:08:10','Olivier Costet','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Cluster','P2 major','0119483','Mark Emlyn David Thomas','2011-01-26 13:28:31','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50646 Ensure larger Tribes messages are fully read. Patch provided by Olivier Costet.','java/org/apache/catalina/tribes/ByteMessage.java\nwebapps/docs/changelog.xml'),(1011,50648,'Bug 50648 – RpcChannel improvements','','2011-01-25 09:38:16','Olivier Costet','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Cluster','P2 enhancement','6336b45','Mark Emlyn David Thomas','2011-01-26 11:53:23','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50648 Correctly set the interrupt status if a thread using RpcChannel is interrupted waiting for a message reply. Based on a patch by Olivier Costet.','java/org/apache/catalina/tribes/group/RpcChannel.java\nwebapps/docs/changelog.xml'),(1012,49711,'Bug 49711 – HttpServletRequest#getParts() does not work in a Filter','In order to have the ability to process multipart/form-data transparently with help of the new Servlet 3.0 HttpServletRequest#getParts(), a Filter is the most suitable place for this. \n\nThis works fine in Glassfish v3. However, in Tomcat the getParts() returns null and it works only inside a servlet with @MultipartConfig annotation.\n\nThis is too strict. This makes it hard if not impossible to process multipart/form-data requests transparently with help of a Filter (i.e. creating a new parametermap and replacing the original one in HttpServletRequest).\n\nIt is true that the Servlet 3.0 spec tells nothing about the use of this method inside a Filter, but this is in my opinion an oversight. There is no other way to obtain the parts than parsing the stream yourself with good \'ol Apache Commons FileUpload.\n\nSince it works fine in Glassfish v3, I\'d suggest to make Tomcat 7 that lenient as well.','2010-08-05 16:39:53','balusc','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 enhancement','f69c178','Christopher Schultz','2011-01-21 13:32:39','Re-fixed bug #49711: HttpServletRequest#getParts() does not work in a Filter - Moved allowCasualMultipartParsing setting from <Connector> to <Context>','java/org/apache/catalina/Context.java\njava/org/apache/catalina/connector/Connector.java\njava/org/apache/catalina/connector/Request.java\njava/org/apache/catalina/core/StandardContext.java\ntest/org/apache/catalina/connector/TestRequest.java\ntest/org/apache/catalina/core/TestStandardContext.java\nwebapps/docs/changelog.xml\nwebapps/docs/config/ajp.xml\nwebapps/docs/config/context.xml\nwebapps/docs/config/http.xml'),(1013,49711,'Bug 49711 – HttpServletRequest#getParts() does not work in a Filter','In order to have the ability to process multipart/form-data transparently with help of the new Servlet 3.0 HttpServletRequest#getParts(), a Filter is the most suitable place for this. \n\nThis works fine in Glassfish v3. However, in Tomcat the getParts() returns null and it works only inside a servlet with @MultipartConfig annotation.\n\nThis is too strict. This makes it hard if not impossible to process multipart/form-data requests transparently with help of a Filter (i.e. creating a new parametermap and replacing the original one in HttpServletRequest).\n\nIt is true that the Servlet 3.0 spec tells nothing about the use of this method inside a Filter, but this is in my opinion an oversight. There is no other way to obtain the parts than parsing the stream yourself with good \'ol Apache Commons FileUpload.\n\nSince it works fine in Glassfish v3, I\'d suggest to make Tomcat 7 that lenient as well.','2010-08-05 16:39:53','balusc','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 enhancement','6a69e81','Christopher Schultz','2011-01-21 12:46:03','Fixed bug #49711: HttpServletRequest#getParts() does not work in a Filter - Added <Connector> attribute allowCasualMultipartParsing (default false) - Requests that contain multipart/form-data will be parsed in the absence of @MultipartConfig when the above attribute is set to \"true\"','java/org/apache/catalina/ant/AbstractCatalinaTask.java\njava/org/apache/catalina/connector/Connector.java\njava/org/apache/catalina/connector/Request.java\njava/org/apache/tomcat/util/net/AprEndpoint.java\ntest/org/apache/catalina/connector/TestRequest.java\nwebapps/docs/changelog.xml\nwebapps/docs/config/ajp.xml\nwebapps/docs/config/http.xml'),(1014,50629,'Bug 50629 – Make the bindThread/unbindThread method protected','In the latest Tomcat codes, I saw that a new thread is created for listener start, filter start and loadOnStartup. But the two methods bindThread and unbindThread is marked as private, how about making those methods protected ? So that other containers could use those two methods for their own initialization works.\nThanks.','2011-01-21 07:23:54','Ivan','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','3898ed0','Mark Emlyn David Thomas','2011-01-21 08:17:12','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50629 Make StandardContext.bindThread() and StandardContext.unbindThread() protected to allow use by sub-classes.','java/org/apache/catalina/core/StandardContext.java\nwebapps/docs/changelog.xml'),(1015,50441,'Bug 50441 – It is not possible to have multiple instacnes of same docBase inside appBase','','2010-12-09 05:18:13','Ognjen Milic','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 enhancement','3fa7607','Mark Emlyn David Thomas','2011-01-20 15:43:12','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50441 Clarify when docBase can be set','webapps/docs/changelog.xml\nwebapps/docs/config/context.xml'),(1016,50526,'Bug 50526 – Clarify that JavaMail Session JNDI resource factory can accept any configuration attribute from JavaMail','From the examples currently shown in jndi-resources-howto.html, one might assume that adding \"foo.bar.baz\" will be added to the java.util.Properties object passed-into the Session.getInstance method, but it is not entirely clear.\n\nIt would be nice to explicitly state that arbitrary <Resource> attributes will be converted into Session configuration properties.\n\nAlso, there are certain properties that are outside of the JavaMail spec, such as \"password\".','2010-12-28 22:42:38','Christopher Schultz','Tomcat Developers Mailing List','CLOSED FIXED','Tomcat 7','Documentation','P2 enhancement','6478f07','Mark Emlyn David Thomas','2011-01-20 14:05:38','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50526 Additional JavaMail docs','webapps/docs/changelog.xml\nwebapps/docs/jndi-resources-howto.xml'),(1017,50620,'Bug 50620 – Session related errors prevent clean recycle of Request and Response objects by CoyoteAdapter','','2011-01-19 15:54:38','vamsavardhana reddy','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 major','fbd0110','Mark Emlyn David Thomas','2011-01-20 13:34:18','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50620 Exceptions calling session.endAccess should not prevent recycle() from completing normally','java/org/apache/catalina/connector/LocalStrings.properties\njava/org/apache/catalina/connector/Request.java'),(1018,50606,'Bug 50606 – Error running CGI executable in Tomcat 6.0.30','','2011-01-18 02:26:41','basil','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','c0cd721','Konstantin Kolinko','2011-01-20 12:43:35','Fix http://issues.apache.org/bugzilla/show_bug.cgi?id=50606 Improve CGIServlet: Provide support for specifying empty value for the executable init-param. Provide support for explicit additional arguments for the executable. Those were broken when implementing fix for bug 49657','java/org/apache/catalina/servlets/CGIServlet.java\nwebapps/docs/cgi-howto.xml\nwebapps/docs/changelog.xml'),(1019,49657,'Bug 49657 – In CGI Mode, \"executable\" full path with spaces does not work','In CGI mode, if you specify a full path for a command, containing blank, \nit does not work\n\nexample :\n       <init-param>\n            <param-name>executable</param-name>\n            <param-value>c:\\Tools\\mycommand</param-value>\n        </init-param>\nis OK but\n\n       <init-param>\n            <param-name>executable</param-name>\n            <param-value>c:\\Program Files\\mycommand</param-value>\n          </init-param>\ndoes not work well with error like\n\n\n7 juil. 2010 15:51:52 org.apache.catalina.core.ApplicationContext log\nINFO: cgi: runCGI (stderr):\'C:\\Program\' is not recognized as an internal or external command,\n\nNeed probably to add \" in for cgiExcecutable in CGIServlet.java,  like it is done\nfor CmdAndArgs','2010-07-28 03:45:08','de Ratuld','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','c0cd721','Konstantin Kolinko','2011-01-20 12:43:35','Fix http://issues.apache.org/bugzilla/show_bug.cgi?id=50606 Improve CGIServlet: Provide support for specifying empty value for the executable init-param. Provide support for explicit additional arguments for the executable. Those were broken when implementing fix for bug 49657','java/org/apache/catalina/servlets/CGIServlet.java\nwebapps/docs/cgi-howto.xml\nwebapps/docs/changelog.xml'),(1020,50535,'Bug 50535 – Support resources serving from /WEB-INF/classes/META-INF/resources directory','Servlet 3.0 introduced the feature to serve static files from META-INF/resources directory. The specification only demands support for this if the META-INF/resources is inside of a jar file in the /WEB-INF/lib directory.\n\nTomcat passes this requirement because it serves files from jar but not from WEB-INF/classes. It seems Glassfish 3.0.1 however supports both type of locations. It would be nice if Tomcat would support it too.','2011-01-01 09:35:40','Attila Király','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','9a2fd75','Mark Emlyn David Thomas','2011-01-20 11:35:55','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50535 Provid an option (disabled by default) to serve resources from /WEB-INF/classes/META-INF/resources','java/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/startup/ContextConfig.java\njava/org/apache/naming/resources/BaseDirContext.java\ntest/org/apache/catalina/core/TestStandardContextResources.java\ntest/webapp-3.0-fragments/WEB-INF/classes/META-INF/resources/resourceG.jsp\nwebapps/docs/config/context.xml'),(1021,50613,'Bug 50613 – ConnectionPool.size corruption when evictions enabled:','When (the various forms of) eviction run on the connection pool, ConnectionPool.size goes negative.  This appears to be a concurrency problem.\n\nAttached is a unit test that illustrates the issue.','2011-01-18 17:33:53','Jeremy Norris','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 major','5cb0b7a','Filip Hanik','2011-01-19 16:25:08','https://issues.apache.org/bugzilla/show_bug.cgi?id=50613 Fix concurrency bug around size calculation for the pool','modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java\nmodules/jdbc-pool/test/org/apache/tomcat/jdbc/test/TestSizePreservation.java'),(1022,50535,'Bug 50535 – Support resources serving from /WEB-INF/classes/META-INF/resources directory','Servlet 3.0 introduced the feature to serve static files from META-INF/resources directory. The specification only demands support for this if the META-INF/resources is inside of a jar file in the /WEB-INF/lib directory.\n\nTomcat passes this requirement because it serves files from jar but not from WEB-INF/classes. It seems Glassfish 3.0.1 however supports both type of locations. It would be nice if Tomcat would support it too.','2011-01-01 09:35:40','Attila Király','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','c3297ee','Mark Emlyn David Thomas','2011-01-19 14:36:58','Rename in preparation for https://issues.apache.org/bugzilla/show_bug.cgi?id=50535','java/org/apache/catalina/Context.java\njava/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/startup/ContextConfig.java\njava/org/apache/naming/resources/BaseDirContext.java'),(1023,50601,'Bug 50601 – Redundant null checks before instanceof in equals()','','2011-01-17 08:54:21','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','d95db3f','Mark Emlyn David Thomas','2011-01-19 14:08:36','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50601 Code clean-up Patch provided by sebb','java/org/apache/catalina/core/ApplicationTaglibDescriptor.java\njava/org/apache/catalina/deploy/LoginConfig.java\njava/org/apache/catalina/tribes/tipis/AbstractReplicatedMap.java\njava/org/apache/el/parser/SimpleNode.java\njava/org/apache/naming/NamingEntry.java\njava/org/apache/tomcat/util/net/URL.java\nwebapps/docs/changelog.xml'),(1024,22278,'Bug 22278 – [PATCH] Include RemoteAddrValve in manager.xml','The TC-Administration webapp context-descriptor admin.xml includes a (out-\ncommented) RemoteAddrValve to restrict access to localhost \"for obvious \nsecurity reasons\" - so should the manager webapp for the same reason.','2003-08-10 09:42:17','Yann Cébron','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 4','Webapps:Manager','P3 enhancement','18b7569','Mark Emlyn David Thomas','2011-01-18 19:00:59','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=22278 Add a commented out RemoteAddrValve that limits access to the Manager and Host Manager applications to localhost. Based on a patch by Yann Cébron.','webapps/docs/changelog.xml\nwebapps/host-manager/META-INF/context.xml\nwebapps/manager/META-INF/context.xml'),(1025,50599,'Bug 50599 – Documentation gives impression that \"manager\" role enables using ant deploy','','2011-01-16 14:12:27','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 normal','e112190','Konstantin Kolinko','2011-01-18 12:30:24','Documentation fixes: 1) role name: s/manager/manager-script/ (BZ 50599), s/manager-script/admin-script/ on 401/403 pages of host-manager webapp (a typo) 2) there is no property \"debug\" on the Context, nor on several other classes (realms, authenticators)','webapps/docs/config/host.xml\nwebapps/docs/deployer-howto.xml\nwebapps/docs/html-manager-howto.xml\nwebapps/docs/jndi-datasource-examples-howto.xml\nwebapps/docs/manager-howto.xml\nwebapps/docs/realm-howto.xml\nwebapps/host-manager/401.jsp\nwebapps/host-manager/403.jsp'),(1026,50599,'Bug 50599 – Documentation gives impression that \"manager\" role enables using ant deploy','','2011-01-16 14:12:27','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 normal','cb768c0','Mark Emlyn David Thomas','2011-01-17 12:31:45','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50599 Use correct names of security roles for Manager app','java/org/apache/catalina/ant/package.html\nwebapps/docs/appdev/build.xml.txt\nwebapps/docs/appdev/processes.xml\nwebapps/docs/changelog.xml\nwebapps/docs/funcspecs/fs-admin-apps.xml\nwebapps/docs/realm-howto.xml'),(1027,50598,'Bug 50598 – Sample build.xml uses wrong manager.url','','2011-01-16 14:08:25','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 normal','de188ad','Mark Emlyn David Thomas','2011-01-17 12:19:37','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50598 Correct URL for manager text interface','java/org/apache/catalina/ant/AbstractCatalinaTask.java\njava/org/apache/catalina/ant/package.html\nres/deployer/build.xml\nwebapps/docs/appdev/build.xml.txt\nwebapps/docs/changelog.xml\nwebapps/docs/deployer-howto.xml'),(1028,50597,'Bug 50597 – Class.newInstance is used for Dynamic instance filters causing InstantiationException','Class.newInstance is called even when the following method ServletContext.addFilter method is called:\n\njavax.servlet.FilterRegistration.Dynamic addFilter(java.lang.String s, javax.servlet.Filter filter);\n\nThis leads to an InstantiationException at runtime if there is no no-args constructor for the filter (pasted below). I\'ll supply a simple patch that fixes the issue for me.\n\nSEVERE: Exception starting filter testFilter\njava.lang.InstantiationException: test.TestFilter\n        at java.lang.Class.newInstance0(Class.java:340)\n        at java.lang.Class.newInstance(Class.java:308)\n        at org.apache.catalina.core.DefaultInstanceManager.newInstance(DefaultIn\nstanceManager.java:119)\n        at org.apache.catalina.core.ApplicationFilterConfig.getFilter(Applicatio\nnFilterConfig.java:252)\n        at org.apache.catalina.core.ApplicationFilterConfig.setFilterDef(Applica\ntionFilterConfig.java:372)\n        at org.apache.catalina.core.ApplicationFilterConfig.<init>(ApplicationFi\nlterConfig.java:98)\n        at org.apache.catalina.core.StandardContext.filterStart(StandardContext.\njava:4382)\n        at org.apache.catalina.core.StandardContext$2.call(StandardContext.java:\n5040)\n        at org.apache.catalina.core.StandardContext$2.call(StandardContext.java:5035)\n        at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)\n        at java.util.concurrent.FutureTask.run(FutureTask.java:138)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n        at java.lang.Thread.run(Thread.java:662)','2011-01-16 12:25:24','Ismael Juma','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','30468b7','Mark Emlyn David Thomas','2011-01-17 12:12:36','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50597 Don\'t instantiate a new instance of a Filter if an instance was provided via the ServletContext.addFilter(String, Filter) method. Patch provided by Ismael Juma.','java/org/apache/catalina/core/ApplicationFilterConfig.java\nwebapps/docs/changelog.xml'),(1029,50600,'Bug 50600 – ConcurrentModificationException removing WAR via FarmWarDeployer','The following exception was reported via $work\n\nWARNING: Exception processing cluster org.apache.catalina.ha.tcp.SimpleTcpCluster@68e4e358 background process\njava.util.ConcurrentModificationException\nat java.util.HashMap$HashIterator.nextEntry(HashMap.java:810)\nat java.util.HashMap$EntryIterator.next(HashMap.java:851)\nat java.util.HashMap$EntryIterator.next(HashMap.java:849)\nat org.apache.catalina.ha.deploy.WarWatcher.check(WarWatcher.java:87)\nat org.apache.catalina.ha.deploy.FarmWarDeployer.backgroundProcess(FarmWarDeployer.java:609)\nat org.apache.catalina.ha.tcp.SimpleTcpCluster.backgroundProcess(SimpleTcpCluster.java:596)\nat org.apache.catalina.core.ContainerBase.backgroundProcess(ContainerBase.java:1302)\nat org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1601)\nat org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1610)\nat org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.run(ContainerBase.java:1590)\nat java.lang.Thread.run(Thread.java:636)\n\nThe root cause is removing the entry directly from the Map rather than from the iterator. I have a patch that I\'ll apply shortly.','2011-01-17 06:20:11','Mark Thomas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Cluster','P2 normal','d269ce3','Mark Emlyn David Thomas','2011-01-17 06:26:56','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50600 Prevent ConcurrentModificationException when removing WAR via FarmWarDeployer','java/org/apache/catalina/ha/deploy/WarWatcher.java\nwebapps/docs/changelog.xml'),(1030,50582,'Bug 50582 – Small JSPs do not set Content-Length (and use chunked encoding) if AccessLogValve is configured','','2011-01-14 02:16:41','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 regression','35a84d1','Mark Emlyn David Thomas','2011-01-16 07:55:55','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50582 Refactor access logging so chunked encoding is not forced if bytes sent is logged','java/org/apache/catalina/connector/CoyoteAdapter.java\njava/org/apache/catalina/valves/AccessLogValve.java\njava/org/apache/catalina/valves/JDBCAccessLogValve.java\njava/org/apache/coyote/http11/AbstractOutputBuffer.java\nwebapps/docs/changelog.xml'),(1031,50591,'Bug 50591 – NPE in ReplicationValve in 7.0.6','','2011-01-15 12:33:11','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Cluster','P2 regression','d8f8be1','Konstantin Kolinko','2011-01-15 12:43:46','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50591 Do not throw NullPointerException when ReplicationValve#filter is not set.','java/org/apache/catalina/ha/tcp/ReplicationValve.java\nwebapps/docs/changelog.xml'),(1032,31912,'Bug 31912 – Add .css and .png to ReplicationValve filter in server.xml','May I suggest adding the .css and .png file types to the default filter list?\n\nOriginal:\n<Valve className=\"org.apache.catalina.cluster.tcp.ReplicationValve\"\nfilter=\".*\\.gif;.*\\.js;.*\\.jpg;.*\\.htm;.*\\.html;.*\\.txt;\"/>\n\nSuggested:\n<Valve className=\"org.apache.catalina.cluster.tcp.ReplicationValve\"\nfilter=\".*\\.gif;.*\\.js;.*\\.jpg;.*\\.png;.*\\.htm;.*\\.html;.*\\.css;.*\\.txt;\"/>','2004-10-27 04:25:53','Joseph Lam','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina:Cluster','P3 enhancement','a580b59','Konstantin Kolinko','2011-01-15 12:26:58','Updated ReplicationValve examples in the docs with the new regexp syntax. Added *.jpeg pattern to the list, as inspired by the comment in BZ 31912 https://issues.apache.org/bugzilla/show_bug.cgi?id=31912#c2','webapps/docs/cluster-howto.xml\nwebapps/docs/config/cluster-valve.xml'),(1033,31912,'Bug 31912 – Add .css and .png to ReplicationValve filter in server.xml','May I suggest adding the .css and .png file types to the default filter list?\n\nOriginal:\n<Valve className=\"org.apache.catalina.cluster.tcp.ReplicationValve\"\nfilter=\".*\\.gif;.*\\.js;.*\\.jpg;.*\\.htm;.*\\.html;.*\\.txt;\"/>\n\nSuggested:\n<Valve className=\"org.apache.catalina.cluster.tcp.ReplicationValve\"\nfilter=\".*\\.gif;.*\\.js;.*\\.jpg;.*\\.png;.*\\.htm;.*\\.html;.*\\.css;.*\\.txt;\"/>','2004-10-27 04:25:53','Joseph Lam','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina:Cluster','P3 enhancement','a580b59','Konstantin Kolinko','2011-01-15 12:26:58','Updated ReplicationValve examples in the docs with the new regexp syntax. Added *.jpeg pattern to the list, as inspired by the comment in BZ 31912 https://issues.apache.org/bugzilla/show_bug.cgi?id=31912#c2','webapps/docs/cluster-howto.xml\nwebapps/docs/config/cluster-valve.xml'),(1034,18797,'Bug 18797 – MemoryUserRule doesn\'t validate user attributes','The implementation of org.apache.catalina.realm.MemoryRuleSet.begin dosen\'t \nvalidate the attribute values before adding a user to the MemoryRealm. If \nusername or name are not present then a null username is used which can cause \nodd problems later on.\n\nBasically the method should check that parameters passed to MemoryRealm.addUser \nare not null before calling the method.','2003-04-08 06:33:14','Richard Clark','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 4','Catalina','P3 enhancement','51650a1','Mark Emlyn David Thomas','2011-01-13 12:55:55','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=18797 Provide null/zero-length protection','java/org/apache/catalina/users/LocalStrings.properties\njava/org/apache/catalina/users/MemoryUserDatabase.java\nwebapps/docs/changelog.xml'),(1035,18462,'Bug 18462 – System.err gets overriden to output to System.out','I am using Eclipse to do my development and I am running tomcat 4.1.24 from \nwithin eclipse. One of the nice features of eclipse is that anything you \ndisplay with System.out comes out in blue and anything you send to System.err \nis displayed in red. However when tomcat is running Catalina overrides \nSystem.err and makes it point to System.out. This is very inconvinient because \nits much harder to search for severe error messages in a list of millions of \ntrivial ones.','2003-03-28 12:35:32','Nikolay Metchev','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P3 enhancement','164fd40','Mark Emlyn David Thomas','2011-01-12 19:55:02','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=18462 Don\'t merge stdout and stderr internally','java/org/apache/catalina/startup/Catalina.java\njava/org/apache/catalina/startup/Embedded.java\nwebapps/docs/changelog.xml'),(1036,15688,'Bug 15688 – full-qualified names instead of imports','Hi,\n\nJasper generated *.java-files that are compiled.\nThe template for those files is very \"unaesthetic\".\n\nI could demonstrate nice side-effects using a simple\n  <%@ page import=\"mypackage.Jspfactory\" %>\n\nYou should use full qualified names instead of a bunch of import-staments.\nFor example\n  _jspxFactory = JspFactory.getDefaultFactory();\nwould become\n  _jspxFactory = javax.servlet.jsp.JspFactory.getDefaultFactory();\nand if you don\'t already do,\nyou should use the this-reference where possible.\n\nI don\'t know what the spec says about that conflict, but it shouldn\'t be a bad\nidea to use full-qualified names instead of imports.','2002-12-27 22:30:47','Sven','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 4','Jasper 2','P3 enhancement','e69347b','Mark Emlyn David Thomas','2011-01-12 07:08:16','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=15688 Use fully qualified class names to avoid possible naming conflicts JSP 2.2 TCK passes with these changes','java/org/apache/jasper/compiler/Generator.java\njava/org/apache/jasper/compiler/JspUtil.java\nwebapps/docs/changelog.xml'),(1037,50205,'Bug 50205 – Add deployIgnorePaths attribute to StandardHost','The attached patch adds a deployIgnorePaths attribute to StandardHost as I discussed with markt at ApacheConNA.  The attribute is a comma-separated list of regular expressions that will exclude files or directories under appBase from autoDepoy and deployOnStartup.  The host docs have been updated, and JMX get and set have been tested.\n\nWhy?  Here are a couple of use cases that this attribute can fix:\n\n- CATALINA_BASE configuration is kept under version control.  For example, I keep all of my configuration in subversion.  This includes appBase which has svn:externals to pull in the application code.  So, appBase/.svn gets deployed.\n\n- A context defined in server.xml but living in appBase will currently get double-deployed.  The recommendation is to move the app outside of appBase, but this attribute would allow it to live there with the instance\'s other apps.','2010-11-03 13:19:50','Jim Riggs','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 enhancement','0f3515c','Konstantin Kolinko','2011-01-12 00:23:49','Additional improvements for https://issues.apache.org/bugzilla/show_bug.cgi?id=50205 Followup to r1057788 1) Simplify check for absence of value 2) Reuse Matcher instance across iterations','java/org/apache/catalina/startup/HostConfig.java'),(1038,50205,'Bug 50205 – Add deployIgnorePaths attribute to StandardHost','The attached patch adds a deployIgnorePaths attribute to StandardHost as I discussed with markt at ApacheConNA.  The attribute is a comma-separated list of regular expressions that will exclude files or directories under appBase from autoDepoy and deployOnStartup.  The host docs have been updated, and JMX get and set have been tested.\n\nWhy?  Here are a couple of use cases that this attribute can fix:\n\n- CATALINA_BASE configuration is kept under version control.  For example, I keep all of my configuration in subversion.  This includes appBase which has svn:externals to pull in the application code.  So, appBase/.svn gets deployed.\n\n- A context defined in server.xml but living in appBase will currently get double-deployed.  The recommendation is to move the app outside of appBase, but this attribute would allow it to live there with the instance\'s other apps.','2010-11-03 13:19:50','Jim Riggs','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 enhancement','657b3f7','Mark Emlyn David Thomas','2011-01-10 11:48:25','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50205 Add deployIgnore to Host Based on a patch by Jim Riggs','java/org/apache/catalina/Host.java\njava/org/apache/catalina/core/StandardHost.java\njava/org/apache/catalina/core/mbeans-descriptors.xml\njava/org/apache/catalina/startup/HostConfig.java\njava/org/apache/catalina/startup/LocalStrings.properties\nwebapps/docs/config/host.xml'),(1039,50333,'Bug 50333 – IllegalArgumentException occurs when setting maxActive to smaller than 1.','','2010-11-25 00:22:29','Eiji Takahashi','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','0ccff07','Filip Hanik','2011-01-10 11:41:43','https://issues.apache.org/bugzilla/show_bug.cgi?id=50333 dont allow 0 or negative max active values','modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/PoolProperties.java'),(1040,49953,'Bug 49953 – Missing @Override annotations','','2010-09-17 14:00:04','Sebb','Tomcat Developers Mailing List','RESOLVED WONTFIX','Tomcat Modules','jdbc-pool','P2 normal','fd990a4','Filip Hanik','2011-01-10 11:38:08','https://issues.apache.org/bugzilla/show_bug.cgi?id=49953','modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/interceptor/StatementCache.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/jmx/ConnectionPool.java'),(1041,50413,'Bug 50413 – Tomcat returns 304 instead of 404 response for static custom 404 error file','','2010-12-05 07:34:55','Konstantin Preißer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 minor','cb67e5b','Konstantin Kolinko','2011-01-09 03:10:33','Enable testcase for 50413#c6, now that the issue is fixed with r1056889. Update changelog.','test/org/apache/catalina/servlets/TestDefaultServlet.java\nwebapps/docs/changelog.xml'),(1042,50413,'Bug 50413 – Tomcat returns 304 instead of 404 response for static custom 404 error file','','2010-12-05 07:34:55','Konstantin Preißer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 minor','4fe1ec8','Konstantin Kolinko','2011-01-09 03:07:02','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50413#c6 Serve the error page regardless of \"Range\" header in the original request.','java/org/apache/catalina/servlets/DefaultServlet.java'),(1043,50413,'Bug 50413 – Tomcat returns 304 instead of 404 response for static custom 404 error file','','2010-12-05 07:34:55','Konstantin Preißer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 minor','3c97f54','Konstantin Kolinko','2011-01-09 02:13:28','Added tests for https://issues.apache.org/bugzilla/show_bug.cgi?id=50413 The test that is currently failing is commented out and marked with a \"FIXME\" comment.','test/org/apache/catalina/servlets/TestDefaultServlet.java'),(1044,21157,'Bug 21157 – CookieExample is setting cookie after writing data','A servlet can not set the headers and cookies after writing data to the \nservlet\'s output stream. Once the servlet writes data, headers are committed. \nHowever CookieExample writes some data first before doing addCookie on the \nresponse. \n\nThe reason why this code works at all even with the above bug is: The \nCookieExample is only writing a small amount of data before doing \nresponse.addCookie. That data is still held in buffer and not yet sent over \nthe wire. Hence the headers are not yet committed. So it is pure luck that \nthis example works. \n\nYou can easily expose the bug by writing say 20K characters in this example \nbefore response.addCookie is called. You will see that the cookies that are \nadding to response are not actually sent back to client. \n\nFix is simple. Move up the response.addCookie() before response.getWriter()','2003-06-27 23:12:00','Vishy Kasar','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 4','Webapps:Examples','P5 enhancement','4ce656a','Mark Emlyn David Thomas','2011-01-08 17:27:26','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=21157 Write cookie before response might be committed','webapps/docs/changelog.xml\nwebapps/examples/WEB-INF/classes/CookieExample.java'),(1045,50556,'Bug 50556 – improve JreMemoryLeakPreventionListener against leak caused by LdapPoolManager','When class com.sun.jndi.ldap.LdapPoolManager is initialized, if if the system property com.sun.jndi.ldap.connect.pool.timeout is set to a value greater than 0, a PoolCleaner thread is spawned, without fixing a specific context class loader.\nIf the initialization of the class is triggered by a web application, its class loader will be used by the PoolCleaner thread. If that web app is stopped, its class loader will leak.\n\nWe can improve JreMemoryLeakPreventionListener to prevent that leak.','2011-01-06 17:13:06','Sylvain Laurent','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 enhancement','d36f958','Sylvain Laurent','2011-01-07 17:56:30','bug 50556: improve JreMemoryLeakPreventionListener against leak caused by LdapPoolManager https://issues.apache.org/bugzilla/show_bug.cgi?id=50556','java/org/apache/catalina/core/JreMemoryLeakPreventionListener.java\njava/org/apache/catalina/core/LocalStrings.properties\nwebapps/docs/changelog.xml\nwebapps/docs/config/listeners.xml'),(1046,50556,'Bug 50556 – improve JreMemoryLeakPreventionListener against leak caused by LdapPoolManager','When class com.sun.jndi.ldap.LdapPoolManager is initialized, if if the system property com.sun.jndi.ldap.connect.pool.timeout is set to a value greater than 0, a PoolCleaner thread is spawned, without fixing a specific context class loader.\nIf the initialization of the class is triggered by a web application, its class loader will be used by the PoolCleaner thread. If that web app is stopped, its class loader will leak.\n\nWe can improve JreMemoryLeakPreventionListener to prevent that leak.','2011-01-06 17:13:06','Sylvain Laurent','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 enhancement','d36f958','Sylvain Laurent','2011-01-07 17:56:30','bug 50556: improve JreMemoryLeakPreventionListener against leak caused by LdapPoolManager https://issues.apache.org/bugzilla/show_bug.cgi?id=50556','java/org/apache/catalina/core/JreMemoryLeakPreventionListener.java\njava/org/apache/catalina/core/LocalStrings.properties\nwebapps/docs/changelog.xml\nwebapps/docs/config/listeners.xml'),(1047,50496,'Bug 50496 – AccessLogValve not logging size correctly for %B with enabled compression','','2010-12-19 07:33:26','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED WONTFIX','Tomcat 6','Catalina','P2 normal','7f2e096','Mark Emlyn David Thomas','2011-01-07 08:01:00','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50496 Differentiate between content written (what the app writes to the output stream) and bytes written (what Tomcat writes to the socket) and use bytes for the access logs','java/org/apache/catalina/connector/Response.java\njava/org/apache/catalina/valves/AccessLogValve.java\njava/org/apache/catalina/valves/ErrorReportValve.java\njava/org/apache/catalina/valves/JDBCAccessLogValve.java\njava/org/apache/coyote/OutputBuffer.java\njava/org/apache/coyote/RequestInfo.java\njava/org/apache/coyote/Response.java\njava/org/apache/coyote/ajp/AbstractAjpProcessor.java\njava/org/apache/coyote/ajp/AjpAprProcessor.java\njava/org/apache/coyote/ajp/AjpProcessor.java\njava/org/apache/coyote/http11/AbstractOutputBuffer.java\njava/org/apache/coyote/http11/InternalAprOutputBuffer.java\njava/org/apache/coyote/http11/InternalNioOutputBuffer.java\njava/org/apache/coyote/http11/InternalOutputBuffer.java\njava/org/apache/coyote/http11/filters/ChunkedOutputFilter.java\njava/org/apache/coyote/http11/filters/GzipOutputFilter.java\njava/org/apache/coyote/http11/filters/IdentityOutputFilter.java\njava/org/apache/coyote/http11/filters/VoidOutputFilter.java\nwebapps/docs/changelog.xml'),(1048,50552,'Bug 50552 – Ant Tasks give a null pointer exception when an error occurs, masking true error','','2011-01-06 12:39:49','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','a6b37af','Mark Emlyn David Thomas','2011-01-07 06:24:36','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50552 Avoid NPE that hides error when using Ant tasks (schultz)','java/org/apache/catalina/ant/BaseRedirectorHelperTask.java\nwebapps/docs/changelog.xml'),(1049,50554,'Bug 50554 – Bad use of getClass() could potentially lead to concurrency bugs in future','','2011-01-06 14:38:25','Mohsen Vakilian','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','06b8609','Mark Emlyn David Thomas','2011-01-07 05:31:59','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50554 Various FindBugs / Eclipse warnings Silence the false positives','java/org/apache/naming/java/javaURLContextFactory.java\nres/findbugs/filter-false-positives.xml\nwebapps/docs/changelog.xml'),(1050,50477,'Bug 50477 – If you set 0 to initialSize, can\'t obtain Connection by using getConnectionAsync method.','','2010-12-15 04:40:32','Eiji Takahashi','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','869c6f4','Filip Hanik','2011-01-06 18:53:11','Fix bug https://issues.apache.org/bugzilla/show_bug.cgi?id=50477','modules/jdbc-pool/.classpath\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java\nmodules/jdbc-pool/test/org/apache/tomcat/jdbc/test/Async0IdleTestBug50477.java'),(1051,49543,'Bug 49543 – Request for a \"shared\" datasource configuration as in DBCP','The ability to configure the datasource at the server level and have it shared amongst all applications on that server with each application supplying their own credentials for the datasource. This type of configuration is supported by DBCP and is called a \"shared\" datasource configuration.','2010-07-02 15:07:50','Jason','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 enhancement','3560f39','Filip Hanik','2011-01-06 13:22:34','https://issues.apache.org/bugzilla/show_bug.cgi?id=49543 Add the ability to specify a data source link, to use a shared datasource with per application credentials','java/org/apache/naming/factory/DataSourceLinkFactory.java\nwebapps/docs/changelog.xml\nwebapps/docs/config/context.xml'),(1052,50550,'Bug 50550 – PropFind 404 error after MkCol succes','','2011-01-06 09:11:12','Maarten van Hulsentop','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Servlets:WebDAV','P2 normal','5c2742c','Mark Emlyn David Thomas','2011-01-06 13:09:23','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50550 Make sure PROPFIND,MKCOL,PROPFIND returns 404,201,207 rather than 404,201,404','java/org/apache/naming/resources/ProxyDirContext.java\nwebapps/docs/changelog.xml'),(1053,47319,'Bug 47319 – With APR, getRemoteHost() returns NULL for unknown clients','','2009-06-05 05:11:52','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P3 normal','ce64f9b','Mark Emlyn David Thomas','2011-01-06 12:02:27','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47319 Don\'t return null for getRemoteHost() if the IP address cannot be resolved.','java/org/apache/coyote/http11/Http11AprProcessor.java\nwebapps/docs/changelog.xml'),(1054,50547,'Bug 50547 – The CHANGE_SESSION_ID message that received during cluster session synchronization is dropped.','Neither CHANGE_SESSION_ID message nor SESSION_EXPIRED message set timestamp. \nIf these messages are received during cluster sessions synchronization in DeltaManager startup, \nbecause the timestamp is not set, they are dropped. \n\nI made a patch that add timestamp for CHANGE_SESSION_ID and SESSION_EXPIRED message.\n\nBest Regards.','2011-01-06 03:48:03','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina:Cluster','P2 normal','a0ef3e6','Keiichi Fujino','2011-01-06 04:17:28','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50547. Add time stamp for CHANGE_SESSION_ID and SESSION_EXPIRED message.','java/org/apache/catalina/ha/session/DeltaManager.java\nwebapps/docs/changelog.xml'),(1055,50453,'Bug 50453 – Multiple X-Forwarded-For headers not handled by RemoteIP valve','','2010-12-10 09:29:39','Jim Riggs','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','3541fc6','Mark Emlyn David Thomas','2011-01-05 10:05:42','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50453 Correctly handle multiple X-Forwarded-For headers','java/org/apache/catalina/filters/RemoteIpFilter.java\njava/org/apache/catalina/valves/RemoteIpValve.java\ntest/org/apache/catalina/filters/TestRemoteIpFilter.java\ntest/org/apache/catalina/valves/TestRemoteIpValve.java\nwebapps/docs/changelog.xml'),(1056,50467,'Bug 50467 – Occasional NIO connector lockups on high load','We\'ve been running Tomcat 6.0.29 on FC8 2.6.21 with tens of thousands of long polling threads which usually work fine. Every few days though we will experience a sudden lockup of the NIO connector and it has to be restarted. These have been seen to be accompanied by the following stack trace:\n\nException in thread \"http-8082-ClientPoller-0\" java.lang.NullPointerException\n	at org.apache.tomcat.util.net.NioEndpoint$Poller.run(NioEndpoint.java:1620)\n	at java.lang.Thread.run(Thread.java:662)\n\nLooking at the source it seems the issue is likely to be a race condition where access() is called on a null attachment, probably while it\'s in the process of being cancelled:\n\n                    while (iterator != null && iterator.hasNext()) {\n                        SelectionKey sk = (SelectionKey) iterator.next();\n                        KeyAttachment attachment = (KeyAttachment)sk.attachment();\n/*NPE*/                 attachment.access();\n                        iterator.remove();\n                        processKey(sk, attachment);\n                    }//while','2010-12-13 14:02:35','Steven Hugg','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 major','688e61e','Mark Emlyn David Thomas','2011-01-05 08:51:48','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50467 Protect against NPE that will cause Poller to fail','java/org/apache/tomcat/util/net/NioEndpoint.java\nwebapps/docs/changelog.xml'),(1057,50496,'Bug 50496 – AccessLogValve not logging size correctly for %B with enabled compression','','2010-12-19 07:33:26','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED WONTFIX','Tomcat 6','Catalina','P2 normal','160373e','Mark Emlyn David Thomas','2011-01-05 05:10:29','Simplify getContentCount. Prep for fixing bug 50496','java/org/apache/catalina/connector/OutputBuffer.java\njava/org/apache/catalina/connector/Response.java\njava/org/apache/catalina/valves/AccessLogValve.java\njava/org/apache/catalina/valves/ErrorReportValve.java\njava/org/apache/catalina/valves/JDBCAccessLogValve.java'),(1058,50527,'Bug 50527 – misleading error message for unknown HTTP method','For unknown HTTP methods, Tomcat says:\n\n\"...is not defined in RFC 2068 and is not supported by the servlet API\"\n\nThis is misleading.\n\n1) RFC 2068 has been obsoleted by RFC 2616 over 10 years ago. It doesn\'t matter what it says.\n\n2) As a matter of fact, what RFC 2616 says doesn\'t matter either. Methods are an extension point, and extension methods work just fine *when implemented*.\n\nSo the message (in javax/servlet/http/LocalStrings.properties) should be something like:\n\n\"...is not implemented by this servlet for this URI\".','2010-12-29 08:56:38','Julian Reschke','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','738405b','Mark Emlyn David Thomas','2011-01-04 17:59:38','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50527 Improve error message','java/javax/servlet/http/LocalStrings.properties'),(1059,49000,'Bug 49000 – Cookie parsing bug when an empty value has an equal sign on the end','','2010-03-26 19:51:34','Henri Yandell','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','06d22d4','Mark Emlyn David Thomas','2011-01-04 14:20:28','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49000 Make accepting name only cookies configurable, defaulting to disabled.','java/org/apache/tomcat/util/http/CookieSupport.java\njava/org/apache/tomcat/util/http/Cookies.java\ntest/org/apache/tomcat/util/http/TestCookies.java\ntest/org/apache/tomcat/util/http/TestCookiesAllowNameOnly.java\nwebapps/docs/config/systemprops.xml'),(1060,49000,'Bug 49000 – Cookie parsing bug when an empty value has an equal sign on the end','','2010-03-26 19:51:34','Henri Yandell','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','afe77d0','Mark Emlyn David Thomas','2011-01-04 13:28:23','Partial fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=49000 Consistently handle name only cookies (which are not spec complaint)','java/org/apache/tomcat/util/http/Cookies.java\ntest/org/apache/tomcat/util/http/TestCookies.java'),(1061,49372,'Bug 49372 – 7.0.0RC: Starting second instance of Tomcat on the same port results in \"An invalid Lifecycle transition was attempted\"','Using the current pre-7.0.0 trunk as of now (r950811),\nto reproduce:\n1) start an instance of Tomcat\n2) start the second instance of Tomcat using the same configuration\n\nThe start fails (as expected), but the messages are accompanied with \nLifecycleException:  An invalid Lifecycle transition was attempted ([before_stop]) for component [StandardServer[8005]] in state [STARTING]\n\nSee the log below.\n\n03.06.2010 3:14:08 org.apache.catalina.startup.Catalina load\nINFO: Initialization processed in 3145 ms\n03.06.2010 3:14:09 org.apache.catalina.core.StandardService startInternal\nINFO: Starting service Catalina\n03.06.2010 3:14:09 org.apache.catalina.core.StandardEngine startInternal\nINFO: Starting Servlet Engine: Apache Tomcat/7.0.0-dev\n03.06.2010 3:14:09 org.apache.catalina.startup.HostConfig deployDirectory\nINFO: Deploying web application directory docs\n03.06.2010 3:14:11 org.apache.catalina.startup.HostConfig deployDirectory\nINFO: Deploying web application directory examples\n03.06.2010 3:14:12 org.apache.catalina.startup.HostConfig deployDirectory\nINFO: Deploying web application directory host-manager\n03.06.2010 3:14:13 org.apache.catalina.startup.HostConfig deployDirectory\nINFO: Deploying web application directory manager\n03.06.2010 3:14:13 org.apache.catalina.startup.HostConfig deployDirectory\nINFO: Deploying web application directory ROOT\n03.06.2010 3:14:13 org.apache.coyote.http11.Http11Protocol init\nSEVERE: Error initializing endpoint\njava.net.BindException: Address already in use: JVM_Bind <null>:8080\n	at org.apache.tomcat.util.net.JIoEndpoint.init(JIoEndpoint.java:368)\n	at org.apache.coyote.http11.Http11Protocol.init(Http11Protocol.java:125)\n	at org.apache.catalina.connector.Connector.startInternal(Connector.java:866)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:137)\n	at org.apache.catalina.core.StandardService.startInternal(StandardService.java:437)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:137)\n	at org.apache.catalina.core.StandardServer.startInternal(StandardServer.java:648)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:137)\n	at org.apache.catalina.startup.Catalina.start(Catalina.java:576)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n	at java.lang.reflect.Method.invoke(Method.java:597)\n	at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:288)\n	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:415)\nCaused by: java.net.BindException: Address already in use: JVM_Bind\n	at java.net.PlainSocketImpl.socketBind(Native Method)\n	at java.net.PlainSocketImpl.bind(PlainSocketImpl.java:365)\n	at java.net.ServerSocket.bind(ServerSocket.java:319)\n	at java.net.ServerSocket.<init>(ServerSocket.java:185)\n	at java.net.ServerSocket.<init>(ServerSocket.java:141)\n	at org.apache.tomcat.util.net.DefaultServerSocketFactory.createSocket(DefaultServerSocketFactory.java:52)\n	at org.apache.tomcat.util.net.JIoEndpoint.init(JIoEndpoint.java:357)\n	... 14 more\n03.06.2010 3:14:13 org.apache.catalina.startup.Catalina start\nSEVERE: Catalina.start: \nLifecycleException:  Protocol handler initialization failed: java.net.BindException: Address already in use: JVM_Bind <null>:8080\n	at org.apache.catalina.connector.Connector.startInternal(Connector.java:868)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:137)\n	at org.apache.catalina.core.StandardService.startInternal(StandardService.java:437)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:137)\n	at org.apache.catalina.core.StandardServer.startInternal(StandardServer.java:648)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:137)\n	at org.apache.catalina.startup.Catalina.start(Catalina.java:576)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n	at java.lang.reflect.Method.invoke(Method.java:597)\n	at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:288)\n	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:415)\n03.06.2010 3:14:13 org.apache.catalina.startup.Catalina start\nINFO: Server startup in 4737 ms\n03.06.2010 3:14:13 org.apache.catalina.core.StandardServer await\nSEVERE: StandardServer.await: create[localhost:8005]: \njava.net.BindException: Address already in use: JVM_Bind\n	at java.net.PlainSocketImpl.socketBind(Native Method)\n	at java.net.PlainSocketImpl.bind(PlainSocketImpl.java:365)\n	at java.net.ServerSocket.bind(ServerSocket.java:319)\n	at java.net.ServerSocket.<init>(ServerSocket.java:185)\n	at org.apache.catalina.core.StandardServer.await(StandardServer.java:359)\n	at org.apache.catalina.startup.Catalina.await(Catalina.java:654)\n	at org.apache.catalina.startup.Catalina.start(Catalina.java:608)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n	at java.lang.reflect.Method.invoke(Method.java:597)\n	at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:288)\n	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:415)\n03.06.2010 3:14:13 org.apache.catalina.startup.Catalina stop\nSEVERE: Catalina.stop\nLifecycleException:  An invalid Lifecycle transition was attempted ([before_stop]) for component [StandardServer[8005]] in state [STARTING]\n	at org.apache.catalina.util.LifecycleBase.invalidTransition(LifecycleBase.java:315)\n	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:204)\n	at org.apache.catalina.startup.Catalina.stop(Catalina.java:641)\n	at org.apache.catalina.startup.Catalina$CatalinaShutdownHook.run(Catalina.java:783)','2010-06-02 19:23:32','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','740649f','Mark Emlyn David Thomas','2011-01-04 12:57:16','Re-fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49372 Don\'t throw an LifecycleException for an invalid transition if a connector fails to start.','java/org/apache/catalina/core/StandardService.java\njava/org/apache/catalina/util/LifecycleBase.java\nwebapps/docs/changelog.xml'),(1062,50541,'Bug 50541 – JNDIRealm: support configuring LDAP sizeLimit (countLimit in SearchControls)','','2011-01-04 11:35:07','Aleksander Adamowski','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','76b6415','Mark Emlyn David Thomas','2011-01-04 12:35:06','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50541 Add support for sizeLimit and timeLimit on the JNDIRealm','java/org/apache/catalina/realm/JNDIRealm.java\nwebapps/docs/changelog.xml\nwebapps/docs/config/realm.xml'),(1063,50488,'Bug 50488 – classpath for jsvc in web page','','2010-12-16 12:46:51','Edoardo Panfili','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 normal','81e2799','Mark Emlyn David Thomas','2011-01-04 11:56:58','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50488 Update classpath required when using jsvc and add a note regarding server VMs.','webapps/docs/changelog.xml\nwebapps/docs/setup.xml'),(1064,50500,'Bug 50500 – EL evaluation of floating-point String value vs BigInteger loses precision','According to the EL spec ch.1.7.1,\nthe A+B,A-B,A*B expressions when A is a \"String containing ., e, or E\" and B is a BigInteger have to be evaluated as follows:\n\n\"coerce both A and B to BigDecimal and apply operator\"\n\nThe actual implementation though, instead of coercing A as String -> BigDecimal, does two coercions:  String -> Double -> BigDecimal, which produces a different result.\n\nTo reproduce, run the following JSP page:\n<%\n  pageContext.setAttribute(\"a\", \"1.1\");\n  pageContext.setAttribute(\"b\", new java.math.BigInteger(\"1000000000000000000000\"));\n  // \"c\" is used to explicitly coerce arguments to BigDecimal\n  pageContext.setAttribute(\"c\", new java.math.BigDecimal(\"0\"));\n%>${a + b}<br>\n${(a+c) + (b+c)}<br>\n${a - b}<br>\n${(a+c) - (b+c)}<br>\n${a * b}<br>\n${(a+c) * (b+c)}\n\nActual result:\n1000000000000000000001.100000000000000088817841970012523233890533447265625\n1000000000000000000001.1\n-999999999999999999998.899999999999999911182158029987476766109466552734375\n-999999999999999999998.9\n1100000000000000088817.841970012523233890533447265625000000000000000000000\n1100000000000000000000.0 \n\nExpected result:\n1000000000000000000001.1\n1000000000000000000001.1\n-999999999999999999998.9\n-999999999999999999998.9\n1100000000000000000000.0 \n1100000000000000000000.0 \n\nI think it is a minor issue, though.\nThis is reproducible in the current tc6.0.x as well.\n\nMaybe o.a.el.lang.ELArithmetic#add(Object, Object) should delegate to BIGDECIMAL instead of DOUBLE with these types of arguments.','2010-12-19 19:00:53','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 minor','b19fb3b','Mark Emlyn David Thomas','2011-01-04 09:22:52','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50500 Use correct coercions (as per the EL spec) for arithmetic operations involving string values containing \'.\', \'e\' or \'E\'. Based on a patch by Brian Weisleder.','java/org/apache/el/lang/ELArithmetic.java\ntest/org/apache/el/lang/TestELArithmetic.java\nwebapps/docs/changelog.xml'),(1065,50025,'Bug 50025 – getConnection method in class DataSourceProxy is ignoring credentials','','2010-09-29 09:48:26','Tim','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 critical','59b17c1','Filip Hanik','2011-01-03 17:14:21','add in ability to pass through credentials https://issues.apache.org/bugzilla/show_bug.cgi?id=50025','modules/jdbc-pool/doc/jdbc-pool.xml\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/DataSourceFactory.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/DataSourceProxy.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/PoolConfiguration.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/PoolProperties.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/PooledConnection.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/jmx/ConnectionPool.java\nmodules/jdbc-pool/test/org/apache/tomcat/jdbc/test/AlternateUsernameTest.java\nmodules/jdbc-pool/test/org/apache/tomcat/jdbc/test/driver/Connection.java\nmodules/jdbc-pool/test/org/apache/tomcat/jdbc/test/driver/Driver.java'),(1066,49159,'Bug 49159 – Improve ThreadLocal memory leak clean-up','Doing this in a thread-safe way means performing the clean-up in the thread where the ThreadLocal exists. A likely point is just before the Thread gets returned to the pool.','2010-04-20 13:33:43','Mark Thomas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','f5eb35a','Sylvain Laurent','2010-12-21 17:26:55','bug 49159: Improve ThreadLocal memory leak clean-up https://issues.apache.org/bugzilla/show_bug.cgi?id=49159','java/org/apache/tomcat/util/threads/LocalStrings.properties\njava/org/apache/tomcat/util/threads/ThreadPoolExecutor.java\njava/org/apache/tomcat/util/threads/res/LocalStrings.properties\njava/org/apache/tomcat/util/threads/res/LocalStrings_es.properties\njava/org/apache/tomcat/util/threads/res/LocalStrings_fr.properties\njava/org/apache/tomcat/util/threads/res/LocalStrings_ja.properties'),(1067,49159,'Bug 49159 – Improve ThreadLocal memory leak clean-up','Doing this in a thread-safe way means performing the clean-up in the thread where the ThreadLocal exists. A likely point is just before the Thread gets returned to the pool.','2010-04-20 13:33:43','Mark Thomas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','f5eb35a','Sylvain Laurent','2010-12-21 17:26:55','bug 49159: Improve ThreadLocal memory leak clean-up https://issues.apache.org/bugzilla/show_bug.cgi?id=49159','java/org/apache/tomcat/util/threads/LocalStrings.properties\njava/org/apache/tomcat/util/threads/ThreadPoolExecutor.java\njava/org/apache/tomcat/util/threads/res/LocalStrings.properties\njava/org/apache/tomcat/util/threads/res/LocalStrings_es.properties\njava/org/apache/tomcat/util/threads/res/LocalStrings_fr.properties\njava/org/apache/tomcat/util/threads/res/LocalStrings_ja.properties'),(1068,50503,'Bug 50503 – Engine level Clustering does not work correctly if the web application has a version.','In Engine level clustering, the name of the cluster manager is  \"HostName#contextName\". \nSimpleTcpCluster#getManagerName(String, Manager) is as follows. \n====\npublic String getManagerName(String name, Manager manager) {\n    String clusterName = name ;\n    if ( clusterName == null ) clusterName = manager.getContainer().getName();\n    if(getContainer() instanceof Engine) {\n        Container context = manager.getContainer() ;\n        if(context != null && context instanceof Context) {\n            Container host = ((Context)context).getParent();\n            if(host != null && host instanceof Host && clusterName!=null && !(clusterName.indexOf(\"#\")>=0))\n                clusterName = host.getName() +\"#\" + clusterName ;\n        }\n    }\n    return clusterName;\n}\n====\n\nIn this method, clusterName.indexOf(\"#\") >= 0 is checked. \n\nBecause the context name becomes contextName##version if the web application has a version, \nthe name of the cluster manager doesn\'t become a format of \"HostName#contextName\". \nAs a result, Engine level Clustering doesn\'t work correctly. \n\nBest regards.','2010-12-21 01:42:21','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Cluster','P2 normal','701d5dc','Keiichi Fujino','2010-12-21 01:56:09','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50503. When web application has a version, Engine level Clustering works correctly.','java/org/apache/catalina/ha/tcp/SimpleTcpCluster.java\nwebapps/docs/changelog.xml'),(1069,13731,'Bug 13731 – Final request, response, session and other variables.','Provide a capability to declare request, response, session and other variables \nin jspService function as final. As tunable feature, just like others, in \ntomcat`s web.xml file.\n\nWhy need this feature? To use request, response, session variables in anonymous \nimplementations of classes. For example - declaration of iterator through \nelements, which includes some other JSP file (statically). And usage of this \niterator in other JSP file.','2002-10-17 13:23:42','Ruslan','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 4','Jasper 2','P3 enhancement','73531cb','Mark Emlyn David Thomas','2010-12-16 18:35:17','https://issues.apache.org/bugzilla/show_bug.cgi?id=13731 Make variables in <code>_jspService()</code> method final where possible.','java/org/apache/jasper/compiler/Generator.java\nwebapps/docs/changelog.xml'),(1070,48822,'Bug 48822 – Include contest name in reload and stop log statements','','2010-02-26 10:35:09','Marc Guillemot','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 enhancement','6e3451d','Sylvain Laurent','2010-12-16 16:07:55','bug 48822: Include contest name in reload and stop log statements https://issues.apache.org/bugzilla/show_bug.cgi?id=48822','webapps/docs/changelog.xml'),(1071,48822,'Bug 48822 – Include contest name in reload and stop log statements','','2010-02-26 10:35:09','Marc Guillemot','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 enhancement','6e3451d','Sylvain Laurent','2010-12-16 16:07:55','bug 48822: Include contest name in reload and stop log statements https://issues.apache.org/bugzilla/show_bug.cgi?id=48822','webapps/docs/changelog.xml'),(1072,48822,'Bug 48822 – Include contest name in reload and stop log statements','','2010-02-26 10:35:09','Marc Guillemot','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 enhancement','f3c50f8','Sylvain Laurent','2010-12-16 15:40:36','bug 48822: Include contest name in reload and stop log statements https://issues.apache.org/bugzilla/show_bug.cgi?id=48822','java/org/apache/catalina/core/LocalStrings.properties\njava/org/apache/catalina/core/LocalStrings_es.properties\njava/org/apache/catalina/core/LocalStrings_fr.properties\njava/org/apache/catalina/core/StandardContext.java'),(1073,48822,'Bug 48822 – Include contest name in reload and stop log statements','','2010-02-26 10:35:09','Marc Guillemot','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 enhancement','f3c50f8','Sylvain Laurent','2010-12-16 15:40:36','bug 48822: Include contest name in reload and stop log statements https://issues.apache.org/bugzilla/show_bug.cgi?id=48822','java/org/apache/catalina/core/LocalStrings.properties\njava/org/apache/catalina/core/LocalStrings_es.properties\njava/org/apache/catalina/core/LocalStrings_fr.properties\njava/org/apache/catalina/core/StandardContext.java'),(1074,10972,'Bug 10972 – <Realm> without className in server.xml produces NullPointerException','If the className attribute is not included with the <Realm> tag in server.xml, \nthe server dies with a cryptic NullPointerException.  It would be nice if it \nproduced a more meaningful error message (like \"Missing className attribute for \n<Realm> tag\").','2002-07-19 02:30:07','Willis Boyce','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 4','Catalina','P3 enhancement','71ad1bd','Mark Emlyn David Thomas','2010-12-15 12:58:05','https://issues.apache.org/bugzilla/show_bug.cgi?id=10972 Improve error message if the className attribute is missing on an element in server.xml where it is required.','java/org/apache/catalina/startup/Catalina.java\njava/org/apache/tomcat/util/digester/Digester.java\njava/org/apache/tomcat/util/digester/ObjectCreateRule.java\nwebapps/docs/changelog.xml'),(1075,10526,'Bug 10526 – Authenticators do not always cache the Principal','Once a user is authenticated a Principal object is supposed to be cached for \nthe duration of the user\'s session. This is especially important when using \nJDBCRealm or JNDIRealm to reduce the load on external authentication services.\n\nMost authenticators (BasicAuthenticator, SSLAuthenticator and \nDigestAuthenticator) call AuthenticatorBase.register()to cache the Principal. \nHowever register() does nothing if a session object does not already exist, so \ncaching does not occur when the application does not create a session object \nitself. The problem can be seen by setting a security constraint on tomcat-docs \nand then browsing the Tomcat documentation - the external authentication \nservice is hit on every request.\n\nThe problem does not occur with form based login, because FormAuthenticator \ncaches the Principal itself and creates a new session if necessary to do it.\n\nProbably the best fix would be to change AuthenticatorBase.register() to create \na new session by calling getSession(request, true) instead of getSession\n(request, false). However, perhaps there is a reason why this is not being \ndone - though if so I cannot see what it is.\n\nAn alternative is to change the concrete authentication classes to make sure a \nsession exists before calling register(), e.g.\n\n--- BasicAuthenticator.java     23 Mar 2002 17:52:16 -0000      1.12\n+++ BasicAuthenticator.java     6 Jul 2002 12:46:30 -0000\n@@ -160,6 +160,7 @@\n         String password = parsePassword(authorization);\n         principal = context.getRealm().authenticate(username, password);\n         if (principal != null) {\n+           Session session = getSession(request, true);\n             register(request, response, principal, Constants.BASIC_METHOD,\n                      username, password);\n             return (true);\n\nSimilar patches would be required for SSLAuthenticator and DigestAuthenticator \nof course.','2002-07-06 13:11:40','John Holman','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 4','Catalina','P3 enhancement','ca34a30','Mark Emlyn David Thomas','2010-12-15 11:41:31','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=10526 Add alwaysUseSession option to authenticators','java/org/apache/catalina/authenticator/AuthenticatorBase.java\nwebapps/docs/changelog.xml\nwebapps/docs/config/valve.xml'),(1076,49125,'Bug 49125 – toString on byte[] array probably is not correct','Two examples of using toString() on a byte[] array, which is unlikely to produce the desired output:\n\nha.deploy.FileMessageFactory.writeMessage()\nlog message uses toString on msg.getData() which is a byte[] array\n\ncoyote.ajp.AjpMessage.dump\nuse toString on \"msg\" which is of type byte[]','2010-04-14 18:54:35','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P5 enhancement','5614817','Christopher Schultz','2010-12-14 15:49:28','Fixed bug #49125: toString on byte[] array probably is not correct - Added HexUtils.toHexString method - Wrapped output of byte[] objects with a call to HexUtils.toHexString','java/org/apache/catalina/ha/deploy/FileMessageFactory.java\njava/org/apache/coyote/ajp/AjpMessage.java\njava/org/apache/tomcat/util/buf/HexUtils.java'),(1077,50201,'Bug 50201 – StandardEngine.defaultAccessLog may become stale when ROOT webapp is redeployed','','2010-11-02 19:28:12','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','ff0d9a8','Konstantin Kolinko','2010-12-12 21:09:32','Improve the fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=50201 - Use AtomicReference to guard against possible duplicate registration of   listeners when logAccess() is called by several threads at the same time. - Added install() and uninstall() method to AccessLogListener   to help register/unregister the listeners. - When defaultAccessLog is nulled, always unregister the listener as well.   The listener does not need to be reused, because now we do create a listener   when there is no log and it will take care of things.','java/org/apache/catalina/core/StandardEngine.java\nwebapps/docs/changelog.xml'),(1078,50460,'Bug 50460 – First access to a jspx page causes classloader leak in JspDocumentParser','','2010-12-11 21:33:47','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','345e6b5','Konstantin Kolinko','2010-12-12 19:58:11','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50460 Avoid leak caused by using a cached exception instance','java/org/apache/jasper/compiler/JspDocumentParser.java\njava/org/apache/naming/resources/ImmutableNameNotFoundException.java'),(1079,48973,'Bug 48973 – Don\'t create SESSIONS.ser when no session exists','','2010-03-24 09:22:46','Marc Guillemot','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 enhancement','6b1d514','Konstantin Kolinko','2010-12-12 17:33:09','Use i18n for the messages It is followup to r1042022 which was a fix for BZ 48973','java/org/apache/catalina/session/LocalStrings.properties\njava/org/apache/catalina/session/StandardManager.java'),(1080,50449,'Bug 50449 – Methodexpression with arguments fails in JSF composite component','','2010-12-09 21:46:12','balusc','Tomcat Developers Mailing List','RESOLVED WORKSFORME','Tomcat 7','Jasper','P2 normal','b3d0f9d','Mark Emlyn David Thomas','2010-12-12 14:50:45','Add some tests for bug50449 but haven\'t reproduced it yet','test/org/apache/el/TestMethodExpressionImpl.java\ntest/org/apache/el/TesterBeanB.java'),(1081,50459,'Bug 50459 – StandardContext.bindThread() and unbindThread() are not symmetrical and not limited to current thread','As a side effect of my commit, I think I found a bug in StandardContext.bindThread() and unbindThread() methods in both tomcat 6 and 7 :\n\n- the methods should be symmetrical : unbindThread should restore the Thread CCL after calling DirContextURLStreamHandler.unbind() and ContextBindings.unbindThread()\n- StandardContext.bindThread() should call DirContextURLStreamHandler.bindThread() instead of DirContextURLStreamHandler.bind()\n- StandardContext.unbindThread() should call DirContextURLStreamHandler.unbindThread() instead of DirContextURLStreamHandler.unbind()','2010-12-11 19:06:16','Sylvain Laurent','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','c263221','Sylvain Laurent','2010-12-11 19:16:33','bug 50459: StandardContext.bindThread() and unbindThread() are not symmetrical and not limited to current thread https://issues.apache.org/bugzilla/show_bug.cgi?id=50459','java/org/apache/catalina/core/StandardContext.java'),(1082,50459,'Bug 50459 – StandardContext.bindThread() and unbindThread() are not symmetrical and not limited to current thread','As a side effect of my commit, I think I found a bug in StandardContext.bindThread() and unbindThread() methods in both tomcat 6 and 7 :\n\n- the methods should be symmetrical : unbindThread should restore the Thread CCL after calling DirContextURLStreamHandler.unbind() and ContextBindings.unbindThread()\n- StandardContext.bindThread() should call DirContextURLStreamHandler.bindThread() instead of DirContextURLStreamHandler.bind()\n- StandardContext.unbindThread() should call DirContextURLStreamHandler.unbindThread() instead of DirContextURLStreamHandler.unbind()','2010-12-11 19:06:16','Sylvain Laurent','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','c263221','Sylvain Laurent','2010-12-11 19:16:33','bug 50459: StandardContext.bindThread() and unbindThread() are not symmetrical and not limited to current thread https://issues.apache.org/bugzilla/show_bug.cgi?id=50459','java/org/apache/catalina/core/StandardContext.java'),(1083,50459,'Bug 50459 – StandardContext.bindThread() and unbindThread() are not symmetrical and not limited to current thread','As a side effect of my commit, I think I found a bug in StandardContext.bindThread() and unbindThread() methods in both tomcat 6 and 7 :\n\n- the methods should be symmetrical : unbindThread should restore the Thread CCL after calling DirContextURLStreamHandler.unbind() and ContextBindings.unbindThread()\n- StandardContext.bindThread() should call DirContextURLStreamHandler.bindThread() instead of DirContextURLStreamHandler.bind()\n- StandardContext.unbindThread() should call DirContextURLStreamHandler.unbindThread() instead of DirContextURLStreamHandler.unbind()','2010-12-11 19:06:16','Sylvain Laurent','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','995ef1b','Sylvain Laurent','2010-12-11 19:10:39','bug 50459: StandardContext.bindThread() and unbindThread() are not symmetrical and not limited to current thread https://issues.apache.org/bugzilla/show_bug.cgi?id=50459','java/org/apache/catalina/core/StandardContext.java'),(1084,50459,'Bug 50459 – StandardContext.bindThread() and unbindThread() are not symmetrical and not limited to current thread','As a side effect of my commit, I think I found a bug in StandardContext.bindThread() and unbindThread() methods in both tomcat 6 and 7 :\n\n- the methods should be symmetrical : unbindThread should restore the Thread CCL after calling DirContextURLStreamHandler.unbind() and ContextBindings.unbindThread()\n- StandardContext.bindThread() should call DirContextURLStreamHandler.bindThread() instead of DirContextURLStreamHandler.bind()\n- StandardContext.unbindThread() should call DirContextURLStreamHandler.unbindThread() instead of DirContextURLStreamHandler.unbind()','2010-12-11 19:06:16','Sylvain Laurent','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','995ef1b','Sylvain Laurent','2010-12-11 19:10:39','bug 50459: StandardContext.bindThread() and unbindThread() are not symmetrical and not limited to current thread https://issues.apache.org/bugzilla/show_bug.cgi?id=50459','java/org/apache/catalina/core/StandardContext.java'),(1085,50448,'Bug 50448 – StandardSession.expire causes IllegalStateException: getCreationTime: Session already invalidated','Hi,\n\nwhen verifying the fix for #50360 I ran into an issue with expired sessions during processExpires:\n\nDec 10, 2010 12:59:32 AM org.apache.catalina.core.ContainerBase backgroundProcess\nWARNING: Exception processing manager de.javakaffee.web.msm.MemcachedBackupSessionManager[/] background process\njava.lang.IllegalStateException: getCreationTime: Session already invalidated\n	at org.apache.catalina.session.StandardSession.getCreationTime(StandardSession.java:1096)\n	at org.apache.catalina.session.ManagerBase.remove(ManagerBase.java:802)\n	at org.apache.catalina.session.StandardSession.expire(StandardSession.java:840)\n	at org.apache.catalina.session.StandardSession.isValid(StandardSession.java:655)\n	at org.apache.catalina.session.ManagerBase.processExpires(ManagerBase.java:609)\n	at org.apache.catalina.session.ManagerBase.backgroundProcess(ManagerBase.java:594)\n	at de.javakaffee.web.msm.MemcachedBackupSessionManager.backgroundProcess(MemcachedBackupSessionManager.java:1130)\n	at org.apache.catalina.core.ContainerBase.backgroundProcess(ContainerBase.java:1214)\n\nAFAICS in MemcachedBackupSessionManager I could override remove(Session session, boolean update) with calling super.remove(session, false) for invalid sessions.\n\nAnother option would be to change StandardSession.expire(StandardSession.java:840) so that it does not invoke manager.remove(this, true) but manager.remove(this, false).\n\nOr even better: change ManagerBase.remove(ManagerBase.java:802) to invoke some session.getCreationTimeInternal() which skips validation.\n\nWhat do you think?\n\nCheers,\nMartin','2010-12-09 19:23:29','Martin Grotzke','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','4117b78','Mark Emlyn David Thomas','2010-12-10 08:54:16','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50448 Regression caused by http://svn.apache.org/viewvc?view=revision&revision=1036281','java/org/apache/catalina/Session.java\njava/org/apache/catalina/manager/DummyProxySession.java\njava/org/apache/catalina/session/ManagerBase.java\njava/org/apache/catalina/session/StandardSession.java\nwebapps/docs/changelog.xml'),(1086,50413,'Bug 50413 – Tomcat returns 304 instead of 404 response for static custom 404 error file','','2010-12-05 07:34:55','Konstantin Preißer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 minor','44cf087','Mark Emlyn David Thomas','2010-12-10 05:11:38','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50413 Ensure 304s are not returned when using static files as error pages','java/org/apache/catalina/servlets/DefaultServlet.java\nwebapps/docs/changelog.xml'),(1087,49159,'Bug 49159 – Improve ThreadLocal memory leak clean-up','Doing this in a thread-safe way means performing the clean-up in the thread where the ThreadLocal exists. A likely point is just before the Thread gets returned to the pool.','2010-04-20 13:33:43','Mark Thomas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','e0d603a','Sylvain Laurent','2010-12-09 17:11:27','bug 49159: Improve ThreadLocal memory leak clean-up https://issues.apache.org/bugzilla/show_bug.cgi?id=49159','java/org/apache/catalina/core/StandardContext.java\njava/org/apache/tomcat/util/threads/DedicatedThreadExecutor.java\ntest/org/apache/tomcat/util/threads/DedicatedThreadExecutorTest.java'),(1088,49159,'Bug 49159 – Improve ThreadLocal memory leak clean-up','Doing this in a thread-safe way means performing the clean-up in the thread where the ThreadLocal exists. A likely point is just before the Thread gets returned to the pool.','2010-04-20 13:33:43','Mark Thomas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','e0d603a','Sylvain Laurent','2010-12-09 17:11:27','bug 49159: Improve ThreadLocal memory leak clean-up https://issues.apache.org/bugzilla/show_bug.cgi?id=49159','java/org/apache/catalina/core/StandardContext.java\njava/org/apache/tomcat/util/threads/DedicatedThreadExecutor.java\ntest/org/apache/tomcat/util/threads/DedicatedThreadExecutorTest.java'),(1089,50360,'Bug 50360 – Server socket still bound after Embedded.stop is invoked','After stopping an Embedded tomcat the server socket is still bound (in state LISTEN).\n\nThis test case fails:\n\n\nimport java.io.File;\nimport java.io.IOException;\nimport java.net.MalformedURLException;\nimport java.net.ServerSocket;\nimport java.net.UnknownHostException;\n\nimport org.apache.catalina.Context;\nimport org.apache.catalina.Engine;\nimport org.apache.catalina.Host;\nimport org.apache.catalina.LifecycleException;\nimport org.apache.catalina.LifecycleState;\nimport org.apache.catalina.connector.Connector;\nimport org.apache.catalina.session.StandardManager;\nimport org.apache.catalina.startup.Embedded;\nimport org.testng.Assert;\nimport org.testng.annotations.Test;\n\n\n@SuppressWarnings( \"deprecation\" )\npublic class TestEmbeddedStop {\n\n    @Test\n    public void testShutdown() throws Exception {\n        final int port = 18888;\n        final Embedded tomcat1 = createCatalina( port );\n        tomcat1.start();\n        tomcat1.stop();\n        try {\n            new ServerSocket( port );\n        } catch ( final IOException e ) {\n            Assert.fail( \"Could not open new server socket on port \" + port, e );\n        }\n    }\n\n    public static Embedded createCatalina( final int port ) throws MalformedURLException,\n            UnknownHostException, LifecycleException {\n\n        final Embedded catalina = new Embedded() {\n\n            @Override\n            // Workaround for #50358 - Embedded.stopInternal sets state to STARTING, should be STOPPING\n            protected void stopInternal() throws LifecycleException {\n                super.stopInternal();\n                setState(LifecycleState.STOPPING);\n            }\n\n        };\n\n        final Engine engine = catalina.createEngine();\n\n        engine.setName( \"engine-\" + port );\n        engine.setDefaultHost( \"localhost\" );\n\n        final String docBase = System.getProperty( \"java.io.tmpdir\" );\n        final Host host = catalina.createHost( \"localhost\", docBase );\n        engine.addChild( host );\n\n        final Context context = catalina.createContext( \"\", \"webapp\" );\n        host.addChild( context );\n        new File( docBase, \"webapp\" ).mkdirs();\n\n        context.setManager( new StandardManager() );\n\n        catalina.addEngine( engine );\n        engine.setService( catalina ); // needed to prevent NPE in ApplicationContext.populateSessionTrackingModes\n\n        final Connector connector = catalina.createConnector( \"localhost\", port, false );\n        catalina.addConnector( connector );\n\n        return catalina;\n    }\n\n}\n\n\nWhen  org.apache.catalina.connector.Connector.stopInternal is changed and sets the state to LifecycleState.MUST_DESTROY at the end this works as expected: the server socket is closed and free for further use.','2010-11-28 20:03:18','Martin Grotzke','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','ecd6e2f','Mark Emlyn David Thomas','2010-12-09 14:49:24','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50360 Add an option to control when the socket is bound','java/org/apache/tomcat/util/net/AbstractEndpoint.java\njava/org/apache/tomcat/util/net/AprEndpoint.java\njava/org/apache/tomcat/util/net/JIoEndpoint.java\njava/org/apache/tomcat/util/net/NioEndpoint.java\ntest/org/apache/tomcat/util/net/TestXxxEndpoint.java\nwebapps/docs/changelog.xml\nwebapps/docs/config/http.xml'),(1090,50360,'Bug 50360 – Server socket still bound after Embedded.stop is invoked','After stopping an Embedded tomcat the server socket is still bound (in state LISTEN).\n\nThis test case fails:\n\n\nimport java.io.File;\nimport java.io.IOException;\nimport java.net.MalformedURLException;\nimport java.net.ServerSocket;\nimport java.net.UnknownHostException;\n\nimport org.apache.catalina.Context;\nimport org.apache.catalina.Engine;\nimport org.apache.catalina.Host;\nimport org.apache.catalina.LifecycleException;\nimport org.apache.catalina.LifecycleState;\nimport org.apache.catalina.connector.Connector;\nimport org.apache.catalina.session.StandardManager;\nimport org.apache.catalina.startup.Embedded;\nimport org.testng.Assert;\nimport org.testng.annotations.Test;\n\n\n@SuppressWarnings( \"deprecation\" )\npublic class TestEmbeddedStop {\n\n    @Test\n    public void testShutdown() throws Exception {\n        final int port = 18888;\n        final Embedded tomcat1 = createCatalina( port );\n        tomcat1.start();\n        tomcat1.stop();\n        try {\n            new ServerSocket( port );\n        } catch ( final IOException e ) {\n            Assert.fail( \"Could not open new server socket on port \" + port, e );\n        }\n    }\n\n    public static Embedded createCatalina( final int port ) throws MalformedURLException,\n            UnknownHostException, LifecycleException {\n\n        final Embedded catalina = new Embedded() {\n\n            @Override\n            // Workaround for #50358 - Embedded.stopInternal sets state to STARTING, should be STOPPING\n            protected void stopInternal() throws LifecycleException {\n                super.stopInternal();\n                setState(LifecycleState.STOPPING);\n            }\n\n        };\n\n        final Engine engine = catalina.createEngine();\n\n        engine.setName( \"engine-\" + port );\n        engine.setDefaultHost( \"localhost\" );\n\n        final String docBase = System.getProperty( \"java.io.tmpdir\" );\n        final Host host = catalina.createHost( \"localhost\", docBase );\n        engine.addChild( host );\n\n        final Context context = catalina.createContext( \"\", \"webapp\" );\n        host.addChild( context );\n        new File( docBase, \"webapp\" ).mkdirs();\n\n        context.setManager( new StandardManager() );\n\n        catalina.addEngine( engine );\n        engine.setService( catalina ); // needed to prevent NPE in ApplicationContext.populateSessionTrackingModes\n\n        final Connector connector = catalina.createConnector( \"localhost\", port, false );\n        catalina.addConnector( connector );\n\n        return catalina;\n    }\n\n}\n\n\nWhen  org.apache.catalina.connector.Connector.stopInternal is changed and sets the state to LifecycleState.MUST_DESTROY at the end this works as expected: the server socket is closed and free for further use.','2010-11-28 20:03:18','Martin Grotzke','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','9a9fc38','Mark Emlyn David Thomas','2010-12-09 14:02:01','Re-factoring in support of https://issues.apache.org/bugzilla/show_bug.cgi?id=50360 Log the right message at the right point','java/org/apache/coyote/AbstractProtocolHandler.java'),(1091,49159,'Bug 49159 – Improve ThreadLocal memory leak clean-up','Doing this in a thread-safe way means performing the clean-up in the thread where the ThreadLocal exists. A likely point is just before the Thread gets returned to the pool.','2010-04-20 13:33:43','Mark Thomas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','b6ac721','Sylvain Laurent','2010-12-09 13:55:04','bug 49159: Improve ThreadLocal memory leak clean-up https://issues.apache.org/bugzilla/show_bug.cgi?id=49159','java/org/apache/catalina/core/ThreadLocalLeakPreventionListener.java'),(1092,49159,'Bug 49159 – Improve ThreadLocal memory leak clean-up','Doing this in a thread-safe way means performing the clean-up in the thread where the ThreadLocal exists. A likely point is just before the Thread gets returned to the pool.','2010-04-20 13:33:43','Mark Thomas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','b6ac721','Sylvain Laurent','2010-12-09 13:55:04','bug 49159: Improve ThreadLocal memory leak clean-up https://issues.apache.org/bugzilla/show_bug.cgi?id=49159','java/org/apache/catalina/core/ThreadLocalLeakPreventionListener.java'),(1093,50360,'Bug 50360 – Server socket still bound after Embedded.stop is invoked','After stopping an Embedded tomcat the server socket is still bound (in state LISTEN).\n\nThis test case fails:\n\n\nimport java.io.File;\nimport java.io.IOException;\nimport java.net.MalformedURLException;\nimport java.net.ServerSocket;\nimport java.net.UnknownHostException;\n\nimport org.apache.catalina.Context;\nimport org.apache.catalina.Engine;\nimport org.apache.catalina.Host;\nimport org.apache.catalina.LifecycleException;\nimport org.apache.catalina.LifecycleState;\nimport org.apache.catalina.connector.Connector;\nimport org.apache.catalina.session.StandardManager;\nimport org.apache.catalina.startup.Embedded;\nimport org.testng.Assert;\nimport org.testng.annotations.Test;\n\n\n@SuppressWarnings( \"deprecation\" )\npublic class TestEmbeddedStop {\n\n    @Test\n    public void testShutdown() throws Exception {\n        final int port = 18888;\n        final Embedded tomcat1 = createCatalina( port );\n        tomcat1.start();\n        tomcat1.stop();\n        try {\n            new ServerSocket( port );\n        } catch ( final IOException e ) {\n            Assert.fail( \"Could not open new server socket on port \" + port, e );\n        }\n    }\n\n    public static Embedded createCatalina( final int port ) throws MalformedURLException,\n            UnknownHostException, LifecycleException {\n\n        final Embedded catalina = new Embedded() {\n\n            @Override\n            // Workaround for #50358 - Embedded.stopInternal sets state to STARTING, should be STOPPING\n            protected void stopInternal() throws LifecycleException {\n                super.stopInternal();\n                setState(LifecycleState.STOPPING);\n            }\n\n        };\n\n        final Engine engine = catalina.createEngine();\n\n        engine.setName( \"engine-\" + port );\n        engine.setDefaultHost( \"localhost\" );\n\n        final String docBase = System.getProperty( \"java.io.tmpdir\" );\n        final Host host = catalina.createHost( \"localhost\", docBase );\n        engine.addChild( host );\n\n        final Context context = catalina.createContext( \"\", \"webapp\" );\n        host.addChild( context );\n        new File( docBase, \"webapp\" ).mkdirs();\n\n        context.setManager( new StandardManager() );\n\n        catalina.addEngine( engine );\n        engine.setService( catalina ); // needed to prevent NPE in ApplicationContext.populateSessionTrackingModes\n\n        final Connector connector = catalina.createConnector( \"localhost\", port, false );\n        catalina.addConnector( connector );\n\n        return catalina;\n    }\n\n}\n\n\nWhen  org.apache.catalina.connector.Connector.stopInternal is changed and sets the state to LifecycleState.MUST_DESTROY at the end this works as expected: the server socket is closed and free for further use.','2010-11-28 20:03:18','Martin Grotzke','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','3173d64','Mark Emlyn David Thomas','2010-12-09 13:10:38','Re-factoring in support of https://issues.apache.org/bugzilla/show_bug.cgi?id=50360 Move ad-hoc attribute handling from the ProtocolHandler to the Endpoint and expose the Endpoint to ServerSocketFactory objects so they can retrieve additional configuration if required. All default components now use explicit configuration rather than relying on the ad-hoc mechanism. Ensure the hooks for alternative SSL implementations are in place (were partially removed). Remove the hooks for alternative ServerSocketFactory implementations (had been hard-coded / half implemented for some time). Make the sslEnabledProtocols attribute work with BIO as well.','java/org/apache/catalina/connector/Connector.java\njava/org/apache/coyote/AbstractProtocolHandler.java\njava/org/apache/coyote/ProtocolHandler.java\njava/org/apache/coyote/ajp/AjpProtocol.java\njava/org/apache/coyote/http11/AbstractHttp11JsseProtocol.java\njava/org/apache/coyote/http11/AbstractHttp11Protocol.java\njava/org/apache/coyote/http11/Http11NioProtocol.java\njava/org/apache/coyote/http11/Http11Protocol.java\njava/org/apache/tomcat/util/net/AbstractEndpoint.java\njava/org/apache/tomcat/util/net/DefaultServerSocketFactory.java\njava/org/apache/tomcat/util/net/JIoEndpoint.java\njava/org/apache/tomcat/util/net/NioEndpoint.java\njava/org/apache/tomcat/util/net/SSLImplementation.java\njava/org/apache/tomcat/util/net/ServerSocketFactory.java\njava/org/apache/tomcat/util/net/jsse/JSSEFactory.java\njava/org/apache/tomcat/util/net/jsse/JSSEImplementation.java\njava/org/apache/tomcat/util/net/jsse/JSSESocketFactory.java\nwebapps/docs/config/http.xml'),(1094,50360,'Bug 50360 – Server socket still bound after Embedded.stop is invoked','After stopping an Embedded tomcat the server socket is still bound (in state LISTEN).\n\nThis test case fails:\n\n\nimport java.io.File;\nimport java.io.IOException;\nimport java.net.MalformedURLException;\nimport java.net.ServerSocket;\nimport java.net.UnknownHostException;\n\nimport org.apache.catalina.Context;\nimport org.apache.catalina.Engine;\nimport org.apache.catalina.Host;\nimport org.apache.catalina.LifecycleException;\nimport org.apache.catalina.LifecycleState;\nimport org.apache.catalina.connector.Connector;\nimport org.apache.catalina.session.StandardManager;\nimport org.apache.catalina.startup.Embedded;\nimport org.testng.Assert;\nimport org.testng.annotations.Test;\n\n\n@SuppressWarnings( \"deprecation\" )\npublic class TestEmbeddedStop {\n\n    @Test\n    public void testShutdown() throws Exception {\n        final int port = 18888;\n        final Embedded tomcat1 = createCatalina( port );\n        tomcat1.start();\n        tomcat1.stop();\n        try {\n            new ServerSocket( port );\n        } catch ( final IOException e ) {\n            Assert.fail( \"Could not open new server socket on port \" + port, e );\n        }\n    }\n\n    public static Embedded createCatalina( final int port ) throws MalformedURLException,\n            UnknownHostException, LifecycleException {\n\n        final Embedded catalina = new Embedded() {\n\n            @Override\n            // Workaround for #50358 - Embedded.stopInternal sets state to STARTING, should be STOPPING\n            protected void stopInternal() throws LifecycleException {\n                super.stopInternal();\n                setState(LifecycleState.STOPPING);\n            }\n\n        };\n\n        final Engine engine = catalina.createEngine();\n\n        engine.setName( \"engine-\" + port );\n        engine.setDefaultHost( \"localhost\" );\n\n        final String docBase = System.getProperty( \"java.io.tmpdir\" );\n        final Host host = catalina.createHost( \"localhost\", docBase );\n        engine.addChild( host );\n\n        final Context context = catalina.createContext( \"\", \"webapp\" );\n        host.addChild( context );\n        new File( docBase, \"webapp\" ).mkdirs();\n\n        context.setManager( new StandardManager() );\n\n        catalina.addEngine( engine );\n        engine.setService( catalina ); // needed to prevent NPE in ApplicationContext.populateSessionTrackingModes\n\n        final Connector connector = catalina.createConnector( \"localhost\", port, false );\n        catalina.addConnector( connector );\n\n        return catalina;\n    }\n\n}\n\n\nWhen  org.apache.catalina.connector.Connector.stopInternal is changed and sets the state to LifecycleState.MUST_DESTROY at the end this works as expected: the server socket is closed and free for further use.','2010-11-28 20:03:18','Martin Grotzke','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','b90da0e','Mark Emlyn David Thomas','2010-12-08 12:15:50','Re-factoring in support of https://issues.apache.org/bugzilla/show_bug.cgi?id=50360 ProtocolHandler should register itself with MBean server rather than have the connector do it.','checkstyle.xml\njava/org/apache/catalina/connector/Connector.java\njava/org/apache/catalina/connector/CoyoteAdapter.java\njava/org/apache/coyote/AbstractProtocolHandler.java\njava/org/apache/coyote/Adapter.java'),(1095,50360,'Bug 50360 – Server socket still bound after Embedded.stop is invoked','After stopping an Embedded tomcat the server socket is still bound (in state LISTEN).\n\nThis test case fails:\n\n\nimport java.io.File;\nimport java.io.IOException;\nimport java.net.MalformedURLException;\nimport java.net.ServerSocket;\nimport java.net.UnknownHostException;\n\nimport org.apache.catalina.Context;\nimport org.apache.catalina.Engine;\nimport org.apache.catalina.Host;\nimport org.apache.catalina.LifecycleException;\nimport org.apache.catalina.LifecycleState;\nimport org.apache.catalina.connector.Connector;\nimport org.apache.catalina.session.StandardManager;\nimport org.apache.catalina.startup.Embedded;\nimport org.testng.Assert;\nimport org.testng.annotations.Test;\n\n\n@SuppressWarnings( \"deprecation\" )\npublic class TestEmbeddedStop {\n\n    @Test\n    public void testShutdown() throws Exception {\n        final int port = 18888;\n        final Embedded tomcat1 = createCatalina( port );\n        tomcat1.start();\n        tomcat1.stop();\n        try {\n            new ServerSocket( port );\n        } catch ( final IOException e ) {\n            Assert.fail( \"Could not open new server socket on port \" + port, e );\n        }\n    }\n\n    public static Embedded createCatalina( final int port ) throws MalformedURLException,\n            UnknownHostException, LifecycleException {\n\n        final Embedded catalina = new Embedded() {\n\n            @Override\n            // Workaround for #50358 - Embedded.stopInternal sets state to STARTING, should be STOPPING\n            protected void stopInternal() throws LifecycleException {\n                super.stopInternal();\n                setState(LifecycleState.STOPPING);\n            }\n\n        };\n\n        final Engine engine = catalina.createEngine();\n\n        engine.setName( \"engine-\" + port );\n        engine.setDefaultHost( \"localhost\" );\n\n        final String docBase = System.getProperty( \"java.io.tmpdir\" );\n        final Host host = catalina.createHost( \"localhost\", docBase );\n        engine.addChild( host );\n\n        final Context context = catalina.createContext( \"\", \"webapp\" );\n        host.addChild( context );\n        new File( docBase, \"webapp\" ).mkdirs();\n\n        context.setManager( new StandardManager() );\n\n        catalina.addEngine( engine );\n        engine.setService( catalina ); // needed to prevent NPE in ApplicationContext.populateSessionTrackingModes\n\n        final Connector connector = catalina.createConnector( \"localhost\", port, false );\n        catalina.addConnector( connector );\n\n        return catalina;\n    }\n\n}\n\n\nWhen  org.apache.catalina.connector.Connector.stopInternal is changed and sets the state to LifecycleState.MUST_DESTROY at the end this works as expected: the server socket is closed and free for further use.','2010-11-28 20:03:18','Martin Grotzke','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','61df8cf','Mark Emlyn David Thomas','2010-12-08 09:51:10','Re-factoring in support of https://issues.apache.org/bugzilla/show_bug.cgi?id=50360 Pull up start()','java/org/apache/coyote/AbstractProtocolHandler.java\njava/org/apache/coyote/LocalStrings.properties\njava/org/apache/coyote/ajp/AjpAprProtocol.java\njava/org/apache/coyote/ajp/AjpProtocol.java\njava/org/apache/coyote/http11/Http11AprProtocol.java\njava/org/apache/coyote/http11/Http11NioProtocol.java\njava/org/apache/coyote/http11/Http11Protocol.java'),(1096,50360,'Bug 50360 – Server socket still bound after Embedded.stop is invoked','After stopping an Embedded tomcat the server socket is still bound (in state LISTEN).\n\nThis test case fails:\n\n\nimport java.io.File;\nimport java.io.IOException;\nimport java.net.MalformedURLException;\nimport java.net.ServerSocket;\nimport java.net.UnknownHostException;\n\nimport org.apache.catalina.Context;\nimport org.apache.catalina.Engine;\nimport org.apache.catalina.Host;\nimport org.apache.catalina.LifecycleException;\nimport org.apache.catalina.LifecycleState;\nimport org.apache.catalina.connector.Connector;\nimport org.apache.catalina.session.StandardManager;\nimport org.apache.catalina.startup.Embedded;\nimport org.testng.Assert;\nimport org.testng.annotations.Test;\n\n\n@SuppressWarnings( \"deprecation\" )\npublic class TestEmbeddedStop {\n\n    @Test\n    public void testShutdown() throws Exception {\n        final int port = 18888;\n        final Embedded tomcat1 = createCatalina( port );\n        tomcat1.start();\n        tomcat1.stop();\n        try {\n            new ServerSocket( port );\n        } catch ( final IOException e ) {\n            Assert.fail( \"Could not open new server socket on port \" + port, e );\n        }\n    }\n\n    public static Embedded createCatalina( final int port ) throws MalformedURLException,\n            UnknownHostException, LifecycleException {\n\n        final Embedded catalina = new Embedded() {\n\n            @Override\n            // Workaround for #50358 - Embedded.stopInternal sets state to STARTING, should be STOPPING\n            protected void stopInternal() throws LifecycleException {\n                super.stopInternal();\n                setState(LifecycleState.STOPPING);\n            }\n\n        };\n\n        final Engine engine = catalina.createEngine();\n\n        engine.setName( \"engine-\" + port );\n        engine.setDefaultHost( \"localhost\" );\n\n        final String docBase = System.getProperty( \"java.io.tmpdir\" );\n        final Host host = catalina.createHost( \"localhost\", docBase );\n        engine.addChild( host );\n\n        final Context context = catalina.createContext( \"\", \"webapp\" );\n        host.addChild( context );\n        new File( docBase, \"webapp\" ).mkdirs();\n\n        context.setManager( new StandardManager() );\n\n        catalina.addEngine( engine );\n        engine.setService( catalina ); // needed to prevent NPE in ApplicationContext.populateSessionTrackingModes\n\n        final Connector connector = catalina.createConnector( \"localhost\", port, false );\n        catalina.addConnector( connector );\n\n        return catalina;\n    }\n\n}\n\n\nWhen  org.apache.catalina.connector.Connector.stopInternal is changed and sets the state to LifecycleState.MUST_DESTROY at the end this works as expected: the server socket is closed and free for further use.','2010-11-28 20:03:18','Martin Grotzke','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','644821a','Mark Emlyn David Thomas','2010-12-08 09:36:26','Re-factoring in support of https://issues.apache.org/bugzilla/show_bug.cgi?id=50360 Move MBean registration from start() to init(). More MBean refactoring expected','java/org/apache/coyote/AbstractProtocolHandler.java\njava/org/apache/coyote/LocalStrings.properties\njava/org/apache/coyote/ajp/AjpAprProtocol.java\njava/org/apache/coyote/ajp/AjpProtocol.java\njava/org/apache/coyote/http11/Http11AprProtocol.java\njava/org/apache/coyote/http11/Http11NioProtocol.java\njava/org/apache/coyote/http11/Http11Protocol.java'),(1097,50360,'Bug 50360 – Server socket still bound after Embedded.stop is invoked','After stopping an Embedded tomcat the server socket is still bound (in state LISTEN).\n\nThis test case fails:\n\n\nimport java.io.File;\nimport java.io.IOException;\nimport java.net.MalformedURLException;\nimport java.net.ServerSocket;\nimport java.net.UnknownHostException;\n\nimport org.apache.catalina.Context;\nimport org.apache.catalina.Engine;\nimport org.apache.catalina.Host;\nimport org.apache.catalina.LifecycleException;\nimport org.apache.catalina.LifecycleState;\nimport org.apache.catalina.connector.Connector;\nimport org.apache.catalina.session.StandardManager;\nimport org.apache.catalina.startup.Embedded;\nimport org.testng.Assert;\nimport org.testng.annotations.Test;\n\n\n@SuppressWarnings( \"deprecation\" )\npublic class TestEmbeddedStop {\n\n    @Test\n    public void testShutdown() throws Exception {\n        final int port = 18888;\n        final Embedded tomcat1 = createCatalina( port );\n        tomcat1.start();\n        tomcat1.stop();\n        try {\n            new ServerSocket( port );\n        } catch ( final IOException e ) {\n            Assert.fail( \"Could not open new server socket on port \" + port, e );\n        }\n    }\n\n    public static Embedded createCatalina( final int port ) throws MalformedURLException,\n            UnknownHostException, LifecycleException {\n\n        final Embedded catalina = new Embedded() {\n\n            @Override\n            // Workaround for #50358 - Embedded.stopInternal sets state to STARTING, should be STOPPING\n            protected void stopInternal() throws LifecycleException {\n                super.stopInternal();\n                setState(LifecycleState.STOPPING);\n            }\n\n        };\n\n        final Engine engine = catalina.createEngine();\n\n        engine.setName( \"engine-\" + port );\n        engine.setDefaultHost( \"localhost\" );\n\n        final String docBase = System.getProperty( \"java.io.tmpdir\" );\n        final Host host = catalina.createHost( \"localhost\", docBase );\n        engine.addChild( host );\n\n        final Context context = catalina.createContext( \"\", \"webapp\" );\n        host.addChild( context );\n        new File( docBase, \"webapp\" ).mkdirs();\n\n        context.setManager( new StandardManager() );\n\n        catalina.addEngine( engine );\n        engine.setService( catalina ); // needed to prevent NPE in ApplicationContext.populateSessionTrackingModes\n\n        final Connector connector = catalina.createConnector( \"localhost\", port, false );\n        catalina.addConnector( connector );\n\n        return catalina;\n    }\n\n}\n\n\nWhen  org.apache.catalina.connector.Connector.stopInternal is changed and sets the state to LifecycleState.MUST_DESTROY at the end this works as expected: the server socket is closed and free for further use.','2010-11-28 20:03:18','Martin Grotzke','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','4216fbd','Mark Emlyn David Thomas','2010-12-08 09:19:23','Re-factoring in support of https://issues.apache.org/bugzilla/show_bug.cgi?id=50360 Pull up init()','java/org/apache/coyote/AbstractProtocolHandler.java\njava/org/apache/coyote/LocalStrings.properties\njava/org/apache/coyote/ajp/AjpAprProtocol.java\njava/org/apache/coyote/ajp/AjpProtocol.java\njava/org/apache/coyote/ajp/LocalStrings.properties\njava/org/apache/coyote/ajp/LocalStrings_es.properties\njava/org/apache/coyote/http11/AbstractHttp11JsseProtocol.java\njava/org/apache/coyote/http11/Http11AprProtocol.java\njava/org/apache/coyote/http11/Http11NioProtocol.java\njava/org/apache/coyote/http11/Http11Protocol.java\njava/org/apache/coyote/http11/LocalStrings.properties\njava/org/apache/coyote/http11/LocalStrings_es.properties\njava/org/apache/coyote/http11/LocalStrings_fr.properties\njava/org/apache/coyote/http11/LocalStrings_ja.properties'),(1098,50360,'Bug 50360 – Server socket still bound after Embedded.stop is invoked','After stopping an Embedded tomcat the server socket is still bound (in state LISTEN).\n\nThis test case fails:\n\n\nimport java.io.File;\nimport java.io.IOException;\nimport java.net.MalformedURLException;\nimport java.net.ServerSocket;\nimport java.net.UnknownHostException;\n\nimport org.apache.catalina.Context;\nimport org.apache.catalina.Engine;\nimport org.apache.catalina.Host;\nimport org.apache.catalina.LifecycleException;\nimport org.apache.catalina.LifecycleState;\nimport org.apache.catalina.connector.Connector;\nimport org.apache.catalina.session.StandardManager;\nimport org.apache.catalina.startup.Embedded;\nimport org.testng.Assert;\nimport org.testng.annotations.Test;\n\n\n@SuppressWarnings( \"deprecation\" )\npublic class TestEmbeddedStop {\n\n    @Test\n    public void testShutdown() throws Exception {\n        final int port = 18888;\n        final Embedded tomcat1 = createCatalina( port );\n        tomcat1.start();\n        tomcat1.stop();\n        try {\n            new ServerSocket( port );\n        } catch ( final IOException e ) {\n            Assert.fail( \"Could not open new server socket on port \" + port, e );\n        }\n    }\n\n    public static Embedded createCatalina( final int port ) throws MalformedURLException,\n            UnknownHostException, LifecycleException {\n\n        final Embedded catalina = new Embedded() {\n\n            @Override\n            // Workaround for #50358 - Embedded.stopInternal sets state to STARTING, should be STOPPING\n            protected void stopInternal() throws LifecycleException {\n                super.stopInternal();\n                setState(LifecycleState.STOPPING);\n            }\n\n        };\n\n        final Engine engine = catalina.createEngine();\n\n        engine.setName( \"engine-\" + port );\n        engine.setDefaultHost( \"localhost\" );\n\n        final String docBase = System.getProperty( \"java.io.tmpdir\" );\n        final Host host = catalina.createHost( \"localhost\", docBase );\n        engine.addChild( host );\n\n        final Context context = catalina.createContext( \"\", \"webapp\" );\n        host.addChild( context );\n        new File( docBase, \"webapp\" ).mkdirs();\n\n        context.setManager( new StandardManager() );\n\n        catalina.addEngine( engine );\n        engine.setService( catalina ); // needed to prevent NPE in ApplicationContext.populateSessionTrackingModes\n\n        final Connector connector = catalina.createConnector( \"localhost\", port, false );\n        catalina.addConnector( connector );\n\n        return catalina;\n    }\n\n}\n\n\nWhen  org.apache.catalina.connector.Connector.stopInternal is changed and sets the state to LifecycleState.MUST_DESTROY at the end this works as expected: the server socket is closed and free for further use.','2010-11-28 20:03:18','Martin Grotzke','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','837a88f','Mark Emlyn David Thomas','2010-12-08 08:37:11','Re-factoring in support of https://issues.apache.org/bugzilla/show_bug.cgi?id=50360 Align the init() methods (JSSE still to go)','java/org/apache/coyote/ajp/AjpAprProtocol.java\njava/org/apache/coyote/ajp/AjpProtocol.java\njava/org/apache/coyote/ajp/Constants.java\njava/org/apache/coyote/http11/Http11AprProtocol.java\njava/org/apache/coyote/http11/Http11NioProtocol.java\njava/org/apache/coyote/http11/Http11Protocol.java'),(1099,50360,'Bug 50360 – Server socket still bound after Embedded.stop is invoked','After stopping an Embedded tomcat the server socket is still bound (in state LISTEN).\n\nThis test case fails:\n\n\nimport java.io.File;\nimport java.io.IOException;\nimport java.net.MalformedURLException;\nimport java.net.ServerSocket;\nimport java.net.UnknownHostException;\n\nimport org.apache.catalina.Context;\nimport org.apache.catalina.Engine;\nimport org.apache.catalina.Host;\nimport org.apache.catalina.LifecycleException;\nimport org.apache.catalina.LifecycleState;\nimport org.apache.catalina.connector.Connector;\nimport org.apache.catalina.session.StandardManager;\nimport org.apache.catalina.startup.Embedded;\nimport org.testng.Assert;\nimport org.testng.annotations.Test;\n\n\n@SuppressWarnings( \"deprecation\" )\npublic class TestEmbeddedStop {\n\n    @Test\n    public void testShutdown() throws Exception {\n        final int port = 18888;\n        final Embedded tomcat1 = createCatalina( port );\n        tomcat1.start();\n        tomcat1.stop();\n        try {\n            new ServerSocket( port );\n        } catch ( final IOException e ) {\n            Assert.fail( \"Could not open new server socket on port \" + port, e );\n        }\n    }\n\n    public static Embedded createCatalina( final int port ) throws MalformedURLException,\n            UnknownHostException, LifecycleException {\n\n        final Embedded catalina = new Embedded() {\n\n            @Override\n            // Workaround for #50358 - Embedded.stopInternal sets state to STARTING, should be STOPPING\n            protected void stopInternal() throws LifecycleException {\n                super.stopInternal();\n                setState(LifecycleState.STOPPING);\n            }\n\n        };\n\n        final Engine engine = catalina.createEngine();\n\n        engine.setName( \"engine-\" + port );\n        engine.setDefaultHost( \"localhost\" );\n\n        final String docBase = System.getProperty( \"java.io.tmpdir\" );\n        final Host host = catalina.createHost( \"localhost\", docBase );\n        engine.addChild( host );\n\n        final Context context = catalina.createContext( \"\", \"webapp\" );\n        host.addChild( context );\n        new File( docBase, \"webapp\" ).mkdirs();\n\n        context.setManager( new StandardManager() );\n\n        catalina.addEngine( engine );\n        engine.setService( catalina ); // needed to prevent NPE in ApplicationContext.populateSessionTrackingModes\n\n        final Connector connector = catalina.createConnector( \"localhost\", port, false );\n        catalina.addConnector( connector );\n\n        return catalina;\n    }\n\n}\n\n\nWhen  org.apache.catalina.connector.Connector.stopInternal is changed and sets the state to LifecycleState.MUST_DESTROY at the end this works as expected: the server socket is closed and free for further use.','2010-11-28 20:03:18','Martin Grotzke','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','0c99818','Mark Emlyn David Thomas','2010-12-08 08:06:46','Re-factoring in support of https://issues.apache.org/bugzilla/show_bug.cgi?id=50360 Pull up stop()','java/org/apache/coyote/AbstractProtocolHandler.java\njava/org/apache/coyote/ajp/AbstractAjpProtocol.java\njava/org/apache/coyote/ajp/LocalStrings.properties\njava/org/apache/coyote/ajp/LocalStrings_es.properties\njava/org/apache/coyote/http11/AbstractHttp11Protocol.java\njava/org/apache/coyote/http11/LocalStrings.properties\njava/org/apache/coyote/http11/LocalStrings_es.properties\njava/org/apache/coyote/http11/LocalStrings_fr.properties\njava/org/apache/coyote/http11/LocalStrings_ja.properties'),(1100,50360,'Bug 50360 – Server socket still bound after Embedded.stop is invoked','After stopping an Embedded tomcat the server socket is still bound (in state LISTEN).\n\nThis test case fails:\n\n\nimport java.io.File;\nimport java.io.IOException;\nimport java.net.MalformedURLException;\nimport java.net.ServerSocket;\nimport java.net.UnknownHostException;\n\nimport org.apache.catalina.Context;\nimport org.apache.catalina.Engine;\nimport org.apache.catalina.Host;\nimport org.apache.catalina.LifecycleException;\nimport org.apache.catalina.LifecycleState;\nimport org.apache.catalina.connector.Connector;\nimport org.apache.catalina.session.StandardManager;\nimport org.apache.catalina.startup.Embedded;\nimport org.testng.Assert;\nimport org.testng.annotations.Test;\n\n\n@SuppressWarnings( \"deprecation\" )\npublic class TestEmbeddedStop {\n\n    @Test\n    public void testShutdown() throws Exception {\n        final int port = 18888;\n        final Embedded tomcat1 = createCatalina( port );\n        tomcat1.start();\n        tomcat1.stop();\n        try {\n            new ServerSocket( port );\n        } catch ( final IOException e ) {\n            Assert.fail( \"Could not open new server socket on port \" + port, e );\n        }\n    }\n\n    public static Embedded createCatalina( final int port ) throws MalformedURLException,\n            UnknownHostException, LifecycleException {\n\n        final Embedded catalina = new Embedded() {\n\n            @Override\n            // Workaround for #50358 - Embedded.stopInternal sets state to STARTING, should be STOPPING\n            protected void stopInternal() throws LifecycleException {\n                super.stopInternal();\n                setState(LifecycleState.STOPPING);\n            }\n\n        };\n\n        final Engine engine = catalina.createEngine();\n\n        engine.setName( \"engine-\" + port );\n        engine.setDefaultHost( \"localhost\" );\n\n        final String docBase = System.getProperty( \"java.io.tmpdir\" );\n        final Host host = catalina.createHost( \"localhost\", docBase );\n        engine.addChild( host );\n\n        final Context context = catalina.createContext( \"\", \"webapp\" );\n        host.addChild( context );\n        new File( docBase, \"webapp\" ).mkdirs();\n\n        context.setManager( new StandardManager() );\n\n        catalina.addEngine( engine );\n        engine.setService( catalina ); // needed to prevent NPE in ApplicationContext.populateSessionTrackingModes\n\n        final Connector connector = catalina.createConnector( \"localhost\", port, false );\n        catalina.addConnector( connector );\n\n        return catalina;\n    }\n\n}\n\n\nWhen  org.apache.catalina.connector.Connector.stopInternal is changed and sets the state to LifecycleState.MUST_DESTROY at the end this works as expected: the server socket is closed and free for further use.','2010-11-28 20:03:18','Martin Grotzke','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','eab872b','Mark Emlyn David Thomas','2010-12-08 07:57:54','Re-factoring in support of https://issues.apache.org/bugzilla/show_bug.cgi?id=50360 Pull up pause() and resume() methods','java/org/apache/coyote/AbstractProtocolHandler.java\njava/org/apache/coyote/LocalStrings.properties\njava/org/apache/coyote/ajp/AbstractAjpProtocol.java\njava/org/apache/coyote/ajp/LocalStrings.properties\njava/org/apache/coyote/ajp/LocalStrings_es.properties\njava/org/apache/coyote/http11/AbstractHttp11Protocol.java\njava/org/apache/coyote/http11/LocalStrings.properties\njava/org/apache/coyote/http11/LocalStrings_es.properties\njava/org/apache/coyote/http11/LocalStrings_fr.properties\njava/org/apache/coyote/http11/LocalStrings_ja.properties'),(1101,50360,'Bug 50360 – Server socket still bound after Embedded.stop is invoked','After stopping an Embedded tomcat the server socket is still bound (in state LISTEN).\n\nThis test case fails:\n\n\nimport java.io.File;\nimport java.io.IOException;\nimport java.net.MalformedURLException;\nimport java.net.ServerSocket;\nimport java.net.UnknownHostException;\n\nimport org.apache.catalina.Context;\nimport org.apache.catalina.Engine;\nimport org.apache.catalina.Host;\nimport org.apache.catalina.LifecycleException;\nimport org.apache.catalina.LifecycleState;\nimport org.apache.catalina.connector.Connector;\nimport org.apache.catalina.session.StandardManager;\nimport org.apache.catalina.startup.Embedded;\nimport org.testng.Assert;\nimport org.testng.annotations.Test;\n\n\n@SuppressWarnings( \"deprecation\" )\npublic class TestEmbeddedStop {\n\n    @Test\n    public void testShutdown() throws Exception {\n        final int port = 18888;\n        final Embedded tomcat1 = createCatalina( port );\n        tomcat1.start();\n        tomcat1.stop();\n        try {\n            new ServerSocket( port );\n        } catch ( final IOException e ) {\n            Assert.fail( \"Could not open new server socket on port \" + port, e );\n        }\n    }\n\n    public static Embedded createCatalina( final int port ) throws MalformedURLException,\n            UnknownHostException, LifecycleException {\n\n        final Embedded catalina = new Embedded() {\n\n            @Override\n            // Workaround for #50358 - Embedded.stopInternal sets state to STARTING, should be STOPPING\n            protected void stopInternal() throws LifecycleException {\n                super.stopInternal();\n                setState(LifecycleState.STOPPING);\n            }\n\n        };\n\n        final Engine engine = catalina.createEngine();\n\n        engine.setName( \"engine-\" + port );\n        engine.setDefaultHost( \"localhost\" );\n\n        final String docBase = System.getProperty( \"java.io.tmpdir\" );\n        final Host host = catalina.createHost( \"localhost\", docBase );\n        engine.addChild( host );\n\n        final Context context = catalina.createContext( \"\", \"webapp\" );\n        host.addChild( context );\n        new File( docBase, \"webapp\" ).mkdirs();\n\n        context.setManager( new StandardManager() );\n\n        catalina.addEngine( engine );\n        engine.setService( catalina ); // needed to prevent NPE in ApplicationContext.populateSessionTrackingModes\n\n        final Connector connector = catalina.createConnector( \"localhost\", port, false );\n        catalina.addConnector( connector );\n\n        return catalina;\n    }\n\n}\n\n\nWhen  org.apache.catalina.connector.Connector.stopInternal is changed and sets the state to LifecycleState.MUST_DESTROY at the end this works as expected: the server socket is closed and free for further use.','2010-11-28 20:03:18','Martin Grotzke','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','9d1f121','Mark Emlyn David Thomas','2010-12-06 19:08:38','Re-factoring in support of https://issues.apache.org/bugzilla/show_bug.cgi?id=50360 Pull up the concrete destroy() method - required a fair bit of refactoring Pull up the abstract init() method()','java/org/apache/coyote/AbstractProtocolHandler.java\njava/org/apache/coyote/LocalStrings.properties\njava/org/apache/coyote/ajp/AbstractAjpProtocol.java\njava/org/apache/coyote/ajp/AjpAprProtocol.java\njava/org/apache/coyote/ajp/AjpProtocol.java\njava/org/apache/coyote/ajp/LocalStrings.properties\njava/org/apache/coyote/http11/AbstractHttp11Protocol.java\njava/org/apache/coyote/http11/Http11AprProtocol.java\njava/org/apache/coyote/http11/Http11NioProtocol.java\njava/org/apache/coyote/http11/Http11Protocol.java\njava/org/apache/tomcat/util/net/AbstractEndpoint.java\njava/org/apache/tomcat/util/net/AprEndpoint.java\njava/org/apache/tomcat/util/net/JIoEndpoint.java\njava/org/apache/tomcat/util/net/NioEndpoint.java'),(1102,50360,'Bug 50360 – Server socket still bound after Embedded.stop is invoked','After stopping an Embedded tomcat the server socket is still bound (in state LISTEN).\n\nThis test case fails:\n\n\nimport java.io.File;\nimport java.io.IOException;\nimport java.net.MalformedURLException;\nimport java.net.ServerSocket;\nimport java.net.UnknownHostException;\n\nimport org.apache.catalina.Context;\nimport org.apache.catalina.Engine;\nimport org.apache.catalina.Host;\nimport org.apache.catalina.LifecycleException;\nimport org.apache.catalina.LifecycleState;\nimport org.apache.catalina.connector.Connector;\nimport org.apache.catalina.session.StandardManager;\nimport org.apache.catalina.startup.Embedded;\nimport org.testng.Assert;\nimport org.testng.annotations.Test;\n\n\n@SuppressWarnings( \"deprecation\" )\npublic class TestEmbeddedStop {\n\n    @Test\n    public void testShutdown() throws Exception {\n        final int port = 18888;\n        final Embedded tomcat1 = createCatalina( port );\n        tomcat1.start();\n        tomcat1.stop();\n        try {\n            new ServerSocket( port );\n        } catch ( final IOException e ) {\n            Assert.fail( \"Could not open new server socket on port \" + port, e );\n        }\n    }\n\n    public static Embedded createCatalina( final int port ) throws MalformedURLException,\n            UnknownHostException, LifecycleException {\n\n        final Embedded catalina = new Embedded() {\n\n            @Override\n            // Workaround for #50358 - Embedded.stopInternal sets state to STARTING, should be STOPPING\n            protected void stopInternal() throws LifecycleException {\n                super.stopInternal();\n                setState(LifecycleState.STOPPING);\n            }\n\n        };\n\n        final Engine engine = catalina.createEngine();\n\n        engine.setName( \"engine-\" + port );\n        engine.setDefaultHost( \"localhost\" );\n\n        final String docBase = System.getProperty( \"java.io.tmpdir\" );\n        final Host host = catalina.createHost( \"localhost\", docBase );\n        engine.addChild( host );\n\n        final Context context = catalina.createContext( \"\", \"webapp\" );\n        host.addChild( context );\n        new File( docBase, \"webapp\" ).mkdirs();\n\n        context.setManager( new StandardManager() );\n\n        catalina.addEngine( engine );\n        engine.setService( catalina ); // needed to prevent NPE in ApplicationContext.populateSessionTrackingModes\n\n        final Connector connector = catalina.createConnector( \"localhost\", port, false );\n        catalina.addConnector( connector );\n\n        return catalina;\n    }\n\n}\n\n\nWhen  org.apache.catalina.connector.Connector.stopInternal is changed and sets the state to LifecycleState.MUST_DESTROY at the end this works as expected: the server socket is closed and free for further use.','2010-11-28 20:03:18','Martin Grotzke','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','76a9855','Mark Emlyn David Thomas','2010-12-06 18:22:44','Re-factoring in support of https://issues.apache.org/bugzilla/show_bug.cgi?id=50360 Add the necessary plumbing for the AbstractProtocolHandler to perform the JMX registration','java/org/apache/coyote/AbstractProtocolHandler.java\njava/org/apache/coyote/ajp/AjpAprProtocol.java\njava/org/apache/coyote/ajp/AjpProtocol.java\njava/org/apache/coyote/http11/Http11AprProtocol.java\njava/org/apache/coyote/http11/Http11NioProtocol.java\njava/org/apache/coyote/http11/Http11Protocol.java\njava/org/apache/tomcat/util/net/AbstractEndpoint.java\njava/org/apache/tomcat/util/net/JIoEndpoint.java'),(1103,50360,'Bug 50360 – Server socket still bound after Embedded.stop is invoked','After stopping an Embedded tomcat the server socket is still bound (in state LISTEN).\n\nThis test case fails:\n\n\nimport java.io.File;\nimport java.io.IOException;\nimport java.net.MalformedURLException;\nimport java.net.ServerSocket;\nimport java.net.UnknownHostException;\n\nimport org.apache.catalina.Context;\nimport org.apache.catalina.Engine;\nimport org.apache.catalina.Host;\nimport org.apache.catalina.LifecycleException;\nimport org.apache.catalina.LifecycleState;\nimport org.apache.catalina.connector.Connector;\nimport org.apache.catalina.session.StandardManager;\nimport org.apache.catalina.startup.Embedded;\nimport org.testng.Assert;\nimport org.testng.annotations.Test;\n\n\n@SuppressWarnings( \"deprecation\" )\npublic class TestEmbeddedStop {\n\n    @Test\n    public void testShutdown() throws Exception {\n        final int port = 18888;\n        final Embedded tomcat1 = createCatalina( port );\n        tomcat1.start();\n        tomcat1.stop();\n        try {\n            new ServerSocket( port );\n        } catch ( final IOException e ) {\n            Assert.fail( \"Could not open new server socket on port \" + port, e );\n        }\n    }\n\n    public static Embedded createCatalina( final int port ) throws MalformedURLException,\n            UnknownHostException, LifecycleException {\n\n        final Embedded catalina = new Embedded() {\n\n            @Override\n            // Workaround for #50358 - Embedded.stopInternal sets state to STARTING, should be STOPPING\n            protected void stopInternal() throws LifecycleException {\n                super.stopInternal();\n                setState(LifecycleState.STOPPING);\n            }\n\n        };\n\n        final Engine engine = catalina.createEngine();\n\n        engine.setName( \"engine-\" + port );\n        engine.setDefaultHost( \"localhost\" );\n\n        final String docBase = System.getProperty( \"java.io.tmpdir\" );\n        final Host host = catalina.createHost( \"localhost\", docBase );\n        engine.addChild( host );\n\n        final Context context = catalina.createContext( \"\", \"webapp\" );\n        host.addChild( context );\n        new File( docBase, \"webapp\" ).mkdirs();\n\n        context.setManager( new StandardManager() );\n\n        catalina.addEngine( engine );\n        engine.setService( catalina ); // needed to prevent NPE in ApplicationContext.populateSessionTrackingModes\n\n        final Connector connector = catalina.createConnector( \"localhost\", port, false );\n        catalina.addConnector( connector );\n\n        return catalina;\n    }\n\n}\n\n\nWhen  org.apache.catalina.connector.Connector.stopInternal is changed and sets the state to LifecycleState.MUST_DESTROY at the end this works as expected: the server socket is closed and free for further use.','2010-11-28 20:03:18','Martin Grotzke','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','c3635ff','Mark Emlyn David Thomas','2010-12-06 17:06:52','Re-factoring in support of https://issues.apache.org/bugzilla/show_bug.cgi?id=50360 Pull up JMX related methods Tidy up the remaining protocol specific methods','java/org/apache/coyote/AbstractProtocolHandler.java\njava/org/apache/coyote/ajp/AbstractAjpProtocol.java\njava/org/apache/coyote/http11/AbstractHttp11JsseProtocol.java\njava/org/apache/coyote/http11/AbstractHttp11Protocol.java'),(1104,49159,'Bug 49159 – Improve ThreadLocal memory leak clean-up','Doing this in a thread-safe way means performing the clean-up in the thread where the ThreadLocal exists. A likely point is just before the Thread gets returned to the pool.','2010-04-20 13:33:43','Mark Thomas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','8e6eac6','Sylvain Laurent','2010-12-06 15:49:14','bug 49159: Improve ThreadLocal memory leak clean-up https://issues.apache.org/bugzilla/show_bug.cgi?id=49159','java/org/apache/catalina/core/LocalStrings.properties\njava/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/core/StandardThreadExecutor.java\njava/org/apache/catalina/core/ThreadLocalLeakPreventionListener.java\njava/org/apache/catalina/loader/WebappClassLoader.java\njava/org/apache/tomcat/util/threads/Constants.java\njava/org/apache/tomcat/util/threads/TaskQueue.java\njava/org/apache/tomcat/util/threads/TaskThread.java\njava/org/apache/tomcat/util/threads/ThreadPoolExecutor.java'),(1105,49159,'Bug 49159 – Improve ThreadLocal memory leak clean-up','Doing this in a thread-safe way means performing the clean-up in the thread where the ThreadLocal exists. A likely point is just before the Thread gets returned to the pool.','2010-04-20 13:33:43','Mark Thomas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','8e6eac6','Sylvain Laurent','2010-12-06 15:49:14','bug 49159: Improve ThreadLocal memory leak clean-up https://issues.apache.org/bugzilla/show_bug.cgi?id=49159','java/org/apache/catalina/core/LocalStrings.properties\njava/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/core/StandardThreadExecutor.java\njava/org/apache/catalina/core/ThreadLocalLeakPreventionListener.java\njava/org/apache/catalina/loader/WebappClassLoader.java\njava/org/apache/tomcat/util/threads/Constants.java\njava/org/apache/tomcat/util/threads/TaskQueue.java\njava/org/apache/tomcat/util/threads/TaskThread.java\njava/org/apache/tomcat/util/threads/ThreadPoolExecutor.java'),(1106,50360,'Bug 50360 – Server socket still bound after Embedded.stop is invoked','After stopping an Embedded tomcat the server socket is still bound (in state LISTEN).\n\nThis test case fails:\n\n\nimport java.io.File;\nimport java.io.IOException;\nimport java.net.MalformedURLException;\nimport java.net.ServerSocket;\nimport java.net.UnknownHostException;\n\nimport org.apache.catalina.Context;\nimport org.apache.catalina.Engine;\nimport org.apache.catalina.Host;\nimport org.apache.catalina.LifecycleException;\nimport org.apache.catalina.LifecycleState;\nimport org.apache.catalina.connector.Connector;\nimport org.apache.catalina.session.StandardManager;\nimport org.apache.catalina.startup.Embedded;\nimport org.testng.Assert;\nimport org.testng.annotations.Test;\n\n\n@SuppressWarnings( \"deprecation\" )\npublic class TestEmbeddedStop {\n\n    @Test\n    public void testShutdown() throws Exception {\n        final int port = 18888;\n        final Embedded tomcat1 = createCatalina( port );\n        tomcat1.start();\n        tomcat1.stop();\n        try {\n            new ServerSocket( port );\n        } catch ( final IOException e ) {\n            Assert.fail( \"Could not open new server socket on port \" + port, e );\n        }\n    }\n\n    public static Embedded createCatalina( final int port ) throws MalformedURLException,\n            UnknownHostException, LifecycleException {\n\n        final Embedded catalina = new Embedded() {\n\n            @Override\n            // Workaround for #50358 - Embedded.stopInternal sets state to STARTING, should be STOPPING\n            protected void stopInternal() throws LifecycleException {\n                super.stopInternal();\n                setState(LifecycleState.STOPPING);\n            }\n\n        };\n\n        final Engine engine = catalina.createEngine();\n\n        engine.setName( \"engine-\" + port );\n        engine.setDefaultHost( \"localhost\" );\n\n        final String docBase = System.getProperty( \"java.io.tmpdir\" );\n        final Host host = catalina.createHost( \"localhost\", docBase );\n        engine.addChild( host );\n\n        final Context context = catalina.createContext( \"\", \"webapp\" );\n        host.addChild( context );\n        new File( docBase, \"webapp\" ).mkdirs();\n\n        context.setManager( new StandardManager() );\n\n        catalina.addEngine( engine );\n        engine.setService( catalina ); // needed to prevent NPE in ApplicationContext.populateSessionTrackingModes\n\n        final Connector connector = catalina.createConnector( \"localhost\", port, false );\n        catalina.addConnector( connector );\n\n        return catalina;\n    }\n\n}\n\n\nWhen  org.apache.catalina.connector.Connector.stopInternal is changed and sets the state to LifecycleState.MUST_DESTROY at the end this works as expected: the server socket is closed and free for further use.','2010-11-28 20:03:18','Martin Grotzke','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','efebfd2','Mark Emlyn David Thomas','2010-12-06 12:16:53','Re-factoring in support of https://issues.apache.org/bugzilla/show_bug.cgi?id=50360 Pull up timeout getters/setters. Use -1 consistently for the default value of keepAliveTimeout','java/org/apache/coyote/AbstractProtocolHandler.java\njava/org/apache/coyote/ajp/AbstractAjpProtocol.java\njava/org/apache/coyote/ajp/AjpProtocol.java\njava/org/apache/coyote/http11/AbstractHttp11Protocol.java\njava/org/apache/tomcat/util/net/AbstractEndpoint.java'),(1107,50360,'Bug 50360 – Server socket still bound after Embedded.stop is invoked','After stopping an Embedded tomcat the server socket is still bound (in state LISTEN).\n\nThis test case fails:\n\n\nimport java.io.File;\nimport java.io.IOException;\nimport java.net.MalformedURLException;\nimport java.net.ServerSocket;\nimport java.net.UnknownHostException;\n\nimport org.apache.catalina.Context;\nimport org.apache.catalina.Engine;\nimport org.apache.catalina.Host;\nimport org.apache.catalina.LifecycleException;\nimport org.apache.catalina.LifecycleState;\nimport org.apache.catalina.connector.Connector;\nimport org.apache.catalina.session.StandardManager;\nimport org.apache.catalina.startup.Embedded;\nimport org.testng.Assert;\nimport org.testng.annotations.Test;\n\n\n@SuppressWarnings( \"deprecation\" )\npublic class TestEmbeddedStop {\n\n    @Test\n    public void testShutdown() throws Exception {\n        final int port = 18888;\n        final Embedded tomcat1 = createCatalina( port );\n        tomcat1.start();\n        tomcat1.stop();\n        try {\n            new ServerSocket( port );\n        } catch ( final IOException e ) {\n            Assert.fail( \"Could not open new server socket on port \" + port, e );\n        }\n    }\n\n    public static Embedded createCatalina( final int port ) throws MalformedURLException,\n            UnknownHostException, LifecycleException {\n\n        final Embedded catalina = new Embedded() {\n\n            @Override\n            // Workaround for #50358 - Embedded.stopInternal sets state to STARTING, should be STOPPING\n            protected void stopInternal() throws LifecycleException {\n                super.stopInternal();\n                setState(LifecycleState.STOPPING);\n            }\n\n        };\n\n        final Engine engine = catalina.createEngine();\n\n        engine.setName( \"engine-\" + port );\n        engine.setDefaultHost( \"localhost\" );\n\n        final String docBase = System.getProperty( \"java.io.tmpdir\" );\n        final Host host = catalina.createHost( \"localhost\", docBase );\n        engine.addChild( host );\n\n        final Context context = catalina.createContext( \"\", \"webapp\" );\n        host.addChild( context );\n        new File( docBase, \"webapp\" ).mkdirs();\n\n        context.setManager( new StandardManager() );\n\n        catalina.addEngine( engine );\n        engine.setService( catalina ); // needed to prevent NPE in ApplicationContext.populateSessionTrackingModes\n\n        final Connector connector = catalina.createConnector( \"localhost\", port, false );\n        catalina.addConnector( connector );\n\n        return catalina;\n    }\n\n}\n\n\nWhen  org.apache.catalina.connector.Connector.stopInternal is changed and sets the state to LifecycleState.MUST_DESTROY at the end this works as expected: the server socket is closed and free for further use.','2010-11-28 20:03:18','Martin Grotzke','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','23473a3','Mark Emlyn David Thomas','2010-12-06 10:43:52','Re-factoring in support of https://issues.apache.org/bugzilla/show_bug.cgi?id=50360 Pull up more getters/setters.','java/org/apache/coyote/AbstractProtocolHandler.java\njava/org/apache/coyote/ajp/AbstractAjpProtocol.java\njava/org/apache/coyote/http11/AbstractHttp11Protocol.java'),(1108,50360,'Bug 50360 – Server socket still bound after Embedded.stop is invoked','After stopping an Embedded tomcat the server socket is still bound (in state LISTEN).\n\nThis test case fails:\n\n\nimport java.io.File;\nimport java.io.IOException;\nimport java.net.MalformedURLException;\nimport java.net.ServerSocket;\nimport java.net.UnknownHostException;\n\nimport org.apache.catalina.Context;\nimport org.apache.catalina.Engine;\nimport org.apache.catalina.Host;\nimport org.apache.catalina.LifecycleException;\nimport org.apache.catalina.LifecycleState;\nimport org.apache.catalina.connector.Connector;\nimport org.apache.catalina.session.StandardManager;\nimport org.apache.catalina.startup.Embedded;\nimport org.testng.Assert;\nimport org.testng.annotations.Test;\n\n\n@SuppressWarnings( \"deprecation\" )\npublic class TestEmbeddedStop {\n\n    @Test\n    public void testShutdown() throws Exception {\n        final int port = 18888;\n        final Embedded tomcat1 = createCatalina( port );\n        tomcat1.start();\n        tomcat1.stop();\n        try {\n            new ServerSocket( port );\n        } catch ( final IOException e ) {\n            Assert.fail( \"Could not open new server socket on port \" + port, e );\n        }\n    }\n\n    public static Embedded createCatalina( final int port ) throws MalformedURLException,\n            UnknownHostException, LifecycleException {\n\n        final Embedded catalina = new Embedded() {\n\n            @Override\n            // Workaround for #50358 - Embedded.stopInternal sets state to STARTING, should be STOPPING\n            protected void stopInternal() throws LifecycleException {\n                super.stopInternal();\n                setState(LifecycleState.STOPPING);\n            }\n\n        };\n\n        final Engine engine = catalina.createEngine();\n\n        engine.setName( \"engine-\" + port );\n        engine.setDefaultHost( \"localhost\" );\n\n        final String docBase = System.getProperty( \"java.io.tmpdir\" );\n        final Host host = catalina.createHost( \"localhost\", docBase );\n        engine.addChild( host );\n\n        final Context context = catalina.createContext( \"\", \"webapp\" );\n        host.addChild( context );\n        new File( docBase, \"webapp\" ).mkdirs();\n\n        context.setManager( new StandardManager() );\n\n        catalina.addEngine( engine );\n        engine.setService( catalina ); // needed to prevent NPE in ApplicationContext.populateSessionTrackingModes\n\n        final Connector connector = catalina.createConnector( \"localhost\", port, false );\n        catalina.addConnector( connector );\n\n        return catalina;\n    }\n\n}\n\n\nWhen  org.apache.catalina.connector.Connector.stopInternal is changed and sets the state to LifecycleState.MUST_DESTROY at the end this works as expected: the server socket is closed and free for further use.','2010-11-28 20:03:18','Martin Grotzke','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','75b49a2','Mark Emlyn David Thomas','2010-12-06 10:01:34','Re-factoring in support of https://issues.apache.org/bugzilla/show_bug.cgi?id=50360 Start to pull more getters/setters and the generic attribute handling. Note that the comments around generic attribute handling are aspirational in some cases but subsequent commits should align the behaviour to the comments.','java/org/apache/coyote/AbstractProtocolHandler.java\njava/org/apache/coyote/LocalStrings.properties\njava/org/apache/coyote/ajp/AbstractAjpProtocol.java\njava/org/apache/coyote/ajp/LocalStrings.properties\njava/org/apache/coyote/ajp/LocalStrings_es.properties\njava/org/apache/coyote/http11/AbstractHttp11Protocol.java\njava/org/apache/coyote/http11/LocalStrings.properties\njava/org/apache/coyote/http11/LocalStrings_es.properties\njava/org/apache/coyote/http11/LocalStrings_fr.properties\njava/org/apache/coyote/http11/LocalStrings_ja.properties'),(1109,50360,'Bug 50360 – Server socket still bound after Embedded.stop is invoked','After stopping an Embedded tomcat the server socket is still bound (in state LISTEN).\n\nThis test case fails:\n\n\nimport java.io.File;\nimport java.io.IOException;\nimport java.net.MalformedURLException;\nimport java.net.ServerSocket;\nimport java.net.UnknownHostException;\n\nimport org.apache.catalina.Context;\nimport org.apache.catalina.Engine;\nimport org.apache.catalina.Host;\nimport org.apache.catalina.LifecycleException;\nimport org.apache.catalina.LifecycleState;\nimport org.apache.catalina.connector.Connector;\nimport org.apache.catalina.session.StandardManager;\nimport org.apache.catalina.startup.Embedded;\nimport org.testng.Assert;\nimport org.testng.annotations.Test;\n\n\n@SuppressWarnings( \"deprecation\" )\npublic class TestEmbeddedStop {\n\n    @Test\n    public void testShutdown() throws Exception {\n        final int port = 18888;\n        final Embedded tomcat1 = createCatalina( port );\n        tomcat1.start();\n        tomcat1.stop();\n        try {\n            new ServerSocket( port );\n        } catch ( final IOException e ) {\n            Assert.fail( \"Could not open new server socket on port \" + port, e );\n        }\n    }\n\n    public static Embedded createCatalina( final int port ) throws MalformedURLException,\n            UnknownHostException, LifecycleException {\n\n        final Embedded catalina = new Embedded() {\n\n            @Override\n            // Workaround for #50358 - Embedded.stopInternal sets state to STARTING, should be STOPPING\n            protected void stopInternal() throws LifecycleException {\n                super.stopInternal();\n                setState(LifecycleState.STOPPING);\n            }\n\n        };\n\n        final Engine engine = catalina.createEngine();\n\n        engine.setName( \"engine-\" + port );\n        engine.setDefaultHost( \"localhost\" );\n\n        final String docBase = System.getProperty( \"java.io.tmpdir\" );\n        final Host host = catalina.createHost( \"localhost\", docBase );\n        engine.addChild( host );\n\n        final Context context = catalina.createContext( \"\", \"webapp\" );\n        host.addChild( context );\n        new File( docBase, \"webapp\" ).mkdirs();\n\n        context.setManager( new StandardManager() );\n\n        catalina.addEngine( engine );\n        engine.setService( catalina ); // needed to prevent NPE in ApplicationContext.populateSessionTrackingModes\n\n        final Connector connector = catalina.createConnector( \"localhost\", port, false );\n        catalina.addConnector( connector );\n\n        return catalina;\n    }\n\n}\n\n\nWhen  org.apache.catalina.connector.Connector.stopInternal is changed and sets the state to LifecycleState.MUST_DESTROY at the end this works as expected: the server socket is closed and free for further use.','2010-11-28 20:03:18','Martin Grotzke','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','875840f','Mark Emlyn David Thomas','2010-12-06 09:02:19','Re-factoring in support of https://issues.apache.org/bugzilla/show_bug.cgi?id=50360 Start to pull stuff up into the base class','java/org/apache/coyote/AbstractProtocolHandler.java\njava/org/apache/coyote/ajp/AbstractAjpProtocol.java\njava/org/apache/coyote/http11/AbstractHttp11Protocol.java'),(1110,50360,'Bug 50360 – Server socket still bound after Embedded.stop is invoked','After stopping an Embedded tomcat the server socket is still bound (in state LISTEN).\n\nThis test case fails:\n\n\nimport java.io.File;\nimport java.io.IOException;\nimport java.net.MalformedURLException;\nimport java.net.ServerSocket;\nimport java.net.UnknownHostException;\n\nimport org.apache.catalina.Context;\nimport org.apache.catalina.Engine;\nimport org.apache.catalina.Host;\nimport org.apache.catalina.LifecycleException;\nimport org.apache.catalina.LifecycleState;\nimport org.apache.catalina.connector.Connector;\nimport org.apache.catalina.session.StandardManager;\nimport org.apache.catalina.startup.Embedded;\nimport org.testng.Assert;\nimport org.testng.annotations.Test;\n\n\n@SuppressWarnings( \"deprecation\" )\npublic class TestEmbeddedStop {\n\n    @Test\n    public void testShutdown() throws Exception {\n        final int port = 18888;\n        final Embedded tomcat1 = createCatalina( port );\n        tomcat1.start();\n        tomcat1.stop();\n        try {\n            new ServerSocket( port );\n        } catch ( final IOException e ) {\n            Assert.fail( \"Could not open new server socket on port \" + port, e );\n        }\n    }\n\n    public static Embedded createCatalina( final int port ) throws MalformedURLException,\n            UnknownHostException, LifecycleException {\n\n        final Embedded catalina = new Embedded() {\n\n            @Override\n            // Workaround for #50358 - Embedded.stopInternal sets state to STARTING, should be STOPPING\n            protected void stopInternal() throws LifecycleException {\n                super.stopInternal();\n                setState(LifecycleState.STOPPING);\n            }\n\n        };\n\n        final Engine engine = catalina.createEngine();\n\n        engine.setName( \"engine-\" + port );\n        engine.setDefaultHost( \"localhost\" );\n\n        final String docBase = System.getProperty( \"java.io.tmpdir\" );\n        final Host host = catalina.createHost( \"localhost\", docBase );\n        engine.addChild( host );\n\n        final Context context = catalina.createContext( \"\", \"webapp\" );\n        host.addChild( context );\n        new File( docBase, \"webapp\" ).mkdirs();\n\n        context.setManager( new StandardManager() );\n\n        catalina.addEngine( engine );\n        engine.setService( catalina ); // needed to prevent NPE in ApplicationContext.populateSessionTrackingModes\n\n        final Connector connector = catalina.createConnector( \"localhost\", port, false );\n        catalina.addConnector( connector );\n\n        return catalina;\n    }\n\n}\n\n\nWhen  org.apache.catalina.connector.Connector.stopInternal is changed and sets the state to LifecycleState.MUST_DESTROY at the end this works as expected: the server socket is closed and free for further use.','2010-11-28 20:03:18','Martin Grotzke','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','5db1aee','Mark Emlyn David Thomas','2010-12-06 08:36:48','Re-factoring in support of https://issues.apache.org/bugzilla/show_bug.cgi?id=50360 Implement a common base class for ProtocolHandler implementations that will handle life-cycle/mbean issues (once more re-factoring has been completed)','java/org/apache/coyote/AbstractProtocolHandler.java\njava/org/apache/coyote/ajp/AbstractAjpProtocol.java\njava/org/apache/coyote/http11/AbstractHttp11Protocol.java'),(1111,49159,'Bug 49159 – Improve ThreadLocal memory leak clean-up','Doing this in a thread-safe way means performing the clean-up in the thread where the ThreadLocal exists. A likely point is just before the Thread gets returned to the pool.','2010-04-20 13:33:43','Mark Thomas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','4895489','Sylvain Laurent','2010-12-05 17:54:05','bug 49159: Improve ThreadLocal memory leak clean-up https://issues.apache.org/bugzilla/show_bug.cgi?id=49159 Renewing threads of the pool when a webapp is stopped','conf/server.xml\njava/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/core/StandardThreadExecutor.java\njava/org/apache/catalina/core/ThreadLocalLeakPreventionListener.java\njava/org/apache/catalina/core/mbeans-descriptors.xml\njava/org/apache/catalina/loader/LocalStrings.properties\njava/org/apache/catalina/loader/WebappClassLoader.java\njava/org/apache/catalina/loader/WebappLoader.java\njava/org/apache/tomcat/util/threads/Constants.java\njava/org/apache/tomcat/util/threads/LocalStrings.properties\njava/org/apache/tomcat/util/threads/TaskQueue.java\njava/org/apache/tomcat/util/threads/TaskThread.java\njava/org/apache/tomcat/util/threads/TaskThreadFactory.java\njava/org/apache/tomcat/util/threads/ThreadPoolExecutor.java\nres/confinstall/server_1.xml\nwebapps/docs/changelog.xml\nwebapps/docs/config/context.xml\nwebapps/docs/config/executor.xml'),(1112,49159,'Bug 49159 – Improve ThreadLocal memory leak clean-up','Doing this in a thread-safe way means performing the clean-up in the thread where the ThreadLocal exists. A likely point is just before the Thread gets returned to the pool.','2010-04-20 13:33:43','Mark Thomas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','4895489','Sylvain Laurent','2010-12-05 17:54:05','bug 49159: Improve ThreadLocal memory leak clean-up https://issues.apache.org/bugzilla/show_bug.cgi?id=49159 Renewing threads of the pool when a webapp is stopped','conf/server.xml\njava/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/core/StandardThreadExecutor.java\njava/org/apache/catalina/core/ThreadLocalLeakPreventionListener.java\njava/org/apache/catalina/core/mbeans-descriptors.xml\njava/org/apache/catalina/loader/LocalStrings.properties\njava/org/apache/catalina/loader/WebappClassLoader.java\njava/org/apache/catalina/loader/WebappLoader.java\njava/org/apache/tomcat/util/threads/Constants.java\njava/org/apache/tomcat/util/threads/LocalStrings.properties\njava/org/apache/tomcat/util/threads/TaskQueue.java\njava/org/apache/tomcat/util/threads/TaskThread.java\njava/org/apache/tomcat/util/threads/TaskThreadFactory.java\njava/org/apache/tomcat/util/threads/ThreadPoolExecutor.java\nres/confinstall/server_1.xml\nwebapps/docs/changelog.xml\nwebapps/docs/config/context.xml\nwebapps/docs/config/executor.xml'),(1113,50411,'Bug 50411 – invalid sessions not removed from PersistenManager store','','2010-12-04 18:36:08','Marco','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','bd04cce','Mark Emlyn David Thomas','2010-12-05 17:50:56','Additional fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=50411','java/org/apache/catalina/session/PersistentManagerBase.java'),(1114,50282,'Bug 50282 – Reference from javax.security.auth.login.LoginContext.contextClassLoader initalized in static code block prevents an undeployed Web application from being garbage collected (similar to #49669)','','2010-11-16 20:14:17','Justin Almquist','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','dba82cd','Sylvain Laurent','2010-12-05 16:26:22','bug 50282 / fixed line length','java/org/apache/catalina/core/JreMemoryLeakPreventionListener.java'),(1115,50282,'Bug 50282 – Reference from javax.security.auth.login.LoginContext.contextClassLoader initalized in static code block prevents an undeployed Web application from being garbage collected (similar to #49669)','','2010-11-16 20:14:17','Justin Almquist','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','39e29a3','Sylvain Laurent','2010-12-05 16:06:25','bug 50282 / fixed some typos in documentation','webapps/docs/config/listeners.xml'),(1116,50411,'Bug 50411 – invalid sessions not removed from PersistenManager store','','2010-12-04 18:36:08','Marco','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','1a4bd03','Mark Emlyn David Thomas','2010-12-05 14:32:00','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50411 Ensure sessions are removed from the Store associated with a PersistentManager.','java/org/apache/catalina/session/PersistentManagerBase.java\nwebapps/docs/changelog.xml'),(1117,50282,'Bug 50282 – Reference from javax.security.auth.login.LoginContext.contextClassLoader initalized in static code block prevents an undeployed Web application from being garbage collected (similar to #49669)','','2010-11-16 20:14:17','Justin Almquist','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','f2d19a9','Sylvain Laurent','2010-12-03 17:19:11','bug 50282 : Load javax.security.auth.login.Configuration with JreMemoryLeakPreventionListener to avoid memory leak when stopping a webapp that would use JAAS.','java/org/apache/catalina/core/JreMemoryLeakPreventionListener.java\nwebapps/docs/changelog.xml\nwebapps/docs/config/listeners.xml'),(1118,48973,'Bug 48973 – Don\'t create SESSIONS.ser when no session exists','','2010-03-24 09:22:46','Marc Guillemot','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 enhancement','079d43b','Sylvain Laurent','2010-12-03 17:00:58','bug 48973 (enhancement): Don\'t create SESSIONS.ser when no session exists https://issues.apache.org/bugzilla/show_bug.cgi?id=48973','java/org/apache/catalina/session/StandardManager.java\nwebapps/docs/changelog.xml'),(1119,48973,'Bug 48973 – Don\'t create SESSIONS.ser when no session exists','','2010-03-24 09:22:46','Marc Guillemot','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 enhancement','079d43b','Sylvain Laurent','2010-12-03 17:00:58','bug 48973 (enhancement): Don\'t create SESSIONS.ser when no session exists https://issues.apache.org/bugzilla/show_bug.cgi?id=48973','java/org/apache/catalina/session/StandardManager.java\nwebapps/docs/changelog.xml'),(1120,50408,'Bug 50408 – Scoped EL variable in methodexpression is treated as Object','Consider following example:\n\n<dl>\n  <c:forEach items=\"${pageContext.response.headerNames}\" var=\"name\">\n    <c:forEach items=\"${pageContext.response.getHeaders(name)}\" var=\"value\">\n      <dt>${name}</dt><dd>${value}</dd>\n    </c:forEach>\n  </c:forEach>\n</dl>\n\nThe ${name} is a String. The ${name.class.name} also proves that. The getHeaders(name) call however results in:\n\norg.apache.jasper.el.JspELException: /test.jsp(23,12) \'${pageContext.response.getHeaders(name)}\' java.lang.NoSuchMethodException: org.apache.catalina.connector.ResponseFacade.getHeaders(java.lang.Object)\n\nAnother example which also results in NoSuchMethodException which suggests that an Object is been passed as argument:\n\n<c:set var=\"name\" value=\"test\" />\n${pageContext.response.getHeader(name)}\n\nThis works all fine on Glassfish v3.','2010-12-03 12:37:00','balusc','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','4ed7b7e','Mark Emlyn David Thomas','2010-12-03 16:49:54','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50408 Fix <code>NoSuchMethodException</code> when using scoped variables with EL method invocation.','java/javax/el/CompositeELResolver.java\ntest/javax/el/TestCompositeELResolver.java\ntest/webapp-3.0/bug50408.jsp\nwebapps/docs/changelog.xml'),(1121,48692,'Bug 48692 – Provide option to parse application/x-www-form-urlencoded PUT requests','Provide an option to treat application/x-www-form-urlencoded encoded parameters in a PUT request in a similar manner to application/x-www-form-urlencoded parameters in a POST request','2010-02-07 02:41:33','Mark Thomas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','e34b164','Christopher Schultz','2010-12-03 11:07:50','Fixed bug 48692: Provide option to parse application/x-www-form-urlencoded PUT requests','java/org/apache/catalina/connector/Connector.java\njava/org/apache/catalina/connector/Request.java\ntest/org/apache/catalina/connector/TestRequest.java\nwebapps/docs/changelog.xml\nwebapps/docs/config/ajp.xml\nwebapps/docs/config/http.xml'),(1122,50228,'Bug 50228 – PermGen leak when calling JspFragment.invoke() with a custom Writer','','2010-11-07 03:27:43','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','cadf86c','Konstantin Kolinko','2010-12-01 20:40:55','Move changelog comment for BZ 50228 from Catalina to Jasper.','webapps/docs/changelog.xml'),(1123,50360,'Bug 50360 – Server socket still bound after Embedded.stop is invoked','After stopping an Embedded tomcat the server socket is still bound (in state LISTEN).\n\nThis test case fails:\n\n\nimport java.io.File;\nimport java.io.IOException;\nimport java.net.MalformedURLException;\nimport java.net.ServerSocket;\nimport java.net.UnknownHostException;\n\nimport org.apache.catalina.Context;\nimport org.apache.catalina.Engine;\nimport org.apache.catalina.Host;\nimport org.apache.catalina.LifecycleException;\nimport org.apache.catalina.LifecycleState;\nimport org.apache.catalina.connector.Connector;\nimport org.apache.catalina.session.StandardManager;\nimport org.apache.catalina.startup.Embedded;\nimport org.testng.Assert;\nimport org.testng.annotations.Test;\n\n\n@SuppressWarnings( \"deprecation\" )\npublic class TestEmbeddedStop {\n\n    @Test\n    public void testShutdown() throws Exception {\n        final int port = 18888;\n        final Embedded tomcat1 = createCatalina( port );\n        tomcat1.start();\n        tomcat1.stop();\n        try {\n            new ServerSocket( port );\n        } catch ( final IOException e ) {\n            Assert.fail( \"Could not open new server socket on port \" + port, e );\n        }\n    }\n\n    public static Embedded createCatalina( final int port ) throws MalformedURLException,\n            UnknownHostException, LifecycleException {\n\n        final Embedded catalina = new Embedded() {\n\n            @Override\n            // Workaround for #50358 - Embedded.stopInternal sets state to STARTING, should be STOPPING\n            protected void stopInternal() throws LifecycleException {\n                super.stopInternal();\n                setState(LifecycleState.STOPPING);\n            }\n\n        };\n\n        final Engine engine = catalina.createEngine();\n\n        engine.setName( \"engine-\" + port );\n        engine.setDefaultHost( \"localhost\" );\n\n        final String docBase = System.getProperty( \"java.io.tmpdir\" );\n        final Host host = catalina.createHost( \"localhost\", docBase );\n        engine.addChild( host );\n\n        final Context context = catalina.createContext( \"\", \"webapp\" );\n        host.addChild( context );\n        new File( docBase, \"webapp\" ).mkdirs();\n\n        context.setManager( new StandardManager() );\n\n        catalina.addEngine( engine );\n        engine.setService( catalina ); // needed to prevent NPE in ApplicationContext.populateSessionTrackingModes\n\n        final Connector connector = catalina.createConnector( \"localhost\", port, false );\n        catalina.addConnector( connector );\n\n        return catalina;\n    }\n\n}\n\n\nWhen  org.apache.catalina.connector.Connector.stopInternal is changed and sets the state to LifecycleState.MUST_DESTROY at the end this works as expected: the server socket is closed and free for further use.','2010-11-28 20:03:18','Martin Grotzke','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','d754be3','Mark Emlyn David Thomas','2010-12-01 13:37:29','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50360 Bind/release socket on start()/stop() Register/deregister MBeans on init()/destroy()','java/org/apache/catalina/connector/Connector.java\njava/org/apache/coyote/ProtocolHandler.java\njava/org/apache/coyote/ajp/AbstractAjpProtocol.java\njava/org/apache/coyote/http11/AbstractHttp11Protocol.java\njava/org/apache/coyote/http11/Http11AprProtocol.java\njava/org/apache/coyote/http11/Http11NioProtocol.java\njava/org/apache/coyote/http11/Http11Protocol.java\njava/org/apache/tomcat/util/net/AbstractEndpoint.java\njava/org/apache/tomcat/util/net/AprEndpoint.java\njava/org/apache/tomcat/util/net/JIoEndpoint.java\njava/org/apache/tomcat/util/net/NioEndpoint.java\ntest/org/apache/tomcat/util/net/TestXxxEndpoint.java\nwebapps/docs/changelog.xml'),(1124,50383,'Bug 50383 – Bad spelling in catalina.sh','','2010-11-30 08:45:38','Michael Osipov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P2 normal','c8f9633','Rainer Jung','2010-11-30 09:58:07','Fix typo in script comment. BZ 50383, addition to r1040546.','bin/tool-wrapper.bat\nbin/tool-wrapper.sh'),(1125,50383,'Bug 50383 – Bad spelling in catalina.sh','','2010-11-30 08:45:38','Michael Osipov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P2 normal','90a0bc5','Mark Emlyn David Thomas','2010-11-30 09:47:34','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50383 Comment typo','bin/catalina.bat\nbin/catalina.sh'),(1126,50352,'Bug 50352 – AsyncListener.onComplete is not called after AsyncContext.complete() is called','Using servlet 3 async features, when asyncContext.complete(); is called from an async thread, the AsyncListener onComplete() method is not called though it should be.\n\nExample Servlet :\n\n\npackage test;\n\nimport java.io.IOException;\n\nimport javax.servlet.AsyncContext;\nimport javax.servlet.AsyncEvent;\nimport javax.servlet.AsyncListener;\nimport javax.servlet.ServletException;\nimport javax.servlet.annotation.WebServlet;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\n\n/**\n * Servlet implementation class MyServlet\n */\n@WebServlet(value = \"/MyServlet\", asyncSupported = true)\npublic class MyServlet extends HttpServlet implements AsyncListener {\n	private static final long serialVersionUID = 1L;\n\n	protected void doGet(HttpServletRequest request,\n			HttpServletResponse response) throws ServletException, IOException {\n		final AsyncContext asyncContext = request.startAsync(request, response);\n		asyncContext.addListener(this);\n\n		asyncContext.start(new Runnable() {\n\n			@Override\n			public void run() {\n				try {\n					Thread.sleep(5 * 1000);\n					asyncContext.getResponse().getWriter().write(\"Hello world\");\n					asyncContext.complete();\n				} catch (Exception e) {\n					e.printStackTrace();\n				}\n			}\n		});\n	}\n\n	@Override\n	public void onComplete(AsyncEvent arg0) throws IOException {\n		System.out.println(\"onComplete \" + arg0);\n	}\n\n	@Override\n	public void onError(AsyncEvent arg0) throws IOException {\n		System.out.println(\"onError \" + arg0);\n	}\n\n	@Override\n	public void onStartAsync(AsyncEvent arg0) throws IOException {\n		System.out.println(\"onStartAsync \" + arg0);\n	}\n\n	@Override\n	public void onTimeout(AsyncEvent arg0) throws IOException {\n		System.out.println(\"onTimeout \" + arg0);\n	}\n}','2010-11-27 16:30:59','Sylvain Laurent','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','1e1f0e9','Mark Emlyn David Thomas','2010-11-29 11:58:31','Test case for https://issues.apache.org/bugzilla/show_bug.cgi?id=50352','test/org/apache/catalina/core/TestAsyncContextImpl.java'),(1127,50352,'Bug 50352 – AsyncListener.onComplete is not called after AsyncContext.complete() is called','Using servlet 3 async features, when asyncContext.complete(); is called from an async thread, the AsyncListener onComplete() method is not called though it should be.\n\nExample Servlet :\n\n\npackage test;\n\nimport java.io.IOException;\n\nimport javax.servlet.AsyncContext;\nimport javax.servlet.AsyncEvent;\nimport javax.servlet.AsyncListener;\nimport javax.servlet.ServletException;\nimport javax.servlet.annotation.WebServlet;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\n\n/**\n * Servlet implementation class MyServlet\n */\n@WebServlet(value = \"/MyServlet\", asyncSupported = true)\npublic class MyServlet extends HttpServlet implements AsyncListener {\n	private static final long serialVersionUID = 1L;\n\n	protected void doGet(HttpServletRequest request,\n			HttpServletResponse response) throws ServletException, IOException {\n		final AsyncContext asyncContext = request.startAsync(request, response);\n		asyncContext.addListener(this);\n\n		asyncContext.start(new Runnable() {\n\n			@Override\n			public void run() {\n				try {\n					Thread.sleep(5 * 1000);\n					asyncContext.getResponse().getWriter().write(\"Hello world\");\n					asyncContext.complete();\n				} catch (Exception e) {\n					e.printStackTrace();\n				}\n			}\n		});\n	}\n\n	@Override\n	public void onComplete(AsyncEvent arg0) throws IOException {\n		System.out.println(\"onComplete \" + arg0);\n	}\n\n	@Override\n	public void onError(AsyncEvent arg0) throws IOException {\n		System.out.println(\"onError \" + arg0);\n	}\n\n	@Override\n	public void onStartAsync(AsyncEvent arg0) throws IOException {\n		System.out.println(\"onStartAsync \" + arg0);\n	}\n\n	@Override\n	public void onTimeout(AsyncEvent arg0) throws IOException {\n		System.out.println(\"onTimeout \" + arg0);\n	}\n}','2010-11-27 16:30:59','Sylvain Laurent','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','6fe9848','Mark Emlyn David Thomas','2010-11-29 11:58:05','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50352 Ensure that AsyncListener.onComplete() is fired when AsyncContext.complete() is called.','java/org/apache/coyote/AsyncStateMachine.java\nwebapps/docs/changelog.xml'),(1128,50351,'Bug 50351 – javax.naming.NamingException: No set method found for property: singleton','','2010-11-27 16:27:45','Flávio Henrique','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 regression','09ec614','Mark Emlyn David Thomas','2010-11-29 10:40:11','Add a test case for https://issues.apache.org/bugzilla/show_bug.cgi?id=50351','test/org/apache/naming/resources/TestNamingContext.java\ntest/org/apache/naming/resources/TesterObject.java'),(1129,50351,'Bug 50351 – javax.naming.NamingException: No set method found for property: singleton','','2010-11-27 16:27:45','Flávio Henrique','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 regression','a39a3d2','Mark Emlyn David Thomas','2010-11-29 10:39:50','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50351 Fix the regression that broke BeanFactory resources caused by the previous fix for 50159','java/org/apache/naming/factory/BeanFactory.java\nwebapps/docs/changelog.xml'),(1130,50159,'Bug 50159 – JNDI context returns new datasource instance each request','Requesting a javax.sql.DataSource via JNDI results in a new instance each time.\n\nIn my particular case I have defined a c3p0 connection pool as follows:\n\n<Resource auth=\"Container\"\n   name=\"jdbc/mydb\"\n   description=\"My Database\"\n   factory=\"org.apache.naming.factory.BeanFactory\"\n   type=\"com.mchange.v2.c3p0.ComboPooledDataSource\"\n   driverClass=\"org.gjt.mm.mysql.Driver\"\n   jdbcUrl=\"jdbc:mysql://localhost:3306/mydb?autoReconnect=true\"\n   user=\"myUserName\"\n   password=\"myPassword\"\n   minPoolSize=\"5\"\n   maxPoolSize=\"50\"\n   acquireIncrement=\"1\"\n   idleConnectionTestPeriod=\"100\"\n   maxIdleTime=\"1800\"\n   preferredTestQuery=\"SELECT 1;\"\n/>\n\nI am using a 3rd party library to access the datasource.  Each time a request is made I can see a new connection pool being created.  With a simple test I was also able to see that the instance being returned was different each time.  Test code:\n\nContext initialContext = new InitialContext();\nreturn ((DataSource)initialContext.lookup(this.dataSource)).getConnection();\n\nWhen comparing the source code for org.apache.naming.NamingContext between 7.02 and 7.04 the following 4 lines of code were removed (line 808):\n\nif (obj != null) {\n   entry.value = obj;\n   entry.type = NamingEntry.ENTRY;\n}\n\nAdding this code back into the class fixes the issue.','2010-10-26 15:46:50','Mark Watson','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 critical','a39a3d2','Mark Emlyn David Thomas','2010-11-29 10:39:50','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50351 Fix the regression that broke BeanFactory resources caused by the previous fix for 50159','java/org/apache/naming/factory/BeanFactory.java\nwebapps/docs/changelog.xml'),(1131,50358,'Bug 50358 – Embedded.stopInternal sets state to STARTING, should be STOPPING','','2010-11-28 18:13:10','Martin Grotzke','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','07b72f1','Mark Emlyn David Thomas','2010-11-29 08:41:07','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50358 Set correct state when stopping','java/org/apache/catalina/startup/Embedded.java\nwebapps/docs/changelog.xml'),(1132,49142,'Bug 49142 – Missing serialVersionUIDs','org.apache.catalina.ha.ClusterMessageBase is Serializable; consider declaring a serialVersionUID\n\nSimilarly for:\norg.apache.catalina.ha.session.ReplicatedSession \norg.apache.catalina.ha.session.SerializablePrincipal \norg.apache.catalina.session.StandardSession \norg.apache.catalina.tribes.tipis.AbstractReplicatedMap.MapMessage\norg.apache.tomcat.util.modeler.ManagedBean','2010-04-16 21:25:34','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','4cbb52f','Mark Emlyn David Thomas','2010-11-24 17:08:38','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49142 Add missing serialVersionUIDs using Eclipse\'s auto correct and a little manual formatting','java/javax/servlet/GenericServlet.java\njava/javax/servlet/ServletContextAttributeEvent.java\njava/javax/servlet/ServletContextEvent.java\njava/javax/servlet/ServletException.java\njava/javax/servlet/ServletRequestAttributeEvent.java\njava/javax/servlet/ServletRequestEvent.java\njava/javax/servlet/UnavailableException.java\njava/javax/servlet/http/HttpServlet.java\njava/javax/servlet/http/HttpSessionBindingEvent.java\njava/javax/servlet/http/HttpSessionEvent.java\njava/javax/servlet/jsp/JspException.java\njava/javax/servlet/jsp/JspTagException.java\njava/javax/servlet/jsp/SkipPageException.java\njava/javax/servlet/jsp/el/ELException.java\njava/javax/servlet/jsp/el/ELParseException.java\njava/javax/servlet/jsp/tagext/TagSupport.java\njava/org/apache/catalina/ha/deploy/FileMessage.java\njava/org/apache/catalina/ha/deploy/UndeployMessage.java\njava/org/apache/catalina/manager/StatusManagerServlet.java\njava/org/apache/catalina/session/StandardSession.java\njava/org/apache/catalina/ssi/SSIServlet.java\njava/org/apache/catalina/ssi/SSIStopProcessingException.java\njava/org/apache/catalina/tribes/ChannelException.java\njava/org/apache/catalina/tribes/RemoteProcessException.java\njava/org/apache/catalina/tribes/UniqueId.java\njava/org/apache/catalina/tribes/io/ChannelData.java\njava/org/apache/catalina/tribes/tipis/AbstractReplicatedMap.java\njava/org/apache/catalina/tribes/tipis/LazyReplicatedMap.java\njava/org/apache/catalina/tribes/tipis/ReplicatedMap.java\njava/org/apache/catalina/tribes/util/ExecutorFactory.java\njava/org/apache/catalina/util/ParameterMap.java\njava/org/apache/catalina/util/ResourceSet.java\njava/org/apache/jasper/JasperException.java\njava/org/apache/jasper/compiler/JspDocumentParser.java\njava/org/apache/jasper/runtime/HttpJspBase.java\njava/org/apache/juli/logging/LogConfigurationException.java\njava/org/apache/naming/EjbRef.java\njava/org/apache/naming/HandlerRef.java\njava/org/apache/naming/JndiPermission.java\njava/org/apache/naming/ResourceEnvRef.java\njava/org/apache/naming/ResourceLinkRef.java\njava/org/apache/naming/ServiceRef.java\njava/org/apache/naming/TransactionRef.java\njava/org/apache/tomcat/util/buf/CharChunk.java\njava/org/apache/tomcat/util/buf/MessageBytes.java\njava/org/apache/tomcat/util/modeler/BaseAttributeFilter.java\njava/org/apache/tomcat/util/modeler/FixedNotificationFilter.java\njava/org/apache/tomcat/util/modeler/ManagedBean.java\njava/org/apache/tomcat/util/net/URL.java\ntest/org/apache/catalina/tribes/demos/MapDemo.java\nwebapps/examples/WEB-INF/jsp/applet/Clock2.java'),(1133,48837,'Bug 48837 – Memory leaks protection does not detect leaks triggered by JSP pages code','','2010-03-01 18:51:11','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 enhancement','ddbbfc1','Mark Emlyn David Thomas','2010-11-24 16:28:33','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48837 Extend thread local memory leak detection to include classes loaded by subordinate class loaders to the web application\'s class loader such as the Jasper class loader. Based on a patch by Sylvain Laurent.','java/org/apache/catalina/loader/WebappClassLoader.java\nwebapps/docs/changelog.xml'),(1134,50106,'Bug 50106 – Fix several mbean descriptors','Fix several mbean descriptors: \n - Add writeable=\"false\" to Lifecycle stateName(setter is not provided for stateName).\n - Remove obsolete bufferSize from CoyoteConnector.\n - Add packetSize to CoyoteConnector.','2010-10-17 21:00:41','Eiji Takahashi','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','ef51c04','Mark Emlyn David Thomas','2010-11-24 15:54:21','https://issues.apache.org/bugzilla/show_bug.cgi?id=50106 Correct several MBean descriptors. Patch provided by Eiji Takahashi.','java/org/apache/catalina/authenticator/mbeans-descriptors.xml\njava/org/apache/catalina/connector/mbeans-descriptors.xml\njava/org/apache/catalina/core/mbeans-descriptors.xml\njava/org/apache/catalina/ha/session/mbeans-descriptors.xml\njava/org/apache/catalina/ha/tcp/mbeans-descriptors.xml\njava/org/apache/catalina/loader/mbeans-descriptors.xml\njava/org/apache/catalina/realm/mbeans-descriptors.xml\njava/org/apache/catalina/session/mbeans-descriptors.xml\njava/org/apache/catalina/valves/mbeans-descriptors.xml\njava/org/apache/jasper/servlet/mbeans-descriptors.xml\nwebapps/docs/changelog.xml'),(1135,49650,'Bug 49650 – Streamline package.access property definition in catalina.properties','','2010-07-26 12:58:32','Owen Farrell','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','5b4e760','Mark Emlyn David Thomas','2010-11-24 15:33:49','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49650 Remove unnecessary entries package.access property defined in catalina.properties. Patch provided by Owen Farrell.','conf/catalina.properties\njava/org/apache/catalina/startup/catalina.properties\nwebapps/docs/changelog.xml'),(1136,50108,'Bug 50108 – Add missing setter/getter to AbstractXXXProtocol','','2010-10-18 03:22:19','Eiji Takahashi','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 enhancement','5a84fdb','Mark Emlyn David Thomas','2010-11-24 15:16:32','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50108 Add get/set methods for Connector property minSpareThreads. Patch provided by Eiji Takahashi.','java/org/apache/coyote/ajp/AbstractAjpProtocol.java\njava/org/apache/coyote/http11/AbstractHttp11Protocol.java\nwebapps/docs/changelog.xml'),(1137,50294,'Bug 50294 – Mention obvious things about config format','','2010-11-18 17:10:14','Luke Meyer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P4 enhancement','ad6748f','Mark Emlyn David Thomas','2010-11-24 14:59:19','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50294 Add more information to documentation regarding format of configuration files. Patch provided by Luke Meyer.','webapps/docs/changelog.xml\nwebapps/docs/config/index.xml'),(1138,50201,'Bug 50201 – StandardEngine.defaultAccessLog may become stale when ROOT webapp is redeployed','','2010-11-02 19:28:12','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','74f0260','Mark Emlyn David Thomas','2010-11-24 12:28:55','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50201 Track changes that require an update to the default access log. It isn\'t perfect but should cover normal usage','java/org/apache/catalina/core/StandardEngine.java'),(1139,50015,'Bug 50015 – dynamic servlet security incomplete and badly distributed','The current implementation of dynamic servlet security through ServletRegistration.Dynamic.setServletSecurity and the ServletContext.createServlet and addServlet methods is incomplete, and includes some logic that exposes internals of the tomcat security framework directly in the ServletRegistration.Dynamic implementation.\n\nThe attached patch:\n\n- moves the logic that depends on the internals of tomcats security implementation from ApplicationServletRegistration to StandardContext where it can at least be overridden by e.g. jacc implementations\n\n- provides notifications to StandardContext of users calling createServlet and addServlet on ApplicationContext/ServletContext so subclasses of StandardContext can implement the spec behavior without subclassing ApplicationContext.\n\nThis patch is generated from a tomcat copy that already has several other patches I\'ve proposed applied.  Let me know if there are problems applying it.','2010-09-27 16:22:54','david jencks','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','0843ba0','Mark Emlyn David Thomas','2010-11-23 14:21:09','Add a test case for bug50015','test/org/apache/catalina/core/TestStandardContext.java'),(1140,50318,'Bug 50318 – NPE when opening Session Details page for an expired session','','2010-11-22 16:20:41','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Manager','P2 minor','0770d05','Mark Emlyn David Thomas','2010-11-23 12:59:49','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50318 Avoid NPE when viewing session detail for expired sessions','webapps/docs/changelog.xml\nwebapps/manager/WEB-INF/jsp/sessionDetail.jsp'),(1141,50207,'Bug 50207 – CometProcessor async timeout events are not being fired','This is reproducible using the the default chat example (ie: ChatServlet, /examples/jsp/chat) and the following additional changes:\n\n1) Enabled Http11Nio in conf/server.xml:\n\n    <Connector \n        address=\"0.0.0.0\" \n        port=\"8080\" \n        protocol=\"org.apache.coyote.http11.Http11NioProtocol\"\n        connectionTimeout=\"20000\" \n        enableLookups=\"false\"\n        acceptCount=\"100\"\n        disableUploadTimeout=\"true\"\n        maxThreads=\"15\"\n        minSpareThreads=\"15\"\n        maxSpareThreads=\"15\"\n        RECYCLE_FACADES=\"true\"/>\n\n2) Enabled the comet valve in conf/context.xml:\n\n  <Valve className=\"org.apache.catalina.valves.CometConnectionManagerValve\" />\n\nThe problem is CometEvent.EventType.ERROR (and subtype TIMEOUT) and CometEvent.EventType.END are never being fired.\n\nThis can be confirmed in the logs; the messages for these events are never printed.  This worked on Tomcat 6.0.29.\n\nAs an aside, what is the most complete/robust way to do async IO in tomcat 7 today, Servlet 3.0 or CometProcessor?','2010-11-03 14:52:32','Jeremy Norris','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 regression','46e7d1e','Mark Emlyn David Thomas','2010-11-23 11:57:47','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50207','java/org/apache/coyote/http11/Http11NioProtocol.java\njava/org/apache/tomcat/util/net/NioEndpoint.java\nwebapps/docs/changelog.xml'),(1142,50316,'Bug 50316 – Minor glitch with display of negative TTL on sessionDetail.jsp','','2010-11-22 11:29:24','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Manager application','P2 minor','278a36a','Konstantin Kolinko','2010-11-22 15:59:20','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50316 Fix display of negative values','java/org/apache/catalina/manager/JspHelper.java\njava/org/apache/catalina/manager/StatusTransformer.java\nwebapps/docs/changelog.xml'),(1143,50228,'Bug 50228 – PermGen leak when calling JspFragment.invoke() with a custom Writer','','2010-11-07 03:27:43','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','182d5cc','Konstantin Kolinko','2010-11-22 12:40:09','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50228 Improve recycling of BodyContentImpl.','java/org/apache/jasper/runtime/BodyContentImpl.java\njava/org/apache/jasper/runtime/PageContextImpl.java'),(1144,50308,'Bug 50308 – Call to AsyncContext.dispatch() in the onTimeout callback throws exception','When dispatch() method is called inside the onTimeout() function of the AsyncListener, the exception is thrown:\n\nSEVERE: An exception or error occurred in the container during the request processing\njava.lang.IllegalStateException: Calling [dispatchAsync()] is not valid for a request with Async state [TIMING_OUT]\n	at org.apache.coyote.AsyncStateMachine.asyncDispatch(AsyncStateMachine.java:220)\n	at org.apache.coyote.http11.Http11NioProcessor.actionInternal(Http11NioProcessor.java:672)\n	at org.apache.coyote.http11.AbstractHttp11Processor.action(AbstractHttp11Processor.java:937)\n	at org.apache.coyote.Request.action(Request.java:348)\n	at org.apache.catalina.core.AsyncContextImpl.dispatch(AsyncContextImpl.java:173)\n	at org.apache.catalina.core.AsyncContextImpl.dispatch(AsyncContextImpl.java:135)\n	at org.apache.catalina.core.AsyncContextImpl.dispatch(AsyncContextImpl.java:130)\n	at com.juriy.snowball.SnowServlet$1.onTimeout(SnowServlet.java:23)\n	at org.apache.catalina.core.AsyncListenerWrapper.fireOnTimeout(AsyncListenerWrapper.java:45)\n	at org.apache.catalina.core.AsyncContextImpl.timeout(AsyncContextImpl.java:109)\n	at org.apache.catalina.connector.CoyoteAdapter.asyncDispatch(CoyoteAdapter.java:270)\n	at org.apache.coyote.http11.Http11NioProcessor.asyncDispatch(Http11NioProcessor.java:232)\n	at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.event(Http11NioProtocol.java:305)\n	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1526)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n	at java.lang.Thread.run(Thread.java:619)\n\n\nThe sample code is below:\n\n	protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n		AsyncContext context = request.startAsync();\n		context.setTimeout(3000);\n		context.addListener(new AsyncListener() {\n\n			public void onComplete(AsyncEvent asyncEvent) throws IOException {}\n\n			public void onTimeout(AsyncEvent asyncEvent) throws IOException {\n				System.out.println(\"HITTING TIMEOUT\");\n				asyncEvent.getAsyncContext().dispatch();\n			}\n\n			public void onError(AsyncEvent asyncEvent) throws IOException {}\n\n			public void onStartAsync(AsyncEvent asyncEvent) throws IOException {}\n		});\n}\n\n\nIt looks like the Servlet 3.0 specification allows to do such call, here\'s the quotation that explicitly states the flow of the timeouted async contexts (page 18):\n\n\"In the event that an asynchronous operation times out, the container must run\nthrough the following steps:\n■ Invoke the AsyncListener.onTimeout method on all the AsyncListener\ninstances registered with the ServletRequest on which the asynchronous\noperation was initiated.\n■ If none of the listeners called AsyncContext.complete() or any of the\nAsyncContext.dispatch methods, perform an error dispatch with a status\ncode equal to HttpServletResponse.SC_INTERNAL_SERVER_ERROR.\n■ If no matching error page was found, or the error page did not call\nAsyncContext.complete() or any of the AsyncContext.dispatch\nmethods, the container MUST call AsyncContext.complete()\"\n\nSecond step assumes that the call to dispatch in onTimeout() is allowed.','2010-11-20 11:00:06','Juriy','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 critical','991702c','Mark Emlyn David Thomas','2010-11-22 09:35:51','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50308 Allow asynchronous request processing to call AsyncContext.dispatch() once the asynchronous request has timed out.','java/org/apache/coyote/AsyncStateMachine.java\ntest/org/apache/catalina/core/TestAsyncContextImpl.java\nwebapps/docs/changelog.xml'),(1145,50273,'Bug 50273 – AprEndpoint logs socket accept fails altough error is harmless','','2010-11-15 10:39:37','Michael Osipov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 normal','a00f58c','Mark Emlyn David Thomas','2010-11-22 09:12:05','Additional info for https://issues.apache.org/bugzilla/show_bug.cgi?id=50273 Add the error number to the message','java/org/apache/tomcat/jni/Error.java'),(1146,50273,'Bug 50273 – AprEndpoint logs socket accept fails altough error is harmless','','2010-11-15 10:39:37','Michael Osipov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 normal','c82e2cb','Mark Emlyn David Thomas','2010-11-22 08:42:01','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50273 Provide a workaround for an HP-UX issue that can result in large numbers of SEVERE log messages appearing in the logs as a result of normal operation.','java/org/apache/tomcat/util/net/AprEndpoint.java\nwebapps/docs/changelog.xml'),(1147,50310,'Bug 50310 – Manager detailed status page does not display servlets','To reproduce:\n1. Login to the Manager webapp\n2. Click \"Server Status\" and then \"Complete Server Status\" links.\n\n\n\nIn TC6 the \"Complete Server Status\" page lists servlets for each deployed application.\n\nIn the current TC7 it does not list them. Only summary information on each webapp is displayed.\n\n\nLooking at the StatusManagerServlet and StatusTransformer classes, the code to iterate over servlets is still there, but probably the JMX names have changed and are not working any more.','2010-11-21 21:08:35','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Manager','P2 normal','ade20d2','Mark Emlyn David Thomas','2010-11-22 06:49:05','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50310 Ensure Servlet info is displayed in Manager application','java/org/apache/catalina/core/StandardWrapper.java\nwebapps/docs/changelog.xml'),(1148,50228,'Bug 50228 – PermGen leak when calling JspFragment.invoke() with a custom Writer','','2010-11-07 03:27:43','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','7ac94d6','Konstantin Kolinko','2010-11-21 22:05:44','Revert r1032232 It broke evaluation of <c:set var=\"v\">value<c:set> https://issues.apache.org/bugzilla/show_bug.cgi?id=50228#c3','java/org/apache/jasper/runtime/PageContextImpl.java'),(1149,50303,'Bug 50303 – typo, improvements to Tomcat 6 doc','','2010-11-19 12:32:17','Tilman Hausherr','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P2 normal','a23dd89','Mark Emlyn David Thomas','2010-11-19 13:49:11','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50303 Update JavaMail download location JAF is included in Java SE 6','webapps/docs/changelog.xml\nwebapps/docs/jndi-resources-howto.xml'),(1150,50293,'Bug 50293 – javax.el.CompositeELResolver synchronization issue','','2010-11-18 16:58:18','Robert Goff','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 normal','7b89af8','Mark Emlyn David Thomas','2010-11-19 13:31:17','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50293 Increase default resolver array size. (Jasper adds 5 resolvers.)','java/javax/el/CompositeELResolver.java\nwebapps/docs/changelog.xml'),(1151,49297,'Bug 49297 – Whitespace absence is allowed before attribute name in a custom tag','','2010-05-15 15:58:53','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 minor','a6006d3','Mark Emlyn David Thomas','2010-11-19 13:21:29','Additional fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=49297 Handle tag directives in a similar manner to page directives','java/org/apache/jasper/compiler/Parser.java\ntest/org/apache/jasper/compiler/TestParser.java\ntest/webapp-3.0/WEB-INF/tags/bug49297.tag\ntest/webapp-3.0/bug49nnn/bug49297Tag.jsp'),(1152,50192,'Bug 50192 – performance issue after revision 746425','','2010-11-01 15:17:42','Robert Goff','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','e075c4b','Mark Emlyn David Thomas','2010-11-12 13:29:12','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50192 Improve performance for EL when running under a security manager. Based on a patch by Robert Goff.','java/org/apache/jasper/el/ELContextImpl.java\njava/org/apache/jasper/el/ELResolverImpl.java\nwebapps/docs/changelog.xml'),(1153,49297,'Bug 49297 – Whitespace absence is allowed before attribute name in a custom tag','','2010-05-15 15:58:53','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 minor','fb89b7a','Mark Emlyn David Thomas','2010-11-12 11:52:02','Additional tests and fixes for https://issues.apache.org/bugzilla/show_bug.cgi?id=49297 Duplicate attribute rules for the page directive are slightly different. Based on a patch by genspring','java/org/apache/jasper/compiler/Parser.java\njava/org/apache/jasper/util/UniqueAttributesImpl.java\ntest/org/apache/jasper/compiler/TestParser.java\ntest/webapp-3.0/bug49nnn/bug49297MultipleImport1.jsp\ntest/webapp-3.0/bug49nnn/bug49297MultipleImport2.jsp\ntest/webapp-3.0/bug49nnn/bug49297MultiplePageEncoding1.jsp\ntest/webapp-3.0/bug49nnn/bug49297MultiplePageEncoding2.jsp\ntest/webapp-3.0/bug49nnn/bug49297MultiplePageEncoding3.jsp\ntest/webapp-3.0/bug49nnn/bug49297MultiplePageEncoding4.jsp\nwebapps/docs/changelog.xml'),(1154,50230,'Bug 50230 – Recursive dependency between the tomcat-catalina-ha and tomcat-catalina','','2010-11-07 21:04:22','Ivan','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Manager','P2 normal','96020cb','Mark Emlyn David Thomas','2010-11-11 17:10:25','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50230 Add new DistributedManager interface that is implemented by the Backup Manager to remove circular dependency between tomcat-catalina-ha and tomcat-catalina modules. Also allows third-party distributed Manager implementations to report full session information through the HTML Manager.','java/org/apache/catalina/DistributedManager.java\njava/org/apache/catalina/ha/session/BackupManager.java\njava/org/apache/catalina/manager/HTMLManagerServlet.java\nwebapps/docs/changelog.xml'),(1155,50252,'Bug 50252 – ClassCastException occurs if context.xml contains <ResourceLink>.','','2010-11-11 01:08:11','Eiji Takahashi','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','7e7283d','Mark Emlyn David Thomas','2010-11-11 08:00:52','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50252 Prevent ClassCastException when using a <ResourceLink>. Patch provided by Eiji Takahashi.','java/org/apache/naming/NamingContext.java\nwebapps/docs/changelog.xml'),(1156,50183,'Bug 50183 – [Tribes] Bio Sender is not scheduling the task to the excecutors','','2010-10-29 16:55:40','Ariel','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Cluster','P2 major','84efb0a','Mark Emlyn David Thomas','2010-11-11 07:51:35','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50183 BIO sender was not scheduling tasks to the executor during normal operation. Patch provided by Ariel.','java/org/apache/catalina/tribes/transport/bio/BioReceiver.java\njava/org/apache/catalina/tribes/transport/bio/BioReplicationTask.java\nwebapps/docs/changelog.xml'),(1157,50169,'Bug 50169 – Trying to register wrapper and welcomeFile to Mapper before context is registered on Mapper.','','2010-10-28 03:21:29','Eiji Takahashi','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','476921f','Mark Emlyn David Thomas','2010-11-11 07:29:40','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50169 Ensure that when a Container is started that it doesn\'t try and register with the mapper unless its parent has already started. Patch provided by Eiji Takahashi.','java/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/core/StandardWrapper.java\nwebapps/docs/changelog.xml'),(1158,49860,'Bug 49860 – getParameters() fails on chunked POST requests with trailers','','2010-09-01 20:12:43','Dan Luca','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Servlet & JSP API','P2 normal','b1ac367','Konstantin Kolinko','2010-11-11 03:53:01','Followup to implementation of https://issues.apache.org/bugzilla/show_bug.cgi?id=49860 Use local variable instead of array access.','java/org/apache/coyote/http11/filters/ChunkedInputFilter.java'),(1159,50222,'Bug 50222 – JreMemoryLeakPreventionListener should speculatively cause memory leaks using the system ClassLoader','JreMemoryLeakPreventionListener intentionally invokes methods known to pin the context ClassLoader in memory in order to avoid having a WebappClassLoader unintentionally pin itself. This may cause undesirable behavior in embedded environments.\n\nInstead, JMLPL could use a security context to temporarily set the current context ClassLoader to be the system ClassLoader and solve the embedded situation without the client having to remember to take this care.','2010-11-05 11:00:08','Christopher Schultz','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','4ca3db3','Mark Emlyn David Thomas','2010-11-10 08:02:55','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50222 Pin the system rather than the common class loader in memory which will work better in an embedded environment.','java/org/apache/catalina/core/JreMemoryLeakPreventionListener.java\nwebapps/docs/changelog.xml'),(1160,50242,'Bug 50242 – Sample log4j configuration does not match default JULI-based configuration','The default configuration for JULI that ships with Tomcat is somewhat complex: it defines a number of handlers and maps application and server logging to each.\n\nThe sample configuration for log4j in the logging documentation is quite simple and just shoves everything into a single log file.\n\nIt would be nicer to include a sample configuration for log4j that mirrors the default one.','2010-11-09 16:38:19','Christopher Schultz','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 enhancement','5869c29','Mark Emlyn David Thomas','2010-11-10 07:20:59','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50242 Provide sample log4j config that is a closer match to the default config','webapps/docs/changelog.xml\nwebapps/docs/logging.xml'),(1161,49860,'Bug 49860 – getParameters() fails on chunked POST requests with trailers','','2010-09-01 20:12:43','Dan Luca','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Servlet & JSP API','P2 normal','ed7a652','Mark Emlyn David Thomas','2010-11-10 06:08:44','Additional fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=49860 Need to store headers in a separate buffer - the contents of the read buffer may not be static for the life of the request','java/org/apache/coyote/http11/filters/ChunkedInputFilter.java'),(1162,49860,'Bug 49860 – getParameters() fails on chunked POST requests with trailers','','2010-09-01 20:12:43','Dan Luca','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Servlet & JSP API','P2 normal','6f04897','Mark Emlyn David Thomas','2010-11-10 06:08:31','kkolinko\'s additional test case for https://issues.apache.org/bugzilla/show_bug.cgi?id=49860 Test for correct handling if read buffer is filled and then re-used','test/org/apache/coyote/http11/filters/TestChunkedInputFilter.java'),(1163,50184,'Bug 50184 – RpcChannel sends the answer without requesting an ACK','','2010-10-29 17:12:34','Ariel','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Cluster','P2 normal','afdc055','Mark Emlyn David Thomas','2010-11-09 12:08:25','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50184 Add an option to the RpcChannel to enable the Channel send options to be set for the reply message. Based on a patch by Ariel.','java/org/apache/catalina/tribes/group/RpcChannel.java\nwebapps/docs/changelog.xml'),(1164,50232,'Bug 50232 – org.apache.catalina.session.StoreBase has a hidden dependency on PersistentManager','','2010-11-08 05:09:39','Tiago Batista','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','b5c24f9','Mark Emlyn David Thomas','2010-11-09 10:31:19','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50232 Remove dependency between StoreBase and PersistentManager and associated code clean-up. Patch provided by Tiago Batista.','java/org/apache/catalina/session/StoreBase.java\nwebapps/docs/changelog.xml'),(1165,50228,'Bug 50228 – PermGen leak when calling JspFragment.invoke() with a custom Writer','','2010-11-07 03:27:43','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','f80234f','Konstantin Kolinko','2010-11-07 04:11:00','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50228 Clear the reference to a writer when BodyContentImpl is recycled.','java/org/apache/jasper/runtime/PageContextImpl.java'),(1166,50168,'Bug 50168 – destory method is called twice while the child is destoryed directly','While calling the method destory() on the StandardContext directly, it seems that the method destoryInternal() is called twice in the LifecycleMBeanBase, the two stacktraces are below :\n    a.  LifecycleMBeanBase.unregister(ObjectName) line: 191   \n         LifecycleMBeanBase.destroyInternal() line: 73   \n         ContainerBase.destroyInternal() line: 1109   \n         StandardContext.destroyInternal() line: 5114   \n         LifecycleBase.destroy() line: 271   \n         ContainerBase.removeChild(Container) line: 963   \n         ContainerBase.destroyInternal() line: 1106   \n         StandardContext.destroyInternal() line: 5114   \n         LifecycleBase.destroy() line: 271   \n         ...\n     b. LifecycleMBeanBase.unregister(ObjectName) line: 191   \n         LifecycleMBeanBase.destroyInternal() line: 73   \n         ContainerBase.destroyInternal() line: 1109   \n         StandardContext.destroyInternal() line: 5114   \n         LifecycleBase.destroy() line: 271\n         ...','2010-10-27 22:47:42','Ivan','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','6eae969','Mark Emlyn David Thomas','2010-11-04 19:03:26','https://issues.apache.org/bugzilla/show_bug.cgi?id=50168 Add a DESTROYING state and associated events and use them to ensure Contexts are only destroyed once.','java/org/apache/catalina/Lifecycle.java\njava/org/apache/catalina/LifecycleState.java\njava/org/apache/catalina/core/AprLifecycleListener.java\njava/org/apache/catalina/core/ContainerBase.java\njava/org/apache/catalina/startup/ContextConfig.java\njava/org/apache/catalina/util/LifecycleBase.java\nwebapps/docs/changelog.xml'),(1167,50127,'Bug 50127 – Possible NPEs in SimpleTCPCluster','','2010-10-20 19:31:02','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','f77368f','Mark Emlyn David Thomas','2010-11-04 15:51:30','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50127 Also fix all the other Eclipse warnings','java/org/apache/catalina/ha/tcp/SimpleTcpCluster.java'),(1168,50159,'Bug 50159 – JNDI context returns new datasource instance each request','Requesting a javax.sql.DataSource via JNDI results in a new instance each time.\n\nIn my particular case I have defined a c3p0 connection pool as follows:\n\n<Resource auth=\"Container\"\n   name=\"jdbc/mydb\"\n   description=\"My Database\"\n   factory=\"org.apache.naming.factory.BeanFactory\"\n   type=\"com.mchange.v2.c3p0.ComboPooledDataSource\"\n   driverClass=\"org.gjt.mm.mysql.Driver\"\n   jdbcUrl=\"jdbc:mysql://localhost:3306/mydb?autoReconnect=true\"\n   user=\"myUserName\"\n   password=\"myPassword\"\n   minPoolSize=\"5\"\n   maxPoolSize=\"50\"\n   acquireIncrement=\"1\"\n   idleConnectionTestPeriod=\"100\"\n   maxIdleTime=\"1800\"\n   preferredTestQuery=\"SELECT 1;\"\n/>\n\nI am using a 3rd party library to access the datasource.  Each time a request is made I can see a new connection pool being created.  With a simple test I was also able to see that the instance being returned was different each time.  Test code:\n\nContext initialContext = new InitialContext();\nreturn ((DataSource)initialContext.lookup(this.dataSource)).getConnection();\n\nWhen comparing the source code for org.apache.naming.NamingContext between 7.02 and 7.04 the following 4 lines of code were removed (line 808):\n\nif (obj != null) {\n   entry.value = obj;\n   entry.type = NamingEntry.ENTRY;\n}\n\nAdding this code back into the class fixes the issue.','2010-10-26 15:46:50','Mark Watson','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 critical','536b25e','Mark Emlyn David Thomas','2010-11-04 13:59:20','https://issues.apache.org/bugzilla/show_bug.cgi?id=50159 Add a new attribute for <Resource> elements, singleton that controls whether or not a new object is created every time a JNDI lookup is performed to obtain the resource. The default value is true, which will return the same instance of the resource in every JNDI lookup.','java/org/apache/catalina/core/NamingContextListener.java\njava/org/apache/catalina/deploy/ContextResource.java\njava/org/apache/naming/NamingContext.java\njava/org/apache/naming/ResourceRef.java\ntest/org/apache/naming/resources/TestNamingContext.java\nwebapps/docs/changelog.xml\nwebapps/docs/config/context.xml'),(1169,49180,'Bug 49180 – Add option to disable log rotation in FileHandler.','Small enhancement to FileHandler.java which allow susers to disable log rotation by setting the .rotation attribute to \"false\".','2010-04-24 13:34:58','Pid','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','7184011','Timothy A. Funk','2010-11-01 11:48:32','bug 49180','java/org/apache/juli/FileHandler.java'),(1170,50157,'Bug 50157 – a lot of MapperListener is registered as ContainerListener of StandardContext','','2010-10-26 03:28:12','Eiji Takahashi','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 minor','53c5d85','Mark Emlyn David Thomas','2010-10-26 18:09:20','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50157 Ensure MapperListener is only added to a container object once. Also  - Improve debug logging for MapperListener registration.  - Expose names of LifecycleListeners and ContainerListers for StandardContext via JMX.','java/org/apache/catalina/connector/LocalStrings.properties\njava/org/apache/catalina/connector/MapperListener.java\njava/org/apache/catalina/core/mbeans-descriptors.xml\njava/org/apache/catalina/mbeans/ContainerMBean.java\nwebapps/docs/changelog.xml'),(1171,50140,'Bug 50140 – Silent installation into wrong target directory','Incorrect silent installation on Windows 2008 Enterprise:\n\nCommand: apachetomcat-6.0.26.exe /S /D=c:\\tomcat\n\nTomcat files are copied to \"c:\\Program Files\" instead of \"c:\\tomcat\"\nThe installation works fine on Windows XP and Windows 2003 Server systems.','2010-10-21 12:54:47','Michael Hopf','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Native:Packaging','P2 normal','5dc34a7','Mark Emlyn David Thomas','2010-10-26 08:30:35','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50140 Don\'t ignore a user specified install directory on 64-bit platforms Allow 32-bit or 64-bit JVMs to be selected when installing on a 64-bit platform','res/jvm.ini\nres/tomcat.nsi\nwebapps/docs/changelog.xml'),(1172,50129,'Bug 50129 – ContextConfig - unnecessary null checks','','2010-10-20 19:48:00','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','509ab5d','Mark Emlyn David Thomas','2010-10-24 10:29:20','Re-factor to avoid IDE warnings re possible nulls. Includes a fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=50129','java/org/apache/catalina/startup/ContextConfig.java'),(1173,50138,'Bug 50138 – Lack of synchronization in org.apache.catalina.security.SecurityUtil','Symptom: all processor threads spin madly in:\n==============\n\"tomcat-processor-20\" daemon prio=10 tid=0x09210800 nid=0x51fb runnable [0x61b76000]\n   java.lang.Thread.State: RUNNABLE\n	at java.util.HashMap.getEntry(HashMap.java:347)\n	at java.util.HashMap.containsKey(HashMap.java:335)\n	at org.apache.catalina.security.SecurityUtil.doAsPrivilege(SecurityUtil.java:227)\n	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:230)\n	at org.apache.catalina.core.ApplicationFilterChain.access$000(ApplicationFilterChain.java:56)\n	at org.apache.catalina.core.ApplicationFilterChain$1.run(ApplicationFilterChain.java:189)\n	at java.security.AccessController.doPrivileged(Native Method)\n	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:185)\n...\n==============\n\nCause: org.apache.catalina.security.SecurityUtil.objectCache is a HashMap, but access to it is not synchronized. The javadoc for HashMap says:\n=============\nNote that this implementation is not synchronized. If multiple threads access a hash map concurrently, and at least one of the threads modifies the map structurally, it must be synchronized externally.\n=============\n\nProposed solution: change objectCache to ConcurrentHashMap;','2010-10-21 09:22:56','Dmitry Mikhaylov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','9d955f4','Mark Emlyn David Thomas','2010-10-21 11:58:21','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50138 Fix threading issues','java/org/apache/catalina/security/SecurityUtil.java\nwebapps/docs/changelog.xml'),(1174,49991,'Bug 49991 – Tomcat 7 JAAS problem with CDI','','2010-09-23 20:01:53','Flávio Henrique','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','d9dbb2f','Mark Emlyn David Thomas','2010-10-19 16:27:39','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49991 Ensure servlet request listeners are fired for the login and error pages during FORM authentication.','java/org/apache/catalina/authenticator/FormAuthenticator.java\nwebapps/docs/changelog.xml'),(1175,49991,'Bug 49991 – Tomcat 7 JAAS problem with CDI','','2010-09-23 20:01:53','Flávio Henrique','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','99fad7e','Mark Emlyn David Thomas','2010-10-19 15:52:28','Re-factor ServletRequestListener events with an eye to https://issues.apache.org/bugzilla/show_bug.cgi?id=49991 and any possible future changes in the Servlet spec','java/org/apache/catalina/Context.java\njava/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/core/StandardContextValve.java'),(1176,50084,'Bug 50084 – catalina.sh fix in #49728 breaks PID handling again','The pid handling fix in #49728 breaks PID handling again.\n\nThe fix now removes empty PID files before start.\nThis doesn\'t work on RHEL5/CentOS5 (and maybe others), where tomcat is started as non-root user.\n\nThe pid files on these OS\'s are in /var/run, which is only writeable by root.\nTherefore, the init.d script creates the pid file and sets the permissions accordinghly.\nThis is not working anymore, as catalina.sh tries to remove this empty file and skips filling the file as it cant remove it.','2010-10-13 08:06:57','Robert Oschwald','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','9853808','Mark Emlyn David Thomas','2010-10-19 10:50:14','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50084 Handle the case where the PID file is readable/writeable but the directory is not','bin/catalina.sh'),(1177,49297,'Bug 49297 – Whitespace absence is allowed before attribute name in a custom tag','','2010-05-15 15:58:53','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 minor','2f5db1f','Mark Emlyn David Thomas','2010-10-19 09:21:05','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49297 Enforce the rules in the JSP specification for parsing the attributes of custom and standard actions that require that the attribute names are unique within an element and that there is whitespace before the attribute name. The whitespace test can be disabled by setting the system property <code>org.apache.jasper.compiler.Parser.STRICT_WHITESPACE</code> to <code>false</code>','java/org/apache/jasper/compiler/Parser.java\njava/org/apache/jasper/resources/LocalStrings.properties\njava/org/apache/jasper/util/UniqueAttributesImpl.java\ntest/org/apache/jasper/compiler/TestParser.java\ntest/org/apache/jasper/compiler/TestParserNoStrictWhitespace.java\ntest/webapp-3.0/WEB-INF/tags/echo.tag\ntest/webapp-3.0/bug49297DuplicateAttr.jsp\ntest/webapp-3.0/bug49297NoSpace.jsp\nwebapps/docs/changelog.xml\nwebapps/docs/config/systemprops.xml'),(1178,50107,'Bug 50107 – StandardPipeline is destroyed two times.','','2010-10-18 03:05:40','Eiji Takahashi','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','44f568f','Mark Emlyn David Thomas','2010-10-19 09:14:13','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50107 When removing a Host via JMX, do not attempt to destroy the host\'s pipeline twice. Patch provided by Eiji Takahashi.','java/org/apache/catalina/mbeans/MBeanFactory.java\nwebapps/docs/changelog.xml'),(1179,50105,'Bug 50105 – Violation of JSP-EL spec version 2.1 when coerce Enum to String','','2010-10-17 05:26:20','Oliver Siegmar','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','e6c1d55','Mark Emlyn David Thomas','2010-10-19 09:03:01','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50105 Use Enum.name() rather than Enum.toString() in composite expressions','java/org/apache/el/parser/AstCompositeExpression.java\ntest/org/apache/el/TestValueExpressionImpl.java\ntest/org/apache/el/TesterEnum.java\nwebapps/docs/changelog.xml'),(1180,22965,'Bug 22965 – [PATCH] Tidy up conf/web.xml','Patch below for conf/web.xml:\n\n- fix minor spelling mistakes\n- reference parameters by \'[parametername]\', parameter values by \"[value]\" for\n  easier reading\n- reindent/format all paragraphs\n- update comments: \n  * default servlet is disabled by default, too\n  * update/add some documentation to \"Welcome File List\"','2003-09-07 12:58:46','Yann Cébron','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 4','Catalina','P3 enhancement','2b11ae0','Mark Emlyn David Thomas','2010-10-16 16:21:36','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=22965 Typos, formatting, etc Based on a patch by Yann Cébron','conf/web.xml\nwebapps/docs/changelog.xml'),(1181,49426,'Bug 49426 – Manager app wrongly localized','','2010-06-11 03:26:07','Marc Guillemot','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Manager','P2 normal','7357867','Mark Emlyn David Thomas','2010-10-16 15:31:37','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49426 Messages displayed to the user in the Manager (text and HTML) should be based on the Locale of the user, not the server','java/org/apache/catalina/manager/HTMLManagerServlet.java\njava/org/apache/catalina/manager/ManagerServlet.java\njava/org/apache/tomcat/util/res/StringManager.java'),(1182,50078,'Bug 50078 – Concurrent access to WeakHashMap in ConcurrentCache causes infinite loop, 100% CPU usage','','2010-10-12 01:10:00','Takayoshi Kimura','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','6105c97','Mark Emlyn David Thomas','2010-10-14 13:37:20','Enhance fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=50078 Make cache sizes configurable','java/javax/el/BeanELResolver.java\njava/org/apache/el/lang/ExpressionBuilder.java\nwebapps/docs/config/systemprops.xml'),(1183,50078,'Bug 50078 – Concurrent access to WeakHashMap in ConcurrentCache causes infinite loop, 100% CPU usage','','2010-10-12 01:10:00','Takayoshi Kimura','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','24494ec','Mark Emlyn David Thomas','2010-10-14 12:36:20','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50078 Thread safety in EL caches. Patch provided by  Takayoshi Kimura','java/javax/el/BeanELResolver.java\njava/org/apache/el/lang/ExpressionBuilder.java\njava/org/apache/el/util/ConcurrentCache.java'),(1184,50087,'Bug 50087 – When metadata-complete=\"false\" throw illegal JVM_CONSTANT_Class name','When metadata-complete=\"false\" and add groovy-all-1.7.2.jar to app lib throw\n\njava.lang.reflect.InvocationTargetException\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n	at java.lang.reflect.Method.invoke(Method.java:597)\n	at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:290)\n	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:418)\nCaused by: java.lang.ClassFormatError: groovy/jmx/builder/package-info : illegal JVM_CONSTANT_Class name: groovy/jmx/builder/package-info\n	at java.lang.ClassLoader.defineClass1(Native Method)\n	at java.lang.ClassLoader.defineClassCond(ClassLoader.java:632)\n	at java.lang.ClassLoader.defineClass(ClassLoader.java:616)\n	at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:141)\n	at org.apache.catalina.loader.WebappClassLoader.findClassInternal(WebappClassLoader.java:2804)\n	at org.apache.catalina.loader.WebappClassLoader.findClass(WebappClassLoader.java:1144)\n	at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1639)\n	at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1517)\n	at org.apache.catalina.startup.ContextConfig.checkHandlesTypes(ContextConfig.java:1952)\n	at org.apache.catalina.startup.ContextConfig.processAnnotationsStream(ContextConfig.java:1915)\n	at org.apache.catalina.startup.ContextConfig.processAnnotationsJar(ContextConfig.java:1802)\n	at org.apache.catalina.startup.ContextConfig.processAnnotationsUrl(ContextConfig.java:1761)\n	at org.apache.catalina.startup.ContextConfig.processAnnotations(ContextConfig.java:1747)\n	at org.apache.catalina.startup.ContextConfig.webConfig(ContextConfig.java:1252)\n	at org.apache.catalina.startup.ContextConfig.configureStart(ContextConfig.java:881)\n	at org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfig.java:315)\n	at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\n	at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:89)\n	at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:4700)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:140)\n	at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:1028)\n	at org.apache.catalina.core.StandardHost.startInternal(StandardHost.java:773)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:140)\n	at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:1028)\n	at org.apache.catalina.core.StandardEngine.startInternal(StandardEngine.java:278)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:140)\n	at org.apache.catalina.core.StandardService.startInternal(StandardService.java:429)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:140)\n	at org.apache.catalina.core.StandardServer.startInternal(StandardServer.java:662)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:140)\n	at org.apache.catalina.startup.Catalina.start(Catalina.java:592)\n	... 6 more','2010-10-13 09:36:12','heyoulin','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','9e7ce59','Mark Emlyn David Thomas','2010-10-14 12:05:55','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50087 Catch ClassFormatErrors when scanning for annotations.','java/org/apache/catalina/startup/ContextConfig.java\nwebapps/docs/changelog.xml'),(1185,49428,'Bug 49428 – Fix WebDAV mounts from Windows Mini-Redirector clients','','2010-06-11 07:34:22','Panagiotis Astithas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','2a64850','Konstantin Kolinko','2010-10-13 10:55:27','Re-implement the fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=49428','java/org/apache/catalina/servlets/WebdavServlet.java'),(1186,49428,'Bug 49428 – Fix WebDAV mounts from Windows Mini-Redirector clients','','2010-06-11 07:34:22','Panagiotis Astithas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','f6281bb','Konstantin Kolinko','2010-10-13 10:03:23','Revert r964780 that was a fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=49428','java/org/apache/catalina/servlets/WebdavServlet.java'),(1187,49922,'Bug 49922 – ApplicationFilterChain more than the same filter','When i web.xml like this:\n\n<filter>\n    <filter-name>Seam Filter</filter-name>\n    <filter-class>org.jboss.seam.servlet.SeamFilter</filter-class>\n  </filter>\n  <filter-mapping>\n    <filter-name>Seam Filter</filter-name>\n    <url-pattern>/app/yofc/*</url-pattern>\n  </filter-mapping>\n  <filter-mapping>\n    <filter-name>Seam Filter</filter-name>\n    <url-pattern>*.seam</url-pattern>\n  </filter-mapping>\n\nthen ApplicationFilterChain have two same Seam Filter.\n\nthis would cause some app error. Patch:\n\nvoid addFilter(ApplicationFilterConfig filterConfig) {\n    	for(ApplicationFilterConfig filter:filters)\n    		if(filter==filterConfig)\n    			return;\n        if (n == filters.length) {\n            ApplicationFilterConfig[] newFilters =\n                new ApplicationFilterConfig[n + INCREMENT];\n            System.arraycopy(filters, 0, newFilters, 0, n);\n            filters = newFilters;\n        }\n        filters[n++] = filterConfig;\n\n    }','2010-09-14 02:32:04','heyoulin','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','13baeea','Mark Emlyn David Thomas','2010-10-13 07:10:30','Better fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=49922 Revert my approach and go with patch suggested by heyoulin. Extend test cases','java/org/apache/catalina/core/ApplicationFilterChain.java\njava/org/apache/catalina/deploy/WebXml.java\njava/org/apache/catalina/startup/ContextConfig.java\ntest/org/apache/catalina/core/TestStandardContext.java\ntest/org/apache/catalina/startup/TestContextConfigAnnotation.java\ntest/webapp-3.0/WEB-INF/web.xml\nwebapps/docs/changelog.xml'),(1188,50044,'Bug 50044 – NIO HTTP connector aborts GET requests incorrectly.','','2010-10-04 21:39:54','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 normal','ac8cdb3','Mark Emlyn David Thomas','2010-10-12 08:10:43','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50044 for NIO connector','java/org/apache/coyote/http11/Http11NioProcessor.java\nwebapps/docs/changelog.xml'),(1189,50044,'Bug 50044 – NIO HTTP connector aborts GET requests incorrectly.','','2010-10-04 21:39:54','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 normal','f4bb92e','Mark Emlyn David Thomas','2010-10-10 18:10:27','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50044 for APR connector','java/org/apache/coyote/http11/Http11AprProcessor.java\njava/org/apache/tomcat/util/net/AprEndpoint.java\nwebapps/docs/changelog.xml'),(1190,50066,'Bug 50066 – Cannot compile recursive tag with ant if it uses a class from the webapp','','2010-10-09 09:49:32','Sylvain Laurent','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 major','79cf689','Mark Emlyn David Thomas','2010-10-10 14:16:00','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50066 Fix building of recursive tag files when the file depends on a JAR file. Patch provided by Sylvain Laurent.','java/org/apache/jasper/compiler/TagFileProcessor.java\nwebapps/docs/changelog.xml'),(1191,50063,'Bug 50063 – Latest trunck can\'t configure context when metadata-complete is true and version is 3.0','','2010-10-08 22:59:40','heyoulin','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','4d7f111','Mark Emlyn David Thomas','2010-10-10 05:58:24','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50063 Fix apps with meta-data complete returning 404s','java/org/apache/catalina/startup/ContextConfig.java\nwebapps/docs/changelog.xml'),(1192,50027,'Bug 50027 – NullPointerException if context.xml is present with <Resource>','If you deploy a WAR with contex.xml in META-INF and the context.xml has <Resource> tag, Tomcat don´t boot and gives this error:\n\njava.lang.NullPointerException\n	at org.apache.catalina.core.StandardContext.getObjectKeyPropertiesNameOnly(StandardContext.java:5570)\n	at org.apache.catalina.core.StandardContext.setNamingResources(StandardContext.java:1757)\n	at org.apache.catalina.core.StandardContext.getNamingResources(StandardContext.java:1735)\n	at org.apache.catalina.startup.SetNextNamingRule.end(SetNextNamingRule.java:99)\n	at org.apache.tomcat.util.digester.Digester.endElement(Digester.java:1058)\n	at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.endElement(AbstractSAXParser.java:601)\n	at com.sun.org.apache.xerces.internal.parsers.AbstractXMLDocumentParser.emptyElement(AbstractXMLDocumentParser.java:180)\n	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanStartElement(XMLDocumentFragmentScannerImpl.java:1343)\n	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(XMLDocumentFragmentScannerImpl.java:2755)\n	at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:648)\n	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:511)\n	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:808)\n	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:737)\n	at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:119)\n	at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(AbstractSAXParser.java:1205)\n	at com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(SAXParserImpl.java:522)\n	at org.apache.tomcat.util.digester.Digester.parse(Digester.java:1544)\n	at org.apache.catalina.startup.Catalina.load(Catalina.java:524)\n	at org.apache.catalina.startup.Catalina.load(Catalina.java:560)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n	at java.lang.reflect.Method.invoke(Method.java:597)\n	at org.apache.catalina.startup.Bootstrap.load(Bootstrap.java:260)\n	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414)\n29/09/2010 13:50:37 org.apache.catalina.startup.Catalina load\nAVISO: Catalina.start using conf/server.xml: \njava.lang.NullPointerException\n	at org.apache.tomcat.util.digester.Digester.createSAXException(Digester.java:2688)\n	at org.apache.tomcat.util.digester.Digester.createSAXException(Digester.java:2714)\n	at org.apache.tomcat.util.digester.Digester.endElement(Digester.java:1061)\n	at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.endElement(AbstractSAXParser.java:601)\n	at com.sun.org.apache.xerces.internal.parsers.AbstractXMLDocumentParser.emptyElement(AbstractXMLDocumentParser.java:180)\n	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanStartElement(XMLDocumentFragmentScannerImpl.java:1343)\n	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(XMLDocumentFragmentScannerImpl.java:2755)\n	at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:648)\n	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:511)\n	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:808)\n	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:737)\n	at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:119)\n	at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(AbstractSAXParser.java:1205)\n	at com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(SAXParserImpl.java:522)\n	at org.apache.tomcat.util.digester.Digester.parse(Digester.java:1544)\n	at org.apache.catalina.startup.Catalina.load(Catalina.java:524)\n	at org.apache.catalina.startup.Catalina.load(Catalina.java:560)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n	at java.lang.reflect.Method.invoke(Method.java:597)\n	at org.apache.catalina.startup.Bootstrap.load(Bootstrap.java:260)\n	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414)\nCaused by: java.lang.NullPointerException\n	at org.apache.catalina.core.StandardContext.getObjectKeyPropertiesNameOnly(StandardContext.java:5570)\n	at org.apache.catalina.core.StandardContext.setNamingResources(StandardContext.java:1757)\n	at org.apache.catalina.core.StandardContext.getNamingResources(StandardContext.java:1735)\n	at org.apache.catalina.startup.SetNextNamingRule.end(SetNextNamingRule.java:99)\n	at org.apache.tomcat.util.digester.Digester.endElement(Digester.java:1058)\n	... 20 more\n29/09/2010 13:50:37 org.apache.tomcat.util.digester.SetPropertiesRule begin\nAVISO: [SetPropertiesRule]{Server/Service/Engine/Host/Context} Setting property \'source\' to \'org.eclipse.jst.jee.server:bestforkprime\' did not find a matching property.\n29/09/2010 13:50:37 org.apache.tomcat.util.digester.Digester endElement\nGRAVE: End event threw exception\njava.lang.NullPointerException\n	at org.apache.catalina.core.StandardContext.getObjectKeyPropertiesNameOnly(StandardContext.java:5570)\n	at org.apache.catalina.core.StandardContext.setNamingResources(StandardContext.java:1757)\n	at org.apache.catalina.core.StandardContext.getNamingResources(StandardContext.java:1735)\n	at org.apache.catalina.startup.SetNextNamingRule.end(SetNextNamingRule.java:99)\n	at org.apache.tomcat.util.digester.Digester.endElement(Digester.java:1058)\n	at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.endElement(AbstractSAXParser.java:601)\n	at com.sun.org.apache.xerces.internal.parsers.AbstractXMLDocumentParser.emptyElement(AbstractXMLDocumentParser.java:180)\n	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanStartElement(XMLDocumentFragmentScannerImpl.java:1343)\n	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(XMLDocumentFragmentScannerImpl.java:2755)\n	at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:648)\n	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:511)\n	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:808)\n	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:737)\n	at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:119)\n	at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(AbstractSAXParser.java:1205)\n	at com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(SAXParserImpl.java:522)\n	at org.apache.tomcat.util.digester.Digester.parse(Digester.java:1544)\n	at org.apache.catalina.startup.Catalina.load(Catalina.java:524)\n	at org.apache.catalina.startup.Catalina.start(Catalina.java:573)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n	at java.lang.reflect.Method.invoke(Method.java:597)\n	at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:288)\n	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:415)\n29/09/2010 13:50:37 org.apache.catalina.startup.Catalina load\nAVISO: Catalina.start using conf/server.xml: \njava.lang.NullPointerException\n	at org.apache.tomcat.util.digester.Digester.createSAXException(Digester.java:2688)\n	at org.apache.tomcat.util.digester.Digester.createSAXException(Digester.java:2714)\n	at org.apache.tomcat.util.digester.Digester.endElement(Digester.java:1061)\n	at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.endElement(AbstractSAXParser.java:601)\n	at com.sun.org.apache.xerces.internal.parsers.AbstractXMLDocumentParser.emptyElement(AbstractXMLDocumentParser.java:180)\n	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanStartElement(XMLDocumentFragmentScannerImpl.java:1343)\n	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(XMLDocumentFragmentScannerImpl.java:2755)\n	at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:648)\n	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:511)\n	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:808)\n	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:737)\n	at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:119)\n	at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(AbstractSAXParser.java:1205)\n	at com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(SAXParserImpl.java:522)\n	at org.apache.tomcat.util.digester.Digester.parse(Digester.java:1544)\n	at org.apache.catalina.startup.Catalina.load(Catalina.java:524)\n	at org.apache.catalina.startup.Catalina.start(Catalina.java:573)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n	at java.lang.reflect.Method.invoke(Method.java:597)\n	at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:288)\n	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:415)\nCaused by: java.lang.NullPointerException\n	at org.apache.catalina.core.StandardContext.getObjectKeyPropertiesNameOnly(StandardContext.java:5570)\n	at org.apache.catalina.core.StandardContext.setNamingResources(StandardContext.java:1757)\n	at org.apache.catalina.core.StandardContext.getNamingResources(StandardContext.java:1735)\n	at org.apache.catalina.startup.SetNextNamingRule.end(SetNextNamingRule.java:99)\n	at org.apache.tomcat.util.digester.Digester.endElement(Digester.java:1058)\n	... 20 more\n29/09/2010 13:50:37 org.apache.catalina.startup.Catalina start\nGRAVE: Cannot start server. Server instance is not configured.\n\nHere is my contex.xml OBS: some values were replaced with XXXX \n\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<Context privileged=\"true\" reloadable=\"true\">\n\n	<WatchedResource>WEB-INF/web.xml</WatchedResource>\n	<WatchedResource>META-INF/context.xml</WatchedResource>\n	\n	<Resource name=\"jdbc/bestfork\" auth=\"Container\"\n		type=\"com.mchange.v2.c3p0.ComboPooledDataSource\" factory=\"org.apache.naming.factory.BeanFactory\"\n		user=\"xxx\" password=\"xxxx\" driverClass=\"org.postgresql.Driver\"\n		jdbcUrl=\"jdbc:postgresql://localhost:5432/xxxxx\" minPoolSize=\"5\"\n		maxPoolSize=\"30\" acquireIncrement=\"5\" idleConnectionTestPeriod=\"100\"\n		maxIdleTime=\"30\"/>\n\n	<Resource name=\"mail/Session\" auth=\"Container\" type=\"javax.mail.Session\"\n		mail.smtp.host=\"xxxx\" mail.smtp.auth=\"true\"\n		username=\"xxx\" password=\"xxx\"\n		mail.user=\"xxxx\" mail.password=\"xxxx\"\n		mail.smtp.port=\"587\" mail.transport.protocol=\"smtp\" mail.debug=\"true\" />\n\n	<Realm className=\"org.apache.catalina.realm.JDBCRealm\"\n		driverName=\"org.postgresql.Driver\" connectionURL=\"jdbc:postgresql://localhost:5432/xxxx\"\n		connectionName=\"xxxx\" connectionPassword=\"xxxx\" userTable=\"usuario\"\n		userNameCol=\"usuario_cpf\" userCredCol=\"usuario_senha\" userRoleTable=\"usuario_papel\"\n		roleNameCol=\"papel_nome\" digest=\"MD5\" />\n				\n\n</Context>','2010-09-29 13:02:53','Flávio Henrique','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P3 regression','6ce21f4','Mark Emlyn David Thomas','2010-10-08 17:46:05','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50027 Avoid NPE on start when a Context is defined in server.xml with one or more JNDI resources.','java/org/apache/catalina/core/StandardContext.java\nwebapps/docs/changelog.xml'),(1193,50059,'Bug 50059 – Resources are not served from /WEB-INF/lib/{*.jar}/META-INF/resources if metadata-complete=\"true\" is set in web.xml','','2010-10-08 07:57:25','Attila Király','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','da36bd1','Mark Emlyn David Thomas','2010-10-08 17:37:19','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50059 Always make JAR resources available','java/org/apache/catalina/startup/ContextConfig.java\nwebapps/docs/changelog.xml'),(1194,50017,'Bug 50017 – Make private immutable fields final','','2010-09-27 20:27:07','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P5 trivial','c4a3427','Mark Emlyn David Thomas','2010-10-08 10:16:23','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50017 Code clean-up. No functional change. Patch provided by sebb','java/javax/el/ValueReference.java\njava/javax/servlet/AsyncEvent.java\njava/javax/servlet/HttpConstraintElement.java\njava/javax/servlet/HttpMethodConstraintElement.java\njava/javax/servlet/MultipartConfigElement.java\njava/javax/servlet/ServletContextAttributeEvent.java\njava/javax/servlet/ServletRequestAttributeEvent.java\njava/javax/servlet/ServletRequestEvent.java\njava/javax/servlet/ServletSecurityElement.java\njava/javax/servlet/UnavailableException.java\njava/javax/servlet/http/HttpSessionBindingEvent.java\njava/javax/servlet/jsp/ErrorData.java\njava/javax/servlet/jsp/tagext/BodyContent.java\njava/javax/servlet/jsp/tagext/FunctionInfo.java\njava/javax/servlet/jsp/tagext/TagAttributeInfo.java\njava/javax/servlet/jsp/tagext/TagData.java\njava/javax/servlet/jsp/tagext/TagExtraInfo.java\njava/javax/servlet/jsp/tagext/TagFileInfo.java\njava/javax/servlet/jsp/tagext/TagVariableInfo.java\njava/javax/servlet/jsp/tagext/ValidationMessage.java\njava/javax/servlet/jsp/tagext/VariableInfo.java\nwebapps/docs/changelog.xml'),(1195,50016,'Bug 50016 – bad division of responsibility around isUserInRole and new Request login and logout methods','','2010-09-27 16:56:39','david jencks','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','469a916','Mark Emlyn David Thomas','2010-10-08 10:02:05','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50016 Re-factor isUserInRole() and login() / logout() methods to support JACC implementations and to improve encapsulation. Patch provided by David Jencks.','java/org/apache/catalina/Authenticator.java\njava/org/apache/catalina/Realm.java\njava/org/apache/catalina/authenticator/AuthenticatorBase.java\njava/org/apache/catalina/authenticator/BasicAuthenticator.java\njava/org/apache/catalina/authenticator/DigestAuthenticator.java\njava/org/apache/catalina/authenticator/FormAuthenticator.java\njava/org/apache/catalina/authenticator/LocalStrings.properties\njava/org/apache/catalina/authenticator/NonLoginAuthenticator.java\njava/org/apache/catalina/authenticator/SSLAuthenticator.java\njava/org/apache/catalina/connector/LocalStrings.properties\njava/org/apache/catalina/connector/Request.java\njava/org/apache/catalina/realm/RealmBase.java\njava/org/apache/catalina/realm/UserDatabaseRealm.java\nwebapps/docs/changelog.xml'),(1196,50015,'Bug 50015 – dynamic servlet security incomplete and badly distributed','The current implementation of dynamic servlet security through ServletRegistration.Dynamic.setServletSecurity and the ServletContext.createServlet and addServlet methods is incomplete, and includes some logic that exposes internals of the tomcat security framework directly in the ServletRegistration.Dynamic implementation.\n\nThe attached patch:\n\n- moves the logic that depends on the internals of tomcats security implementation from ApplicationServletRegistration to StandardContext where it can at least be overridden by e.g. jacc implementations\n\n- provides notifications to StandardContext of users calling createServlet and addServlet on ApplicationContext/ServletContext so subclasses of StandardContext can implement the spec behavior without subclassing ApplicationContext.\n\nThis patch is generated from a tomcat copy that already has several other patches I\'ve proposed applied.  Let me know if there are problems applying it.','2010-09-27 16:22:54','david jencks','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','11e513d','Mark Emlyn David Thomas','2010-10-08 09:22:04','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50015 Re-factor dynamic servlet security implementation to make extensions, such as JACC implementations, simpler. Patch provided by David Jencks.','java/org/apache/catalina/Context.java\njava/org/apache/catalina/core/ApplicationContext.java\njava/org/apache/catalina/core/ApplicationServletRegistration.java\njava/org/apache/catalina/core/StandardContext.java\nwebapps/docs/changelog.xml'),(1197,48716,'Bug 48716 – Embedded Tomcat JULI aggressively resetting default logging configuration','When using Tomcat embedded in conjunction with default JDK logging, any removal of a StandardContext instance from the Host container will lead to a reset of all JDK logging configuration.\n\nThis is due to \n\nStandardContext.stop() \n\ncalling \n\nWebappLoader.stop() \n\ncalling \n\norg.apache.juli.logging.LogFactory.release(ClassLoader) \n\nwhich in turn calls \n\nLogManager.getLogManager().reset();\n\nand the fact that, when using JDK logging, LogManager.getLogManager returns the default log manager rather that JULI\'s log manager. \n\nSuggestion: Check whether the log manager is actually JULI\'s.','2010-02-09 14:29:26','Henning Blohm','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','34d7380','Mark Emlyn David Thomas','2010-10-08 08:21:55','Additional fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=48716 Don\'t call reset if the default LngManager is in use','java/org/apache/juli/logging/LogFactory.java'),(1198,50013,'Bug 50013 – missing classes when running catalina ant tasks','With trunk after 7.0.2 :\n\n- tomcat-util.jar is missing in /bin/catalina-tasks.xml\n- even after adding this, I still have a NoClassDefFoundError for org.apache.tomcat.util.file.Matcher . Apparently this is a new class in a new package and the build script does not put it in any jar built.','2010-09-27 13:15:09','Sylvain Laurent','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','fc90c29','Mark Emlyn David Thomas','2010-10-08 08:10:28','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50013 Correctly package classes from org.apache.tomcat.util.file and add the tomcat-util.jar to the class path for the Ant tasks. Based on a patch provided by Sylvain Laurent.','bin/catalina-tasks.xml\nbuild.xml\nwebapps/docs/changelog.xml'),(1199,49994,'Bug 49994 – NamingContext Possible Bug','In NamingContext implementation, if \"lookup()\" is a Reference, current\nimplementation caches the result of the NamingManager # getObjectInstance via\nfollowing statements and changes the type of the entry. In the following\nlookups, same object is returned. I would like to write ObjectFactory that\nreturns new instance for each time lookup is called on its reference. But with\nthe current implementation, it is not possible to write such an object factory\nbecause of aferomentioned sitaution. I think that entry must be stay as\nReference instead of changing entry type.\n\nNamingContext class:\n\nprotected Object lookup(Name name, boolean resolveLinks)\n        throws NamingException {\n.....\n            } else if (entry.type == NamingEntry.REFERENCE) {\n                try {\n                    Object obj = NamingManager.getObjectInstance\n                        (entry.value, name, this, env);\n                    if (obj != null) {\n                        entry.value = obj;                           \n                        entry.type = NamingEntry.ENTRY;  ---> CHANGES type of\nthe naming entry\n                    }\n                    return obj;\n                } catch (NamingException e) {\n                    throw e;\n                } catch (Exception e) {\n                    log.warn(sm.getString\n                            (\"namingContext.failResolvingReference\"), e);\n                    throw new NamingException(e.getMessage());\n                }\n            }\n\n...........\n}','2010-09-24 07:59:24','Gurkan Erdogdu','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','ec28a9a','Mark Emlyn David Thomas','2010-10-08 07:57:57','Add test cases for: - https://issues.apache.org/bugzilla/show_bug.cgi?id=49994 - https://issues.apache.org/bugzilla/show_bug.cgi?id=23950 Based on the original test case for bug 23950 provided by Eli Miller','test/org/apache/naming/resources/TestNamingContext.java\ntest/org/apache/naming/resources/TesterFactory.java\ntest/org/apache/naming/resources/TesterObject.java'),(1200,23950,'Bug 23950 – [PATCH] Context.listBindings(...) broken?','','2003-10-20 17:56:35','Eli Miller','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 4','Catalina','P3 normal','ec28a9a','Mark Emlyn David Thomas','2010-10-08 07:57:57','Add test cases for: - https://issues.apache.org/bugzilla/show_bug.cgi?id=49994 - https://issues.apache.org/bugzilla/show_bug.cgi?id=23950 Based on the original test case for bug 23950 provided by Eli Miller','test/org/apache/naming/resources/TestNamingContext.java\ntest/org/apache/naming/resources/TesterFactory.java\ntest/org/apache/naming/resources/TesterObject.java'),(1201,23950,'Bug 23950 – [PATCH] Context.listBindings(...) broken?','','2003-10-20 17:56:35','Eli Miller','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 4','Catalina','P3 normal','ec28a9a','Mark Emlyn David Thomas','2010-10-08 07:57:57','Add test cases for: - https://issues.apache.org/bugzilla/show_bug.cgi?id=49994 - https://issues.apache.org/bugzilla/show_bug.cgi?id=23950 Based on the original test case for bug 23950 provided by Eli Miller','test/org/apache/naming/resources/TestNamingContext.java\ntest/org/apache/naming/resources/TesterFactory.java\ntest/org/apache/naming/resources/TesterObject.java'),(1202,49994,'Bug 49994 – NamingContext Possible Bug','In NamingContext implementation, if \"lookup()\" is a Reference, current\nimplementation caches the result of the NamingManager # getObjectInstance via\nfollowing statements and changes the type of the entry. In the following\nlookups, same object is returned. I would like to write ObjectFactory that\nreturns new instance for each time lookup is called on its reference. But with\nthe current implementation, it is not possible to write such an object factory\nbecause of aferomentioned sitaution. I think that entry must be stay as\nReference instead of changing entry type.\n\nNamingContext class:\n\nprotected Object lookup(Name name, boolean resolveLinks)\n        throws NamingException {\n.....\n            } else if (entry.type == NamingEntry.REFERENCE) {\n                try {\n                    Object obj = NamingManager.getObjectInstance\n                        (entry.value, name, this, env);\n                    if (obj != null) {\n                        entry.value = obj;                           \n                        entry.type = NamingEntry.ENTRY;  ---> CHANGES type of\nthe naming entry\n                    }\n                    return obj;\n                } catch (NamingException e) {\n                    throw e;\n                } catch (Exception e) {\n                    log.warn(sm.getString\n                            (\"namingContext.failResolvingReference\"), e);\n                    throw new NamingException(e.getMessage());\n                }\n            }\n\n...........\n}','2010-09-24 07:59:24','Gurkan Erdogdu','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','ce39a3c','Mark Emlyn David Thomas','2010-10-08 07:57:04','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49994 Lookup of JNDI references should return a new object instance each time','java/org/apache/naming/NamingContext.java\njava/org/apache/naming/NamingContextBindingsEnumeration.java'),(1203,49987,'Bug 49987 – Data race in ApplicationContext','','2010-09-23 10:16:06','Sergey Vorobyev','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P3 minor','2db864e','Mark Emlyn David Thomas','2010-10-07 17:53:55','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49987 Fix thread safety issue with population of servlet context initialization parameters.','java/org/apache/catalina/core/ApplicationContext.java\njava/org/apache/catalina/core/StandardContext.java\nwebapps/docs/changelog.xml'),(1204,49986,'Bug 49986 – Double-check locking. Possible data-race in JspServletWrapper','','2010-09-23 09:31:03','Sergey Vorobyev','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','2570d6ff','Mark Emlyn David Thomas','2010-10-07 10:34:29','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49986 Thread safety issues in JSP reload process. (timw)','java/org/apache/jasper/servlet/JspServletWrapper.java'),(1205,49978,'Bug 49978 – WebappLoader throws exception if workDir already exists (when unpackWARs=false)','In WebappLoader.setRepositories(), if the war is not unpacked, it tries to create a directory /WEB-INF/classes inside the workDir.  If that directory already exists, an error is thrown and the webapp does not start.\n\nThis is a change from 5.5, which didn\'t check the return value of classRepository.mkdirs().  mkdirs() returns false if the directories already exist.  I doubt it was the intention here.  Probably the intention was to throw an exception if the directory could not be created, rather than if it already existed.','2010-09-22 14:11:28','Jim Frederic','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','b0051c8','Mark Emlyn David Thomas','2010-10-07 10:13:44','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49978 Don\'t try to create directories that already exist','java/org/apache/catalina/loader/WebappLoader.java'),(1206,49972,'Bug 49972 – Double-check idiom. Possible data-race.','','2010-09-22 04:44:02','Sergey Vorobyev','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Manager application','P2 normal','0ae33cb','Mark Emlyn David Thomas','2010-10-07 10:05:51','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49972 Address potential thread safety issues.','java/org/apache/tomcat/util/http/FastHttpDateFormat.java'),(1207,50054,'Bug 50054 – When the AJP connector is used, minSpareThreads cannot be used.','I found following warnning messages. \n\n==\nOct 7, 2010 2:25:27 PM org.apache.catalina.startup.SetAllPropertiesRule begin\nWARNING: [SetAllPropertiesRule]{Server/Service/Connector} Setting property \'minSpareThreads\' to \'31\' did not find a matching property.\n==\n\nThe AJP connector\'s configs are the following. \n<Connector port=\"8009\" protocol=\"AJP/1.3\" redirectPort=\"8443\" minSpareThreads=\"100\"/>\n\nWhen I used the Http connector, minSpareThreads was able to be used. \n\norg.apache.coyote.ajp.AjpProtocol doesn\'t set the minSpareThreads to org.apache.tomcat.util.net.JIoEndpoint.\n\nI made a patch.\nThis patch was made based on AbstractHttp11Protocol. \n\nBest regards.','2010-10-07 04:22:51','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 normal','654c964','Keiichi Fujino','2010-10-07 04:54:51','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50054 Correctly handle the setting of minSpareThreads in AJP connector. Other attributes (acceptorThreadCount etc.) are correctly set by this fix.','java/org/apache/coyote/ajp/AbstractAjpProtocol.java\njava/org/apache/coyote/ajp/AjpAprProtocol.java\njava/org/apache/coyote/ajp/AjpProtocol.java\nwebapps/docs/changelog.xml'),(1208,49957,'Bug 49957 – Work directories of deployed webapps are deleted at shutdown','','2010-09-19 11:39:18','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 regression','03ea590','Mark Emlyn David Thomas','2010-10-06 18:54:13','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49957 Correct regression due to Lifecycle re-factoring that cleared all work directories (with compiled JSPs and persisted sessions) when Tomcat was stopped.','java/org/apache/catalina/startup/HostConfig.java\njava/org/apache/catalina/startup/LocalStrings.properties\nwebapps/docs/changelog.xml'),(1209,49956,'Bug 49956 – @Resource(name=) Normalization of JNDI Name','','2010-09-17 20:15:03','Gurkan Erdogdu','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','0e71157','Mark Emlyn David Thomas','2010-10-06 17:58:37','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49956 Handle case when @Resource annotation uses the full JNDI name for a resource. Based on a patch by Gurkan Erdogdu.','java/org/apache/catalina/core/DefaultInstanceManager.java\nwebapps/docs/changelog.xml'),(1210,49952,'Bug 49952 – ServletContainerInitializer can\'t actually add listeners','','2010-09-17 13:49:20','david jencks','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','937227a','Mark Emlyn David Thomas','2010-10-06 17:46:43','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49952 Allow ServletContainerInitializers to add listeners to a web application. Patch provided by David Jencks.','java/org/apache/catalina/core/LocalStrings.properties\njava/org/apache/catalina/core/StandardContext.java\ntest/org/apache/catalina/startup/TestListener.java\nwebapps/docs/changelog.xml'),(1211,50026,'Bug 50026 – DefaultServlet serves META-INF and WEB-INF from root when remapped on /folder/*','','2010-09-29 11:25:46','balusc','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P3 enhancement','fd27668','Tim Whittington','2010-10-06 03:22:46','More fixes for https://issues.apache.org/bugzilla/show_bug.cgi?id=50026 Calculating complete resource path when accessed via RequestDispatcher.include()','java/org/apache/catalina/servlets/DefaultServlet.java'),(1212,49669,'Bug 49669 – Static reference from  javax.security.auth.Policy.contextClassLoader prevents an undeployed Web application from being garbage collected','','2010-07-29 10:19:23','Arjen Knibbe','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','72545c1','Konstantin Kolinko','2010-10-05 21:03:29','Amending the fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=49669 Do not depend on the deprecated class. Use reflection instead.','java/org/apache/catalina/core/JreMemoryLeakPreventionListener.java\njava/org/apache/catalina/core/LocalStrings.properties\nwebapps/docs/config/listeners.xml'),(1213,49669,'Bug 49669 – Static reference from  javax.security.auth.Policy.contextClassLoader prevents an undeployed Web application from being garbage collected','','2010-07-29 10:19:23','Arjen Knibbe','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','d4281fc','Mark Emlyn David Thomas','2010-10-05 03:30:54','Correct fix fot 49669','java/org/apache/catalina/core/JreMemoryLeakPreventionListener.java\nwebapps/docs/changelog.xml'),(1214,50026,'Bug 50026 – DefaultServlet serves META-INF and WEB-INF from root when remapped on /folder/*','','2010-09-29 11:25:46','balusc','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P3 enhancement','3530095','Tim Whittington','2010-10-04 22:57:25','Updating changelog with fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=50026','webapps/docs/changelog.xml'),(1215,49945,'Bug 49945 – Continuation of JMX Descriptor Improvements','','2010-09-17 01:09:05','chamith buddhika','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','ae0cf97','Mark Emlyn David Thomas','2010-10-04 17:24:55','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49945 More JMX improvements. Patch provided by Chamith Buddhika.','java/org/apache/catalina/core/mbeans-descriptors.xml\njava/org/apache/catalina/startup/mbeans-descriptors.xml\nwebapps/docs/changelog.xml'),(1216,50026,'Bug 50026 – DefaultServlet serves META-INF and WEB-INF from root when remapped on /folder/*','','2010-09-29 11:25:46','balusc','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P3 enhancement','b628789','Tim Whittington','2010-10-04 16:37:11','More fixes for https://issues.apache.org/bugzilla/show_bug.cgi?id=50026 Calculating path prefix used in listings correctly so links in listings produced by WebdavServlet mounted to a subpath are correct.','java/org/apache/catalina/servlets/DefaultServlet.java\njava/org/apache/catalina/servlets/WebdavServlet.java'),(1217,50026,'Bug 50026 – DefaultServlet serves META-INF and WEB-INF from root when remapped on /folder/*','','2010-09-29 11:25:46','balusc','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P3 enhancement','29c6f93','Tim Whittington','2010-10-04 16:33:57','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50026 for WebdavServlet Factored checking of special WEB-INF and META-INF paths into service to trap requests for GET methods handled by DefaultServlet (which does not check access). Retained checking of special paths in handlers for copy, delete, move (copy + delete), and in enumeration of resources (propfind).','java/org/apache/catalina/servlets/WebdavServlet.java'),(1218,50026,'Bug 50026 – DefaultServlet serves META-INF and WEB-INF from root when remapped on /folder/*','','2010-09-29 11:25:46','balusc','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P3 enhancement','89b9b75','Tim Whittington','2010-10-04 16:19:09','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50026 Always calculate path of resource to be served relative to the context root. This invokes the standard protection of WEB-INF and META-INF directories. This is a breaking change for the unofficial use of DefaultServlet to remount the webapp base under a new path.','java/org/apache/catalina/servlets/DefaultServlet.java'),(1219,49923,'Bug 49923 – The latest thunk can\'t shutdown if add tomcat native java library dll','The latest thunk can\'t shutdown if add tomcat native java library dll','2010-09-14 02:34:35','heyoulin','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','b2afc78','Mark Emlyn David Thomas','2010-10-04 05:30:13','Mladen fixed 49923','webapps/docs/changelog.xml'),(1220,49923,'Bug 49923 – The latest thunk can\'t shutdown if add tomcat native java library dll','The latest thunk can\'t shutdown if add tomcat native java library dll','2010-09-14 02:34:35','heyoulin','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','f07c867','Mladen Turk','2010-10-04 05:22:03','Fix 49923 by making sure timeouts can\'t be negative','java/org/apache/tomcat/util/net/AbstractEndpoint.java'),(1221,49937,'Bug 49937 – Problems with AsyncListener and resource injection','','2010-09-16 01:49:41','david jencks','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','cf4e575','Mark Emlyn David Thomas','2010-10-03 16:53:49','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49937 Use InstanceManager to create AsyncListeners so annotations are processed. Based on a patch by David Jencks.','java/org/apache/catalina/core/AsyncContextImpl.java\nwebapps/docs/changelog.xml'),(1222,49922,'Bug 49922 – ApplicationFilterChain more than the same filter','When i web.xml like this:\n\n<filter>\n    <filter-name>Seam Filter</filter-name>\n    <filter-class>org.jboss.seam.servlet.SeamFilter</filter-class>\n  </filter>\n  <filter-mapping>\n    <filter-name>Seam Filter</filter-name>\n    <url-pattern>/app/yofc/*</url-pattern>\n  </filter-mapping>\n  <filter-mapping>\n    <filter-name>Seam Filter</filter-name>\n    <url-pattern>*.seam</url-pattern>\n  </filter-mapping>\n\nthen ApplicationFilterChain have two same Seam Filter.\n\nthis would cause some app error. Patch:\n\nvoid addFilter(ApplicationFilterConfig filterConfig) {\n    	for(ApplicationFilterConfig filter:filters)\n    		if(filter==filterConfig)\n    			return;\n        if (n == filters.length) {\n            ApplicationFilterConfig[] newFilters =\n                new ApplicationFilterConfig[n + INCREMENT];\n            System.arraycopy(filters, 0, newFilters, 0, n);\n            filters = newFilters;\n        }\n        filters[n++] = filterConfig;\n\n    }','2010-09-14 02:32:04','heyoulin','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','e9002cb','Mark Emlyn David Thomas','2010-10-03 13:27:42','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49922 Don\'t map filter twice if filter matches multiple mapping.','java/org/apache/catalina/deploy/FilterMap.java\njava/org/apache/catalina/deploy/WebXml.java\njava/org/apache/catalina/startup/ContextConfig.java\ntest/org/apache/catalina/core/TestStandardContext.java\ntest/org/apache/catalina/startup/TestContextConfigAnnotation.java\ntest/webapp-3.0/WEB-INF/web.xml'),(1223,49998,'Bug 49998 – ParserController.hasJspRoot() does not detect JSP as using XML syntax if <jsp:root> namespace declaration uses \' delimiters instead of \"','','2010-09-24 16:25:42','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','8e582bf','Konstantin Kolinko','2010-10-03 13:03:05','Correct changelog entry for r1003923 7.0.3 was cut from r1003911, so this one will be in 7.0.4 as Mark noted in BZ Correct a typo in the bug number. It is BZ 49998','webapps/docs/changelog.xml'),(1224,49998,'Bug 49998 – ParserController.hasJspRoot() does not detect JSP as using XML syntax if <jsp:root> namespace declaration uses \' delimiters instead of \"','','2010-09-24 16:25:42','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','2c10c83','Tim Whittington','2010-10-03 02:53:15','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49998 Handle single quoted attributes in detection of jsp:root element in XML syntax JSP files.','java/org/apache/jasper/compiler/ParserController.java\nwebapps/docs/changelog.xml'),(1225,49799,'Bug 49799 – The new JSP 2.2 omit-attribute in jsp:attribute does not work with EL or expressions','','2010-08-22 16:44:10','PhilippJ','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','557ef4e','Mark Emlyn David Thomas','2010-10-02 17:14:37','Fix NPE and TCK failures caused by previous fix for bug 49799.','java/org/apache/jasper/compiler/Generator.java'),(1226,49985,'Bug 49985 – Lazy initialization without any synchronization - data race in AstInteger, AstFloatingPoint, AstString','','2010-09-23 08:55:42','Sergey Vorobyev','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','b893eee','Mark Emlyn David Thomas','2010-10-02 14:53:30','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49985 Make thread safe','java/org/apache/el/parser/AstFloatingPoint.java\njava/org/apache/el/parser/AstInteger.java\njava/org/apache/el/parser/AstString.java\nwebapps/docs/changelog.xml'),(1227,49916,'Bug 49916 – use an init-param for jspFile on explicit jsp servlets','','2010-09-11 02:10:28','david jencks','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','029af40','Mark Emlyn David Thomas','2010-10-01 13:29:03','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49916 Switch to using an initialisation parameter to pass JSP file information from Catalina to Jasper. This simplifies the Catalina code as well as making it easier for Geronimo and others to integrate Jasper. Patch provided by David Jencks.','java/org/apache/catalina/Context.java\njava/org/apache/catalina/Globals.java\njava/org/apache/catalina/Wrapper.java\njava/org/apache/catalina/core/ApplicationDispatcher.java\njava/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/core/StandardWrapper.java\njava/org/apache/catalina/core/StandardWrapperValve.java\njava/org/apache/catalina/deploy/WebXml.java\njava/org/apache/catalina/startup/ContextConfig.java\njava/org/apache/jasper/servlet/JspServlet.java\nwebapps/docs/changelog.xml'),(1228,49915,'Bug 49915 – [Patch] o.a.c.c.StandardServer swallows error on storeConfig.','When o.a.c.c.StandardServer#storeConfig is called all exceptions were getting swallowed. \n\nThis lead to the impresssion it was working correctly when saved either through the manager application /manager/save or through jconsole.\n\nI\'ve removed the catch throwable block and thrown an exception upon not finding the registerd MBean.','2010-09-10 19:35:43','Wesley','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','5eb3851','Mark Emlyn David Thomas','2010-10-01 12:49:29','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49915 Make error more obvious, particularly when accessed via JConsole, if StandardServer.storeConfig() is called when there is no StoreConfig implementation present.','java/org/apache/catalina/core/StandardServer.java\nwebapps/docs/changelog.xml'),(1229,49905,'Bug 49905 – In cluster, when using DeltaManager memory leak can occur','','2010-09-09 07:22:00','Ruslan','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Cluster','P2 normal','2c858be','Mark Emlyn David Thomas','2010-10-01 12:32:31','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49905 Prevent memory leak when using aysnc session replication','java/org/apache/catalina/tribes/group/interceptors/MessageDispatch15Interceptor.java\njava/org/apache/catalina/tribes/util/TcclThreadFactory.java'),(1230,49890,'Bug 49890 – Nio Selector issue on linux platform','','2010-09-07 09:17:54','Andrey Timofeev','Tomcat Developers Mailing List','RESOLVED WONTFIX','Tomcat 6','Connectors','P2 major','f4de5ab','Mark Emlyn David Thomas','2010-10-01 10:54:53','https://issues.apache.org/bugzilla/show_bug.cgi?id=49890 Detect when the JVM bug occurs and log an error asking for more information.','java/org/apache/tomcat/util/net/NioEndpoint.java\njava/org/apache/tomcat/util/net/res/LocalStrings.properties\nwebapps/docs/changelog.xml'),(1231,49861,'Bug 49861 – Log format of RMI ports can be improved, remove \",\"','','2010-09-02 04:42:55','Peter Bieringer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 minor','00cc8c6','Mark Emlyn David Thomas','2010-10-01 07:37:05','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49861 Don\'t use commas when logging RMI port values','java/org/apache/catalina/mbeans/JmxRemoteLifecycleListener.java\nwebapps/docs/changelog.xml'),(1232,49667,'Bug 49667 – JdbcLeakPrevention class can register unregistered JCBC Driver','','2010-07-29 09:31:33','Arjen Knibbe','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','dc754cc','Mark Emlyn David Thomas','2010-10-01 07:10:51','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49667 Ensure JDBC leak prevention code doesn\'t trigger the very memory leak it is meant to be fixing.','java/org/apache/catalina/loader/JdbcLeakPrevention.java\nwebapps/docs/changelog.xml'),(1233,49860,'Bug 49860 – getParameters() fails on chunked POST requests with trailers','','2010-09-01 20:12:43','Dan Luca','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Servlet & JSP API','P2 normal','19b997c','Mark Emlyn David Thomas','2010-10-01 06:21:58','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49860 Add support for trailing headers','java/org/apache/coyote/http11/filters/ChunkedInputFilter.java\ntest/org/apache/coyote/http11/filters/TestChunkedInputFilter.java\nwebapps/docs/changelog.xml'),(1234,49856,'Bug 49856 – Connector/ThreadPool link to Executor not exposed via JMX','When viewing either Connector objects or ThreadPool objects via JMX the name of the executor is not shown. It would be helpful if this were exposed via JMX so the links between Connectors/ThreadPools and Executors could be determined.','2010-09-01 03:24:08','Mark Thomas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','167829c','Mark Emlyn David Thomas','2010-09-30 17:47:46','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49856 Add an executorName attribute to Connectors so it is possible to trace ThreadPool to Connector to Executor via JMX.','java/org/apache/catalina/connector/Connector.java\njava/org/apache/catalina/connector/mbeans-descriptors.xml\nwebapps/docs/changelog.xml'),(1235,49730,'Bug 49730 – Race condition in StandardThreadExecutor : requests are sometimes enqueued instead of creating new threads','In tomcat 6, I often configure an Executor with minSpareThreads=0 to work around memory leak issues upon redeployment.\n\nSometimes (especially in development), when I refresh a page of my webapp with Safari, Chrome or Firefox, some resources of the page take several seconds (>10s) to be served though they are static resources and should come in less than 50ms. For instance, over 15 requests for a page (1 for html, the others for resources like js, css, images...), I sometimes have 1 or 2 that take >10s. \n\nAfter analysis, I found that in org.apache.catalina.core.StandardThreadExecutor.TaskQueue.offer(Runnable) the statement \nif (parent.getActiveCount()<(parent.getPoolSize()))\nis sometimes true unexpectedly. Here is the scenario :\n\n- ThreadPoolExecutor is empty\n- the user refreshes the page (or accesses it with an empty cache) in his web browser for a page that uses a more than 10-15 resources\n- the browser establishes one TCP connection and a new Thread is created\n- after the browser receives the response, it decides to load as many resources as possible in parallel. For this it establishes up to 6 TCP connections (in my tests)\n- The Acceptor thread calls StandardThreadExecutor.execute to process each incoming connection.\n- For each call, StandardThreadExecutor.TaskQueue.offer(Runnable) is being called\n- if you study the sources of Java 6 ThreadPoolExecutor, you can see that there\'s a small delay between the time a new Thread is created (thus increasing poolSize) and the time it starts working on its first task (increasing the activeCount)\n- Since in my case connections are established in a rapid burst, the calls to TaskQueue.offer() are sometimes faster than this small delay, so that we do have parent.getActiveCount()<parent.getPoolSize() and thus the task is enqueued instead of forcing the creation of a thread to serve it.\n- Since Keep-Alive is enabled and tomcat 6 threads take care of only one TCP connection at a time, the requests in the queue must wait for the keep-alive timeout so that a Thread is returned to the pool to serve pending tasks.\n- With 25s keepAliveTimeOut, it means that some requests take more than 25s to be served eventhough the pool was never full and the server quite idle!!!\n\nOther facts about this issue :\n- Although my test case starts with an empty pool, it can occur even on a loaded server. The thing that triggers the issue is the burst of new TCP connections.\n- The problem is less severe with a lower keepAliveTimeout, or if keepalive is disabled. In any case, it also depends on the time taken to serve current requests.\n- The issue also affects tomcat 7 but is less severe because tc7 threads are returned to the pool after each http request, even if the TCP connection is kept alive. The impact would the same as with tc6 with keepAlive disabled.','2010-08-09 16:16:04','Sylvain Laurent','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','2bfc300','Mark Emlyn David Thomas','2010-09-30 13:56:42','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49730 Race condition in executor can lead to long delays in request processing','java/org/apache/tomcat/util/threads/TaskQueue.java\njava/org/apache/tomcat/util/threads/ThreadPoolExecutor.java\nwebapps/docs/changelog.xml'),(1236,50021,'Bug 50021 – ExceptionUtils class missing from bootstrap.jar','o.a.c.startup.Bootstrap uses o.a.jasper.util.ExceptionUtils, but this class is not placed in bootstrap.jar, causing rather nasty failures if anything goes wrong during initial bootstrapping.\n\nThis should be a fairly simple matter of updating build.xml to include it, but I wasn\'t sure whether including Jasper classes in the bootstrap was the done thing.\nThere\'s an o.a.tomcat.util.ExceptionUtils that is identical, but that too looks like the wrong thing to grab.','2010-09-29 03:43:11','Tim Whittington','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 critical','6c22816','Mark Emlyn David Thomas','2010-09-29 06:15:51','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=50021 Don\'t reference ExceptionUtisl from Bootstrap - it won\'t be visible at startup.','java/org/apache/catalina/startup/Bootstrap.java\nwebapps/docs/changelog.xml'),(1237,48644,'Bug 48644 – Code should never ignore throwable','There seem to be quite a few places where code catches Throwable and ignores it.\n\nFor example:\n\nant.jmx.JMXAccessorQueryTask.bindAttributes\nant.jmx.JMXAccessorTask.execute\ncore.StandardContext - lots of methods\n\nIn most cases, catching Exception would be enough.','2010-01-30 17:20:32','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','132e68b','Mark Emlyn David Thomas','2010-09-29 06:07:10','Fix error in fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=48644 Should use ExcpetionUtils from o.a.tomcat.util, not o.a.jasper.util Fixed with the help of Eclipe\'s organise imports that also removed a few unused imports.','java/org/apache/catalina/authenticator/FormAuthenticator.java\njava/org/apache/catalina/connector/CoyoteAdapter.java\njava/org/apache/catalina/connector/Request.java\njava/org/apache/catalina/core/ApplicationContext.java\njava/org/apache/catalina/core/ApplicationContextFacade.java\njava/org/apache/catalina/core/ApplicationDispatcher.java\njava/org/apache/catalina/core/ApplicationFilterChain.java\njava/org/apache/catalina/core/ContainerBase.java\njava/org/apache/catalina/core/DefaultInstanceManager.java\njava/org/apache/catalina/core/JasperListener.java\njava/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/core/StandardContextValve.java\njava/org/apache/catalina/core/StandardHost.java\njava/org/apache/catalina/core/StandardHostValve.java\njava/org/apache/catalina/core/StandardServer.java\njava/org/apache/catalina/core/StandardWrapperValve.java\njava/org/apache/catalina/ha/authenticator/ClusterSingleSignOn.java\njava/org/apache/catalina/loader/WebappClassLoader.java\njava/org/apache/catalina/loader/WebappLoader.java\njava/org/apache/catalina/manager/JMXProxyServlet.java\njava/org/apache/catalina/mbeans/ServerLifecycleListener.java\njava/org/apache/catalina/realm/JAASRealm.java\njava/org/apache/catalina/realm/UserDatabaseRealm.java\njava/org/apache/catalina/session/StandardSession.java\njava/org/apache/catalina/startup/Bootstrap.java\njava/org/apache/catalina/startup/Catalina.java\njava/org/apache/catalina/startup/Tool.java\njava/org/apache/catalina/tribes/membership/McastServiceImpl.java\njava/org/apache/catalina/tribes/transport/nio/NioReceiver.java\njava/org/apache/catalina/util/CharsetMapper.java\njava/org/apache/catalina/util/ServerInfo.java\njava/org/apache/catalina/valves/AccessLogValve.java\njava/org/apache/catalina/valves/ExtendedAccessLogValve.java\njava/org/apache/coyote/ajp/AjpAprProcessor.java\njava/org/apache/coyote/ajp/AjpAprProtocol.java\njava/org/apache/coyote/ajp/AjpProcessor.java\njava/org/apache/coyote/ajp/AjpProtocol.java\njava/org/apache/coyote/http11/AbstractHttp11Processor.java\njava/org/apache/coyote/http11/Http11AprProcessor.java\njava/org/apache/coyote/http11/Http11AprProtocol.java\njava/org/apache/coyote/http11/Http11NioProcessor.java\njava/org/apache/coyote/http11/Http11NioProtocol.java\njava/org/apache/coyote/http11/Http11Processor.java\njava/org/apache/coyote/http11/Http11Protocol.java'),(1238,50018,'Bug 50018 – Javadoc corrections','','2010-09-27 20:47:45','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 minor','2f8a27c','Tim Whittington','2010-09-29 04:08:32','https://issues.apache.org/bugzilla/show_bug.cgi?id=50018 Minor javadoc corrections in Jasper.','java/org/apache/jasper/compiler/ParserController.java\njava/org/apache/jasper/compiler/TagFileProcessor.java\nwebapps/docs/changelog.xml'),(1239,49195,'Bug 49195 – Using -1 as shutdown port with Windows service works, but prints error message','1. Install Tomcat as a service on Windows\n2. Specify <Server port=\"-1\" in server.xml\n3. Start the service, and then stop the service.\n4. The following is printed in the catalina.2010-04-27.log:\n\n27.04.2010 17:49:13 org.apache.catalina.startup.Catalina stopServer\nSEVERE: No shutdown port configured. Shut down server through OS signal. Server not shut down.\n\nIt is just a message. Tomcat stops regardless of it:\nAfter printing the message Catalina#stopServer() performs System.exit(1) which results in Tomcat shutdown.\n\nI think that when service launcher stops Tomcat, Catalina#server is not null. That can be used to differentiate the two use cases.\n\nThere could be improvements on how to stop Tomcat. E.g., to call Catalina.stop(). If that is the case, it would be better to use wait(10000) instead of sleep(10000) in StandardServer.await(), so that it could be woken by a notifyAll() call, or use interrupt() call to wake it up (if we know the thread). System.exit(0) would work regardless of all that.\n\nI suppose that jsvc may show the same behaviour, but I have not tried.','2010-04-27 10:22:54','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 minor','7c6b1a5','Mark Emlyn David Thomas','2010-09-28 16:43:32','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49195 Avoid error message when shutting down Windows service when the shutdown port is disabled.','java/org/apache/catalina/startup/Catalina.java\nwebapps/docs/changelog.xml'),(1240,49665,'Bug 49665 – When file not found error occurs it does not tell you which file caused the error.','','2010-07-29 05:08:43','Ted Leung','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','7b24ed5','Mark Emlyn David Thomas','2010-09-28 13:23:05','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49665 Better handling for missing TLD files. Report JSP filename and location.','java/org/apache/jasper/compiler/Generator.java\njava/org/apache/jasper/compiler/JspDocumentParser.java\njava/org/apache/jasper/compiler/Parser.java\njava/org/apache/jasper/compiler/TagLibraryInfoImpl.java\nwebapps/docs/changelog.xml'),(1241,49728,'Bug 49728 – catalina.sh PID file handling not working if started by initscript','the PID file handling was changed in 6.0.24 in catalina.sh, which avoid the use of an initscript to start tomcat proper (e.g. on CentOS/RHEL5). catalina.sh is currently too strict regarding existing PID file and has imho a too lightweight check.\n\nBelow is a patch which improves the PID file handling.\n\nIt fixes 2 issues.\n\nIssue 1: tomcat won\'t start, if initscript has already created as root a PID file and changed permissions, that user tomcat would able to write it\'s PID into this file.\n\nFix: check existing PID file whether it\'s non-empty and if yes, check, whether PID is stale\n\nIssue 2: catalina.sh unconditionally tries to remove the given PID file, not testing the case that it has no write access to the directory (e.g. /var/run).\n\nFix: check before removing a PID file (because this needs write access to pid file directory, which is e.g. /var/run, were user tomcat has no write access)\n\nPls. include this fix into upstream, thank you.\n\n  Peter\n\n--- catalina.sh 2010-07-19 12:59:45.000000000 +0000\n+++ catalina.sh 2010-08-09 13:00:56.000000000 +0000\n@@ -311,9 +311,15 @@\nelif [ \"$1\" = \"start\" ] ; then\n\n  if [ ! -z \"$CATALINA_PID\" ]; then\n-    if [ -f \"$CATALINA_PID\" ]; then\n-      echo \"PID file ($CATALINA_PID) found. Is Tomcat still running? Start aborted.\"\n-      exit 1\n+    if [ -f \"$CATALINA_PID\" -a -s \"$CATALINA_PID\" ]; then\n+      echo \"Non-empty PID file ($CATALINA_PID) found. Is Tomcat still running?\"\n+      pid=\"`cat \"$CATALINA_PID\"`\"\n+      if ps -p $pid >/dev/null; then\n+        echo \"Tomcat is probably still running with PID $pid! Start aborted.\"\n+        exit 1\n+      else\n+        echo \"Tomcat is no longer running (stale PID file).\"\n+      fi\n    fi\n  fi\n\n@@ -393,7 +399,11 @@\n      while [ $SLEEP -ge 0 ]; do\n        kill -0 `cat $CATALINA_PID` >/dev/null 2>&1\n        if [ $? -gt 0 ]; then\n-          rm $CATALINA_PID\n+          if [ -w `dirname \"$CATALINA_PID\"` ]; then\n+            rm $CATALINA_PID\n+          else\n+            echo \"Non-removable PID file found ($CATALINA_PID).\"\n+          fi\n          break\n        fi\n        if [ $SLEEP -gt 0 ]; then\n@@ -416,7 +426,11 @@\n      if [ -f \"$CATALINA_PID\" ]; then\n        echo \"Killing: `cat $CATALINA_PID`\"\n        kill -9 `cat $CATALINA_PID`\n-        rm $CATALINA_PID\n+        if [ -w `dirname \"$CATALINA_PID\"` ]; then\n+          rm $CATALINA_PID\n+        else\n+          echo \"Non-removable PID file found ($CATALINA_PID).\"\n+        fi\n      fi\n    fi\n  fi','2010-08-09 10:05:07','Peter Bieringer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','a8296af','Mark Emlyn David Thomas','2010-09-28 12:59:54','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49728 Improve PID file handling, particularly when another process creates it and Tomcat is unable to write to the file.','bin/catalina.sh'),(1242,49657,'Bug 49657 – In CGI Mode, \"executable\" full path with spaces does not work','In CGI mode, if you specify a full path for a command, containing blank, \nit does not work\n\nexample :\n       <init-param>\n            <param-name>executable</param-name>\n            <param-value>c:\\Tools\\mycommand</param-value>\n        </init-param>\nis OK but\n\n       <init-param>\n            <param-name>executable</param-name>\n            <param-value>c:\\Program Files\\mycommand</param-value>\n          </init-param>\ndoes not work well with error like\n\n\n7 juil. 2010 15:51:52 org.apache.catalina.core.ApplicationContext log\nINFO: cgi: runCGI (stderr):\'C:\\Program\' is not recognized as an internal or external command,\n\nNeed probably to add \" in for cgiExcecutable in CGIServlet.java,  like it is done\nfor CmdAndArgs','2010-07-28 03:45:08','de Ratuld','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','54d4f69','Mark Emlyn David Thomas','2010-09-28 10:43:03','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49657 Correctly handle CGI executables with spaces in the name/path','java/org/apache/catalina/servlets/CGIServlet.java\nwebapps/docs/changelog.xml'),(1243,49625,'Bug 49625 – Tomcat doesn\'t send Vary consistently when gzip enabled','HTTP requires that the Vary response header be sent consistently for all responses if they change based upon different aspects of the request.\nMy pages has both compressed and uncompressed variants available, negotiated by the Accept-Encoding request header, but it sends different Vary headers for each;\n\n\"accept-encoding\" when the response is compressed, and\n\"\" when it is not.\nThis can cause problems for downstream caches, because they cannot consistently determine what the cache key for a given URI is.\n\nMy server.xml content:\n  <Service name=\"Catalina\">\n  \n    <Connector port=\"8080\" proxyPort=\"80\" maxHttpHeaderSize=\"8192\" protocol=\"org.apache.coyote.http11.Http11Protocol\" \n    maxThreads=\"200\" minSpareThreads=\"25\" maxPostSize=\"8\" \n    maxSpareThreads=\"75\" enableLookups=\"false\" keepAliveTimeout=\"3000\" maxKeepAliveRequests=\"100\"\n    redirectPort=\"8443\" acceptCount=\"100\"\n    connectionTimeout=\"8000\" disableUploadTimeout=\"true\"\n    compression=\"on\" compressionMinSize=\"2048\"\n    compressableMimeType=\"text/html,text/xml,text/javascript,text/css\" />\n    \n    <Engine name=\"Catalina\" defaultHost=\"localhost\">\n        <Host name=\"localhost\" appBase=\"webapps\" unpackWARs=\"false\" autoDeploy=\"false\"\ndebug=\"0\"\n            xmlValidation=\"false\" xmlNamespaceAware=\"false\">\n	</Host>\n    </Engine>\n  </Service>','2010-07-21 03:11:07','Ferenc Lutischan','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 normal','7435fa9','Mark Emlyn David Thomas','2010-09-28 08:08:53','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49625 Ensure Vary header is set if response may be compressed rather than only setting it if it is compressed.','java/org/apache/coyote/http11/AbstractHttp11Processor.java\nwebapps/docs/changelog.xml'),(1244,49209,'Bug 49209 – AccessControlException when undeploying application','When running Tomcat with a SecurityManager, an AccessControlException is thrown during undeployment.\n\nStack trace:\n\nCaused by: java.security.AccessControlException: access denied (java.lang.RuntimePermission getClassLoader)\n	at java.security.AccessControlContext.checkPermission(AccessControlContext.java:323)\n	at java.security.AccessController.checkPermission(AccessController.java:546)\n	at java.lang.SecurityManager.checkPermission(SecurityManager.java:532)\n	at java.lang.Class.getClassLoader(Class.java:594)\n	at org.apache.catalina.loader.JdbcLeakPrevention.clearJdbcDriverRegistrations(JdbcLeakPrevention.java:49)\n\nI assume the default catalina.policy should be updated, to take this case into account.','2010-04-28 07:30:12','Stephan Bublava','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','d0d4c75','Mark Emlyn David Thomas','2010-09-27 19:06:08','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49209 Prevent possible AccessControlException during undeployment when running with a security manager Patch provided by Sylvain Laurent','java/org/apache/catalina/loader/WebappClassLoader.java'),(1245,48644,'Bug 48644 – Code should never ignore throwable','There seem to be quite a few places where code catches Throwable and ignores it.\n\nFor example:\n\nant.jmx.JMXAccessorQueryTask.bindAttributes\nant.jmx.JMXAccessorTask.execute\ncore.StandardContext - lots of methods\n\nIn most cases, catching Exception would be enough.','2010-01-30 17:20:32','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','e67a33f','Mark Emlyn David Thomas','2010-09-27 18:29:30','Remaining fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=48644 Some Throwables must always be re-thrown','java/org/apache/tomcat/jni/Library.java\njava/org/apache/tomcat/util/digester/Digester.java\njava/org/apache/tomcat/util/http/fileupload/FileUploadBase.java\njava/org/apache/tomcat/util/http/fileupload/util/Streams.java\njava/org/apache/tomcat/util/net/AprEndpoint.java\njava/org/apache/tomcat/util/net/JIoEndpoint.java\njava/org/apache/tomcat/util/net/NioBlockingSelector.java\njava/org/apache/tomcat/util/net/NioEndpoint.java'),(1246,48644,'Bug 48644 – Code should never ignore throwable','There seem to be quite a few places where code catches Throwable and ignores it.\n\nFor example:\n\nant.jmx.JMXAccessorQueryTask.bindAttributes\nant.jmx.JMXAccessorTask.execute\ncore.StandardContext - lots of methods\n\nIn most cases, catching Exception would be enough.','2010-01-30 17:20:32','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','3a56f7d','Mark Emlyn David Thomas','2010-09-27 18:22:02','Partial fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=48644 Some Throwables must always be re-thrown','java/org/apache/naming/NamingService.java\njava/org/apache/naming/factory/ResourceFactory.java\njava/org/apache/naming/factory/webservices/ServiceRefFactory.java'),(1247,48644,'Bug 48644 – Code should never ignore throwable','There seem to be quite a few places where code catches Throwable and ignores it.\n\nFor example:\n\nant.jmx.JMXAccessorQueryTask.bindAttributes\nant.jmx.JMXAccessorTask.execute\ncore.StandardContext - lots of methods\n\nIn most cases, catching Exception would be enough.','2010-01-30 17:20:32','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','7b9aa5e','Mark Emlyn David Thomas','2010-09-27 18:17:30','Partial fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=48644 Some Throwables must always be re-thrown','java/org/apache/juli/ClassLoaderLogManager.java\njava/org/apache/juli/OneLineFormatter.java'),(1248,48644,'Bug 48644 – Code should never ignore throwable','There seem to be quite a few places where code catches Throwable and ignores it.\n\nFor example:\n\nant.jmx.JMXAccessorQueryTask.bindAttributes\nant.jmx.JMXAccessorTask.execute\ncore.StandardContext - lots of methods\n\nIn most cases, catching Exception would be enough.','2010-01-30 17:20:32','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','8ce6ee3','Mark Emlyn David Thomas','2010-09-27 18:16:26','Partial fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=48644 Some Throwables must always be re-thrown','java/org/apache/jasper/compiler/ImplicitTagLibraryInfo.java\njava/org/apache/jasper/compiler/JspReader.java\njava/org/apache/jasper/compiler/JspRuntimeContext.java\njava/org/apache/jasper/compiler/Localizer.java\njava/org/apache/jasper/compiler/ParserController.java\njava/org/apache/jasper/compiler/TagLibraryInfoImpl.java\njava/org/apache/jasper/compiler/TldLocationsCache.java\njava/org/apache/jasper/runtime/JspFactoryImpl.java\njava/org/apache/jasper/servlet/JspCServletContext.java\njava/org/apache/jasper/servlet/JspServlet.java\njava/org/apache/jasper/servlet/JspServletWrapper.java'),(1249,48644,'Bug 48644 – Code should never ignore throwable','There seem to be quite a few places where code catches Throwable and ignores it.\n\nFor example:\n\nant.jmx.JMXAccessorQueryTask.bindAttributes\nant.jmx.JMXAccessorTask.execute\ncore.StandardContext - lots of methods\n\nIn most cases, catching Exception would be enough.','2010-01-30 17:20:32','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','4b60a6c','Mark Emlyn David Thomas','2010-09-27 18:12:05','Partial fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=48644 Some Throwables must always be re-thrown','java/org/apache/coyote/ajp/AjpAprProcessor.java\njava/org/apache/coyote/ajp/AjpAprProtocol.java\njava/org/apache/coyote/ajp/AjpProcessor.java\njava/org/apache/coyote/ajp/AjpProtocol.java\njava/org/apache/coyote/http11/AbstractHttp11Processor.java\njava/org/apache/coyote/http11/Http11AprProcessor.java\njava/org/apache/coyote/http11/Http11AprProtocol.java\njava/org/apache/coyote/http11/Http11NioProcessor.java\njava/org/apache/coyote/http11/Http11NioProtocol.java\njava/org/apache/coyote/http11/Http11Processor.java\njava/org/apache/coyote/http11/Http11Protocol.java'),(1250,48644,'Bug 48644 – Code should never ignore throwable','There seem to be quite a few places where code catches Throwable and ignores it.\n\nFor example:\n\nant.jmx.JMXAccessorQueryTask.bindAttributes\nant.jmx.JMXAccessorTask.execute\ncore.StandardContext - lots of methods\n\nIn most cases, catching Exception would be enough.','2010-01-30 17:20:32','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','92f81b1','Mark Emlyn David Thomas','2010-09-27 18:01:45','Partial fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=48644 Some Throwables must always be re-thrown','java/org/apache/catalina/mbeans/MBeanUtils.java\njava/org/apache/catalina/mbeans/ServerLifecycleListener.java\njava/org/apache/catalina/realm/JAASRealm.java\njava/org/apache/catalina/realm/JDBCRealm.java\njava/org/apache/catalina/realm/UserDatabaseRealm.java\njava/org/apache/catalina/session/StandardManager.java\njava/org/apache/catalina/session/StandardSession.java\njava/org/apache/catalina/startup/Bootstrap.java\njava/org/apache/catalina/startup/Catalina.java\njava/org/apache/catalina/startup/CatalinaProperties.java\njava/org/apache/catalina/startup/ContextConfig.java\njava/org/apache/catalina/startup/HostConfig.java\njava/org/apache/catalina/startup/TldConfig.java\njava/org/apache/catalina/startup/Tool.java\njava/org/apache/catalina/tribes/membership/McastServiceImpl.java\njava/org/apache/catalina/tribes/transport/nio/NioReceiver.java\njava/org/apache/catalina/util/CharsetMapper.java\njava/org/apache/catalina/util/ServerInfo.java\njava/org/apache/catalina/valves/AccessLogValve.java\njava/org/apache/catalina/valves/ErrorReportValve.java\njava/org/apache/catalina/valves/ExtendedAccessLogValve.java\njava/org/apache/catalina/valves/JDBCAccessLogValve.java'),(1251,48644,'Bug 48644 – Code should never ignore throwable','There seem to be quite a few places where code catches Throwable and ignores it.\n\nFor example:\n\nant.jmx.JMXAccessorQueryTask.bindAttributes\nant.jmx.JMXAccessorTask.execute\ncore.StandardContext - lots of methods\n\nIn most cases, catching Exception would be enough.','2010-01-30 17:20:32','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','27a4f9f','Mark Emlyn David Thomas','2010-09-27 17:32:25','Partial fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=48644 Some Throwables must always be re-thrown','java/org/apache/catalina/deploy/ErrorPage.java\njava/org/apache/catalina/ha/authenticator/ClusterSingleSignOn.java\njava/org/apache/catalina/ha/session/DeltaManager.java\njava/org/apache/catalina/loader/WebappClassLoader.java\njava/org/apache/catalina/loader/WebappLoader.java\njava/org/apache/catalina/manager/HTMLManagerServlet.java\njava/org/apache/catalina/manager/JMXProxyServlet.java\njava/org/apache/catalina/manager/ManagerServlet.java\njava/org/apache/catalina/manager/host/HostManagerServlet.java'),(1252,48644,'Bug 48644 – Code should never ignore throwable','There seem to be quite a few places where code catches Throwable and ignores it.\n\nFor example:\n\nant.jmx.JMXAccessorQueryTask.bindAttributes\nant.jmx.JMXAccessorTask.execute\ncore.StandardContext - lots of methods\n\nIn most cases, catching Exception would be enough.','2010-01-30 17:20:32','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','857482b','Mark Emlyn David Thomas','2010-09-27 16:52:49','Partial fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=48644 Some Throwables must always be re-thrown','java/org/apache/catalina/authenticator/FormAuthenticator.java\njava/org/apache/catalina/connector/CoyoteAdapter.java\njava/org/apache/catalina/connector/Request.java\njava/org/apache/catalina/core/ApplicationContext.java\njava/org/apache/catalina/core/ApplicationContextFacade.java\njava/org/apache/catalina/core/ApplicationDispatcher.java\njava/org/apache/catalina/core/ApplicationFilterChain.java\njava/org/apache/catalina/core/AprLifecycleListener.java\njava/org/apache/catalina/core/ContainerBase.java\njava/org/apache/catalina/core/DefaultInstanceManager.java\njava/org/apache/catalina/core/JasperListener.java\njava/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/core/StandardContextValve.java\njava/org/apache/catalina/core/StandardHost.java\njava/org/apache/catalina/core/StandardHostValve.java\njava/org/apache/catalina/core/StandardServer.java\njava/org/apache/catalina/core/StandardWrapper.java\njava/org/apache/catalina/core/StandardWrapperValve.java'),(1253,48644,'Bug 48644 – Code should never ignore throwable','There seem to be quite a few places where code catches Throwable and ignores it.\n\nFor example:\n\nant.jmx.JMXAccessorQueryTask.bindAttributes\nant.jmx.JMXAccessorTask.execute\ncore.StandardContext - lots of methods\n\nIn most cases, catching Exception would be enough.','2010-01-30 17:20:32','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','2e6cc46','Mark Emlyn David Thomas','2010-09-27 16:24:18','Partial fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=48644 Don\'t catch Throwable','java/org/apache/catalina/ant/AbstractCatalinaTask.java\njava/org/apache/catalina/ant/ValidatorTask.java\njava/org/apache/catalina/ant/jmx/JMXAccessorQueryTask.java\njava/org/apache/catalina/ant/jmx/JMXAccessorTask.java'),(1254,49884,'Bug 49884 – NullPointerException in org.apache.catalina.core.AsyncContextImpl.doInternalComplete','','2010-09-04 23:16:09','Kevin','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','587b1a8','Mark Emlyn David Thomas','2010-09-27 08:13:32','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49884','java/org/apache/catalina/connector/CoyoteAdapter.java\njava/org/apache/catalina/connector/Request.java\njava/org/apache/catalina/core/AsyncContextImpl.java\njava/org/apache/catalina/security/SecurityClassLoad.java\njava/org/apache/coyote/ActionCode.java\njava/org/apache/coyote/ajp/AjpAprProcessor.java\njava/org/apache/coyote/ajp/AjpAprProtocol.java\njava/org/apache/coyote/http11/AbstractHttp11Processor.java\njava/org/apache/coyote/http11/Constants.java\njava/org/apache/coyote/http11/Http11AprProcessor.java\njava/org/apache/coyote/http11/Http11AprProtocol.java\njava/org/apache/coyote/http11/Http11NioProcessor.java\njava/org/apache/coyote/http11/Http11NioProtocol.java\njava/org/apache/coyote/http11/Http11Processor.java\njava/org/apache/coyote/http11/Http11Protocol.java\njava/org/apache/coyote/http11/LocalStrings.properties\njava/org/apache/tomcat/util/net/AbstractEndpoint.java\njava/org/apache/tomcat/util/net/AprEndpoint.java\njava/org/apache/tomcat/util/net/JIoEndpoint.java\njava/org/apache/tomcat/util/net/NioEndpoint.java\njava/org/apache/tomcat/util/net/SocketWrapper.java\njava/org/apache/tomcat/util/net/res/LocalStrings.properties\ntest/org/apache/catalina/core/TestAsyncContextImpl.java\nwebapps/docs/changelog.xml'),(1255,49993,'Bug 49993 – service.bat does not check for JAVA_HOME validity','service.bat does not check for JAVA_HOME validity.\nIt also does not check for JRE_HOME like catalina.bat does trough\nsetclasspath.bat script.\n\nIf neither the JAVA_HOME nor JRE_HOME are set we should inform the\nuser and then switch to auto detection mode from the registry','2010-09-24 01:58:56','Mladen Turk','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','7cf1de5','Mladen Turk','2010-09-24 02:00:00','Fix Bz #49993 by checking the JAVA_HOME/JRE_HOME environment variables','bin/service.bat'),(1256,49102,'Bug 49102 – coyote.ajp.Constants - 3 \"constant\" arrays are mutable','The class coyote.ajp.Constants contains 3 public static non-empty String[] arrays:\n\nmethodTransArray\nresponseTransArray\nheaderTransArray\n\nresponseTransArray only appears to be locally, so could be made private.\n\nThe others are used in index lookups, so get(index) methods could be used to protect them.','2010-04-12 16:11:37','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P5 enhancement','fb5a3e7','Tim Whittington','2010-09-23 06:38:56','https://issues.apache.org/bugzilla/show_bug.cgi?id=49102','java/org/apache/coyote/ajp/AjpAprProcessor.java\njava/org/apache/coyote/ajp/AjpProcessor.java\njava/org/apache/coyote/ajp/Constants.java'),(1257,49955,'Bug 49955 – Building instructions incorrect.','','2010-09-17 18:28:13','Wesley','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 normal','c4ffe0c','Tim Whittington','2010-09-23 06:15:16','https://issues.apache.org/bugzilla/show_bug.cgi?id=49955','Start Tomcat.launch\nStop Tomcat.launch\nwebapps/docs/building.xml\nwebapps/docs/changelog.xml'),(1258,49909,'Bug 49909 – jstl 1.2 not support','','2010-09-10 06:20:26','dl','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','8dc0306','Mark Emlyn David Thomas','2010-09-17 07:05:39','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49909 Re-enable JSTL. This was a regression in the fix for bz 47950','java/org/apache/catalina/loader/WebappClassLoader.java\nwebapps/docs/changelog.xml'),(1259,47950,'Bug 47950 – No case insensitivity handling for OLE2 entry names','','2009-10-06 15:48:49','Trejkaz (pen name)','POI Developers List','NEW','POI','POIFS','P2 normal','8dc0306','Mark Emlyn David Thomas','2010-09-17 07:05:39','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49909 Re-enable JSTL. This was a regression in the fix for bz 47950','java/org/apache/catalina/loader/WebappClassLoader.java\nwebapps/docs/changelog.xml'),(1260,49584,'Bug 49584 – Borrowers Getting Stuck','The borrow connection logic seems to assume that connections will always transition between active to idle. However, if connections move from active to released then a borrower can get stuck in idle.poll even though there is room in the pool for another connection to be created.\n\nThere is also an issue with connection create failing causing the pool size to be incremented but not decremented. In the borrowConnection method the pool size is incremented. However, if an exception occurs in the createConnection method releaseConnection can be called with a null argument and the pool size is not decremented.','2010-07-12 05:15:17','Ben Murphy','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','ddf304d','Mark Emlyn David Thomas','2010-09-15 09:24:14','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49584 Move the offering of a new thread on release from the abandoned connection code to the release code to eliminate the possibility of a blocked thread on release.','modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java'),(1261,49584,'Bug 49584 – Borrowers Getting Stuck','The borrow connection logic seems to assume that connections will always transition between active to idle. However, if connections move from active to released then a borrower can get stuck in idle.poll even though there is room in the pool for another connection to be created.\n\nThere is also an issue with connection create failing causing the pool size to be incremented but not decremented. In the borrowConnection method the pool size is incremented. However, if an exception occurs in the createConnection method releaseConnection can be called with a null argument and the pool size is not decremented.','2010-07-12 05:15:17','Ben Murphy','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','a0ffe49','Mark Emlyn David Thomas','2010-09-15 07:42:55','Address a concern raised in https://issues.apache.org/bugzilla/show_bug.cgi?id=49584 Re-factor code to clarify con is never null when release is called.','modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java'),(1262,49924,'Bug 49924 – When non-primary node changes into a primary node, isPrimarySession is not changed to true.','If BackupManager is used,\nwhen a primary node is switched, \nDeltaSession#isPrimarySession is not changed to true. \n\nNon-primary node changes into a primary node \nwhen a primary node is stopped or we get a non-primary session. \n\nIf a primary node is stopped, a primary node is switched. \nIn AbstractReplicatedMap, when a primary node is switched, \nMapOwner(BackupManager)#objectMadePrimay is called. \nHowever, isPrimarySession does not change to true in this method. \n=====BackupManager#objectMadePrimay=====\npublic void objectMadePrimay(Object key, Object value) {\n    if (value!=null && value instanceof DeltaSession) {\n        DeltaSession session = (DeltaSession)value;\n        synchronized (session) {\n            session.access();\n            session.endAccess();\n        }\n    }\n}\n=====\n\nIf we get a non-primary session,  a primary node is switched. \nHowever, isPrimarySession does not change to true. \nIt is only a change of primary node.\n\nI made a patch.\nIt contains the following. \nisPrimarySession is set to true in BackupManager#objectMadePrimay.\nWhen get() is called in non-primary node, MapOwner#objectMadePrimay is called.\n\n\nBest regards.','2010-09-14 03:23:07','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Cluster','P2 normal','b255697','Keiichi Fujino','2010-09-14 03:49:33','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49924 When non-primary node changes into a primary node, make sure isPrimarySession is changed to true.','java/org/apache/catalina/ha/session/BackupManager.java\njava/org/apache/catalina/tribes/tipis/AbstractReplicatedMap.java\nwebapps/docs/changelog.xml'),(1263,49234,'Bug 49234 – JMX Descriptor Modifications','','2010-04-30 00:17:34','chamith buddhika','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','e0182ef','Mark Emlyn David Thomas','2010-09-11 21:25:03','Further work for https://issues.apache.org/bugzilla/show_bug.cgi?id=49234 GSOC 2010. Enable the creation of Services, Engines, Connectors, Hosts and Contexts via JMX from a minimal server.xml that contains only a Server element. Based on a patch by Chamith Buddhika. I added the additional changes to pass the parent class loader down the hierarchy.','java/org/apache/catalina/Server.java\njava/org/apache/catalina/Service.java\njava/org/apache/catalina/core/StandardEngine.java\njava/org/apache/catalina/core/StandardServer.java\njava/org/apache/catalina/core/StandardService.java\njava/org/apache/catalina/core/mbeans-descriptors.xml\njava/org/apache/catalina/mbeans/ContainerMBean.java\njava/org/apache/catalina/mbeans/ContextMBean.java\njava/org/apache/catalina/mbeans/ServiceMBean.java\njava/org/apache/catalina/startup/Catalina.java\nwebapps/docs/changelog.xml'),(1264,49892,'Bug 49892 – Wrong JNDI Name for Method Resource Injections','Method based JNDI env. injections not worked correctly. Patch is attached. See Java EE 6 specification section, EE. 5.2.5 Annotations and Injections. Patch is provided that solves problem.','2010-09-07 10:44:49','Gurkan Erdogdu','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','94147b2','Mark Emlyn David Thomas','2010-09-08 15:45:16','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49892 Correct JNDI name for method resource injections Based on a patch by Gurkan Erdogdu','java/org/apache/catalina/core/DefaultInstanceManager.java'),(1265,48817,'Bug 48817 – Skip validation query and use JDBC API for validation','The jdbc-pool should allow, if Java 6 is present, to not have to configure the validationQuery, but instead use the \njava.sql.Connection.isValid(int timeout)\nmethod call','2010-02-25 18:21:40','Filip Hanik','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','b0d34ed','Mark Emlyn David Thomas','2010-09-08 11:31:27','Document new validation class (https://issues.apache.org/bugzilla/show_bug.cgi?id=48817) Patch provided by Matt Passell.','modules/jdbc-pool/doc/jdbc-pool.xml'),(1266,49831,'Bug 49831 – Issue with closing XAConnections on MSSQL','When using XAConnections with MSSQL it has been noticed that the physical connections are not being closed when DataSourceProxy.close(boolean all) is called. This method invokes org.apache.tomcat.jdbc.pool.PooledConnection.disconnent() which calls connection.close(). However, when used with SQLServer, the connection attribute is a proxy object (type com.microsoft.sqlserver.jdbc.SQLServerConnectionPoolProxy) which wraps the physical connection (of type com.microsoft.sqlserver.jdbc.SQLServerConnection). Calling close() on the proxy object only notifies the pool manager that the Connection is released back to the pool; it does not close the underlying physical connection.\n\nThis is what the PooledConnection.disconnent() implementation currently reads:\n\nprivate void disconnect(boolean finalize) {\n    if (isDiscarded()) {\n        return;\n    }\n    setDiscarded(true);\n    if (connection != null) {\n        try {\n            connection.close();\n        }catch (Exception ignore) {\n            if (log.isDebugEnabled()) {\n                log.debug(\"Unable to close underlying SQL connection\",ignore);\n            }\n        }\n    }\n    connection = null;\n    xaConnection = null;\n    lastConnected = -1;\n    if (finalize) parent.finalize(this);\n}\n\nIf the logic was changed to the following, it would properly closed the XAConnection with the MSSQL.\n\nprivate void disconnect(boolean finalize) {\n    if (isDiscarded()) {\n        return;\n    }\n    setDiscarded(true);\n    if (connection != null) {\n        try {\n            if (xaConnection != null) {\n                xaConnection.close(); \n            } else {\n                connection.close();\n            }\n        }catch (Exception ignore) {\n            if (log.isDebugEnabled()) {\n                log.debug(\"Unable to close underlying SQL connection\",ignore);\n            }\n        }\n    }\n    connection = null;\n    xaConnection = null;\n    lastConnected = -1;\n    if (finalize) parent.finalize(this);\n}','2010-08-26 11:08:08','Daniel Mikusa','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','64a8346','Mark Emlyn David Thomas','2010-09-08 11:27:00','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49831 Make sure pooled XA connections are properly closed when the pool shuts down. Based on a patch by Daniel Mikusa.','modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/PooledConnection.java'),(1267,49884,'Bug 49884 – NullPointerException in org.apache.catalina.core.AsyncContextImpl.doInternalComplete','','2010-09-04 23:16:09','Kevin','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','7b942ce','Mark Emlyn David Thomas','2010-09-07 08:56:29','Additional debug logging to investigate https://issues.apache.org/bugzilla/show_bug.cgi?id=49884 - logs hashcodes for current request, coyote request and request processor - logs thread name - makes debug stack trace optional (enabled with trace level logging) - adds debug statements to additional methods','java/org/apache/catalina/core/AsyncContextImpl.java'),(1268,49883,'Bug 49883 – java.lang.UnsupportedOperationException: The getName() method should never be called','','2010-09-04 22:58:52','Kevin','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','a9f0fd5','Mark Emlyn David Thomas','2010-09-05 16:43:38','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49883 Return a name for use in log messages rather than throwing an UnsupportedOperationException','java/org/apache/catalina/realm/CombinedRealm.java\nwebapps/docs/changelog.xml'),(1269,49802,'Bug 49802 – Shutdown of AJP Connector do not work','','2010-08-23 05:59:48','Domenico Briganti','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 regression','cd7263e','Mark Emlyn David Thomas','2010-09-05 16:36:16','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49802 Allow the connectors to be stopped via JMX.','java/org/apache/catalina/connector/Connector.java\njava/org/apache/catalina/core/StandardService.java\njava/org/apache/coyote/ProtocolHandler.java\njava/org/apache/coyote/ajp/AjpAprProcessor.java\njava/org/apache/coyote/ajp/AjpAprProtocol.java\njava/org/apache/coyote/ajp/AjpProcessor.java\njava/org/apache/coyote/ajp/AjpProtocol.java\njava/org/apache/coyote/ajp/LocalStrings.properties\njava/org/apache/coyote/http11/AbstractHttp11Protocol.java\njava/org/apache/coyote/http11/Http11AprProcessor.java\njava/org/apache/coyote/http11/Http11NioProcessor.java\njava/org/apache/coyote/http11/Http11Processor.java\njava/org/apache/coyote/http11/LocalStrings.properties\njava/org/apache/tomcat/util/net/AbstractEndpoint.java\njava/org/apache/tomcat/util/net/AprEndpoint.java\njava/org/apache/tomcat/util/net/JIoEndpoint.java\njava/org/apache/tomcat/util/net/NioEndpoint.java\nwebapps/docs/changelog.xml'),(1270,49865,'Bug 49865 – ExceptionUtils throw NoClassDefFoundError during startup','Remove conf/catalina.properties and get:\n\nSEVERE: Class loader creation threw exception\njava.lang.NoClassDefFoundError: org/apache/tomcat/util/ExceptionUtils\n        at org.apache.catalina.startup.CatalinaProperties.loadProperties(CatalinaProperties.java:112)\n        at org.apache.catalina.startup.CatalinaProperties.<clinit>(CatalinaProperties.java:52)\n        at org.apache.catalina.startup.Bootstrap.createClassLoader(Bootstrap.java:110)\n        at org.apache.catalina.startup.Bootstrap.initClassLoaders(Bootstrap.java:93)\n        at org.apache.catalina.startup.Bootstrap.init(Bootstrap.java:207)\n        at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:392)\nCaused by: java.lang.ClassNotFoundException: org.apache.tomcat.util.ExceptionUtils\n        at java.net.URLClassLoader$1.run(URLClassLoader.java:200)\n        at java.security.AccessController.doPrivileged(Native Method)\n        at java.net.URLClassLoader.findClass(URLClassLoader.java:188)\n        at java.lang.ClassLoader.loadClass(ClassLoader.java:303)\n        at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)\n        at java.lang.ClassLoader.loadClass(ClassLoader.java:248)\n        at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:316)\n\norg.apache.tomcat.util.ExceptionUtils is not available for the class loader during this early stage.\n\nObserved in r991965, added TODO marks in CatalinaProperties.java.','2010-09-02 12:52:49','Rainer Jung','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','12db09b','Mark Emlyn David Thomas','2010-09-03 16:37:46','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49865 Allow Tomcat to start if catalina.properties is not present','java/org/apache/catalina/startup/CatalinaProperties.java\nwebapps/docs/changelog.xml'),(1271,49876,'Bug 49876 – correcting generics related compile warning in org/apache/tomcat/util/bcel/classfile files','Explanation:\n\nSeveral files have compile time generics related warnings displayed for org/apache/tomcat/util/bcel/classfile. This patch cleans up several of those warnings.','2010-09-03 08:17:45','Gábor','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 trivial','6155a8b','Mark Emlyn David Thomas','2010-09-03 14:50:57','https://issues.apache.org/bugzilla/show_bug.cgi?id=49876 Generics warnings in the copied Apache Jakarta BCEL code. Based on a patch by Gábor. (markt)','java/org/apache/tomcat/util/bcel/classfile/AnnotationEntry.java\njava/org/apache/tomcat/util/bcel/classfile/Attribute.java\njava/org/apache/tomcat/util/bcel/classfile/JavaClass.java\njava/org/apache/tomcat/util/bcel/classfile/Unknown.java\njava/org/apache/tomcat/util/bcel/classfile/Utility.java\nwebapps/docs/changelog.xml'),(1272,49869,'Bug 49869 – Javadoc for WebAppClassLoader constructor has copy/paste error','The constructor that takes a parent class loader has a copy of the doc string from the constructor that does not take a parent class loader.','2010-09-02 18:26:13','bmargulies','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','a6620cb','Rainer Jung','2010-09-03 04:54:20','BZ 49869: Javadoc Fix.','java/org/apache/catalina/loader/WebappClassLoader.java'),(1273,49865,'Bug 49865 – ExceptionUtils throw NoClassDefFoundError during startup','Remove conf/catalina.properties and get:\n\nSEVERE: Class loader creation threw exception\njava.lang.NoClassDefFoundError: org/apache/tomcat/util/ExceptionUtils\n        at org.apache.catalina.startup.CatalinaProperties.loadProperties(CatalinaProperties.java:112)\n        at org.apache.catalina.startup.CatalinaProperties.<clinit>(CatalinaProperties.java:52)\n        at org.apache.catalina.startup.Bootstrap.createClassLoader(Bootstrap.java:110)\n        at org.apache.catalina.startup.Bootstrap.initClassLoaders(Bootstrap.java:93)\n        at org.apache.catalina.startup.Bootstrap.init(Bootstrap.java:207)\n        at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:392)\nCaused by: java.lang.ClassNotFoundException: org.apache.tomcat.util.ExceptionUtils\n        at java.net.URLClassLoader$1.run(URLClassLoader.java:200)\n        at java.security.AccessController.doPrivileged(Native Method)\n        at java.net.URLClassLoader.findClass(URLClassLoader.java:188)\n        at java.lang.ClassLoader.loadClass(ClassLoader.java:303)\n        at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)\n        at java.lang.ClassLoader.loadClass(ClassLoader.java:248)\n        at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:316)\n\norg.apache.tomcat.util.ExceptionUtils is not available for the class loader during this early stage.\n\nObserved in r991965, added TODO marks in CatalinaProperties.java.','2010-09-02 12:52:49','Rainer Jung','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','8399989','Rainer Jung','2010-09-02 12:52:48','BZ 49865: ExceptionUtils throw NoClassDefFoundError during startup. Add TODO markers.','java/org/apache/catalina/startup/CatalinaProperties.java'),(1274,48967,'Bug 48967 – Externalize Strings \"catalina.base\" and \"catalina.home\"','','2010-03-23 14:19:02','Marc Guillemot','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 enhancement','bcb994c','Rainer Jung','2010-09-02 10:52:11','BZ 48967: Replace strings \"catalina.base\" and \"catalina.home\" by globally defined constants.','java/org/apache/catalina/Globals.java\njava/org/apache/catalina/connector/Connector.java\njava/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/ha/deploy/FarmWarDeployer.java\njava/org/apache/catalina/manager/ManagerServlet.java\njava/org/apache/catalina/manager/host/HostManagerServlet.java\njava/org/apache/catalina/realm/JAASMemoryLoginModule.java\njava/org/apache/catalina/realm/MemoryRealm.java\njava/org/apache/catalina/startup/Bootstrap.java\njava/org/apache/catalina/startup/Catalina.java\njava/org/apache/catalina/startup/CatalinaProperties.java\njava/org/apache/catalina/startup/Embedded.java\njava/org/apache/catalina/startup/ExpandWar.java\njava/org/apache/catalina/startup/HostConfig.java\njava/org/apache/catalina/startup/Tomcat.java\njava/org/apache/catalina/startup/Tool.java\njava/org/apache/catalina/users/MemoryUserDatabase.java\njava/org/apache/catalina/valves/AccessLogValve.java\njava/org/apache/jasper/compiler/AntCompiler.java\njava/org/apache/tomcat/util/net/AbstractEndpoint.java\njava/org/apache/tomcat/util/net/jsse/JSSESocketFactory.java\nwebapps/docs/changelog.xml'),(1275,49799,'Bug 49799 – The new JSP 2.2 omit-attribute in jsp:attribute does not work with EL or expressions','','2010-08-22 16:44:10','PhilippJ','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','851ccfc','Mark Emlyn David Thomas','2010-08-30 18:32:08','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49799 The new omit< attribute for <jsp:attribute .../> elements now supports the use of expressions and expression language.','java/org/apache/jasper/compiler/Generator.java\njava/org/apache/jasper/compiler/Node.java\njava/org/apache/jasper/compiler/Validator.java\ntest/org/apache/jasper/compiler/TestGenerator.java\ntest/webapp-3.0/bug49799.jsp\nwebapps/docs/changelog.xml'),(1276,49698,'Bug 49698 – AsyncContext timeout always return http 500','Whatever asynclistener timeout call complete response always return http 500.','2010-08-03 22:42:38','heyoulin','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 major','a761cdc','Mark Emlyn David Thomas','2010-08-29 10:50:11','Fix likely cause of Gump failure. Fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=49698 in r990342 was incomplete','java/org/apache/catalina/core/AsyncContextImpl.java'),(1277,49698,'Bug 49698 – AsyncContext timeout always return http 500','Whatever asynclistener timeout call complete response always return http 500.','2010-08-03 22:42:38','heyoulin','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 major','24facac','Mark Emlyn David Thomas','2010-08-28 07:07:39','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49698 Allow listeners to call complete when a async request times out Add a test case based on pero\'s previous timeout test case','java/org/apache/catalina/core/AsyncContextImpl.java\ntest/org/apache/catalina/core/TestAsyncContextImpl.java\nwebapps/docs/changelog.xml'),(1278,38113,'Bug 38113 – getQueryString returns null instead of empty-string','','2006-01-03 23:06:03','Dan Jacobs','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','3d9e7c0','Mark Emlyn David Thomas','2010-08-25 12:44:08','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=38113','java/org/apache/catalina/connector/Request.java\ntest/org/apache/catalina/connector/TestRequest.java'),(1279,49749,'Bug 49749 – SSO cookie should be added as HttpOnly','SSO cookies should be made HttpOnly by default.\n\nIn org.apache.catalina.authenticator.AuthenticatorBase#register(), \n\n798- response.addCookie(cookie);\n798+ response.addCookieInternal(cookie, true);','2010-08-13 19:18:22','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','e641f20','Mark Emlyn David Thomas','2010-08-25 07:36:38','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49749','java/org/apache/catalina/authenticator/AuthenticatorBase.java\nwebapps/docs/changelog.xml'),(1280,48738,'Bug 48738 – [PATCH]Allow GzipOutputFilter to send partial result when flushBuffer() is called','','2010-02-13 23:28:26','Jiong Wang','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 enhancement','526f4ac','Mark Emlyn David Thomas','2010-08-24 06:02:14','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48738 Workaround a couple of long standing JDK bugs to enable GZIP compressed output streams to be flushed. Based on a patch provided by Jiong Wang.','java/org/apache/coyote/http11/AbstractOutputBuffer.java\njava/org/apache/coyote/http11/filters/FlushableGZIPOutputStream.java\njava/org/apache/coyote/http11/filters/GzipOutputFilter.java\ntest/org/apache/coyote/http11/TestGzipOutputFilter.java\nwebapps/docs/changelog.xml'),(1281,49669,'Bug 49669 – Static reference from  javax.security.auth.Policy.contextClassLoader prevents an undeployed Web application from being garbage collected','','2010-07-29 10:19:23','Arjen Knibbe','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','707f778','Mark Emlyn David Thomas','2010-08-23 16:35:03','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49669 Another Java class triggering a memory leak. This time javax.security.auth.Policy','java/org/apache/catalina/core/JreMemoryLeakPreventionListener.java\nwebapps/docs/config/listeners.xml'),(1282,49670,'Bug 49670 – org.apache.catalina.authenticator.SingleSignOn valve does not function','I have two web applications; neither declare a realm in the context.xml and both are configured for authentication in the web.xml using standard tomcat authentication methods.  I have enabled the tomcat valve in the host and have added a realm to the host as well.\n\n      <Host name=\"localhost\"  appBase=\"webapps\" unpackWARs=\"true\" autoDeploy=\"true\">\n      	<Realm className=\"org.apache.catalina.realm.JAASRealm\" appName=\"SSO\" userClassNames=\"a.b.c\" roleClassNames=\"a.b.c\" useContextClassLoader=\"false\"/>\n        <!-- SingleSignOn valve, share authentication between web applications\n             Documentation at: /docs/config/valve.html -->\n        <Valve className=\"org.apache.catalina.authenticator.SingleSignOn\"/>\n        <!-- Access log processes all example.\n             Documentation at: /docs/config/valve.html -->\n        <!--\n        <Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"  \n               prefix=\"localhost_access_log.\" suffix=\".txt\" pattern=\"common\" resolveHosts=\"false\"/>\n        -->\n\nI have added a jaas configuration for the SSO app in the jaas.conf file for the server.  I am certain that the realm, jaas.conf are all configured properly as the web applications do require a user to authenticate before accessing the application, but if I have authenticated to one application I still am required to authenticate before accessing the other application.\n\nI have this exact same configuration working on a tomcat 6 environment, but an identical configuration will not operate on a tomcat 7 server.','2010-07-29 10:43:35','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 regression','e2f0b9b','Mark Emlyn David Thomas','2010-08-23 16:15:13','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49670 Fix SSO - broken by Lifecycle refactoring','java/org/apache/catalina/authenticator/AuthenticatorBase.java\nwebapps/docs/changelog.xml'),(1283,49721,'Bug 49721 – Fail to access the resources such as jsp files from a jar file which is supported by servlet 3.0','I put a jsp file in a jar file and test whether tomcat 7 supports it by viewing it from the browser and failed.','2010-08-06 21:52:37','Wang Guangzhe','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 normal','187eed8','Mark Emlyn David Thomas','2010-08-23 15:37:25','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49721 All JARs can be resource JARs. Although the spec defines no order, use ordered JARs in order then the remaining JARs in any order.','java/org/apache/catalina/startup/ContextConfig.java'),(1284,49726,'Bug 49726 – JSP 2.2 new configuration element <default-content-type> under <jsp-property-group> works incorrectly on tomcat trunk','','2010-08-09 02:07:45','Wang Guangzhe','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 major','42c226f','Mark Emlyn David Thomas','2010-08-23 15:23:28','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49726 Specifying a default content type via a JSP property group should not prevent a page from setting some other content type Includes test cases','java/org/apache/jasper/compiler/Compiler.java\ntest/org/apache/jasper/compiler/TestCompiler.java\ntest/webapp-3.0/WEB-INF/web.xml\ntest/webapp-3.0/bug49726a.jsp\ntest/webapp-3.0/bug49726b.jsp\nwebapps/docs/changelog.xml'),(1285,49750,'Bug 49750 – WebappClassLoader.validate(name) does not validate javax.servlet.','The method does not validate the class name as described in the method documentation.\n\n\"Validate a classname. As per SRV.9.7.2, we must restrict loading of classes from J2SE (java.*) and classes of the servlet API (javax.servlet.*) \"','2010-08-15 11:06:54','Pid','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 trivial','6fce7d7','Mark Emlyn David Thomas','2010-08-23 13:32:03','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49750 Align WebappClassLoader.validate() implementation with Javadoc and ensure that javax.servlet.* classes can not be loaded by a WebappClassLoader instance. Patch provided by pid.','java/org/apache/catalina/loader/WebappClassLoader.java\nwebapps/docs/changelog.xml'),(1286,49758,'Bug 49758 – [Patch] Generics warnings - rawtypes','','2010-08-16 13:20:09','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','c05cb94','Mark Emlyn David Thomas','2010-08-22 19:11:18','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49758 Fix generics warnings exposed by a fix in Eclipse 3.6. Patch provided by sebb.','java/javax/annotation/Resource.java\njava/javax/ejb/EJB.java\njava/javax/el/BeanELResolver.java\njava/javax/el/ELContext.java\njava/javax/el/ResourceBundleELResolver.java\njava/javax/servlet/ServletRequestWrapper.java\njava/javax/servlet/ServletResponseWrapper.java\njava/javax/servlet/annotation/HandlesTypes.java\njava/javax/servlet/jsp/el/ExpressionEvaluator.java\njava/javax/servlet/jsp/el/ImplicitObjectELResolver.java\njava/javax/servlet/jsp/tagext/TagSupport.java\njava/javax/xml/ws/WebServiceRef.java\njava/org/apache/el/lang/EvaluationContext.java\njava/org/apache/el/parser/AstValue.java\njava/org/apache/jasper/el/ELContextWrapper.java\njava/org/apache/jasper/el/ExpressionEvaluatorImpl.java\njava/org/apache/naming/resources/DirContextURLConnection.java\nwebapps/docs/changelog.xml'),(1287,49779,'Bug 49779 – 501 Method not implemented with successive POST requests','','2010-08-19 05:47:51','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','426e563','Mark Emlyn David Thomas','2010-08-22 18:55:26','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49779 Improve handling of POST requests and FORM authentication, particularly when the user agent responds to the 302 response by repeating the POST request including a request body. Any request body provided at this point is now swallowed. Clean up the FormAuthenticator test case and extend the coverage to include bug 49779 and the remaining combinations of request methods.','java/org/apache/catalina/authenticator/FormAuthenticator.java\ntest/org/apache/catalina/authenticator/TestFormAuthenticator.java\ntest/org/apache/catalina/startup/SimpleHttpClient.java\nwebapps/docs/changelog.xml'),(1288,49779,'Bug 49779 – 501 Method not implemented with successive POST requests','','2010-08-19 05:47:51','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','426e563','Mark Emlyn David Thomas','2010-08-22 18:55:26','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49779 Improve handling of POST requests and FORM authentication, particularly when the user agent responds to the 302 response by repeating the POST request including a request body. Any request body provided at this point is now swallowed. Clean up the FormAuthenticator test case and extend the coverage to include bug 49779 and the remaining combinations of request methods.','java/org/apache/catalina/authenticator/FormAuthenticator.java\ntest/org/apache/catalina/authenticator/TestFormAuthenticator.java\ntest/org/apache/catalina/startup/SimpleHttpClient.java\nwebapps/docs/changelog.xml'),(1289,49779,'Bug 49779 – 501 Method not implemented with successive POST requests','','2010-08-19 05:47:51','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','339ccb7','Mark Emlyn David Thomas','2010-08-22 17:02:33','Provide 100 Continue responses if required during FORM authentication Side issues from investigating https://issues.apache.org/bugzilla/show_bug.cgi?id=49779','java/org/apache/catalina/authenticator/FormAuthenticator.java\ntest/org/apache/catalina/authenticator/TestFormAuthenticator.java\nwebapps/docs/changelog.xml'),(1290,49757,'Bug 49757 – correcting some generics related warnings','Patch attached. Thanks','2010-08-16 13:13:12','Gábor','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 trivial','d446678','Mark Emlyn David Thomas','2010-08-22 10:56:20','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49757 Correct generics warnings and a couple of other warnings whilst I had the files open. Based on a patch by Gábor','java/org/apache/catalina/manager/JMXProxyServlet.java\njava/org/apache/catalina/tribes/tipis/AbstractReplicatedMap.java\nwebapps/docs/changelog.xml'),(1291,49714,'Bug 49714 – The annotation process of Jar should not impact distributable of web.xml.','Even if < distributable/> is set to web.xml(servlet3.0), \ndistributable is changed from true to false by the annotation process of JAR. \n\nContextConfig#processAnnotations is as follows. \n===ContextConfig#processAnnotations\nprotected void processAnnotations(Set<WebXml> fragments) {\n    for(WebXml fragment : fragments) {\n        if (!fragment.isMetadataComplete()) {\n            WebXml annotations = new WebXml();\n            URL url = fragment.getURL();\n            processAnnotationsUrl(url, annotations);\n            Set<WebXml> set = new HashSet<WebXml>();\n            set.add(annotations);\n            // Merge annotations into fragment - fragment takes priority\n            fragment.merge(set);\n        }\n    }\n}\n===\ndistributable of \"annotations\" created by new WebXml() is false (default). \nIf \"annotations\" is merged with \"fragment\", distributable of \"fragment\" becomes false. \n\nBecause \"fragment\" is merged with web.xml of the web application,\neven if < distributable/> is set to web.xml, distributable is changed from true to false. \n\nThe following are necessary. \nannotations.setDistributable(true);\n\nBest regards.','2010-08-05 22:06:15','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','f4a10ec','Keiichi Fujino','2010-08-05 22:19:28','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49714 The annotation process of Jar doesn\'t influence distributable element of web.xml.','java/org/apache/catalina/startup/ContextConfig.java\nwebapps/docs/changelog.xml'),(1292,48817,'Bug 48817 – Skip validation query and use JDBC API for validation','The jdbc-pool should allow, if Java 6 is present, to not have to configure the validationQuery, but instead use the \njava.sql.Connection.isValid(int timeout)\nmethod call','2010-02-25 18:21:40','Filip Hanik','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','6c299bd','Mark Emlyn David Thomas','2010-08-05 18:27:53','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48817 Add Validator interface and allow users to configure a Validator class name','modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/DataSourceFactory.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/DataSourceProxy.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/PoolConfiguration.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/PoolProperties.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/PooledConnection.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/Validator.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/jmx/ConnectionPool.java'),(1293,49585,'Bug 49585 – jsvc.tar.gz no longer in $CATALINA_HOME/bin','The 5.5.30 and 6.0.28 (I haven\'t checked 7.0) binary releases of Tomcat no longer ship bin/jsvc.tar.gz. A look at the changelog leads me to believe this is intentional.\n\nThe documentation (setup.html), however, still refers to that file. In particular, the sentence \"Source tarballs for jsvc are included with the Tomcat binaries\" is no longer correct.','2010-07-12 05:22:39','Sergio Gelato','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Webapps:Documentation','P2 regression','3c5fc7c','Mark Emlyn David Thomas','2010-08-05 16:38:03','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49585 Update for changes in Commons Daemon packaging','webapps/docs/changelog.xml\nwebapps/docs/setup.xml'),(1294,48545,'Bug 48545 – truststorePass used in JSSESocketFactory should be optional (nillable)','','2010-01-14 07:58:48','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','bb3cf6d','Mark Emlyn David Thomas','2010-08-05 11:50:50','Extend fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=48545 to aid back-port to 6.0.x by better aligning behaviours','java/org/apache/tomcat/util/net/jsse/JSSESocketFactory.java\njava/org/apache/tomcat/util/net/jsse/res/LocalStrings.properties\nwebapps/docs/changelog.xml\nwebapps/docs/config/http.xml'),(1295,49655,'Bug 49655 – ExpressionFactoryImpl.createMethodExpression() is not EL 2.2 Spec conform','','2010-07-27 10:32:48','Sascha Gro','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 major','96a99ce','Mark Emlyn David Thomas','2010-08-01 17:04:25','Add an explicit test case for bug 49655','test/org/apache/el/TestMethodExpressionImpl.java'),(1296,49407,'Bug 49407 – backup manager reports too few current sessions','With 100 sessions shared across 4 nodes (i.e. 25 active sessions per node), the delta manager reports 100 current sessions per node (25 active and the copies of the sessions from the other nodes). The back manager reports 25. For consistency it should report 50. The 25 active sessions plus the 25 (or so) that are backed up on that node.','2010-06-08 15:58:58','Mark Thomas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Cluster','P2 normal','d21b105','Mark Emlyn David Thomas','2010-07-29 14:32:58','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49407 Make BackupManager and DeltaManager handle primary and backup sessions consistently','java/org/apache/catalina/session/ManagerBase.java\njava/org/apache/catalina/tribes/tipis/AbstractReplicatedMap.java\nwebapps/docs/changelog.xml'),(1297,49268,'Bug 49268 – Use checkstyle to enforce common code style','','2010-05-10 12:12:31','Marc Guillemot','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','0b2375f','Mark Emlyn David Thomas','2010-07-22 18:31:30','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49268 Add necessary plumbing to enable Checkstyle The config file is deliberately empty. The check will be uncommented once the source code has been fixed (~200 files contain tabs).','build.properties.default\nbuild.xml\ncheckstyle.xml\nwebapps/docs/changelog.xml'),(1298,49555,'Bug 49555 – Custom Taglibs should support all parameters','I added two method <function>s with the same name but with an addition parameters.  I get this error:\n\norg.apache.jasper.JasperException: Duplicate function name list in tag library /WEB-INF/dataStore.tld\n\nCrap!  It is not even looking at the parameters.  Ok, Java matches on method names and method parameters.  It is commonly called a method signature. \n\nWell, Jasper is in the Google SDK, so it could perhaps be smarter than I am -- so maybe I overlooked something.  Is that the case?\n\nWhy can\'t the Jasper compiler match on parameters like Java?  This is after all Java.  I\'m only using TLDs because they are cleaner then escaping Java code in JSP.  I have already wrote a considerable amount of TLD code and it does not easily mix with the expression language.  This is the reason why it is so important to have this implementation work as expected.\n\nPlease let me know how I can help.  Lets get this fixed.\n\n-Jimmy\n\nAppEngine SDK 1.3.2 (sorry, I don\'t know the embedded Jasper version)','2010-07-05 18:13:53','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','4c9845c','Mark Emlyn David Thomas','2010-07-22 17:36:11','Fix regression in previous fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=49555 Use TCCL to load webapp classes','java/org/apache/jasper/compiler/ELFunctionMapper.java'),(1299,49613,'Bug 49613 – Request.getAttributeNames() slows down some applications','','2010-07-19 06:23:09','Sampo Savolainen','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 major','5f1ad13','Mark Emlyn David Thomas','2010-07-22 10:36:15','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49613 Improve performance for multiple calls to Request.getAttributeNames() when using SSL. Patch provided by Sampo Savolainen.','java/org/apache/catalina/connector/Request.java\nwebapps/docs/changelog.xml'),(1300,49567,'Bug 49567 – when starting a new thread from a startAsync Runnable, an infinite amount of doPosts is generated','','2010-07-07 09:22:22','Pieter Libin','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 normal','2357fb5','Mark Emlyn David Thomas','2010-07-22 05:12:18','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49567 Better handling of calls to complete() from a separate thread. There are still a handful of TODOs around this which will follow shortly but I\'m committing this since it passes the unit tests and the Servlet TCK (with BIO)','java/org/apache/catalina/connector/CoyoteAdapter.java\njava/org/apache/catalina/connector/Request.java\njava/org/apache/catalina/core/AsyncContextImpl.java\njava/org/apache/coyote/http11/Http11Processor.java\ntest/org/apache/catalina/core/TestAsyncContextImpl.java\nwebapps/docs/changelog.xml'),(1301,49600,'Bug 49600 – Bad exception thrown by ProxyDirContext.lookup','','2010-07-16 05:38:47','Marc Guillemot','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','98d05b0','Mark Emlyn David Thomas','2010-07-21 16:31:30','Test case for https://issues.apache.org/bugzilla/show_bug.cgi?id=49600 Based on a patch by Marc Guillemot','test/org/apache/naming/resources/TestProxyDirContext.java'),(1302,49600,'Bug 49600 – Bad exception thrown by ProxyDirContext.lookup','','2010-07-16 05:38:47','Marc Guillemot','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','86a129a','Mark Emlyn David Thomas','2010-07-21 16:30:53','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49600 Return a consistent exception for \'Not Found\' resources.','java/org/apache/naming/resources/BaseDirContext.java\njava/org/apache/naming/resources/FileDirContext.java\njava/org/apache/naming/resources/ProxyDirContext.java\njava/org/apache/naming/resources/WARDirContext.java\nwebapps/docs/changelog.xml'),(1303,49617,'Bug 49617 – Fix ExpiresFilter docs (remove remaining ExpiresActive reference)','Remove the last references to the removed configuration parameter ExpiresActive.','2010-07-19 17:44:38','Cyrille Le Clerc','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','dfbd8aa','Mark Emlyn David Thomas','2010-07-21 12:37:58','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49617 Correct the ExpiresFilter documentation after changes to the submitted patch','java/org/apache/catalina/filters/ExpiresFilter.java\ntest/org/apache/catalina/filters/TestExpiresFilter.java\nwebapps/docs/changelog.xml\nwebapps/docs/config/filter.xml'),(1304,49428,'Bug 49428 – Fix WebDAV mounts from Windows Mini-Redirector clients','','2010-06-11 07:34:22','Panagiotis Astithas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','7543997','Mark Emlyn David Thomas','2010-07-16 07:59:57','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49428 Add a work-around for the known namespace issues for some Microsoft WebDAV clients. Patch provided by Panagiotis Astithas.','java/org/apache/catalina/servlets/WebdavServlet.java\nwebapps/docs/changelog.xml'),(1305,49598,'Bug 49598 – Session update fails and adds second cookie header without header name','The following code in a Servlet or JSP will cause invalid session cookies to be sent to the client:\n\nHttpSession session = req.getSession(true);\nsession.invalidate();\nreq.getSession(true);\n\nEssentially the client will still see the old session cookie and then try and use the now invalidated session, breaking most applications that do this.','2010-07-15 17:30:38','Mark Thomas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 regression','6468337','Mark Emlyn David Thomas','2010-07-15 17:37:41','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49598 When updating the session cookie header, actually update it rather than adding a new header without a name.','java/org/apache/catalina/connector/Response.java\nwebapps/docs/changelog.xml'),(1306,49598,'Bug 49598 – Session update fails and adds second cookie header without header name','The following code in a Servlet or JSP will cause invalid session cookies to be sent to the client:\n\nHttpSession session = req.getSession(true);\nsession.invalidate();\nreq.getSession(true);\n\nEssentially the client will still see the old session cookie and then try and use the now invalidated session, breaking most applications that do this.','2010-07-15 17:30:38','Mark Thomas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 regression','7a3db31','Mark Emlyn David Thomas','2010-07-15 17:32:35','Test case for https://issues.apache.org/bugzilla/show_bug.cgi?id=49598 Multiple invalid session cookies','test/org/apache/catalina/connector/TestResponse.java'),(1307,48998,'Bug 48998 – Proposal : port mod_expires in java as ExpiresFilter Servlet Filter','','2010-03-26 16:38:18','Cyrille Le Clerc','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','7963a16','Mark Emlyn David Thomas','2010-07-14 18:11:30','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48998 Add the ExpiresFilter, a port of mod_expires Patch provided by Cyrille Le Clerc','java/org/apache/catalina/filters/ExpiresFilter.java\njava/org/apache/catalina/filters/LocalStrings.properties\ntest/org/apache/catalina/filters/TestExpiresFilter.java\nwebapps/docs/changelog.xml\nwebapps/docs/config/filter.xml'),(1308,49127,'Bug 49127 – SimpleTcpReplicationManager.startInternal() ignores Exception','ha.session.SimpleTcpReplicationManager.startInternal() ignores Exception when invoking Thread.sleep() - it only needs to ignore InterruptedException.','2010-04-14 19:05:06','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P5 enhancement','eca4ed9','Mark Emlyn David Thomas','2010-07-14 17:39:40','Fxi https://issues.apache.org/bugzilla/show_bug.cgi?id=49127 Don\'t swallow exceptions unnecessarily','java/org/apache/catalina/ha/session/SimpleTcpReplicationManager.java\nwebapps/docs/changelog.xml'),(1309,49128,'Bug 49128 – loader.WebappClassLoader.start() ignores Exception','catalina.loader.WebappClassLoader.start() ignores Exception.\n\nHowever, it probably only needs to ignore SecurityException','2010-04-14 19:06:21','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P5 enhancement','e8245ef','Mark Emlyn David Thomas','2010-07-14 17:35:37','Fxi https://issues.apache.org/bugzilla/show_bug.cgi?id=49128 Don\'t swallow exceptions unnecessarily','java/org/apache/catalina/loader/WebappClassLoader.java\nwebapps/docs/changelog.xml'),(1310,49130,'Bug 49130 – NSIS - clarify that service is always installed','','2010-04-14 20:56:28','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Packaging','P2 enhancement','2138e13','Mark Emlyn David Thomas','2010-07-14 17:29:44','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49130 Better describe the core package Patch provided by sebb.','res/tomcat.nsi\nwebapps/docs/changelog.xml'),(1311,49182,'Bug 49182 – Documentation patch for setclasspath.sh','','2010-04-24 21:47:10','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','7dc26f7','Mark Emlyn David Thomas','2010-07-14 17:24:45','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49182 Align setclasspath comments with reality. Based on a patch provided by sebb.','bin/setclasspath.bat\nbin/setclasspath.sh\nwebapps/docs/changelog.xml'),(1312,48960,'Bug 48960 – SSI Servlet should support safe configuration','The current configuration of the SSI module is \"All\" or \"None\". The \"ALL\" option will expose all the legacy Apache SSI directive (echo, printenv, if, exec, ...). As documented, allowing SSI will allow execution of arbitrary programs using the \"exec\". As a result, there is no safe way to expose sites/projects containing SSI directive, without taking a security risk, or reviewing of every file.\n\nThe \"exec\" directive, with the cmd option is a major risk. Even for Apache, you have the option to allowing the \"safe\" include (includeNoExec). The includeNoExec allow pages to be served, even when the content is not reviewed, or when users are allowed to upload content to the site.\n\nI have a big site which need to be converted into JSP. I would like to use the SSI servlet to allow for transition over time. The extra risk from ( from exec cmd) make it impossible to deploy the SSI.\n\nMy request: Modify the configuration of SSI as follow: By default, it will only allow \"safe\" directive (no exec cmd=...). This will eliminate the risk from arbitrary execution of commands (\"del *.*\"). It will also remove many potentail load problems. The cmd= should only be allowed using a directive like \"allowUnsafeExec\", which will default to false.\n\nI think that the change will make it easier to use the SSI feature, without exposing the server to big risk. The risk associated with the \"safer\" version of SSI is similar to the risk from running JSP pages.','2010-03-22 16:37:48','Yair Lenga','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 enhancement','a36b0c0','Mark Emlyn David Thomas','2010-07-13 17:35:39','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48960 Disable exec by default in SSI and provide an option to enable it for both  Servlet and Filter','conf/web.xml\njava/org/apache/catalina/ssi/SSIFilter.java\njava/org/apache/catalina/ssi/SSIProcessor.java\njava/org/apache/catalina/ssi/SSIServlet.java\nwebapps/docs/changelog.xml\nwebapps/docs/ssi-howto.xml'),(1313,49555,'Bug 49555 – Custom Taglibs should support all parameters','I added two method <function>s with the same name but with an addition parameters.  I get this error:\n\norg.apache.jasper.JasperException: Duplicate function name list in tag library /WEB-INF/dataStore.tld\n\nCrap!  It is not even looking at the parameters.  Ok, Java matches on method names and method parameters.  It is commonly called a method signature. \n\nWell, Jasper is in the Google SDK, so it could perhaps be smarter than I am -- so maybe I overlooked something.  Is that the case?\n\nWhy can\'t the Jasper compiler match on parameters like Java?  This is after all Java.  I\'m only using TLDs because they are cleaner then escaping Java code in JSP.  I have already wrote a considerable amount of TLD code and it does not easily mix with the expression language.  This is the reason why it is so important to have this implementation work as expected.\n\nPlease let me know how I can help.  Lets get this fixed.\n\n-Jimmy\n\nAppEngine SDK 1.3.2 (sorry, I don\'t know the embedded Jasper version)','2010-07-05 18:13:53','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','b5f089d','Mark Emlyn David Thomas','2010-07-11 12:37:32','Make the fix for bug 49555 more robust','java/org/apache/jasper/compiler/ELFunctionMapper.java\ntest/org/apache/el/TestELInJsp.java\ntest/org/apache/el/TesterFunctions.java\ntest/webapp-3.0/WEB-INF/bugs.tld'),(1314,49442,'Bug 49442 – Make StringManager fields final','','2010-06-15 05:41:37','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','4159093','Mark Emlyn David Thomas','2010-07-10 17:22:12','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49442 Trivial code clean-up. No functional change. Based on a patch provided by Sebb.','java/org/apache/tomcat/util/res/StringManager.java'),(1315,49478,'Bug 49478 – Add encoding parameter to AddDefaultCharSetFilter','AddDefaultCharSetFilter adds a default charset to each request. It assumes ISO-8859-1 as the default charset.\n\nThe attached patch makes it configurable by introducing an \"encoding\" parameter. This parameter can take one of two special values \"default\" or \"system\". Every other value will be interpreted as a name of an character set, e.g \"utf-8\".\n\nThe meaning of the two special values are as follows:\n\n default: use ISO-8859-1. This value will also be used, if no parameter was specified, or if it is empty\n\n system: the jvm will be asked for the default charset. This charset will usually be set by system locale.\n\nTogether with this functional change, there are two minor changes and one bigger changes hidden. First use of annotation \"Override\" at overriden methods. Second use of keyword \"static\" for the ResponseWrapper, since it has no reference to outer class. The third and somewhat bigger change is use of HttpServletResponse#setCharacterEncoding(encoding) instead of manipulating the content-type.','2010-06-21 05:43:57','Felix Schumacher','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','d6766f1','Mark Emlyn David Thomas','2010-07-10 17:13:23','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49478 Add support for user specified character sets to the AddDefaultCharsetFilter. Based on a patch by Felix Schumacher.','java/org/apache/catalina/filters/AddDefaultCharsetFilter.java\njava/org/apache/catalina/filters/LocalStrings.properties\ntest/org/apache/catalina/filters/TestAddCharSetFilter.java\nwebapps/docs/changelog.xml\nwebapps/docs/config/filter.xml'),(1316,49570,'Bug 49570 – The CompressionFilter example should support HTTP proxies to cache gzipped content better by sending Vary: Accept-Encoding header','','2010-07-08 02:11:36','Thai Ha','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Examples','P2 enhancement','c191152','Mark Emlyn David Thomas','2010-07-10 13:20:41','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49570 When using the example compression filter, set the Vary header on compressed responses','webapps/docs/changelog.xml\nwebapps/examples/WEB-INF/classes/compressionFilters/CompressionResponseStream.java'),(1317,48297,'Bug 48297 – webservices.ServiceRefFactory.initHandlerChain adds wrong items to list?','','2009-11-28 19:01:37','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','8ef5e6a','Mark Emlyn David Thomas','2010-07-08 18:22:34','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48297 Use the HandlerInfo to initialise the HandlerChain, rather than adding to it which clearly isn\'t correct. From looking at the javadoc, I believe this is the fix required but I don\'t have a test case.','java/org/apache/naming/factory/webservices/ServiceRefFactory.java\nwebapps/docs/changelog.xml'),(1318,49555,'Bug 49555 – Custom Taglibs should support all parameters','I added two method <function>s with the same name but with an addition parameters.  I get this error:\n\norg.apache.jasper.JasperException: Duplicate function name list in tag library /WEB-INF/dataStore.tld\n\nCrap!  It is not even looking at the parameters.  Ok, Java matches on method names and method parameters.  It is commonly called a method signature. \n\nWell, Jasper is in the Google SDK, so it could perhaps be smarter than I am -- so maybe I overlooked something.  Is that the case?\n\nWhy can\'t the Jasper compiler match on parameters like Java?  This is after all Java.  I\'m only using TLDs because they are cleaner then escaping Java code in JSP.  I have already wrote a considerable amount of TLD code and it does not easily mix with the expression language.  This is the reason why it is so important to have this implementation work as expected.\n\nPlease let me know how I can help.  Lets get this fixed.\n\n-Jimmy\n\nAppEngine SDK 1.3.2 (sorry, I don\'t know the embedded Jasper version)','2010-07-05 18:13:53','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','aa69f6d','Mark Emlyn David Thomas','2010-07-08 17:29:12','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49555 Correctly handle tag libraries that use functions defined in static inner classes','java/org/apache/jasper/compiler/ELFunctionMapper.java\nwebapps/docs/changelog.xml'),(1319,49555,'Bug 49555 – Custom Taglibs should support all parameters','I added two method <function>s with the same name but with an addition parameters.  I get this error:\n\norg.apache.jasper.JasperException: Duplicate function name list in tag library /WEB-INF/dataStore.tld\n\nCrap!  It is not even looking at the parameters.  Ok, Java matches on method names and method parameters.  It is commonly called a method signature. \n\nWell, Jasper is in the Google SDK, so it could perhaps be smarter than I am -- so maybe I overlooked something.  Is that the case?\n\nWhy can\'t the Jasper compiler match on parameters like Java?  This is after all Java.  I\'m only using TLDs because they are cleaner then escaping Java code in JSP.  I have already wrote a considerable amount of TLD code and it does not easily mix with the expression language.  This is the reason why it is so important to have this implementation work as expected.\n\nPlease let me know how I can help.  Lets get this fixed.\n\n-Jimmy\n\nAppEngine SDK 1.3.2 (sorry, I don\'t know the embedded Jasper version)','2010-07-05 18:13:53','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','463f494','Mark Emlyn David Thomas','2010-07-08 17:28:21','Test case for https://issues.apache.org/bugzilla/show_bug.cgi?id=49555 Fix to follow shortly','test/org/apache/el/TestELInJsp.java\ntest/org/apache/el/TesterFunctions.java\ntest/webapp-3.0/WEB-INF/bugs.tld\ntest/webapp-3.0/bug49555.jsp'),(1320,49503,'Bug 49503 – Connectors do not bind to their ports in Catalina.load(), but only later in start()','','2010-06-25 11:22:41','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','a90b576','Mark Emlyn David Thomas','2010-07-08 11:48:48','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49503 Revert the protocol handler component of r940656. Subsequent lifecycle fixes have resolved the issues that required this change','java/org/apache/catalina/connector/Connector.java\nwebapps/docs/changelog.xml'),(1321,49217,'Bug 49217 – Accepting java keyword in EL','According to EL, the Whatever comes to the right of the dot operator must follow normal Java naming rules for identifiers. For example it must not be a Java Key word (Here the example is shown for int, which is a Java key word).\n\n// Java Bean\npackage library;\npublic class Book {\nprivate String title;\npublic void setInt(String title) {\nthis.title = title;\n}\npublic String getInt() {\nreturn title;\n}\n}\n// JSP\n<%\nlibrary.Book book = new library.Book();\nbook.setInt(\"sample title\");\nrequest.setAttribute(\"book\", book);\n%>\n${book.int}\n//OUTPUT\nsample title','2010-04-29 05:32:05','sekhar','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 minor','1697a64','Mark Emlyn David Thomas','2010-07-06 12:47:39','Improve fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=49217 Make sure identifiers meet the requirements of the JLS','java/org/apache/el/parser/AstDotSuffix.java\njava/org/apache/el/parser/AstIdentifier.java\njava/org/apache/el/util/Validation.java\nwebapps/docs/changelog.xml'),(1322,49217,'Bug 49217 – Accepting java keyword in EL','According to EL, the Whatever comes to the right of the dot operator must follow normal Java naming rules for identifiers. For example it must not be a Java Key word (Here the example is shown for int, which is a Java key word).\n\n// Java Bean\npackage library;\npublic class Book {\nprivate String title;\npublic void setInt(String title) {\nthis.title = title;\n}\npublic String getInt() {\nreturn title;\n}\n}\n// JSP\n<%\nlibrary.Book book = new library.Book();\nbook.setInt(\"sample title\");\nrequest.setAttribute(\"book\", book);\n%>\n${book.int}\n//OUTPUT\nsample title','2010-04-29 05:32:05','sekhar','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 minor','e0edc60','Mark Emlyn David Thomas','2010-07-06 12:45:23','Side effect of fixing https://issues.apache.org/bugzilla/show_bug.cgi?id=49217 Make the examples and the unit tests spec compliant','test/webapp-3.0/bug47413.jsp\nwebapps/examples/WEB-INF/classes/jsp2/examples/ValuesBean.java\nwebapps/examples/jsp/jsp2/el/composite.jsp'),(1323,49217,'Bug 49217 – Accepting java keyword in EL','According to EL, the Whatever comes to the right of the dot operator must follow normal Java naming rules for identifiers. For example it must not be a Java Key word (Here the example is shown for int, which is a Java key word).\n\n// Java Bean\npackage library;\npublic class Book {\nprivate String title;\npublic void setInt(String title) {\nthis.title = title;\n}\npublic String getInt() {\nreturn title;\n}\n}\n// JSP\n<%\nlibrary.Book book = new library.Book();\nbook.setInt(\"sample title\");\nrequest.setAttribute(\"book\", book);\n%>\n${book.int}\n//OUTPUT\nsample title','2010-04-29 05:32:05','sekhar','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 minor','c43a580','Mark Emlyn David Thomas','2010-07-05 17:45:26','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49217 Prevent use of Java keywords in identifiers','java/org/apache/el/parser/AstDotSuffix.java\njava/org/apache/el/parser/AstIdentifier.java\njava/org/apache/el/util/Validation.java\nwebapps/docs/changelog.xml'),(1324,49217,'Bug 49217 – Accepting java keyword in EL','According to EL, the Whatever comes to the right of the dot operator must follow normal Java naming rules for identifiers. For example it must not be a Java Key word (Here the example is shown for int, which is a Java key word).\n\n// Java Bean\npackage library;\npublic class Book {\nprivate String title;\npublic void setInt(String title) {\nthis.title = title;\n}\npublic String getInt() {\nreturn title;\n}\n}\n// JSP\n<%\nlibrary.Book book = new library.Book();\nbook.setInt(\"sample title\");\nrequest.setAttribute(\"book\", book);\n%>\n${book.int}\n//OUTPUT\nsample title','2010-04-29 05:32:05','sekhar','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 minor','aa8495b','Mark Emlyn David Thomas','2010-07-05 17:44:29','Test case for https://issues.apache.org/bugzilla/show_bug.cgi?id=49217','test/org/apache/el/parser/TestELParser.java\ntest/org/apache/el/parser/TesterBeanA.java'),(1325,49551,'Bug 49551 – When setting absolute path to default context.xml, in ContextConfig.contextConfig() it cannot be found','','2010-07-05 07:41:23','Violeta Georgieva','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','dca6dd1','Mark Emlyn David Thomas','2010-07-05 17:07:32','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49551 Allow default context.xml file to be specified using an absolute path.','java/org/apache/catalina/startup/ContextConfig.java\nwebapps/docs/changelog.xml'),(1326,49550,'Bug 49550 – [PATCH] Response class fix isSpace (deprecated) => isWhiteSpace','','2010-07-05 07:23:31','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','7b9630b','Mark Emlyn David Thomas','2010-07-05 16:58:23','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49550 Trivial code clean up','java/org/apache/catalina/connector/Response.java\nwebapps/docs/changelog.xml'),(1327,49528,'Bug 49528 – HttpServletRequest.isAsyncStarted() returns false when a Runnable is started','','2010-06-30 06:32:11','Pieter Libin','Tomcat Developers Mailing List','CLOSED FIXED','Tomcat 7','Servlet & JSP API','P2 blocker','cdbb47c','Mark Emlyn David Thomas','2010-07-05 16:51:21','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49528 Previous fix was incomplete. Improve test case and fix TCK and test cases pass with this patch','java/org/apache/catalina/connector/Request.java\njava/org/apache/catalina/core/AsyncContextImpl.java\ntest/org/apache/catalina/core/TestAsyncContextImpl.java'),(1328,49528,'Bug 49528 – HttpServletRequest.isAsyncStarted() returns false when a Runnable is started','','2010-06-30 06:32:11','Pieter Libin','Tomcat Developers Mailing List','CLOSED FIXED','Tomcat 7','Servlet & JSP API','P2 blocker','d82e80e','Mark Emlyn David Thomas','2010-07-04 16:38:41','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49528 AsyncContext.start() uses an internal dispatch but this should not have the same side-effects as calling dispatch() TCK and test cases passes with this patch','java/org/apache/catalina/core/AsyncContextImpl.java\nwebapps/docs/changelog.xml'),(1329,49528,'Bug 49528 – HttpServletRequest.isAsyncStarted() returns false when a Runnable is started','','2010-06-30 06:32:11','Pieter Libin','Tomcat Developers Mailing List','CLOSED FIXED','Tomcat 7','Servlet & JSP API','P2 blocker','398ca7e','Mark Emlyn David Thomas','2010-07-04 16:34:02','Add a test case for https://issues.apache.org/bugzilla/show_bug.cgi?id=49528','test/org/apache/catalina/core/TestAsyncContextImpl.java'),(1330,49528,'Bug 49528 – HttpServletRequest.isAsyncStarted() returns false when a Runnable is started','','2010-06-30 06:32:11','Pieter Libin','Tomcat Developers Mailing List','CLOSED FIXED','Tomcat 7','Servlet & JSP API','P2 blocker','741e000','Peter Rossbach','2010-07-03 18:48:16','Fix Bug 49528 - HttpServletRequest.isAsyncStarted() returns false when a Runnable is started Add isDebugEnabled statements.','java/org/apache/catalina/core/AsyncContextImpl.java\ntest/org/apache/catalina/core/TestAsyncContextImpl.java\nwebapps/docs/changelog.xml'),(1331,49530,'Bug 49530 – Context is not correctly stopped at shutdown','','2010-06-30 10:08:43','Rainer Frey','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','3bd4bcb','Mark Emlyn David Thomas','2010-07-02 14:04:14','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49530 Make sure children are stopped if they are running when the parent stops.','java/org/apache/catalina/core/ContainerBase.java\nwebapps/docs/changelog.xml'),(1332,49536,'Bug 49536 – If no webapps deployed, accessing a URL returns 200 OK with no content instead of 404','','2010-07-01 04:07:11','S. Ali Tokmen','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 regression','4e34898','Mark Emlyn David Thomas','2010-07-01 17:35:19','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49536 Ensure a 404 response for an unmapped request when no ROOT context is deployed. Most of the change is getting the mapper to use the Host object rather than the ObjectName or an empty string','java/org/apache/catalina/connector/CoyoteAdapter.java\njava/org/apache/catalina/connector/MapperListener.java\njava/org/apache/catalina/connector/Request.java\njava/org/apache/tomcat/util/http/mapper/Mapper.java\nwebapps/docs/changelog.xml'),(1333,49525,'Bug 49525 – IE8: Unabled to store data in HttpSession (root context)','Environment:\n\nTomcat 7.0.0 Beta\nIE8\n\nA simplest webapp only have a test.jsp below:\n\n<%=request.getSession().getId()%>\n\nthis app installed as root context\n\nthe test.jsp works fine in firefox\n\nbut when using IE8\n\nthere is always a different session id where refresh the test page.\n\nBTW: the test.jsp works find in Tomcat 6.x','2010-06-29 22:22:03','oschina.net','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 blocker','0b8a9a8','Mark Emlyn David Thomas','2010-07-01 15:33:45','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49525 Cookies for ROOT context need a path of /','java/org/apache/catalina/core/ApplicationSessionCookieConfig.java\nwebapps/docs/changelog.xml'),(1334,49522,'Bug 49522 – Complete Server status (status/all) causes stack trace','type Exception report\n\nmessage\n\ndescription The server encountered an internal error () that prevented it from fulfilling this request.\n\nexception\n\njavax.servlet.ServletException: javax.management.AttributeNotFoundException:  Cannot find attribute startTime for org.apache.catalina.deploy.NamingResources@d1c778\n	org.apache.catalina.manager.StatusManagerServlet.doGet(StatusManagerServlet.java:292)\n	javax.servlet.http.HttpServlet.service(HttpServlet.java:621)\n	javax.servlet.http.HttpServlet.service(HttpServlet.java:722)\n\nroot cause\n\njavax.management.AttributeNotFoundException:  Cannot find attribute startTime for org.apache.catalina.deploy.NamingResources@d1c778\n	org.apache.tomcat.util.modeler.ManagedBean.getGetter(ManagedBean.java:493)\n	org.apache.tomcat.util.modeler.BaseModelMBean.getAttribute(BaseModelMBean.java:180)\n	com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.getAttribute(DefaultMBeanServerInterceptor.java:666)\n	com.sun.jmx.mbeanserver.JmxMBeanServer.getAttribute(JmxMBeanServer.java:638)\n	org.apache.catalina.manager.StatusTransformer.writeContext(StatusTransformer.java:656)\n	org.apache.catalina.manager.StatusTransformer.writeDetailedState(StatusTransformer.java:590)\n	org.apache.catalina.manager.StatusManagerServlet.doGet(StatusManagerServlet.java:287)\n	javax.servlet.http.HttpServlet.service(HttpServlet.java:621)\n	javax.servlet.http.HttpServlet.service(HttpServlet.java:722)','2010-06-29 10:41:51','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Manager','P2 normal','3c88f07','Mark Emlyn David Thomas','2010-07-01 14:06:47','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49522 Just use host and path in NamingResources MBean name rather than full Context MBean name','java/org/apache/catalina/core/StandardContext.java\nwebapps/docs/changelog.xml'),(1335,49518,'Bug 49518 – Typo in tomcat-7.0-doc/extras.html ?','','2010-06-29 08:26:44','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 trivial','4223989','Mark Emlyn David Thomas','2010-07-01 07:28:49','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49518 Correct typo','webapps/docs/changelog.xml\nwebapps/docs/extras.xml'),(1336,49414,'Bug 49414 – Wrong memory leak detection: executor thread reported as web app thread','','2010-06-09 10:11:08','Marc Guillemot','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','e434c4c','Mark Emlyn David Thomas','2010-06-26 03:04:32','Improve fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=49414 Just look for presence of CoyoteAdapter class','java/org/apache/catalina/loader/WebappClassLoader.java'),(1337,49030,'Bug 49030 – Processing of Tomcat Connector configuration can leave some connectors uninitialized','If the Server part of the Tomcat 6 configuration is beeing processed and there are more connectory defined, it seems to be the fact the exceptions during the connector initialization are not catched properly, so if there comes some exception by the initialization of one connector (for example to try to initialize the new connector for the same port like had the already initialized connector), then no other connectors are processed and created (no one listening port is allocated) even if such other connectors are defined properly. It leads to the situation the connectory are then initialized differently if the order of the connectors changes. It can be very confusing if searching some error in the definitions. Together with the fact, the default server.xml contains at least in some cases the invalid connector definition it leads to serious confusion it searching the configuration problem...','2010-03-31 12:34:56','Artur Linhart','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','fc44a48','Konstantin Kolinko','2010-06-25 10:13:26','Additional fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=49030 When initializing/starting/stopping connectors and one of them fails, do not ignore the others.','java/org/apache/catalina/core/LocalStrings.properties\njava/org/apache/catalina/core/StandardService.java\nwebapps/docs/changelog.xml'),(1338,49488,'Bug 49488 – Infrequent StringIndexOutOfBoundsException in WebappClassLoader','After switching from Tomcat 5.5 to Tomcat 6.0.24, every now and then Tomcat\'s WebappClassLoader throws StringIndexOutOfBoundsExceptions, which leads to various exceptions like NoDefClassFoundError. With Tomcat 5.5, everything went fine. The web application in which the exceptions occur remained untouched throughout the whole time. The error is also present in Tomcat 6.0.26.\n\nHere is a short stack trace from the Catalina log file:\n\njava.lang.StringIndexOutOfBoundsException: String index out of range: 95\n         at java.lang.String.substring(String.java:1934)\n         at org.apache.catalina.util.RequestUtil.normalize(RequestUtil.java:131)\n         at org.apache.naming.resources.FileDirContext.normalize(FileDirContext.java:771)\n         at org.apache.naming.resources.FileDirContext.file(FileDirContext.java:809)\n         at org.apache.naming.resources.FileDirContext.getAttributes(FileDirContext.java:429)\n         at org.apache.naming.resources.BaseDirContext.getAttributes(BaseDirContext.java:747)\n         at org.apache.naming.resources.ProxyDirContext.getAttributes(ProxyDirContext.java:840)\n         at org.apache.catalina.loader.WebappClassLoader.findResourceInternal(WebappClassLoader.java:2414)\n         at org.apache.catalina.loader.WebappClassLoader.findClassInternal(WebappClassLoader.java:2266)\n         at org.apache.catalina.loader.WebappClassLoader.findClass(WebappClassLoader.java:976)\n         at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1451)\n         at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1329)\n         at java.lang.Class.getDeclaredClasses0(Native Method)\n         at java.lang.Class.getDeclaredClasses(Class.java:1699)','2010-06-22 07:24:50','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED WORKSFORME','Tomcat 6','Catalina','P2 normal','d141e95','Mark Emlyn David Thomas','2010-06-25 03:58:14','Add a check of the edge cases for bug 49488. As expected, they all pass.','test/org/apache/catalina/util/TestRequestUtil.java'),(1339,49414,'Bug 49414 – Wrong memory leak detection: executor thread reported as web app thread','','2010-06-09 10:11:08','Marc Guillemot','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','65ad74b','Mark Emlyn David Thomas','2010-06-25 03:53:24','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49414 Try to differentiate between request threads and threads started by applications','java/org/apache/catalina/loader/LocalStrings.properties\njava/org/apache/catalina/loader/WebappClassLoader.java\nwebapps/docs/config/context.xml'),(1340,49476,'Bug 49476 – Cannot expire selected session in Manager webapp','','2010-06-20 11:47:00','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Manager','P2 normal','a0159a3','Mark Emlyn David Thomas','2010-06-24 05:57:02','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49476 CSRF protection was preventing access to session expiration features Also: - Switch Manager app to generic CSRF protection - Add support for multiple nonces to CSRF filter - Improve 403 page - Don\'t open JSP pages in session expiration in a new window - makes CSRF prevention a real pain','java/org/apache/catalina/filters/CsrfPreventionFilter.java\njava/org/apache/catalina/manager/HTMLManagerServlet.java\njava/org/apache/catalina/manager/LocalStrings.properties\nwebapps/docs/config/filter.xml\nwebapps/manager/403.jsp\nwebapps/manager/WEB-INF/jsp/sessionDetail.jsp\nwebapps/manager/WEB-INF/jsp/sessionsList.jsp\nwebapps/manager/WEB-INF/web.xml'),(1341,49230,'Bug 49230 – sun.net.www.http.KeepAliveCache preventing classloader from being garbage collected','','2010-04-29 12:17:59','Rob Kooper','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','6f18d02','Mark Emlyn David Thomas','2010-06-23 03:40:19','Improve the fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=49230 Don\'t log an error about loading Sun class on non-Sun JVMs. Use i18n for message.','java/org/apache/catalina/core/JreMemoryLeakPreventionListener.java\njava/org/apache/catalina/core/LocalStrings.properties'),(1342,49475,'Bug 49475 – Welcome page mentions obsolete role name','','2010-06-20 11:30:42','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 minor','03dc1e3','Mark Emlyn David Thomas','2010-06-22 15:18:51','Add fix of 49475','webapps/docs/changelog.xml'),(1343,49475,'Bug 49475 – Welcome page mentions obsolete role name','','2010-06-20 11:30:42','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 minor','81aeb8b','Mark Emlyn David Thomas','2010-06-22 15:17:08','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49475 Use new role name for manager app access','webapps/ROOT/index.html'),(1344,49122,'Bug 49122 – Update of ROOT application index.html','The patch adds a new paragraph at the top of the page, recommending that users join the low volume Tomcat Announce list and adds a link to the appropriate subscription email address.\n\nThe patch also replaces the table based layout with a standards compliant CSS version, which is largely visually identical.','2010-04-14 09:40:44','Pid','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Examples','P2 enhancement','4875e8d','Mark Emlyn David Thomas','2010-06-22 13:52:40','https://issues.apache.org/bugzilla/show_bug.cgi?id=49122 Update ROOT\'s index page Patch provided by pid','webapps/ROOT/index.html\nwebapps/docs/changelog.xml'),(1345,49230,'Bug 49230 – sun.net.www.http.KeepAliveCache preventing classloader from being garbage collected','','2010-04-29 12:17:59','Rob Kooper','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','470afe6','Mark Emlyn David Thomas','2010-06-22 05:21:25','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49230 Enhance JRE leak prevention listener with protection for the keep-alive thread started by sun.net.www.http.HttpClient Patch provided by Rob Kooper.','java/org/apache/catalina/core/JreMemoryLeakPreventionListener.java\nwebapps/docs/changelog.xml\nwebapps/docs/config/listeners.xml'),(1346,49443,'Bug 49443 – RemoteIpValve : remoteIpHeader vs remoteIPHeader','','2010-06-15 07:38:37','Sylvain Laurent','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P2 minor','27091e7','Mark Emlyn David Thomas','2010-06-18 07:19:38','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49443 Use remoteIp... rather then remoteIP... consistently','java/org/apache/catalina/filters/RemoteIpFilter.java\njava/org/apache/catalina/valves/RemoteIpValve.java\nwebapps/docs/config/filter.xml\nwebapps/docs/config/valve.xml'),(1347,49436,'Bug 49436 – Documented default for UserDatabase readonly attribute wrong','In version 6.0.26 org.apache.catalina.users.MemoryUserDatabase sets readonly = true. In version 5.5.29 org.apache.catalina.users.MemoryUserDatabase sets readonly = false. This means that the save method will default to logging an error message rather than saving the user database file.\n\n    public void save()\n        throws Exception\n    {\n        if(getReadonly())\n        {\n            log.error(sm.getString(\"memoryUserDatabase.readOnly\"));\n            return;\n        }\n\nThe message that is displayed in 6.0.26 is:\nmemoryUserDatabase.readOnly=User database has been configured to be read only. Changes cannot be saved\n\nI cannot find any documentation or a JMX management bean to set readonly = false.\nHence the save method I was using in Tomcat 5.0.28 and tomcat 5.5.29 no longer works.\n\nDavid Tugby','2010-06-14 14:03:54','David Tugby','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','c03b040','Mark Emlyn David Thomas','2010-06-18 06:18:09','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49436 Correct default for UserDatabase\'s readonly attribute','webapps/docs/changelog.xml\nwebapps/docs/jndi-resources-howto.xml'),(1348,44285,'Bug 44285 – ssl.SessionId Cache Control','There is no way to control the ssl.SessionId cache size.\nThe default Sun JVM behavior is too keep a SoftReference cache that grows as much as it can. This has \na performance impact since the GC works harder because of the heap size.\n\nThe result is that with a system that has a lot of https clients, the memory grows to a very large size:\nWe have 700K of SessionIds in memory consuming a little over 800MB !!!\n\nI think the connector should have attributes that let me control the max time and size ssl.sessionid are \nkept (for reference, websphere let\'s you do that).\n\nAnother useful feature would be to let me explicitly invalidate a ssl.sessionid (during the request life \ncycle).','2008-01-23 05:29:19','Yuval Perlov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 enhancement','71ea003','Jean-Frederic Clere','2010-06-17 05:41:19','Typo in previous fix for 44285','java/org/apache/coyote/http11/AbstractHttp11Protocol.java'),(1349,49445,'Bug 49445 – After session ID is changed on authentication, the session replication does not work.','After r889716, \nsession ID is changed on authentication. \n(default of changeSessionIdOnAuthentication is true. )\nBut DeltaManager doesn\'t notify other cluster nodes. \n\nTherefore, non-primary node keeps having old session ID. \nAnd, can not replicate of change of session attribute notified by new session ID. \n\nThe workaround is ...\noverride changeSessionId method, and notify to change session ID.\n\nBackupManager is OK. \nThis problem is DeltaManager only.\n\nBest regards.','2010-06-16 05:08:02','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina:Cluster','P2 normal','4f990f1','Keiichi Fujino','2010-06-16 07:01:45','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49445 The change in session ID is notified to other node.','java/org/apache/catalina/ha/session/DeltaManager.java\njava/org/apache/catalina/ha/session/LocalStrings.properties\njava/org/apache/catalina/ha/session/SessionMessage.java\njava/org/apache/catalina/ha/session/SessionMessageImpl.java\njava/org/apache/catalina/ha/session/mbeans-descriptors.xml'),(1350,49213,'Bug 49213 – Manager application doesn\'t work in security mode','In the manager application, the sessions page doesn\'t work when I launch Tomcat with -security argument. I had to add the following permissions :\n    grant codeBase \"file:${catalina.home}/webapps/manager/-\" {\n        permission java.lang.RuntimePermission \"accessClassInPackage.org.apache.catalina\";\n        permission java.lang.RuntimePermission \"accessClassInPackage.org.apache.catalina.manager\";\n        permission java.lang.RuntimePermission \"accessClassInPackage.org.apache.catalina.manager.util\";\n    };','2010-04-28 12:34:12','Alexis Hassler','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Manager application','P2 normal','ac696d6','Mark Emlyn David Thomas','2010-06-14 08:53:20','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49213 Add permissions required by Manager application','conf/catalina.policy'),(1351,49424,'Bug 49424 – Using URL.ChunkedStreamingMode results in HTTP response code: 405','Using the URL class coupled with setChunkedStreamingMode  results in:\n\nSEVERE: java.lang.NullPointerException\n	at org.apache.catalina.connector.Request.readChunkedPostBody(Request.java:2632)\n\nThis is true for 6.0.26.  This worked fine in 6.0.16 and the source code\nthat I have for 6.0.20 does not have the readChunkedPostBody method.\n\nAttached is a TestNG unit test demonstrating the issue.  The method\nconnectNoChunking() runs fine while the method connectWithChunking() fails.','2010-06-10 14:08:48','Earl Nolan','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 regression','bd87fe1','Mark Emlyn David Thomas','2010-06-10 15:58:49','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49424 Avoid NPE if no input data is provided in a chunked POST request','java/org/apache/catalina/connector/Request.java'),(1352,49424,'Bug 49424 – Using URL.ChunkedStreamingMode results in HTTP response code: 405','Using the URL class coupled with setChunkedStreamingMode  results in:\n\nSEVERE: java.lang.NullPointerException\n	at org.apache.catalina.connector.Request.readChunkedPostBody(Request.java:2632)\n\nThis is true for 6.0.26.  This worked fine in 6.0.16 and the source code\nthat I have for 6.0.20 does not have the readChunkedPostBody method.\n\nAttached is a TestNG unit test demonstrating the issue.  The method\nconnectNoChunking() runs fine while the method connectWithChunking() fails.','2010-06-10 14:08:48','Earl Nolan','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 regression','734bee9','Mark Emlyn David Thomas','2010-06-10 15:58:02','Test cases for bug49424 based on a patch by Earl Nolan','test/org/apache/catalina/connector/TestRequest.java'),(1353,49372,'Bug 49372 – 7.0.0RC: Starting second instance of Tomcat on the same port results in \"An invalid Lifecycle transition was attempted\"','Using the current pre-7.0.0 trunk as of now (r950811),\nto reproduce:\n1) start an instance of Tomcat\n2) start the second instance of Tomcat using the same configuration\n\nThe start fails (as expected), but the messages are accompanied with \nLifecycleException:  An invalid Lifecycle transition was attempted ([before_stop]) for component [StandardServer[8005]] in state [STARTING]\n\nSee the log below.\n\n03.06.2010 3:14:08 org.apache.catalina.startup.Catalina load\nINFO: Initialization processed in 3145 ms\n03.06.2010 3:14:09 org.apache.catalina.core.StandardService startInternal\nINFO: Starting service Catalina\n03.06.2010 3:14:09 org.apache.catalina.core.StandardEngine startInternal\nINFO: Starting Servlet Engine: Apache Tomcat/7.0.0-dev\n03.06.2010 3:14:09 org.apache.catalina.startup.HostConfig deployDirectory\nINFO: Deploying web application directory docs\n03.06.2010 3:14:11 org.apache.catalina.startup.HostConfig deployDirectory\nINFO: Deploying web application directory examples\n03.06.2010 3:14:12 org.apache.catalina.startup.HostConfig deployDirectory\nINFO: Deploying web application directory host-manager\n03.06.2010 3:14:13 org.apache.catalina.startup.HostConfig deployDirectory\nINFO: Deploying web application directory manager\n03.06.2010 3:14:13 org.apache.catalina.startup.HostConfig deployDirectory\nINFO: Deploying web application directory ROOT\n03.06.2010 3:14:13 org.apache.coyote.http11.Http11Protocol init\nSEVERE: Error initializing endpoint\njava.net.BindException: Address already in use: JVM_Bind <null>:8080\n	at org.apache.tomcat.util.net.JIoEndpoint.init(JIoEndpoint.java:368)\n	at org.apache.coyote.http11.Http11Protocol.init(Http11Protocol.java:125)\n	at org.apache.catalina.connector.Connector.startInternal(Connector.java:866)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:137)\n	at org.apache.catalina.core.StandardService.startInternal(StandardService.java:437)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:137)\n	at org.apache.catalina.core.StandardServer.startInternal(StandardServer.java:648)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:137)\n	at org.apache.catalina.startup.Catalina.start(Catalina.java:576)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n	at java.lang.reflect.Method.invoke(Method.java:597)\n	at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:288)\n	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:415)\nCaused by: java.net.BindException: Address already in use: JVM_Bind\n	at java.net.PlainSocketImpl.socketBind(Native Method)\n	at java.net.PlainSocketImpl.bind(PlainSocketImpl.java:365)\n	at java.net.ServerSocket.bind(ServerSocket.java:319)\n	at java.net.ServerSocket.<init>(ServerSocket.java:185)\n	at java.net.ServerSocket.<init>(ServerSocket.java:141)\n	at org.apache.tomcat.util.net.DefaultServerSocketFactory.createSocket(DefaultServerSocketFactory.java:52)\n	at org.apache.tomcat.util.net.JIoEndpoint.init(JIoEndpoint.java:357)\n	... 14 more\n03.06.2010 3:14:13 org.apache.catalina.startup.Catalina start\nSEVERE: Catalina.start: \nLifecycleException:  Protocol handler initialization failed: java.net.BindException: Address already in use: JVM_Bind <null>:8080\n	at org.apache.catalina.connector.Connector.startInternal(Connector.java:868)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:137)\n	at org.apache.catalina.core.StandardService.startInternal(StandardService.java:437)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:137)\n	at org.apache.catalina.core.StandardServer.startInternal(StandardServer.java:648)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:137)\n	at org.apache.catalina.startup.Catalina.start(Catalina.java:576)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n	at java.lang.reflect.Method.invoke(Method.java:597)\n	at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:288)\n	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:415)\n03.06.2010 3:14:13 org.apache.catalina.startup.Catalina start\nINFO: Server startup in 4737 ms\n03.06.2010 3:14:13 org.apache.catalina.core.StandardServer await\nSEVERE: StandardServer.await: create[localhost:8005]: \njava.net.BindException: Address already in use: JVM_Bind\n	at java.net.PlainSocketImpl.socketBind(Native Method)\n	at java.net.PlainSocketImpl.bind(PlainSocketImpl.java:365)\n	at java.net.ServerSocket.bind(ServerSocket.java:319)\n	at java.net.ServerSocket.<init>(ServerSocket.java:185)\n	at org.apache.catalina.core.StandardServer.await(StandardServer.java:359)\n	at org.apache.catalina.startup.Catalina.await(Catalina.java:654)\n	at org.apache.catalina.startup.Catalina.start(Catalina.java:608)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n	at java.lang.reflect.Method.invoke(Method.java:597)\n	at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:288)\n	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:415)\n03.06.2010 3:14:13 org.apache.catalina.startup.Catalina stop\nSEVERE: Catalina.stop\nLifecycleException:  An invalid Lifecycle transition was attempted ([before_stop]) for component [StandardServer[8005]] in state [STARTING]\n	at org.apache.catalina.util.LifecycleBase.invalidTransition(LifecycleBase.java:315)\n	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:204)\n	at org.apache.catalina.startup.Catalina.stop(Catalina.java:641)\n	at org.apache.catalina.startup.Catalina$CatalinaShutdownHook.run(Catalina.java:783)','2010-06-02 19:23:32','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','53a81b2','Mark Emlyn David Thomas','2010-06-06 17:51:30','Remainder of fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=49372 Avoid invalid Lifecycle transitions on failed start due to already bound shutdown port','java/org/apache/catalina/core/StandardService.java'),(1354,49372,'Bug 49372 – 7.0.0RC: Starting second instance of Tomcat on the same port results in \"An invalid Lifecycle transition was attempted\"','Using the current pre-7.0.0 trunk as of now (r950811),\nto reproduce:\n1) start an instance of Tomcat\n2) start the second instance of Tomcat using the same configuration\n\nThe start fails (as expected), but the messages are accompanied with \nLifecycleException:  An invalid Lifecycle transition was attempted ([before_stop]) for component [StandardServer[8005]] in state [STARTING]\n\nSee the log below.\n\n03.06.2010 3:14:08 org.apache.catalina.startup.Catalina load\nINFO: Initialization processed in 3145 ms\n03.06.2010 3:14:09 org.apache.catalina.core.StandardService startInternal\nINFO: Starting service Catalina\n03.06.2010 3:14:09 org.apache.catalina.core.StandardEngine startInternal\nINFO: Starting Servlet Engine: Apache Tomcat/7.0.0-dev\n03.06.2010 3:14:09 org.apache.catalina.startup.HostConfig deployDirectory\nINFO: Deploying web application directory docs\n03.06.2010 3:14:11 org.apache.catalina.startup.HostConfig deployDirectory\nINFO: Deploying web application directory examples\n03.06.2010 3:14:12 org.apache.catalina.startup.HostConfig deployDirectory\nINFO: Deploying web application directory host-manager\n03.06.2010 3:14:13 org.apache.catalina.startup.HostConfig deployDirectory\nINFO: Deploying web application directory manager\n03.06.2010 3:14:13 org.apache.catalina.startup.HostConfig deployDirectory\nINFO: Deploying web application directory ROOT\n03.06.2010 3:14:13 org.apache.coyote.http11.Http11Protocol init\nSEVERE: Error initializing endpoint\njava.net.BindException: Address already in use: JVM_Bind <null>:8080\n	at org.apache.tomcat.util.net.JIoEndpoint.init(JIoEndpoint.java:368)\n	at org.apache.coyote.http11.Http11Protocol.init(Http11Protocol.java:125)\n	at org.apache.catalina.connector.Connector.startInternal(Connector.java:866)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:137)\n	at org.apache.catalina.core.StandardService.startInternal(StandardService.java:437)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:137)\n	at org.apache.catalina.core.StandardServer.startInternal(StandardServer.java:648)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:137)\n	at org.apache.catalina.startup.Catalina.start(Catalina.java:576)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n	at java.lang.reflect.Method.invoke(Method.java:597)\n	at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:288)\n	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:415)\nCaused by: java.net.BindException: Address already in use: JVM_Bind\n	at java.net.PlainSocketImpl.socketBind(Native Method)\n	at java.net.PlainSocketImpl.bind(PlainSocketImpl.java:365)\n	at java.net.ServerSocket.bind(ServerSocket.java:319)\n	at java.net.ServerSocket.<init>(ServerSocket.java:185)\n	at java.net.ServerSocket.<init>(ServerSocket.java:141)\n	at org.apache.tomcat.util.net.DefaultServerSocketFactory.createSocket(DefaultServerSocketFactory.java:52)\n	at org.apache.tomcat.util.net.JIoEndpoint.init(JIoEndpoint.java:357)\n	... 14 more\n03.06.2010 3:14:13 org.apache.catalina.startup.Catalina start\nSEVERE: Catalina.start: \nLifecycleException:  Protocol handler initialization failed: java.net.BindException: Address already in use: JVM_Bind <null>:8080\n	at org.apache.catalina.connector.Connector.startInternal(Connector.java:868)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:137)\n	at org.apache.catalina.core.StandardService.startInternal(StandardService.java:437)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:137)\n	at org.apache.catalina.core.StandardServer.startInternal(StandardServer.java:648)\n	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:137)\n	at org.apache.catalina.startup.Catalina.start(Catalina.java:576)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n	at java.lang.reflect.Method.invoke(Method.java:597)\n	at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:288)\n	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:415)\n03.06.2010 3:14:13 org.apache.catalina.startup.Catalina start\nINFO: Server startup in 4737 ms\n03.06.2010 3:14:13 org.apache.catalina.core.StandardServer await\nSEVERE: StandardServer.await: create[localhost:8005]: \njava.net.BindException: Address already in use: JVM_Bind\n	at java.net.PlainSocketImpl.socketBind(Native Method)\n	at java.net.PlainSocketImpl.bind(PlainSocketImpl.java:365)\n	at java.net.ServerSocket.bind(ServerSocket.java:319)\n	at java.net.ServerSocket.<init>(ServerSocket.java:185)\n	at org.apache.catalina.core.StandardServer.await(StandardServer.java:359)\n	at org.apache.catalina.startup.Catalina.await(Catalina.java:654)\n	at org.apache.catalina.startup.Catalina.start(Catalina.java:608)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n	at java.lang.reflect.Method.invoke(Method.java:597)\n	at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:288)\n	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:415)\n03.06.2010 3:14:13 org.apache.catalina.startup.Catalina stop\nSEVERE: Catalina.stop\nLifecycleException:  An invalid Lifecycle transition was attempted ([before_stop]) for component [StandardServer[8005]] in state [STARTING]\n	at org.apache.catalina.util.LifecycleBase.invalidTransition(LifecycleBase.java:315)\n	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:204)\n	at org.apache.catalina.startup.Catalina.stop(Catalina.java:641)\n	at org.apache.catalina.startup.Catalina$CatalinaShutdownHook.run(Catalina.java:783)','2010-06-02 19:23:32','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','c0324b1','Mark Emlyn David Thomas','2010-06-06 17:50:11','Make syncs consistent Partial fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=49372 Avoid invalid Lifecycle transitions on failed start due to already bound shutdown port','java/org/apache/catalina/util/LifecycleBase.java'),(1355,49376,'Bug 49376 – Minor corrections to info properties.','The static info properties appear to contain legacy packages.','2010-06-03 07:33:13','Pid','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Cluster','P2 trivial','e119b5b','Mark Emlyn David Thomas','2010-06-06 17:31:20','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49376 Correct package names in info properties','java/org/apache/catalina/ha/authenticator/ClusterSingleSignOn.java\njava/org/apache/catalina/ha/authenticator/ClusterSingleSignOnListener.java\njava/org/apache/catalina/ha/session/ClusterSessionListener.java'),(1356,48843,'Bug 48843 – Tomcat Acceptor Thread goes into wait() and it will never come back','Hi,\n\nI believe I\'ve found a race condition in Tomcat that causes the http port to\nbe non-responsive. It exists in 6.0 and also in 5.5 (although the code has\nbeen refactored).\nI could not find any reference to it in the Bug database or the mailing list\narchives.\n\nConsider a tomcat instance with maxThreads set to 2, i.e. you have 2 tomcat\nthreads to service incoming requests.\nThe sequence of events is as follows:\n1. Thread 1 and Thread 2 are both servicing a request each.\n2. A third request comes in.\n3. In class JIOEndpoint.java, the acceptor thread calls methods\nprocessSocket() which then calls getWorkerThread() which then calls\ncreateWorkerThread().\n4. createWorkerThread() returns null since both threads are busy processing\nthe two requests.\n5. Here is the race condition in method getWorkerThread() in the code shown\nbelow\n\nprotected Worker getWorkerThread(){\n...\nWorker workerThread = createWorkerThread();\n        while (workerThread == null) {\n            try {\n                synchronized (workers) {\n                    workers.wait();\n                 }\n            }\n...\n}\n\nThe acceptor thread executes the \"while(workerThread == null)\" statement and\nis then switched out by the CPU.\nThe two threads executing the two requests complete and go into\nWorker.await() waiting for the next job after executing method\nrecycleWorkerThread().\nThe acceptor thread is switched back into CPU and executes the synchronized\nblock and goes into the wait().\n\nAt this point, there aren\'t any Worker threads out there processing requests\nand therefore there isn\'t any thread to wake up the acceptor thread.\nThe application is non-responsive after this.\n\nA simple solution would be to check if curThreadsBusy > 0 in the\nsynchronized block before going into wait() in method getWorkerThread()\nOR increase the scope of the critical section to include the while loop.\n\nThanks,\nHarshad\n\nStack Traces below:\n\n\"bda19102143\" id=1578 in WAITING on\nlock=org.apache.tomcat.util.net.jioendpoint$wor...@13aa4ee3^m\n    at java.lang.Object.wait(Native Method)^M\n    at java.lang.Object.wait(Object.java:485)^M\n    at\norg.apache.tomcat.util.net.JIoEndpoint$Worker.await(JIoEndpoint.java:416)^M\n    at\norg.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:442)^M\n    at java.lang.Thread.run(Thread.java:619)^M\n\n\"http-8091-Acceptor-0\" id=43 in WAITING on\nlock=org.apache.tomcat.util.net.jioendpoint$workerst...@13bd7b6a^m\n    at java.lang.Object.wait(Native Method)^M\n    at java.lang.Object.wait(Object.java:485)^M\n    at\norg.apache.tomcat.util.net.JIoEndpoint.getWorkerThread(JIoEndpoint.java:700)^M\n    at\norg.apache.tomcat.util.net.JIoEndpoint.processSocket(JIoEndpoint.java:731)^M\n    at\norg.apache.tomcat.util.net.JIoEndpoint$Acceptor.run(JIoEndpoint.java:313)^M\n    at java.lang.Thread.run(Thread.java:619)^M','2010-03-02 17:43:49','Harshad Kamat','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 major','be686be','Konstantin Kolinko','2010-06-02 21:33:08','Prevent possible deadlocks in AprEndpoint.Poller and AprEndpoint.Sendfile, caused by missing Object.notify() wakeup, which is similar to https://issues.apache.org/bugzilla/show_bug.cgi?id=48843','java/org/apache/tomcat/util/net/AprEndpoint.java'),(1357,49099,'Bug 49099 – Using % after context prefix results in 400 but nothing is logged in access log','','2010-04-12 15:48:23','Igor Fedulov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 major','0dab832','Konstantin Kolinko','2010-06-02 18:54:49','Followup to r950587 which was a fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=49099 Fix lookup of the root context: its name is \"\", not \"/\".','java/org/apache/catalina/connector/CoyoteAdapter.java'),(1358,49095,'Bug 49095 – org.apache.tomcat.util.net.AprEndpoint.unlockAccept does not wakeup accepts with deferred accept or BSD filters','','2010-04-12 08:16:23','Ruediger Pluem','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 normal','f735870','Konstantin Kolinko','2010-06-02 13:34:55','Followup to r948043 that was a fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=49095 We should not use PrintWriter(OutputStream), because that implicitly uses the platform default charset. Specify the charset explicitly.','java/org/apache/tomcat/util/net/AprEndpoint.java'),(1359,49178,'Bug 49178 – Running tomcat/6.0.26 with security manager generates ORACLE jdbc error','java.lang.ArrayIndexOutOfBoundsException: -1\n        oracle.jdbc.driver.T4CTTIoauthenticate.setSessionFields(T4CTTIoauthenticate.java:942)\n        oracle.jdbc.driver.T4CTTIoauthenticate.<init>(T4CTTIoauthenticate.java:221)\n        oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:358)\n        oracle.jdbc.driver.PhysicalConnection.<init>(PhysicalConnection.java:508)\n        oracle.jdbc.driver.T4CConnection.<init>(T4CConnection.java:203)\n        oracle.jdbc.driver.T4CDriverExtension.getConnection(T4CDriverExtension.java:33)\n        oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:510)\n        oracle.jdbc.pool.OracleDataSource.getPhysicalConnection(OracleDataSource.java:275)\n        oracle.jdbc.pool.OracleDataSource.getConnection(OracleDataSource.java:206)\n        xxx.yyy.CPC.data.DAOUtil.getConnection(Unknown Source)\n        xxx.yyy.CPC.logging.LogDAO.createLog(Unknown Source)\n        xxx.yyy.CPC.logging.DBLogger.db(Unknown Source)\n        org.apache.jsp.CPC.Default_jsp._jspService(Default_jsp.java:90)\n        org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)\n        javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n        org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:377)\n        org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)\n        org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)\n        javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n        sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        java.lang.reflect.Method.invoke(Method.java:597)\n        org.apache.catalina.security.SecurityUtil$1.run(SecurityUtil.java:269)\n        java.security.AccessController.doPrivileged(Native Method)\n        javax.security.auth.Subject.doAsPrivileged(Subject.java:517)\n        org.apache.catalina.security.SecurityUtil.execute(SecurityUtil.java:301)\n        org.apache.catalina.security.SecurityUtil.doAsPrivilege(SecurityUtil.java:162) \n\n\nWhen  I enabled  -Djava.security.debug=access,failure I see The problem was with oracle jar in file:${catalina.base}\\lib dir was getting called with \\ at the start. The problem was that there was attempt to access \\file:${catalina.base}\\lib\\ojdbc6.jar rather than file:\\${catalina.base}\\lib\\ojdbc6.jar. When I added the AllProperty policy rule for that \\file:${catalina.base}\\lib\\- . this error went away.','2010-04-23 12:54:50','Suresh T','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','d86c217','Mark Emlyn David Thomas','2010-06-02 11:26:30','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49178 Using ${catalina.base}/lib will require an additional permission','conf/catalina.policy'),(1360,49099,'Bug 49099 – Using % after context prefix results in 400 but nothing is logged in access log','','2010-04-12 15:48:23','Igor Fedulov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 major','137f247','Mark Emlyn David Thomas','2010-06-02 11:12:36','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49099 Hooking the CoyoteAdaptor into the existing AccessLog wasn\'t as invasive as I feared so go that route to log requests rejected by the Adaptor before the request/response reaches the AcessLogValve','java/org/apache/catalina/AccessLog.java\njava/org/apache/catalina/connector/CoyoteAdapter.java\njava/org/apache/catalina/valves/AccessLogValve.java\nwebapps/docs/config/valve.xml'),(1361,48971,'Bug 48971 – memory leak protection : stopping TimeThreads should be optional and disabled by default','','2010-03-23 22:56:08','Sylvain Laurent','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','ac8a5ba','Mark Emlyn David Thomas','2010-06-01 12:59:14','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48971 Make stopping of TimerThreads optional and disabled by default','java/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/loader/WebappClassLoader.java\njava/org/apache/catalina/loader/WebappLoader.java\nwebapps/docs/config/context.xml'),(1362,49345,'Bug 49345 – EL does not work correctly with JSF 2.0 composite components','We are using JSF 2.0\'s <f:validateBean> tag with a JSF 2.0 composite component:\n\n<ex:ExampleComposite id=\"example1\" managedBean=\"#{beanValidation}\">\n <f:validateBean for=\"example1:input\"/>\n</ex:ExampleComposite>\n\n#{beanValidation} corresponds to a bean with property \"value\" which is used as the value for the input box \"example1:input\" defined in the composite component.  As this is a custom component, the \"for\" attribute really needs to resolve #{cc.attrs.beanValidation.value}.  In MyFaces, we defer to Tomcat\'s ValueExpressionImpl.getValueReference() method to obtain a ValueReference containing the underlying bean and the correct property name.  However, what we end up with is a ValueReference containing the correct bean and an incorrect property name (\"attrs\" instead of \"value\").  Hence, we end up with an exception when trying to validate.  I\'ve dug around a bit and I can trace the issue back to  AstValue.getValueReference() (or at least, I think this is it):\n\nreturn new ValueReference(t.base, this.jjtGetChild(1).getValue(ctx));\n\nI don\'t think the Tomcat EL code is taking composite components into account here and is simply lopping off the first part of the EL expression no matter what.  For composite components, more than that has to be trimmed off as everything is prefixed with \"cc.attrs\".\n\nNote that this issue has been independently verified by another member of the MyFaces team and it has been confirmed that running MyFaces with Sun\'s EL implementation works, so the problem is not on MyFaces\'s side.','2010-05-26 09:39:52','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 major','0670926','Mark Emlyn David Thomas','2010-05-31 13:30:25','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49345 Second parameter for new ValueReference should be property. There is no guarantee that the property will be the second child node.','java/org/apache/el/parser/AstValue.java'),(1363,49345,'Bug 49345 – EL does not work correctly with JSF 2.0 composite components','We are using JSF 2.0\'s <f:validateBean> tag with a JSF 2.0 composite component:\n\n<ex:ExampleComposite id=\"example1\" managedBean=\"#{beanValidation}\">\n <f:validateBean for=\"example1:input\"/>\n</ex:ExampleComposite>\n\n#{beanValidation} corresponds to a bean with property \"value\" which is used as the value for the input box \"example1:input\" defined in the composite component.  As this is a custom component, the \"for\" attribute really needs to resolve #{cc.attrs.beanValidation.value}.  In MyFaces, we defer to Tomcat\'s ValueExpressionImpl.getValueReference() method to obtain a ValueReference containing the underlying bean and the correct property name.  However, what we end up with is a ValueReference containing the correct bean and an incorrect property name (\"attrs\" instead of \"value\").  Hence, we end up with an exception when trying to validate.  I\'ve dug around a bit and I can trace the issue back to  AstValue.getValueReference() (or at least, I think this is it):\n\nreturn new ValueReference(t.base, this.jjtGetChild(1).getValue(ctx));\n\nI don\'t think the Tomcat EL code is taking composite components into account here and is simply lopping off the first part of the EL expression no matter what.  For composite components, more than that has to be trimmed off as everything is prefixed with \"cc.attrs\".\n\nNote that this issue has been independently verified by another member of the MyFaces team and it has been confirmed that running MyFaces with Sun\'s EL implementation works, so the problem is not on MyFaces\'s side.','2010-05-26 09:39:52','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 major','cb73196','Mark Emlyn David Thomas','2010-05-31 13:29:17','Test case for https://issues.apache.org/bugzilla/show_bug.cgi?id=49345 Fix to follow','test/org/apache/el/TestValueExpressionImpl.java'),(1364,49360,'Bug 49360 – Context class reload fails for PersistentManager','On context class reload tomcat fails with\n\nLifecycleException:  An invalid Lifecycle transition was attempted ([before_start]) for component [org.apache.catalina.session.PersistentManager[/xxx]] in state [DESTROYED]','2010-05-29 17:45:06','Marco','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','ac22dd8','Mark Emlyn David Thomas','2010-05-31 12:57:45','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49360 Managers will be restarted on Context reload','java/org/apache/catalina/ha/session/BackupManager.java\njava/org/apache/catalina/ha/session/DeltaManager.java\njava/org/apache/catalina/session/PersistentManagerBase.java'),(1365,49340,'Bug 49340 – Webapp unavailable after deploy then stop then start','Occurs with tomcat 7.0 RC3 but not with 6.0.26\n\nUsing the manager/html :\n\n- deploy a war\n- test one of its page, it should be deployed properly\n- stop the webapp\n- start the webapp\n- test one of its page : FAILURE : tomcat returns a 404.\n\nNotes :\n- if using \"reload\" instead of stop/start it\'s OK, but it does not fix the unavailability\n- if the webapp is present when tomcat is started, then the stop/start works normally\n- The work around is to undeploy the webapp and redeploy it.','2010-05-25 17:45:19','Sylvain Laurent','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','0f669e3','Mark Emlyn David Thomas','2010-05-28 16:08:02','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49340 Simplify the mapper listener registration/de-registration process','java/org/apache/catalina/connector/MapperListener.java'),(1366,49196,'Bug 49196 – NPE in PageContext.getErrorData()','This bug is present in some older versions also, but I haven\'t had time until now to file the report. Here it is:\n\nI\'ve got\n\n  <error-page>\n    <error-code>403</error-code>\n    <location>/free/login/denied.jsp</location>\n  </error-page>\n\nin web.xml and call pageContext.getErrorData() in denied.jsp.\n\nTHIS WORKS FINE!\n\nWhat does not work is if the user is HTTP-redirected to denied.jsp or simply calls it by entering the URL in his browser. In this case the JSP throws\n\njava.lang.NullPointerException\n        at javax.servlet.jsp.PageContext.getErrorData(PageContext.java:515)\n        at org.apache.jsp.free.login.denied_jsp._jspService(denied_jsp.java:389)\n        at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n        at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:377)\n        at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)\n        at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at com.folgmann.filters.AuthFilter.doFilter(AuthFilter.java:446)\n        at com.folgmann.filters.HttpFilterSupport.doFilter(HttpFilterSupport.java:41)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at com.folgmann.filters.ValidatingThreadPoolFilter.doFilter(ValidatingThreadPoolFilter.java:138)\n        at com.folgmann.filters.HttpFilterSupport.doFilter(HttpFilterSupport.java:41)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at com.folgmann.filters.CharsetFilter.doFilter(CharsetFilter.java:114)\n        at com.folgmann.filters.HttpFilterSupport.doFilter(HttpFilterSupport.java:41)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)\n        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)\n        at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:465)\n        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)\n        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)\n        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:298)\n        at org.apache.jk.server.JkCoyoteHandler.invoke(JkCoyoteHandler.java:190)\n        at org.apache.jk.common.HandlerRequest.invoke(HandlerRequest.java:291)\n        at org.apache.jk.common.ChannelSocket.invoke(ChannelSocket.java:769)\n        at org.apache.jk.common.ChannelSocket.processConnection(ChannelSocket.java:698)\n        at org.apache.jk.common.ChannelSocket$SocketConnection.runIt(ChannelSocket.java:891)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:690)\n        at java.lang.Thread.run(Thread.java:619)\n\nI\'m sure that this wasn\'t intended by the JSP spec. I suggest that pageContext.getErrorData() returns null instead when an error page is not called like an error page should be called.\n\nTnx,\n     boris','2010-04-27 10:37:16','Boris Folgmann','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','788126b','Mark Emlyn David Thomas','2010-05-25 10:20:58','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49196 Avoid NPE on PageContext.getErrorData()','java/javax/servlet/jsp/PageContext.java'),(1367,49196,'Bug 49196 – NPE in PageContext.getErrorData()','This bug is present in some older versions also, but I haven\'t had time until now to file the report. Here it is:\n\nI\'ve got\n\n  <error-page>\n    <error-code>403</error-code>\n    <location>/free/login/denied.jsp</location>\n  </error-page>\n\nin web.xml and call pageContext.getErrorData() in denied.jsp.\n\nTHIS WORKS FINE!\n\nWhat does not work is if the user is HTTP-redirected to denied.jsp or simply calls it by entering the URL in his browser. In this case the JSP throws\n\njava.lang.NullPointerException\n        at javax.servlet.jsp.PageContext.getErrorData(PageContext.java:515)\n        at org.apache.jsp.free.login.denied_jsp._jspService(denied_jsp.java:389)\n        at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n        at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:377)\n        at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)\n        at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at com.folgmann.filters.AuthFilter.doFilter(AuthFilter.java:446)\n        at com.folgmann.filters.HttpFilterSupport.doFilter(HttpFilterSupport.java:41)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at com.folgmann.filters.ValidatingThreadPoolFilter.doFilter(ValidatingThreadPoolFilter.java:138)\n        at com.folgmann.filters.HttpFilterSupport.doFilter(HttpFilterSupport.java:41)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at com.folgmann.filters.CharsetFilter.doFilter(CharsetFilter.java:114)\n        at com.folgmann.filters.HttpFilterSupport.doFilter(HttpFilterSupport.java:41)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)\n        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)\n        at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:465)\n        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)\n        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)\n        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:298)\n        at org.apache.jk.server.JkCoyoteHandler.invoke(JkCoyoteHandler.java:190)\n        at org.apache.jk.common.HandlerRequest.invoke(HandlerRequest.java:291)\n        at org.apache.jk.common.ChannelSocket.invoke(ChannelSocket.java:769)\n        at org.apache.jk.common.ChannelSocket.processConnection(ChannelSocket.java:698)\n        at org.apache.jk.common.ChannelSocket$SocketConnection.runIt(ChannelSocket.java:891)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:690)\n        at java.lang.Thread.run(Thread.java:619)\n\nI\'m sure that this wasn\'t intended by the JSP spec. I suggest that pageContext.getErrorData() returns null instead when an error page is not called like an error page should be called.\n\nTnx,\n     boris','2010-04-27 10:37:16','Boris Folgmann','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','88adbcb','Mark Emlyn David Thomas','2010-05-25 10:20:16','Add a test case for https://issues.apache.org/bugzilla/show_bug.cgi?id=49196 Patch to follow shortly','test/javax/servlet/jsp/TestPageContext.java\ntest/webapp-3.0/bug49196.jsp'),(1368,49095,'Bug 49095 – org.apache.tomcat.util.net.AprEndpoint.unlockAccept does not wakeup accepts with deferred accept or BSD filters','','2010-04-12 08:16:23','Ruediger Pluem','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 normal','d5c073f','Mark Emlyn David Thomas','2010-05-25 09:53:14','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49095 AprEndpoint does not wakeup accepts with deferred accept or BSD filters Based on a patch provided by Ruediger Pluem','java/org/apache/tomcat/util/net/AprEndpoint.java'),(1369,48976,'Bug 48976 – Document JAVA_ENDORSED_DIRS in the header of catalina.{sh,bat}','','2010-03-24 14:14:38','Laurent Vaills','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P2 trivial','06cda08','Mark Emlyn David Thomas','2010-05-24 10:28:20','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48976 Document JAVA_ENDORSED_DIRS','bin/catalina.bat\nbin/catalina.sh'),(1370,48840,'Bug 48840 – catalina.sh fails to set CATALINA_HOME on newer bash versions','','2010-03-02 10:33:37','mdietze','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 major','304aeaa','Konstantin Kolinko','2010-05-20 12:19:49','Additional fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=48840 Port the fix from catalina.sh to tool-wrapper.sh as well.','bin/tool-wrapper.sh'),(1371,49299,'Bug 49299 – Servlet 3.0 ch.7.1.1 says that custom cookie name affects URL rewriting','','2010-05-15 17:38:08','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','9369636','Mark Emlyn David Thomas','2010-05-16 17:47:26','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49299 Implement the requirements of section 7.1.1 of the Servlet 3.0 spec that require the path parameter to change name as well. Remove the option to set the default via a system property for the sake of simplicity.','java/org/apache/catalina/Globals.java\njava/org/apache/catalina/connector/CoyoteAdapter.java\njava/org/apache/catalina/connector/LocalStrings.properties\njava/org/apache/catalina/connector/Request.java\njava/org/apache/catalina/connector/Response.java\njava/org/apache/catalina/core/ApplicationSessionCookieConfig.java\njava/org/apache/catalina/realm/RealmBase.java\ntest/org/apache/catalina/connector/TestCoyoteAdaptor.java\nwebapps/docs/config/systemprops.xml'),(1372,49290,'Bug 49290 – Using a JarScanner with scanAllDirectories=true causes Tomcat 7 not to start','','2010-05-14 10:26:11','Larry Isaacs','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','a7b96d0','Mark Emlyn David Thomas','2010-05-15 18:52:18','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49290 Allow Tomcat to start when using a JarScanner with scanAllDirectories=true Patch by Larry Issacs (with minor tweaks)','java/org/apache/catalina/startup/ContextConfig.java'),(1373,49218,'Bug 49218 – Fix support for META-INF/resources','','2010-04-29 07:21:16','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','8a486f7','Mark Emlyn David Thomas','2010-05-12 07:10:03','Fix remaining issue described in https://issues.apache.org/bugzilla/show_bug.cgi?id=49218 doLookup should return null if the resource cannot be found and should not throw an exception Fixes a potential infinite loop in VirtualDirContext','java/org/apache/naming/resources/BaseDirContext.java\njava/org/apache/naming/resources/FileDirContext.java\njava/org/apache/naming/resources/LocalStrings.properties\njava/org/apache/naming/resources/VirtualDirContext.java\njava/org/apache/naming/resources/WARDirContext.java'),(1374,49221,'Bug 49221 – javax.servlet.http.Cookie.setDomain uses default charset','javax.servlet.http.Cookie.setDomain(String pattern)\nhas the following code:\n\ndomain = pattern.toLowerCase();\n\nThe result of this depends on the default Locale; it would be safer to use a fixed locale, e.g. Local.ENGLISH.','2010-04-29 09:40:27','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 normal','05810ee','Mark Emlyn David Thomas','2010-05-12 06:31:04','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49221 Ensure case conversion behaves as expected Patch provided by sebb','java/javax/servlet/http/Cookie.java'),(1375,49224,'Bug 49224 – NullPointerException in PooledConnection when username or password are null','I\'m using jdbc-pool (version 1.0.8.5) to connect to a DataSource requiring no authentication.  Unless I explicitly set the username and password in the PoolProperties object to empty String (as opposed to leaving them null), a NullPointerException is thrown on lines 215 or 216 of PooledConnection.connectUsingDriver().','2010-04-29 11:15:49','Matt Passell','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','4fff6c0','Mark Emlyn David Thomas','2010-05-12 06:29:06','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49224 Only try setting the username and password if they are non-null Patch provided by Matt Passell','modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/PooledConnection.java'),(1376,49181,'Bug 49181 – Exception thrown incorrectly when dynamically adding a Listener','ApplicationContext.addListener(instance) always throws an exception if the listener is a ServletContextListener or an HttpSessionListener because successful instanceof checks don\'t finish with a return.','2010-04-24 19:14:59','Pid','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','552ffdd','Mark Emlyn David Thomas','2010-05-12 06:24:00','Fix remainder of https://issues.apache.org/bugzilla/show_bug.cgi?id=49181 Add additional check to prevent adding Servlet context listeners once the calls to the Servlet Context listeners start','java/org/apache/catalina/core/ApplicationContext.java\njava/org/apache/catalina/core/StandardContext.java'),(1377,49226,'Bug 49226 – toLowerCase()/toUpperCase() may not work OK in all Locales','','2010-04-29 11:29:18','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','5ad9ecd','Mark Emlyn David Thomas','2010-05-11 16:05:15','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49226 Ensure case conversion behaves as expected Patch provided by sebb','java/org/apache/catalina/core/ApplicationPart.java\njava/org/apache/catalina/core/StandardEngine.java\njava/org/apache/catalina/core/StandardHost.java\njava/org/apache/catalina/deploy/FilterMap.java\njava/org/apache/catalina/manager/HTMLManagerServlet.java\njava/org/apache/catalina/manager/util/SessionUtils.java\njava/org/apache/catalina/servlets/CGIServlet.java\njava/org/apache/catalina/servlets/WebdavServlet.java\njava/org/apache/catalina/ssi/ResponseIncludeWrapper.java\njava/org/apache/catalina/ssi/SSIMediator.java\njava/org/apache/catalina/ssi/SSIProcessor.java\njava/org/apache/catalina/ssi/SSIServlet.java\njava/org/apache/catalina/ssi/SSIServletExternalResolver.java\njava/org/apache/catalina/startup/ClassLoaderFactory.java\njava/org/apache/catalina/startup/ContextConfig.java\njava/org/apache/catalina/startup/HostConfig.java\njava/org/apache/catalina/util/ExtensionValidator.java\njava/org/apache/catalina/util/MIME2Java.java\njava/org/apache/tomcat/util/buf/MessageBytes.java\njava/org/apache/tomcat/util/http/AcceptLanguage.java\njava/org/apache/tomcat/util/http/fileupload/FileItemHeadersImpl.java\njava/org/apache/tomcat/util/http/fileupload/FileUploadBase.java\njava/org/apache/tomcat/util/http/fileupload/ParameterParser.java\njava/org/apache/tomcat/util/http/fileupload/ServletFileUpload.java\njava/org/apache/tomcat/util/modeler/OperationInfo.java\njava/org/apache/tomcat/util/net/URL.java\njava/org/apache/tomcat/util/net/jsse/JSSESocketFactory.java\nwebapps/examples/WEB-INF/classes/examples/ShowSource.java\nwebapps/examples/WEB-INF/classes/jsp2/examples/el/Functions.java'),(1378,49227,'Bug 49227 – toLowerCase()/toUpperCase() may not work OK in all Locales','','2010-04-29 11:30:31','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 normal','09abffb','Mark Emlyn David Thomas','2010-05-11 15:51:45','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49227 Ensure case conversion behaves as expected Patch provided by sebb','java/org/apache/coyote/http11/Http11AprProcessor.java\njava/org/apache/coyote/http11/Http11NioProcessor.java\njava/org/apache/coyote/http11/Http11Processor.java'),(1379,49228,'Bug 49228 – toLowerCase()/toUpperCase() may not work OK in all Locales','','2010-04-29 11:31:40','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','a954806','Mark Emlyn David Thomas','2010-05-11 11:53:10','https://issues.apache.org/bugzilla/show_bug.cgi?id=49228 Use English Locale since other Locale\'s may give add results','java/org/apache/jasper/compiler/Validator.java\njava/org/apache/jasper/tagplugins/jstl/Util.java'),(1380,49235,'Bug 49235 – ServletContainerInitializer onStartup(Set<Class<?>> classSet is not expect class','','2010-04-30 03:08:29','dl','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','4a581aa','Mark Emlyn David Thomas','2010-05-11 11:48:36','https://issues.apache.org/bugzilla/show_bug.cgi?id=49235 Fix handlesTypes with annotations. The annotated class should be reported, not the annotation class.','java/org/apache/catalina/startup/ContextConfig.java'),(1381,49240,'Bug 49240 – Error thrown during detection of ServletContainerInitializer\'s','ContextConfig.checkHandlesTypes() throws a NoClassDefFoundError, which isn\'t caught, when the class being analysed is initialised if the class, or a class that it references(?), is not present in the classpath.\n\nE.g. When a mysql connector/j jar (v5.x) is scanned, an attempt to load the following class occurs: com.mchange.v2.c3p0.QueryConnectionTester\n\njava.lang.NoClassDefFoundError: com/mchange/v2/c3p0/QueryConnectionTester\n	at java.lang.ClassLoader.defineClass1(Native Method)\n	at java.lang.ClassLoader.defineClass(ClassLoader.java:698)\n	at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:124)\n	at java.net.URLClassLoader.defineClass(URLClassLoader.java:260)\n	at java.net.URLClassLoader.access$000(URLClassLoader.java:56)\n	at java.net.URLClassLoader$1.run(URLClassLoader.java:195)\n	at java.security.AccessController.doPrivileged(Native Method)\n	at java.net.URLClassLoader.findClass(URLClassLoader.java:188)\n	at java.lang.ClassLoader.loadClass(ClassLoader.java:315)\n	at java.lang.ClassLoader.loadClass(ClassLoader.java:250)\n	at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:398)\n	at java.lang.Class.forName0(Native Method)\n	at java.lang.Class.forName(Class.java:247)\n\nAlso Class.forName is used here, referencing the WebappClassLoader, instead of calling WebappClassLoader.loadClass() directly.','2010-05-01 07:46:16','Pid','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','f24ed2d','Mark Emlyn David Thomas','2010-05-11 05:46:42','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49240 If a class can\'t be loaded, don\'t scan HandlesTypes for it Also handle NoClassDefFoundError Patch provided by pid','java/org/apache/catalina/startup/ContextConfig.java'),(1382,49269,'Bug 49269 – Shouldn\'t see maxIdle > maxActive message with default props','In PoolProperties, the default value for maxIdle is Integer.MAX_VALUE and the default for maxActive is 100.  This results in a warning message being logged and the value for maxIdle set to match maxActive on lines 393/394 of ConnectionPool.  The default for maxIdle should match that of maxActive.','2010-05-10 14:32:07','Matt Passell','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','27a3909','Mark Emlyn David Thomas','2010-05-11 04:01:52','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49269 Set maxIdle to maxActive by default to prevent warning on start when maxIdle > maxActive Patch provided by Matt Passell','modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/PoolProperties.java'),(1383,49134,'Bug 49134 – Server.stop() doesn\'t unregister all MBeans','','2010-04-16 05:32:43','Marc Guillemot','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','4a2830c','Mark Emlyn David Thomas','2010-05-03 17:40:52','With the benefit of some sleep, refactor the MBean support for Lifecycle (still some components to convert) Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49134 Thanks to Marc Guillemot whose test case for 49134 provided the basis of o.a.c.mbeans.TestRegistration','java/org/apache/catalina/LifecycleMBeanRegistration.java\njava/org/apache/catalina/connector/Connector.java\njava/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/core/StandardServer.java\njava/org/apache/catalina/core/StandardService.java\njava/org/apache/catalina/core/StandardThreadExecutor.java\njava/org/apache/catalina/loader/WebappLoader.java\njava/org/apache/catalina/mbeans/MBeanFactory.java\njava/org/apache/catalina/mbeans/MBeanUtils.java\njava/org/apache/catalina/startup/Tomcat.java\njava/org/apache/catalina/util/LifecycleBase.java\njava/org/apache/catalina/util/LifecycleMBeanBase.java\njava/org/apache/catalina/util/LocalStrings.properties\njava/org/apache/coyote/http11/Http11Protocol.java\ntest/org/apache/catalina/mbeans/RegistrationTest.java\ntest/org/apache/catalina/mbeans/TestRegistration.java\ntest/org/apache/catalina/startup/TomcatBaseTest.java'),(1435,49014,'Bug 49014 – Add RemoteIpFilter test case','','2010-03-29 00:17:51','Cyrille Le Clerc','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','d9330a9','Mark Emlyn David Thomas','2010-04-04 06:37:17','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49014 Add test cases for the RemoteIpFilter Patch provided by Cyrille Le Clerc','test/org/apache/catalina/filters/TestRemoteIpFilter.java'),(1385,49241,'Bug 49241 – DataSourceFactory.parsePoolProperties() doesn\'t look for \"suspectTimeout\"','If you call the DataSourceFactory.parsePoolProperties() method, passing in a Properties object with the \"suspectTimeout\" property set, that key/value pair is never passed on to the PoolProperties.setSuspectTimeout() method.','2010-05-01 21:01:46','Matt Passell','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','b75b021','Filip Hanik','2010-05-03 15:12:48','https://issues.apache.org/bugzilla/show_bug.cgi?id=49241','modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/DataSourceFactory.java'),(1386,49092,'Bug 49092 – util.IntrospectionUtils.PATH_SEPARATOR should be final','The field\n\norg.apache.tomcat.util.IntrospectionUtils.PATH_SEPARATOR\n\nshould be final.','2010-04-11 22:37:12','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','616bd68','Mark Emlyn David Thomas','2010-05-01 11:20:31','Another fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=49092 Make constant final','test/org/apache/catalina/tribes/demos/IntrospectionUtils.java'),(1387,49236,'Bug 49236 – JAR indexing does not have any benefits and can cause some harm','','2010-04-30 05:49:29','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Unknown','P2 normal','f13a1c0','Konstantin Kolinko','2010-04-30 05:56:35','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49236 Do not use indexing when packing Tomcat JARs.','build.xml'),(1388,49218,'Bug 49218 – Fix support for META-INF/resources','','2010-04-29 07:21:16','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','3c51db7','Konstantin Kolinko','2010-04-30 00:00:01','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49218 The test runs successfully if JreMemoryLeakPreventionListener is present.','test/org/apache/catalina/core/TestStandardContextResources.java'),(1389,49218,'Bug 49218 – Fix support for META-INF/resources','','2010-04-29 07:21:16','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','b7c336a','Konstantin Kolinko','2010-04-29 23:49:40','Log unexpected runtima and IO errors in ApplicationContext#getResource() and ApplicationContext#getResourceAsStream(). This is inspired by BZ 49218.','java/org/apache/catalina/core/ApplicationContext.java\njava/org/apache/catalina/core/LocalStrings.properties'),(1390,49207,'Bug 49207 – Filter name not set when dynamically added','When dynamically adding a Filter the name is not set when calling the method \"addMappingForUrlPatterns\" in ApplicationFilterRegistration.java.\n\njava.lang.IllegalArgumentException: Filter mapping specifies an unknown\nfilter name null\n	at\norg.apache.catalina.core.StandardContext.validateFilterMap(StandardContext.java:2650)\n	at\norg.apache.catalina.core.StandardContext.addFilterMapBefore(StandardContext.java:2622)\n	at\norg.apache.catalina.core.ApplicationFilterRegistration.addMappingForUrlPatterns(ApplicationFilterRegistration.java:102)\n	at\norg.pidster.tomcat.test7.dyn.TestDynamicsListener.contextInitialized(TestDynamicsListener.java:105)','2010-04-28 05:40:52','Pid','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','3396917','Konstantin Kolinko','2010-04-28 12:21:32','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49207 FilterMap#filterName was null when it was configured dynamically with addMappingForUrlPatterns() Patch provided by Pid','java/org/apache/catalina/core/ApplicationFilterRegistration.java'),(1391,49073,'Bug 49073 – Ability to disable shutdown port not documented','','2010-04-08 14:59:09','Paschal Nee','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P2 normal','059ad7e','Mark Emlyn David Thomas','2010-04-27 08:50:38','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49073','webapps/docs/config/server.xml'),(1392,49184,'Bug 49184 – Index out of bounds exception thrown when dynamically adding Filter','When dynamically adding a filter to a context an exception is thrown.\n\njava.lang.ArrayIndexOutOfBoundsException\n	at java.lang.System.arraycopy(Native Method)\n	at org.apache.catalina.core.StandardContext.addFilterMapBefore(StandardContext.java:2629)\n	at org.apache.catalina.core.ApplicationFilterRegistration.addMappingForServletNames(ApplicationFilterRegistration.java:75)','2010-04-25 08:54:34','Pid','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','3f4a241','Mark Emlyn David Thomas','2010-04-26 05:17:46','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49184 Prevent ArrayIndexOutOfBoundsException Patch provided by Pid','java/org/apache/catalina/core/StandardContext.java'),(1393,48689,'Bug 48689 – Jar abstraction for Jasper','Jasper can load TLD files through the ServletContext or from a Jar file. To load TLDs from Jar file, an URL to a Jar file must be passed. However, in some environments (e.g. in OSGi) it might not be easy to provide an URL to a jar file. It would be nice to abstract the way Jasper is looking up the embedded TLDs so that different ways of looking up TLDs within Jar files or Bundles or whatever could be used.','2010-02-05 12:30:40','Jarek Gawor','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 enhancement','efd418b','Mark Emlyn David Thomas','2010-04-25 08:56:32','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48689 Access TLD files through a new JarResource interface to make extending Jasper simpler, particularly in OSGi environments. Patch provided by Jarek Gawor.','java/org/apache/jasper/JspCompilationContext.java\njava/org/apache/jasper/compiler/ImplicitTagLibraryInfo.java\njava/org/apache/jasper/compiler/JarResource.java\njava/org/apache/jasper/compiler/JarURLResource.java\njava/org/apache/jasper/compiler/JspDocumentParser.java\njava/org/apache/jasper/compiler/Parser.java\njava/org/apache/jasper/compiler/ParserController.java\njava/org/apache/jasper/compiler/TagFileProcessor.java\njava/org/apache/jasper/compiler/TagLibraryInfoImpl.java\njava/org/apache/jasper/compiler/TldLocation.java\njava/org/apache/jasper/compiler/TldLocationsCache.java\njava/org/apache/jasper/servlet/JspServletWrapper.java\nwebapps/docs/changelog.xml'),(1394,48358,'Bug 48358 – JSP-unloading reloaded','','2009-12-09 06:58:37','Isabel Drost','Tomcat Developers Mailing List','REOPENED','Tomcat 6','Jasper','P2 enhancement','8bbab22','Mark Emlyn David Thomas','2010-04-25 08:19:19','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48358 Add the ability to limit the number of JSPs loaded at any one time.','conf/web.xml\njava/org/apache/jasper/EmbeddedServletOptions.java\njava/org/apache/jasper/JspC.java\njava/org/apache/jasper/Options.java\njava/org/apache/jasper/compiler/JspRuntimeContext.java\njava/org/apache/jasper/resources/LocalStrings.properties\njava/org/apache/jasper/servlet/JspServlet.java\njava/org/apache/jasper/servlet/JspServletWrapper.java\njava/org/apache/jasper/util/Entry.java\njava/org/apache/jasper/util/JspQueue.java\nwebapps/docs/changelog.xml\nwebapps/docs/jasper-howto.xml'),(1395,49181,'Bug 49181 – Exception thrown incorrectly when dynamically adding a Listener','ApplicationContext.addListener(instance) always throws an exception if the listener is a ServletContextListener or an HttpSessionListener because successful instanceof checks don\'t finish with a return.','2010-04-24 19:14:59','Pid','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','71deb95','Mark Emlyn David Thomas','2010-04-24 19:26:20','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49181 Patch provided by Pid','java/org/apache/catalina/core/ApplicationContext.java'),(1396,48222,'Bug 48222 – Source JARs empty in maven central','$ jar -tvf ~/.m2/repository/org/apache/tomcat/tomcat-servlet-api/7.0.0-SNAPSHOT/tomcat-servlet-api-7.0.0-SNAPSHOT-sources.jar \n     0 Wed Sep 16 18:05:10 BST 2009 META-INF/\n    71 Wed Sep 16 18:05:10 BST 2009 META-INF/MANIFEST.MF','2009-11-18 02:31:31','Dave Syer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Packaging','P2 enhancement','7af2fbd','Mark Emlyn David Thomas','2010-04-24 19:11:50','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48222 Provide src JARs for Maven','res/maven/TODO-currently-empty-src.jar\nres/maven/mvn-pub.xml\nres/maven/mvn.properties.default\nres/maven/tomcat-jasper-jdt.pom\nres/maven/tomcat-jasper.pom'),(1397,48644,'Bug 48644 – Code should never ignore throwable','There seem to be quite a few places where code catches Throwable and ignores it.\n\nFor example:\n\nant.jmx.JMXAccessorQueryTask.bindAttributes\nant.jmx.JMXAccessorTask.execute\ncore.StandardContext - lots of methods\n\nIn most cases, catching Exception would be enough.','2010-01-30 17:20:32','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','1be8bf5','Mark Emlyn David Thomas','2010-04-24 15:26:17','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48644 Don\'t silently swallow Throwables that need to be re-thrown Patch provided by Charlotte H (with a few tweaks) Patch developed during the London GDC OS Jumpstart 2010','java/org/apache/catalina/ant/AbstractCatalinaTask.java\njava/org/apache/catalina/core/AprLifecycleListener.java\njava/org/apache/catalina/core/StandardPipeline.java\njava/org/apache/catalina/core/StandardWrapper.java\njava/org/apache/catalina/ha/session/DeltaManager.java\njava/org/apache/catalina/manager/ManagerServlet.java\njava/org/apache/catalina/manager/StatusTransformer.java\njava/org/apache/catalina/manager/host/HostManagerServlet.java\njava/org/apache/catalina/mbeans/MBeanUtils.java\njava/org/apache/catalina/realm/JDBCRealm.java\njava/org/apache/catalina/session/JDBCStore.java\njava/org/apache/catalina/session/ManagerBase.java\njava/org/apache/catalina/session/StandardManager.java\njava/org/apache/catalina/ssi/ResponseIncludeWrapper.java\njava/org/apache/catalina/startup/CatalinaProperties.java\njava/org/apache/catalina/startup/ContextConfig.java\njava/org/apache/catalina/startup/ExpandWar.java\njava/org/apache/catalina/startup/HostConfig.java\njava/org/apache/catalina/startup/TldConfig.java\njava/org/apache/catalina/users/MemoryUserDatabase.java\njava/org/apache/catalina/util/ExtensionValidator.java\njava/org/apache/catalina/valves/ErrorReportValve.java\njava/org/apache/catalina/valves/JDBCAccessLogValve.java\njava/org/apache/jasper/compiler/TldLocationsCache.java\njava/org/apache/jasper/servlet/JspCServletContext.java\njava/org/apache/jasper/util/ExceptionUtils.java\njava/org/apache/tomcat/util/ExceptionUtils.java'),(1398,49132,'Bug 49132 – JNDI not working','Simple web-app test to lookup the environment context is throwing an exception - below code is taken from tomcat 6/7 docs - 2nd line throws a NameNotFound Exception \'comp\' not found.\n\n// Obtain our environment naming context\nContext initCtx = new InitialContext();\nContext envCtx = (Context) initCtx.lookup(\"java:comp/env\");','2010-04-16 01:52:57','Alvin','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 blocker','45ecf59','Mark Emlyn David Thomas','2010-04-23 18:20:33','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49132 Need to start JNDI before listeners are called','java/org/apache/catalina/core/NamingContextListener.java'),(1399,49132,'Bug 49132 – JNDI not working','Simple web-app test to lookup the environment context is throwing an exception - below code is taken from tomcat 6/7 docs - 2nd line throws a NameNotFound Exception \'comp\' not found.\n\n// Obtain our environment naming context\nContext initCtx = new InitialContext();\nContext envCtx = (Context) initCtx.lookup(\"java:comp/env\");','2010-04-16 01:52:57','Alvin','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 blocker','f1c2d52','Mark Emlyn David Thomas','2010-04-23 18:19:12','Add test case for bug 49132. Check JNDI is available when ServletContextListeners start','test/org/apache/catalina/core/TestNamingContextListener.java'),(1400,49140,'Bug 49140 – Inefficient use of keySet() iterator in StandardContext.java','','2010-04-16 21:14:48','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','b30fc95','Mark Emlyn David Thomas','2010-04-23 11:03:28','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49140 Use appropriate iterators and for-each where possible','java/org/apache/catalina/connector/Request.java\njava/org/apache/catalina/core/ApplicationHttpRequest.java\njava/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/ha/authenticator/ClusterSingleSignOnListener.java\njava/org/apache/catalina/ha/session/ClusterSessionListener.java\njava/org/apache/catalina/startup/ContextConfig.java'),(1401,49143,'Bug 49143 – Possible incorrect lazy initialisations','Incorrect lazy initialization of static field:\n\norg.apache.catalina.realm.RealmBase.md5Helper\norg.apache.catalina.session.StandardSession.sessionContext\norg.apache.catalina.startup.TldConfig.noTldJars\norg.apache.catalina.util.ExtensionValidator.containerAvailableExtensions\norg.apache.tomcat.util.modeler.modules.MbeansDescriptorsDigesterSource.digester\n\nfields should probably all be made volatile','2010-04-16 21:44:52','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','a6092d7','Mark Emlyn David Thomas','2010-04-23 10:23:45','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49143 Threading / initialisation issues. Not all were valid. Make them volatile anyway so FindBugs doesn\'t complain. Fix some additional issues - use of valueOf() - found along the way','java/org/apache/catalina/realm/RealmBase.java\njava/org/apache/catalina/session/StandardSession.java\njava/org/apache/catalina/startup/TldConfig.java\njava/org/apache/catalina/util/ExtensionValidator.java\njava/org/apache/tomcat/util/modeler/modules/MbeansDescriptorsDigesterSource.java'),(1402,49144,'Bug 49144 – Incorrect lazy initialization and update of static fields?','Incorrect lazy initialization and update of static fields:\n\norg.apache.catalina.startup.Bootstrap.daemon\norg.apache.catalina.startup.ContextConfig.contextDigester\n\nFindbugs says:\n\nThis method contains an unsynchronized lazy initialization of a static field. After the field is set, the object stored into that location is further updated or accessed. The setting of the field is visible to other threads as soon as it is set. If the futher accesses in the method that set the field serve to initialize the object, then you have a very serious multithreading bug, unless something else prevents any other thread from accessing the stored object until it is fully initialized. \n\nEven if you feel confident that the method is never called by multiple threads, it might be better to not set the static field until the value you are setting it to is fully populated/initialized.','2010-04-16 21:47:20','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','fd7ed83','Mark Emlyn David Thomas','2010-04-23 09:59:54','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49144 Not an issue but stop FindBugs complaining Also fix one other FindBugs report for this class.','java/org/apache/catalina/startup/Bootstrap.java'),(1403,49164,'Bug 49164 – junit test ignores failures in threads','','2010-04-21 14:08:24','Felix Schumacher','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Cluster','P2 minor','aa758d8','Mark Emlyn David Thomas','2010-04-23 09:48:16','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49164 Improve unit tests by propagating failures from spawned threads to main thread. Patch provided by Felix Schumacher.','test/org/apache/catalina/tribes/test/interceptors/TestOrderInterceptor.java'),(1404,49171,'Bug 49171 – Avoid raw type warning in TagSupport','','2010-04-22 07:10:06','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 enhancement','8bd4d7a','Mark Emlyn David Thomas','2010-04-23 09:43:27','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49171 Fix IDE warning Patch provided by sebb','java/javax/servlet/jsp/tagext/TagSupport.java'),(1405,49170,'Bug 49170 – Transmission of duplicated session in DeltaManager#handleGET_ALL_SESSIONS.','','2010-04-22 06:54:01','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Cluster','P2 normal','f61100d','Keiichi Fujino','2010-04-22 06:57:55','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49170','java/org/apache/catalina/ha/session/DeltaManager.java'),(1406,43642,'Bug 43642 – Add prestartminSpareThreads attribute for Executor','The attached patch adds the boolean attribute prestartminSpareThreads to the\nExecutor element. This allows the admin to prestart minspareThreads for this\nExecutor during the start of Tomcat. The default value is false which is the old\nbehaviour. A documentation patch for executor.xml can be created if there is\ninterest in committing this patch.','2007-10-17 08:00:46','Ruediger Pluem','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 enhancement','e7fb8fa','Jean-Frederic Clere','2010-04-21 08:55:19','Fix for 43642.','java/org/apache/catalina/core/StandardThreadExecutor.java\nwebapps/docs/changelog.xml\nwebapps/docs/config/executor.xml'),(1407,49141,'Bug 49141 – Impossible cast in naming.factory.SendMailFactory.getObjectInstance','naming.factory.SendMailFactory.getObjectInstance contains an impossible cast from javax.mail.internet.MimeMessage to javax.mail.internet.MimePart\n\n[Findbugs]','2010-04-16 21:21:03','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','7205c74','Mark Emlyn David Thomas','2010-04-20 15:49:10','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49141 Stop Findbugs complaining','java/javax/mail/internet/MimeMessage.java'),(1408,49158,'Bug 49158 – More than one JSESSIONID cookie headers set','The following JSP\n\n<%\n  session.invalidate();\n  session = request.getSession();\n  session.invalidate();\n  session = request.getSession();\n%>\nDone!\n\n\nGenerates this response from Apache Tomcat\nHTTP/1.x 200 OK\n\nServer: Apache-Coyote/1.1\n\nSet-Cookie: JSESSIONID=8C65C3AB20B8BBD157866668B67983B1; Path=\"\"; HttpOnly\n\nSet-Cookie: JSESSIONID=498BD2E8B22C5121143B7305A0ECB249; Path=\"\"; HttpOnly\n\nSet-Cookie: JSESSIONID=49F58AE7833522293F8EAD2AB2D13F19; Path=\"\"; HttpOnly\n\nContent-Type: text/html;charset=ISO-8859-1\n\nContent-Length: 7\n\nDate: Tue, 20 Apr 2010 15:38:47 GMT','2010-04-20 11:40:39','Filip Hanik','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 major','91593f5','Filip Hanik','2010-04-20 13:13:37','https://issues.apache.org/bugzilla/show_bug.cgi?id=49158 Session cookies should only set one header','java/org/apache/catalina/connector/Request.java\njava/org/apache/catalina/connector/Response.java'),(1409,49158,'Bug 49158 – More than one JSESSIONID cookie headers set','The following JSP\n\n<%\n  session.invalidate();\n  session = request.getSession();\n  session.invalidate();\n  session = request.getSession();\n%>\nDone!\n\n\nGenerates this response from Apache Tomcat\nHTTP/1.x 200 OK\n\nServer: Apache-Coyote/1.1\n\nSet-Cookie: JSESSIONID=8C65C3AB20B8BBD157866668B67983B1; Path=\"\"; HttpOnly\n\nSet-Cookie: JSESSIONID=498BD2E8B22C5121143B7305A0ECB249; Path=\"\"; HttpOnly\n\nSet-Cookie: JSESSIONID=49F58AE7833522293F8EAD2AB2D13F19; Path=\"\"; HttpOnly\n\nContent-Type: text/html;charset=ISO-8859-1\n\nContent-Length: 7\n\nDate: Tue, 20 Apr 2010 15:38:47 GMT','2010-04-20 11:40:39','Filip Hanik','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 major','2468252','Filip Hanik','2010-04-20 12:34:27','Add test case for bug 49158','test/org/apache/tomcat/util/http/TestBug49158.java'),(1410,48589,'Bug 48589 – org.apache.catalina.realm.JNDIRealm User class should be accessible from sub-classes','','2010-01-21 07:49:57','Candid Dauth','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','a2499e7','Konstantin Kolinko','2010-04-20 12:30:52','Additional patch for https://issues.apache.org/bugzilla/show_bug.cgi?id=48589 Do not access JNDIRealm$User class fields directly, but use the getter methods, as (theoretically) those can be overwritten in subclasses.','java/org/apache/catalina/realm/JNDIRealm.java'),(1411,49151,'Bug 49151 – ClassCastException in BackupManager#stopInternal.','In BackupManager#startInternal,\nWhen constructor of LazyReplicatedMap throws exception, \nsessions is not LazyReplicatedMap.\nActually, AbstractReplicatedMap#init has the possibility of throwing RuntimeException. \n\nIn BackupManager#stopInternal ClassCastException is thrown \nbecause AbstractReplicatedMap#breakdown is executed regardless of the type of sessions. \n\nshould be changed as follows to avoid ClassCastException. \n===\nskip.\nif (sessions instanceof LazyReplicatedMap) {\n    LazyReplicatedMap map = (LazyReplicatedMap)sessions;\n    if ( map!=null ) {\n        map.breakdown();\n    }\n}\nskip.\n===\n\nThis problem exists in Tomcat7.0 and 6.0.\n\nBest Regards.','2010-04-19 05:02:32','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Cluster','P2 normal','fcb9861','Keiichi Fujino','2010-04-19 06:12:02','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49151','java/org/apache/catalina/ha/session/BackupManager.java'),(1412,49150,'Bug 49150 – All primary sessions are deleted at BackupManager#stopInternal.','BackupManager#stopInternal is as follows.\n\n=====\nprotected synchronized void stopInternal() throws LifecycleException {\n\n    super.stopInternal();\n\n    LazyReplicatedMap map = (LazyReplicatedMap)sessions;\n        if ( map!=null ) {\n            map.breakdown();\n        }\n\n        cluster.removeManager(this);\n}\n=====\n\nIn Tomcat 7.0.0 RC1, super#stopInternal() is called first.\nIn StandardManager#stopInternal() of the super class,\nThe session is stored, and expire all active sessions. \n\nStoring session is unnecessary in BackupManager.\nand\nWhen the session expired, the session is deleted from all cluster nodes.\n\nAs a Result,\nAll primary sessions (of own node has) are deleted  from all cluster nodes.\n\nFor instance,\nNode1 : sessionA(primary), sessionB(proxy), sessionC(backup)\nNode2 : sessionA(backup), sessionB(primary), sessionC(proxy)\nNode3 : sessionA(proxy), sessionB(backup), sessionC(primary)\n\nIf Node1 is stopped, it becomes the following. \n\nNode1 : stopped\nNode2 : sessionB(primary), sessionC(backup)\nNode3 : sessionB(backup), sessionC(primary)\n\nsessionA is expired.\nIt should be the following. \n\nNode1 : stopped\nNode2 : sessionA(primary), sessionB(primary), sessionC(backup)\nNode3 : sessionA(backup), sessionB(backup), sessionC(primary)\n\n\nThere is no problem in Tomcat6.0.x, \nbecause it executes super.stop() after LazyReplicatedMap#breakdown() .\n\nI made a patch against trunk.\n\nBest Regards.','2010-04-19 03:37:08','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Cluster','P2 normal','09f4e25','Keiichi Fujino','2010-04-19 06:07:16','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49150','java/org/apache/catalina/ha/session/BackupManager.java'),(1413,48843,'Bug 48843 – Tomcat Acceptor Thread goes into wait() and it will never come back','Hi,\n\nI believe I\'ve found a race condition in Tomcat that causes the http port to\nbe non-responsive. It exists in 6.0 and also in 5.5 (although the code has\nbeen refactored).\nI could not find any reference to it in the Bug database or the mailing list\narchives.\n\nConsider a tomcat instance with maxThreads set to 2, i.e. you have 2 tomcat\nthreads to service incoming requests.\nThe sequence of events is as follows:\n1. Thread 1 and Thread 2 are both servicing a request each.\n2. A third request comes in.\n3. In class JIOEndpoint.java, the acceptor thread calls methods\nprocessSocket() which then calls getWorkerThread() which then calls\ncreateWorkerThread().\n4. createWorkerThread() returns null since both threads are busy processing\nthe two requests.\n5. Here is the race condition in method getWorkerThread() in the code shown\nbelow\n\nprotected Worker getWorkerThread(){\n...\nWorker workerThread = createWorkerThread();\n        while (workerThread == null) {\n            try {\n                synchronized (workers) {\n                    workers.wait();\n                 }\n            }\n...\n}\n\nThe acceptor thread executes the \"while(workerThread == null)\" statement and\nis then switched out by the CPU.\nThe two threads executing the two requests complete and go into\nWorker.await() waiting for the next job after executing method\nrecycleWorkerThread().\nThe acceptor thread is switched back into CPU and executes the synchronized\nblock and goes into the wait().\n\nAt this point, there aren\'t any Worker threads out there processing requests\nand therefore there isn\'t any thread to wake up the acceptor thread.\nThe application is non-responsive after this.\n\nA simple solution would be to check if curThreadsBusy > 0 in the\nsynchronized block before going into wait() in method getWorkerThread()\nOR increase the scope of the critical section to include the while loop.\n\nThanks,\nHarshad\n\nStack Traces below:\n\n\"bda19102143\" id=1578 in WAITING on\nlock=org.apache.tomcat.util.net.jioendpoint$wor...@13aa4ee3^m\n    at java.lang.Object.wait(Native Method)^M\n    at java.lang.Object.wait(Object.java:485)^M\n    at\norg.apache.tomcat.util.net.JIoEndpoint$Worker.await(JIoEndpoint.java:416)^M\n    at\norg.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:442)^M\n    at java.lang.Thread.run(Thread.java:619)^M\n\n\"http-8091-Acceptor-0\" id=43 in WAITING on\nlock=org.apache.tomcat.util.net.jioendpoint$workerst...@13bd7b6a^m\n    at java.lang.Object.wait(Native Method)^M\n    at java.lang.Object.wait(Object.java:485)^M\n    at\norg.apache.tomcat.util.net.JIoEndpoint.getWorkerThread(JIoEndpoint.java:700)^M\n    at\norg.apache.tomcat.util.net.JIoEndpoint.processSocket(JIoEndpoint.java:731)^M\n    at\norg.apache.tomcat.util.net.JIoEndpoint$Acceptor.run(JIoEndpoint.java:313)^M\n    at java.lang.Thread.run(Thread.java:619)^M','2010-03-02 17:43:49','Harshad Kamat','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 major','725a892','Konstantin Kolinko','2010-04-16 21:59:56','Improve the ChatServlet comet example. 1. Fix possible deadlock in ChatServlet$MessageSender, similar to BZ 48843. 2. Properly wake up ChatServlet$MessageSender when the servlet is destroyed. 3. Filter special characters when printing the message in ChatServlet. 4. Provide an explicit charset everywhere. 5. Fix frames layout. Fix redirections. Use target=\"<name>\" attribute in HTML to send request to a particular frame. 6. Fix DTDs. Use frameset DTD for the page containing frames. 7. Add \"xxx joined the chat\" message at startup. 8. Rename chat.jsp -> index.jsp, so that the entry point to this example is more visible. 9. Corrected the link that opens a new chat window. It referenced an undefined JavaScript function. Now it is implemented just by using target=\"_blank\". 10. Added submit button to the form pages. 11. Minor message tweaks.','webapps/examples/WEB-INF/classes/chat/ChatServlet.java\nwebapps/examples/jsp/chat/chat.jsp\nwebapps/examples/jsp/chat/index.jsp\nwebapps/examples/jsp/chat/login.jsp\nwebapps/examples/jsp/chat/post.jsp'),(1414,49024,'Bug 49024 – Enhance RemoteIpFilter docs','','2010-03-30 17:50:34','Cyrille Le Clerc','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','dfc9343','Mark Emlyn David Thomas','2010-04-14 19:17:26','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49024 Enhance the RemoteIpFilter docs Patch provided by Cyrille Le Clerc','webapps/docs/config/filter.xml'),(1415,49129,'Bug 49129 – DigestAuthenticator.md5Helper - possible incorrect lazy initialisation','Findbugs says:\n\n\"This method contains an unsynchronized lazy initialization of a non-volatile static field. Because the compiler or processor may reorder instructions, threads are not guaranteed to see a completely initialized object, if the method can be called by multiple threads. You can make the field volatile to correct the problem.\"','2010-04-14 19:09:31','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','867605f','Mark Emlyn David Thomas','2010-04-14 19:13:45','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49129','java/org/apache/catalina/authenticator/DigestAuthenticator.java'),(1416,49118,'Bug 49118 – Inefficient use of String concatenation in loop','','2010-04-14 05:40:15','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','95a2eb8','Mark Emlyn David Thomas','2010-04-14 18:50:35','https://issues.apache.org/bugzilla/show_bug.cgi?id=49118 Use StringBuilder rather than concatenation','java/javax/servlet/http/HttpServlet.java'),(1417,49110,'Bug 49110 – runtime.JspFactoryImpl$PageContextPool needs to be static','Findbugs says:\n\nBug: org.apache.jasper.runtime.JspFactoryImpl$PageContextPool needs to be _static_ to avoid a deadly embrace with org.apache.jasper.runtime.JspFactoryImpl.localPool\nPattern id: SIC_THREADLOCAL_DEADLY_EMBRACE, type: SIC, category: CORRECTNESS\n\n\nThis class is an inner class, but should probably be a static inner class. As it is, there is a serious danger of a deadly embrace between the inner class and the thread local in the outer class. Because the inner class isn\'t static, it retains a reference to the outer class. If the thread local contains a reference to an instance of the inner class, the inner and outer instance will both be reachable and not eligible for garbage collection.','2010-04-12 19:50:48','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','b027259','Mark Emlyn David Thomas','2010-04-14 18:47:57','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49110 Make inner class static to prevent possible memory leak - found by FindBugs','java/org/apache/jasper/runtime/JspFactoryImpl.java'),(1418,49109,'Bug 49109 – RealmBase.authenticate uses toString on byte array','catalina.realm.RealmBase.authenticate(String username, byte[] credentials)\nhas the following code:\n\nreturn (authenticate(username, credentials.toString()));\n\nThis looks wrong, as credentials is a byte array.\n\nIt should probably be:\n\nreturn (authenticate(username, new String(credentials[,charset])));','2010-04-12 19:36:53','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','bcf0a01','Mark Emlyn David Thomas','2010-04-14 18:43:37','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49109 Remove unused authenticate() method with a broken default impl','java/org/apache/catalina/Realm.java\njava/org/apache/catalina/realm/CombinedRealm.java\njava/org/apache/catalina/realm/LockOutRealm.java\njava/org/apache/catalina/realm/RealmBase.java'),(1419,49106,'Bug 49106 – Unused imports','','2010-04-12 19:01:41','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','f8d3565','Mark Emlyn David Thomas','2010-04-14 18:29:34','https://issues.apache.org/bugzilla/show_bug.cgi?id=49106 Remove unused import','java/org/apache/catalina/realm/JNDIRealm.java'),(1420,49105,'Bug 49105 – Javadoc corrections','','2010-04-12 19:00:58','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','ead3997','Mark Emlyn David Thomas','2010-04-14 18:27:59','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49105 Misc Javadoc corrections.','java/javax/el/ExpressionFactory.java\njava/javax/servlet/HttpConstraintElement.java\njava/javax/servlet/ServletContext.java\njava/org/apache/catalina/Context.java\njava/org/apache/catalina/Host.java\njava/org/apache/catalina/Lifecycle.java\njava/org/apache/catalina/Session.java\njava/org/apache/catalina/authenticator/FormAuthenticator.java\njava/org/apache/catalina/connector/Request.java\njava/org/apache/catalina/core/ApplicationSessionCookieConfig.java\njava/org/apache/catalina/core/ContainerBase.java\njava/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/session/StandardSession.java\njava/org/apache/catalina/tribes/ChannelListener.java\njava/org/apache/catalina/tribes/group/RpcChannel.java\njava/org/apache/el/parser/AstValue.java\njava/org/apache/jasper/compiler/Node.java\nwebapps/examples/WEB-INF/classes/chat/ChatServlet.java\nwebapps/examples/WEB-INF/classes/filters/ExampleFilter.java\nwebapps/examples/WEB-INF/classes/filters/SetCharacterEncodingFilter.java'),(1421,49104,'Bug 49104 – Fix up some raw types','','2010-04-12 18:59:00','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','5be4f29','Mark Emlyn David Thomas','2010-04-14 18:24:17','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49104 Generics','java/org/apache/coyote/ajp/AjpProtocol.java\njava/org/apache/coyote/http11/Http11Protocol.java\njava/org/apache/tomcat/util/net/JIoEndpoint.java'),(1422,49103,'Bug 49103 – Missing annotations','','2010-04-12 18:57:56','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','1018cd7','Mark Emlyn David Thomas','2010-04-14 18:19:33','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49103 Add @Override where appropriate','java/org/apache/coyote/http11/Http11NioProtocol.java\njava/org/apache/coyote/http11/Http11Protocol.java\njava/org/apache/tomcat/util/net/AprEndpoint.java\njava/org/apache/tomcat/util/net/NioEndpoint.java\njava/org/apache/tomcat/util/net/jsse/JSSEImplementation.java'),(1423,49082,'Bug 49082 – ExpressionFactory.newInstance needs to be privileged','The ExpressionFactory.newInstance method needs to be wrapped in a privileged block so as to not throw an exception for security reasons.\n\nI\'m currently seeing a java.security.AccessControlException on el.properties when calling getClassNameJreDir().\n\nAlso, the System.getProperty(\"java.home\") does not need to have a trailing separator?  I would think you would want to modify the PROPERTY_FILE for el.properties to check for this final separator character.','2010-04-09 17:00:03','Robert Goff','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 normal','6624750','Mark Emlyn David Thomas','2010-04-14 10:46:07','Fully fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49082','java/javax/el/ExpressionFactory.java'),(1424,49045,'Bug 49045 – JMX Enhancement- Provision of MBeanFactory createStandardService','Currently MBeanFactory doesn\'t have a method for creating a new StandardService MBean. This would become an issue for future enhancements of JMX support in Tomcat. As per discussions with Mark, this enhancement is suggested as a starting point for possible future enhancements in JMX support.','2010-04-04 05:40:57','chamith buddhika','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','32046eb','Mark Emlyn David Thomas','2010-04-14 08:07:04','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49045 Add support for adding Services and Engines via JMX Based on a patch by Chamith Buddhika','java/org/apache/catalina/mbeans/MBeanFactory.java\njava/org/apache/catalina/mbeans/mbeans-descriptors.xml'),(1425,49089,'Bug 49089 – ChannelData.USE_SECURE_RANDOM_FOR_UUID public static mutable field','catalina.tribes.io.ChannelData.USE_SECURE_RANDOM_FOR_UUID is a mutable public static field.\n\nIt\'s only used by an instance method, so there\'s no need for it to be static.\nProbably no need for it to be public either; it could be a private field with a setter - or better a final field set by the constructor.','2010-04-11 22:24:38','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','cb0b029','Mark Emlyn David Thomas','2010-04-14 06:14:34','Alternative fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=49089','java/org/apache/catalina/tribes/io/ChannelData.java'),(1426,49116,'Bug 49116 – Memory leak by HttpSession.','When session is stored in StandardManager#doUnload method, \nan invalid session is stored. \n\nFor instance, \nIf HttpSession#invalidate is executed while executing StandardManager#doUnload,\nsession of \"isValid=false\" is stored.\n\nThe session of isValid=false is restored in StandardManager#doLoad, \nand it registers in session map (sessions). \nHowever, no one can invalidate this session. \n\nIf isValid is false, StandardSession#invalidate() and StandardSession#isValid() can not expire session.\nThey are throws IllegalStateException or return immediately. \n\nConsequently, the session of isValid=false is never deleted from the session map(sessions). \n\nI made a patch.\nIf session is already invalid, expire session to prevent memory leak.\n\nBest Regards.\nKeiichi.','2010-04-14 04:43:30','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','bddfc0a','Keiichi Fujino','2010-04-14 04:48:43','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49116 If session is already invalid, expire session to prevent memory leak.','java/org/apache/catalina/session/StandardManager.java'),(1427,49086,'Bug 49086 – Addition of Javadoc for Servlet 3.0 annotations','','2010-04-11 16:43:49','Pid','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 enhancement','6fc4360','Mark Emlyn David Thomas','2010-04-12 06:34:09','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49086 Add Javadocs to javax.servlet.annotation Patch provided by Pid.','java/javax/servlet/annotation/HandlesTypes.java\njava/javax/servlet/annotation/HttpConstraint.java\njava/javax/servlet/annotation/HttpMethodConstraint.java\njava/javax/servlet/annotation/MultipartConfig.java\njava/javax/servlet/annotation/ServletSecurity.java\njava/javax/servlet/annotation/WebFilter.java\njava/javax/servlet/annotation/WebInitParam.java\njava/javax/servlet/annotation/WebListener.java\njava/javax/servlet/annotation/WebServlet.java'),(1428,49091,'Bug 49091 – Util.specialCharactersRepresentation should be private','jasper.tagplugins.jstl.Util.specialCharactersRepresentation is a mutable public static array; it is not used outside the class as far as I can tell and so should be made private','2010-04-11 22:31:35','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','1ecfaa9','Mark Emlyn David Thomas','2010-04-12 05:42:07','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49091 Reduce visibility','java/org/apache/jasper/tagplugins/jstl/Util.java'),(1429,49082,'Bug 49082 – ExpressionFactory.newInstance needs to be privileged','The ExpressionFactory.newInstance method needs to be wrapped in a privileged block so as to not throw an exception for security reasons.\n\nI\'m currently seeing a java.security.AccessControlException on el.properties when calling getClassNameJreDir().\n\nAlso, the System.getProperty(\"java.home\") does not need to have a trailing separator?  I would think you would want to modify the PROPERTY_FILE for el.properties to check for this final separator character.','2010-04-09 17:00:03','Robert Goff','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 normal','e9118c9','Mark Emlyn David Thomas','2010-04-12 05:26:39','Partial fox for https://issues.apache.org/bugzilla/show_bug.cgi?id=49082 java.home may not include the final path separator','java/javax/el/ExpressionFactory.java'),(1430,49081,'Bug 49081 – EL expression preceded by a # in an attribute value of jsp documents','','2010-04-09 16:50:50','Silvio Corciolani','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 regression','9590fad','Mark Emlyn David Thomas','2010-04-11 14:15:02','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49081 \"#${1+1}\" should evaluate to \"#2\" Note that all files apart from ELParser.jjt are generated by javacc from the changes to ELParser.jjt','java/org/apache/el/parser/ELParser.jjt\njava/org/apache/el/parser/ELParserTokenManager.java\njava/org/apache/el/parser/ELParserTreeConstants.java\njava/org/apache/el/parser/JJTELParserState.java\njava/org/apache/el/parser/ParseException.java\njava/org/apache/el/parser/SimpleCharStream.java\njava/org/apache/el/parser/Token.java\njava/org/apache/el/parser/TokenMgrError.java'),(1431,49081,'Bug 49081 – EL expression preceded by a # in an attribute value of jsp documents','','2010-04-09 16:50:50','Silvio Corciolani','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 regression','96a6cd3','Mark Emlyn David Thomas','2010-04-11 14:09:16','Add test cases for https://issues.apache.org/bugzilla/show_bug.cgi?id=49081 \"#${1+1}\" should evaluate to \"#2\"','test/org/apache/el/parser/TestELParser.java\ntest/org/apache/jasper/compiler/TestAttributeParser.java'),(1432,49075,'Bug 49075 – protected Class User doesn\'t check argument roles for null','','2010-04-08 18:15:55','Felix Schumacher','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','e59ba8f','Mark Emlyn David Thomas','2010-04-09 07:16:40','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49075 NPE protection if roles is null and roles needs to be modifiable','java/org/apache/catalina/realm/JNDIRealm.java'),(1433,49018,'Bug 49018 – Timeout argument misprocessed when expiring sessions from Tomcat Manager','Steps to reproduce:\n1. Login to the Tomcat Manager Application\n2. Select a web application that has several sessions that are inactive for more than 2 minutes\n3. In the text field next to the \"Expire sessions\" button print \"2\"\n4. Press \"Expire sessions\"\n5. Sample observed result:\n\nOK - Session information for application at context path /myapp\nDefault maximum session inactive interval 30 minutes\n<1 minutes:16 sessions\n1 - <2 minutes:2 sessions\n2 - <3 minutes:5 sessions\n3 - <4 minutes:1 sessions\n4 - <5 minutes:2 sessions\n5 - <6 minutes:1 sessions\n6 - <7 minutes:2 sessions\n9 - <10 minutes:1 sessions\n8 minutes:expired 0 sessions\n\nActually some sessions were expired (even if the above message prints \"0\").\n\nExpected result:\nAll sessions with idle time > 2 minutes had to be expired.\n\nThe bug is in the following lines of ManagerServlet#sessions(PrintWriter, String, int):\n\nLines 1176-1179\n                if (idle >= 0 && time >= idle*60) {\n                    sessions[i].expire();\n                    idle++;\n                }\n\nThe patch would be to replace \"idle++\" with \"expired++\",\nbecause \"idle\" is the time (in minutes) as submitted from the web form and \"expired\" is the counter.','2010-03-29 15:18:35','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Manager application','P2 minor','155e3f8','Konstantin Kolinko','2010-04-06 23:24:08','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49018 Fix processing of time argument in the \"Expire sessions\" action in the Manager web application','java/org/apache/catalina/manager/LocalStrings.properties\njava/org/apache/catalina/manager/LocalStrings_de.properties\njava/org/apache/catalina/manager/LocalStrings_es.properties\njava/org/apache/catalina/manager/LocalStrings_fr.properties\njava/org/apache/catalina/manager/LocalStrings_ja.properties\njava/org/apache/catalina/manager/ManagerServlet.java'),(1434,48648,'Bug 48648 – Blank page (dropped connection) when running TC7 with TCnative (APR)','','2010-01-31 17:58:11','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 normal','216352a','Mark Emlyn David Thomas','2010-04-04 12:26:51','Fix the immediate problem described in https://issues.apache.org/bugzilla/show_bug.cgi?id=48648 Still need review remainder of bug report','java/org/apache/tomcat/util/net/AprEndpoint.java'),(1436,48983,'Bug 48983 – Enhance RemoteIpValve and RemoteIpFilter logging','','2010-03-24 23:15:14','Cyrille Le Clerc','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','9a42719','Mark Emlyn David Thomas','2010-04-04 06:25:56','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48983 Additional debug logging for when RemoteIp(Valve|Filter) is not invoked','.classpath\njava/org/apache/catalina/filters/RemoteIpFilter.java\njava/org/apache/catalina/valves/RemoteIpValve.java'),(1437,48914,'Bug 48914 – EL MethodExpression behavior incorrect','When dealing with the new [] and . operators in the EL specification, the specification says: \"If the expression is a MethodExpression, then calling its invoke method causes the method to be invoked, and the parameters params for the invoke method will be ignored, since those specified in EL will be used.\"  The behavior in Tomcat 7 is different as it uses the values specified in the invoke method.\n\nThis can be tested by doing something like this:\n        MethodExpression myMethodExpression = fact.createMethodExpression(ctxt, \"#{myBean[myStringExpression](\'using brackets in EL\')}\", String.class, new Class<?>[] {String.class});\n        Object myMethodReturn = myMethodExpression.invoke(ctxt, new String[] {\"using brackets\"});\n        pw.println(\"myMethodReturn=\"+myMethodReturn);','2010-03-15 14:05:24','Robert Goff','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 normal','bcc7505','Mark Emlyn David Thomas','2010-04-04 06:09:18','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48914 Invoke should use parameters provided in expression in preference to parameters provided in invoke() call','java/org/apache/el/parser/AstValue.java'),(1438,48914,'Bug 48914 – EL MethodExpression behavior incorrect','When dealing with the new [] and . operators in the EL specification, the specification says: \"If the expression is a MethodExpression, then calling its invoke method causes the method to be invoked, and the parameters params for the invoke method will be ignored, since those specified in EL will be used.\"  The behavior in Tomcat 7 is different as it uses the values specified in the invoke method.\n\nThis can be tested by doing something like this:\n        MethodExpression myMethodExpression = fact.createMethodExpression(ctxt, \"#{myBean[myStringExpression](\'using brackets in EL\')}\", String.class, new Class<?>[] {String.class});\n        Object myMethodReturn = myMethodExpression.invoke(ctxt, new String[] {\"using brackets\"});\n        pw.println(\"myMethodReturn=\"+myMethodReturn);','2010-03-15 14:05:24','Robert Goff','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 normal','9cc9412','Mark Emlyn David Thomas','2010-04-04 06:08:04','Modify unit tests to take account of https://issues.apache.org/bugzilla/show_bug.cgi?id=48914 Invoke should use parameters provided in expression in preference to parameters provided in invoke() call','test/org/apache/el/TestMethodExpressionImpl.java'),(1439,49030,'Bug 49030 – Processing of Tomcat Connector configuration can leave some connectors uninitialized','If the Server part of the Tomcat 6 configuration is beeing processed and there are more connectory defined, it seems to be the fact the exceptions during the connector initialization are not catched properly, so if there comes some exception by the initialization of one connector (for example to try to initialize the new connector for the same port like had the already initialized connector), then no other connectors are processed and created (no one listening port is allocated) even if such other connectors are defined properly. It leads to the situation the connectory are then initialized differently if the order of the connectors changes. It can be very confusing if searching some error in the definitions. Together with the fact, the default server.xml contains at least in some cases the invalid connector definition it leads to serious confusion it searching the configuration problem...','2010-03-31 12:34:56','Artur Linhart','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','4925b6e','Mark Emlyn David Thomas','2010-03-31 09:06:30','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=49030 Failure of one connector should not leave some connectors started and some ignored','java/org/apache/catalina/core/LocalStrings.properties\njava/org/apache/catalina/core/StandardService.java'),(1440,48895,'Bug 48895 – WebAppClassLoader.clearThreadLocalMap() concurrency issues','I think that the memory leak protection of WebAppClassLoader.clearReferencesThreadLocals() which detects and clears ThreadLocals that would prevent GC the WebAppClassLoader instance has issues regarding concurrency :\n\n- It enumerates Threads and looks into internal structures of the Thread class, but there are no \"memory barrier\" that would ensure a consistent state of the ThreadLocalMap being examined.\nSo, it is theoretically possible that a ThreadLocal in Thread A was properly cleaned up by the application, but the current thread B (that is undeploying the application) does not see the up to date state because there\'s no synchronization between those threads.\n\n- Much more severe : after detecting such a leak, it invokes java.lang.ThreadLocal.ThreadLocalMap.remove(ThreadLocal) on Thread A\'s ThreadLocalMap instance but the invocation is done by Thread B (the thread that undeploys the app). The remove() method is not thread safe at all, and nor is the expungeStaleEntries() method which may also be invoked in clearThreadLocalMap().\nSo, if a webapp is being undeployed while other applications continue to receive a heavy load of requests, this could corrupt the internal structures of the ThreadLocalMap instance !\n\nI propose to keep the detection of leaks as it is, but to make the actual clearing optional (and disabled by default) to avoid encountering big problems in production.\n\nIdea to improve the clearing in a safe way : if the thread that is \"provoking\" the leak is one of tomcat\'s worker threads, we could mark it as \"dirty\", and then have a background task that would end such threads (renew those threads in the pool).','2010-03-11 22:20:01','Sylvain Laurent','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','ae6fcf5','Mark Emlyn David Thomas','2010-03-29 11:01:14','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48895 Make clearing thread locals optional and disabled by default since it isn\'t thread-safe','java/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/loader/LocalStrings.properties\njava/org/apache/catalina/loader/WebappClassLoader.java\njava/org/apache/catalina/loader/WebappLoader.java\nwebapps/docs/config/context.xml'),(1441,48840,'Bug 48840 – catalina.sh fails to set CATALINA_HOME on newer bash versions','','2010-03-02 10:33:37','mdietze','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 major','1d7fdc8','Mark Emlyn David Thomas','2010-03-29 07:51:46','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48840 If CDPATH is set, cd may result in output to stdout. Swallow the output. This is safe since the script outputs the value used for CATALINA_HOME so any issues will be visible then. Patch provided by mdietze','bin/catalina.sh'),(1442,48839,'Bug 48839 – Header folding fails in NIO connector','Overview : HTTP request having one of its header folded send to NIO connctor fails with 400 bad request.\n\nSteps to Reproduce:\n1) Send an HTTP request having a header whoes value is folded (example :\nAdd an HTTP header TestHeader  with value = \"abcd\" +\"\\r\\n\\t\"+\"efgh\"\nto a server which is using Java Nio Blocking Connector  Http11NioProtocol \n\nExpected Result : Request should be handled successfully\n\nActual Result   : 400 Bad Request response is send back\n\nAdditional Information: \nThe issue is present in the  parseHeader() method of InternalNioInputBuffer class.\nHere the variable headerParsePos is set according to the enum\nHeaderParsePosition {HEADER_START, HEADER_NAME, HEADER_VALUE, HEADER_MULTI_LINE}\nInorder to verify if the header is multiline first the value of  headerParsePos is set to HEADER_MULTI_LINE\nThen following code is executed\nif ( headerParsePos == HeaderParsePosition.HEADER_MULTI_LINE ) {\n                if ( (chr != Constants.SP) && (chr != Constants.HT)) {\n                    headerParsePos = HeaderParsePosition.HEADER_START;\n                } else {\n                    eol = false;\n                    // Copying one extra space in the buffer (since there must\n                    // be at least one space inserted between the lines)\n                    buf[headerData.realPos] = chr;\n                    headerData.realPos++;\n                }\n}\n\nHere if the first character of the next line is not equal to space or tab then the value of   variable   headerParsePos is set to HEADER_START\nBut if the value is equal to space or tab then value of   variable   headerParsePos remains HEADER_MULTI_LINE.\nThe futher parsing of the header value is done only in case headerParsePos is set to HEADER_VALUE\nwhile (headerParsePos == HeaderParsePosition.HEADER_VALUE ||\n              headerParsePos == HeaderParsePosition.HEADER_MULTI_LINE) {\n          if ( headerParsePos == HeaderParsePosition.HEADER_VALUE ) {\n//code to parse header value \n         }\n       if ( headerParsePos == HeaderParsePosition.HEADER_MULTI_LINE ) {\n//code to handle multiline header\n        }\n}\nSince the value of headerParsePos is not being set back to HEADER_VALUE therefore code to handle multiline header is being executed .\nAnd the while loop goes in an endless loop.\nIf the else part of code to handle multiline header if                     headerParsePos = HeaderParsePosition. HEADER_VALUE; line is added as below\nif ( headerParsePos == HeaderParsePosition.HEADER_MULTI_LINE ) {\n                if ( (chr != Constants.SP) && (chr != Constants.HT)) {\n                    headerParsePos = HeaderParsePosition.HEADER_START;\n                } else {\n                    eol = false;\n                    // Copying one extra space in the buffer (since there must\n                    // be at least one space inserted between the lines)\n                    buf[headerData.realPos] = chr;\n                    headerData.realPos++;\n                    headerParsePos = HeaderParsePosition. HEADER_VALUE;\n                }\n}\nThen the header folding is handled successfully','2010-03-02 08:05:16','Richa Baronia','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 normal','5dc6615','Mark Emlyn David Thomas','2010-03-29 06:37:53','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48839 Correctly handle multi-line headers with the NIO connector Patch suggested by Richa Baronia','java/org/apache/coyote/http11/InternalNioInputBuffer.java'),(1443,48839,'Bug 48839 – Header folding fails in NIO connector','Overview : HTTP request having one of its header folded send to NIO connctor fails with 400 bad request.\n\nSteps to Reproduce:\n1) Send an HTTP request having a header whoes value is folded (example :\nAdd an HTTP header TestHeader  with value = \"abcd\" +\"\\r\\n\\t\"+\"efgh\"\nto a server which is using Java Nio Blocking Connector  Http11NioProtocol \n\nExpected Result : Request should be handled successfully\n\nActual Result   : 400 Bad Request response is send back\n\nAdditional Information: \nThe issue is present in the  parseHeader() method of InternalNioInputBuffer class.\nHere the variable headerParsePos is set according to the enum\nHeaderParsePosition {HEADER_START, HEADER_NAME, HEADER_VALUE, HEADER_MULTI_LINE}\nInorder to verify if the header is multiline first the value of  headerParsePos is set to HEADER_MULTI_LINE\nThen following code is executed\nif ( headerParsePos == HeaderParsePosition.HEADER_MULTI_LINE ) {\n                if ( (chr != Constants.SP) && (chr != Constants.HT)) {\n                    headerParsePos = HeaderParsePosition.HEADER_START;\n                } else {\n                    eol = false;\n                    // Copying one extra space in the buffer (since there must\n                    // be at least one space inserted between the lines)\n                    buf[headerData.realPos] = chr;\n                    headerData.realPos++;\n                }\n}\n\nHere if the first character of the next line is not equal to space or tab then the value of   variable   headerParsePos is set to HEADER_START\nBut if the value is equal to space or tab then value of   variable   headerParsePos remains HEADER_MULTI_LINE.\nThe futher parsing of the header value is done only in case headerParsePos is set to HEADER_VALUE\nwhile (headerParsePos == HeaderParsePosition.HEADER_VALUE ||\n              headerParsePos == HeaderParsePosition.HEADER_MULTI_LINE) {\n          if ( headerParsePos == HeaderParsePosition.HEADER_VALUE ) {\n//code to parse header value \n         }\n       if ( headerParsePos == HeaderParsePosition.HEADER_MULTI_LINE ) {\n//code to handle multiline header\n        }\n}\nSince the value of headerParsePos is not being set back to HEADER_VALUE therefore code to handle multiline header is being executed .\nAnd the while loop goes in an endless loop.\nIf the else part of code to handle multiline header if                     headerParsePos = HeaderParsePosition. HEADER_VALUE; line is added as below\nif ( headerParsePos == HeaderParsePosition.HEADER_MULTI_LINE ) {\n                if ( (chr != Constants.SP) && (chr != Constants.HT)) {\n                    headerParsePos = HeaderParsePosition.HEADER_START;\n                } else {\n                    eol = false;\n                    // Copying one extra space in the buffer (since there must\n                    // be at least one space inserted between the lines)\n                    buf[headerData.realPos] = chr;\n                    headerData.realPos++;\n                    headerParsePos = HeaderParsePosition. HEADER_VALUE;\n                }\n}\nThen the header folding is handled successfully','2010-03-02 08:05:16','Richa Baronia','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 normal','1747fab','Mark Emlyn David Thomas','2010-03-29 06:36:55','Test case for https://issues.apache.org/bugzilla/show_bug.cgi?id=48839 Fix to follow shortly','test/org/apache/coyote/http11/TestInternalInputBuffer.java'),(1444,48717,'Bug 48717 – Session listeners not called on cluster node start','','2010-02-09 17:43:14','David Rees','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina:Cluster','P2 regression','39d3082','Mark Emlyn David Thomas','2010-03-28 15:34:12','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48717 When a node joins a cluster and it receives all the current sessions, ensure the sessionCreated event is fired if the Manager is configured to replicate session events','java/org/apache/catalina/ha/session/DeltaManager.java'),(1445,48662,'Bug 48662 – context.xml expansion on deployment improvements','Two parts:\n\n1. Log a warning/info message if Tomcat ignores a bundled context.xml in favour of one in CATALINA_BASE/<engine name>/<host name>\n\n2. Make the extraction/copying of context.xml configurable, probably via a new attribute extractXml on the host','2010-02-02 22:44:07','Mark Thomas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','83226d9','Mark Emlyn David Thomas','2010-03-28 07:57:46','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48662 Make extraction of context.xml files configurable and disable it by default for Tomcat 7','java/org/apache/catalina/Context.java\njava/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/core/StandardHost.java\njava/org/apache/catalina/mbeans/MBeanFactory.java\njava/org/apache/catalina/startup/ContextConfig.java\njava/org/apache/catalina/startup/HostConfig.java\njava/org/apache/catalina/startup/LocalStrings.properties\nwebapps/docs/changelog.xml\nwebapps/docs/config/host.xml'),(1446,48992,'Bug 48992 – <Realm> tags are not closed, in examples of CombinedRealm and LockOutRealm.','Trailing <Realm/> should be </Realm> in examples of\n\'Realm Configuration HOW-TO.\'','2010-03-26 06:13:25','Fumiyuki Shimizu','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P2 trivial','f00e8e6','Konstantin Kolinko','2010-03-26 06:28:47','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48992 Fix XML tags in examples for CombinedRealm and LockOutRealm Based on the patch by Fumiyuki Shimizu','webapps/docs/realm-howto.xml'),(1447,45015,'Bug 45015 – Quoting in attributes','According to JSP 2.0 specification (chapter 1.7 page 72,73)\n\nThis code is illegal:\n<mytags:tag value=\"<%= \"hi!\" %>\" />\n\nInstead the correct sentence would be:\n<mytags:tag value=\'<%= \"hi!\" %>\' />\n<mytags:tag value=\"<%= \\\"hi!\\\" %>\" />\n<mytags:tag value=\'<%= \\\"name\\\" %>\' />\n...\n\nBut Tomcat 5.5 accept the first sentence. It\'s not a real bug but accepting a wrong sentence allow developpers to write code which does not respect the JSP specification. And when this code is executing in another servlet container (Websphere 6.1 for example) it doesn\'t work.','2008-05-16 04:22:28','Eric Taix','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Servlet & JSP API','P2 normal','ad97002','Mark Emlyn David Thomas','2010-03-25 18:46:12','Re-fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45015 Regression in recent parsing re-factoring','java/org/apache/jasper/compiler/AttributeParser.java\njava/org/apache/jasper/compiler/Parser.java'),(1448,45015,'Bug 45015 – Quoting in attributes','According to JSP 2.0 specification (chapter 1.7 page 72,73)\n\nThis code is illegal:\n<mytags:tag value=\"<%= \"hi!\" %>\" />\n\nInstead the correct sentence would be:\n<mytags:tag value=\'<%= \"hi!\" %>\' />\n<mytags:tag value=\"<%= \\\"hi!\\\" %>\" />\n<mytags:tag value=\'<%= \\\"name\\\" %>\' />\n...\n\nBut Tomcat 5.5 accept the first sentence. It\'s not a real bug but accepting a wrong sentence allow developpers to write code which does not respect the JSP specification. And when this code is executing in another servlet container (Websphere 6.1 for example) it doesn\'t work.','2008-05-16 04:22:28','Eric Taix','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Servlet & JSP API','P2 normal','833a52e','Mark Emlyn David Thomas','2010-03-25 17:41:46','Add an additional test case for bug 45015.','test/org/apache/jasper/compiler/TestGenerator.java\ntest/webapp-3.0/bug45nnn/bug45015c.jsp'),(1449,44041,'Bug 44041 – WebappClassLoader duplicate class definition under high Load if hasExternalRepositories is true','','2007-12-07 13:55:58','Philippe Mouawad','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 critical','4df6f0e','Mark Emlyn David Thomas','2010-03-25 15:44:41','Address various class-loader deadlock / sync issues https://issues.apache.org/bugzilla/show_bug.cgi?id=44041 https://issues.apache.org/bugzilla/show_bug.cgi?id=48694 https://issues.apache.org/bugzilla/show_bug.cgi?id=48903','java/org/apache/catalina/loader/WebappClassLoader.java\njava/org/apache/jasper/servlet/JasperLoader.java'),(1450,48694,'Bug 48694 – WebappClassLoader deadlock if web application uses it\'s own classloader','','2010-02-07 23:52:07','Eugene Petrenko','Tomcat Developers Mailing List','','Tomcat 6','Catalina','P2 normal','4df6f0e','Mark Emlyn David Thomas','2010-03-25 15:44:41','Address various class-loader deadlock / sync issues https://issues.apache.org/bugzilla/show_bug.cgi?id=44041 https://issues.apache.org/bugzilla/show_bug.cgi?id=48694 https://issues.apache.org/bugzilla/show_bug.cgi?id=48903','java/org/apache/catalina/loader/WebappClassLoader.java\njava/org/apache/jasper/servlet/JasperLoader.java'),(1451,48903,'Bug 48903 – ClassLoader deadlock when compiling JSP pages in 6.0.26','','2010-03-12 22:21:19','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 critical','4df6f0e','Mark Emlyn David Thomas','2010-03-25 15:44:41','Address various class-loader deadlock / sync issues https://issues.apache.org/bugzilla/show_bug.cgi?id=44041 https://issues.apache.org/bugzilla/show_bug.cgi?id=48694 https://issues.apache.org/bugzilla/show_bug.cgi?id=48903','java/org/apache/catalina/loader/WebappClassLoader.java\njava/org/apache/jasper/servlet/JasperLoader.java'),(1452,48790,'Bug 48790 – Race condition in org.apache.catalina.session.ManagerBase:maxActive','','2010-02-22 03:41:21','Yao Qi','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 major','5ca3eaa','Mark Emlyn David Thomas','2010-03-24 08:38:23','Simpler fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=48790 based on a patch by kkolinko Make maxActive thread safe. Probably unnecessary but technically a bug.','java/org/apache/catalina/ha/session/DeltaManager.java\njava/org/apache/catalina/session/ManagerBase.java'),(1453,48790,'Bug 48790 – Race condition in org.apache.catalina.session.ManagerBase:maxActive','','2010-02-22 03:41:21','Yao Qi','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 major','e2c9a95','Mark Emlyn David Thomas','2010-03-24 08:26:11','Revert fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=48790 in preparation for a simpler solution','java/org/apache/catalina/ha/session/DeltaManager.java\njava/org/apache/catalina/session/ManagerBase.java'),(1454,48934,'Bug 48934 – Cluster\'s regression. When replication fails once, replication can be never done again.','','2010-03-18 11:09:23','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Cluster','P2 regression','fc66705','Filip Hanik','2010-03-18 09:54:27','https://issues.apache.org/bugzilla/show_bug.cgi?id=48934 The wrong sender was disconnected, should only be the sender holding the actual TCP connections.','java/org/apache/catalina/tribes/transport/ReplicationTransmitter.java\njava/org/apache/catalina/tribes/transport/nio/PooledParallelSender.java'),(1455,48795,'Bug 48795 – Tomcat tries to use cache when compilation failed','','2010-02-22 15:13:26','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','368eb50','Mark Emlyn David Thomas','2010-03-11 15:28:34','Alternative fix for bug 48795. Add a new property to control if the next request always triggers recompilation after a compilation failure. Defaults to false and only applies in development mode','conf/web.xml\njava/org/apache/jasper/EmbeddedServletOptions.java\njava/org/apache/jasper/JspC.java\njava/org/apache/jasper/JspCompilationContext.java\njava/org/apache/jasper/Options.java\njava/org/apache/jasper/resources/LocalStrings.properties'),(1456,44265,'Bug 44265 – Improve JspWriterImpl performance with \"inline\" sub method','As you know, the JspWriterImpl.write method was always invoked in JSP file \nfrequently. But I found its performance is poor because too many sub method \nwere invoked as well.\nAfter copying two sub method\'s code to write method, the performance was \nimproved observably.','2008-01-18 02:51:47','Michael Mao','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 enhancement','9113574','Konstantin Kolinko','2010-03-11 13:32:39','Mark the min(a,b) method as static. Inspired by https://issues.apache.org/bugzilla/show_bug.cgi?id=44265','java/org/apache/jasper/runtime/JspWriterImpl.java'),(1457,48795,'Bug 48795 – Tomcat tries to use cache when compilation failed','','2010-02-22 15:13:26','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','cb04111','Mark Emlyn David Thomas','2010-03-10 12:35:43','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48795 If compilation fails, always try to re-compile the next time around','java/org/apache/jasper/JspCompilationContext.java\njava/org/apache/jasper/servlet/JspServletWrapper.java'),(1458,48793,'Bug 48793 – catalina.sh: \"stop\" errors on HP-UX','','2010-02-22 13:58:40','Thomas GL','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Native:Packaging','P2 normal','f41d44f','Mark Emlyn David Thomas','2010-03-10 11:46:46','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48793 Make catalina.sh more robust to different return values on different platforms Patch provided by Thomas GL','bin/catalina.sh'),(1459,48379,'Bug 48379 – Session cookie domain and path configuration support','This patch adds support for configuring session cookie domain and path \nparameter on per-context basis.\n\nConfiguration is done by editing META-INF/context.xml\n\n<Context sessionCookiePath=\"/something\" sessionCookieDomain=\".domain.tld\" />\n\nApplies to 6.0.20.','2009-12-11 08:43:07','Brane F. Gracnar','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 enhancement','f9ca850','Mark Emlyn David Thomas','2010-03-10 11:18:10','Remainder of fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=48379 Allow session cookie name to be configured per context With this option, the servlet 3 options and system property there were just too many places this was being configured so the system property option has been removed for Tomcat 7.','java/org/apache/catalina/Context.java\njava/org/apache/catalina/Globals.java\njava/org/apache/catalina/connector/CoyoteAdapter.java\njava/org/apache/catalina/core/ApplicationSessionCookieConfig.java\njava/org/apache/catalina/core/StandardContext.java\nwebapps/docs/config/systemprops.xml'),(1460,48379,'Bug 48379 – Session cookie domain and path configuration support','This patch adds support for configuring session cookie domain and path \nparameter on per-context basis.\n\nConfiguration is done by editing META-INF/context.xml\n\n<Context sessionCookiePath=\"/something\" sessionCookieDomain=\".domain.tld\" />\n\nApplies to 6.0.20.','2009-12-11 08:43:07','Brane F. Gracnar','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 enhancement','e67ef55','Mark Emlyn David Thomas','2010-03-10 08:56:28','Partial fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=48379 Allow session cookie path to be configured per context With this option, the servlet 3 options and Connector.emptySessionPath there were just too many places this was being configured so the Connector option has been removed for Tomcat 7. Based on a patch by Brane F. Gracnar','java/org/apache/catalina/Context.java\njava/org/apache/catalina/connector/Connector.java\njava/org/apache/catalina/connector/Request.java\njava/org/apache/catalina/core/ApplicationSessionCookieConfig.java\njava/org/apache/catalina/core/StandardContext.java\nwebapps/docs/config/ajp.xml\nwebapps/docs/config/context.xml\nwebapps/docs/config/http.xml'),(1461,48258,'Bug 48258 – Creating a session cookie with a specific default domain.','','2009-11-21 10:43:04','Tomcat Developers Mailing List','Tomcat Developers Mailing List','','Tomcat 6','Catalina','P2 enhancement','c6d4f99','Mark Emlyn David Thomas','2010-03-10 07:54:16','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48258 for TC7 Allow session cookie domain to be over-ridden by context configuration in the same way httpOnly may be Based on a patch by Donn Aiken','java/org/apache/catalina/Context.java\njava/org/apache/catalina/connector/Request.java\njava/org/apache/catalina/core/ApplicationSessionCookieConfig.java\njava/org/apache/catalina/core/StandardContext.java\nwebapps/docs/config/context.xml'),(1462,48790,'Bug 48790 – Race condition in org.apache.catalina.session.ManagerBase:maxActive','','2010-02-22 03:41:21','Yao Qi','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 major','a1f74d1','Mark Emlyn David Thomas','2010-03-09 17:19:44','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48790 Make maxActive thread safe. Technically a bug but seems like overkill.','java/org/apache/catalina/ha/session/DeltaManager.java\njava/org/apache/catalina/session/ManagerBase.java'),(1463,48701,'Bug 48701 – jsp:getProperty broken for certain cases','','2010-02-08 07:02:56','Boris Folgmann','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 regression','42bac69','Mark Emlyn David Thomas','2010-03-09 16:51:46','Bug 48701 test cases','test/org/apache/jasper/compiler/TestGenerator.java\ntest/webapp-3.0/WEB-INF/bugs.tld\ntest/webapp-3.0/bug48701-TVI-NFA.jsp\ntest/webapp-3.0/bug48701-TVI-NG.jsp\ntest/webapp-3.0/bug48701-UseBean.jsp\ntest/webapp-3.0/bug48701-VI.jsp\ntest/webapp-3.0/bug48701-fail.jsp'),(1464,48701,'Bug 48701 – jsp:getProperty broken for certain cases','','2010-02-08 07:02:56','Boris Folgmann','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 regression','906acd0','Mark Emlyn David Thomas','2010-03-09 16:51:18','Complete fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=48701','java/org/apache/jasper/compiler/Generator.java'),(1465,48007,'Bug 48007 – ClassNotFoundException when deserializing custom object with FileStore','We\'re using the FileStore to make sessions persistent. Sessions are serialized correctly, but every minute or so we get an exception like the following:\n\nSEVERE: Session: 6D026DD0479F48B331D28EE8325095BB;\njava.lang.ClassNotFoundException: com.whatever.spikes.session.CustomClass\n       at java.net.URLClassLoader$1.run(URLClassLoader.java:200)\n       at java.security.AccessController.doPrivileged(Native Method)\n       at java.net.URLClassLoader.findClass(URLClassLoader.java:188)\n       at java.lang.ClassLoader.loadClass(ClassLoader.java:319)\n       at java.lang.ClassLoader.loadClass(ClassLoader.java:254)\n       at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:399)\n       at java.lang.Class.forName0(Native Method)\n       at java.lang.Class.forName(Class.java:247)\n       at java.io.ObjectInputStream.resolveClass(ObjectInputStream.java:604)\n       at org.apache.catalina.util.CustomObjectInputStream.resolveClass(CustomObjectInputStream.java:78)\n       at java.io.ObjectInputStream.readNonProxyDesc(ObjectInputStream.java:1575)\n       at java.io.ObjectInputStream.readClassDesc(ObjectInputStream.java:1496)\n       at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1732)\n       at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1329)\n       at java.io.ObjectInputStream.readObject(ObjectInputStream.java:351)\n       at org.apache.catalina.session.StandardSession.readObject(StandardSession.java:1407)\n       at org.apache.catalina.session.StandardSession.readObjectData(StandardSession.java:931)\n       at org.apache.catalina.session.FileStore.load(FileStore.java:296)\n       at org.apache.catalina.session.StoreBase.processExpires(StoreBase.java:194)\n       at org.apache.catalina.session.PersistentManagerBase.processExpires(PersistentManagerBase.java:553)\n       at org.apache.catalina.session.ManagerBase.backgroundProcess(ManagerBase.java:664)\n       at org.apache.catalina.core.ContainerBase.backgroundProcess(ContainerBase.java:1285)\n       at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1570)\n       at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1579)\n       at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1579)\n       at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.run(ContainerBase.java:1559)\n       at java.lang.Thread.run(Thread.java:637)\n\nThis doesn\'t happen if we put CustomClass in $CATALINA_HOME/shared/lib or $CATALINA_HOME/shared/classes\n\nConfiguration:\n<Context path=\"/Spikes\" reloadable=\"true\" docBase=\"/Users/mman/Workspaces/Spikes\" workDir=\"/Users/mman/Workspaces/Spikes/work\" >\n       <Manager className=\"org.apache.catalina.session.PersistentManager\" maxIdleBackup=\"0\" >\n               <Store className=\"org.apache.catalina.session.FileStore\" directory=\"/Users/mman/tmp/tomcat-sessions\"/>\n         </Manager>\n</Context>\n\nEnvironment:\n*) Mac OS/X 10.6.1\n*) JDK 1.6.0_15\n*) Tomcat 5.5.27','2009-10-15 14:55:33','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED WORKSFORME','Tomcat 5','Catalina','P2 normal','6a1df3e','Konstantin Kolinko','2010-03-09 10:04:53','https://issues.apache.org/bugzilla/show_bug.cgi?id=48007#c5 Improve exception processing in CustomObjectInputStream#resolveClass(), to help find the cause behind BZ 48007.','java/org/apache/catalina/util/CustomObjectInputStream.java'),(1466,48007,'Bug 48007 – ClassNotFoundException when deserializing custom object with FileStore','We\'re using the FileStore to make sessions persistent. Sessions are serialized correctly, but every minute or so we get an exception like the following:\n\nSEVERE: Session: 6D026DD0479F48B331D28EE8325095BB;\njava.lang.ClassNotFoundException: com.whatever.spikes.session.CustomClass\n       at java.net.URLClassLoader$1.run(URLClassLoader.java:200)\n       at java.security.AccessController.doPrivileged(Native Method)\n       at java.net.URLClassLoader.findClass(URLClassLoader.java:188)\n       at java.lang.ClassLoader.loadClass(ClassLoader.java:319)\n       at java.lang.ClassLoader.loadClass(ClassLoader.java:254)\n       at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:399)\n       at java.lang.Class.forName0(Native Method)\n       at java.lang.Class.forName(Class.java:247)\n       at java.io.ObjectInputStream.resolveClass(ObjectInputStream.java:604)\n       at org.apache.catalina.util.CustomObjectInputStream.resolveClass(CustomObjectInputStream.java:78)\n       at java.io.ObjectInputStream.readNonProxyDesc(ObjectInputStream.java:1575)\n       at java.io.ObjectInputStream.readClassDesc(ObjectInputStream.java:1496)\n       at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1732)\n       at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1329)\n       at java.io.ObjectInputStream.readObject(ObjectInputStream.java:351)\n       at org.apache.catalina.session.StandardSession.readObject(StandardSession.java:1407)\n       at org.apache.catalina.session.StandardSession.readObjectData(StandardSession.java:931)\n       at org.apache.catalina.session.FileStore.load(FileStore.java:296)\n       at org.apache.catalina.session.StoreBase.processExpires(StoreBase.java:194)\n       at org.apache.catalina.session.PersistentManagerBase.processExpires(PersistentManagerBase.java:553)\n       at org.apache.catalina.session.ManagerBase.backgroundProcess(ManagerBase.java:664)\n       at org.apache.catalina.core.ContainerBase.backgroundProcess(ContainerBase.java:1285)\n       at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1570)\n       at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1579)\n       at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1579)\n       at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.run(ContainerBase.java:1559)\n       at java.lang.Thread.run(Thread.java:637)\n\nThis doesn\'t happen if we put CustomClass in $CATALINA_HOME/shared/lib or $CATALINA_HOME/shared/classes\n\nConfiguration:\n<Context path=\"/Spikes\" reloadable=\"true\" docBase=\"/Users/mman/Workspaces/Spikes\" workDir=\"/Users/mman/Workspaces/Spikes/work\" >\n       <Manager className=\"org.apache.catalina.session.PersistentManager\" maxIdleBackup=\"0\" >\n               <Store className=\"org.apache.catalina.session.FileStore\" directory=\"/Users/mman/tmp/tomcat-sessions\"/>\n         </Manager>\n</Context>\n\nEnvironment:\n*) Mac OS/X 10.6.1\n*) JDK 1.6.0_15\n*) Tomcat 5.5.27','2009-10-15 14:55:33','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED WORKSFORME','Tomcat 5','Catalina','P2 normal','6a1df3e','Konstantin Kolinko','2010-03-09 10:04:53','https://issues.apache.org/bugzilla/show_bug.cgi?id=48007#c5 Improve exception processing in CustomObjectInputStream#resolveClass(), to help find the cause behind BZ 48007.','java/org/apache/catalina/util/CustomObjectInputStream.java'),(1467,48701,'Bug 48701 – jsp:getProperty broken for certain cases','','2010-02-08 07:02:56','Boris Folgmann','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 regression','1fbec8a','Konstantin Kolinko','2010-03-09 09:04:58','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48701 Add a system property to allow disabling enforcement of a requirement of JSP.5.3. The specification recommends, but does not require us to enforce it.','java/org/apache/jasper/compiler/Generator.java\nwebapps/docs/config/systemprops.xml'),(1468,48760,'Bug 48760 – Tomcat breaks in serving large files (>=1.8MB) under high load and high threading.','','2010-02-17 20:44:37','Stefan Kendall','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 major','f1760d8','Mark Emlyn David Thomas','2010-03-09 08:15:15','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48760 Remove potential race condition that can result in multiple threads trying to use the same InputStream','java/org/apache/naming/resources/FileDirContext.java\njava/org/apache/naming/resources/WARDirContext.java'),(1469,48737,'Bug 48737 – JspCompilationContext assumes that tagfile with a path starting with META-INF are in jars without checking','','2010-02-13 18:19:03','Fabrizio Giustina','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','6ac5036','Mark Emlyn David Thomas','2010-03-09 07:30:37','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48737 Don\'t assume paths that start with /META-INF/... are always in JARs. This is not true for some IDEs Patch provided by Fabrizio Giustina','java/org/apache/jasper/JspCompilationContext.java'),(1470,48729,'Bug 48729 – JNDIRealm.java not parsing roles correctly','','2010-02-11 17:27:55','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','4cf35b8','Mark Emlyn David Thomas','2010-03-09 07:14:23','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48729 Return roles defined by both userRoleName and roleName mechanisms Patch provided by \'eric\'','java/org/apache/catalina/realm/JNDIRealm.java'),(1471,48668,'Bug 48668 – Template text that looks like a deferred expression can be mishandled even if EL is ignored','In some cases text that happens to look similar to a deferred expression (#{..}) can get mangled even if the EL is not active. This appears to only happen if the text in question immediately proceeds a custom tag (either a full blown custom tag or a simple .tag file tag). The initial # and { characters get removed.\n\nThis happens in Tomcat v6.0.24 but did not happen in v6.0.20 so appears to be unintentional.\n\nWe have been upgrading legacy sites to Tomcat v6 and have hit this problem.\n\nThis problem can be recreated in a bog standard install of Tomcat v6.0.24. Create a simple .tag file that does nothing more than say \'hello\'. Place a reference to this tag into a JSP with the offending text immediately after it. \n\nA test JSP that looks something like (note that EL is being ignored)...\n\n<%@ page isELIgnored=\"true\" %>\n<%@ taglib tagdir=\"/WEB-INF/tags/custom\" prefix=\"custom\" %>\n<html>\n<title>Test</title>\n</head>\n<body>\n  <custom:example />#{foo.bar}\n</body>\n</html>\n\nWhere the custom example tag (/WEB-INF/tags/custom/example.tag) looks like this...\n\nHello\n\nRather than the page returning the following...\n\n<html>\n<title>Test</title>\n</head>\n<body>\n  Hello#{foo.bar}\n</body>\n</html>\n\nIt will return...\n\n<html>\n<title>Test</title>\n</head>\n<body>\n  Hellofoo.bar}\n</body>\n</html>\n\nNotice the missing # and { from the text.\n\nI don\'t believe the platform Tomcat is running on matters. Have seen this behaviour on both Mac OS X and Linux.','2010-02-03 09:22:59','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 minor','5e0f0c4','Konstantin Kolinko','2010-03-08 19:43:23','Amendment for BZ 48668 fixes. Use setter methods that accept String value to set pageInfo properties. Throw an exception if tagInfo is not available for a tag file or requiredVersion is not parseable. (Both of that should not happen).','java/org/apache/jasper/compiler/Compiler.java'),(1472,48701,'Bug 48701 – jsp:getProperty broken for certain cases','','2010-02-08 07:02:56','Boris Folgmann','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 regression','aee1e3e','Mark Emlyn David Thomas','2010-03-08 16:53:29','Revisit https://issues.apache.org/bugzilla/show_bug.cgi?id=48701 Allow TagVariableInfo as well as VariableInfo to introduce objects later used by <jsp:getProperty> - JSP.5.3','java/org/apache/jasper/compiler/Generator.java'),(1473,48661,'Bug 48661 – inconsistent error page behavior','There seems to be a bug or at least an inconsistency in how tomcat handles the error page.\n\nIn Tomcat 6.0.20, if I define my error page like this in web.xml:\n\n<error-page>\n      <exception-type>java.lang.Exception</exception-type>\n      <location>/unexpectedErrors.jsp</location>\n</error-page>\n\nThen, if the response has already been committed, Tomcat does this on\nthe system console:\n\nFeb 1, 2010 5:59:04 PM org.apache.catalina.core.StandardWrapperValve invoke\nSEVERE: Servlet.service() for servlet jsp threw exception\njava.lang.NullPointerException\n       at org.apache.jsp.cpe_jsp._jspService(cpe_jsp.java:693)\n       at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)\n       at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n       at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:374)\n       at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:342)\n       at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:267)\n       at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n       at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n       at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n       at com.eaglecreektech.expedience.provisioning.web.servletFilters.AuthFilter.doFilter(AuthFilter.java:133)\n       at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n       at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n       at com.eaglecreektech.expedience.provisioning.web.servletFilters.RequestVolumeFilter.doFilter(RequestVolumeFilter.java:141)\n       at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n       at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n       at com.eaglecreektech.expedience.provisioning.web.servletFilters.StartupCheckFilter.doFilter(StartupCheckFilter.java:65)\n       at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n       at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n       at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)\n       at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)\n       at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:128)\n       at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)\n       at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n       at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)\n       at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:849)\n       at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:583)\n       at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:454)\n       at java.lang.Thread.run(Thread.java:619)\nFeb 1, 2010 5:59:04 PM org.apache.catalina.core.StandardHostValve custom\nSEVERE: Exception Processing\nErrorPage[exceptionType=java.lang.Exception,\nlocation=/unexpectedErrors.jsp]\njava.lang.IllegalStateException: Cannot reset buffer after response\nhas been committed\n       at org.apache.catalina.connector.Response.resetBuffer(Response.java:691)\n       at org.apache.catalina.core.StandardHostValve.custom(StandardHostValve.java:409)\n       at org.apache.catalina.core.StandardHostValve.throwable(StandardHostValve.java:271)\n       at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:142)\n       at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)\n       at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n       at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)\n       at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:849)\n       at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:583)\n       at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:454)\n       at java.lang.Thread.run(Thread.java:619)\n\n\nAnd it doesn\'t put any error text into the broken page - the page just\nshows how ever far it got before it encountered the error.\n\nThis behavior doesn\'t seem correct - it seems like it should at least\nbehave the same way as it does when the error page is defined in a jsp\npage:\n\n<%@ page errorPage=\"unexpectedErrors.jsp\" %>\n\nIf the response has already been committed, then it just appends the\nerror page onto the end of the response (not ideal, but nothing else can be done, as far as I know)\n\nIf the response has not been committed, it clears the buffer and\nwrites the error page (which looks nice and pretty , like it should)\n\nI\'d suggest that the error handling code for the error page as defined in web.xml should check if the response has been committed, and not try to clear the buffer if it is already committed - just append to the end, the same way that the jsp error handler does.','2010-02-02 15:07:25','Dan Armbrust','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 minor','1ec5ca7','Mark Emlyn David Thomas','2010-03-08 13:58:28','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48661 If the response has been committed, include the error page like Jasper does','java/org/apache/catalina/core/StandardHostValve.java'),(1474,48629,'Bug 48629 – JNDIRealm and roleNested doesn\'t work with roleSearch=\"(member={1})\"','','2010-01-27 13:35:47','tahitiangabriel','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 minor','4d8b1ff','Mark Emlyn David Thomas','2010-03-08 12:59:51','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48629 Make nested role search work with username as well as DN Add roleNested to the docs Patch provided by Felix Schumacher','java/org/apache/catalina/realm/JNDIRealm.java\nwebapps/docs/realm-howto.xml'),(1475,48668,'Bug 48668 – Template text that looks like a deferred expression can be mishandled even if EL is ignored','In some cases text that happens to look similar to a deferred expression (#{..}) can get mangled even if the EL is not active. This appears to only happen if the text in question immediately proceeds a custom tag (either a full blown custom tag or a simple .tag file tag). The initial # and { characters get removed.\n\nThis happens in Tomcat v6.0.24 but did not happen in v6.0.20 so appears to be unintentional.\n\nWe have been upgrading legacy sites to Tomcat v6 and have hit this problem.\n\nThis problem can be recreated in a bog standard install of Tomcat v6.0.24. Create a simple .tag file that does nothing more than say \'hello\'. Place a reference to this tag into a JSP with the offending text immediately after it. \n\nA test JSP that looks something like (note that EL is being ignored)...\n\n<%@ page isELIgnored=\"true\" %>\n<%@ taglib tagdir=\"/WEB-INF/tags/custom\" prefix=\"custom\" %>\n<html>\n<title>Test</title>\n</head>\n<body>\n  <custom:example />#{foo.bar}\n</body>\n</html>\n\nWhere the custom example tag (/WEB-INF/tags/custom/example.tag) looks like this...\n\nHello\n\nRather than the page returning the following...\n\n<html>\n<title>Test</title>\n</head>\n<body>\n  Hello#{foo.bar}\n</body>\n</html>\n\nIt will return...\n\n<html>\n<title>Test</title>\n</head>\n<body>\n  Hellofoo.bar}\n</body>\n</html>\n\nNotice the missing # and { from the text.\n\nI don\'t believe the platform Tomcat is running on matters. Have seen this behaviour on both Mac OS X and Linux.','2010-02-03 09:22:59','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 minor','de0e6e1','Konstantin Kolinko','2010-03-06 21:43:12','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48668 Fix remaining issues in BZ48668 The idea behind this change is to make ELParser aware about isDeferredAsLiteral option. Before this change ELParser was used to parse an attribute regardless of isELIgnored or isDeferredSyntaxAllowedAsLiteral values. With this change we do not use ELParser when isELIgnored is true and ELParser does not parse \'#{\' in expressions when isDeferredSyntaxAllowedAsLiteral is true. It simplified the code in many places. Also, servlet specification version from web.xml and JSP specification version from TLD file are now taken into account when determining the default values for isELIgnored and isDeferredSyntaxAllowedAsLiteral. As far as I understand the code, previously only isELIgnored was determined by the servlet specification version.','java/org/apache/jasper/compiler/Compiler.java\njava/org/apache/jasper/compiler/ELParser.java\njava/org/apache/jasper/compiler/JspConfig.java\njava/org/apache/jasper/compiler/Validator.java\njava/org/apache/jasper/resources/LocalStrings.properties\ntest/org/apache/jasper/compiler/TestParser.java\ntest/webapp/bug48668a.jsp'),(1476,48668,'Bug 48668 – Template text that looks like a deferred expression can be mishandled even if EL is ignored','In some cases text that happens to look similar to a deferred expression (#{..}) can get mangled even if the EL is not active. This appears to only happen if the text in question immediately proceeds a custom tag (either a full blown custom tag or a simple .tag file tag). The initial # and { characters get removed.\n\nThis happens in Tomcat v6.0.24 but did not happen in v6.0.20 so appears to be unintentional.\n\nWe have been upgrading legacy sites to Tomcat v6 and have hit this problem.\n\nThis problem can be recreated in a bog standard install of Tomcat v6.0.24. Create a simple .tag file that does nothing more than say \'hello\'. Place a reference to this tag into a JSP with the offending text immediately after it. \n\nA test JSP that looks something like (note that EL is being ignored)...\n\n<%@ page isELIgnored=\"true\" %>\n<%@ taglib tagdir=\"/WEB-INF/tags/custom\" prefix=\"custom\" %>\n<html>\n<title>Test</title>\n</head>\n<body>\n  <custom:example />#{foo.bar}\n</body>\n</html>\n\nWhere the custom example tag (/WEB-INF/tags/custom/example.tag) looks like this...\n\nHello\n\nRather than the page returning the following...\n\n<html>\n<title>Test</title>\n</head>\n<body>\n  Hello#{foo.bar}\n</body>\n</html>\n\nIt will return...\n\n<html>\n<title>Test</title>\n</head>\n<body>\n  Hellofoo.bar}\n</body>\n</html>\n\nNotice the missing # and { from the text.\n\nI don\'t believe the platform Tomcat is running on matters. Have seen this behaviour on both Mac OS X and Linux.','2010-02-03 09:22:59','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 minor','916154f','Konstantin Kolinko','2010-03-06 16:03:14','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48668 Honor isELIgnored and isDeferredSyntaxAllowed in the Parser','java/org/apache/jasper/compiler/Parser.java\ntest/org/apache/jasper/compiler/TestParser.java\ntest/webapp/bug48668a.jsp'),(1477,48668,'Bug 48668 – Template text that looks like a deferred expression can be mishandled even if EL is ignored','In some cases text that happens to look similar to a deferred expression (#{..}) can get mangled even if the EL is not active. This appears to only happen if the text in question immediately proceeds a custom tag (either a full blown custom tag or a simple .tag file tag). The initial # and { characters get removed.\n\nThis happens in Tomcat v6.0.24 but did not happen in v6.0.20 so appears to be unintentional.\n\nWe have been upgrading legacy sites to Tomcat v6 and have hit this problem.\n\nThis problem can be recreated in a bog standard install of Tomcat v6.0.24. Create a simple .tag file that does nothing more than say \'hello\'. Place a reference to this tag into a JSP with the offending text immediately after it. \n\nA test JSP that looks something like (note that EL is being ignored)...\n\n<%@ page isELIgnored=\"true\" %>\n<%@ taglib tagdir=\"/WEB-INF/tags/custom\" prefix=\"custom\" %>\n<html>\n<title>Test</title>\n</head>\n<body>\n  <custom:example />#{foo.bar}\n</body>\n</html>\n\nWhere the custom example tag (/WEB-INF/tags/custom/example.tag) looks like this...\n\nHello\n\nRather than the page returning the following...\n\n<html>\n<title>Test</title>\n</head>\n<body>\n  Hello#{foo.bar}\n</body>\n</html>\n\nIt will return...\n\n<html>\n<title>Test</title>\n</head>\n<body>\n  Hellofoo.bar}\n</body>\n</html>\n\nNotice the missing # and { from the text.\n\nI don\'t believe the platform Tomcat is running on matters. Have seen this behaviour on both Mac OS X and Linux.','2010-02-03 09:22:59','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 minor','bf36a0c','Konstantin Kolinko','2010-03-06 15:46:06','Additional tests for https://issues.apache.org/bugzilla/show_bug.cgi?id=48668 The TestCase currently passes: the parts that do not pass currently are commented-out: - in bug48668a.jsp: those that prevent JSP from being compiled - in TestParser.java: also those that provide wrong output.','test/org/apache/jasper/compiler/TestParser.java\ntest/webapp/WEB-INF/tags/bug48668.tagx\ntest/webapp/bug48668a.jsp'),(1478,48861,'Bug 48861 – Files without AL headers','','2010-03-04 23:36:54','Sebb','Tomcat Developers Mailing List','NEW','Tomcat Modules','Tomcat Lite','P2 normal','94dd25a','Mark Emlyn David Thomas','2010-03-05 04:08:45','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48861 for Tomcat 7 (missed a couple)','java/org/apache/tomcat/util/bcel/package.html\njava/org/apache/tomcat/util/scan/package.html'),(1479,48861,'Bug 48861 – Files without AL headers','','2010-03-04 23:36:54','Sebb','Tomcat Developers Mailing List','NEW','Tomcat Modules','Tomcat Lite','P2 normal','e7df8ea','Mark Emlyn David Thomas','2010-03-05 04:03:30','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48861 for Tomcat 7. Still an issue for Tomcat-lite','java/org/apache/tomcat/util/bcel/classfile/AnnotationElementValue.java\njava/org/apache/tomcat/util/bcel/classfile/ArrayElementValue.java\njava/org/apache/tomcat/util/bcel/classfile/ClassElementValue.java\njava/org/apache/tomcat/util/bcel/classfile/EnumElementValue.java\njava/org/apache/tomcat/util/bcel/classfile/package.html\njava/org/apache/tomcat/util/bcel/util/package.html\ntest/org/apache/catalina/deploy/TestSecurityConstraint.java\ntest/org/apache/catalina/loader/TestWebappClassLoaderMemoryLeak.java'),(1480,48050,'Bug 48050 – org.apache.naming.NamingContext\'s createSubcontext method returns Context with wrong name','Below is the original source code of org.apache.naming.NamingContext\'s createSubcontext(Name name) method:\n\n/**\n     * Creates and binds a new context. Creates a new context with the given \n     * name and binds it in the target context (that named by all but \n     * terminal atomic component of the name). All intermediate contexts and \n     * the target context must already exist.\n     * \n     * @param name the name of the context to create; may not be empty\n     * @return the newly created context\n     * @exception NameAlreadyBoundException if name is already bound\n     * @exception InvalidAttributesException if creation of the subcontext \n     * requires specification of mandatory attributes\n     * @exception NamingException if a naming exception is encountered\n     */\n    public Context createSubcontext(Name name)\n        throws NamingException {\n        checkWritable();\n        \n        Context newContext = new NamingContext(env, this.name);\n        bind(name, newContext);\n        \n        return newContext;\n    }\n\nHowever, the returned NamingContext has the same name with its parent NamingContext. I suggest change the source code to below:\n\n    public Context createSubcontext(Name name)\n        throws NamingException {\n        checkWritable();\n        \n        Context newContext = new NamingContext(env, name.get(name.size() - 1));\n        bind(name, newContext);\n        \n        return newContext;\n    }','2009-10-25 10:26:17','qingyang.xu','Tomcat Developers Mailing List','RESOLVED INVALID','Tomcat 6','Catalina','P2 minor','65093e0','Mark Emlyn David Thomas','2010-03-04 07:05:06','Revert r917784 and r905722 - changes associated with the invalid bug 48050','java/org/apache/naming/LocalStrings.properties\njava/org/apache/naming/NamingContext.java'),(1481,48831,'Bug 48831 – Properly closing JULI FileHandler','','2010-03-01 09:01:25','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','11ca0ae','Konstantin Kolinko','2010-03-04 03:05:36','Fix 1. of https://issues.apache.org/bugzilla/show_bug.cgi?id=48831#c3 Ignore the reset() call from java.util.logging.LogManager.Cleaner, because we have our own shutdown hook that will take care.','java/org/apache/juli/ClassLoaderLogManager.java'),(1482,48831,'Bug 48831 – Properly closing JULI FileHandler','','2010-03-01 09:01:25','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','9b8038f','Konstantin Kolinko','2010-03-03 19:18:44','Fix 2. of https://issues.apache.org/bugzilla/show_bug.cgi?id=48831#c3 When resetting a logger do not close handlers that do not belong to the current class loader.','java/org/apache/juli/ClassLoaderLogManager.java'),(1483,47977,'Bug 47977 – body-content of empty in TLD ignored for JSP Documents','','2009-10-10 13:39:39','jcorallo','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Servlet & JSP API','P2 normal','7189925','Mark Emlyn David Thomas','2010-03-03 16:00:22','Revert previous fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=47977 that caused regression https://issues.apache.org/bugzilla/show_bug.cgi?id=48827 and implement an alternative fix','java/org/apache/jasper/compiler/JspDocumentParser.java'),(1484,48827,'Bug 48827 – Error validating empty tag that contains jsp:attribute in JSP documents in XML syntax','','2010-02-27 13:10:11','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 regression','7189925','Mark Emlyn David Thomas','2010-03-03 16:00:22','Revert previous fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=47977 that caused regression https://issues.apache.org/bugzilla/show_bug.cgi?id=48827 and implement an alternative fix','java/org/apache/jasper/compiler/JspDocumentParser.java'),(1485,47977,'Bug 47977 – body-content of empty in TLD ignored for JSP Documents','','2009-10-10 13:39:39','jcorallo','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Servlet & JSP API','P2 normal','715989d','Mark Emlyn David Thomas','2010-03-03 15:59:23','Add tests for bugs 47977 and 48827','test/org/apache/TestAll.java\ntest/org/apache/jasper/compiler/TestJspDocumentParser.java\ntest/webapp/bug47977.jspx\ntest/webapp/bug48827.jspx'),(1486,48827,'Bug 48827 – Error validating empty tag that contains jsp:attribute in JSP documents in XML syntax','','2010-02-27 13:10:11','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 regression','715989d','Mark Emlyn David Thomas','2010-03-03 15:59:23','Add tests for bugs 47977 and 48827','test/org/apache/TestAll.java\ntest/org/apache/jasper/compiler/TestJspDocumentParser.java\ntest/webapp/bug47977.jspx\ntest/webapp/bug48827.jspx'),(1487,48827,'Bug 48827 – Error validating empty tag that contains jsp:attribute in JSP documents in XML syntax','','2010-02-27 13:10:11','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 regression','e54e5db','Mark Emlyn David Thomas','2010-03-03 14:27:25','Echo tags are not expected to have bodies. Has the happy side-effect of providing a tag that can be used to test bug 48827.','test/webapp/WEB-INF/tags/echo-deferred.tag\ntest/webapp/WEB-INF/tags/echo-double.tag\ntest/webapp/WEB-INF/tags/echo-long.tag\ntest/webapp/WEB-INF/tags/echo-noel.tag\ntest/webapp/WEB-INF/tags/echo.tag'),(1488,48831,'Bug 48831 – Properly closing JULI FileHandler','','2010-03-01 09:01:25','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','68b2ba9','Mark Emlyn David Thomas','2010-03-03 12:26:54','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48831 Address issues 1 & 2 by using a ReadWriteLock to control access to the writer. This ensures messages won\'t be written while the writer is null. Note there is no (easy) way to not close the handler. Address issue 3 by re-enabling the JULI shutdown hook if JULI is being used and Tomcat isn\'t stopped via a shutdown hook. Address issue 4 by making ClassLoaderLogManager#useShutdownHook volatile','java/org/apache/catalina/startup/Catalina.java\njava/org/apache/juli/ClassLoaderLogManager.java\njava/org/apache/juli/FileHandler.java'),(1489,48660,'Bug 48660 – Connector compression=on overwrites Vary header','When compressing the connector sets the \"Vary: Accept-Encoding\".  I think it would be more correct to append \"Accept-Encoding\" the the current value of the Vary header instead of replacing it. \n\nIn particular, I cannot set this header to \"Cookie\" to force reload of the page if the JSESSIONID cookie changes','2010-02-02 13:40:54','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 normal','5070d89','Mark Emlyn David Thomas','2010-03-02 11:02:25','Better fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=48660 As per Konstantin\'s comments, ensure a single Vary header is used and take account of * if present','java/org/apache/coyote/http11/Http11AprProcessor.java\njava/org/apache/coyote/http11/Http11NioProcessor.java\njava/org/apache/coyote/http11/Http11Processor.java'),(1490,48050,'Bug 48050 – org.apache.naming.NamingContext\'s createSubcontext method returns Context with wrong name','Below is the original source code of org.apache.naming.NamingContext\'s createSubcontext(Name name) method:\n\n/**\n     * Creates and binds a new context. Creates a new context with the given \n     * name and binds it in the target context (that named by all but \n     * terminal atomic component of the name). All intermediate contexts and \n     * the target context must already exist.\n     * \n     * @param name the name of the context to create; may not be empty\n     * @return the newly created context\n     * @exception NameAlreadyBoundException if name is already bound\n     * @exception InvalidAttributesException if creation of the subcontext \n     * requires specification of mandatory attributes\n     * @exception NamingException if a naming exception is encountered\n     */\n    public Context createSubcontext(Name name)\n        throws NamingException {\n        checkWritable();\n        \n        Context newContext = new NamingContext(env, this.name);\n        bind(name, newContext);\n        \n        return newContext;\n    }\n\nHowever, the returned NamingContext has the same name with its parent NamingContext. I suggest change the source code to below:\n\n    public Context createSubcontext(Name name)\n        throws NamingException {\n        checkWritable();\n        \n        Context newContext = new NamingContext(env, name.get(name.size() - 1));\n        bind(name, newContext);\n        \n        return newContext;\n    }','2009-10-25 10:26:17','qingyang.xu','Tomcat Developers Mailing List','RESOLVED INVALID','Tomcat 6','Catalina','P2 minor','390724f','Mark Emlyn David Thomas','2010-03-01 18:14:12','Correct fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=48050 NamingContext.createSubcontext method returns Context with wrong name','java/org/apache/naming/LocalStrings.properties\njava/org/apache/naming/NamingContext.java'),(1491,48392,'Bug 48392 – jdbc-pool is not returning the proxied connection in resultSet and statement','The proxy connection returned by the jdbc-pool is not proxying the resultSet and the statement so if the client gets access to the underlying connection through: \n\nresultSet.getStatement().getConnection()\n\nHe is able to close the physical connection due to both instances (resultSet and statement) were not proxied. \nIf this happens next time a client gets a connection from the jdbc-pool it will return a proxy with a physical connection closed.','2009-12-15 11:43:20','gfernandes','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 critical','4afd23d','Filip Hanik','2010-02-24 14:27:09','https://issues.apache.org/bugzilla/show_bug.cgi?id=48392 Add an interceptor to be able to wrap existing statements and result sets to prevent code from accessing the connection Patch submitted by gsfernandes@gmail.com','modules/jdbc-pool/doc/jdbc-pool.xml\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/interceptor/StatementDecoratorInterceptor.java'),(1492,48783,'Bug 48783 – JPDA defaults made better but help does not tell','Lines 46 and 49 in catalina.bat have not been changed when default JPDA options were made more useful. This is an issue of the Windows bat not Unix one.\n\nPlease change the documentation for the default JPDA_TRANSPORT to the actual dt_socket instead of dt_shmem.\nAlso change JPDA_ADDRESS from jdbconn to 8000','2010-02-20 17:05:14','Kamil Sevecek','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 trivial','0c6d744','Mark Emlyn David Thomas','2010-02-22 16:21:06','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48783 Correct defaults','bin/catalina.bat'),(1493,48616,'Bug 48616 – Struts 1.2 and bean:define tag throws jsp 1.1 regression exception','I\'m using Struts 1.2.\nI\'ve upgrade from tomcat 6.0.20 to 6.0.24 and nothing works.\n\nThe jsp compilation throws many error (i use the tag bean:define with same variable many times in jsp):\n\nDuring jsp precompilation:\n\n\"my_variable\" is already defined in _jspService(javax.servlet.http.HttpServletRequest,javax.servlet.http.HttpServletResponse)\n\nand at runtime:\n\n26-gen-2010 10.16.43 org.apache.catalina.core.ApplicationDispatcher invoke\nGRAVE: Servlet.service() for servlet jsp threw exception\norg.apache.jasper.JasperException: Unable to compile class for JSP: \n\nAn error occurred at line: 459 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 576 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 693 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 810 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 927 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 1.045 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 1.162 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 1.279 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 1.396 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 1.531 in the generated java file\nDuplicate local variable patientsExists\n\nAn error occurred at line: 1.660 in the generated java file\nDuplicate local variable patientsExists\n\nAn error occurred at line: 1.777 in the generated java file\nDuplicate local variable patientsExists\n\nAn error occurred at line: 1.897 in the generated java file\nDuplicate local variable multiportionExists\n\nAn error occurred at line: 2.014 in the generated java file\nDuplicate local variable multiportionExists\n\nAn error occurred at line: 2.131 in the generated java file\nDuplicate local variable multiportionExists\n\nAn error occurred at line: 2.251 in the generated java file\nDuplicate local variable generalExists\n\nAn error occurred at line: 2.368 in the generated java file\nDuplicate local variable generalExists\n\nAn error occurred at line: 2.485 in the generated java file\nDuplicate local variable generalExists\n\nAn error occurred at line: 2.605 in the generated java file\nDuplicate local variable messagesExists\n\nAn error occurred at line: 2.722 in the generated java file\nDuplicate local variable messagesExists\n\nAn error occurred at line: 2.842 in the generated java file\nDuplicate local variable printFindExists\n\nAn error occurred at line: 2.959 in the generated java file\nDuplicate local variable printFindExists\n\nStacktrace:\n        at org.apache.jasper.compiler.DefaultErrorHandler.javacError(DefaultErrorHandler.java:92)\n        at org.apache.jasper.compiler.ErrorDispatcher.javacError(ErrorDispatcher.java:330)\n        at org.apache.jasper.compiler.JDTCompiler.generateClass(JDTCompiler.java:439)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:334)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:312)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:299)\n        at org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:589)\n        at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:317)\n        at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)\n        at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)\n        at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:551)\n        at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:488)\n        at org.apache.jasper.runtime.JspRuntimeLibrary.include(JspRuntimeLibrary.java:968)\n        at org.apache.jsp.WEB_002dINF.pages.login.mainPage_jsp._jspService(mainPage_jsp.java:206)\n        at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n        at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:377)\n        at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)\n        at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)\n        at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:436)\n        at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:374)\n        at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:302)\n        at org.apache.struts.action.RequestProcessor.doForward(RequestProcessor.java:1062)\n        at org.apache.struts.action.RequestProcessor.processForwardConfig(RequestProcessor.java:386)\n        at org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:229)\n        at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1196)\n        at org.apache.struts.action.ActionServlet.doPost(ActionServlet.java:432)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)\n        at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:436)\n        at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:374)\n        at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:302)\n        at org.apache.struts.action.RequestProcessor.doForward(RequestProcessor.java:1062)\n        at org.apache.struts.action.RequestProcessor.processForwardConfig(RequestProcessor.java:386)\n        at org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:229)\n        at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1196)\n        at org.apache.struts.action.ActionServlet.doPost(ActionServlet.java:432)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at org.displaytag.filter.ResponseOverrideFilter.doFilter(ResponseOverrideFilter.java:125)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)\n        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)\n        at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:558)\n        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)\n        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)\n        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:298)\n        at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:852)\n        at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:588)\n        at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)\n        at java.lang.Thread.run(Thread.java:619)\n\n\n\nBefore upgrading to 6.0.24 all works fine.\n\nReading the documentation of bean:define in struts javadoc i see this message:\n\nUSAGE NOTE - There is a restriction in the JSP 1.1 Specification that disallows using the same value for an id attribute more than once in a single JSP page. Therefore, you will not be able to use <bean:define> for the same bean name more than once in a single page. \n\nBut i\'ve not specify any jsp version.\n\nSo, is this a tomcat 6.0.24 regression bug? \n\nI\'ve not particular compilation type/version specified in my app.','2010-01-26 01:22:58','agharta','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 blocker','eb06b92','Konstantin Kolinko','2010-02-16 20:10:34','Apply my patch from https://issues.apache.org/bugzilla/show_bug.cgi?id=48616#c20 This patch - Reverts r905145, - Provides an alternative fix for bug 48616 and bug 42390, - Replaces Vector -> List, Hashtable -> HashMap in the affected API.','java/org/apache/jasper/compiler/Generator.java\njava/org/apache/jasper/compiler/Node.java\njava/org/apache/jasper/compiler/ScriptingVariabler.java'),(1494,48616,'Bug 48616 – Struts 1.2 and bean:define tag throws jsp 1.1 regression exception','I\'m using Struts 1.2.\nI\'ve upgrade from tomcat 6.0.20 to 6.0.24 and nothing works.\n\nThe jsp compilation throws many error (i use the tag bean:define with same variable many times in jsp):\n\nDuring jsp precompilation:\n\n\"my_variable\" is already defined in _jspService(javax.servlet.http.HttpServletRequest,javax.servlet.http.HttpServletResponse)\n\nand at runtime:\n\n26-gen-2010 10.16.43 org.apache.catalina.core.ApplicationDispatcher invoke\nGRAVE: Servlet.service() for servlet jsp threw exception\norg.apache.jasper.JasperException: Unable to compile class for JSP: \n\nAn error occurred at line: 459 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 576 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 693 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 810 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 927 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 1.045 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 1.162 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 1.279 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 1.396 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 1.531 in the generated java file\nDuplicate local variable patientsExists\n\nAn error occurred at line: 1.660 in the generated java file\nDuplicate local variable patientsExists\n\nAn error occurred at line: 1.777 in the generated java file\nDuplicate local variable patientsExists\n\nAn error occurred at line: 1.897 in the generated java file\nDuplicate local variable multiportionExists\n\nAn error occurred at line: 2.014 in the generated java file\nDuplicate local variable multiportionExists\n\nAn error occurred at line: 2.131 in the generated java file\nDuplicate local variable multiportionExists\n\nAn error occurred at line: 2.251 in the generated java file\nDuplicate local variable generalExists\n\nAn error occurred at line: 2.368 in the generated java file\nDuplicate local variable generalExists\n\nAn error occurred at line: 2.485 in the generated java file\nDuplicate local variable generalExists\n\nAn error occurred at line: 2.605 in the generated java file\nDuplicate local variable messagesExists\n\nAn error occurred at line: 2.722 in the generated java file\nDuplicate local variable messagesExists\n\nAn error occurred at line: 2.842 in the generated java file\nDuplicate local variable printFindExists\n\nAn error occurred at line: 2.959 in the generated java file\nDuplicate local variable printFindExists\n\nStacktrace:\n        at org.apache.jasper.compiler.DefaultErrorHandler.javacError(DefaultErrorHandler.java:92)\n        at org.apache.jasper.compiler.ErrorDispatcher.javacError(ErrorDispatcher.java:330)\n        at org.apache.jasper.compiler.JDTCompiler.generateClass(JDTCompiler.java:439)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:334)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:312)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:299)\n        at org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:589)\n        at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:317)\n        at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)\n        at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)\n        at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:551)\n        at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:488)\n        at org.apache.jasper.runtime.JspRuntimeLibrary.include(JspRuntimeLibrary.java:968)\n        at org.apache.jsp.WEB_002dINF.pages.login.mainPage_jsp._jspService(mainPage_jsp.java:206)\n        at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n        at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:377)\n        at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)\n        at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)\n        at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:436)\n        at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:374)\n        at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:302)\n        at org.apache.struts.action.RequestProcessor.doForward(RequestProcessor.java:1062)\n        at org.apache.struts.action.RequestProcessor.processForwardConfig(RequestProcessor.java:386)\n        at org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:229)\n        at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1196)\n        at org.apache.struts.action.ActionServlet.doPost(ActionServlet.java:432)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)\n        at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:436)\n        at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:374)\n        at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:302)\n        at org.apache.struts.action.RequestProcessor.doForward(RequestProcessor.java:1062)\n        at org.apache.struts.action.RequestProcessor.processForwardConfig(RequestProcessor.java:386)\n        at org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:229)\n        at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1196)\n        at org.apache.struts.action.ActionServlet.doPost(ActionServlet.java:432)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at org.displaytag.filter.ResponseOverrideFilter.doFilter(ResponseOverrideFilter.java:125)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)\n        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)\n        at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:558)\n        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)\n        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)\n        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:298)\n        at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:852)\n        at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:588)\n        at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)\n        at java.lang.Thread.run(Thread.java:619)\n\n\n\nBefore upgrading to 6.0.24 all works fine.\n\nReading the documentation of bean:define in struts javadoc i see this message:\n\nUSAGE NOTE - There is a restriction in the JSP 1.1 Specification that disallows using the same value for an id attribute more than once in a single JSP page. Therefore, you will not be able to use <bean:define> for the same bean name more than once in a single page. \n\nBut i\'ve not specify any jsp version.\n\nSo, is this a tomcat 6.0.24 regression bug? \n\nI\'ve not particular compilation type/version specified in my app.','2010-01-26 01:22:58','agharta','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 blocker','eb06b92','Konstantin Kolinko','2010-02-16 20:10:34','Apply my patch from https://issues.apache.org/bugzilla/show_bug.cgi?id=48616#c20 This patch - Reverts r905145, - Provides an alternative fix for bug 48616 and bug 42390, - Replaces Vector -> List, Hashtable -> HashMap in the affected API.','java/org/apache/jasper/compiler/Generator.java\njava/org/apache/jasper/compiler/Node.java\njava/org/apache/jasper/compiler/ScriptingVariabler.java'),(1495,42390,'Bug 42390 – JSP compilation error with nested tagfile tags with variables with \"AT_BEGIN\" scope','Given a tagfile \"test.tag\" in /WEB-INF/tags/t:\n---- begin test.tag ----\n<%@ variable name-given=\"X\" scope=\"AT_BEGIN\" %>\n<jsp:doBody/>\n---- end test.tag ----\nthe following JSP \"testTest.jsp\":\n---- begin testTest.jsp ----\n<t:test><t:test/></t:test>\n---- end testTest.jsp ----\ngives a JSP compilation error:\norg.apache.jasper.JasperException: Unable to compile class for JSP: \nStacktrace:\n        at\norg.apache.jasper.compiler.DefaultErrorHandler.javacError(DefaultErrorHandler.java:85)\n        at\norg.apache.jasper.compiler.ErrorDispatcher.javacError(ErrorDispatcher.java:330)\n        at\norg.apache.jasper.compiler.JDTCompiler.generateClass(JDTCompiler.java:435)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:298)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:277)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:265)\n        at\norg.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:564)\n        at\norg.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:299)\n        at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:315)\n        at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:265)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:803)\n        at\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:269)\n        at\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:188)\n        at\norg.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:210)\n        at\norg.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:174)\n        at\norg.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)\n        at\norg.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:117)\n        at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:542)\n        at\norg.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:108)\n        at\norg.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:151)\n        at\norg.apache.coyote.http11.Http11Processor.process(Http11Processor.java:870)\n        at\norg.apache.coyote.http11.Http11BaseProtocol$Http11ConnectionHandler.processConnection(Http11BaseProtocol.java:665)\n        at\norg.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:528)\n        at\norg.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:81)\n        at\norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:685)\n        at java.lang.Thread.run(Thread.java:613)','2007-05-11 00:59:37','MicroNova YUZU Team','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P1 major','eb06b92','Konstantin Kolinko','2010-02-16 20:10:34','Apply my patch from https://issues.apache.org/bugzilla/show_bug.cgi?id=48616#c20 This patch - Reverts r905145, - Provides an alternative fix for bug 48616 and bug 42390, - Replaces Vector -> List, Hashtable -> HashMap in the affected API.','java/org/apache/jasper/compiler/Generator.java\njava/org/apache/jasper/compiler/Node.java\njava/org/apache/jasper/compiler/ScriptingVariabler.java'),(1496,48629,'Bug 48629 – JNDIRealm and roleNested doesn\'t work with roleSearch=\"(member={1})\"','','2010-01-27 13:35:47','tahitiangabriel','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 minor','8e6106c','Mark Emlyn David Thomas','2010-02-16 16:15:21','Revert r904914. https://issues.apache.org/bugzilla/show_bug.cgi?id=48629  now proposes a better solution','java/org/apache/catalina/realm/JNDIRealm.java'),(1497,48589,'Bug 48589 – org.apache.catalina.realm.JNDIRealm User class should be accessible from sub-classes','','2010-01-21 07:49:57','Candid Dauth','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','3d04b5b','Mark Emlyn David Thomas','2010-02-16 06:40:55','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48589 Make JNDIRealm easier to extend by making the User class protected Based on a patch by Candid Dauth','java/org/apache/catalina/realm/JNDIRealm.java'),(1498,48582,'Bug 48582 – JspServletWrapper.getServletContext() throws NullPointerException','','2010-01-20 13:25:03','Tim McCune','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 major','7301a10','Mark Emlyn David Thomas','2010-02-16 06:07:00','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48582 Avoid NPE as config may be null but ctxt won\'t be','java/org/apache/jasper/servlet/JspServletWrapper.java'),(1499,48580,'Bug 48580 – 6.0.24: AccessControlException in ProtectedFunctionMapper on first access to certain JSP','','2010-01-20 11:54:45','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','9e55819','Mark Emlyn David Thomas','2010-02-16 04:27:49','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48580 Prevent AccessControlException if first access is to a JSP that uses a FunctionMapper','java/org/apache/jasper/security/SecurityClassLoad.java'),(1500,48616,'Bug 48616 – Struts 1.2 and bean:define tag throws jsp 1.1 regression exception','I\'m using Struts 1.2.\nI\'ve upgrade from tomcat 6.0.20 to 6.0.24 and nothing works.\n\nThe jsp compilation throws many error (i use the tag bean:define with same variable many times in jsp):\n\nDuring jsp precompilation:\n\n\"my_variable\" is already defined in _jspService(javax.servlet.http.HttpServletRequest,javax.servlet.http.HttpServletResponse)\n\nand at runtime:\n\n26-gen-2010 10.16.43 org.apache.catalina.core.ApplicationDispatcher invoke\nGRAVE: Servlet.service() for servlet jsp threw exception\norg.apache.jasper.JasperException: Unable to compile class for JSP: \n\nAn error occurred at line: 459 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 576 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 693 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 810 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 927 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 1.045 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 1.162 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 1.279 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 1.396 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 1.531 in the generated java file\nDuplicate local variable patientsExists\n\nAn error occurred at line: 1.660 in the generated java file\nDuplicate local variable patientsExists\n\nAn error occurred at line: 1.777 in the generated java file\nDuplicate local variable patientsExists\n\nAn error occurred at line: 1.897 in the generated java file\nDuplicate local variable multiportionExists\n\nAn error occurred at line: 2.014 in the generated java file\nDuplicate local variable multiportionExists\n\nAn error occurred at line: 2.131 in the generated java file\nDuplicate local variable multiportionExists\n\nAn error occurred at line: 2.251 in the generated java file\nDuplicate local variable generalExists\n\nAn error occurred at line: 2.368 in the generated java file\nDuplicate local variable generalExists\n\nAn error occurred at line: 2.485 in the generated java file\nDuplicate local variable generalExists\n\nAn error occurred at line: 2.605 in the generated java file\nDuplicate local variable messagesExists\n\nAn error occurred at line: 2.722 in the generated java file\nDuplicate local variable messagesExists\n\nAn error occurred at line: 2.842 in the generated java file\nDuplicate local variable printFindExists\n\nAn error occurred at line: 2.959 in the generated java file\nDuplicate local variable printFindExists\n\nStacktrace:\n        at org.apache.jasper.compiler.DefaultErrorHandler.javacError(DefaultErrorHandler.java:92)\n        at org.apache.jasper.compiler.ErrorDispatcher.javacError(ErrorDispatcher.java:330)\n        at org.apache.jasper.compiler.JDTCompiler.generateClass(JDTCompiler.java:439)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:334)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:312)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:299)\n        at org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:589)\n        at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:317)\n        at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)\n        at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)\n        at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:551)\n        at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:488)\n        at org.apache.jasper.runtime.JspRuntimeLibrary.include(JspRuntimeLibrary.java:968)\n        at org.apache.jsp.WEB_002dINF.pages.login.mainPage_jsp._jspService(mainPage_jsp.java:206)\n        at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n        at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:377)\n        at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)\n        at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)\n        at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:436)\n        at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:374)\n        at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:302)\n        at org.apache.struts.action.RequestProcessor.doForward(RequestProcessor.java:1062)\n        at org.apache.struts.action.RequestProcessor.processForwardConfig(RequestProcessor.java:386)\n        at org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:229)\n        at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1196)\n        at org.apache.struts.action.ActionServlet.doPost(ActionServlet.java:432)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)\n        at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:436)\n        at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:374)\n        at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:302)\n        at org.apache.struts.action.RequestProcessor.doForward(RequestProcessor.java:1062)\n        at org.apache.struts.action.RequestProcessor.processForwardConfig(RequestProcessor.java:386)\n        at org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:229)\n        at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1196)\n        at org.apache.struts.action.ActionServlet.doPost(ActionServlet.java:432)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at org.displaytag.filter.ResponseOverrideFilter.doFilter(ResponseOverrideFilter.java:125)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)\n        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)\n        at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:558)\n        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)\n        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)\n        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:298)\n        at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:852)\n        at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:588)\n        at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)\n        at java.lang.Thread.run(Thread.java:619)\n\n\n\nBefore upgrading to 6.0.24 all works fine.\n\nReading the documentation of bean:define in struts javadoc i see this message:\n\nUSAGE NOTE - There is a restriction in the JSP 1.1 Specification that disallows using the same value for an id attribute more than once in a single JSP page. Therefore, you will not be able to use <bean:define> for the same bean name more than once in a single page. \n\nBut i\'ve not specify any jsp version.\n\nSo, is this a tomcat 6.0.24 regression bug? \n\nI\'ve not particular compilation type/version specified in my app.','2010-01-26 01:22:58','agharta','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 blocker','9470327','Konstantin Kolinko','2010-02-15 23:52:38','Additional test for BZ 48616','test/org/apache/jasper/compiler/TestScriptingVariabler.java\ntest/webapp/bug48616b.jsp'),(1501,48498,'Bug 48498 – 6.0.22RC: ArrayIndexOutOfBoundsException from Jasper when compilation error inside a CDATA block','','2010-01-06 19:40:54','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','789ac1e','Mark Emlyn David Thomas','2010-02-15 19:46:07','Workaround Java 6/7 bug described in https://issues.apache.org/bugzilla/show_bug.cgi?id=48498 Avoid the ArrayIndexOutOfBoundsException','java/org/apache/jasper/compiler/JavacErrorDetail.java\njava/org/apache/jasper/resources/LocalStrings.properties'),(1502,48545,'Bug 48545 – truststorePass used in JSSESocketFactory should be optional (nillable)','','2010-01-14 07:58:48','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','cf857a0','Mark Emlyn David Thomas','2010-02-15 12:14:27','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48545 Truststores don\'t have to have passwords Based on a patch by \'smmwpf54\'','java/org/apache/tomcat/util/net/jsse/JSSESocketFactory.java\nwebapps/docs/config/http.xml'),(1503,48384,'Bug 48384 – globalXsltFile parameter for the DefaultServlet','When overriding the DefaultServlet for a given application, the globalXsltFile path need to be relative to Tomcat root.\n\nfor example:\n<init-param>\n<param-name>globalXsltFile</param-name>\n<param-value>webapps/quercus/WEB-INF/listing.xsl</param-value>\n</init-param>\n\nit would be nice if the path could be relative to the application context.','2009-12-13 16:24:30','h3xstream','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 trivial','0e595cf','Mark Emlyn David Thomas','2010-02-13 15:12:11','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48384 Add a per context xslt option for directory listings Make the fallback options work as described in the docs','conf/web.xml\njava/org/apache/catalina/servlets/DefaultServlet.java\nwebapps/docs/default-servlet.xml'),(1504,48371,'Bug 48371 – addWebXmlMappings does not place servlet tags correctly','If there is a commented-out <security-constraint> or commented-out <servlet> tag and addWebXmlMappings=\"true\", the JSP\'s servlet and servlet-mapping tags are placed incorrectly and Tomcat will not start due to \"--\" being inside a comment.\n\nBasically, it seems the web.xml is not parsed correctly when using addWebXmlMappings and you cannot have above tags commented out, or new servlet tags will be placed incorrectly and comment tags not respected.','2009-12-10 18:16:34','Lee Clemens','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 minor','563e315','Mark Emlyn David Thomas','2010-02-13 13:25:07','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48371 Skip comments when working out where to insert generated servlets and associated mappings','java/org/apache/jasper/JspC.java'),(1505,48318,'Bug 48318 – WebDAV servlet returns 500 if files not readable','If a directory contains a file that is not readable by the Tomcat\nprocess (eg file permissions, dangling symlink) then Tomcat throws a\nNullPointerException and returns a 500 Internal Server Error to the\nclient.\n\nThrowing NPE in these circumstances is certainly wrong.  Returning 500\nwith no further information is unhelpful behavior and should be fixed.\nGenerally, interfaces of this type at least list inaccessible files\n(Windows Explorer, UNIX ls(1), BSD FTP client, ...) and only return an\nerror when one attempts to access such a file.\n\nmarkt suggests an alternative of simply ignoring inaccessible files but notes\nthat \"could cause issues if a user tries to upload a file of that name\" and\nsuggests better error reporting.\n\n\nStack:\n\n    SEVERE: Servlet.service() for servlet webdav threw exception\n    java.lang.NullPointerException\n            at org.apache.catalina.servlets.WebdavServlet.parseProperties(Unknown Source)\n            at org.apache.catalina.servlets.WebdavServlet.doPropfind(Unknown Source)\n            at org.apache.catalina.servlets.WebdavServlet.service(Unknown Source)\n            at javax.servlet.http.HttpServlet.service(Unknown Source)\n            ...\n\n\nMethod parseProperties() is in\njava/org/apache/catalina/servlets/WebdavServlet.java.org and the NPE\nhappens when cacheEntry.attributes is null (case FIND_BY_PROPERTY in my\ntesting and possibly in other cases too).\n\nFollowing the breadcrumbs via:\n\n    cacheEntry = resources.lookupCache(path);\n\nleads eventually to java/org/apache/naming/resources/FileDirContext.java:\n\n    public Attributes getAttributes(String name, String[] attrIds)\n        throws NamingException {\n        // Building attribute list\n        File file = file(name);\n        if (file == null)\n            throw new NamingException\n                (sm.getString(\"resources.notFound\", name));\n    ...\n    protected File file(String name) {\n        File file = new File(base, name);\n        if (file.exists() && file.canRead()) {\n            ... // do useful stuff\n        } else {\n            return null; // ouch\n        }','2009-12-01 07:07:07','Martin Carpenter','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Servlet & JSP API','P2 normal','da42e44','Mark Emlyn David Thomas','2010-02-12 17:12:48','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48318 Handle case where WebDAV resource is in directory listing but is not accessible','java/org/apache/catalina/servlets/WebdavServlet.java'),(1506,48726,'Bug 48726 – DeployTask throws OutOfMemoryErrors when deploying large WAR files','','2010-02-10 22:46:18','adam','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Manager application','P2 major','53e0674','Mark Emlyn David Thomas','2010-02-10 18:47:11','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48726 Prevent OOME when uploading large files with the deployer Patch provided by \'adam\'','java/org/apache/catalina/ant/AbstractCatalinaTask.java\njava/org/apache/catalina/ant/DeployTask.java'),(1507,48716,'Bug 48716 – Embedded Tomcat JULI aggressively resetting default logging configuration','When using Tomcat embedded in conjunction with default JDK logging, any removal of a StandardContext instance from the Host container will lead to a reset of all JDK logging configuration.\n\nThis is due to \n\nStandardContext.stop() \n\ncalling \n\nWebappLoader.stop() \n\ncalling \n\norg.apache.juli.logging.LogFactory.release(ClassLoader) \n\nwhich in turn calls \n\nLogManager.getLogManager().reset();\n\nand the fact that, when using JDK logging, LogManager.getLogManager returns the default log manager rather that JULI\'s log manager. \n\nSuggestion: Check whether the log manager is actually JULI\'s.','2010-02-09 14:29:26','Henning Blohm','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','00dd2de','Mark Emlyn David Thomas','2010-02-10 18:36:51','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48716 Provide an undocumented \'shoot yourself in the foot\' option to disable the JULI logging reset','java/org/apache/catalina/loader/WebappClassLoader.java'),(1508,48694,'Bug 48694 – WebappClassLoader deadlock if web application uses it\'s own classloader','','2010-02-07 23:52:07','Eugene Petrenko','Tomcat Developers Mailing List','','Tomcat 6','Catalina','P2 normal','515be4e','Mark Emlyn David Thomas','2010-02-10 17:41:55','Part of fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=48694 that is not in trunk','java/org/apache/catalina/loader/WebappClassLoader.java'),(1509,48170,'Bug 48170 – Unnecessary synchronization by JspFactory.getDefaultFactory contributes to stability problems','I have a soak test at constant load that is initially stable.  Within the hour, an ever increasing number of blocked threads develops.  The vast majority of threads are in JSP rendering, blocked on JspFactory.getDefaultFactory().\n\nThe server eventually crashes.\n\nWe are running Java 6.\n\nUpon code inspection, there appears to be no real reason for synchronizing the getDefaultFactory() and setDefaultFactory() as the setter is called only once upon startup when the sub-class loads.\n\nPatching the jar, I tried three other experiments:\n1) Removing the synchronized keyword entirely.\n2) Locking on an inner static class instead of the JspFactory.class.\n3) Using volatile for the static member variable.\n\nBoth experiments #1 and #3 showed vastly better stability.  I was able to double the throughput of the server without seeing increasing number of blocked threads.\n\nExperiment #2 yielded the same behavior as the original code.  Thus, no other code\nis synchronizing on JspFactory.class.  Rather, there seem to be some sort of contention in the java.lang.Class monitor.\n\nUsing volatile would preserve the multi-threading semantics while avoiding contributing to the instability issue.','2009-11-10 18:04:01','Earl Nolan','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 major','c09753b','Mark Emlyn David Thomas','2010-02-08 17:20:55','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48170 Remove unnecessary syncs that cause issues under heavy load','java/javax/servlet/jsp/JspFactory.java'),(1510,48109,'Bug 48109 – Improve binaryStream processing in WebappClassLoader#findResourceInternal','','2009-11-02 19:49:49','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 minor','dda2cbc','Mark Emlyn David Thomas','2010-02-08 17:07:24','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48109 Extent try catch block (diff is a lot simpler if you ignore whitespace) to ensure InputStream is closed.','java/org/apache/catalina/loader/WebappClassLoader.java'),(1511,48660,'Bug 48660 – Connector compression=on overwrites Vary header','When compressing the connector sets the \"Vary: Accept-Encoding\".  I think it would be more correct to append \"Accept-Encoding\" the the current value of the Vary header instead of replacing it. \n\nIn particular, I cannot set this header to \"Cookie\" to force reload of the page if the JSESSIONID cookie changes','2010-02-02 13:40:54','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 normal','ce0670a','Mark Emlyn David Thomas','2010-02-07 21:27:43','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48660 Compression should add to Vary header rather than over-write it','java/org/apache/coyote/http11/Http11AprProcessor.java\njava/org/apache/coyote/http11/Http11NioProcessor.java\njava/org/apache/coyote/http11/Http11Processor.java'),(1512,48665,'Bug 48665 – RemoteIpValve examples refer to \"connector\" package','','2010-02-03 03:38:00','Bjarni Thorbjornsson','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P2 normal','9905155','Mark Emlyn David Thomas','2010-02-07 21:06:49','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48665 Correct package in Javadoc Patch provided by Cyrille Le Clerc','java/org/apache/catalina/valves/RemoteIpValve.java'),(1513,48668,'Bug 48668 – Template text that looks like a deferred expression can be mishandled even if EL is ignored','In some cases text that happens to look similar to a deferred expression (#{..}) can get mangled even if the EL is not active. This appears to only happen if the text in question immediately proceeds a custom tag (either a full blown custom tag or a simple .tag file tag). The initial # and { characters get removed.\n\nThis happens in Tomcat v6.0.24 but did not happen in v6.0.20 so appears to be unintentional.\n\nWe have been upgrading legacy sites to Tomcat v6 and have hit this problem.\n\nThis problem can be recreated in a bog standard install of Tomcat v6.0.24. Create a simple .tag file that does nothing more than say \'hello\'. Place a reference to this tag into a JSP with the offending text immediately after it. \n\nA test JSP that looks something like (note that EL is being ignored)...\n\n<%@ page isELIgnored=\"true\" %>\n<%@ taglib tagdir=\"/WEB-INF/tags/custom\" prefix=\"custom\" %>\n<html>\n<title>Test</title>\n</head>\n<body>\n  <custom:example />#{foo.bar}\n</body>\n</html>\n\nWhere the custom example tag (/WEB-INF/tags/custom/example.tag) looks like this...\n\nHello\n\nRather than the page returning the following...\n\n<html>\n<title>Test</title>\n</head>\n<body>\n  Hello#{foo.bar}\n</body>\n</html>\n\nIt will return...\n\n<html>\n<title>Test</title>\n</head>\n<body>\n  Hellofoo.bar}\n</body>\n</html>\n\nNotice the missing # and { from the text.\n\nI don\'t believe the platform Tomcat is running on matters. Have seen this behaviour on both Mac OS X and Linux.','2010-02-03 09:22:59','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 minor','9252d96','Mark Emlyn David Thomas','2010-02-07 21:00:58','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48668 Don\'t look for EL matches (which swallow the EL match string) if EL is not enabled','java/org/apache/jasper/compiler/Parser.java'),(1514,48668,'Bug 48668 – Template text that looks like a deferred expression can be mishandled even if EL is ignored','In some cases text that happens to look similar to a deferred expression (#{..}) can get mangled even if the EL is not active. This appears to only happen if the text in question immediately proceeds a custom tag (either a full blown custom tag or a simple .tag file tag). The initial # and { characters get removed.\n\nThis happens in Tomcat v6.0.24 but did not happen in v6.0.20 so appears to be unintentional.\n\nWe have been upgrading legacy sites to Tomcat v6 and have hit this problem.\n\nThis problem can be recreated in a bog standard install of Tomcat v6.0.24. Create a simple .tag file that does nothing more than say \'hello\'. Place a reference to this tag into a JSP with the offending text immediately after it. \n\nA test JSP that looks something like (note that EL is being ignored)...\n\n<%@ page isELIgnored=\"true\" %>\n<%@ taglib tagdir=\"/WEB-INF/tags/custom\" prefix=\"custom\" %>\n<html>\n<title>Test</title>\n</head>\n<body>\n  <custom:example />#{foo.bar}\n</body>\n</html>\n\nWhere the custom example tag (/WEB-INF/tags/custom/example.tag) looks like this...\n\nHello\n\nRather than the page returning the following...\n\n<html>\n<title>Test</title>\n</head>\n<body>\n  Hello#{foo.bar}\n</body>\n</html>\n\nIt will return...\n\n<html>\n<title>Test</title>\n</head>\n<body>\n  Hellofoo.bar}\n</body>\n</html>\n\nNotice the missing # and { from the text.\n\nI don\'t believe the platform Tomcat is running on matters. Have seen this behaviour on both Mac OS X and Linux.','2010-02-03 09:22:59','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 minor','6e2e25d','Mark Emlyn David Thomas','2010-02-07 20:58:06','Add test cases for bug 48668','test/org/apache/jasper/compiler/TestParser.java\ntest/webapp/bug48668a.jsp\ntest/webapp/bug48668b.jsp'),(1515,48672,'Bug 48672 – Tomcat Virtual Host Manager (/host-manager) have broken \"Host Manager Help\" link.','When in /host-manager application one wants to see \"Host Manager Help\", link leads to 404 page.\nMaybe we should supply \"/host-manager/../docs/virtual-hosting-howto.html\" instead of non working \"/host-manager/../docs/host-manager-howto.html\".','2010-02-03 10:42:20','Peter Skopek','Tomcat Developers Mailing List','NEW','Tomcat 6','Manager application','P2 enhancement','aee42ef','Mark Emlyn David Thomas','2010-02-07 18:30:45','As pointed out by bug https://issues.apache.org/bugzilla/show_bug.cgi?id=48672, the host-manager application docs do not exist. Make this clear.','java/org/apache/catalina/manager/host/LocalStrings.properties'),(1516,48643,'Bug 48643 – catalina.session.FileStore.save() and load() - close() bugs','The code for the save() method reads:\n\ntry {\n    fos = new FileOutputStream(file.getAbsolutePath());\n    oos = new ObjectOutputStream(new BufferedOutputStream(fos));\n} catch (IOException e) {\n    if (oos != null) { <== oos can only be null here\n        try {\n            oos.close();\n        } catch (IOException f) {\n            // Ignore\n        }\n    }\n    throw e;\n}\n\nPresumably the catch statement should try to close fos instead?\n\nSimilarly for the load() method; at line 280/281 there is the code:\n\n        } catch (IOException e) {\n            if (ois != null) {\n\nHowever, ois is the last object created by the try clause, so must be null.\nProbably the code should check and close bis and/or fis.\n\nAt the end of the load() method, the code says:\n\n            // Close the input stream\n            if (ois != null) {\n\nHowever, ois cannot be null at that point.\n\nNote: these bugs were detected by the Eclipse compiler.','2010-01-30 16:53:02','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','6f48cde','Mark Emlyn David Thomas','2010-02-07 17:16:40','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48643 Clean up','java/org/apache/catalina/session/FileStore.java\njava/org/apache/catalina/session/StandardManager.java'),(1517,48678,'Bug 48678 – org.apache.catalina.startup.Catalina incorrectly duplicates super class member','','2010-02-04 00:09:04','Henning Blohm','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','067e0ba','Mark Emlyn David Thomas','2010-02-06 16:34:12','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48678 StandardService already defines server. Having two in the type hierarchy just causes confusion','java/org/apache/catalina/startup/Catalina.java'),(1518,48658,'Bug 48658 – Save test output in files; allow single test to be run','','2010-02-02 07:34:06','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','25df235','Mark Emlyn David Thomas','2010-02-06 15:19:27','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48658 Save test output in files; allow single test to be run Patch provided by sebb','build.xml'),(1519,48039,'Bug 48039 – org.apache.catalina.core.StandardService start method doesn\'t return immediately when it has started already','Below is the relevant part of source code:\n\npublic void start() throws LifecycleException {\n\n        // Validate and update our current component state\n        if (log.isInfoEnabled() && started) {\n            log.info(sm.getString(\"standardService.start.started\"));\n        }\n        \n        if( ! initialized )\n            init(); \n\nIs it reasonable that start() method should return immediately?\n\nI checked the start() methods in StandardServer, StandardEngine, StandardHost and StandardContext, and found that they all return immediately if \'started\' has been true.','2009-10-21 19:12:53','qingyang.xu','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 minor','89b1581','Mark Emlyn David Thomas','2010-02-02 12:45:18','Correct fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=48039 Return immediately if already started','java/org/apache/catalina/core/StandardService.java'),(1520,48050,'Bug 48050 – org.apache.naming.NamingContext\'s createSubcontext method returns Context with wrong name','Below is the original source code of org.apache.naming.NamingContext\'s createSubcontext(Name name) method:\n\n/**\n     * Creates and binds a new context. Creates a new context with the given \n     * name and binds it in the target context (that named by all but \n     * terminal atomic component of the name). All intermediate contexts and \n     * the target context must already exist.\n     * \n     * @param name the name of the context to create; may not be empty\n     * @return the newly created context\n     * @exception NameAlreadyBoundException if name is already bound\n     * @exception InvalidAttributesException if creation of the subcontext \n     * requires specification of mandatory attributes\n     * @exception NamingException if a naming exception is encountered\n     */\n    public Context createSubcontext(Name name)\n        throws NamingException {\n        checkWritable();\n        \n        Context newContext = new NamingContext(env, this.name);\n        bind(name, newContext);\n        \n        return newContext;\n    }\n\nHowever, the returned NamingContext has the same name with its parent NamingContext. I suggest change the source code to below:\n\n    public Context createSubcontext(Name name)\n        throws NamingException {\n        checkWritable();\n        \n        Context newContext = new NamingContext(env, name.get(name.size() - 1));\n        bind(name, newContext);\n        \n        return newContext;\n    }','2009-10-25 10:26:17','qingyang.xu','Tomcat Developers Mailing List','RESOLVED INVALID','Tomcat 6','Catalina','P2 minor','66fa6d7','Mark Emlyn David Thomas','2010-02-02 12:39:11','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48050 createSubcontext method returns Context with wrong name Based on a suggestion by gingyang.xu','java/org/apache/naming/NamingContext.java'),(1521,48039,'Bug 48039 – org.apache.catalina.core.StandardService start method doesn\'t return immediately when it has started already','Below is the relevant part of source code:\n\npublic void start() throws LifecycleException {\n\n        // Validate and update our current component state\n        if (log.isInfoEnabled() && started) {\n            log.info(sm.getString(\"standardService.start.started\"));\n        }\n        \n        if( ! initialized )\n            init(); \n\nIs it reasonable that start() method should return immediately?\n\nI checked the start() methods in StandardServer, StandardEngine, StandardHost and StandardContext, and found that they all return immediately if \'started\' has been true.','2009-10-21 19:12:53','qingyang.xu','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 minor','0cc94d6','Mark Emlyn David Thomas','2010-02-02 12:27:00','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48039 Return immediately if already started','java/org/apache/catalina/core/StandardService.java'),(1522,48551,'Bug 48551 – StringCache: Use entrySet() rather than keySet() + get()','','2010-01-14 19:23:43','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','c85e791','Mark Emlyn David Thomas','2010-02-02 12:21:23','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48551 Use entrySet() rather than keySet() + get() Patch provided by sebb','java/org/apache/catalina/deploy/WebXml.java\njava/org/apache/tomcat/util/buf/StringCache.java'),(1523,48653,'Bug 48653 – RemoteIpValve : request.secure and request.scheme are not forced to \"false\" and \"http\" if X-Forwarded-Proto=http','','2010-02-01 09:26:02','Cyrille Le Clerc','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','1789bd8','Mark Emlyn David Thomas','2010-02-02 08:28:55','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48653 RemoteIpValve : request.secure and request.scheme are not forced to \"false\" and \"http\" if X-Forwarded-Proto=http Patch provided by Cyrille Le Clerc','java/org/apache/catalina/valves/RemoteIpValve.java\njava/org/apache/catalina/valves/mbeans-descriptors.xml\ntest/org/apache/catalina/valves/TestRemoteIpValve.java\nwebapps/docs/config/valve.xml'),(1524,48647,'Bug 48647 – RemoteIpFilter : request.secure and request.scheme are not forced to \"false\" and \"http\" if X-Forwarded-Proto=http','','2010-01-31 16:28:21','Cyrille Le Clerc','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','7aa1206','Mark Emlyn David Thomas','2010-02-02 08:25:42','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48647 RemoteIpFilter : request.secure and request.scheme are not forced to \"false\" and \"http\" if X-Forwarded-Proto=http Patch provided by Cyrille Le Clerc','java/org/apache/catalina/filters/RemoteIpFilter.java\nwebapps/docs/config/filter.xml'),(1525,48616,'Bug 48616 – Struts 1.2 and bean:define tag throws jsp 1.1 regression exception','I\'m using Struts 1.2.\nI\'ve upgrade from tomcat 6.0.20 to 6.0.24 and nothing works.\n\nThe jsp compilation throws many error (i use the tag bean:define with same variable many times in jsp):\n\nDuring jsp precompilation:\n\n\"my_variable\" is already defined in _jspService(javax.servlet.http.HttpServletRequest,javax.servlet.http.HttpServletResponse)\n\nand at runtime:\n\n26-gen-2010 10.16.43 org.apache.catalina.core.ApplicationDispatcher invoke\nGRAVE: Servlet.service() for servlet jsp threw exception\norg.apache.jasper.JasperException: Unable to compile class for JSP: \n\nAn error occurred at line: 459 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 576 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 693 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 810 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 927 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 1.045 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 1.162 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 1.279 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 1.396 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 1.531 in the generated java file\nDuplicate local variable patientsExists\n\nAn error occurred at line: 1.660 in the generated java file\nDuplicate local variable patientsExists\n\nAn error occurred at line: 1.777 in the generated java file\nDuplicate local variable patientsExists\n\nAn error occurred at line: 1.897 in the generated java file\nDuplicate local variable multiportionExists\n\nAn error occurred at line: 2.014 in the generated java file\nDuplicate local variable multiportionExists\n\nAn error occurred at line: 2.131 in the generated java file\nDuplicate local variable multiportionExists\n\nAn error occurred at line: 2.251 in the generated java file\nDuplicate local variable generalExists\n\nAn error occurred at line: 2.368 in the generated java file\nDuplicate local variable generalExists\n\nAn error occurred at line: 2.485 in the generated java file\nDuplicate local variable generalExists\n\nAn error occurred at line: 2.605 in the generated java file\nDuplicate local variable messagesExists\n\nAn error occurred at line: 2.722 in the generated java file\nDuplicate local variable messagesExists\n\nAn error occurred at line: 2.842 in the generated java file\nDuplicate local variable printFindExists\n\nAn error occurred at line: 2.959 in the generated java file\nDuplicate local variable printFindExists\n\nStacktrace:\n        at org.apache.jasper.compiler.DefaultErrorHandler.javacError(DefaultErrorHandler.java:92)\n        at org.apache.jasper.compiler.ErrorDispatcher.javacError(ErrorDispatcher.java:330)\n        at org.apache.jasper.compiler.JDTCompiler.generateClass(JDTCompiler.java:439)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:334)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:312)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:299)\n        at org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:589)\n        at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:317)\n        at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)\n        at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)\n        at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:551)\n        at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:488)\n        at org.apache.jasper.runtime.JspRuntimeLibrary.include(JspRuntimeLibrary.java:968)\n        at org.apache.jsp.WEB_002dINF.pages.login.mainPage_jsp._jspService(mainPage_jsp.java:206)\n        at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n        at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:377)\n        at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)\n        at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)\n        at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:436)\n        at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:374)\n        at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:302)\n        at org.apache.struts.action.RequestProcessor.doForward(RequestProcessor.java:1062)\n        at org.apache.struts.action.RequestProcessor.processForwardConfig(RequestProcessor.java:386)\n        at org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:229)\n        at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1196)\n        at org.apache.struts.action.ActionServlet.doPost(ActionServlet.java:432)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)\n        at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:436)\n        at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:374)\n        at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:302)\n        at org.apache.struts.action.RequestProcessor.doForward(RequestProcessor.java:1062)\n        at org.apache.struts.action.RequestProcessor.processForwardConfig(RequestProcessor.java:386)\n        at org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:229)\n        at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1196)\n        at org.apache.struts.action.ActionServlet.doPost(ActionServlet.java:432)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at org.displaytag.filter.ResponseOverrideFilter.doFilter(ResponseOverrideFilter.java:125)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)\n        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)\n        at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:558)\n        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)\n        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)\n        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:298)\n        at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:852)\n        at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:588)\n        at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)\n        at java.lang.Thread.run(Thread.java:619)\n\n\n\nBefore upgrading to 6.0.24 all works fine.\n\nReading the documentation of bean:define in struts javadoc i see this message:\n\nUSAGE NOTE - There is a restriction in the JSP 1.1 Specification that disallows using the same value for an id attribute more than once in a single JSP page. Therefore, you will not be able to use <bean:define> for the same bean name more than once in a single page. \n\nBut i\'ve not specify any jsp version.\n\nSo, is this a tomcat 6.0.24 regression bug? \n\nI\'ve not particular compilation type/version specified in my app.','2010-01-26 01:22:58','agharta','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 blocker','a4ce585','Mark Emlyn David Thomas','2010-01-31 19:04:40','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48616, a regression caused by the fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=42390 The requirement for variable declaration also depends on whether or not a fragment helper has been used for the parent tag (if any). Where such a helper has been used, the variables must be redefined. Test cases for both bugs and the JSP TCK pass with this patch applied.','java/org/apache/jasper/compiler/Generator.java\njava/org/apache/jasper/compiler/ScriptingVariabler.java'),(1526,42390,'Bug 42390 – JSP compilation error with nested tagfile tags with variables with \"AT_BEGIN\" scope','Given a tagfile \"test.tag\" in /WEB-INF/tags/t:\n---- begin test.tag ----\n<%@ variable name-given=\"X\" scope=\"AT_BEGIN\" %>\n<jsp:doBody/>\n---- end test.tag ----\nthe following JSP \"testTest.jsp\":\n---- begin testTest.jsp ----\n<t:test><t:test/></t:test>\n---- end testTest.jsp ----\ngives a JSP compilation error:\norg.apache.jasper.JasperException: Unable to compile class for JSP: \nStacktrace:\n        at\norg.apache.jasper.compiler.DefaultErrorHandler.javacError(DefaultErrorHandler.java:85)\n        at\norg.apache.jasper.compiler.ErrorDispatcher.javacError(ErrorDispatcher.java:330)\n        at\norg.apache.jasper.compiler.JDTCompiler.generateClass(JDTCompiler.java:435)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:298)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:277)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:265)\n        at\norg.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:564)\n        at\norg.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:299)\n        at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:315)\n        at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:265)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:803)\n        at\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:269)\n        at\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:188)\n        at\norg.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:210)\n        at\norg.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:174)\n        at\norg.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)\n        at\norg.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:117)\n        at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:542)\n        at\norg.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:108)\n        at\norg.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:151)\n        at\norg.apache.coyote.http11.Http11Processor.process(Http11Processor.java:870)\n        at\norg.apache.coyote.http11.Http11BaseProtocol$Http11ConnectionHandler.processConnection(Http11BaseProtocol.java:665)\n        at\norg.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:528)\n        at\norg.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:81)\n        at\norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:685)\n        at java.lang.Thread.run(Thread.java:613)','2007-05-11 00:59:37','MicroNova YUZU Team','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P1 major','a4ce585','Mark Emlyn David Thomas','2010-01-31 19:04:40','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48616, a regression caused by the fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=42390 The requirement for variable declaration also depends on whether or not a fragment helper has been used for the parent tag (if any). Where such a helper has been used, the variables must be redefined. Test cases for both bugs and the JSP TCK pass with this patch applied.','java/org/apache/jasper/compiler/Generator.java\njava/org/apache/jasper/compiler/ScriptingVariabler.java'),(1527,48616,'Bug 48616 – Struts 1.2 and bean:define tag throws jsp 1.1 regression exception','I\'m using Struts 1.2.\nI\'ve upgrade from tomcat 6.0.20 to 6.0.24 and nothing works.\n\nThe jsp compilation throws many error (i use the tag bean:define with same variable many times in jsp):\n\nDuring jsp precompilation:\n\n\"my_variable\" is already defined in _jspService(javax.servlet.http.HttpServletRequest,javax.servlet.http.HttpServletResponse)\n\nand at runtime:\n\n26-gen-2010 10.16.43 org.apache.catalina.core.ApplicationDispatcher invoke\nGRAVE: Servlet.service() for servlet jsp threw exception\norg.apache.jasper.JasperException: Unable to compile class for JSP: \n\nAn error occurred at line: 459 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 576 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 693 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 810 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 927 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 1.045 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 1.162 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 1.279 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 1.396 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 1.531 in the generated java file\nDuplicate local variable patientsExists\n\nAn error occurred at line: 1.660 in the generated java file\nDuplicate local variable patientsExists\n\nAn error occurred at line: 1.777 in the generated java file\nDuplicate local variable patientsExists\n\nAn error occurred at line: 1.897 in the generated java file\nDuplicate local variable multiportionExists\n\nAn error occurred at line: 2.014 in the generated java file\nDuplicate local variable multiportionExists\n\nAn error occurred at line: 2.131 in the generated java file\nDuplicate local variable multiportionExists\n\nAn error occurred at line: 2.251 in the generated java file\nDuplicate local variable generalExists\n\nAn error occurred at line: 2.368 in the generated java file\nDuplicate local variable generalExists\n\nAn error occurred at line: 2.485 in the generated java file\nDuplicate local variable generalExists\n\nAn error occurred at line: 2.605 in the generated java file\nDuplicate local variable messagesExists\n\nAn error occurred at line: 2.722 in the generated java file\nDuplicate local variable messagesExists\n\nAn error occurred at line: 2.842 in the generated java file\nDuplicate local variable printFindExists\n\nAn error occurred at line: 2.959 in the generated java file\nDuplicate local variable printFindExists\n\nStacktrace:\n        at org.apache.jasper.compiler.DefaultErrorHandler.javacError(DefaultErrorHandler.java:92)\n        at org.apache.jasper.compiler.ErrorDispatcher.javacError(ErrorDispatcher.java:330)\n        at org.apache.jasper.compiler.JDTCompiler.generateClass(JDTCompiler.java:439)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:334)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:312)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:299)\n        at org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:589)\n        at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:317)\n        at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)\n        at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)\n        at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:551)\n        at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:488)\n        at org.apache.jasper.runtime.JspRuntimeLibrary.include(JspRuntimeLibrary.java:968)\n        at org.apache.jsp.WEB_002dINF.pages.login.mainPage_jsp._jspService(mainPage_jsp.java:206)\n        at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n        at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:377)\n        at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)\n        at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)\n        at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:436)\n        at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:374)\n        at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:302)\n        at org.apache.struts.action.RequestProcessor.doForward(RequestProcessor.java:1062)\n        at org.apache.struts.action.RequestProcessor.processForwardConfig(RequestProcessor.java:386)\n        at org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:229)\n        at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1196)\n        at org.apache.struts.action.ActionServlet.doPost(ActionServlet.java:432)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)\n        at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:436)\n        at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:374)\n        at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:302)\n        at org.apache.struts.action.RequestProcessor.doForward(RequestProcessor.java:1062)\n        at org.apache.struts.action.RequestProcessor.processForwardConfig(RequestProcessor.java:386)\n        at org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:229)\n        at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1196)\n        at org.apache.struts.action.ActionServlet.doPost(ActionServlet.java:432)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at org.displaytag.filter.ResponseOverrideFilter.doFilter(ResponseOverrideFilter.java:125)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)\n        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)\n        at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:558)\n        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)\n        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)\n        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:298)\n        at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:852)\n        at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:588)\n        at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)\n        at java.lang.Thread.run(Thread.java:619)\n\n\n\nBefore upgrading to 6.0.24 all works fine.\n\nReading the documentation of bean:define in struts javadoc i see this message:\n\nUSAGE NOTE - There is a restriction in the JSP 1.1 Specification that disallows using the same value for an id attribute more than once in a single JSP page. Therefore, you will not be able to use <bean:define> for the same bean name more than once in a single page. \n\nBut i\'ve not specify any jsp version.\n\nSo, is this a tomcat 6.0.24 regression bug? \n\nI\'ve not particular compilation type/version specified in my app.','2010-01-26 01:22:58','agharta','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 blocker','19c6035','Mark Emlyn David Thomas','2010-01-31 19:01:45','Restore the current 6.0.x implementation so patch to fix 48616 will apply cleanly to 6.0.x','java/org/apache/jasper/compiler/ScriptingVariabler.java'),(1528,48616,'Bug 48616 – Struts 1.2 and bean:define tag throws jsp 1.1 regression exception','I\'m using Struts 1.2.\nI\'ve upgrade from tomcat 6.0.20 to 6.0.24 and nothing works.\n\nThe jsp compilation throws many error (i use the tag bean:define with same variable many times in jsp):\n\nDuring jsp precompilation:\n\n\"my_variable\" is already defined in _jspService(javax.servlet.http.HttpServletRequest,javax.servlet.http.HttpServletResponse)\n\nand at runtime:\n\n26-gen-2010 10.16.43 org.apache.catalina.core.ApplicationDispatcher invoke\nGRAVE: Servlet.service() for servlet jsp threw exception\norg.apache.jasper.JasperException: Unable to compile class for JSP: \n\nAn error occurred at line: 459 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 576 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 693 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 810 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 927 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 1.045 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 1.162 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 1.279 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 1.396 in the generated java file\nDuplicate local variable configurationExists\n\nAn error occurred at line: 1.531 in the generated java file\nDuplicate local variable patientsExists\n\nAn error occurred at line: 1.660 in the generated java file\nDuplicate local variable patientsExists\n\nAn error occurred at line: 1.777 in the generated java file\nDuplicate local variable patientsExists\n\nAn error occurred at line: 1.897 in the generated java file\nDuplicate local variable multiportionExists\n\nAn error occurred at line: 2.014 in the generated java file\nDuplicate local variable multiportionExists\n\nAn error occurred at line: 2.131 in the generated java file\nDuplicate local variable multiportionExists\n\nAn error occurred at line: 2.251 in the generated java file\nDuplicate local variable generalExists\n\nAn error occurred at line: 2.368 in the generated java file\nDuplicate local variable generalExists\n\nAn error occurred at line: 2.485 in the generated java file\nDuplicate local variable generalExists\n\nAn error occurred at line: 2.605 in the generated java file\nDuplicate local variable messagesExists\n\nAn error occurred at line: 2.722 in the generated java file\nDuplicate local variable messagesExists\n\nAn error occurred at line: 2.842 in the generated java file\nDuplicate local variable printFindExists\n\nAn error occurred at line: 2.959 in the generated java file\nDuplicate local variable printFindExists\n\nStacktrace:\n        at org.apache.jasper.compiler.DefaultErrorHandler.javacError(DefaultErrorHandler.java:92)\n        at org.apache.jasper.compiler.ErrorDispatcher.javacError(ErrorDispatcher.java:330)\n        at org.apache.jasper.compiler.JDTCompiler.generateClass(JDTCompiler.java:439)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:334)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:312)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:299)\n        at org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:589)\n        at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:317)\n        at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)\n        at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)\n        at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:551)\n        at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:488)\n        at org.apache.jasper.runtime.JspRuntimeLibrary.include(JspRuntimeLibrary.java:968)\n        at org.apache.jsp.WEB_002dINF.pages.login.mainPage_jsp._jspService(mainPage_jsp.java:206)\n        at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n        at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:377)\n        at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)\n        at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)\n        at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:436)\n        at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:374)\n        at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:302)\n        at org.apache.struts.action.RequestProcessor.doForward(RequestProcessor.java:1062)\n        at org.apache.struts.action.RequestProcessor.processForwardConfig(RequestProcessor.java:386)\n        at org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:229)\n        at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1196)\n        at org.apache.struts.action.ActionServlet.doPost(ActionServlet.java:432)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)\n        at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:436)\n        at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:374)\n        at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:302)\n        at org.apache.struts.action.RequestProcessor.doForward(RequestProcessor.java:1062)\n        at org.apache.struts.action.RequestProcessor.processForwardConfig(RequestProcessor.java:386)\n        at org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:229)\n        at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1196)\n        at org.apache.struts.action.ActionServlet.doPost(ActionServlet.java:432)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at org.displaytag.filter.ResponseOverrideFilter.doFilter(ResponseOverrideFilter.java:125)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)\n        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)\n        at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:558)\n        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)\n        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)\n        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:298)\n        at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:852)\n        at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:588)\n        at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)\n        at java.lang.Thread.run(Thread.java:619)\n\n\n\nBefore upgrading to 6.0.24 all works fine.\n\nReading the documentation of bean:define in struts javadoc i see this message:\n\nUSAGE NOTE - There is a restriction in the JSP 1.1 Specification that disallows using the same value for an id attribute more than once in a single JSP page. Therefore, you will not be able to use <bean:define> for the same bean name more than once in a single page. \n\nBut i\'ve not specify any jsp version.\n\nSo, is this a tomcat 6.0.24 regression bug? \n\nI\'ve not particular compilation type/version specified in my app.','2010-01-26 01:22:58','agharta','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 blocker','3e824ab','Mark Emlyn David Thomas','2010-01-31 18:57:56','Add minimal version of test case provided by \'agharta\' in for https://issues.apache.org/bugzilla/show_bug.cgi?id=48616','test/org/apache/jasper/compiler/TestScriptingVariabler.java\ntest/webapp/WEB-INF/bugs.tld\ntest/webapp/bug48616.jsp'),(1529,42390,'Bug 42390 – JSP compilation error with nested tagfile tags with variables with \"AT_BEGIN\" scope','Given a tagfile \"test.tag\" in /WEB-INF/tags/t:\n---- begin test.tag ----\n<%@ variable name-given=\"X\" scope=\"AT_BEGIN\" %>\n<jsp:doBody/>\n---- end test.tag ----\nthe following JSP \"testTest.jsp\":\n---- begin testTest.jsp ----\n<t:test><t:test/></t:test>\n---- end testTest.jsp ----\ngives a JSP compilation error:\norg.apache.jasper.JasperException: Unable to compile class for JSP: \nStacktrace:\n        at\norg.apache.jasper.compiler.DefaultErrorHandler.javacError(DefaultErrorHandler.java:85)\n        at\norg.apache.jasper.compiler.ErrorDispatcher.javacError(ErrorDispatcher.java:330)\n        at\norg.apache.jasper.compiler.JDTCompiler.generateClass(JDTCompiler.java:435)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:298)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:277)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:265)\n        at\norg.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:564)\n        at\norg.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:299)\n        at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:315)\n        at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:265)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:803)\n        at\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:269)\n        at\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:188)\n        at\norg.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:210)\n        at\norg.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:174)\n        at\norg.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)\n        at\norg.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:117)\n        at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:542)\n        at\norg.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:108)\n        at\norg.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:151)\n        at\norg.apache.coyote.http11.Http11Processor.process(Http11Processor.java:870)\n        at\norg.apache.coyote.http11.Http11BaseProtocol$Http11ConnectionHandler.processConnection(Http11BaseProtocol.java:665)\n        at\norg.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:528)\n        at\norg.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:81)\n        at\norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:685)\n        at java.lang.Thread.run(Thread.java:613)','2007-05-11 00:59:37','MicroNova YUZU Team','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P1 major','b0d3fd2','Mark Emlyn David Thomas','2010-01-31 17:49:34','Add test case for https://issues.apache.org/bugzilla/show_bug.cgi?id=42390 JSP & tag file provided by MicroNova YUZU Team','test/org/apache/jasper/compiler/TestScriptingVariabler.java\ntest/webapp/WEB-INF/tags/bug42390.tag\ntest/webapp/bug42390.jsp'),(1530,48645,'Bug 48645 – RequestUtil.URLDecode(byte[] bytes, String enc)','the enc is not used in the implementation\n\n  public static String URLDecode(byte[] bytes, String enc) {\n        return URLDecode(bytes, null, false);\n    }','2010-01-31 04:36:17','Feng Peng','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','d0f9da2','Mark Emlyn David Thomas','2010-01-31 07:48:53','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48645 Use specified encoding rather than null','java/org/apache/catalina/util/RequestUtil.java'),(1531,42390,'Bug 42390 – JSP compilation error with nested tagfile tags with variables with \"AT_BEGIN\" scope','Given a tagfile \"test.tag\" in /WEB-INF/tags/t:\n---- begin test.tag ----\n<%@ variable name-given=\"X\" scope=\"AT_BEGIN\" %>\n<jsp:doBody/>\n---- end test.tag ----\nthe following JSP \"testTest.jsp\":\n---- begin testTest.jsp ----\n<t:test><t:test/></t:test>\n---- end testTest.jsp ----\ngives a JSP compilation error:\norg.apache.jasper.JasperException: Unable to compile class for JSP: \nStacktrace:\n        at\norg.apache.jasper.compiler.DefaultErrorHandler.javacError(DefaultErrorHandler.java:85)\n        at\norg.apache.jasper.compiler.ErrorDispatcher.javacError(ErrorDispatcher.java:330)\n        at\norg.apache.jasper.compiler.JDTCompiler.generateClass(JDTCompiler.java:435)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:298)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:277)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:265)\n        at\norg.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:564)\n        at\norg.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:299)\n        at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:315)\n        at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:265)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:803)\n        at\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:269)\n        at\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:188)\n        at\norg.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:210)\n        at\norg.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:174)\n        at\norg.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)\n        at\norg.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:117)\n        at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:542)\n        at\norg.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:108)\n        at\norg.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:151)\n        at\norg.apache.coyote.http11.Http11Processor.process(Http11Processor.java:870)\n        at\norg.apache.coyote.http11.Http11BaseProtocol$Http11ConnectionHandler.processConnection(Http11BaseProtocol.java:665)\n        at\norg.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:528)\n        at\norg.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:81)\n        at\norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:685)\n        at java.lang.Thread.run(Thread.java:613)','2007-05-11 00:59:37','MicroNova YUZU Team','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P1 major','d9a4fb5','Mark Emlyn David Thomas','2010-01-31 07:34:22','Revert r804734 (https://issues.apache.org/bugzilla/show_bug.cgi?id=42390) while I look for a better fix Tab police','java/org/apache/jasper/compiler/ScriptingVariabler.java'),(1532,48627,'Bug 48627 – JasperException with JSF tags and value expressions','I recently updated from Tomcat 6.0.20 to 6.0.24.\nNow some jsps with jsf tags are not compiling anymore.\n\nFollowing tag results in a JasperException in 6.0.24 but compiles fine with older versions:\n\n<h:outputText value=\"\\\\\">\n\nStack:\nCaused by: org.apache.jasper.JasperException: /pages/preferences.jsp(147,100) According to TLD or attribute directive in tag file, attribute value does not accept any expressions\n                at org.apache.jasper.compiler.DefaultErrorHandler.jspError(DefaultErrorHandler.java:40)\n                at org.apache.jasper.compiler.ErrorDispatcher.dispatch(ErrorDispatcher.java:407)\n                at org.apache.jasper.compiler.ErrorDispatcher.jspError(ErrorDispatcher.java:148)\n                at org.apache.jasper.compiler.Validator$ValidateVisitor.checkXmlAttributes(Validator.java:1165)\n                at org.apache.jasper.compiler.Validator$ValidateVisitor.visit(Validator.java:852)\n                at org.apache.jasper.compiler.Node$CustomTag.accept(Node.java:1530)\n                at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2361)\n                at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2411)\n                at org.apache.jasper.compiler.Validator$ValidateVisitor.visit(Validator.java:871)\n                at org.apache.jasper.compiler.Node$CustomTag.accept(Node.java:1530)\n                at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2361)\n                at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2411)\n                at org.apache.jasper.compiler.Validator$ValidateVisitor.visit(Validator.java:871)\n                at org.apache.jasper.compiler.Node$CustomTag.accept(Node.java:1530)\n                at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2361)\n                at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2411)\n                at org.apache.jasper.compiler.Validator$ValidateVisitor.visit(Validator.java:871)\n                at org.apache.jasper.compiler.Node$CustomTag.accept(Node.java:1530)\n                at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2361)\n                at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2411)\n                at org.apache.jasper.compiler.Validator$ValidateVisitor.visit(Validator.java:871)\n                at org.apache.jasper.compiler.Node$CustomTag.accept(Node.java:1530)\n                at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2361)\n                at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2411)\n                at org.apache.jasper.compiler.Validator$ValidateVisitor.visit(Validator.java:871)\n                at org.apache.jasper.compiler.Node$CustomTag.accept(Node.java:1530)\n                at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2361)\n                at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2411)\n                at org.apache.jasper.compiler.Validator$ValidateVisitor.visit(Validator.java:871)\n                at org.apache.jasper.compiler.Node$CustomTag.accept(Node.java:1530)\n                at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2361)\n                at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2411)\n                at org.apache.jasper.compiler.Node$Visitor.visit(Node.java:2417)\n                at org.apache.jasper.compiler.Node$Root.accept(Node.java:495)\n                at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2361)\n                at org.apache.jasper.compiler.Validator.validateExDirectives(Validator.java:1775)\n                at org.apache.jasper.compiler.Compiler.generateJava(Compiler.java:183)\n                at org.apache.jasper.compiler.Compiler.compile(Compiler.java:332)\n                at org.apache.jasper.compiler.Compiler.compile(Compiler.java:312)\n                at org.apache.jasper.compiler.Compiler.compile(Compiler.java:299)\n                at org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:589)\n                at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:317)\n                at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)\n                at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)\n                at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n                at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n                at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n                at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)\n                at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:551)\n                at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:488)\n                at org.apache.jasper.runtime.JspRuntimeLibrary.include(JspRuntimeLibrary.java:968)\n                at org.apache.jasper.runtime.PageContextImpl.doInclude(PageContextImpl.java:650)\n                at org.apache.jasper.runtime.PageContextImpl.include(PageContextImpl.java:644)\n                at org.apache.tiles.jsp.context.JspTilesRequestContext.include(JspTilesRequestContext.java:80)\n                ... 67 more','2010-01-27 00:28:18','Michael Heinen','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 major','21cd6aa','Mark Emlyn David Thomas','2010-01-30 20:40:39','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48627 Don\'t convert literal attribute values to EL since attributes may not accept EL','java/org/apache/jasper/compiler/AttributeParser.java\njava/org/apache/jasper/compiler/Parser.java\ntest/org/apache/jasper/compiler/TestAttributeParser.java'),(1533,48629,'Bug 48629 – JNDIRealm and roleNested doesn\'t work with roleSearch=\"(member={1})\"','','2010-01-27 13:35:47','tahitiangabriel','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 minor','bfea32a','Mark Emlyn David Thomas','2010-01-30 18:08:46','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48629 Get nested role search working when {1} is used in roleSearch Patch provided by Gabriel','java/org/apache/catalina/realm/JNDIRealm.java'),(1534,48627,'Bug 48627 – JasperException with JSF tags and value expressions','I recently updated from Tomcat 6.0.20 to 6.0.24.\nNow some jsps with jsf tags are not compiling anymore.\n\nFollowing tag results in a JasperException in 6.0.24 but compiles fine with older versions:\n\n<h:outputText value=\"\\\\\">\n\nStack:\nCaused by: org.apache.jasper.JasperException: /pages/preferences.jsp(147,100) According to TLD or attribute directive in tag file, attribute value does not accept any expressions\n                at org.apache.jasper.compiler.DefaultErrorHandler.jspError(DefaultErrorHandler.java:40)\n                at org.apache.jasper.compiler.ErrorDispatcher.dispatch(ErrorDispatcher.java:407)\n                at org.apache.jasper.compiler.ErrorDispatcher.jspError(ErrorDispatcher.java:148)\n                at org.apache.jasper.compiler.Validator$ValidateVisitor.checkXmlAttributes(Validator.java:1165)\n                at org.apache.jasper.compiler.Validator$ValidateVisitor.visit(Validator.java:852)\n                at org.apache.jasper.compiler.Node$CustomTag.accept(Node.java:1530)\n                at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2361)\n                at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2411)\n                at org.apache.jasper.compiler.Validator$ValidateVisitor.visit(Validator.java:871)\n                at org.apache.jasper.compiler.Node$CustomTag.accept(Node.java:1530)\n                at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2361)\n                at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2411)\n                at org.apache.jasper.compiler.Validator$ValidateVisitor.visit(Validator.java:871)\n                at org.apache.jasper.compiler.Node$CustomTag.accept(Node.java:1530)\n                at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2361)\n                at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2411)\n                at org.apache.jasper.compiler.Validator$ValidateVisitor.visit(Validator.java:871)\n                at org.apache.jasper.compiler.Node$CustomTag.accept(Node.java:1530)\n                at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2361)\n                at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2411)\n                at org.apache.jasper.compiler.Validator$ValidateVisitor.visit(Validator.java:871)\n                at org.apache.jasper.compiler.Node$CustomTag.accept(Node.java:1530)\n                at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2361)\n                at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2411)\n                at org.apache.jasper.compiler.Validator$ValidateVisitor.visit(Validator.java:871)\n                at org.apache.jasper.compiler.Node$CustomTag.accept(Node.java:1530)\n                at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2361)\n                at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2411)\n                at org.apache.jasper.compiler.Validator$ValidateVisitor.visit(Validator.java:871)\n                at org.apache.jasper.compiler.Node$CustomTag.accept(Node.java:1530)\n                at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2361)\n                at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2411)\n                at org.apache.jasper.compiler.Node$Visitor.visit(Node.java:2417)\n                at org.apache.jasper.compiler.Node$Root.accept(Node.java:495)\n                at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2361)\n                at org.apache.jasper.compiler.Validator.validateExDirectives(Validator.java:1775)\n                at org.apache.jasper.compiler.Compiler.generateJava(Compiler.java:183)\n                at org.apache.jasper.compiler.Compiler.compile(Compiler.java:332)\n                at org.apache.jasper.compiler.Compiler.compile(Compiler.java:312)\n                at org.apache.jasper.compiler.Compiler.compile(Compiler.java:299)\n                at org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:589)\n                at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:317)\n                at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)\n                at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)\n                at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n                at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n                at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n                at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)\n                at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:551)\n                at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:488)\n                at org.apache.jasper.runtime.JspRuntimeLibrary.include(JspRuntimeLibrary.java:968)\n                at org.apache.jasper.runtime.PageContextImpl.doInclude(PageContextImpl.java:650)\n                at org.apache.jasper.runtime.PageContextImpl.include(PageContextImpl.java:644)\n                at org.apache.tiles.jsp.context.JspTilesRequestContext.include(JspTilesRequestContext.java:80)\n                ... 67 more','2010-01-27 00:28:18','Michael Heinen','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 major','d8bc712','Mark Emlyn David Thomas','2010-01-28 18:35:39','Add a test case for bug 48627','test/org/apache/jasper/compiler/TestParser.java\ntest/webapp/WEB-INF/tags/echo-noel.tag\ntest/webapp/bug48627.jsp'),(1535,48613,'Bug 48613 – AprLifecycleListener tries to initialize even if it is not configured in server.xml','When Tomcat starts, this message is displayed, in spite of this listener not being used in server.xml. There is no way to avoid it.\n\norg.apache.catalina.core.AprLifecycleListener init\nINFO: The Apache Tomcat Native library which allows optimal performance in production environments was not found on the java.library.path','2010-01-25 15:07:48','Martin Cordova','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','deb5c49','Filip Hanik','2010-01-28 14:30:06','Fix according to https://issues.apache.org/bugzilla/show_bug.cgi?id=48613','java/org/apache/catalina/core/AprLifecycleListener.java'),(1536,48613,'Bug 48613 – AprLifecycleListener tries to initialize even if it is not configured in server.xml','When Tomcat starts, this message is displayed, in spite of this listener not being used in server.xml. There is no way to avoid it.\n\norg.apache.catalina.core.AprLifecycleListener init\nINFO: The Apache Tomcat Native library which allows optimal performance in production environments was not found on the java.library.path','2010-01-25 15:07:48','Martin Cordova','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','dd5ae2a','Filip Hanik','2010-01-27 20:29:51','https://issues.apache.org/bugzilla/show_bug.cgi?id=48613 APR should not attempt to initialize if the listener has been removed from server.xml','java/org/apache/catalina/core/AprLifecycleListener.java'),(1537,47774,'Bug 47774 – Illegal context class loader is used when HttpSessionListener is executed.','When HttpSessionListener is executed, illegal class loader is set to the context classLoader.\n\nI think that the problem is in CoyoteAdapter#parseSessionCookiesId method. \nJSESSION COOKIE is parsed in this method, and sessionId is set to the request. \n\nTo check sessionId, Request#isRequestedSessionIdValid method is called in this method. \nAnd, Session#isValid() might be called in Request#isRequestedSessionIdValid method. \nHowever, the context class loader of a current thread is StandardClassLoader. \nIt is not WebappClassLoader. \n\nFor instance,\nWhen the session has already passed session-timeout, \nSession#expire is executed.\nAt this time, the context class loader of the thread that executes HttpSessionListenner#sessionDestroyed is StanderdClassLoader. \nThis is not good. \nThe context class loader of the thread that executes HttpSessionListenner should be WebAppClassLoader. \n\n\nBest regards.','2009-09-01 01:58:42','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','cf05c25','Mark Emlyn David Thomas','2010-01-14 16:33:58','Fix TCK failures with security manager due to fix for bug 47774','java/org/apache/catalina/security/SecurityClassLoad.java\njava/org/apache/catalina/session/StandardSession.java'),(1538,48532,'Bug 48532 – try to read truststore even when clientauth is false','When people try to set up SSL with Tomcat, most of them don\'t need client authentication and thus won\'t set the truststoreFile, truststorePass and etc. However, Tomcat (or rather, JSSESocketFactory) will always try to load the trust store. Somehow it got a valid path but the password (by default set to that for the keystore) is incorrect and will throw an exception like below. This is very\nconfusing as people will keep checking the password of their keystore (and\ndon\'t know anything about trust store).\n\nI\'d recommend the following solutions (most preferred listed first):\n1) don\'t load the trust store if client authentication is false.\n2) if a trust store is not specified, use the keystore.\n3) the SSL howto should emphasize that a trust store must be set up.\n\nsample stack trace:\n\njava.io.IOException: Keystore was tampered with, or password was incorrect\n        at sun.security.provider.JavaKeyStore.engineLoad(JavaKeyStore.java:771)\n        at sun.security.provider.JavaKeyStore$JKS.engineLoad(JavaKeyStore.java:3\n8)\n        at java.security.KeyStore.load(KeyStore.java:1185)\n        at org.apache.tomcat.util.net.jsse.JSSESocketFactory.getStore(JSSESocket\nFactory.java:287)\n        at org.apache.tomcat.util.net.jsse.JSSESocketFactory.getTrustStore(JSSES\nocketFactory.java:261)\n        at org.apache.tomcat.util.net.jsse.JSSE14SocketFactory.getTrustManagers(\nJSSE14SocketFactory.java:175)\n        at org.apache.tomcat.util.net.jsse.JSSE15SocketFactory.getTrustManagers(\nJSSE15SocketFactory.java:69)','2010-01-12 22:26:00','Kent Tong','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Webapps:Documentation','P2 normal','5d7bc9c','Mark Emlyn David Thomas','2010-01-13 06:18:10','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48532 Better documentation of the SSL connector defaults','webapps/docs/config/http.xml'),(1539,48516,'Bug 48516 – NullPointerException in JNDIRealm','','2010-01-11 05:42:00','Kevin Conaway','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','62d29b6','Mark Emlyn David Thomas','2010-01-12 17:43:23','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48516 Fix possible NPE when user does not exist in directory Patch provided by Kevin Conaway','java/org/apache/catalina/realm/JNDIRealm.java'),(1540,47774,'Bug 47774 – Illegal context class loader is used when HttpSessionListener is executed.','When HttpSessionListener is executed, illegal class loader is set to the context classLoader.\n\nI think that the problem is in CoyoteAdapter#parseSessionCookiesId method. \nJSESSION COOKIE is parsed in this method, and sessionId is set to the request. \n\nTo check sessionId, Request#isRequestedSessionIdValid method is called in this method. \nAnd, Session#isValid() might be called in Request#isRequestedSessionIdValid method. \nHowever, the context class loader of a current thread is StandardClassLoader. \nIt is not WebappClassLoader. \n\nFor instance,\nWhen the session has already passed session-timeout, \nSession#expire is executed.\nAt this time, the context class loader of the thread that executes HttpSessionListenner#sessionDestroyed is StanderdClassLoader. \nThis is not good. \nThe context class loader of the thread that executes HttpSessionListenner should be WebAppClassLoader. \n\n\nBest regards.','2009-09-01 01:58:42','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','413c5bc','Mark Emlyn David Thomas','2010-01-12 17:36:15','Improved fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=47774','java/org/apache/catalina/session/StandardSession.java'),(1541,47774,'Bug 47774 – Illegal context class loader is used when HttpSessionListener is executed.','When HttpSessionListener is executed, illegal class loader is set to the context classLoader.\n\nI think that the problem is in CoyoteAdapter#parseSessionCookiesId method. \nJSESSION COOKIE is parsed in this method, and sessionId is set to the request. \n\nTo check sessionId, Request#isRequestedSessionIdValid method is called in this method. \nAnd, Session#isValid() might be called in Request#isRequestedSessionIdValid method. \nHowever, the context class loader of a current thread is StandardClassLoader. \nIt is not WebappClassLoader. \n\nFor instance,\nWhen the session has already passed session-timeout, \nSession#expire is executed.\nAt this time, the context class loader of the thread that executes HttpSessionListenner#sessionDestroyed is StanderdClassLoader. \nThis is not good. \nThe context class loader of the thread that executes HttpSessionListenner should be WebAppClassLoader. \n\n\nBest regards.','2009-09-01 01:58:42','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','df43d20','Mark Emlyn David Thomas','2010-01-12 17:15:31','Revert fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=47774 Better fix to follow','java/org/apache/catalina/connector/Request.java'),(1542,48530,'Bug 48530 – Patch for the Tomcat documentation : Server status page','','2010-01-12 06:05:00','Arnaud Espy','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Webapps:Documentation','P2 enhancement','6cab25b','Mark Emlyn David Thomas','2010-01-12 17:03:32','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48530 Add info on the Server Status page to the Manager How-To Based on a patch by Arnaud Espy','webapps/docs/manager-howto.xml'),(1543,48004,'Bug 48004 – setHeader() does not replace the previous value for a \"Server\"','','2009-10-15 11:16:16','olivier dupuy','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Unknown','P2 normal','13daf69','Mark Emlyn David Thomas','2010-01-12 16:36:49','Fix bug 48004. Allow applications to set the server header.','java/org/apache/coyote/http11/Http11AprProcessor.java\njava/org/apache/coyote/http11/Http11NioProcessor.java\njava/org/apache/coyote/http11/Http11Processor.java\nwebapps/docs/config/http.xml'),(1544,48421,'Bug 48421 – JULI webapp logging files will not closed when webapp is stopped,reloaded or undeployed','In Tomcat 6  the JULI logging files which are (can be) declared in webapp/WEB-INF/classes/logging.properties will not closed, when the\nwebapp is reloaded, stopped or even undeployed. The files will at last be closed, when tomcat is shut down or restarted.\n\nThis is also true for the normally used Handler org.apache.juli.FileHandler, which opens a new File every day and closes the old.\n\nOn windows this has following effects:\nA) If  the webapp is undeployed the files which are open at this moment are locked and cannot be deleted until tomcat is (someday) stopped or restarted.\nB) If the webapp is reloaded the file is opened a second time. So the file has two open handles.\nThe next day the FileHandler closes one handle but the file is kept locked through the other handle and cannot be deleted.\n\nEvery time a webapp is reloaded the associated logfile is opened again (but not closed).\nThis has the consequence that after reloading webapps a few times tomcat must be restarted from time to time.\n\nWhen tomcat is shutdown the unnecessary (and other) open files are closed and will get the shutdown time as modification time.\nThat means any old log files will receive a current modification time, which is irritating.\n\nSteps to verify on windows: (for example: undeploy)\n1. create in the examples webapp: of tomcat 6.0.20:\nexamples/WEB-INF/classes/logging.properties:\n\nhandlers = org.apache.juli.FileHandler\norg.apache.juli.FileHandler.level = FINE\norg.apache.juli.FileHandler.directory = ${catalina.base}/logs\norg.apache.juli.FileHandler.prefix = servlet-examples.\n\n2. start tomcat\n3. undeploy examples using manager\nActual Results:\nfile ${catalina.base}/logs/servlet-examples.<date>.log cannot be deleted (nor at the next day)\nExpected:\nfile ${catalina.base}/logs/servlet-examples.<date>.log can be deleted\n\nvery cumbersome Workaround (working for reload):\nThe getHead method of a custom Formatter is extended to track the handlers along with the classloader and webapp.\nIf for a webapp a different (i.e. new) classloader is detected the close method of the handlers assigned to the old classloader is called. So the assigned file is proper closed (and the Formatter.getTail result is appended)\n\nI have set severity at minor because tomcat can be used (without webapp logging). But it is a bug because with this logging the same logfile can be useless multiple open (as described above), which should be considered as buggy.','2009-12-20 14:45:51','Karl-Heinz','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 minor','eeb017a','Mark Emlyn David Thomas','2010-01-12 14:06:48','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48421 Clean up a web application\'s logs and handlers when it stops. This involved modifying the fix that prevented log messages being lost in shutdown.','java/org/apache/juli/ClassLoaderLogManager.java\njava/org/apache/juli/logging/LogFactory.java'),(1545,48524,'Bug 48524 – Property keys not present in the default file','Property keys in localised files should all be present in the default file, e.g. all keys in LocalStrings_ja.properties should be in the corresponding LocalStrings.properties.\n\nHowever, that\'s not always the case:\n\nFile: java\\org\\apache\\catalina\\core\\LocalStrings_es.properties\nCannot find basekey: \'standardWrapper.privilegedServlet\'\nCannot find basekey: \'applicationFilterConfig.restrictedFiltersResource\'\nCannot find basekey: \'applicationFilterConfig.privilegedFilter\'\nCannot find basekey: \'standardWrapper.restrictedServletsResource\'\nFile: java\\org\\apache\\catalina\\core\\LocalStrings_fr.properties\nCannot find basekey: \'standardWrapper.privilegedServlet\'\nFile: java\\org\\apache\\catalina\\core\\LocalStrings_ja.properties\nCannot find basekey: \'standardWrapper.privilegedServlet\'\nFile: java\\org\\apache\\catalina\\manager\\host\\LocalStrings_es.properties\nCannot find basekey: \'hostManagerServlet.cannotInvoke\'\nFile: java\\org\\apache\\catalina\\realm\\LocalStrings_es.properties\nCannot find basekey: \'jaasRealm.authenticatedSuccess\'\nFile: java\\org\\apache\\jasper\\resources\\LocalStrings_fr.properties\nCannot find basekey: \'jsp.error.tld.fn.invalid.signature.classnotfound\'\nCannot find basekey: \'jsp.error.useBean.noSession\'\nCannot find basekey: \'jsp.warning.unknown.element.in.TLD\'\nFile: java\\org\\apache\\jasper\\resources\\LocalStrings_ja.properties\nCannot find basekey: \'jsp.error.useBean.noSession\'','2010-01-11 13:36:38','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','dcf28d7','Mark Emlyn David Thomas','2010-01-12 06:42:46','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48524 Remove unused keys. Fix case issue for jsp.error.usebean.noSession.','java/org/apache/catalina/core/LocalStrings_es.properties\njava/org/apache/catalina/core/LocalStrings_fr.properties\njava/org/apache/catalina/core/LocalStrings_ja.properties\njava/org/apache/catalina/manager/host/LocalStrings_es.properties\njava/org/apache/catalina/realm/LocalStrings_es.properties\njava/org/apache/jasper/resources/LocalStrings_fr.properties\njava/org/apache/jasper/resources/LocalStrings_ja.properties'),(1546,48523,'Bug 48523 – Duplicate property keys in various files','There are some properties files with non-unique property keys; normally these should be unique.\n\nFile: java\\org\\apache\\catalina\\realm\\LocalStrings.properties\nDuplicate key: \'jaasRealm.userPrincipalSuccess\'\njaasRealm.userPrincipalSuccess=Principal \"{0}\" is a valid user class. We will use this as the user Principal.\njaasRealm.userPrincipalSuccess=Subject for username \"{0}\" returned user Principal \"{1}\"\nDuplicate key: \'jaasRealm.userPrincipalFailure\'\njaasRealm.userPrincipalFailure=No valid user Principal found\njaasRealm.userPrincipalFailure=Subject for username \"{0}\" did not return a valid user Principal\nFile: java\\org\\apache\\catalina\\realm\\LocalStrings_es.properties\nDuplicate key: \'jaasRealm.userPrincipalSuccess\'\njaasRealm.userPrincipalSuccess = El Principal \"{0}\" es una clase v\\u00E1lida de usuario. La vamos a usar como usuario Principal.\njaasRealm.userPrincipalSuccess = El asunto para el nombre de usuario \"{0}\" devolvi\\u00F3 usuario Principal \"{1}\"\nDuplicate key: \'jaasRealm.userPrincipalFailure\'\njaasRealm.userPrincipalFailure = No se ha hallado usuario Principal\njaasRealm.userPrincipalFailure = El asunto para el nombre de usuario \"{0}\" no devolvi\\u00F3 un usuario Principal v\\u00E1lido\nFile: java\\org\\apache\\catalina\\startup\\LocalStrings.properties\nDuplicate key: \'contextConfig.jndiUrl\'\ncontextConfig.jndiUrl=The connection created for URL [{0}] was not a DirContextURLConnection\ncontextConfig.jndiUrl=Unable to process JNDI URL [{0}] for annotations\nDuplicate key: \'webXml.mergeConflictFilter\'\nwebXml.mergeConflictFilter=The Servlet [{0}] was defined inconsistently in multiple fragments including fragment with name [{1}] located at [{2}]\nwebXml.mergeConflictFilter=The Filter [{0}] was defined inconsistently in multiple fragments including fragment with name [{1}] located at [{2}]\nFile: java\\org\\apache\\jasper\\resources\\LocalStrings.properties\nDuplicate key: \'jsp.error.page.invalid.buffer\'\njsp.error.page.invalid.buffer=Page directive: invalid value for buffer\njsp.error.page.invalid.buffer=Page directive: invalid buffer size\nDuplicate key: \'jsp.error.xml.invalidHighSurrogate\'\njsp.error.xml.invalidHighSurrogate = High surrogate bits in UTF-8 sequence must not exceed 0x10 but found 0x{0}.\njsp.error.xml.invalidHighSurrogate = High surrogate bits in UTF-8 sequence must not exceed 0x10 but found 0x{0}.\nFile: java\\org\\apache\\jasper\\resources\\LocalStrings_es.properties\nDuplicate key: \'jsp.error.page.invalid.buffer\'\njsp.error.page.invalid.buffer = Directiva Page\\: valor incorrecto para b\\u00FAfer\njsp.error.page.invalid.buffer = Directiva Page\\: valor incorrecto para buffer\nDuplicate key: \'jsp.error.xml.invalidHighSurrogate\'\njsp.error.xml.invalidHighSurrogate = Los bits de surrogaci\\u00F3n alta en secuencai UTF-8 no deben de exceder 0x10 pero se hall\\u00F3 0x{0}.\njsp.error.xml.invalidHighSurrogate = Surrogaci\\u00F3n Alta de bits en secuencia UTF-8 no debe de exceder 0x10, pero se hall\\u00F3 0x{0}.\nFile: java\\org\\apache\\jasper\\resources\\LocalStrings_ja.properties\nDuplicate key: \'jsp.error.page.invalid.buffer\'\njsp.error.page.invalid.buffer=page\\u6307\\u793a\\u5b50: buffer\\u5c5e\\u6027\\u306e\\u5024\\u304c\\u7121\\u52b9\\u3067\\u3059\njsp.error.page.invalid.buffer=page\\u6307\\u793a\\u5b50: \\u7121\\u52b9\\u306a\\u30d0\\u30c3\\u30d5\\u30a1\\u30b5\\u30a4\\u30ba\\u3067\\u3059\nDuplicate key: \'jsp.error.xml.invalidHighSurrogate\'\njsp.error.xml.invalidHighSurrogate = UTF-8\\u30b7\\u30fc\\u30b1\\u30f3\\u30b9\\u306e\\u30cf\\u30a4\\u30b5\\u30ed\\u30b2\\u30fc\\u30c8\\u30d3\\u30c3\\u30c8\\u306f0x10\\u3092\\u8d8a\\u3048\\u3066\\u306f\\u3044\\u3051\\u307e\\u305b\\u3093\\u304c\\u30010x{0}\\u304c\\u898b\\u3064\\u304b\\u308a\\u307e\\u3057\\u305f\njsp.error.xml.invalidHighSurrogate = UTF-8\\u30b7\\u30fc\\u30b1\\u30f3\\u30b9\\u306e\\u30cf\\u30a4\\u30b5\\u30ed\\u30b2\\u30fc\\u30c8\\u30d3\\u30c3\\u30c8\\u306f0x10\\u3092\\u8d8a\\u3048\\u3066\\u306f\\u3044\\u3051\\u307e\\u305b\\u3093\\u304c\\u30010x{0}\\u304c\\u898b\\u3064\\u304b\\u308a\\u307e\\u3057\\u305f\nFile: java\\org\\apache\\tomcat\\util\\net\\res\\LocalStrings.properties\nDuplicate key: \'endpoint.poll.fail\'\nendpoint.poll.fail=Socket [{0}] poll event: [{1}] {2}\nendpoint.poll.fail=Critical poller failure (restarting poller): [{0}] {1}\nFile: java\\org\\apache\\tomcat\\util\\net\\res\\LocalStrings_es.properties\nDuplicate key: \'endpoint.poll.fail\'\nendpoint.poll.fail = Conector [{0}] evento de encuesta\\: [{1}] {2}\nendpoint.poll.fail = Fallo cr\\u00EDtico de encuestador (reiniciando encuestador)\\: [{0}] {1}\nFile: java\\org\\apache\\tomcat\\util\\net\\res\\LocalStrings.properties\nDuplicate key: \'endpoint.poll.fail\'\nendpoint.poll.fail=Socket [{0}] poll event: [{1}] {2}\nendpoint.poll.fail=Critical poller failure (restarting poller): [{0}] {1}\nFile: java\\org\\apache\\tomcat\\util\\net\\res\\LocalStrings_es.properties\nDuplicate key: \'endpoint.poll.fail\'\nendpoint.poll.fail = Conector [{0}] evento de encuesta\\: [{1}] {2}\nendpoint.poll.fail = Fallo cr\\u00EDtico de encuestador (reiniciando encuestador)\\: [{0}] {1}','2010-01-11 12:45:44','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','f2eea0c','Mark Emlyn David Thomas','2010-01-12 06:09:18','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48523 Resolve duplicate keys','java/org/apache/catalina/realm/LocalStrings.properties\njava/org/apache/catalina/realm/LocalStrings_es.properties\njava/org/apache/catalina/startup/ContextConfig.java\njava/org/apache/catalina/startup/LocalStrings.properties\njava/org/apache/jasper/resources/LocalStrings.properties\njava/org/apache/jasper/resources/LocalStrings_es.properties\njava/org/apache/jasper/resources/LocalStrings_ja.properties\njava/org/apache/tomcat/util/net/res/LocalStrings.properties\njava/org/apache/tomcat/util/net/res/LocalStrings_es.properties'),(1547,48517,'Bug 48517 – @SuppressWarnings(\"unchecked\") - document and reduce scope','','2010-01-11 07:49:28','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','4df1957','Mark Emlyn David Thomas','2010-01-12 05:31:03','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48517 Reduce scope of @SupressWarnings and document reasoning Based on a patch by sebb','java/javax/el/BeanELResolver.java\njava/javax/el/ELContext.java\njava/javax/el/ResourceBundleELResolver.java\njava/org/apache/catalina/loader/WebappClassLoader.java\njava/org/apache/el/lang/ELSupport.java\njava/org/apache/el/lang/EvaluationContext.java\njava/org/apache/el/parser/AstIdentifier.java\njava/org/apache/el/parser/AstValue.java\njava/org/apache/el/parser/SimpleNode.java\njava/org/apache/naming/resources/VirtualDirContext.java'),(1548,47977,'Bug 47977 – body-content of empty in TLD ignored for JSP Documents','','2009-10-10 13:39:39','jcorallo','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Servlet & JSP API','P2 normal','dd63218','Mark Emlyn David Thomas','2010-01-11 19:10:46','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47977 Using a body with tags specified to have empty body content should cause an error','java/org/apache/jasper/compiler/JspDocumentParser.java'),(1549,36923,'Bug 36923 – Deactivated EL expressions are not parsed for jsp expressions/scriptlets/etc','JavaServer Pages Specification 2.0, section JSP.3.3.2 says:\n---\nSince the syntactic pattern ${expr} was not reserved in the JSP specifications\nbefore JSP 2.0, there may be situations where such a pattern appears but the\nintention is not to activate EL expression evaluation but rather to pass through\nthe pattern verbatim. To address this, the EL evaluation machinery can be\ndeactivated as indicated in this section.\n[...]\nThe default mode for JSP pages in a Web Application delivered using a web.xml\nusing the Servlet 2.3 or earlier format is to ignore EL expressions; this\nprovides for backward compatibility.\n---\n\nHowever, even with deactivated EL expression evaluation, jsp code like:\n<%@ page isELIgnored=\"true\" %>${<%= \"Hello, world!\" %>}\n\nwill produce output like:\n${<%= \"Hello, world!\" %>}\n\nwhich is of course not backwards-compatible with Servlet 2.3 / JSP 1.2 container\n(e.g., Tomcat 4.x), where the output would be:\n${Hello, world!}\n\nThe ${...} syntax is widely used, and any pre-2.0 jsp pages having it would be\nincompatible with Tomcat 5.x even though the standard tries to ensure the\ncompatibility.','2005-10-05 01:08:53','Yegor Borovikov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P3 normal','a9ddeb2','Mark Emlyn David Thomas','2010-01-10 06:37:16','Add a test case for bug36923','test/org/apache/el/TestELInJsp.java\ntest/webapp/bug36923.jsp'),(1550,48112,'Bug 48112 – Closing curly brace in literal string incorrectly treated as expression terminator.','On tomcat 6.0.20 something like the following line in a JSP causes a exception:\n\n<c:out value=\"${fn:trim(\'{world}\')}\"/>\n\nAfter removing the closing curly brace from the literal (\'{world}\' -> \'{world\') the JSP works. This behaviour seems specific to 6.0.20, as on 6.0.18 and 6.0.16 the line above works fine.\n\nExample of exception:\n=====================\norg.apache.jasper.JasperException: An exception occurred processing JSP page /test.jsp at line 11\n\n8: <meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\">\n9: </head>\n10: <body>\n11: <c:out value=\"${fn:trim(\'{world}\')}\"/>\n12: </body>\n13: </html>\n\n\nStacktrace:\n	org.apache.jasper.servlet.JspServletWrapper.handleJspException(JspServletWrapper.java:505)\n	org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:416)\n	org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:342)\n	org.apache.jasper.servlet.JspServlet.service(JspServlet.java:267)\n	javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\nroot cause\n\njavax.el.ELException: Error Parsing: ${fn:trim(\'{world}\n	org.apache.el.lang.ExpressionBuilder.createNodeInternal(ExpressionBuilder.java:125)\n	org.apache.el.lang.ExpressionBuilder.build(ExpressionBuilder.java:150)\n	org.apache.el.lang.ExpressionBuilder.createValueExpression(ExpressionBuilder.java:194)\n	org.apache.el.ExpressionFactoryImpl.createValueExpression(ExpressionFactoryImpl.java:68)\n	org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate(PageContextImpl.java:934)\n	org.apache.jsp.test_jsp._jspx_meth_c_005fout_005f0(test_jsp.java:98)\n	org.apache.jsp.test_jsp._jspService(test_jsp.java:72)\n	org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)\n	javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n	org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:374)\n	org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:342)\n	org.apache.jasper.servlet.JspServlet.service(JspServlet.java:267)\n	javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\nroot cause\n\norg.apache.el.parser.ParseException: Encountered \" <ILLEGAL_CHARACTER> \"\\\' \"\" at line 1, column 11.\nWas expecting one of:\n    <INTEGER_LITERAL> ...\n    <FLOATING_POINT_LITERAL> ...\n    <STRING_LITERAL> ...\n    \"true\" ...\n    \"false\" ...\n    \"null\" ...\n    \"(\" ...\n    \")\" ...\n    \"!\" ...\n    \"not\" ...\n    \"empty\" ...\n    \"-\" ...\n    <IDENTIFIER> ...\n    \n	org.apache.el.parser.ELParser.generateParseException(ELParser.java:2142)\n	org.apache.el.parser.ELParser.jj_consume_token(ELParser.java:2024)\n	org.apache.el.parser.ELParser.Function(ELParser.java:1207)\n	org.apache.el.parser.ELParser.NonLiteral(ELParser.java:1114)\n	org.apache.el.parser.ELParser.ValuePrefix(ELParser.java:1016)\n	org.apache.el.parser.ELParser.Value(ELParser.java:965)\n	org.apache.el.parser.ELParser.Unary(ELParser.java:947)\n	org.apache.el.parser.ELParser.Multiplication(ELParser.java:711)\n	org.apache.el.parser.ELParser.Math(ELParser.java:631)\n	org.apache.el.parser.ELParser.Compare(ELParser.java:443)\n	org.apache.el.parser.ELParser.Equality(ELParser.java:337)\n	org.apache.el.parser.ELParser.And(ELParser.java:281)\n	org.apache.el.parser.ELParser.Or(ELParser.java:225)\n	org.apache.el.parser.ELParser.Choice(ELParser.java:182)\n	org.apache.el.parser.ELParser.Expression(ELParser.java:174)\n	org.apache.el.parser.ELParser.DynamicExpression(ELParser.java:146)\n	org.apache.el.parser.ELParser.CompositeExpression(ELParser.java:43)\n	org.apache.el.lang.ExpressionBuilder.createNodeInternal(ExpressionBuilder.java:93)\n	org.apache.el.lang.ExpressionBuilder.build(ExpressionBuilder.java:150)\n	org.apache.el.lang.ExpressionBuilder.createValueExpression(ExpressionBuilder.java:194)\n	org.apache.el.ExpressionFactoryImpl.createValueExpression(ExpressionFactoryImpl.java:68)\n	org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate(PageContextImpl.java:934)\n	org.apache.jsp.test_jsp._jspx_meth_c_005fout_005f0(test_jsp.java:98)\n	org.apache.jsp.test_jsp._jspService(test_jsp.java:72)\n	org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)\n	javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n	org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:374)\n	org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:342)\n	org.apache.jasper.servlet.JspServlet.service(JspServlet.java:267)\n	javax.servlet.http.HttpServlet.service(HttpServlet.java:717)','2009-11-03 07:09:58','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','11810fb','Mark Emlyn David Thomas','2010-01-06 13:51:24','Add a test case for bug 48112 (note this passes - need to check when used in a JSP)','test/org/apache/el/TestELEvaluation.java'),(1551,48299,'Bug 48299 – Add Javadoc target to build file','','2009-11-29 06:48:07','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 enhancement','fe2f07b','Mark Emlyn David Thomas','2010-01-05 15:56:14','Improve JavaDoc generation Based on the proposed patch for https://issues.apache.org/bugzilla/show_bug.cgi?id=48299 Also ensure the clean targets clean up fully','dist.xml\nextras.xml'),(1552,48424,'Bug 48424 – Keep same logic for creating the objectnames for connector mbeans','Currently, for connector MBeans, they are registered and unregistered by Connector classes themselves. But in the ServerLifecycle and MBeanUtils, there are also codes for unregistering the connector MBeans. Suppose it is used for double check ?\nThe question is that the codes for creating connector object name are not same, in the MBeanUtils, it always assume that address property is of String type, sometimes that a ClassCastException would be thrown.','2009-12-20 23:29:35','Ivan','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Connectors','P2 normal','da5f249','Mark Emlyn David Thomas','2010-01-05 14:53:38','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48424 Based on a patch by Ivan Ensure that the ObjectNames for the Connectors are always generated using the same method','java/org/apache/catalina/connector/Connector.java\njava/org/apache/catalina/mbeans/MBeanUtils.java'),(1553,48464,'Bug 48464 – Feature request: startup.bat: -title option needed','','2009-12-30 06:08:15','LiuYan 刘研','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Native:Integration','P2 enhancement','e2335d0','Mark Emlyn David Thomas','2010-01-04 06:29:45','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48464 Provide an option to specify the command window title Patch provided by LiuYan','bin/catalina.bat'),(1554,48464,'Bug 48464 – Feature request: startup.bat: -title option needed','','2009-12-30 06:08:15','LiuYan 刘研','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Native:Integration','P2 enhancement','726ee52','Konstantin Kolinko','2010-01-03 09:02:31','Followup to r895191 Fix calling Tomcat Windows scripts from a directory containing \'&\' character, and allow to use this character in the names of CATALINA_HOME/CATALINA_BASE directories. https://issues.apache.org/bugzilla/show_bug.cgi?id=48464#c4','bin/catalina.bat\nbin/digest.bat\nbin/service.bat\nbin/setclasspath.bat\nbin/shutdown.bat\nbin/startup.bat\nbin/tool-wrapper.bat\nbin/version.bat'),(1555,48464,'Bug 48464 – Feature request: startup.bat: -title option needed','','2009-12-30 06:08:15','LiuYan 刘研','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Native:Integration','P2 enhancement','32dfe72','Konstantin Kolinko','2010-01-02 08:47:10','Fix calling Tomcat Windows scripts from a directory containg spaces, as noted in https://issues.apache.org/bugzilla/show_bug.cgi?id=48464#c4 by LiuYan','bin/catalina.bat\nbin/service.bat\nbin/shutdown.bat\nbin/startup.bat\nbin/version.bat'),(1556,48006,'Bug 48006 – Implement the header X-Powered-By suggested by the servlet specification','','2009-10-15 11:34:52','olivier dupuy','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 enhancement','3d309a5','Mark Emlyn David Thomas','2009-12-31 05:46:24','Update X-Powered-By header for Servlet 3.0 / JSP 2.2 and add additional information as suggested by the Servlet Spec and https://issues.apache.org/bugzilla/show_bug.cgi?id=48006','java/org/apache/catalina/connector/CoyoteAdapter.java'),(1557,43819,'Bug 43819 – Support latest JSR245 proposal to make EL \"self-contained\"','','2007-11-08 14:48:53','Christoph Beck','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 normal','9a2ae02','Mark Emlyn David Thomas','2009-12-30 17:20:30','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=43819 Implement ExpressionFactory.newInstance() and ensure that Jasper does not refer to org.apache.el directly JSP 2.1 TCK passes with these changes applied Based on a patch by Christoph Beck','java/javax/el/ExpressionFactory.java\njava/org/apache/jasper/compiler/JspUtil.java\njava/org/apache/jasper/compiler/PageInfo.java\njava/org/apache/jasper/compiler/Validator.java\njava/org/apache/jasper/runtime/JspApplicationContextImpl.java'),(1558,48345,'Bug 48345 – Session does time-out shorter than setting in web.xml when PersistentManager is used.','I am encountering the problem that Session does time-out shorter than setting in web.xml.\n\nThis is a simple scenario where the problem occurs. \n\nI am using PersistentManager by the following configuration.\n<Context>\n  <Manager className=\"org.apache.catalina.session.PersistentManager\"\n           maxIdleSwap=\"120\">\n    <Store className=\"org.apache.catalina.session.FileStore\"/>\n  </Manager>\n</Context>\n\nI am setting the session-timeout at five minutes.\n<session-config>\n    <session-timeout>5</session-timeout>\n</session-config>\n\n[scenario]\n1. Create Session.\n2. 120 seconds pass. \n   Session does swapOut. \n3. In addition, 120 seconds pass. \n   Get Session.\n   Session does swapIn and access time of session in the memory is updated. \n4. In addition, 90 seconds pass.\n   Get Session.\n\nBecause the access time of the session has been updated in (3),\nThe session should be able to be acquired.\nHowever, the session can not be acquired. \n\nThis cause is StoreBase#processExpires invoked between (3) and (4).\nStoreBase#processExpire deletes the session saved in Store.\nStoreBase#processExpires is as follows.\n\n=====StoreBase#processExpires=====\npublic void processExpires() {\n...\n    for (int i = 0; i < keys.length; i++) {\n        try {\n            StandardSession session = (StandardSession) load(keys[i]);\n            if (session == null) {\n                continue;\n            }\n            if (session.isValid()) {\n                continue;\n            }\n              ...\n            if ( ( (PersistentManagerBase) manager).isLoaded( keys[i] )) {\n                // recycle old backup session\n                session.recycle();\n            } else {\n                // expire swapped out session\n                session.expire();\n            }\n            remove(session.getIdInternal());\n        } catch (Exception e) {\n            ...\n        }\n    }\n}\n======\n\nThe session saved in Store is loaded, and StandardSession#isValid() is executed. \nStandardSession#expire(true) is invoked for the session that passes \nsession time-out in \"StandardSession#isValid()\". \n\nStandardSession#expire(true) invokes Manager#remove(Session).\nAs a result, the session is deleted from the session map. \n\nIn a word, session in memory is deleted by invalidating old session in Store. \nAs a result, session does time-out shorter than setting in web.xml\n\nI made a patch against trunk.\n\nBest regards.','2009-12-07 02:09:14','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','d939925','Mark Emlyn David Thomas','2009-12-30 06:30:01','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48345 Patch provided by Keiichi Fujino','java/org/apache/catalina/session/StoreBase.java'),(1559,48417,'Bug 48417 – series of patches to LocalStrings_fr.properties','','2009-12-20 11:48:51','andre w','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 minor','4cbdc0d','Mark Emlyn David Thomas','2009-12-30 06:07:22','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48417 Correct French trabslations Patches provided by André Warnier','java/org/apache/catalina/connector/LocalStrings_fr.properties\njava/org/apache/catalina/core/LocalStrings_fr.properties\njava/org/apache/catalina/ha/LocalStrings_fr.properties\njava/org/apache/catalina/manager/LocalStrings_fr.properties\njava/org/apache/catalina/mbeans/LocalStrings_fr.properties\njava/org/apache/catalina/realm/LocalStrings_fr.properties\njava/org/apache/catalina/session/LocalStrings_fr.properties\njava/org/apache/catalina/startup/LocalStrings_fr.properties\njava/org/apache/catalina/tribes/LocalStrings_fr.properties\njava/org/apache/catalina/util/LocalStrings_fr.properties'),(1560,48454,'Bug 48454 – \"Bad file descriptor\"-IOException in CGIServlet for some programs','','2009-12-29 02:46:52','Markus Grieder','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','ae6c3c4','Mark Emlyn David Thomas','2009-12-30 05:45:34','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48454 Give the stderr reader a chance to finish before terminating the CGI process. This avoids \"Bad file descriptor\" errors. The period to wait is configurable. Based on a patch by Markus Grieder','conf/web.xml\njava/org/apache/catalina/servlets/CGIServlet.java\nwebapps/docs/cgi-howto.xml'),(1561,48443,'Bug 48443 – when the context path is empty,tomcat will startup with a FileNotFoundException','','2009-12-24 22:34:44','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','ff22e4a','Mark Emlyn David Thomas','2009-12-30 04:24:17','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48443 Correct FileNotFoundException on ROOT context start when annotation scanning is enabled Patch provided by wujunchen','java/org/apache/naming/resources/DirContextURLConnection.java'),(1562,47453,'Bug 47453 – JasperException for deferred-method with return type void','','2009-06-30 01:46:56','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','04fbe97','Mark Emlyn David Thomas','2009-12-22 16:17:41','Fix regression (JSP TCK failure) with fix for bug 47453','java/org/apache/jasper/compiler/Validator.java\njava/org/apache/jasper/resources/LocalStrings.properties'),(1563,47413,'Bug 47413 – There is difference in composite ${a}${b} EL expressions between 6.0.18 and 6.0.20','In Tomcat 6.0.18, <c:out> tag that has undefined reference in its value  (like the following snippet) outputs empty string(\"\"), but in Tomcat 6.0.20 outputs null. This is a critical bug.. Please fix it ASAP.\n\n===\n<c:out value=\"${foo.undefined.bar}\" />\n===','2009-06-24 01:45:05','masatonagai','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Servlet & JSP API','P2 critical','b8507e6','Konstantin Kolinko','2009-12-21 16:51:29','Fix second part of Comment 8 in https://issues.apache.org/bugzilla/show_bug.cgi?id=47413#c8 Coerce result of composite EL expression (${a}${b}) from String to the expected type.','java/org/apache/jasper/compiler/Generator.java'),(1564,47963,'Bug 47963 – HTTP status reason-phrase contains illegal characters in Japanese locale','','2009-10-08 07:38:25','Craig Chaney','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','3b6b1a5','Konstantin Kolinko','2009-12-21 01:29:40','Followup for rev.892612 Better fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=47963 Tab character is also allowed in the reason-phrase Also, use more traditional method of iterating over a string.','java/org/apache/tomcat/util/http/HttpMessages.java'),(1565,47963,'Bug 47963 – HTTP status reason-phrase contains illegal characters in Japanese locale','','2009-10-08 07:38:25','Craig Chaney','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','89a4851','Mark Emlyn David Thomas','2009-12-20 12:21:06','Better fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=47963','java/org/apache/coyote/ajp/AjpAprProcessor.java\njava/org/apache/coyote/ajp/AjpProcessor.java\njava/org/apache/coyote/http11/AbstractOutputBuffer.java\njava/org/apache/coyote/http11/InternalAprOutputBuffer.java\njava/org/apache/tomcat/util/http/HttpMessages.java\njava/org/apache/tomcat/util/http/res/LocalStrings.properties\njava/org/apache/tomcat/util/http/res/LocalStrings_es.properties\njava/org/apache/tomcat/util/http/res/LocalStrings_fr.properties\njava/org/apache/tomcat/util/http/res/LocalStrings_ja.properties\nwebapps/docs/config/systemprops.xml'),(1566,47963,'Bug 47963 – HTTP status reason-phrase contains illegal characters in Japanese locale','','2009-10-08 07:38:25','Craig Chaney','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','a576c70','Mark Emlyn David Thomas','2009-12-20 11:35:10','Revert fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=47963 pending a better solution','java/javax/servlet/http/LocalStrings.properties\njava/javax/servlet/http/LocalStrings_es.properties\njava/javax/servlet/http/LocalStrings_fr.properties\njava/javax/servlet/http/LocalStrings_ja.properties\njava/org/apache/catalina/authenticator/LocalStrings.properties\njava/org/apache/catalina/authenticator/LocalStrings_es.properties\njava/org/apache/catalina/authenticator/LocalStrings_fr.properties\njava/org/apache/catalina/authenticator/LocalStrings_ja.properties\njava/org/apache/catalina/core/LocalStrings.properties\njava/org/apache/catalina/core/LocalStrings_es.properties\njava/org/apache/catalina/core/LocalStrings_fr.properties\njava/org/apache/catalina/core/LocalStrings_ja.properties\njava/org/apache/catalina/realm/LocalStrings.properties\njava/org/apache/catalina/realm/LocalStrings_es.properties\njava/org/apache/catalina/realm/LocalStrings_fr.properties\njava/org/apache/catalina/realm/LocalStrings_ja.properties\njava/org/apache/catalina/valves/LocalStrings.properties\njava/org/apache/catalina/valves/LocalStrings_ja.properties\njava/org/apache/jasper/resources/LocalStrings.properties\njava/org/apache/jasper/resources/LocalStrings_es.properties\njava/org/apache/jasper/resources/LocalStrings_fr.properties\njava/org/apache/jasper/resources/LocalStrings_ja.properties'),(1567,48399,'Bug 48399 – Lock fields should be final','','2009-12-16 19:20:55','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','e1d1476','Mark Emlyn David Thomas','2009-12-19 22:46:02','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48399 Make locks final Patch by sebb','java/org/apache/catalina/ha/session/DeltaSession.java\njava/org/apache/catalina/tribes/group/interceptors/OrderInterceptor.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/MultiLockFairBlockingQueue.java'),(1568,48413,'Bug 48413 – correction of typos in valves/LocalStrings_fr.properties','','2009-12-19 02:37:41','andre w','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 minor','ac41425','Mark Emlyn David Thomas','2009-12-19 21:47:37','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48413 Correct translations Patch provided by André Warnier','java/org/apache/catalina/valves/LocalStrings_fr.properties'),(1569,47930,'Bug 47930 – PersistentManager (using filestore) can return different session objects linked to the same session ID, when Tomcat is restarted','','2009-10-01 22:42:57','Sean Soerjanto','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','d9f2c99','Mark Emlyn David Thomas','2009-12-18 13:42:09','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47930 Make swapIn thread safe so parallel requests for the same session don\'t result in multiple session objects for one sesison.','java/org/apache/catalina/session/PersistentManagerBase.java'),(1570,47963,'Bug 47963 – HTTP status reason-phrase contains illegal characters in Japanese locale','','2009-10-08 07:38:25','Craig Chaney','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','87f7faf','Mark Emlyn David Thomas','2009-12-18 11:13:28','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47963 Anything that could end up in an HTTP header must meet the requirements of RFC2616.','java/javax/servlet/http/LocalStrings.properties\njava/javax/servlet/http/LocalStrings_es.properties\njava/javax/servlet/http/LocalStrings_fr.properties\njava/javax/servlet/http/LocalStrings_ja.properties\njava/org/apache/catalina/authenticator/LocalStrings.properties\njava/org/apache/catalina/authenticator/LocalStrings_es.properties\njava/org/apache/catalina/authenticator/LocalStrings_fr.properties\njava/org/apache/catalina/authenticator/LocalStrings_ja.properties\njava/org/apache/catalina/core/LocalStrings.properties\njava/org/apache/catalina/core/LocalStrings_es.properties\njava/org/apache/catalina/core/LocalStrings_fr.properties\njava/org/apache/catalina/core/LocalStrings_ja.properties\njava/org/apache/catalina/realm/LocalStrings.properties\njava/org/apache/catalina/realm/LocalStrings_es.properties\njava/org/apache/catalina/realm/LocalStrings_fr.properties\njava/org/apache/catalina/realm/LocalStrings_ja.properties\njava/org/apache/catalina/valves/LocalStrings.properties\njava/org/apache/catalina/valves/LocalStrings_ja.properties\njava/org/apache/jasper/resources/LocalStrings.properties\njava/org/apache/jasper/resources/LocalStrings_es.properties\njava/org/apache/jasper/resources/LocalStrings_fr.properties\njava/org/apache/jasper/resources/LocalStrings_ja.properties'),(1571,48113,'Bug 48113 – Member hostname components are printed as signed 8bits','','2009-11-03 10:31:25','Quintin Beukes','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Cluster','P2 normal','5b511cd','Konstantin Kolinko','2009-12-17 03:43:25','Followup to rev.883362, fixing https://issues.apache.org/bugzilla/show_bug.cgi?id=48113 Rename method argument. The method prints bytes as unsigned values, not as \"int\"s as the old name implied. Based on the patch by Quintin Beukes','java/org/apache/catalina/tribes/util/Arrays.java'),(1572,47609,'Bug 47609 – Failsafe EOL conversion','','2009-07-30 11:52:49','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Native:Packaging','P2 normal','1030b25','Konstantin Kolinko','2009-12-16 23:05:24','Followup to rev.883125 Additional fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47609 Add patterns for textual files without extension Remove an extra comma','dist.xml'),(1573,47841,'Bug 47841 – CombinedRealm fails to switch to other realm','','2009-09-15 02:01:07','Edward','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','e15db62','Mark Emlyn David Thomas','2009-12-16 06:05:09','Fix bug 47841: CombinedRealm fails to switch to other realm https://issues.apache.org/bugzilla/show_bug.cgi?id=47841 Handle failure of sub-realm during combined realm start','java/org/apache/catalina/realm/CombinedRealm.java\njava/org/apache/catalina/realm/LocalStrings.properties'),(1574,47841,'Bug 47841 – CombinedRealm fails to switch to other realm','','2009-09-15 02:01:07','Edward','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','e15db62','Mark Emlyn David Thomas','2009-12-16 06:05:09','Fix bug 47841: CombinedRealm fails to switch to other realm https://issues.apache.org/bugzilla/show_bug.cgi?id=47841 Handle failure of sub-realm during combined realm start','java/org/apache/catalina/realm/CombinedRealm.java\njava/org/apache/catalina/realm/LocalStrings.properties'),(1575,47841,'Bug 47841 – CombinedRealm fails to switch to other realm','','2009-09-15 02:01:07','Edward','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','d784d08','Mark Emlyn David Thomas','2009-12-16 06:04:24','Side issues from bug 47841 Override getInfo() log messages that use it have useful info Add support for a connectionTimeout attribute','java/org/apache/catalina/realm/JNDIRealm.java\nwebapps/docs/config/realm.xml'),(1576,47841,'Bug 47841 – CombinedRealm fails to switch to other realm','','2009-09-15 02:01:07','Edward','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','e89edd1','Mark Emlyn David Thomas','2009-12-16 06:02:54','Side issue from bug 47841 Overrides getInfo() in Realms so log messages that use it have useful info','java/org/apache/catalina/realm/DataSourceRealm.java\njava/org/apache/catalina/realm/JAASRealm.java\njava/org/apache/catalina/realm/JDBCRealm.java'),(1577,47774,'Bug 47774 – Illegal context class loader is used when HttpSessionListener is executed.','When HttpSessionListener is executed, illegal class loader is set to the context classLoader.\n\nI think that the problem is in CoyoteAdapter#parseSessionCookiesId method. \nJSESSION COOKIE is parsed in this method, and sessionId is set to the request. \n\nTo check sessionId, Request#isRequestedSessionIdValid method is called in this method. \nAnd, Session#isValid() might be called in Request#isRequestedSessionIdValid method. \nHowever, the context class loader of a current thread is StandardClassLoader. \nIt is not WebappClassLoader. \n\nFor instance,\nWhen the session has already passed session-timeout, \nSession#expire is executed.\nAt this time, the context class loader of the thread that executes HttpSessionListenner#sessionDestroyed is StanderdClassLoader. \nThis is not good. \nThe context class loader of the thread that executes HttpSessionListenner should be WebAppClassLoader. \n\n\nBest regards.','2009-09-01 01:58:42','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','06d22b9','Mark Emlyn David Thomas','2009-12-14 17:54:20','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47774 Ensure any session listeners are called with the Thread CCL set to the web application\'s class loader','java/org/apache/catalina/connector/Request.java'),(1578,48387,'Bug 48387 – Make RemoteIpFilter parameters consistent with RemoteIpValve','','2009-12-14 10:28:40','Cyrille Le Clerc','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','803d64d','Mark Emlyn David Thomas','2009-12-14 16:18:34','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48387 Make configuration attributes consistent between Filter and Valves Patch provided by Cyrille Le Clerc','java/org/apache/catalina/filters/RemoteIpFilter.java'),(1579,47769,'Bug 47769 – documentation on web.xml resource-ref does\'nt state optional','','2009-08-31 04:49:13','Martin Gainty','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P2 normal','7a529c9','Mark Emlyn David Thomas','2009-12-14 13:04:54','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47769 Reword JNDI docs in an attempt to make clear why resource-ref elements appear to be optional','webapps/docs/jndi-resources-howto.xml'),(1580,47744,'Bug 47744 – Memory leak when using SSL + Java security manager','','2009-08-26 11:01:57','Greg Vanore','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Connector:Coyote','P2 major','51d5511','Mark Emlyn David Thomas','2009-12-14 09:53:00','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47744 Prevent medium term memory leak when ussing SSL with a security manager Based on a patch by Greg Vanore','java/org/apache/tomcat/util/net/jsse/JSSESupport.java'),(1581,48381,'Bug 48381 – Hostnames in the <Host> section are converted to lower case','','2009-12-11 12:44:32','japel','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','e758ce2','Mark Emlyn David Thomas','2009-12-13 18:03:32','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48381 Add a note about case of host name','webapps/docs/config/host.xml'),(1582,43656,'Bug 43656 – ELSupport.coerceToType won\'t handle null for java.lang.Number','If ELSupport.coerceToType is called with an BigDecimal instance as the first Parameter \'obj\' and \nBigDecimal.class as type it should return the inputted value.\n\nInstead the BigDecimal is converted into a double and back into a BigDecimal which leads to a diffenent \nvalue. This happens in Line 228:\n\n        if (BigInteger.class.equals(type)) {\n            if (number instanceof BigDecimal) {\n                return ((BigDecimal) number).toBigInteger();\n            }\n            return BigInteger.valueOf(number.longValue()); // This leads to a different value.\n        }\n\nExample: Run the Method with new BigDecimal(\"0.19\"), BigDecimal.class as parameters.\nThis should result in a BigDecimal with value 0.19. Instead i got \n0.190000000000000002220446049250313080847263336181640625.\n\n The easiest solution is to compare the class of the object to coerce with the target class and return the \ninputted value if the are equal in ELSupport.coerceToType Method:\n\npublic final static Object coerceToType(final Object obj, final Class type) throws \nIllegalArgumentException {\n		if (type == null || Object.class.equals(type) || type.equals(obj.getClass())) {\n			return obj;\n		}\n...','2007-10-18 18:02:47','Nils Eckert','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Servlet & JSP API','P2 normal','64e2305','Mark Emlyn David Thomas','2009-12-13 17:48:20','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=43656 Correctly coerce null to zero when Number is the required type.','java/org/apache/el/lang/ELSupport.java\ntest/org/apache/el/lang/TestELSupport.java'),(1583,47656,'Bug 47656 – Documentation on server configuration should include note about ant-style variable substitution','The 3.3 documentation mentioned that ant-style variable substitution was available in the server.xml configuration.\n\nThe documentation for 5.5 (and 6.0) doesn\'t seem to mention that anywhere.  It should be included.  Something like:\n\nConfiguration attribute values may use variable substitution (aka dynamic variable values or system property variable values).\n\nThe syntax for doing so is ${varname}\n\nValid variable names come from any system properties (JVM Option) that are available at the time.  Values are only resolved once and not updated until the server is restarted.','2009-08-06 14:37:42','Rodney','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Webapps:Documentation','P2 minor','da2ad8f','Mark Emlyn David Thomas','2009-12-11 08:47:10','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47656 Add information on system property replacement in config files.','webapps/docs/config/index.xml'),(1584,47537,'Bug 47537 – Empty response when forward to login page fails','When tomcat receives a POST request on a session that has timedout, it will forward to the form based login page (form-login-page). \nIf this forward fails for some reason (an error in the login page for instance), tomcat will return an empty HTTP response, without any error code. \n\nThe tomcat log says \"Unexpected error forwarding to login page\" and contains the detailed stacktrace, but i would expect the error to show up in the browser as well (at least a 500 status)','2009-07-15 10:06:41','gui','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','88b5d4b','Mark Emlyn David Thomas','2009-12-11 08:12:57','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47537 Return an error page if a forward during form auth fails rather than a zero length 200 response.','java/org/apache/catalina/authenticator/FormAuthenticator.java\njava/org/apache/catalina/authenticator/LocalStrings.properties'),(1585,48373,'Bug 48373 – Can not get clients from TomcatBayeux','When call the getClients method,there will be a Exception:\njava.lang.ArrayStoreException: java.util.HashMap$Entry\n\nmaybe this method should be:\n\npublic List<Client> getClients() {\n    return java.util.Arrays.asList(clients.values().toArray(new Client[0]));\n}\n\ninstead of this:\n\npublic List<Client> getClients() {\n    return java.util.Arrays.asList(clients.entrySet().toArray(new Client[0]));\n}','2009-12-11 00:22:52','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','Bayeux','P2 normal','b09d817','Mark Emlyn David Thomas','2009-12-11 07:17:27','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48373 Patch suggested by wujunchen','modules/bayeux/java/org/apache/tomcat/bayeux/TomcatBayeux.java'),(1586,48370,'Bug 48370 – PublishRequest.java can not be compiled','There is a log used in org.apache.tomcat.bayeux.request.PublishRequest,but it was not be defined,so the class can not be complied successfully,there should be something like this?\n\nprivate static final Log log = LogFactory.getLog(PublishRequest.class);','2009-12-10 17:24:23','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','Bayeux','P2 normal','9be399f','Mark Emlyn David Thomas','2009-12-11 07:14:05','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48370 Remove some unused imports','modules/bayeux/java/org/apache/tomcat/bayeux/request/PublishRequest.java'),(1587,47507,'Bug 47507 – tomcat-users.xml is rewritten and made world-readable on startup (!)','The file tomcat-users.xml, which may/does contain password information, is made world-readable on startup, perhaps as a side effect of being rewritten.  The rewriting itself seems like a bug (why is this being done?), but chmod\'ing the file to be world-readable is a serious security problem.','2009-07-10 08:33:29','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','44255e9','Mark Emlyn David Thomas','2009-12-10 13:46:39','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47507 Document the UserDatabaseRealm, in particular the readonly attribute of UserDartabase resources.','webapps/docs/config/realm.xml\nwebapps/docs/jndi-resources-howto.xml\nwebapps/docs/realm-howto.xml'),(1588,48324,'Bug 48324 – Javadoc fixes for connector.Request.java','','2009-12-01 16:02:13','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','549a5d5','Mark Emlyn David Thomas','2009-12-10 11:59:29','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48324 Correct JavaDoc. Patch by sebb','java/org/apache/catalina/connector/Request.java'),(1589,47502,'Bug 47502 – clustering fails on serializing javax.security.auth.subject','Clustering fails on serializing javax.security.auth.subject. See stack below.\n\nI looked a little into the Tomcat code. In ./java/org/apache/catalina/connector/Request.java on line 1752 Tomcat puts the \'javax.security.auth.subject\' on the session if you use a securitymanager. This is the MemoryUser in my case I think.\n\nI must use the securitymanager because I use RMI.\n\nIs there a solution possible by making the MemoryUser serializable or by not putting it in the session as an attribute. Mark Thomas <markt_at_apache_dot_org> suggested a note on the session at the Tomcat user-mailinglist. I\'ve never seen notes on sessions.\n\nThe MemoryUser comes from the security-constraint in my web.xml.\n\n\nJul 8, 2009 5:53:52 PM org.apache.catalina.ha.session.DeltaSession writeObject\nSEVERE: Cannot serialize session attribute javax.security.auth.subject for session 9C533E0EB4A79ED5B206B8F5A5DB09AD\njava.io.NotSerializableException: org.apache.catalina.users.MemoryUser\n    at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1156)\n    at java.io.ObjectOutputStream.writeObject(ObjectOutputStream.java:326)\n    at java.util.LinkedList.writeObject(LinkedList.java:943)\n    at sun.reflect.GeneratedMethodAccessor216.invoke(Unknown Source)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:597)\n    at java.io.ObjectStreamClass.invokeWriteObject(ObjectStreamClass.java:945)\n    at java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1461)\n    at java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1392)\n    at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1150)\n    at java.io.ObjectOutputStream.access$300(ObjectOutputStream.java:143)\n    at java.io.ObjectOutputStream$PutFieldImpl.writeFields(ObjectOutputStream.java:1668)\n    at java.io.ObjectOutputStream.writeFields(ObjectOutputStream.java:454)\n    at javax.security.auth.Subject$SecureSet.writeObject(Subject.java:1281)\n    at sun.reflect.GeneratedMethodAccessor215.invoke(Unknown Source)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:597)\n    at java.io.ObjectStreamClass.invokeWriteObject(ObjectStreamClass.java:945)\n    at java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1461)\n    at java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1392)\n    at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1150)\n    at java.io.ObjectOutputStream.defaultWriteFields(ObjectOutputStream.java:1509)\n    at java.io.ObjectOutputStream.defaultWriteObject(ObjectOutputStream.java:416)\n    at java.util.Collections$SynchronizedCollection.writeObject(Collections.java:1602)\n    at sun.reflect.GeneratedMethodAccessor214.invoke(Unknown Source)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:597)\n    at java.io.ObjectStreamClass.invokeWriteObject(ObjectStreamClass.java:945)\n    at java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1461)\n    at java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1392)\n    at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1150)\n    at java.io.ObjectOutputStream.defaultWriteFields(ObjectOutputStream.java:1509)\n    at java.io.ObjectOutputStream.defaultWriteObject(ObjectOutputStream.java:416)\n    at javax.security.auth.Subject.writeObject(Subject.java:919)\n    at sun.reflect.GeneratedMethodAccessor213.invoke(Unknown Source)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n    at java.lang.reflect.Method.invoke(Method.java:597)\n    at java.io.ObjectStreamClass.invokeWriteObject(ObjectStreamClass.java:945)\n    at java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1461)\n    at java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1392)\n    at java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1150)\n    at java.io.ObjectOutputStream.writeObject(ObjectOutputStream.java:326)\n    at org.apache.catalina.ha.session.DeltaSession.writeObject(DeltaSession.java:714)\n    at org.apache.catalina.ha.session.DeltaSession.writeObjectData(DeltaSession.java:475)\n    at org.apache.catalina.ha.session.DeltaSession.writeObjectData(DeltaSession.java:472)\n    at org.apache.catalina.ha.session.DeltaManager.serializeSessions(DeltaManager.java:733)\n    at org.apache.catalina.ha.session.DeltaManager.sendSessions(DeltaManager.java:1513)\n    at org.apache.catalina.ha.session.DeltaManager.handleGET_ALL_SESSIONS(DeltaManager.java:1479)\n    at org.apache.catalina.ha.session.DeltaManager.messageReceived(DeltaManager.java:1310)\n    at org.apache.catalina.ha.session.DeltaManager.messageDataReceived(DeltaManager.java:1093)\n    at org.apache.catalina.ha.session.ClusterSessionListener.messageReceived(ClusterSessionListener.java:87)\n    at org.apache.catalina.ha.tcp.SimpleTcpCluster.messageReceived(SimpleTcpCluster.java:901)\n    at org.apache.catalina.ha.tcp.SimpleTcpCluster.messageReceived(SimpleTcpCluster.java:882)\n    at org.apache.catalina.tribes.group.GroupChannel.messageReceived(GroupChannel.java:269)\n    at org.apache.catalina.tribes.group.ChannelInterceptorBase.messageReceived(ChannelInterceptorBase.java:79)\n    at org.apache.catalina.tribes.group.ChannelInterceptorBase.messageReceived(ChannelInterceptorBase.java:79)\n    at org.apache.catalina.tribes.group.interceptors.TcpFailureDetector.messageReceived(TcpFailureDetector.java:110)\n    at org.apache.catalina.tribes.group.ChannelInterceptorBase.messageReceived(ChannelInterceptorBase.java:79)\n    at org.apache.catalina.tribes.group.ChannelCoordinator.messageReceived(ChannelCoordinator.java:241)\n    at org.apache.catalina.tribes.transport.ReceiverBase.messageDataReceived(ReceiverBase.java:225)\n    at org.apache.catalina.tribes.transport.nio.NioReplicationTask.drainChannel(NioReplicationTask.java:188)\n    at org.apache.catalina.tribes.transport.nio.NioReplicationTask.run(NioReplicationTask.java:91)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n    at java.lang.Thread.run(Thread.java:619)','2009-07-09 05:57:29','Ronald Klop','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Cluster','P2 critical','806200c','Mark Emlyn David Thomas','2009-12-01 19:31:33','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47502 Don\'t try and replicate attributes we know to be non-serializable Patch by Tim Funk','java/org/apache/catalina/ha/session/DeltaSession.java'),(1590,48296,'Bug 48296 – Generics fixes','','2009-11-28 07:42:38','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','ed40c2c','Mark Emlyn David Thomas','2009-12-01 18:21:41','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48296 Generics and JavaDoc fixes Patch provided by sebb','java/org/apache/catalina/ant/jmx/JMXAccessorTask.java\njava/org/apache/catalina/tribes/membership/Membership.java\njava/org/apache/naming/resources/DirContextURLConnection.java'),(1591,47453,'Bug 47453 – JasperException for deferred-method with return type void','','2009-06-30 01:46:56','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','7a14f93','Mark Emlyn David Thomas','2009-12-01 17:52:55','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47453 Handle void return types. Patch by Tim Funk.','java/org/apache/jasper/compiler/JspUtil.java'),(1592,47342,'Bug 47342 – ReplicatedContext#start throws NullPointerException.','','2009-06-10 02:48:24','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Cluster','P2 normal','9afe6ce','Mark Emlyn David Thomas','2009-11-27 17:23:40','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47342 Make sure replicated context is initialised before accessing fields Patch provided by Keiichi Fujino','java/org/apache/catalina/ha/context/ReplicatedContext.java'),(1593,48289,'Bug 48289 – ElSupport - Javadoc and generics fixes','','2009-11-25 16:35:49','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 normal','b8599a3','Mark Emlyn David Thomas','2009-11-27 13:20:12','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48289 Javadoc / generics fixes Patch procided by sebb','java/org/apache/el/lang/ELSupport.java\ntest/org/apache/el/TestELEvaluation.java'),(1594,48288,'Bug 48288 – Patch to fix generics in javax.el package helpers','','2009-11-25 15:43:06','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 normal','2ac1900','Mark Emlyn David Thomas','2009-11-27 13:14:19','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48288 Supress some warnings Patch provided by sebb','java/org/apache/el/lang/EvaluationContext.java\njava/org/apache/jasper/el/ELContextWrapper.java'),(1595,48287,'Bug 48287 – ApplicationContextFacade - generics fixes','','2009-11-25 15:36:20','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','ce8d1c5','Mark Emlyn David Thomas','2009-11-27 13:11:34','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48287 Eclipse warnings Patch provided by sebb','java/org/apache/catalina/core/ApplicationContextFacade.java'),(1596,48285,'Bug 48285 – ApplicationFilterFactory.matchDispatcher() fails to check ASYNC','catalina.core.ApplicationFilterFactory.matchDispatcher(FilterMap filterMap, DispatcherType type) fails to check for type == ASYNC\n\nThe extra case ought to be added (but I don\'t know what it should contain, so cannot provide a patch)','2009-11-25 08:41:12','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','f0a0aec','Mark Emlyn David Thomas','2009-11-27 13:01:12','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48285 Add handling of Async dispatcher types','java/org/apache/catalina/core/ApplicationFilterFactory.java\njava/org/apache/catalina/deploy/FilterMap.java'),(1597,48282,'Bug 48282 – Possible NPE in org.apache.tomcat.util.modeler.Registry','','2009-11-25 07:42:40','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','56897be','Mark Emlyn David Thomas','2009-11-27 12:17:12','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48282 Correct possible NPE Patch provided by sebb','java/org/apache/tomcat/util/modeler/Registry.java'),(1598,48267,'Bug 48267 – Patch to fix generics in javax packages','','2009-11-23 13:22:35','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 normal','632e68c','Mark Emlyn David Thomas','2009-11-27 12:14:16','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48267 Generics Patch provided by sebb','java/javax/annotation/Resource.java\njava/javax/ejb/EJB.java\njava/javax/el/BeanELResolver.java\njava/javax/el/ELContext.java\njava/javax/el/ListELResolver.java\njava/javax/el/MapELResolver.java\njava/javax/el/ResourceBundleELResolver.java\njava/javax/xml/ws/WebServiceRef.java'),(1599,48297,'Bug 48297 – webservices.ServiceRefFactory.initHandlerChain adds wrong items to list?','','2009-11-28 19:01:37','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','bd8f52c','Mark Emlyn David Thomas','2009-11-27 11:57:21','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48297 Missing french translations and some weird sentences Patch provided by Marc Paquette','java/org/apache/catalina/manager/LocalStrings_fr.properties'),(1600,48295,'Bug 48295 – ProxyPassReverseCookiePath: Not changing path correctly.','','2009-11-27 22:26:38','Jie Gao','Apache HTTPD Bugs Mailing List','REOPENED','Apache httpd-2','mod_proxy','P2 normal','b04f792','Mark Emlyn David Thomas','2009-11-27 11:53:37','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48295 Correct French translations. Patch provided by Marc Paquette','java/org/apache/catalina/core/LocalStrings_fr.properties\njava/org/apache/catalina/manager/LocalStrings_fr.properties\njava/org/apache/catalina/session/LocalStrings_fr.properties'),(1601,48266,'Bug 48266 – Patch to fix generics in catalina','','2009-11-23 13:21:28','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','21cd308','Mark Emlyn David Thomas','2009-11-24 20:00:07','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48266 Generics and unused imports. Patch by sebb','java/org/apache/catalina/ant/jmx/JMXAccessorTask.java\njava/org/apache/catalina/connector/Request.java\njava/org/apache/catalina/core/StandardPart.java\njava/org/apache/catalina/ha/backend/CollectedInfo.java\njava/org/apache/catalina/ha/session/BackupManager.java\njava/org/apache/catalina/ha/tcp/ReplicationValve.java\njava/org/apache/catalina/tribes/tipis/AbstractReplicatedMap.java\njava/org/apache/catalina/tribes/transport/bio/MultipointBioSender.java'),(1602,47836,'Bug 47836 – TldConfig keeps an internal list of ApplicationListeners','','2009-09-14 07:03:43','Guillaume Sauthier','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','92e53f3','Mark Emlyn David Thomas','2009-11-23 20:27:40','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47836 Don\'t keep TLD/listener info between reloads','java/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/startup/TldConfig.java'),(1603,48113,'Bug 48113 – Member hostname components are printed as signed 8bits','','2009-11-03 10:31:25','Quintin Beukes','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Cluster','P2 normal','e43b385','Mark Emlyn David Thomas','2009-11-23 10:10:20','Rest of fix required for https://issues.apache.org/bugzilla/show_bug.cgi?id=48113 Based on a patch by Quintin Beukes','java/org/apache/catalina/tribes/util/Arrays.java'),(1604,48233,'Bug 48233 – Loggers should be private','','2009-11-18 16:34:39','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','a02d4b3','Mark Emlyn David Thomas','2009-11-22 19:46:20','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48233 Reduce visibility of loggers Patch provided by sebb','java/org/apache/catalina/core/ApplicationDispatcher.java\njava/org/apache/catalina/core/AsyncContextImpl.java\njava/org/apache/catalina/core/JreMemoryLeakPreventionListener.java\njava/org/apache/catalina/ha/jmx/ClusterJmxHelper.java\njava/org/apache/catalina/ha/session/SerializablePrincipal.java\njava/org/apache/catalina/loader/WebappClassLoader.java\njava/org/apache/catalina/session/ManagerBase.java\njava/org/apache/catalina/session/StandardManager.java\njava/org/apache/catalina/startup/ConnectorCreateRule.java\njava/org/apache/catalina/startup/ContextConfig.java\njava/org/apache/catalina/startup/DigesterFactory.java\njava/org/apache/catalina/startup/EngineConfig.java\njava/org/apache/catalina/startup/HostConfig.java\njava/org/apache/catalina/tribes/group/ChannelInterceptorBase.java\njava/org/apache/catalina/tribes/group/GroupChannel.java\njava/org/apache/catalina/tribes/group/RpcChannel.java\njava/org/apache/catalina/tribes/group/interceptors/GzipInterceptor.java\njava/org/apache/catalina/tribes/group/interceptors/MessageDispatchInterceptor.java\njava/org/apache/catalina/tribes/group/interceptors/NonBlockingCoordinator.java\njava/org/apache/catalina/tribes/group/interceptors/TcpPingInterceptor.java\njava/org/apache/catalina/tribes/group/interceptors/ThroughputInterceptor.java\njava/org/apache/catalina/tribes/io/BufferPool.java\njava/org/apache/catalina/tribes/io/ObjectReader.java\njava/org/apache/catalina/tribes/tipis/ReplicatedMap.java\njava/org/apache/catalina/tribes/transport/bio/BioReplicationTask.java\njava/org/apache/catalina/tribes/transport/nio/NioReceiver.java\njava/org/apache/catalina/tribes/transport/nio/NioSender.java\njava/org/apache/catalina/tribes/transport/nio/ParallelNioSender.java\njava/org/apache/catalina/tribes/util/Arrays.java\njava/org/apache/coyote/ajp/AjpAprProcessor.java\njava/org/apache/coyote/ajp/AjpAprProtocol.java\njava/org/apache/coyote/ajp/AjpMessage.java\njava/org/apache/coyote/ajp/AjpProcessor.java\njava/org/apache/coyote/ajp/AjpProtocol.java\njava/org/apache/coyote/http11/AbstractHttp11Processor.java\njava/org/apache/coyote/http11/Http11AprProcessor.java\njava/org/apache/coyote/http11/Http11AprProtocol.java\njava/org/apache/coyote/http11/Http11NioProcessor.java\njava/org/apache/coyote/http11/Http11Processor.java\njava/org/apache/jasper/JspC.java\njava/org/apache/jasper/JspCompilationContext.java\njava/org/apache/jasper/compiler/AntCompiler.java\njava/org/apache/jasper/compiler/Compiler.java\njava/org/apache/jasper/compiler/JDTCompiler.java\njava/org/apache/tomcat/util/digester/GenericParser.java\njava/org/apache/tomcat/util/digester/XercesParser.java\njava/org/apache/tomcat/util/net/AprEndpoint.java\njava/org/apache/tomcat/util/net/JIoEndpoint.java\njava/org/apache/tomcat/util/net/NioBlockingSelector.java\njava/org/apache/tomcat/util/net/NioSelectorPool.java\nmodules/bayeux/java/org/apache/tomcat/bayeux/BayeuxServlet.java\nmodules/bayeux/java/org/apache/tomcat/bayeux/ChannelImpl.java\nmodules/bayeux/java/org/apache/tomcat/bayeux/ClientImpl.java\nmodules/bayeux/java/org/apache/tomcat/bayeux/RequestBase.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/DataSource.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/DataSourceFactory.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/DataSourceProxy.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/PoolProperties.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/PooledConnection.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/interceptor/ConnectionState.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/interceptor/StatementFinalizer.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/jmx/ConnectionPool.java\nmodules/tomcat-lite/java/org/apache/tomcat/servlets/session/RandomGenerator.java\nmodules/tomcat-lite/java/org/apache/tomcat/servlets/session/SimpleSessionManager.java\ntest/org/apache/catalina/tribes/demos/LoadTest.java\nwebapps/examples/WEB-INF/classes/async/Async0.java\nwebapps/examples/WEB-INF/classes/async/Async1.java\nwebapps/examples/WEB-INF/classes/async/Async2.java\nwebapps/examples/WEB-INF/classes/async/Async3.java'),(1605,48239,'Bug 48239 – HexUtils exposes public array','','2009-11-19 07:48:12','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','55e5052','Mark Emlyn David Thomas','2009-11-22 19:36:10','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48239 HexUtils exposes public array Based on a patch provided by sebb','java/org/apache/coyote/ajp/AjpAprProcessor.java\njava/org/apache/coyote/ajp/AjpProcessor.java\njava/org/apache/coyote/http11/Http11AprProcessor.java\njava/org/apache/coyote/http11/Http11NioProcessor.java\njava/org/apache/coyote/http11/Http11Processor.java\njava/org/apache/coyote/http11/filters/ChunkedInputFilter.java\njava/org/apache/coyote/http11/filters/ChunkedOutputFilter.java\njava/org/apache/tomcat/util/buf/HexUtils.java\njava/org/apache/tomcat/util/buf/MessageBytes.java'),(1606,48248,'Bug 48248 – tribes.group.interceptors.MessageDispatchInterceptor.run should be volatile','org.apache.catalina.tribes.group.interceptors.MessageDispatchInterceptor.run should be volatile, as it is used to communicate between running threads.','2009-11-20 04:56:14','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','a524187','Mark Emlyn David Thomas','2009-11-22 19:31:43','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48248 Use volatile since field is accessed by multiple threads','java/org/apache/catalina/tribes/group/GroupChannel.java\njava/org/apache/catalina/tribes/group/interceptors/MessageDispatchInterceptor.java\njava/org/apache/catalina/tribes/group/interceptors/TcpPingInterceptor.java\njava/org/apache/catalina/tribes/membership/McastServiceImpl.java'),(1607,48249,'Bug 48249 – org.apache.tomcat.util.net.NioBlockingSelector.BlockPoller.run <= volatile','org.apache.tomcat.util.net.NioBlockingSelector.BlockPoller.run should be volatile, as it is used to communicate between running threads.','2009-11-20 05:06:47','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','c7d7ba2','Mark Emlyn David Thomas','2009-11-22 19:28:03','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48249 Use volatile since field is accessed by multiple threads','java/org/apache/tomcat/util/net/NioBlockingSelector.java'),(1608,48257,'Bug 48257 – typo in spanish translation','','2009-11-21 04:50:07','Guillermo Gutiérrez','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Manager application','P2 normal','97aa819','Mark Emlyn David Thomas','2009-11-22 18:31:18','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48257 Patch provided by Guillermo Gutiérrez','java/org/apache/catalina/manager/LocalStrings_es.properties'),(1609,48049,'Bug 48049 – org.apache.naming.NamingContext\'s destroySubcontext() method doesn\'t  invoke itself recursively, but invoke unbind() method','Below is the original implementation of destroySubcontext(Name name) method:\n\npublic void destroySubcontext(Name name)\n        throws NamingException {\n        \n        checkWritable();\n        \n        while ((!name.isEmpty()) && (name.get(0).length() == 0))\n            name = name.getSuffix(1);\n        if (name.isEmpty())\n            throw new NamingException\n                (sm.getString(\"namingContext.invalidName\"));\n        \n        NamingEntry entry = (NamingEntry) bindings.get(name.get(0));\n        \n        if (entry == null) {\n            throw new NameNotFoundException\n                (sm.getString(\"namingContext.nameNotBound\", name.get(0)));\n        }\n        \n        if (name.size() > 1) {\n            if (entry.type == NamingEntry.CONTEXT) {\n                ((Context) entry.value).unbind(name.getSuffix(1));\n            } else {\n                throw new NamingException\n                    (sm.getString(\"namingContext.contextExpected\"));\n            }\n        } else {\n            if (entry.type == NamingEntry.CONTEXT) {\n                ((Context) entry.value).close();\n                bindings.remove(name.get(0));\n            } else {\n                throw new NotContextException\n                    (sm.getString(\"namingContext.contextExpected\"));\n            }\n        }\n        \n    }\n\n\nHowever, the method invokes \'unbind\' method rather than invokes itself recursively. \n\nif (name.size() > 1) {\n            if (entry.type == NamingEntry.CONTEXT) {\n                ((Context) entry.value).unbind(name.getSuffix(1));\n            } else {\n                throw new NamingException\n                    (sm.getString(\"namingContext.contextExpected\"));\n            }\n\nshould be: \n\nif (name.size() > 1) {\n            if (entry.type == NamingEntry.CONTEXT) {\n                ((Context) entry.value).destroySubcontext(name.getSuffix(1));\n            } else {\n                throw new NamingException\n                    (sm.getString(\"namingContext.contextExpected\"));\n            }','2009-10-25 07:24:55','qingyang.xu','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','af8a612','Mark Emlyn David Thomas','2009-11-22 17:56:53','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48049 Correct copy and paste error and call correct function','java/org/apache/naming/NamingContext.java'),(1610,47799,'Bug 47799 – Domain does not work in Membership and DomainFilterInterceptor.','','2009-09-08 02:39:42','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Cluster','P2 normal','94c643b','Mark Emlyn David Thomas','2009-11-22 17:37:43','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47799 Unable to configure domain in Membership and DomainFilterInterceptor Patch provided by Keiichi Fujino','java/org/apache/catalina/tribes/group/interceptors/DomainFilterInterceptor.java\njava/org/apache/catalina/tribes/membership/McastService.java'),(1611,47462,'Bug 47462 – The annotation doesn\'t become effective.(metadata-complete=\"false\" is not effective.)','','2009-07-01 02:51:39','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','04b0838','Mark Emlyn David Thomas','2009-11-22 15:49:04','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47462 Need to be able to override metadata complete if set in the global web.xml Patch provided by Keiichi Fujino','java/org/apache/catalina/startup/WebRuleSet.java'),(1612,47997,'Bug 47997 – NamingContextListener fails to add itself as a PropertyChangeListener to all namingResources','','2009-10-14 17:45:53','Michael Allman','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','58162ed','Mark Emlyn David Thomas','2009-11-22 14:59:51','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47997 Process changes to the naming resources for all JNDI contexts, not just the global one. Patch by Michael Allman','java/org/apache/catalina/core/NamingContextListener.java'),(1613,47718,'Bug 47718 – ManagerBase leaks fd to /dev/urandom when context stopped','On operating systems where /dev/urandom exists, org.apache.catalina.session.ManagerBase will use it as a source of data for getRandomBytes().\n\nIf you stop a context or undeploy a host, the number of file descriptors that have /dev/urandom open tomcat remains constant.\n\nFor example, if you use the manager application to stop or undeploy a context, the number of file descriptors to /dev/urandom is the same as before the stop.\n\nFile descriptor use is determined by using lsof or examining the /proc/<pid>/fd directory on Linux.\n\nThe same issue is seen if you undeploy a virtual host.\n\nIf you undeploy/deploy a context, or remove/add a virtual host, the # of file descriptors to /dev/urandom will increase each time.\n\nThis is because ManagerBase does not close the DataInputStream it holds to /dev/urandom.\n\nThe patch shown below resolves this issue. Stopping a context, or undeploying a virtual host will close the session manager\'s reference to /dev/urandom.\n\n--- apache-tomcat-5.5.28-src/container/catalina/src/share/org/apache/catalina/session/ManagerBase.java	2009-07-24 13:35:00.000000000 -0600\n+++ apache-tomcat-5.5.28-gls/container/catalina/src/share/org/apache/catalina/session/ManagerBase.java	2009-08-20 13:38:03.000000000 -0600\n@@ -688,10 +688,17 @@\n     }\n\n    public void destroy() {\n         if( oname != null )\n             Registry.getRegistry(null, null).unregisterComponent(oname);\n+        if (randomIS!=null) {\n+            try {\n+                randomIS.close();\n+            } catch (IOException ioe) {\n+            }\n+            randomIS=null;\n+        }\n         initialized=false;\n         oname = null;\n         // Don\'t clear log since it is required in case attributes are changed\n         // (eg via JMX) whilst the manager is stopped.\n     }','2009-08-20 14:48:26','George Sexton','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','ae5c640','Mark Emlyn David Thomas','2009-11-22 14:39:33','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47718 Correct file descriptor leak on context reload/stop Patch provided by George Sexton','java/org/apache/catalina/session/ManagerBase.java'),(1614,47609,'Bug 47609 – Failsafe EOL conversion','','2009-07-30 11:52:49','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Native:Packaging','P2 normal','2bc29d7','Mark Emlyn David Thomas','2009-11-22 14:18:19','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47609 Implment fail-safe EOL conversion for source disributions Based on a patch provided by sebb','dist.xml'),(1615,48252,'Bug 48252 – StackOverflowError in NioEndpoint.setProperty when setting jkHome','- Noticed only when running in debugger with breakpoint set for StackOverflowError.\n- The error is translated by Java\'s reflection mechanism to an InvocationTargetException, which is caught and silently ignored by IntrospectionUtils.\n\n- Connector.initialize() sets jkHome property on Http11NioProtocol.\n- Http11NioProtocol sets jkHome property on NioEndpoint.\n- NioEndpoint recursively invokes its own setProperty method via IntrospectionUtils.setProperty, causing the stack overflow.\n\n- Using embedded Tomcat.\n- Using Nio connector. Does not happen for standard connector.\n- Happens in 6.0.18 and 6.0.20; haven\'t tested with earlier versions.','2009-11-20 08:25:45','James Dobson','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 normal','c0cb61b','Filip Hanik','2009-11-20 11:57:31','https://issues.apache.org/bugzilla/show_bug.cgi?id=48252 Fix potential recursion','java/org/apache/tomcat/util/IntrospectionUtils.java\njava/org/apache/tomcat/util/net/AbstractEndpoint.java'),(1616,48234,'Bug 48234 – org.apache.catalina.core.ContainerBase.getLogger() not thread-safe?','org.apache.catalina.core.ContainerBase.getLogger() is not synchronised, yet all the other methods which access org.apache.catalina.core.ContainerBase.logger are synch. This seems wrong.\n\norg.apache.catalina.core.ContainerBase.logger should probably be private to prevent unsynch. access by subclasses.\n\nSimilar considerations apply to logName and logName()\n\nThe Javadoc for getLogger() states that it can return null - that does not appear to be possible. [Not sure if the method ever returns the parent logger either.]','2009-11-18 17:41:42','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','c53173b','Mark Emlyn David Thomas','2009-11-18 21:01:57','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48234 Align Javadoc with code','java/org/apache/catalina/core/ContainerBase.java'),(1617,48233,'Bug 48233 – Loggers should be private','','2009-11-18 16:34:39','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','68ac96e','Mark Emlyn David Thomas','2009-11-18 19:46:52','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48233 More loggers to private static final','java/org/apache/catalina/core/StandardWrapper.java\njava/org/apache/catalina/ha/context/ReplicatedContext.java\njava/org/apache/catalina/ha/deploy/FarmWarDeployer.java\njava/org/apache/catalina/ha/deploy/FileMessageFactory.java\njava/org/apache/catalina/ha/deploy/WarWatcher.java\njava/org/apache/catalina/ha/session/BackupManager.java\njava/org/apache/catalina/tribes/tipis/AbstractReplicatedMap.java\njava/org/apache/catalina/tribes/tipis/LazyReplicatedMap.java\njava/org/apache/catalina/tribes/transport/ReceiverBase.java\njava/org/apache/catalina/tribes/transport/bio/BioReceiver.java\njava/org/apache/tomcat/util/net/AbstractEndpoint.java\njava/org/apache/tomcat/util/net/NioEndpoint.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/interceptor/AbstractQueryReport.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/interceptor/SlowQueryReport.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/interceptor/SlowQueryReportJmx.java'),(1618,48172,'Bug 48172 – JspRuntimeContext synch. problems.','JspRuntimeContext.jspReloadCount is synchronised when updated, but not when read by getJspReloadCount().\n\nIf the instance is accessed from multiple threads, then the returned value may not be the current value, it could be arbitrarily stale.\n\nIf this is acceptable, then the Javadoc should say so; otherwise the getter needs to be synch. (or the field needs to be volatile) Or just use AtomicInteger.\n\n==\n\nVarious other fields are neither final nor synchronized, e.g.\n\nclasspath\ncodeSource\netc.\n\nAs far as I can tell, these could easily be made final as they are only written by the constructor.','2009-11-11 03:23:50','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Jasper','P2 normal','242b6a3','Mark Emlyn David Thomas','2009-11-18 18:33:57','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48172 Potential threading issues, make fields final where possible','java/org/apache/jasper/compiler/JspRuntimeContext.java'),(1619,48197,'Bug 48197 – XByteBuffer: privatize public fields; fix Javadoc','','2009-11-14 06:29:45','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','a1cb0c3','Mark Emlyn David Thomas','2009-11-18 18:22:13','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48197 Reduce visibility where possible Fix javadoc Based on a patch by sebb','java/org/apache/catalina/tribes/io/XByteBuffer.java'),(1620,48230,'Bug 48230 – Unused imports','','2009-11-18 14:00:17','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','84d49a0','Mark Emlyn David Thomas','2009-11-18 18:10:53','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48230 Remove unused imports. Patch provided by sebb.','java/org/apache/catalina/Authenticator.java\njava/org/apache/catalina/authenticator/FormAuthenticator.java\njava/org/apache/tomcat/util/net/NioEndpoint.java\nmodules/jdbc-pool/test/org/apache/tomcat/jdbc/test/TestSuspectTimeout.java'),(1621,48217,'Bug 48217 – Loggers should be final','','2009-11-17 16:30:07','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','0d7263a','Mark Emlyn David Thomas','2009-11-18 07:10:12','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48217 Make logs final and private; add missing @Override markers Patch provided by sebb.','java/org/apache/coyote/http11/AbstractHttp11Protocol.java\njava/org/apache/coyote/http11/Http11NioProtocol.java\njava/org/apache/coyote/http11/Http11Protocol.java'),(1622,48196,'Bug 48196 – Public arrays that should be private','','2009-11-14 06:28:06','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','38f52b5','Mark Emlyn David Thomas','2009-11-17 18:03:43','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48196 Reduce visibility. Patch by sebb.','java/org/apache/catalina/startup/Tomcat.java\njava/org/apache/catalina/tribes/group/interceptors/TwoPhaseCommitInterceptor.java\njava/org/apache/catalina/util/HexUtils.java'),(1623,48176,'Bug 48176 – Fields that should be final','','2009-11-11 08:01:28','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','16c4534','Mark Emlyn David Thomas','2009-11-17 18:00:31','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48176 Make fields final. Patch by sebb.','java/org/apache/catalina/tribes/io/BufferPool.java\njava/org/apache/jasper/compiler/ServletWriter.java\nmodules/tomcat-lite/java/org/apache/tomcat/util/http/MimeMap.java'),(1624,48175,'Bug 48175 – Loggers should be final','','2009-11-11 07:37:28','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','799b934','Mark Emlyn David Thomas','2009-11-17 17:59:34','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48175 Make loggers final. Patch by sebb with minor modification as original patch broke compilation','java/org/apache/catalina/core/ApplicationFilterConfig.java\njava/org/apache/catalina/core/ContainerBase.java\njava/org/apache/catalina/core/StandardHost.java\njava/org/apache/catalina/core/StandardWrapper.java\njava/org/apache/catalina/ha/ClusterListener.java\njava/org/apache/catalina/ha/context/ReplicatedContext.java\njava/org/apache/catalina/ha/deploy/FarmWarDeployer.java\njava/org/apache/catalina/ha/deploy/FileMessageFactory.java\njava/org/apache/catalina/ha/deploy/WarWatcher.java\njava/org/apache/catalina/ha/session/BackupManager.java\njava/org/apache/catalina/ha/session/DeltaManager.java\njava/org/apache/catalina/ha/session/DeltaRequest.java\njava/org/apache/catalina/ha/session/DeltaSession.java\njava/org/apache/catalina/ha/session/JvmRouteBinderValve.java\njava/org/apache/catalina/ha/session/SerializablePrincipal.java\njava/org/apache/catalina/ha/session/SimpleTcpReplicationManager.java\njava/org/apache/catalina/ha/tcp/ReplicationValve.java\njava/org/apache/catalina/loader/WebappClassLoader.java\njava/org/apache/catalina/loader/WebappLoader.java\njava/org/apache/catalina/mbeans/MBeanFactory.java\njava/org/apache/catalina/security/SecurityConfig.java\njava/org/apache/catalina/security/SecurityUtil.java\njava/org/apache/catalina/startup/Catalina.java\njava/org/apache/catalina/startup/CatalinaProperties.java\njava/org/apache/catalina/startup/ContextConfig.java\njava/org/apache/catalina/startup/DefaultJarScanner.java\njava/org/apache/catalina/startup/DigesterFactory.java\njava/org/apache/catalina/startup/EngineConfig.java\njava/org/apache/catalina/startup/HostConfig.java\njava/org/apache/catalina/startup/TldConfig.java\njava/org/apache/catalina/startup/UserConfig.java\njava/org/apache/catalina/startup/WebXml.java\njava/org/apache/catalina/tribes/group/ChannelInterceptorBase.java\njava/org/apache/catalina/tribes/group/GroupChannel.java\njava/org/apache/catalina/tribes/group/RpcChannel.java\njava/org/apache/catalina/tribes/group/interceptors/FragmentationInterceptor.java\njava/org/apache/catalina/tribes/group/interceptors/MessageDispatchInterceptor.java\njava/org/apache/catalina/tribes/group/interceptors/TcpFailureDetector.java\njava/org/apache/catalina/tribes/group/interceptors/TcpPingInterceptor.java\njava/org/apache/catalina/tribes/group/interceptors/ThroughputInterceptor.java\njava/org/apache/catalina/tribes/group/interceptors/TwoPhaseCommitInterceptor.java\njava/org/apache/catalina/tribes/io/ObjectReader.java\njava/org/apache/catalina/tribes/io/XByteBuffer.java\njava/org/apache/catalina/tribes/membership/McastService.java\njava/org/apache/catalina/tribes/membership/McastServiceImpl.java\njava/org/apache/catalina/tribes/tipis/LazyReplicatedMap.java\njava/org/apache/catalina/tribes/tipis/ReplicatedMap.java\njava/org/apache/catalina/tribes/transport/bio/BioReceiver.java\njava/org/apache/catalina/tribes/transport/bio/BioReplicationTask.java\njava/org/apache/catalina/tribes/transport/bio/BioSender.java\njava/org/apache/catalina/tribes/transport/bio/util/FastQueue.java\njava/org/apache/catalina/tribes/transport/nio/NioReceiver.java\njava/org/apache/catalina/tribes/transport/nio/NioReplicationTask.java\njava/org/apache/catalina/tribes/transport/nio/NioSender.java\njava/org/apache/catalina/tribes/transport/nio/ParallelNioSender.java\njava/org/apache/catalina/tribes/util/Logs.java\njava/org/apache/catalina/util/ExtensionValidator.java\njava/org/apache/coyote/ajp/AjpAprProcessor.java\njava/org/apache/coyote/ajp/AjpAprProtocol.java\njava/org/apache/coyote/ajp/AjpMessage.java\njava/org/apache/coyote/ajp/AjpProcessor.java\njava/org/apache/coyote/ajp/AjpProtocol.java\njava/org/apache/coyote/http11/AbstractHttp11Processor.java\njava/org/apache/coyote/http11/Http11AprProcessor.java\njava/org/apache/coyote/http11/Http11AprProtocol.java\njava/org/apache/coyote/http11/Http11NioProtocol.java\njava/org/apache/coyote/http11/Http11Protocol.java\njava/org/apache/jasper/JspCompilationContext.java\njava/org/apache/jasper/compiler/SmapUtil.java\njava/org/apache/jasper/security/SecurityClassLoad.java\njava/org/apache/jasper/xmlparser/UCSReader.java\njava/org/apache/jasper/xmlparser/UTF8Reader.java\njava/org/apache/naming/NamingContext.java\njava/org/apache/naming/SelectorContext.java\njava/org/apache/naming/resources/FileDirContext.java\njava/org/apache/naming/resources/WARDirContext.java\njava/org/apache/tomcat/util/DomUtil.java\njava/org/apache/tomcat/util/IntrospectionUtils.java\njava/org/apache/tomcat/util/buf/B2CConverter.java\njava/org/apache/tomcat/util/buf/C2BConverter.java\njava/org/apache/tomcat/util/buf/StringCache.java\njava/org/apache/tomcat/util/buf/UEncoder.java\njava/org/apache/tomcat/util/http/Cookies.java\njava/org/apache/tomcat/util/http/Parameters.java\njava/org/apache/tomcat/util/http/mapper/Mapper.java\njava/org/apache/tomcat/util/net/SSLImplementation.java\njava/org/apache/tomcat/util/net/jsse/JSSEImplementation.java\njava/org/apache/tomcat/util/net/jsse/JSSESocketFactory.java\njava/org/apache/tomcat/util/net/jsse/JSSESupport.java\nmodules/tomcat-lite/java/org/apache/tomcat/util/http/mapper/BaseMapper.java\ntest/org/apache/catalina/tribes/demos/IntrospectionUtils.java'),(1625,48174,'Bug 48174 – org.apache.tomcat.jni.Address.APR_ANYADDR should be final','org.apache.tomcat.jni.Address.APR_ANYADDR should be final','2009-11-11 07:14:34','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Integration','P2 normal','57571a7','Mark Emlyn David Thomas','2009-11-17 17:47:39','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48174 Use final','java/org/apache/tomcat/jni/Address.java'),(1626,48173,'Bug 48173 – org.apache.catalina.tribes.io.ChannelData.EMPTY_DATA_ARRAY should be final','org.apache.catalina.tribes.io.ChannelData.EMPTY_DATA_ARRAY should be final','2009-11-11 06:59:39','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','e5ae1bc','Mark Emlyn David Thomas','2009-11-17 17:46:41','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48173 Use final','java/org/apache/catalina/tribes/io/ChannelData.java'),(1627,48151,'Bug 48151 – Java files that don\'t have AL headers','','2009-11-06 03:06:03','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','5447621','Mark Emlyn David Thomas','2009-11-17 17:44:58','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48151 Add missing AL2 headers','java/org/apache/catalina/startup/DefaultJarScanner.java\njava/org/apache/tomcat/JarScannerCallback.java\nmodules/jdbc-pool/test/org/apache/tomcat/jdbc/test/TestConcurrency.java\nmodules/jdbc-pool/test/org/apache/tomcat/jdbc/test/TestException.java\nmodules/jdbc-pool/test/org/apache/tomcat/jdbc/test/driver/ResultSet.java\nmodules/tomcat-lite/examples/spring/TomcatSpring.java\nmodules/tomcat-lite/java/org/apache/tomcat/addons/Filesystem.java\nmodules/tomcat-lite/java/org/apache/tomcat/addons/UserAuthentication.java\nmodules/tomcat-lite/java/org/apache/tomcat/addons/UserSessionManager.java\nmodules/tomcat-lite/java/org/apache/tomcat/addons/UserTemplateClassMapper.java\nmodules/tomcat-lite/java/org/apache/tomcat/integration/ObjectManager.java\nmodules/tomcat-lite/java/org/apache/tomcat/integration/jmx/JmxObjectManagerSpi.java\nmodules/tomcat-lite/java/org/apache/tomcat/integration/simple/LocalFilesystem.java\nmodules/tomcat-lite/java/org/apache/tomcat/integration/simple/Main.java\nmodules/tomcat-lite/java/org/apache/tomcat/integration/simple/ServletHelper.java\nmodules/tomcat-lite/java/org/apache/tomcat/integration/simple/SimpleObjectManager.java\nmodules/tomcat-lite/java/org/apache/tomcat/lite/BodyWriter.java\nmodules/tomcat-lite/java/org/apache/tomcat/lite/Connector.java\nmodules/tomcat-lite/java/org/apache/tomcat/lite/ContextPreinitListener.java\nmodules/tomcat-lite/java/org/apache/tomcat/lite/WebappContextMapper.java\nmodules/tomcat-lite/java/org/apache/tomcat/lite/coyote/CoyoteConnector.java\nmodules/tomcat-lite/java/org/apache/tomcat/lite/webxml/ServletContextConfig.java\nmodules/tomcat-lite/java/org/apache/tomcat/lite/webxml/TomcatLiteWebXmlConfig.java\nmodules/tomcat-lite/java/org/apache/tomcat/lite/webxml/WebXml.java\nmodules/tomcat-lite/java/org/apache/tomcat/servlets/file/CopyUtils.java\nmodules/tomcat-lite/java/org/apache/tomcat/servlets/file/FileCopyUtils.java\nmodules/tomcat-lite/java/org/apache/tomcat/servlets/jsp/PreCompileFilter.java\nmodules/tomcat-lite/java/org/apache/tomcat/servlets/jsp/SingleThreadedProxyServlet.java\nmodules/tomcat-lite/java/org/apache/tomcat/servlets/sec/UserDB.java\nmodules/tomcat-lite/java/org/apache/tomcat/servlets/session/RandomGenerator.java\nmodules/tomcat-lite/java/org/apache/tomcat/servlets/util/Range.java\nmodules/tomcat-lite/java/org/apache/tomcat/servlets/util/UrlUtils.java\nmodules/tomcat-lite/java/org/apache/tomcat/util/http/HttpRequest.java\nmodules/tomcat-lite/java/org/apache/tomcat/util/http/HttpResponse.java\nmodules/tomcat-lite/test/org/apache/tomcat/lite/LiteTestHelper.java\nmodules/tomcat-lite/test/org/apache/tomcat/lite/PropertiesSpiTest.java\nmodules/tomcat-lite/test/org/apache/tomcat/lite/SimpleServlet.java\nmodules/tomcat-lite/test/org/apache/tomcat/test/watchdog/WatchdogTest.java\nmodules/tomcat-lite/test/org/apache/tomcat/util/buf/UEncoderTest.java\ntest/org/apache/TestAll.java\ntest/org/apache/catalina/startup/SimpleHttpClient.java\ntest/org/apache/catalina/startup/TestWebXml.java'),(1628,48150,'Bug 48150 – some misspellings I found in the \"javax.servlet\" package','','2009-11-06 01:46:29','qingyang.xu','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 minor','7849435','Mark Emlyn David Thomas','2009-11-17 17:35:41','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48150 Correct JavaDoc typos. Patch provided by gingyang.xu','java/javax/servlet/GenericServlet.java\njava/javax/servlet/http/HttpServlet.java\njava/javax/servlet/jsp/JspWriter.java\njava/javax/servlet/jsp/PageContext.java\njava/javax/servlet/jsp/SkipPageException.java\njava/javax/servlet/jsp/tagext/JspFragment.java\njava/javax/servlet/jsp/tagext/PageData.java\njava/javax/servlet/jsp/tagext/SimpleTagSupport.java\njava/javax/servlet/jsp/tagext/TagLibraryInfo.java\njava/javax/servlet/jsp/tagext/TagLibraryValidator.java\njava/javax/servlet/jsp/tagext/TagSupport.java'),(1629,48149,'Bug 48149 – some misspellings I  found in the \"org.apache.coyote\" package and \"org.apache.el\" package','','2009-11-06 01:14:34','qingyang.xu','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 normal','39a78f4','Mark Emlyn David Thomas','2009-11-17 17:33:58','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48149 Correct JavaDoc typos. Patch provided by gingyang.xu','java/org/apache/coyote/ActionCode.java\njava/org/apache/coyote/ProtocolHandler.java\njava/org/apache/coyote/Request.java\njava/org/apache/coyote/RequestGroupInfo.java\njava/org/apache/coyote/RequestInfo.java\njava/org/apache/coyote/Response.java\njava/org/apache/coyote/ajp/AjpAprProcessor.java\njava/org/apache/coyote/ajp/AjpAprProtocol.java\njava/org/apache/coyote/ajp/AjpProcessor.java\njava/org/apache/coyote/ajp/AjpProtocol.java\njava/org/apache/coyote/http11/AbstractHttp11Processor.java\njava/org/apache/coyote/http11/AbstractInputBuffer.java\njava/org/apache/coyote/http11/AbstractOutputBuffer.java\njava/org/apache/coyote/http11/Http11AprProcessor.java\njava/org/apache/coyote/http11/Http11NioProcessor.java\njava/org/apache/coyote/http11/Http11Processor.java\njava/org/apache/coyote/http11/InternalAprInputBuffer.java\njava/org/apache/coyote/http11/InternalAprOutputBuffer.java\njava/org/apache/coyote/http11/InternalInputBuffer.java\njava/org/apache/coyote/http11/InternalNioInputBuffer.java\njava/org/apache/coyote/http11/InternalNioOutputBuffer.java\njava/org/apache/coyote/http11/InternalOutputBuffer.java\njava/org/apache/coyote/http11/filters/VoidInputFilter.java\njava/org/apache/el/parser/AstValue.java\njava/org/apache/el/parser/ParseException.java'),(1630,48148,'Bug 48148 – some misspellings I  found in the \"org.apache.jasper\" package and \"org.apache.juli\" package','','2009-11-06 00:32:48','qingyang.xu','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 minor','6ce7032','Mark Emlyn David Thomas','2009-11-17 17:31:47','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48148 Correct JavaDoc typos. Patch provided by gingyang.xu','java/org/apache/jasper/Constants.java\njava/org/apache/jasper/EmbeddedServletOptions.java\njava/org/apache/jasper/JasperException.java\njava/org/apache/jasper/JspC.java\njava/org/apache/jasper/JspCompilationContext.java\njava/org/apache/jasper/Options.java\njava/org/apache/jasper/compiler/Collector.java\njava/org/apache/jasper/compiler/Compiler.java\njava/org/apache/jasper/compiler/ELFunctionMapper.java\njava/org/apache/jasper/compiler/Generator.java\njava/org/apache/jasper/compiler/JarScannerFactory.java\njava/org/apache/jasper/compiler/JspConfig.java\njava/org/apache/jasper/compiler/JspDocumentParser.java\njava/org/apache/jasper/compiler/JspReader.java\njava/org/apache/jasper/compiler/JspRuntimeContext.java\njava/org/apache/jasper/compiler/JspUtil.java\njava/org/apache/jasper/compiler/Node.java\njava/org/apache/jasper/compiler/TagFileProcessor.java\njava/org/apache/jasper/compiler/TagLibraryInfoImpl.java\njava/org/apache/jasper/compiler/TextOptimizer.java\njava/org/apache/jasper/compiler/TldLocationsCache.java\njava/org/apache/jasper/compiler/Validator.java\njava/org/apache/jasper/compiler/tagplugin/TagPluginContext.java\njava/org/apache/jasper/runtime/BodyContentImpl.java\njava/org/apache/jasper/runtime/JspContextWrapper.java\njava/org/apache/jasper/servlet/JspServlet.java\njava/org/apache/jasper/servlet/JspServletWrapper.java\njava/org/apache/jasper/tagplugins/jstl/core/Import.java\njava/org/apache/jasper/util/Enumerator.java\njava/org/apache/jasper/xmlparser/UTF8Reader.java\njava/org/apache/jasper/xmlparser/XMLEncodingDetector.java\njava/org/apache/juli/ClassLoaderLogManager.java\njava/org/apache/juli/OneLineFormatter.java\njava/org/apache/juli/logging/DirectJDKLog.java\njava/org/apache/juli/logging/Log.java\njava/org/apache/juli/logging/LogFactory.java'),(1631,48147,'Bug 48147 – some misspellings I can find in the \"org.apache.naming\" package','','2009-11-05 23:26:42','qingyang.xu','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Documentation','P2 minor','21e86e6','Mark Emlyn David Thomas','2009-11-17 17:27:58','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48147 Correct JavaDoc typos. Patch provided by gingyang.xu','java/org/apache/naming/NamingEntry.java\njava/org/apache/naming/NamingService.java\njava/org/apache/naming/NamingServiceMBean.java\njava/org/apache/naming/ResourceRef.java\njava/org/apache/naming/factory/EjbFactory.java\njava/org/apache/naming/factory/OpenEjbFactory.java\njava/org/apache/naming/factory/ResourceEnvFactory.java\njava/org/apache/naming/factory/TransactionFactory.java\njava/org/apache/naming/resources/BaseDirContext.java\njava/org/apache/naming/resources/DirContextURLConnection.java\njava/org/apache/naming/resources/FileDirContext.java\njava/org/apache/naming/resources/ProxyDirContext.java\njava/org/apache/naming/resources/Resource.java\njava/org/apache/naming/resources/ResourceCache.java\njava/org/apache/naming/resources/WARDirContext.java'),(1632,48146,'Bug 48146 – some misspellings I can find in the \"org.apache.tomcat\" package','','2009-11-05 23:05:31','qingyang.xu','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','ed97da7','Mark Emlyn David Thomas','2009-11-17 17:24:42','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48146 Correct JavaDoc typos. Patch provided by gingyang.xu','java/org/apache/tomcat/jni/BIOCallback.java\njava/org/apache/tomcat/jni/Directory.java\njava/org/apache/tomcat/jni/File.java\njava/org/apache/tomcat/jni/Local.java\njava/org/apache/tomcat/jni/OS.java\njava/org/apache/tomcat/jni/Poll.java\njava/org/apache/tomcat/jni/Pool.java\njava/org/apache/tomcat/jni/Proc.java\njava/org/apache/tomcat/jni/SSL.java\njava/org/apache/tomcat/jni/SSLContext.java\njava/org/apache/tomcat/jni/Shm.java\njava/org/apache/tomcat/jni/Socket.java\njava/org/apache/tomcat/jni/Time.java\njava/org/apache/tomcat/jni/User.java\njava/org/apache/tomcat/util/DomUtil.java\njava/org/apache/tomcat/util/IntrospectionUtils.java\njava/org/apache/tomcat/util/buf/B2CConverter.java\njava/org/apache/tomcat/util/buf/ByteChunk.java\njava/org/apache/tomcat/util/buf/C2BConverter.java\njava/org/apache/tomcat/util/buf/CharChunk.java\njava/org/apache/tomcat/util/buf/MessageBytes.java\njava/org/apache/tomcat/util/buf/StringCache.java\njava/org/apache/tomcat/util/buf/UDecoder.java\njava/org/apache/tomcat/util/buf/UEncoder.java\njava/org/apache/tomcat/util/collections/MultiMap.java\njava/org/apache/tomcat/util/collections/MultiMapNamesEnumeration.java\njava/org/apache/tomcat/util/digester/AbstractRulesImpl.java\njava/org/apache/tomcat/util/digester/CallMethodRule.java\njava/org/apache/tomcat/util/digester/Digester.java\njava/org/apache/tomcat/util/digester/FactoryCreateRule.java\njava/org/apache/tomcat/util/digester/GenericParser.java\njava/org/apache/tomcat/util/digester/NodeCreateRule.java\njava/org/apache/tomcat/util/digester/RuleSet.java\njava/org/apache/tomcat/util/digester/RulesBase.java\njava/org/apache/tomcat/util/digester/SetNextRule.java\njava/org/apache/tomcat/util/digester/SetPropertiesRule.java\njava/org/apache/tomcat/util/digester/SetPropertyRule.java\njava/org/apache/tomcat/util/digester/SetRootRule.java\njava/org/apache/tomcat/util/digester/SetTopRule.java\njava/org/apache/tomcat/util/digester/WithDefaultsRulesWrapper.java\njava/org/apache/tomcat/util/http/ContentType.java\njava/org/apache/tomcat/util/http/Cookies.java\njava/org/apache/tomcat/util/http/MimeHeaders.java\njava/org/apache/tomcat/util/http/fileupload/FileItem.java\njava/org/apache/tomcat/util/http/fileupload/MultipartStream.java\njava/org/apache/tomcat/util/http/mapper/Mapper.java\njava/org/apache/tomcat/util/modeler/AttributeInfo.java\njava/org/apache/tomcat/util/modeler/BaseModelMBean.java\njava/org/apache/tomcat/util/modeler/Registry.java\njava/org/apache/tomcat/util/modeler/modules/MbeansDescriptorsIntrospectionSource.java\njava/org/apache/tomcat/util/net/AprEndpoint.java\njava/org/apache/tomcat/util/net/DefaultServerSocketFactory.java\njava/org/apache/tomcat/util/net/NioEndpoint.java\njava/org/apache/tomcat/util/net/ServerSocketFactory.java\njava/org/apache/tomcat/util/net/jsse/JSSESocketFactory.java'),(1633,48143,'Bug 48143 – Javadoc fixes','','2009-11-05 13:04:26','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','c52b1ba','Mark Emlyn David Thomas','2009-11-17 17:13:30','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48143 Javadoc updates. Patch provide by sebb.','java/javax/servlet/SessionCookieConfig.java\njava/org/apache/catalina/ant/jmx/JMXAccessorCreateTask.java\njava/org/apache/catalina/core/ApplicationFilterChain.java\njava/org/apache/catalina/core/StandardContextValve.java\njava/org/apache/catalina/core/StandardEngineValve.java\njava/org/apache/catalina/core/StandardHostValve.java\njava/org/apache/catalina/core/StandardWrapperValve.java\njava/org/apache/catalina/ha/ClusterManager.java\njava/org/apache/catalina/ha/session/DeltaSession.java\njava/org/apache/catalina/ha/tcp/SimpleTcpCluster.java\njava/org/apache/catalina/manager/StatusTransformer.java\njava/org/apache/catalina/realm/CombinedRealm.java\njava/org/apache/catalina/realm/LockOutRealm.java\njava/org/apache/catalina/startup/Embedded.java\njava/org/apache/catalina/startup/WebRuleSet.java\njava/org/apache/catalina/tribes/group/ChannelCoordinator.java\njava/org/apache/catalina/tribes/io/ChannelData.java\njava/org/apache/catalina/tribes/io/ObjectReader.java\njava/org/apache/catalina/tribes/io/ReplicationStream.java\njava/org/apache/catalina/tribes/io/XByteBuffer.java\njava/org/apache/catalina/tribes/membership/McastServiceImpl.java\njava/org/apache/catalina/tribes/membership/MemberImpl.java\njava/org/apache/catalina/tribes/membership/Membership.java\njava/org/apache/catalina/tribes/transport/bio/util/LinkObject.java\njava/org/apache/catalina/tribes/transport/nio/NioReceiver.java\njava/org/apache/catalina/users/MemoryUserDatabase.java\njava/org/apache/catalina/valves/RemoteIpValve.java\njava/org/apache/coyote/http11/Http11Processor.java\njava/org/apache/jasper/compiler/ParserController.java\njava/org/apache/jasper/compiler/TagFileProcessor.java\njava/org/apache/jasper/compiler/TldLocationsCache.java\njava/org/apache/naming/HandlerRef.java\njava/org/apache/naming/ServiceRef.java\njava/org/apache/naming/resources/BaseDirContext.java\njava/org/apache/tomcat/buildutil/Txt2Html.java\njava/org/apache/tomcat/util/digester/SetPropertiesRule.java\njava/org/apache/tomcat/util/digester/SetPropertyRule.java\njava/org/apache/tomcat/util/modeler/BaseModelMBean.java\njava/org/apache/tomcat/util/net/NioBlockingSelector.java\njava/org/apache/tomcat/util/net/SSLSessionManager.java'),(1634,47495,'Bug 47495 – provide meaningful error message also to stdout if server.xml is not readable','','2009-07-08 02:20:47','Ralf Hauser','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','a28ef3a','Konstantin Kolinko','2009-11-15 15:24:48','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47495 Exit immediately if Catalina.load() failed to create a server instance.','java/org/apache/catalina/startup/Catalina.java'),(1635,48097,'Bug 48097 – NoClassDefFoundError on first access of first jsp','','2009-11-01 11:06:06','Amichai','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','b9bbc3f','Konstantin Kolinko','2009-11-09 09:29:55','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48097 Patch by Mark Thomas.','java/org/apache/catalina/loader/WebappClassLoader.java'),(1636,48097,'Bug 48097 – NoClassDefFoundError on first access of first jsp','','2009-11-01 11:06:06','Amichai','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','2109e33','Konstantin Kolinko','2009-11-09 09:26:00','Revert r.831830. A better patch for issue 48097 was proposed.','java/org/apache/catalina/security/SecurityClassLoad.java'),(1637,47330,'Bug 47330 – proposal : port of mod_remoteip in Tomcat as RemoteIpValve','','2009-06-07 17:38:02','Cyrille Le Clerc','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','a34b357','Mark Emlyn David Thomas','2009-11-05 15:35:09','https://issues.apache.org/bugzilla/show_bug.cgi?id=47330 Add RemoteIpFilter Patch provided by Cyrille Le Clerc','java/org/apache/catalina/filters/RemoteIpFilter.java\nwebapps/docs/config/filter.xml'),(1638,48139,'Bug 48139 – Tomcat Javadoc and unthrown exception fixes','','2009-11-05 08:10:54','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','ab3620c','Mark Emlyn David Thomas','2009-11-05 14:12:14','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48139 Correct javadoc - patch provided by sebb Also fix remaining Eclipse warnings','java/org/apache/catalina/startup/Tomcat.java'),(1639,48137,'Bug 48137 – some misspellings I can find in the \"org.apache.catalina\" package','','2009-11-05 06:13:59','qingyang.xu','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','18c0edc','Mark Emlyn David Thomas','2009-11-05 14:08:42','https://issues.apache.org/bugzilla/show_bug.cgi?id=48137 Fix javadoc typos Patch provided by qingyang.xu','java/org/apache/catalina/Cluster.java\njava/org/apache/catalina/CometEvent.java\njava/org/apache/catalina/CometProcessor.java\njava/org/apache/catalina/Context.java\njava/org/apache/catalina/Host.java\njava/org/apache/catalina/Pipeline.java\njava/org/apache/catalina/ant/BaseRedirectorHelperTask.java\njava/org/apache/catalina/ant/JKStatusUpdateTask.java\njava/org/apache/catalina/ant/jmx/JMXAccessorQueryTask.java\njava/org/apache/catalina/ant/jmx/JMXAccessorSetTask.java\njava/org/apache/catalina/ant/jmx/JMXAccessorTask.java\njava/org/apache/catalina/authenticator/AuthenticatorBase.java\njava/org/apache/catalina/authenticator/FormAuthenticator.java\njava/org/apache/catalina/authenticator/SingleSignOn.java\njava/org/apache/catalina/connector/Connector.java\njava/org/apache/catalina/connector/CoyoteAdapter.java\njava/org/apache/catalina/connector/CoyoteInputStream.java\njava/org/apache/catalina/connector/CoyoteReader.java\njava/org/apache/catalina/connector/OutputBuffer.java\njava/org/apache/catalina/connector/Request.java\njava/org/apache/catalina/connector/RequestFacade.java\njava/org/apache/catalina/connector/Response.java\njava/org/apache/catalina/deploy/ContextService.java\njava/org/apache/catalina/filters/WebdavFixFilter.java\njava/org/apache/catalina/ha/authenticator/ClusterSingleSignOn.java\njava/org/apache/catalina/ha/backend/CollectedInfo.java\njava/org/apache/catalina/ha/backend/HeartbeatListener.java\njava/org/apache/catalina/ha/deploy/FarmWarDeployer.java\njava/org/apache/catalina/ha/deploy/FileMessageFactory.java\njava/org/apache/catalina/ha/deploy/WarWatcher.java\njava/org/apache/catalina/ha/session/DeltaManager.java\njava/org/apache/catalina/ha/session/DeltaRequest.java\njava/org/apache/catalina/ha/session/DeltaSession.java\njava/org/apache/catalina/ha/session/JvmRouteBinderValve.java\njava/org/apache/catalina/ha/session/SessionMessageImpl.java\njava/org/apache/catalina/ha/tcp/ReplicationValve.java\njava/org/apache/catalina/ha/tcp/SimpleTcpCluster.java\njava/org/apache/catalina/loader/WebappClassLoader.java\njava/org/apache/catalina/manager/HTMLManagerServlet.java\njava/org/apache/catalina/manager/JMXProxyServlet.java\njava/org/apache/catalina/manager/ManagerServlet.java\njava/org/apache/catalina/manager/host/HTMLHostManagerServlet.java\njava/org/apache/catalina/manager/util/SessionUtils.java\njava/org/apache/catalina/mbeans/ContextEnvironmentMBean.java\njava/org/apache/catalina/mbeans/ContextResourceLinkMBean.java\njava/org/apache/catalina/mbeans/ContextResourceMBean.java\njava/org/apache/catalina/mbeans/MBeanFactory.java\njava/org/apache/catalina/mbeans/ServerLifecycleListener.java\njava/org/apache/catalina/realm/DataSourceRealm.java\njava/org/apache/catalina/realm/JAASCallbackHandler.java\njava/org/apache/catalina/realm/JAASMemoryLoginModule.java\njava/org/apache/catalina/realm/JAASRealm.java\njava/org/apache/catalina/realm/JDBCRealm.java\njava/org/apache/catalina/realm/JNDIRealm.java\njava/org/apache/catalina/realm/LockOutRealm.java\njava/org/apache/catalina/realm/RealmBase.java\njava/org/apache/catalina/security/SecurityUtil.java\njava/org/apache/catalina/servlets/CGIServlet.java\njava/org/apache/catalina/servlets/DefaultServlet.java\njava/org/apache/catalina/servlets/WebdavServlet.java\njava/org/apache/catalina/session/JDBCStore.java\njava/org/apache/catalina/session/PersistentManagerBase.java\njava/org/apache/catalina/session/StandardManager.java\njava/org/apache/catalina/ssi/ExpressionParseTree.java\njava/org/apache/catalina/ssi/SSIFsize.java\njava/org/apache/catalina/ssi/SSIServletExternalResolver.java\njava/org/apache/catalina/ssi/SSIStopProcessingException.java\njava/org/apache/catalina/tribes/Channel.java\njava/org/apache/catalina/tribes/ChannelListener.java\njava/org/apache/catalina/tribes/Heartbeat.java\njava/org/apache/catalina/tribes/Member.java\njava/org/apache/catalina/tribes/UniqueId.java\njava/org/apache/catalina/tribes/group/GroupChannel.java\njava/org/apache/catalina/tribes/group/interceptors/MessageDispatch15Interceptor.java\njava/org/apache/catalina/tribes/io/ObjectReader.java\njava/org/apache/catalina/tribes/membership/McastServiceImpl.java\njava/org/apache/catalina/tribes/transport/PooledSender.java\njava/org/apache/catalina/tribes/transport/bio/BioReplicationTask.java\njava/org/apache/catalina/tribes/transport/bio/BioSender.java\njava/org/apache/catalina/tribes/transport/bio/util/FastQueue.java\njava/org/apache/catalina/tribes/transport/nio/NioSender.java\njava/org/apache/catalina/tribes/transport/nio/ParallelNioSender.java\njava/org/apache/catalina/users/MemoryUserDatabase.java\njava/org/apache/catalina/util/Base64.java\njava/org/apache/catalina/util/DateTool.java\njava/org/apache/catalina/util/ExtensionValidator.java\njava/org/apache/catalina/util/IOTools.java\njava/org/apache/catalina/util/ManifestResource.java\njava/org/apache/catalina/util/ParameterMap.java\njava/org/apache/catalina/util/RequestUtil.java\njava/org/apache/catalina/util/SchemaResolver.java\njava/org/apache/catalina/util/Strftime.java\njava/org/apache/catalina/valves/AccessLogValve.java\njava/org/apache/catalina/valves/CometConnectionManagerValve.java'),(1640,47495,'Bug 47495 – provide meaningful error message also to stdout if server.xml is not readable','','2009-07-08 02:20:47','Ralf Hauser','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','b8f54514','Timothy A. Funk','2009-11-05 13:46:43','https://issues.apache.org/bugzilla/show_bug.cgi?id=47495','java/org/apache/catalina/startup/Catalina.java'),(1641,48135,'Bug 48135 – ServiceRefFactory: impossible null check of serviceInterfaceClass','The ServiceRefFactory class performs an impossible null check of serviceInterfaceClass at line 238:\n\n237: Class[] serviceInterfaces = serviceInterfaceClass.getInterfaces();\n238: if (serviceInterfaceClass != null) {\n\nIf it were null, line 237 would generate an NPE.','2009-11-05 03:34:18','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','97ccffd','Mark Emlyn David Thomas','2009-11-05 13:41:30','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48135 Also add generics where possible and other Eclipse warnings','java/org/apache/naming/factory/webservices/ServiceProxy.java\njava/org/apache/naming/factory/webservices/ServiceRefFactory.java'),(1642,48133,'Bug 48133 – misspellings in the javadoc and comment of the various classes in the package of \"org.apache.core\"','','2009-11-04 19:05:17','qingyang.xu','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','9204e4d','Mark Emlyn David Thomas','2009-11-05 13:18:53','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48133 Spelling errors in javadoc Patch provided by qingyang.xu','java/org/apache/catalina/core/ApplicationDispatcher.java\njava/org/apache/catalina/core/ApplicationFilterFactory.java\njava/org/apache/catalina/core/ApplicationHttpRequest.java\njava/org/apache/catalina/core/ContainerBase.java\njava/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/core/StandardEngine.java\njava/org/apache/catalina/core/StandardHost.java\njava/org/apache/catalina/core/StandardPipeline.java\njava/org/apache/catalina/core/StandardService.java\njava/org/apache/catalina/core/StandardWrapperFacade.java\njava/org/apache/catalina/core/StandardWrapperValve.java'),(1643,47330,'Bug 47330 – proposal : port of mod_remoteip in Tomcat as RemoteIpValve','','2009-06-07 17:38:02','Cyrille Le Clerc','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','fa803a6','Mark Emlyn David Thomas','2009-11-04 21:03:12','https://issues.apache.org/bugzilla/show_bug.cgi?id=47330 Add RemoteIpValve Patch provided by Cyrille Le Clerc','java/org/apache/catalina/valves/LocalStrings.properties\njava/org/apache/catalina/valves/RemoteIpValve.java\njava/org/apache/catalina/valves/mbeans-descriptors.xml\ntest/org/apache/catalina/valves/RemoteIpValveTest.java\nwebapps/docs/config/valve.xml'),(1644,48132,'Bug 48132 – Patch to add @Override annotations','','2009-11-04 13:41:04','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','77461dd','Mark Emlyn David Thomas','2009-11-04 20:22:13','Partial fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=48132 Patch provided by sebb This is the final patch for this bug fix.','java/org/apache/tomcat/buildutil/Txt2Html.java\njava/org/apache/tomcat/util/buf/B2CConverter.java\njava/org/apache/tomcat/util/buf/ByteChunk.java\njava/org/apache/tomcat/util/buf/C2BConverter.java\njava/org/apache/tomcat/util/buf/CharChunk.java\njava/org/apache/tomcat/util/buf/MessageBytes.java\njava/org/apache/tomcat/util/buf/StringCache.java\njava/org/apache/tomcat/util/digester/CallMethodRule.java\njava/org/apache/tomcat/util/digester/CallParamRule.java\njava/org/apache/tomcat/util/digester/Digester.java\njava/org/apache/tomcat/util/digester/FactoryCreateRule.java\njava/org/apache/tomcat/util/digester/NodeCreateRule.java\njava/org/apache/tomcat/util/digester/ObjectCreateRule.java\njava/org/apache/tomcat/util/digester/ObjectParamRule.java\njava/org/apache/tomcat/util/digester/PathCallParamRule.java\njava/org/apache/tomcat/util/digester/SetNextRule.java\njava/org/apache/tomcat/util/digester/SetPropertiesRule.java\njava/org/apache/tomcat/util/digester/SetPropertyRule.java\njava/org/apache/tomcat/util/digester/SetRootRule.java\njava/org/apache/tomcat/util/digester/SetTopRule.java\njava/org/apache/tomcat/util/http/Cookies.java\njava/org/apache/tomcat/util/http/MimeHeaders.java\njava/org/apache/tomcat/util/http/Parameters.java\njava/org/apache/tomcat/util/http/ServerCookie.java\njava/org/apache/tomcat/util/http/fileupload/DefaultFileItem.java\njava/org/apache/tomcat/util/http/fileupload/DeferredFileOutputStream.java\njava/org/apache/tomcat/util/http/fileupload/DiskFileUpload.java\njava/org/apache/tomcat/util/http/fileupload/FileUpload.java\njava/org/apache/tomcat/util/http/fileupload/MultipartStream.java\njava/org/apache/tomcat/util/http/fileupload/ThresholdingOutputStream.java\njava/org/apache/tomcat/util/log/SystemLogHandler.java\njava/org/apache/tomcat/util/modeler/BaseModelMBean.java\njava/org/apache/tomcat/util/modeler/ManagedBean.java\njava/org/apache/tomcat/util/modeler/NotificationInfo.java\njava/org/apache/tomcat/util/modeler/modules/MbeansDescriptorsDOMSource.java\njava/org/apache/tomcat/util/modeler/modules/MbeansDescriptorsDigesterSource.java\njava/org/apache/tomcat/util/modeler/modules/MbeansDescriptorsIntrospectionSource.java\njava/org/apache/tomcat/util/modeler/modules/MbeansDescriptorsSerSource.java\njava/org/apache/tomcat/util/modeler/modules/MbeansSource.java\njava/org/apache/tomcat/util/net/AprEndpoint.java\njava/org/apache/tomcat/util/net/DefaultServerSocketFactory.java\njava/org/apache/tomcat/util/net/JIoEndpoint.java\njava/org/apache/tomcat/util/net/NioChannel.java\njava/org/apache/tomcat/util/net/NioEndpoint.java\njava/org/apache/tomcat/util/net/SecureNioChannel.java\njava/org/apache/tomcat/util/net/URL.java\njava/org/apache/tomcat/util/net/jsse/JSSEImplementation.java\njava/org/apache/tomcat/util/net/jsse/JSSESocketFactory.java\njava/org/apache/tomcat/util/threads/TaskQueue.java'),(1645,48132,'Bug 48132 – Patch to add @Override annotations','','2009-11-04 13:41:04','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','5072dab','Mark Emlyn David Thomas','2009-11-04 20:21:11','Partial fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=48132 Patch provided by sebb','modules/jdbc-pool/test/org/apache/tomcat/jdbc/test/CheckOutThreadTest.java\nmodules/jdbc-pool/test/org/apache/tomcat/jdbc/test/ConnectCountTest.java\nmodules/jdbc-pool/test/org/apache/tomcat/jdbc/test/DefaultTestCase.java\nmodules/jdbc-pool/test/org/apache/tomcat/jdbc/test/FairnessTest.java\nmodules/jdbc-pool/test/org/apache/tomcat/jdbc/test/TestAsyncQueue.java\ntest/org/apache/catalina/connector/TestRequest.java\ntest/org/apache/catalina/core/TestStandardContext.java\ntest/org/apache/catalina/startup/TestTomcat.java\ntest/org/apache/catalina/startup/TomcatBaseTest.java\ntest/org/apache/catalina/tribes/demos/CoordinationDemo.java\ntest/org/apache/catalina/tribes/demos/EchoRpcTest.java\ntest/org/apache/catalina/tribes/demos/LoadTest.java\ntest/org/apache/catalina/tribes/demos/MapDemo.java\ntest/org/apache/catalina/tribes/demos/MembersWithProperties.java\ntest/org/apache/catalina/tribes/test/channel/TestChannelOptionFlag.java\ntest/org/apache/catalina/tribes/test/channel/TestChannelStartStop.java\ntest/org/apache/catalina/tribes/test/channel/TestDataIntegrity.java\ntest/org/apache/catalina/tribes/test/channel/TestMulticastPackages.java\ntest/org/apache/catalina/tribes/test/channel/TestRemoteProcessException.java\ntest/org/apache/catalina/tribes/test/channel/TestUdpPackages.java\ntest/org/apache/catalina/tribes/test/interceptors/TestNonBlockingCoordinator.java\ntest/org/apache/catalina/tribes/test/interceptors/TestOrderInterceptor.java\ntest/org/apache/catalina/tribes/test/io/TestSenderConnections.java\ntest/org/apache/catalina/tribes/test/io/TestSerialization.java\ntest/org/apache/catalina/tribes/test/membership/TestDomainFilter.java\ntest/org/apache/catalina/tribes/test/membership/TestMemberArrival.java\ntest/org/apache/catalina/tribes/test/membership/TestMemberSerialization.java\ntest/org/apache/catalina/tribes/test/membership/TestTcpFailureDetector.java\ntest/org/apache/catalina/tribes/test/transport/SocketReceive.java\ntest/org/apache/catalina/tribes/test/transport/SocketTribesReceive.java\ntest/org/apache/catalina/tribes/test/transport/SocketValidateReceive.java\ntest/org/apache/catalina/valves/Benchmarks.java\ntest/org/apache/tomcat/util/http/CookiesBaseTest.java\ntest/org/apache/tomcat/util/http/TestCookiesNoFwdStrictSysProps.java'),(1646,48132,'Bug 48132 – Patch to add @Override annotations','','2009-11-04 13:41:04','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','efdd8e9','Mark Emlyn David Thomas','2009-11-04 20:19:20','Partial fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=48132 Patch provided by sebb','java/javax/el/ArrayELResolver.java\njava/javax/el/BeanELResolver.java\njava/javax/el/CompositeELResolver.java\njava/javax/el/Expression.java\njava/javax/el/ListELResolver.java\njava/javax/el/MapELResolver.java\njava/javax/el/ResourceBundleELResolver.java\njava/javax/servlet/http/Cookie.java\njava/javax/servlet/http/HttpServlet.java\njava/javax/servlet/http/HttpSessionBindingEvent.java\njava/javax/servlet/jsp/JspWriter.java\njava/javax/servlet/jsp/el/ImplicitObjectELResolver.java\njava/javax/servlet/jsp/el/ScopedAttributeELResolver.java\njava/javax/servlet/jsp/tagext/BodyContent.java\njava/javax/servlet/jsp/tagext/BodyTagSupport.java\njava/javax/servlet/jsp/tagext/TagAttributeInfo.java'),(1647,48132,'Bug 48132 – Patch to add @Override annotations','','2009-11-04 13:41:04','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','65cd731','Mark Emlyn David Thomas','2009-11-04 20:18:05','Partial fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=48132 Patch provided by sebb','java/org/apache/juli/AsyncFileHandler.java\njava/org/apache/juli/ClassLoaderLogManager.java\njava/org/apache/juli/FileHandler.java\njava/org/apache/juli/JdkLoggerFormatter.java\njava/org/apache/juli/logging/LogConfigurationException.java\njava/org/apache/naming/EjbRef.java\njava/org/apache/naming/HandlerRef.java\njava/org/apache/naming/NamingEntry.java\njava/org/apache/naming/ResourceEnvRef.java\njava/org/apache/naming/ResourceLinkRef.java\njava/org/apache/naming/ResourceRef.java\njava/org/apache/naming/ServiceRef.java\njava/org/apache/naming/TransactionRef.java\njava/org/apache/naming/resources/CacheEntry.java\njava/org/apache/naming/resources/DirContextURLConnection.java\njava/org/apache/naming/resources/DirContextURLStreamHandler.java\njava/org/apache/naming/resources/FileDirContext.java\njava/org/apache/naming/resources/ImmutableNameNotFoundException.java\njava/org/apache/naming/resources/ResourceAttributes.java\njava/org/apache/naming/resources/WARDirContext.java'),(1648,48132,'Bug 48132 – Patch to add @Override annotations','','2009-11-04 13:41:04','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','789895b','Mark Emlyn David Thomas','2009-11-04 20:16:53','Partial fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=48132 Patch provided by sebb','java/org/apache/jasper/compiler/AntCompiler.java\njava/org/apache/jasper/compiler/Collector.java\njava/org/apache/jasper/compiler/Dumper.java\njava/org/apache/jasper/compiler/ELFunctionMapper.java\njava/org/apache/jasper/compiler/ELNode.java\njava/org/apache/jasper/compiler/ELParser.java\njava/org/apache/jasper/compiler/ErrorDispatcher.java\njava/org/apache/jasper/compiler/Generator.java\njava/org/apache/jasper/compiler/ImplicitTagLibraryInfo.java\njava/org/apache/jasper/compiler/JDTCompiler.java\njava/org/apache/jasper/compiler/JasperTagInfo.java\njava/org/apache/jasper/compiler/JspDocumentParser.java\njava/org/apache/jasper/compiler/Mark.java\njava/org/apache/jasper/compiler/Node.java\njava/org/apache/jasper/compiler/PageDataImpl.java\njava/org/apache/jasper/compiler/ScriptingVariabler.java\njava/org/apache/jasper/compiler/SmapGenerator.java\njava/org/apache/jasper/compiler/SmapStratum.java\njava/org/apache/jasper/compiler/SmapUtil.java\njava/org/apache/jasper/compiler/TagFileProcessor.java\njava/org/apache/jasper/compiler/TagLibraryInfoImpl.java\njava/org/apache/jasper/compiler/TagPluginManager.java\njava/org/apache/jasper/compiler/TextOptimizer.java\njava/org/apache/jasper/compiler/Validator.java\njava/org/apache/jasper/el/ELContextImpl.java\njava/org/apache/jasper/el/ELContextWrapper.java\njava/org/apache/jasper/el/ELResolverImpl.java\njava/org/apache/jasper/el/ExpressionEvaluatorImpl.java\njava/org/apache/jasper/el/ExpressionImpl.java\njava/org/apache/jasper/el/FunctionMapperImpl.java\njava/org/apache/jasper/el/JspMethodExpression.java\njava/org/apache/jasper/el/JspValueExpression.java\njava/org/apache/jasper/runtime/BodyContentImpl.java\njava/org/apache/jasper/runtime/HttpJspBase.java\njava/org/apache/jasper/runtime/JspContextWrapper.java\njava/org/apache/jasper/runtime/JspFactoryImpl.java\njava/org/apache/jasper/runtime/JspFragmentHelper.java\njava/org/apache/jasper/runtime/JspWriterImpl.java\njava/org/apache/jasper/runtime/PageContextImpl.java\njava/org/apache/jasper/runtime/PerThreadTagHandlerPool.java\njava/org/apache/jasper/runtime/ProtectedFunctionMapper.java\njava/org/apache/jasper/runtime/ServletResponseWrapperInclude.java\njava/org/apache/jasper/servlet/JasperLoader.java\njava/org/apache/jasper/servlet/JspServlet.java\njava/org/apache/jasper/tagplugins/jstl/Util.java\njava/org/apache/jasper/xmlparser/ASCIIReader.java\njava/org/apache/jasper/xmlparser/TreeNode.java\njava/org/apache/jasper/xmlparser/UCSReader.java\njava/org/apache/jasper/xmlparser/UTF8Reader.java\njava/org/apache/jasper/xmlparser/XMLEncodingDetector.java\njava/org/apache/jasper/xmlparser/XMLString.java\njava/org/apache/jasper/xmlparser/XMLStringBuffer.java'),(1649,48132,'Bug 48132 – Patch to add @Override annotations','','2009-11-04 13:41:04','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','6508ee7','Mark Emlyn David Thomas','2009-11-04 20:14:16','Partial fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=48132 Patch provided by sebb','java/org/apache/coyote/Request.java\njava/org/apache/coyote/ajp/AjpAprProtocol.java\njava/org/apache/coyote/ajp/AjpProtocol.java\njava/org/apache/coyote/http11/Http11AprProtocol.java\njava/org/apache/coyote/http11/Http11NioProcessor.java\njava/org/apache/coyote/http11/Http11NioProtocol.java\njava/org/apache/coyote/http11/Http11Processor.java\njava/org/apache/coyote/http11/Http11Protocol.java\njava/org/apache/coyote/http11/InternalInputBuffer.java\njava/org/apache/coyote/http11/InternalNioInputBuffer.java\njava/org/apache/coyote/http11/InternalNioOutputBuffer.java\njava/org/apache/coyote/http11/InternalOutputBuffer.java\njava/org/apache/coyote/http11/filters/GzipOutputFilter.java'),(1650,48132,'Bug 48132 – Patch to add @Override annotations','','2009-11-04 13:41:04','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','5a0c47e','Mark Emlyn David Thomas','2009-11-04 20:13:12','Partial fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=48132 Patch provided by sebb with some additional issues reported by Eclispe','java/org/apache/el/ExpressionFactoryImpl.java\njava/org/apache/el/MethodExpressionImpl.java\njava/org/apache/el/MethodExpressionLiteral.java\njava/org/apache/el/ValueExpressionImpl.java\njava/org/apache/el/ValueExpressionLiteral.java\njava/org/apache/el/lang/ELArithmetic.java\njava/org/apache/el/lang/EvaluationContext.java\njava/org/apache/el/lang/FunctionMapperFactory.java\njava/org/apache/el/lang/FunctionMapperImpl.java\njava/org/apache/el/lang/VariableMapperFactory.java\njava/org/apache/el/lang/VariableMapperImpl.java\njava/org/apache/el/parser/ArithmeticNode.java\njava/org/apache/el/parser/AstAnd.java\njava/org/apache/el/parser/AstBracketSuffix.java\njava/org/apache/el/parser/AstChoice.java\njava/org/apache/el/parser/AstCompositeExpression.java\njava/org/apache/el/parser/AstDeferredExpression.java\njava/org/apache/el/parser/AstDiv.java\njava/org/apache/el/parser/AstDotSuffix.java\njava/org/apache/el/parser/AstDynamicExpression.java\njava/org/apache/el/parser/AstEmpty.java\njava/org/apache/el/parser/AstEqual.java\njava/org/apache/el/parser/AstFalse.java\njava/org/apache/el/parser/AstFloatingPoint.java\njava/org/apache/el/parser/AstFunction.java\njava/org/apache/el/parser/AstGreaterThan.java\njava/org/apache/el/parser/AstGreaterThanEqual.java\njava/org/apache/el/parser/AstIdentifier.java\njava/org/apache/el/parser/AstInteger.java\njava/org/apache/el/parser/AstLessThan.java\njava/org/apache/el/parser/AstLessThanEqual.java\njava/org/apache/el/parser/AstLiteralExpression.java\njava/org/apache/el/parser/AstMinus.java\njava/org/apache/el/parser/AstMod.java\njava/org/apache/el/parser/AstMult.java\njava/org/apache/el/parser/AstNegative.java\njava/org/apache/el/parser/AstNot.java\njava/org/apache/el/parser/AstNotEqual.java\njava/org/apache/el/parser/AstNull.java\njava/org/apache/el/parser/AstOr.java\njava/org/apache/el/parser/AstPlus.java\njava/org/apache/el/parser/AstString.java\njava/org/apache/el/parser/AstTrue.java\njava/org/apache/el/parser/AstValue.java\njava/org/apache/el/parser/BooleanNode.java\njava/org/apache/el/parser/ParseException.java\njava/org/apache/el/parser/SimpleNode.java\njava/org/apache/el/parser/Token.java\njava/org/apache/el/parser/TokenMgrError.java'),(1651,48132,'Bug 48132 – Patch to add @Override annotations','','2009-11-04 13:41:04','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','8f5970d','Mark Emlyn David Thomas','2009-11-04 19:58:58','Partial fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=48132 Patch provided by sebb','java/org/apache/catalina/ContainerEvent.java\njava/org/apache/catalina/LifecycleException.java\njava/org/apache/catalina/SessionEvent.java\njava/org/apache/catalina/ant/AbstractCatalinaTask.java\njava/org/apache/catalina/ant/BaseRedirectorHelperTask.java\njava/org/apache/catalina/ant/DeployTask.java\njava/org/apache/catalina/ant/JKStatusUpdateTask.java\njava/org/apache/catalina/ant/JMXGetTask.java\njava/org/apache/catalina/ant/JMXQueryTask.java\njava/org/apache/catalina/ant/JMXSetTask.java\njava/org/apache/catalina/ant/ListTask.java\njava/org/apache/catalina/ant/ReloadTask.java\njava/org/apache/catalina/ant/ResourcesTask.java\njava/org/apache/catalina/ant/RolesTask.java\njava/org/apache/catalina/ant/ServerinfoTask.java\njava/org/apache/catalina/ant/SessionsTask.java\njava/org/apache/catalina/ant/StartTask.java\njava/org/apache/catalina/ant/StopTask.java\njava/org/apache/catalina/ant/UndeployTask.java\njava/org/apache/catalina/ant/ValidatorTask.java\njava/org/apache/catalina/ant/jmx/JMXAccessorCreateTask.java\njava/org/apache/catalina/ant/jmx/JMXAccessorGetTask.java\njava/org/apache/catalina/ant/jmx/JMXAccessorInvokeTask.java\njava/org/apache/catalina/ant/jmx/JMXAccessorQueryTask.java\njava/org/apache/catalina/ant/jmx/JMXAccessorSetTask.java\njava/org/apache/catalina/ant/jmx/JMXAccessorUnregisterTask.java\njava/org/apache/catalina/authenticator/AuthenticatorBase.java\njava/org/apache/catalina/authenticator/BasicAuthenticator.java\njava/org/apache/catalina/authenticator/DigestAuthenticator.java\njava/org/apache/catalina/authenticator/FormAuthenticator.java\njava/org/apache/catalina/authenticator/NonLoginAuthenticator.java\njava/org/apache/catalina/authenticator/SSLAuthenticator.java\njava/org/apache/catalina/authenticator/SingleSignOn.java\njava/org/apache/catalina/connector/ClientAbortException.java\njava/org/apache/catalina/connector/CometEventImpl.java\njava/org/apache/catalina/connector/CoyoteInputStream.java\njava/org/apache/catalina/connector/CoyoteOutputStream.java\njava/org/apache/catalina/connector/CoyotePrincipal.java\njava/org/apache/catalina/connector/CoyoteReader.java\njava/org/apache/catalina/connector/CoyoteWriter.java\njava/org/apache/catalina/connector/InputBuffer.java\njava/org/apache/catalina/connector/OutputBuffer.java\njava/org/apache/catalina/connector/RequestFacade.java\njava/org/apache/catalina/connector/ResponseFacade.java\njava/org/apache/catalina/core/ApplicationFilterConfig.java\njava/org/apache/catalina/core/ApplicationHttpRequest.java\njava/org/apache/catalina/core/ApplicationHttpResponse.java\njava/org/apache/catalina/core/ApplicationRequest.java\njava/org/apache/catalina/core/ApplicationResponse.java\njava/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/core/StandardContextValve.java\njava/org/apache/catalina/core/StandardEngine.java\njava/org/apache/catalina/core/StandardEngineValve.java\njava/org/apache/catalina/core/StandardHost.java\njava/org/apache/catalina/core/StandardHostValve.java\njava/org/apache/catalina/core/StandardServer.java\njava/org/apache/catalina/core/StandardService.java\njava/org/apache/catalina/core/StandardWrapper.java\njava/org/apache/catalina/core/StandardWrapperValve.java\njava/org/apache/catalina/deploy/ApplicationParameter.java\njava/org/apache/catalina/deploy/ContextEjb.java\njava/org/apache/catalina/deploy/ContextEnvironment.java\njava/org/apache/catalina/deploy/ContextHandler.java\njava/org/apache/catalina/deploy/ContextLocalEjb.java\njava/org/apache/catalina/deploy/ContextResource.java\njava/org/apache/catalina/deploy/ContextResourceEnvRef.java\njava/org/apache/catalina/deploy/ContextResourceLink.java\njava/org/apache/catalina/deploy/ContextService.java\njava/org/apache/catalina/deploy/ContextTransaction.java\njava/org/apache/catalina/deploy/ErrorPage.java\njava/org/apache/catalina/deploy/FilterDef.java\njava/org/apache/catalina/deploy/FilterMap.java\njava/org/apache/catalina/deploy/LoginConfig.java\njava/org/apache/catalina/deploy/MessageDestination.java\njava/org/apache/catalina/deploy/MessageDestinationRef.java\njava/org/apache/catalina/deploy/SecurityCollection.java\njava/org/apache/catalina/deploy/SecurityConstraint.java\njava/org/apache/catalina/deploy/SecurityRoleRef.java\njava/org/apache/catalina/filters/RemoteAddrFilter.java\njava/org/apache/catalina/filters/RemoteHostFilter.java\njava/org/apache/catalina/filters/RequestDumperFilter.java\njava/org/apache/catalina/ha/ClusterListener.java\njava/org/apache/catalina/ha/ClusterRuleSet.java\njava/org/apache/catalina/ha/authenticator/ClusterSingleSignOn.java\njava/org/apache/catalina/ha/authenticator/ClusterSingleSignOnListener.java\njava/org/apache/catalina/ha/authenticator/SingleSignOnMessage.java\njava/org/apache/catalina/ha/context/ReplicatedContext.java\njava/org/apache/catalina/ha/deploy/FarmWarDeployer.java\njava/org/apache/catalina/ha/deploy/FileMessage.java\njava/org/apache/catalina/ha/deploy/WarWatcher.java\njava/org/apache/catalina/ha/session/BackupManager.java\njava/org/apache/catalina/ha/session/ClusterSessionListener.java\njava/org/apache/catalina/ha/session/DeltaManager.java\njava/org/apache/catalina/ha/session/DeltaRequest.java\njava/org/apache/catalina/ha/session/DeltaSession.java\njava/org/apache/catalina/ha/session/JvmRouteBinderValve.java\njava/org/apache/catalina/ha/session/JvmRouteSessionIDBinderListener.java\njava/org/apache/catalina/ha/session/ReplicatedSession.java\njava/org/apache/catalina/ha/session/SerializablePrincipal.java\njava/org/apache/catalina/ha/session/SessionIDMessage.java\njava/org/apache/catalina/ha/session/SessionMessageImpl.java\njava/org/apache/catalina/ha/session/SimpleTcpReplicationManager.java\njava/org/apache/catalina/ha/tcp/ReplicationValve.java\njava/org/apache/catalina/loader/WebappLoader.java\njava/org/apache/catalina/manager/HTMLManagerServlet.java\njava/org/apache/catalina/manager/JMXProxyServlet.java\njava/org/apache/catalina/manager/ManagerServlet.java\njava/org/apache/catalina/manager/StatusManagerServlet.java\njava/org/apache/catalina/manager/host/HTMLHostManagerServlet.java\njava/org/apache/catalina/manager/host/HostManagerServlet.java\njava/org/apache/catalina/mbeans/ClassNameMBean.java\njava/org/apache/catalina/mbeans/ConnectorMBean.java\njava/org/apache/catalina/mbeans/ContextEnvironmentMBean.java\njava/org/apache/catalina/mbeans/ContextResourceLinkMBean.java\njava/org/apache/catalina/mbeans/ContextResourceMBean.java\njava/org/apache/catalina/realm/CombinedRealm.java\njava/org/apache/catalina/realm/DataSourceRealm.java\njava/org/apache/catalina/realm/GenericPrincipal.java\njava/org/apache/catalina/realm/JAASMemoryLoginModule.java\njava/org/apache/catalina/realm/JAASRealm.java\njava/org/apache/catalina/realm/JDBCRealm.java\njava/org/apache/catalina/realm/JNDIRealm.java\njava/org/apache/catalina/realm/LockOutRealm.java\njava/org/apache/catalina/realm/MemoryRealm.java\njava/org/apache/catalina/realm/MemoryRuleSet.java\njava/org/apache/catalina/realm/RealmBase.java\njava/org/apache/catalina/realm/UserDatabaseRealm.java\njava/org/apache/catalina/servlets/CGIServlet.java\njava/org/apache/catalina/servlets/DefaultServlet.java\njava/org/apache/catalina/servlets/WebdavServlet.java\njava/org/apache/catalina/session/FileStore.java\njava/org/apache/catalina/session/JDBCStore.java\njava/org/apache/catalina/session/PersistentManager.java\njava/org/apache/catalina/session/PersistentManagerBase.java\njava/org/apache/catalina/session/StandardManager.java\njava/org/apache/catalina/session/StandardSession.java\njava/org/apache/catalina/ssi/ByteArrayServletOutputStream.java\njava/org/apache/catalina/ssi/ExpressionParseTree.java\njava/org/apache/catalina/ssi/ResponseIncludeWrapper.java\njava/org/apache/catalina/ssi/SSIServlet.java\njava/org/apache/catalina/startup/Catalina.java\njava/org/apache/catalina/startup/ClusterRuleSetFactory.java\njava/org/apache/catalina/startup/ConnectorCreateRule.java\njava/org/apache/catalina/startup/ContextRuleSet.java\njava/org/apache/catalina/startup/CopyParentClassLoaderRule.java\njava/org/apache/catalina/startup/Embedded.java\njava/org/apache/catalina/startup/EngineRuleSet.java\njava/org/apache/catalina/startup/HostRuleSet.java\njava/org/apache/catalina/startup/LifecycleListenerRule.java\njava/org/apache/catalina/startup/NamingRuleSet.java\njava/org/apache/catalina/startup/RealmRuleSet.java\njava/org/apache/catalina/startup/SetAllPropertiesRule.java\njava/org/apache/catalina/startup/SetContextPropertiesRule.java\njava/org/apache/catalina/startup/SetNextNamingRule.java\njava/org/apache/catalina/startup/TldRuleSet.java\njava/org/apache/catalina/startup/Tomcat.java\njava/org/apache/catalina/startup/WebRuleSet.java\njava/org/apache/catalina/tribes/ChannelException.java\njava/org/apache/catalina/tribes/UniqueId.java\njava/org/apache/catalina/tribes/group/ChannelCoordinator.java\njava/org/apache/catalina/tribes/group/GroupChannel.java\njava/org/apache/catalina/tribes/group/RpcChannel.java\njava/org/apache/catalina/tribes/group/RpcMessage.java\njava/org/apache/catalina/tribes/group/interceptors/DomainFilterInterceptor.java\njava/org/apache/catalina/tribes/group/interceptors/FragmentationInterceptor.java\njava/org/apache/catalina/tribes/group/interceptors/GzipInterceptor.java\njava/org/apache/catalina/tribes/group/interceptors/MessageDispatch15Interceptor.java\njava/org/apache/catalina/tribes/group/interceptors/MessageDispatchInterceptor.java\njava/org/apache/catalina/tribes/group/interceptors/NonBlockingCoordinator.java\njava/org/apache/catalina/tribes/group/interceptors/OrderInterceptor.java\njava/org/apache/catalina/tribes/group/interceptors/StaticMembershipInterceptor.java\njava/org/apache/catalina/tribes/group/interceptors/TcpFailureDetector.java\njava/org/apache/catalina/tribes/group/interceptors/TcpPingInterceptor.java\njava/org/apache/catalina/tribes/group/interceptors/ThroughputInterceptor.java\njava/org/apache/catalina/tribes/group/interceptors/TwoPhaseCommitInterceptor.java\njava/org/apache/catalina/tribes/io/ChannelData.java\njava/org/apache/catalina/tribes/io/DirectByteArrayOutputStream.java\njava/org/apache/catalina/tribes/io/ReplicationStream.java\njava/org/apache/catalina/tribes/membership/McastServiceImpl.java\njava/org/apache/catalina/tribes/membership/MemberImpl.java\njava/org/apache/catalina/tribes/membership/Membership.java\njava/org/apache/catalina/tribes/tipis/AbstractReplicatedMap.java\njava/org/apache/catalina/tribes/tipis/LazyReplicatedMap.java\njava/org/apache/catalina/tribes/tipis/ReplicatedMap.java\njava/org/apache/catalina/tribes/transport/PooledSender.java\njava/org/apache/catalina/tribes/transport/bio/BioReplicationTask.java\njava/org/apache/catalina/tribes/transport/bio/BioSender.java\njava/org/apache/catalina/tribes/transport/bio/MultipointBioSender.java\njava/org/apache/catalina/tribes/transport/bio/PooledMultiSender.java\njava/org/apache/catalina/tribes/transport/nio/NioReceiver.java\njava/org/apache/catalina/tribes/transport/nio/NioSender.java\njava/org/apache/catalina/tribes/transport/nio/ParallelNioSender.java\njava/org/apache/catalina/tribes/transport/nio/PooledParallelSender.java\njava/org/apache/catalina/tribes/util/ExecutorFactory.java\njava/org/apache/catalina/users/MemoryGroup.java\njava/org/apache/catalina/users/MemoryRole.java\njava/org/apache/catalina/users/MemoryUser.java\njava/org/apache/catalina/users/MemoryUserDatabase.java\njava/org/apache/catalina/util/CustomObjectInputStream.java\njava/org/apache/catalina/util/Extension.java\njava/org/apache/catalina/util/ManifestResource.java\njava/org/apache/catalina/util/ParameterMap.java\njava/org/apache/catalina/util/ResourceSet.java\njava/org/apache/catalina/util/XMLWriter.java\njava/org/apache/catalina/valves/AccessLogValve.java\njava/org/apache/catalina/valves/CometConnectionManagerValve.java\njava/org/apache/catalina/valves/ErrorReportValve.java\njava/org/apache/catalina/valves/ExtendedAccessLogValve.java\njava/org/apache/catalina/valves/PersistentValve.java\njava/org/apache/catalina/valves/RemoteAddrValve.java\njava/org/apache/catalina/valves/RemoteHostValve.java\njava/org/apache/catalina/valves/RequestFilterValve.java\njava/org/apache/catalina/valves/SSLValve.java\njava/org/apache/catalina/valves/SemaphoreValve.java\njava/org/apache/catalina/valves/ValveBase.java'),(1652,48131,'Bug 48131 – Add @deprecated annotations to deprecated elements','','2009-11-04 13:30:07','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','a3fa5d3','Mark Emlyn David Thomas','2009-11-04 19:46:07','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48131 Patch provided by sebb','java/javax/servlet/ServletContext.java\njava/javax/servlet/ServletRequest.java\njava/javax/servlet/ServletRequestWrapper.java\njava/javax/servlet/SingleThreadModel.java\njava/javax/servlet/UnavailableException.java\njava/javax/servlet/http/HttpServletRequest.java\njava/javax/servlet/http/HttpServletRequestWrapper.java\njava/javax/servlet/http/HttpServletResponse.java\njava/javax/servlet/http/HttpServletResponseWrapper.java\njava/javax/servlet/http/HttpSession.java\njava/javax/servlet/http/HttpSessionContext.java\njava/javax/servlet/http/HttpUtils.java\njava/javax/servlet/jsp/JspException.java\njava/javax/servlet/jsp/el/ELException.java\njava/javax/servlet/jsp/el/ELParseException.java\njava/javax/servlet/jsp/el/Expression.java\njava/javax/servlet/jsp/el/ExpressionEvaluator.java\njava/javax/servlet/jsp/el/FunctionMapper.java\njava/javax/servlet/jsp/el/VariableResolver.java\njava/javax/servlet/jsp/tagext/BodyTag.java\njava/org/apache/catalina/Cluster.java\njava/org/apache/catalina/Manager.java\njava/org/apache/catalina/connector/Request.java\njava/org/apache/catalina/connector/Response.java\njava/org/apache/catalina/core/ApplicationContext.java\njava/org/apache/catalina/core/ApplicationContextFacade.java\njava/org/apache/catalina/core/ApplicationHttpResponse.java\njava/org/apache/catalina/core/DummyRequest.java\njava/org/apache/catalina/core/DummyResponse.java\njava/org/apache/catalina/ha/session/DeltaSession.java\njava/org/apache/catalina/ha/tcp/SimpleTcpCluster.java\njava/org/apache/catalina/realm/JAASRealm.java\njava/org/apache/catalina/session/ManagerBase.java\njava/org/apache/catalina/session/StandardSession.java\njava/org/apache/catalina/session/StandardSessionFacade.java\njava/org/apache/catalina/startup/Catalina.java\njava/org/apache/catalina/tribes/io/XByteBuffer.java\njava/org/apache/catalina/tribes/membership/McastService.java\njava/org/apache/catalina/tribes/transport/ReceiverBase.java\njava/org/apache/el/parser/SimpleCharStream.java\njava/org/apache/jasper/servlet/JspCServletContext.java\njava/org/apache/naming/resources/ResourceAttributes.java\njava/org/apache/tomcat/util/digester/Rule.java\njava/org/apache/tomcat/util/digester/SetNextRule.java\njava/org/apache/tomcat/util/digester/SetPropertiesRule.java\njava/org/apache/tomcat/util/digester/SetPropertyRule.java\njava/org/apache/tomcat/util/digester/SetRootRule.java\njava/org/apache/tomcat/util/digester/SetTopRule.java'),(1653,48123,'Bug 48123 – 4 misspellings in the javadoc of class \"org.apache.catalina.startup.WebRuleSet\"','No.1\n\nLine: 99\n\n/**\n     * Construct an instance of this <code>RuleSet</code> with the default\n     * matching pattern prefix and default fargment setting.\n     */\n    public WebRuleSet() {\n\n\'fragment\' was misspelled as \'fargment\'\n\nNo.2\n\nLine: 614\n\n/**\n * Rule to check that the <code>login-config</code> is occuring \n * only 1 time within the web.xml\n */\nfinal class SetLoginConfig extends Rule {\n\n\'occurring\' was misspelled as \'occuring\'\n\nNo.3\n\nLine 635\n\n/**\n * Rule to check that the <code>jsp-config</code> is occuring \n * only 1 time within the web.xml\n */\nfinal class SetJspConfig extends Rule {\n\n\'occurring\' was misspelled as \'occuring\'\n\nNo.4\n\nLine 656\n\n/**\n * Rule to check that the <code>session-config</code> is occuring \n * only 1 time within the web.xml\n */\nfinal class SetSessionConfig extends Rule {\n\n\'occurring\' was misspelled as \'occuring\'','2009-11-04 02:02:40','qingyang.xu','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 trivial','363b79a','Mark Emlyn David Thomas','2009-11-04 19:34:33','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48123 Spelling errors','java/org/apache/catalina/startup/WebRuleSet.java'),(1654,48121,'Bug 48121 – 2 misspellings in the javadoc of class \"org.apache.catalina.startup.TldConfig\"','No.1\n\nLine 194:\n\n/**\n     * Attribute value used to turn on/off TLD  namespace awarenes.\n     */\n    private boolean tldNamespaceAware = false;\n\n\'awareness\' was misspelled as \'awarenes\'\n\n\nNo.2\n\nLine 261\n\n/**\n     * Get the server.xml &lt;host&gt; attribute\'s xmlNamespaceAware.\n     * @return true if namespace awarenes is enabled.\n     *\n     */\n    public boolean getTldNamespaceAware(){\n        return this.tldNamespaceAware;\n    }\n\n\'awareness\' was misspelled as \'awarenes\'','2009-11-04 01:48:39','qingyang.xu','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 trivial','5d9f68b','Mark Emlyn David Thomas','2009-11-04 19:30:25','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48121 Spelling errors','java/org/apache/catalina/startup/TldConfig.java'),(1655,48120,'Bug 48120 – one misspelling in the javadoc of class \"org.apache.catalina.startup.SetNextNamingRule\"','Line 50:\n\n/**\n     * Construct a \"set next\" rule with the specified method name.\n     *\n     * @param methodName Method name of the parent method to call\n     * @param paramType Java class of the parent method\'s argument\n     *  (if you wish to use a primitive type, specify the corresonding\n     *  Java wrapper class instead, such as <code>java.lang.Boolean</code>\n     *  for a <code>boolean</code> parameter)\n     */\n    public SetNextNamingRule(String methodName,\n                       String paramType) {\n\n\'corresponding\' was misspelled as \'corresonding\'','2009-11-04 01:45:46','qingyang.xu','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 trivial','7508847','Mark Emlyn David Thomas','2009-11-04 19:28:09','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48120 Spelling errors','java/org/apache/catalina/startup/SetNextNamingRule.java'),(1656,48117,'Bug 48117 – two misspellings in the javadoc of class \"org.apache.catalina.startup.ContextConfig\"','in protected synchronized void stop(): (Line: 1059)\n\n// Removing sercurity role\n\n\'security\' is misspelled to \'sercurity\'\n\n\n\n\nin protected InputSource getWebXmlSource(String filename, String path): (Line: 1354)\n\n/**\n     * \n     * @param filename  Name of the file (possibly with one or more leading path\n     *                  segemnts) to read\n     * @param path      Location that filename is relative to \n     * @return\n     */\n\n\'segments\' is misspelled to \'segemnts\'.','2009-11-04 01:26:19','qingyang.xu','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 trivial','b6df018','Mark Emlyn David Thomas','2009-11-04 19:26:28','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48117 Spelling errors','java/org/apache/catalina/startup/ContextConfig.java'),(1657,47512,'Bug 47512 – Binding java.lang.reflect.Proxy to JNDI directory raises java.lang.ClassCastException','I\'ve created a custom javax.naming.spi.ObjectFactory that is able to bind javax.naming.Reference(s) into the global JNDI naming directory during startup time using a org.apache.catalina.LifecycleListener.\n\nI want two separate web contexts invoke the custom ObjectFactory#getObjectInstance method indirectly, getting through the local to the global JNDI context with a ResourceLink by invoking the local InitialContext#lookup method. Since both contexts have different classloaders my intention is to create a java.lang.reflect.Proxy given the current thread classloader.\n\nFor the first web context, everything goes Ok. The thread reaches the ObjectFactory, the object factory peeks the current thread classloader (always a webapp classloader), peeks the name of the interface to use for Proxy#newProxyInstance method, and the object to proxify for an internal collection and returns the proxy.\n\nThe problem arises for the second web context. The InitialContext#lookup method resolves the name and, although the thread never reaches the ObjectFactory, the object is resolved. Surprisingly, the returned object is the proxy created for the first web context. This proxy implements an interface available in the first web context\'s classloader. This interface is present in the second context classpath, but is loaded by a different webapp classloader. Thus, a java.lang.ClassCastException is raised.\n\nDigging into the tomcat codebase, I found in org.apache.naming.NamingContext that once a reference is resolved, the resolved object is sort of rebound to the original name. Thus, when the second lookup invocation arrives, the name is associated to an object (not a reference) and the ObjectFactory is never invoked.\n\nHere\'s the org.apache.naming.NamingContext code, lines 791 to 799:\n\n } else if (entry.type == NamingEntry.REFERENCE) {\n       try {\n          Object obj = NamingManager.getObjectInstance(entry.value, name, this, env);\n             if (obj != null) {\n               entry.value = obj;\n               entry.type = NamingEntry.ENTRY;\n             }\n          return obj;\n\nWhen a NamingEntry.REFERENCE arrive, the reference is resolved with the help of a javax.naming.spi.NamingManager. If the resolved object is null, the entry is converted to a NamingEntry.ENTRY instead of leaving it as a NamingEntry.REFERENCE.\n\nIn my opinion, the entry should be left as a REFERENCE, so the next invocation to the method, no matter who is the invoker nor its classloader, resolves the reference again with the javax.naming.spi.NamingManager\'s help. This \"cache\" policy of references should be left to the ObjectFactory itself, which will have all the necessary information to apply such a policy.\n\nThe code change would only imply the removal of the if I\'ve shown above.\n\nRegards,\n\nMartin.','2009-07-11 23:09:33','Martín Schonaker','Tomcat Developers Mailing List','RESOLVED WONTFIX','Tomcat 6','Catalina','P2 normal','7f03558','Timothy A. Funk','2009-11-04 11:40:16','revert based on https://issues.apache.org/bugzilla/show_bug.cgi?id=47512#c4','java/org/apache/naming/NamingContext.java'),(1658,48119,'Bug 48119 – 5 misspellings in the javadoc of class \"org.apache.catalina.startup.HostConfig\'','No.1\n\nLine 146:\n\n/**\n     * Attribute value used to turn on/off XML namespace awarenes.\n     */\n    protected boolean xmlNamespaceAware = false;\n\n\'awareness\' was misspelled as \'awarenes\'\n\n\nNo.2\n\nLine 268:\n\n/**\n     * Get the server.xml &lt;host&gt; attribute\'s xmlNamespaceAware.\n     * @return true if namespace awarenes is enabled.\n     *\n     */\n    public boolean getXmlNamespaceAware(){\n        return xmlNamespaceAware;\n    }\n\n\'awareness\' was misspelled as \'awarenes\'\n\nNo.3\n\nLine 366:\n\n/**\n     * Has the specified application been deployed? Note applications defined\n     * in server.xml will not have been deployed.\n     * @return <code>true</code> if the application has been deployed and\n     * <code>false</code> if the applciation has not been deployed or does not\n     * exist\n     */\n    public boolean isDeployed(String name) {\n\n\'application\' was misspelled as \'applciation\'\n\nNo.4\n\nLine 1328:\n\n/**\n     * Add a new Context to be managed by us.\n     * Entry point for the admin webapp, and other JMX Context controlers.\n     */\n    public void manageApp(Context context)  {    \n\n\'controllers\' was misspelled as \'controlers\'\n\nLine 1382:\n\n/**\n     * Remove a webapp from our control.\n     * Entry point for the admin webapp, and other JMX Context controlers.\n     */\n    public void unmanageApp(String contextPath) {\n\n\'controllers\' was misspelled as \'controlers\'','2009-11-04 01:42:30','qingyang.xu','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 trivial','07e5982','Ian Darwin','2009-11-04 08:26:33','Bugfix typos from 48119','java/org/apache/catalina/startup/HostConfig.java'),(1659,48118,'Bug 48118 – two misspellings in the javadoc of class \"org.apache.catalina.startup.Embeded\"','Line: 230\n/**\n     * Return true if redirction of standard streams is enabled.\n     */\n    public boolean isRedirectStreams() {\n\n        return (this.redirectStreams);\n\n    }\n\n\'redirection\' was misspelled to \'redirction\'\n\n\nLine: 875\n\n/** Initialize naming - this should only enable java:env and root naming.\n     * If tomcat is embeded in an application that already defines those -\n     * it shouldn\'t do it.\n     *\n     * XXX The 2 should be separated, you may want to enable java: but not\n     * the initial context and the reverse\n     * XXX Can we \"guess\" - i.e. lookup java: and if something is returned assume\n     * false ?\n     * XXX We have a major problem with the current setting for java: url\n     */\n    protected void initNaming() {\n\n\n\'embedded\' was mispelled to \'embeded\'','2009-11-04 01:33:03','qingyang.xu','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 trivial','ae16eb2','Ian Darwin','2009-11-04 08:13:41','Bugfix typos from 48118','java/org/apache/catalina/startup/Embedded.java'),(1660,47512,'Bug 47512 – Binding java.lang.reflect.Proxy to JNDI directory raises java.lang.ClassCastException','I\'ve created a custom javax.naming.spi.ObjectFactory that is able to bind javax.naming.Reference(s) into the global JNDI naming directory during startup time using a org.apache.catalina.LifecycleListener.\n\nI want two separate web contexts invoke the custom ObjectFactory#getObjectInstance method indirectly, getting through the local to the global JNDI context with a ResourceLink by invoking the local InitialContext#lookup method. Since both contexts have different classloaders my intention is to create a java.lang.reflect.Proxy given the current thread classloader.\n\nFor the first web context, everything goes Ok. The thread reaches the ObjectFactory, the object factory peeks the current thread classloader (always a webapp classloader), peeks the name of the interface to use for Proxy#newProxyInstance method, and the object to proxify for an internal collection and returns the proxy.\n\nThe problem arises for the second web context. The InitialContext#lookup method resolves the name and, although the thread never reaches the ObjectFactory, the object is resolved. Surprisingly, the returned object is the proxy created for the first web context. This proxy implements an interface available in the first web context\'s classloader. This interface is present in the second context classpath, but is loaded by a different webapp classloader. Thus, a java.lang.ClassCastException is raised.\n\nDigging into the tomcat codebase, I found in org.apache.naming.NamingContext that once a reference is resolved, the resolved object is sort of rebound to the original name. Thus, when the second lookup invocation arrives, the name is associated to an object (not a reference) and the ObjectFactory is never invoked.\n\nHere\'s the org.apache.naming.NamingContext code, lines 791 to 799:\n\n } else if (entry.type == NamingEntry.REFERENCE) {\n       try {\n          Object obj = NamingManager.getObjectInstance(entry.value, name, this, env);\n             if (obj != null) {\n               entry.value = obj;\n               entry.type = NamingEntry.ENTRY;\n             }\n          return obj;\n\nWhen a NamingEntry.REFERENCE arrive, the reference is resolved with the help of a javax.naming.spi.NamingManager. If the resolved object is null, the entry is converted to a NamingEntry.ENTRY instead of leaving it as a NamingEntry.REFERENCE.\n\nIn my opinion, the entry should be left as a REFERENCE, so the next invocation to the method, no matter who is the invoker nor its classloader, resolves the reference again with the javax.naming.spi.NamingManager\'s help. This \"cache\" policy of references should be left to the ObjectFactory itself, which will have all the necessary information to apply such a policy.\n\nThe code change would only imply the removal of the if I\'ve shown above.\n\nRegards,\n\nMartin.','2009-07-11 23:09:33','Martín Schonaker','Tomcat Developers Mailing List','RESOLVED WONTFIX','Tomcat 6','Catalina','P2 normal','fee6544','Timothy A. Funk','2009-11-03 20:18:08','Binding java.lang.reflect.Proxy to JNDI directory raises java.lang.ClassCastException https://issues.apache.org/bugzilla/show_bug.cgi?id=47512','java/org/apache/naming/NamingContext.java'),(1661,46947,'Bug 46947 – Code cleanup patch that removes some obsolete null checks','','2009-03-31 13:00:32','Lars Kühne','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P5 enhancement','6908b18','Timothy A. Funk','2009-11-03 19:54:02','https://issues.apache.org/bugzilla/show_bug.cgi?id=46947','java/org/apache/catalina/ant/jmx/JMXAccessorTask.java\njava/org/apache/catalina/tribes/transport/bio/BioReceiver.java\njava/org/apache/catalina/valves/JDBCAccessLogValve.java\njava/org/apache/tomcat/util/net/NioBlockingSelector.java'),(1662,48066,'Bug 48066 – ant.jar is needless in build.xml','following is the relevant parts of the \'build.xml\' file:\n\n<path id=\"tomcat.classpath\">\n    <pathelement location=\"${ant.jar}\"/>\n    <pathelement location=\"${jdt.jar}\"/>\n</path>\n\n... ...\n<target name=\"compile\">\n     <javac srcdir=\"java\" destdir=\"${tomcat.classes}\"\n           debug=\"${compile.debug}\"\n           deprecation=\"${compile.deprecation}\"\n           source=\"${compile.source}\"\n           target=\"${compile.target}\"\n           optimize=\"${compile.optimize}\"\n           excludes=\"**/CVS/**,**/.svn/**\"\n           encoding=\"ISO-8859-1\">\n<!-- Comment this in to show unchecked warnings:     <compilerarg\nvalue=\"-Xlint:unchecked\"/> -->\n      <classpath refid=\"tomcat.classpath\" />\n      <exclude name=\"org/apache/naming/factory/webservices/**\" />\n     </javac>\n     ... ...\n</target>\n\n\n\nHowever, if you delete the first item (<pathelement location=\"${ant.jar}\"/>) in\nthe path element whose id is \'tomcat.classpath\', the target of \'compile\' still\nruns successfully, and if you invoke ant as \"ant -v\", you can see that\n\'ant.jar\' has already been included in the classpath. For example, the\nfollowing is the output on my machine:\n\n... ...\nCompiling 1052 source files to\n/home/xuqy/Downloads/apache-tomcat-6.0.20-src/output/classes\n    [javac] Using modern compiler\n    [javac] Compilation arguments:\n    [javac] \'-d\'\n    [javac] \'/home/xuqy/Downloads/apache-tomcat-6.0.20-src/output/classes\'\n    [javac] \'-classpath\'\n    [javac]\n\'/home/xuqy/Downloads/apache-tomcat-6.0.20-src/output/classes:/home/xuqy/tomcat-base-path/eclipse/plugins/org.eclipse.jdt.core_3.3.1.v_780_R33x.jar:/usr/local/apache-ant-1.7.1/lib/ant-launcher.jar:/usr/local/apache-ant-1.7.1/lib/xercesImpl.jar:/usr/local/apache-ant-1.7.1/lib/ant-jdepend.jar:/usr/local/apache-ant-1.7.1/lib/ant-javamail.jar:/usr/local/apache-ant-1.7.1/lib/ant-commons-net.jar:/usr/local/apache-ant-1.7.1/lib/ant-apache-oro.jar:/usr/local/apache-ant-1.7.1/lib/ant.jar:/usr/local/apache-ant-1.7.1/lib/ant-weblogic.jar:/usr/local/apache-ant-1.7.1/lib/xml-apis.jar:/usr/local/apache-ant-1.7.1/lib/ant-jmf.jar:/usr/local/apache-ant-1.7.1/lib/ant-trax.jar:/usr/local/apache-ant-1.7.1/lib/ant-jsch.jar:/usr/local/apache-ant-1.7.1/lib/ant-commons-logging.jar:/usr/local/apache-ant-1.7.1/lib/ant-apache-regexp.jar:/usr/local/apache-ant-1.7.1/lib/ant-swing.jar:/usr/local/apache-ant-1.7.1/lib/ant-junit.jar:/usr/local/apache-ant-1.7.1/lib/ant-testutil.jar:/usr/local/apache-ant-1.7.1/lib/ant-antlr.jar:/usr/local/apache-ant-1.7.1/lib/ant-jai.jar:/usr/local/apache-ant-1.7.1/lib/ant-nodeps.jar:/usr/local/apache-ant-1.7.1/lib/ant-apache-bsf.jar:/usr/local/apache-ant-1.7.1/lib/ant-apache-resolver.jar:/usr/local/apache-ant-1.7.1/lib/ant-netrexx.jar:/usr/local/apache-ant-1.7.1/lib/ant-starteam.jar:/usr/local/apache-ant-1.7.1/lib/ant-apache-log4j.jar:/usr/local/apache-ant-1.7.1/lib/ant-stylebook.jar:/usr/local/apache-ant-1.7.1/lib/ant-apache-bcel.jar:/usr/lib/jvm/java-6-sun-1.6.0.16/lib/tools.jar\'\n    [javac] \'-sourcepath\'\n    [javac] \'/home/xuqy/Downloads/apache-tomcat-6.0.20-src/java\'\n    [javac] \'-target\'\n    [javac] \'1.5\'\n    [javac] \'-g\'\n    [javac] \'-source\'\n    [javac] \'1.5\'\n\nIt seems that Ant appends ant.jar automatically when invoking javac target. So, removing ant.jar from classpath is safe. Furthermore, ant.jar is neither alluded in build.xml.default nor in the file of \'BUILDING.txt\'. In most cases, it is discarded silently.','2009-10-27 09:09:23','qingyang.xu','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 normal','860fb0e','Mark Emlyn David Thomas','2009-11-02 19:25:54','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48066 Be explicit about including Ant on the compilation classpath','build.xml'),(1663,47918,'Bug 47918 – Wrong description in o.a.c.startup.mbeans-desriptors.xml for the HostConfig operations','','2009-09-30 00:42:57','Uwe Günther','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','8a7022a','Mark Emlyn David Thomas','2009-11-02 19:20:18','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47918 Fix copy and paste descriptions','java/org/apache/catalina/startup/mbeans-descriptors.xml'),(1664,48102,'Bug 48102 – \'Bootstrap\' is misspelled as \'Boostrap\' in the javadoc of the class of \'org.apache.catalina.startup.Bootstrap\'','Below is the javadoc of the class of \'org.apache.catalina.startup.Bootstrap\':\n\n/**\n * Boostrap loader for Catalina.  This application constructs a class loader\n * for use in loading the Catalina internal classes (by accumulating all of the\n * JAR files found in the \"server\" directory under \"catalina.home\"), and\n * starts the regular execution of the container.  The purpose of this\n * roundabout approach is to keep the Catalina internal classes (and any\n * other classes they depend on, such as an XML parser) out of the system\n * class path and therefore not visible to application level classes.\n *\n * @author Craig R. McClanahan\n * @author Remy Maucherat\n * @version $Revision: 831860 $ $Date: 2009-11-02 19:00:01 +0800 (Mon, 02 Nov 2009) $\n */\n\nthe first word ommits a \'t\' letter. It sould be \'Bootstrap\', not \'Boostrap\'.','2009-11-02 03:11:25','qingyang.xu','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','c060034','Mark Emlyn David Thomas','2009-11-02 19:16:42','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48102 and https://issues.apache.org/bugzilla/show_bug.cgi?id=48103 Typos in Javadoc','java/org/apache/catalina/startup/Bootstrap.java'),(1665,48103,'Bug 48103 – \'standalone\' is misspelled as \'standlone\' twice in the javadoc of the class of \'org.apache.catalina.startup.Bootstrap\'','/**\n     * Stop the standlone server.\n     */\n    public void stopServer()\n        throws Exception {\n\n        Method method = \n            catalinaDaemon.getClass().getMethod(\"stopServer\", (Class []) null);\n        method.invoke(catalinaDaemon, (Object []) null);\n\n    }\n\n\n   /**\n     * Stop the standlone server.\n     */\n    public void stopServer(String[] arguments)\n        throws Exception {\n\n        Object param[];\n        Class<?> paramTypes[];\n        if (arguments==null || arguments.length==0) {\n            paramTypes = null;\n            param = null;\n        } else {\n            paramTypes = new Class[1];\n            paramTypes[0] = arguments.getClass();\n            param = new Object[1];\n            param[0] = arguments;\n        }\n        Method method = \n            catalinaDaemon.getClass().getMethod(\"stopServer\", paramTypes);\n        method.invoke(catalinaDaemon, param);\n\n    }','2009-11-02 03:14:04','qingyang.xu','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','c060034','Mark Emlyn David Thomas','2009-11-02 19:16:42','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48102 and https://issues.apache.org/bugzilla/show_bug.cgi?id=48103 Typos in Javadoc','java/org/apache/catalina/startup/Bootstrap.java'),(1666,48104,'Bug 48104 – the javadoc of class \'org.apache.catalina.startup.Catalina\' is not complete, as in the usage() method','Below is the javadoc of class \'org.apache.catalina.startup.Catalina\':\n\n/**\n * Startup/Shutdown shell program for Catalina.  The following command line\n * options are recognized:\n * <ul>\n * <li><b>-config {pathname}</b> - Set the pathname of the configuration file\n *     to be processed.  If a relative path is specified, it will be\n *     interpreted as relative to the directory pathname specified by the\n *     \"catalina.base\" system property.   [conf/server.xml]\n * <li><b>-help</b> - Display usage information.\n * <li><b>-stop</b> - Stop the currently running instance of Catalina.\n * </u>\n *\n * Should do the same thing as Embedded, but using a server.xml file.\n *\n * @author Craig R. McClanahan\n * @author Remy Maucherat\n * @version $Revision: 752323 $ $Date: 2009-03-11 08:46:54 +0800 (Wed, 11 Mar 2009) $\n */\n\nHowever, it doesn\'t allude the \'-nonmaing\' option, and \'start\' option.\n\nBelow is the usage() method of the same class:\n\n/**\n     * Print usage information for this application.\n     */\n    protected void usage() {\n\n        System.out.println\n            (\"usage: java org.apache.catalina.startup.Catalina\"\n             + \" [ -config {pathname} ]\"\n             + \" [ -nonaming ] { start | stop }\");\n\n    }\n\nIt is not complete either. It lacks the \'-help\' option.','2009-11-02 03:20:57','qingyang.xu','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','481cfe9','Mark Emlyn David Thomas','2009-11-02 19:14:11','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48104 Align Javadoc, usage message and code','java/org/apache/catalina/startup/Catalina.java'),(1667,47881,'Bug 47881 – org.apache.catalina.startup.Bootstrap\'s main method handles \'startd\' or \'stopd\' wrongly','String command = \"start\";\nif (args.length > 0) {\n    command = args[args.length - 1];\n}\n\nif (command.equals(\"startd\")) {\n    args[0] = \"start\";\n    daemon.load(args);\n    daemon.start();\n} else if (command.equals(\"stopd\")) {\n    args[0] = \"stop\";\n    daemon.stop();\n} \n... ...\n\n\nshould be: \n\nString command = \"start\";\nif (args.length > 0) {\n    command = args[args.length - 1];\n}\nif (command.equals(\"startd\")) {\n    args[args.length - 1] = \"start\";\n    daemon.load(args);\n    daemon.start();\n} else if (command.equals(\"stopd\")) {\n    args[args.length - 1] = \"stop\";\n    daemon.stop();\n} \n... ...\n\nPlease refer to the following usage method of  org.apache.catalina.startup.Catalina:\nprotected void usage() {\n\n        System.out.println\n            (\"usage: java org.apache.catalina.startup.Catalina\"\n             + \" [ -config {pathname} ]\"\n             + \" [ -nonaming ] { start | stop }\");\n\n    }','2009-09-20 19:14:04','qingyang.xu','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 minor','3ef0f21','Konstantin Kolinko','2009-11-02 06:00:01','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47881 Fix processing of \"startd\" and \"stopd\" arguments, when they are not alone. Patch by Qingyang Xu','java/org/apache/catalina/startup/Bootstrap.java'),(1668,48097,'Bug 48097 – NoClassDefFoundError on first access of first jsp','','2009-11-01 11:06:06','Amichai','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','66e503c','Konstantin Kolinko','2009-11-02 04:12:10','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48097 Make SecurityClassLoad to preload o.a.c.loader.ResourceEntry class','java/org/apache/catalina/security/SecurityClassLoad.java'),(1669,48097,'Bug 48097 – NoClassDefFoundError on first access of first jsp','','2009-11-01 11:06:06','Amichai','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','4d3f83f','Konstantin Kolinko','2009-11-02 04:03:13','Make WebappClassLoader to do not swallow AccessControlException See https://issues.apache.org/bugzilla/show_bug.cgi?id=48097','java/org/apache/catalina/loader/WebappClassLoader.java'),(1670,47331,'Bug 47331 – No translation error messag when using #{...} in template text','','2009-06-08 02:22:52','Marco Guazzone','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','f3b04b4','Mark Emlyn David Thomas','2009-11-01 19:30:55','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47331 Uninterpreted tags are essentially template text so apply the rules of JSp.2.2 there too.','java/org/apache/jasper/compiler/Validator.java\njava/org/apache/jasper/resources/LocalStrings.properties'),(1671,47451,'Bug 47451 – NPE if response contains null content-encoding header','','2009-06-29 14:53:48','Dan Rabe','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 normal','14084ac','Mark Emlyn David Thomas','2009-11-01 17:53:29','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47451 Don\'t trigger an NPE if headers with null or zero length name or set or if a null value is specified. Silently ignore any such calls in the same way the calls are ignored if the response has already been committed.','java/org/apache/catalina/connector/Response.java'),(1672,47364,'Bug 47364 – HttpServletRequest.getAttributeNames() does not return the names of all attributes','In an email exchange that involved Ranier (see attachment), he suggested I log this in Bugzilla, so I am.\n\nI was using Tomcat 6.0.20 on Windows XP SP3 with the latest Java 6 JVM. In the doGet method of a servlet, I was trying to see all request attributes to see if the \"sendfile supported\" attribute was set (specifically the request attribute org.apache.tomcat.sendfile.support). On my first pass at this I just used HttpServletRequest.getAttributeNames() to dump all the names of the attributes expecting to see this one listed, but I got no attributes listed at all. Then I actually got the attribute via getAttribute(\"org.apache.tomcat.sendfile.support\") which worked. So getAttributeNames is not returning the names of all attributes.\n\nSo either:\n\n1. getAttributeNames needs to be fixed to return the names of all attributes (i.e., a code change); or\n\n2. The Tomcat doc needs to be updated in some way as to say thatgetAttributeNames only returns certain attributes and blah blah (i.e., a doc change).\n\nAgain my original email and Ranier\'s reply is attached.\n\nThanks!','2009-06-12 13:44:21','Chris Markle','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','7fc56b4','Mark Emlyn David Thomas','2009-11-01 13:35:02','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47364 Document that HttpServletRequest.getAttributeNames() does not return the names of all attributes (internal Tomcat attributes are excluded)','java/org/apache/catalina/connector/Request.java'),(1673,47330,'Bug 47330 – proposal : port of mod_remoteip in Tomcat as RemoteIpValve','','2009-06-07 17:38:02','Cyrille Le Clerc','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','41741c1','Mark Emlyn David Thomas','2009-10-27 18:16:54','Add back the setters for remote host and remote address and provide an implementation. They will be needed for the mod_remoteip port (bug 47330)','java/org/apache/catalina/connector/Request.java'),(1674,47987,'Bug 47987 – Out of memory being caused by notFoundResources in org.apache.catalina.loader.WebappClassLoader','Guys\n\nTomcat 6.0.20, java 1.6, linux x64\n\norg.apache.catalina.loader.WebappClassLoader records every resource you asked\nfor that doesn\'t exist.\n\nOn our site we have alot of pages ( > 800,000 )\nall of which are using struts2 with validation.\nevery hit means the validator does a request for a resource actionName-validation.xml\n\nThis then gets cached in the WebappClassLoader\nabout line 249\n\n    /**\n     * The list of not found resources.\n     */\n    protected HashMap notFoundResources = new HashMap();\n\nCan this be made into a weak hash map perchance ?\n\nor something so that it won\'t invoke a out of memory.\nI\'m also looking at removing the validator from those urls\nif anyone knows how to tell the validation interceptor that we don\'t use the xml files\nand ONLY use annotations then that would be great :)\n\nTa\n\nD','2009-10-12 15:02:07','David','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 major','e745efb','Mark Emlyn David Thomas','2009-10-22 11:44:06','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47987 Limit size of not found resources cache','java/org/apache/catalina/loader/WebappClassLoader.java'),(1675,37848,'Bug 37848 – Inappropriate Output From catalina.sh When No Terminal Available','bin/catalina.sh issues some informational output to \"stdout\" when executed. If\nTomcat is being started by a Unix init script (ie. as part of the boot process),\nthen this output disrupts the boot messages. It would be useful if this output\nwas only issued when Tomcat is being started from the command line.\n\nA simple patch is included below:\n\n-----patch file-----------------------------------------------------------------\n--- catalina.sh 2005-12-09 10:22:44.000000000 +1100\n+++ catalina.sh 2005-12-09 10:24:30.000000000 +1100\n@@ -131,6 +131,11 @@\n   CATALINA_TMPDIR=\"$CATALINA_BASE\"/temp\n fi\n\n+have_tty=0\n+if [ \"`tty`\" != \"not a tty\" ]; then\n+    have_tty=1\n+fi\n+\n # For Cygwin, switch paths to Windows format before running java\n if $cygwin; then\n   JAVA_HOME=`cygpath --absolute --windows \"$JAVA_HOME\"`\n@@ -150,13 +155,15 @@\n\n # ----- Execute The Requested Command -------------------------------\n\n\n-echo \"Using CATALINA_BASE:   $CATALINA_BASE\"\n-echo \"Using CATALINA_HOME:   $CATALINA_HOME\"\n-echo \"Using CATALINA_TMPDIR: $CATALINA_TMPDIR\"\n-if [ \"$1\" = \"debug\" -o \"$1\" = \"javac\" ] ; then\n-  echo \"Using JAVA_HOME:       $JAVA_HOME\"\n-else\n-  echo \"Using JRE_HOME:       $JRE_HOME\"\n+if [ $have_tty -eq 1 ]; then\n+  echo \"Using CATALINA_BASE:   $CATALINA_BASE\"\n+  echo \"Using CATALINA_HOME:   $CATALINA_HOME\"\n+  echo \"Using CATALINA_TMPDIR: $CATALINA_TMPDIR\"\n+  if [ \"$1\" = \"debug\" -o \"$1\" = \"javac\" ] ; then\n+    echo \"Using JAVA_HOME:       $JAVA_HOME\"\n+  else\n+    echo \"Using JRE_HOME:       $JRE_HOME\"\n+  fi\n fi\n\n if [ \"$1\" = \"jpda\" ] ; then','2005-12-09 00:32:04','David Shaw','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P4 trivial','c266228','Mark Emlyn David Thomas','2009-10-21 17:40:21','Refix https://issues.apache.org/bugzilla/show_bug.cgi?id=37848 Don\'t output info messages if there is no terminal Patch provided by Eric Herman','bin/catalina.sh'),(1676,47987,'Bug 47987 – Out of memory being caused by notFoundResources in org.apache.catalina.loader.WebappClassLoader','Guys\n\nTomcat 6.0.20, java 1.6, linux x64\n\norg.apache.catalina.loader.WebappClassLoader records every resource you asked\nfor that doesn\'t exist.\n\nOn our site we have alot of pages ( > 800,000 )\nall of which are using struts2 with validation.\nevery hit means the validator does a request for a resource actionName-validation.xml\n\nThis then gets cached in the WebappClassLoader\nabout line 249\n\n    /**\n     * The list of not found resources.\n     */\n    protected HashMap notFoundResources = new HashMap();\n\nCan this be made into a weak hash map perchance ?\n\nor something so that it won\'t invoke a out of memory.\nI\'m also looking at removing the validator from those urls\nif anyone knows how to tell the validation interceptor that we don\'t use the xml files\nand ONLY use annotations then that would be great :)\n\nTa\n\nD','2009-10-12 15:02:07','David','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 major','65c7bae','Mark Emlyn David Thomas','2009-10-21 16:57:14','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47987 Limit size of not found resources cache','java/org/apache/catalina/loader/WebappClassLoader.java'),(1677,48009,'Bug 48009 – Editing context.xml may cause unwanted undeploy of a webapp','Tomcat polls context.xml files for changes.  If a previously-existing context.xml is missing at the instant Tomcat polls, then the application is undeployed.\n\nSome text editors (notably vi and its derivatives) create backup files by: 1) Renaming the original file, then 2) creating a new file and writing the edited contents to that file.\n\nTherefore there is a race condition.  There is a small but non-zero probability that a user editing and saving context.xml using such an editor will see their webapp undeployed.  Messages on tomcat-users indicate that such a situation has occurred on a production server at least once.  It\'s undoubtedly rare.\n\nSuggested fixes:\n\n- Examine the directory for the presence of backup files for context.xml, and do not undeploy if one is found even if context.xml is missing.  This is horribly ugly and makes the semantics of \"a backup file\" very peculiar, but is actually the only way to *prevent* the race - anything else only makes it less likely, as on a heavily loaded system (or one where context.xml is being edited via a network file share) the interval between the old context.xml being renamed and the new one being created may be arbitrarily long.\n\n- Only undeploy if the file is missing for a period of time.  The discussion is then around that period.  On tomcat-users, Mark Thomas suggested polling again after 500ms; I suggested remembering the state between polls and only undeploying if the file was missing for two successive polls.  This is a cleaner fix to explain, but is not a complete solution as it does not remove the possibility of such a race.\n\n---\n\nAs an aside, there may well be a similar issue where Tomcat polls for context.xml as it is being written, finds it has changed, and reads a part-written version.  In mitigation, the files involved are typically small and may well be written in one or very few operations; however, Tomcat should probably not assume that any file change is atomic.','2009-10-16 01:52:21','Peter Crowther','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','d55f1d9','Mark Emlyn David Thomas','2009-10-21 16:53:47','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48009 Add a check in case the file is in the middle of being renamed. It isn\'t perfect (it can\'t be) but this should cover most cases','java/org/apache/catalina/startup/HostConfig.java'),(1678,48019,'Bug 48019 – StackOverflowError on \"include\"','JSP file name: \n/common/headers.jsp\n\n\nIt\'s cotent:\n\n<% // example: <%@ include file=\"/common/headers.jsp\" % >\n%>\n<meta http-equiv=\"Content-Type\" content=\"text/html;charset=utf-8\" />\n<meta http-equiv=\"Cache-Control\" content=\"no-store\" />\n<meta http-equiv=\"Pragma\" content=\"no-cache\" />\n<meta http-equiv=\"Expires\" content=\"0\" />\n<link href=\"../css/css.css\" rel=\"stylesheet\" type=\"text/css\">\n\n\nConsole output:\n\njava.lang.StackOverflowError\n	at java.text.DateFormat.format(DateFormat.java:275)\n	at java.text.Format.format(Format.java:140)\n	at java.text.MessageFormat.subformat(MessageFormat.java:1288)\n	at java.text.MessageFormat.format(MessageFormat.java:795)\n	at java.util.logging.SimpleFormatter.format(SimpleFormatter.java:50)\n	at java.util.logging.StreamHandler.publish(StreamHandler.java:179)\n	at java.util.logging.ConsoleHandler.publish(ConsoleHandler.java:88)\n	at java.util.logging.Logger.log(Logger.java:458)\n	at java.util.logging.Logger.doLog(Logger.java:480)\n	at java.util.logging.Logger.logp(Logger.java:680)\n	at org.apache.juli.logging.DirectJDKLog.log(DirectJDKLog.java:167)\n	at org.apache.juli.logging.DirectJDKLog.error(DirectJDKLog.java:135)\n	at org.apache.jasper.compiler.JspReader.pushFile(JspReader.java:606)\n	at org.apache.jasper.compiler.JspReader.<init>(JspReader.java:141)\n	at org.apache.jasper.compiler.JspReader.<init>(JspReader.java:119)\n	at org.apache.jasper.compiler.ParserController.determineSyntaxAndEncoding(ParserController.java:399)\n	at org.apache.jasper.compiler.ParserController.doParse(ParserController.java:207)\n	at org.apache.jasper.compiler.ParserController.parse(ParserController.java:137)\n	at org.apache.jasper.compiler.Parser.processIncludeDirective(Parser.java:339)\n	at org.apache.jasper.compiler.Parser.parseIncludeDirective(Parser.java:376)\n	at org.apache.jasper.compiler.Parser.parseDirective(Parser.java:484)\n	at org.apache.jasper.compiler.Parser.parseTagFileDirectives(Parser.java:1784)\n	at org.apache.jasper.compiler.Parser.parse(Parser.java:127)\n\n\nThis not exist in \"6.0.18\".','2009-10-17 07:18:47','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','deac657','Mark Emlyn David Thomas','2009-10-21 16:43:21','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=48019 Be more careful to skip over all of nodes we aren\'t interested it','java/org/apache/jasper/compiler/Parser.java'),(1679,40001,'Bug 40001 – HTML pages should not use GET to restart web-apps.','','2006-07-10 14:32:20','Michiel Meeuwissen','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Webapps:Manager','P2 enhancement','99f01fd','Mark Emlyn David Thomas','2009-10-10 17:54:54','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=40001 Use POST rather than GET for all operations that are not idempotent Partly based on a patch suggested by Daniel Naber Remove the \"Are you sure?\", partly due to lack of i18n support and since as (based on my recollection) as many people disliked the feature as liked it. Provides a (very) small measure of CSRF protection but lays the foundation for using a nonce with POST.','java/org/apache/catalina/manager/Constants.java\njava/org/apache/catalina/manager/HTMLManagerServlet.java\njava/org/apache/catalina/manager/LocalStrings.properties'),(1680,47324,'Bug 47324 – sessionsList.jsp uses absolute urls which doesn\'t work for Tomcat behind a reverse proxy','','2009-06-06 10:09:35','Maik Jablonski','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Manager application','P2 normal','6bac05d','Mark Emlyn David Thomas','2009-09-27 13:44:26','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47324 Fix submit IRL when behind a reverse proxy Patch by Maik Jablonski','webapps/manager/sessionsList.jsp'),(1681,47320,'Bug 47320 – Decoding jsessionid bug on z/os','If you receive a rewritten URL on z/os with uss (unix on a mainframe), Tomcat\ndoes not properly decode the jsessionid portion of the URL.\n\nThe problem is in org.apache.catalina.connector.CoyoteAdapter in the parseSessionId method.\n\nThe two instantiations of a String object do not specify the encdoding to use.\n\ne.g. String sid = new String(uriBC.getBuffer(), start + sessionIdStart,\n                            semicolon2 - sessionIdStart); \n\n...as well as the second String instantiation in this method.\n\nConsequently z/os uses its default encoding which (I think) is EBCDIC.\n\nIf I recompile with a hardcoded \"UTF-8\" for the encoding then the jsessionid decodes properly.  Not that I am suggesting this literally for the official fix.\n\ne.g. String sid = new String(uriBC.getBuffer(), start + sessionIdStart,\n                            semicolon2 - sessionIdStart, \"UTF-8\");','2009-06-05 08:37:24','David Mirly','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','0f99904','Mark Emlyn David Thomas','2009-09-27 12:48:23','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47320 Don\'t rely on the platform default encoding being suitable to parse the session ID','java/org/apache/catalina/connector/CoyoteAdapter.java\njava/org/apache/catalina/connector/LocalStrings.properties'),(1682,47499,'Bug 47499 – provide better insight on BindException: Cannot assign requested address','1) cite the address you attempt to listen (not just the port)\n2) proper exception chaining\n\nthe following info is currently lost: <<java.net.BindException: Cannot assign requested address\n	at java.net.PlainSocketImpl.socketBind(Native Method)\n	at java.net.PlainSocketImpl.bind(PlainSocketImpl.java:359)\n	at java.net.ServerSocket.bind(ServerSocket.java:319)\n	at java.net.ServerSocket.<init>(ServerSocket.java:185)\n	at javax.net.ssl.SSLServerSocket.<init>(SSLServerSocket.java:106)\n	at com.privasphere.net.ssl.SSLServerSocketImpl.<init>(SSLServerSocketImpl.java:106)\n	at com.privasphere.net.ssl.SSLServerSocketFactoryImpl.createServerSocket(SSLServerSocketFactoryImpl.java:71)\n	at org.apache.tomcat.util.net.jsse.JSSESocketFactory.createSocket(JSSESocketFactory.java:100)\n	at org.apache.tomcat.util.net.PoolTcpEndpoint.initEndpoint(PoolTcpEndpoint.java:295)\n	at org.apache.coyote.http11.Http11BaseProtocol.init(Http11BaseProtocol.java:139)\n	at org.apache.catalina.connector.Connector.initialize(Connector.java:1017)\n	at org.apache.catalina.core.StandardService.initialize(StandardService.java:578)>>','2009-07-08 22:05:03','Ralf Hauser','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 normal','73bb9e4','Mark Emlyn David Thomas','2009-09-22 17:16:54','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47499 Don\'t swallow BindException','java/org/apache/tomcat/util/net/JIoEndpoint.java'),(1683,47267,'Bug 47267 – Display of Release Notes in Windows installer is broken due to LF endings','The Windows installer has option\n[x] Show Readme\nthat is checked by default.\n\nIt results in file \n\"C:\\Program Files\\Apache Software Foundation\\Tomcat 6.0\\webapps\\ROOT\\RELEASE-NOTES.txt\"\nbeing opened in Notepad.\n\nIn TC 6.0.18 and in current RC for 6.0.20 that file has LF line ends. Notepad cannot properly display such files.','2009-05-26 07:38:52','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P2 normal','751a475','Mark Emlyn David Thomas','2009-09-22 16:26:23','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47267','dist.xml'),(1684,47866,'Bug 47866 – NullPointerException in embedded tomcat','It seems that the WebappClassLoader was stopped?\n\n{noformat}\nCaused by: java.lang.NullPointerException\n	at org.apache.catalina.loader.WebappClassLoader.findResources(WebappClassLoader.java:994)\n	at java.lang.ClassLoader.getResources(ClassLoader.java:1016)\n{noformat}\n\nAll I did was launch a server add a context and then ask it to load a resource from its classpath.  It\'s a bit more complicated than that, so I\'ll try and narrow it down if needed.','2009-09-18 00:23:03','Dave Syer','Tomcat Developers Mailing List','RESOLVED WONTFIX','Tomcat 7','Catalina','P3 normal','189181a','Mark Emlyn David Thomas','2009-09-21 06:54:36','Add a test case for https://issues.apache.org/bugzilla/show_bug.cgi?id=47866 Fix a couple of places where expected and actual were the wrong way around','test/org/apache/catalina/startup/TestTomcat.java'),(1685,47231,'Bug 47231 – http://tomcat.apache.org/tomcat-6.0-doc/ssl-howto.html improvements','','2009-05-21 03:58:55','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P2 normal','4b0129c','Mark Emlyn David Thomas','2009-09-20 19:10:15','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47231 Improve the SSL docs. Based on a patch by Sebb. Remove duplication of configuration parameters - it is better to reference the config docs to prevent the two lists of attributes getting out of sync.','webapps/docs/ssl-howto.xml'),(1686,47225,'Bug 47225 – Wrong argument in redirectPath.setChars in Mapper.internalMapWrapper()','','2009-05-19 21:52:39','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 minor','a31d52f','Mark Emlyn David Thomas','2009-09-16 17:17:11','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47225 Buffer length is end-offset','java/org/apache/tomcat/util/http/mapper/Mapper.java'),(1687,47161,'Bug 47161 – Manager ignores executors on status pages','When displaying the thread pools, the StatusManagerServlet ignores executors and uses the \'standard\' ThreadPool information for each connector. This causes incorrect information to be displayed when a connector is configured to use an executor.\n\nOn a related topic, it appears that the connector<->executor link is not exposed via JMX (which it will need to be to fix this).','2009-05-06 07:20:31','Mark Thomas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Manager application','P2 normal','aaf7b5d','Mark Emlyn David Thomas','2009-09-15 17:06:14','Fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=47161 Correctly report maxThreads Note 6.0.x will need a different fix as it still uses threadpools','java/org/apache/tomcat/util/net/AbstractEndpoint.java\njava/org/apache/tomcat/util/threads/ResizableExecutor.java'),(1688,46950,'Bug 46950 – SSL renegotiation does not occur when resource with CLIENT-CERT auth is requested','When a part of a webapp requires an SSL connection with a client certificate there should be an SSL renegotiation to request a client certificate from the browser.\n\nThis is the configuration I added to an webapp that already uses an SSL connector:\n\n<login-config id=\"LoginConfig_1\">\n                <auth-method>CLIENT-CERT</auth-method>\n                <realm-name>WPS</realm-name>\n</login-config>\n\n<security-constraint id=\"SecurityConstraint_1\">\n                <web-resource-collection id=\"WebResourceCollection_1\">\n                        <web-resource-name/>   \n                        <url-pattern>/LoginWithCert.do</url-pattern>\n                        <http-method>DELETE</http-method>\n                        <http-method>GET</http-method>\n                        <http-method>POST</http-method>\n                        <http-method>PUT</http-method>\n                        <http-method>HEAD</http-method>\n                </web-resource-collection>\n                <user-data-constraint id=\"UserDataConstraint_4\">\n                        <transport-guarantee>CONFIDENTIAL</transport-guarantee>\n                </user-data-constraint>\n</security-constraint>\n\nRequests to /LoginWithCert.do require an SSL connection, if there isn\'t one, but no client certificate is requested.','2009-04-01 06:33:02','Andre Cruz','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Native:Integration','P2 normal','e9248d7','Mark Emlyn David Thomas','2009-09-15 13:50:54','Fix Tomcat side of https://issues.apache.org/bugzilla/show_bug.cgi?id=46950 - adds new setVerify() method - uses it before renegotiation to change the cert verification level for the connection - increments minimum tc native version to 1.1.17 as it requires the new setVerify() method','java/org/apache/catalina/core/AprLifecycleListener.java\njava/org/apache/coyote/http11/Http11AprProcessor.java\njava/org/apache/tomcat/jni/SSLSocket.java'),(1689,47828,'Bug 47828 – Change Tomcat.setSilent() to setSilent(boolean)','Change Tomcat.setSilent() to setSilent(boolean).  It\'s nicer for clients to have a JavaBean type setter, and it doesn\'t seem to make sense that you can set something but not unset it.','2009-09-12 00:37:54','Dave Syer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P3 normal','59e88f1','Mark Emlyn David Thomas','2009-09-15 06:38:23','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47828 Change Tomcat.setSilent() to setSilent(boolean) so it can be turned on and off','java/org/apache/catalina/startup/Tomcat.java'),(1690,47827,'Bug 47827 – Tomcat API should not have methods that declare they throw Exception','Tomcat API should not have methods that declare they throw Exception.  Something more specific would be polite to users, since it must be known what actual checked exception types can be thrown.','2009-09-12 00:31:38','Dave Syer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P3 normal','d16b43d','Mark Emlyn David Thomas','2009-09-15 06:35:03','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47827 Be more specific about the exception that is thrown','java/org/apache/catalina/startup/Tomcat.java'),(1691,47827,'Bug 47827 – Tomcat API should not have methods that declare they throw Exception','Tomcat API should not have methods that declare they throw Exception.  Something more specific would be polite to users, since it must be known what actual checked exception types can be thrown.','2009-09-12 00:31:38','Dave Syer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P3 normal','78357bd','Mark Emlyn David Thomas','2009-09-15 06:34:05','Side-effect of fixing https://issues.apache.org/bugzilla/show_bug.cgi?id=47827 No need to declare throws Exception here','java/org/apache/catalina/connector/Connector.java'),(1692,47820,'Bug 47820 – Static utility methods in Tomcat should be instance methods','Why are the static addServlet() methods in Tomcat static?  I can see\nthey don\'t use any state from the instance, but isn\'t it cleaner to use\nan instance method, so that the API is uniform (everything I want to do\nto a tomcat instance goes through the instance)?  It would be more\nconsistent to follow the pattern of addServlet(String,String,String),\nand search for the context by name instead of requiring the instance to\nbe passed in to a static method.','2009-09-11 02:09:00','Dave Syer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Integration','P2 normal','6cce550','Mark Emlyn David Thomas','2009-09-15 06:26:32','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47820 Add non-static versions of static methods','java/org/apache/catalina/startup/Tomcat.java'),(1693,47819,'Bug 47819 – Add sources jars to embedded distribution','Add sources jars to embedded distribution.  They also should be uploaded to Maven Central, but I don\'t see any existing build targets for that, so I assume it\'s a separate manual process.  At least if the source jars were available in the build it would be easy to publish them.','2009-09-11 02:07:41','Dave Syer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Packaging','P2 normal','e856606','Mark Emlyn David Thomas','2009-09-15 05:53:41','Fixed https://issues.apache.org/bugzilla/show_bug.cgi?id=47819 Add source jar generation to embedded. Based on a patch by Dave Syer','build.xml'),(1694,47792,'Bug 47792 – Some int parameters are identified as longs in doc','','2009-09-06 19:06:53','Phil Steitz','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 minor','c0ed0d8','Mark Emlyn David Thomas','2009-09-15 05:21:15','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47792 Some parameters documented as longs, are actually ints Patch provided by Phil Steitz','modules/jdbc-pool/doc/jdbc-pool.xml'),(1695,47791,'Bug 47791 – Update h2database location','','2009-09-06 18:04:14','Phil Steitz','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 minor','0fa4c83','Mark Emlyn David Thomas','2009-09-15 05:19:27','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47791 Update h2 download location Patch provided by Phil Steitz','modules/jdbc-pool/build.properties.default'),(1696,47834,'Bug 47834 – TldConfig throws Exception when exploring unpacked jar','','2009-09-14 04:55:39','Guillaume Sauthier','Tomcat Developers Mailing List','NEW','Tomcat 6','Catalina','P2 enhancement','910a29a','Mark Emlyn David Thomas','2009-09-14 08:39:45','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47834 As well as the JAR as directory feature requested, this adds looking at all files to see if they are JARs rather than using the presence of a .jar extension. These features are optional for the Servlet spec but required for RFC66 in an OSGI environment. Both options are configurable with system properties and default to off.','java/org/apache/catalina/startup/LocalStrings.properties\njava/org/apache/catalina/startup/TldConfig.java\njava/org/apache/jasper/compiler/TagLibraryInfoImpl.java\njava/org/apache/jasper/compiler/TldLocationsCache.java\nwebapps/docs/config/systemprops.xml'),(1697,47425,'Bug 47425 – missing attribute in ssl configuration documentation','','2009-06-25 06:04:53','martin duerrenberger','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P2 normal','d484bb4','Mark Emlyn David Thomas','2009-09-12 12:43:45','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47425 Document the crlFile attribute','webapps/docs/config/http.xml\nwebapps/docs/ssl-howto.xml'),(1698,47826,'Bug 47826 – a logging statement error in org.apache.catalina.startup.Bootstrap.java','// Local repository\n            boolean replace = false;\n            String before = repository;\n            while ((i=repository.indexOf(CATALINA_HOME_TOKEN))>=0) {\n                replace=true;\n                if (i>0) {\n                repository = repository.substring(0,i) + getCatalinaHome() \n                    + repository.substring(i+CATALINA_HOME_TOKEN.length());\n                } else {\n                    repository = getCatalinaHome() \n                        + repository.substring(CATALINA_HOME_TOKEN.length());\n                }\n            }\n            while ((i=repository.indexOf(CATALINA_BASE_TOKEN))>=0) {\n                replace=true;\n                if (i>0) {\n                repository = repository.substring(0,i) + getCatalinaBase() \n                    + repository.substring(i+CATALINA_BASE_TOKEN.length());\n                } else {\n                    repository = getCatalinaBase() \n                        + repository.substring(CATALINA_BASE_TOKEN.length());\n                }\n            }\n            if (replace && log.isDebugEnabled())\n                log.debug(\"Expanded \" + before + \" to \" + replace);\n\nThe last line should be: \"log.debug(\"Expanded \" + before + \" to \" + repository);\"','2009-09-11 17:39:34','qingyang.xu','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 trivial','720de5e','Mark Emlyn David Thomas','2009-09-12 12:13:14','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47826 Broken debug message','java/org/apache/catalina/startup/Bootstrap.java'),(1699,47824,'Bug 47824 – Maven artifacts for extras: juli-adapters should not have dependency on servlet-api','Maven artifacts for extras: juli-adapters should not have dependency on servlet-api.  Or it should at least be optional.','2009-09-11 07:25:33','Dave Syer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P3 normal','e3408dd','Mark Emlyn David Thomas','2009-09-11 10:55:09','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47824','res/maven/juli-adapters.pom'),(1700,45785,'Bug 45785 – ClassCastException if directory ending with .jar exists in WEB-INF/lib','Exception occurs if there is a directory in WEB-INF/lib having a .jar ending (e.g. foo.jar). Don\'t know if it makes sense to create such a dir in WEB-INF/lib, in my case a bug in another tool created such a dir. \n\nBut in any case: Tomcat should not crash because of such a directory, IMHO.\n\njava.lang.ClassCastException: org.apache.naming.resources.FileDirContext cannot be cast to org.apache.naming.resources.Resource\n	at org.apache.catalina.util.ExtensionValidator.validateApplication(ExtensionValidator.java:182)\n	at org.apache.catalina.core.StandardContext.start(StandardContext.java:4167)\n	at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:791)\n	at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:771)\n	at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:525)\n	at org.apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.java:627)\n	at org.apache.catalina.startup.HostConfig.deployDescriptors(HostConfig.java:553)\n	at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:488)\n	at org.apache.catalina.startup.HostConfig.start(HostConfig.java:1149)\n	at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:311)\n	at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:117)\n	at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1053)\n	at org.apache.catalina.core.StandardHost.start(StandardHost.java:719)\n	at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1045)\n	at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:443)\n	at org.apache.catalina.core.StandardService.start(StandardService.java:516)\n	at org.apache.catalina.core.StandardServer.start(StandardServer.java:710)\n	at org.apache.catalina.startup.Catalina.start(Catalina.java:578)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n	at java.lang.reflect.Method.invoke(Method.java:597)\n	at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:288)\n	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:413)','2008-09-11 12:22:35','Andreas Sahlbach','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','6df5862','Mark Emlyn David Thomas','2009-09-09 12:01:21','Fix additional issue related to https://issues.apache.org/bugzilla/show_bug.cgi?id=45785 Exclude directories named *.jar for the extension validator Also simplify isDirectory() check as that includes exists() Based on a patch by Rolf Wojtech','java/org/apache/catalina/util/ExtensionValidator.java'),(1701,47705,'Bug 47705 – ArithmeticException: / by zero when expiring sessions via manager','Received ArithmeticException: / by zero when expiring sessions via Tomcat manager webapp.\n\nThis exception was thrown only if session-timeout is set as -1 on webapp web.xml. Moreover, the exception was also thrown regardless of the idle parameter value (/expire?path=/xxx&idle=mm) as long as session-timeout = -1.\n\nResult:\nException stacktrace:\nERROR: 19/08/2009 00:18:22 [http-80-exec-33] (org.apache.catalina.core.ApplicationContext:669) HTMLManager: ManagerServlet.sessions[/contextpath]\njava.lang.ArithmeticException: / by zero\n        at org.apache.catalina.manager.ManagerServlet.sessions(ManagerServlet.java:1133)\n        at org.apache.catalina.manager.HTMLManagerServlet.sessions(HTMLManagerServlet.java:573)\n        at org.apache.catalina.manager.HTMLManagerServlet.expireSessions(HTMLManagerServlet.java:660)\n        at org.apache.catalina.manager.HTMLManagerServlet.doGet(HTMLManagerServlet.java:118)\n        at org.apache.catalina.manager.HTMLManagerServlet.doPost(HTMLManagerServlet.java:157)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)\n        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)\n        at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:525)\n        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:128)\n        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)\n        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:286)\n        at org.apache.coyote.http11.Http11NioProcessor.process(Http11NioProcessor.java:880)\n        at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:719)\n        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:2081)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n        at java.lang.Thread.run(Thread.java:619)','2009-08-19 00:12:52','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Manager application','P2 normal','6ab874a','Timothy A. Funk','2009-08-31 10:17:37','https://issues.apache.org/bugzilla/show_bug.cgi?id=47705','java/org/apache/catalina/manager/ManagerServlet.java'),(1702,47378,'Bug 47378 – welcome-file ignores servlet mapping','Web applications that use a servlet mapping for their welcome-file are ignored\nand the server returns either a directory listing or a 404 if the listing is\ndisabled.\nI have JSF servlet defined and a servlet-mapping for *.jsf to go to the\nFacesServlet.\nI have \"index.jsf\" listed as by welcome-file and I get a 404 with directory\nlisting disabled.\nI also have a custom servlet defined with its mapping and set the welcome-file\nto its mapping and get a 404 as well.','2009-06-16 12:52:31','Bobby Lawrence','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Servlet & JSP API','P2 enhancement','fe53ca9','Timothy A. Funk','2009-08-31 09:59:00','Allow welcome files without a physical backing. Inspired by this bug https://issues.apache.org/bugzilla/show_bug.cgi?id=47378','java/org/apache/tomcat/util/http/mapper/Mapper.java'),(1703,38797,'Bug 38797 – 5.5.12 and 5.5.15 emit different code on <jsp:getProperty>','Compiling this code:\n\n<jsp:getProperty name=\"person\" property=\"name\"/>\n\nresults in this with the Jasper of Tomcat 5.5.15:\n\nout.write(org.apache.jasper.runtime.JspRuntimeLibrary.toString(org.apache.jasper.runtime.JspRuntimeLibrary.handleGetProperty(_jspx_page_context.getAttribute(\"person\",\nPageContext.PAGE_SCOPE), \"name\")));\n\nAnd this with the Jasper of Tomcat 5.5.12 and before (checked 5.5.12, 5.0.28 and\nsome versions in between):\n\nout.write(org.apache.jasper.runtime.JspRuntimeLibrary.toString(org.apache.jasper.runtime.JspRuntimeLibrary.handleGetProperty(_jspx_page_context.findAttribute(\"person\"),\n\"name\")));\n\nMy property is in the session\'s scope, so the property is not found and an\nexception is thrown:\n\nSCHWERWIEGEND: Servlet.service() for servlet jsp threw exception\norg.apache.jasper.JasperException: Attempted a bean operation on a null object.\n	at\norg.apache.jasper.runtime.JspRuntimeLibrary.handleGetProperty(JspRuntimeLibrary.java:601)\n	at\norg.apache.jsp.title_jsp._jspx_meth_iku_restricted_0(org.apache.jsp.title_jsp:146)\n	at org.apache.jsp.title_jsp._jspService(org.apache.jsp.title_jsp:104)\n	at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:97)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:802)\n	at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:332)\n	at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:314)\n	at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:264)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:802)\n	at\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:252)\n	at\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)\n	at\norg.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:672)\n	at\norg.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:574)\n	at\norg.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:499)\n\nBTW: version 5.5.15 is missing in the bugzilla, so I selected 5.5.14','2006-02-27 18:40:15','Kurt Huwig','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 normal','5b3a3a6','Mark Emlyn David Thomas','2009-08-29 09:24:18','Fix regression in previous fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=38797 Update list of introduced variables before the tag body is processed in case they are used in the tag body.','java/org/apache/jasper/compiler/Generator.java'),(1704,46243,'Bug 46243 – Filter init() fails, still put into service','Using securityfilter, I misconfigured the filter to use a non-existent class for my Realm. This causes a ClassNotFoundException in securityfilter\'s init() method.\n\nWhen attempting to authenticate, I get this error:\n\n2008-11-19 10:26:26,111 [TP-Processor8] ERROR org.apache.catalina.core.ContainerBase.[Catalina].[localhost].[/diagnosis].[default]- Servlet.service() for servlet default threw exception\njava.lang.NullPointerException\n        at org.securityfilter.filter.SecurityFilter.doFilter(SecurityFilter.java:125)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:215)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:188)\n        at org.securityfilter.filter.CheckIPAddressFilter.doFilter(CheckIPAddressFilter.java:130)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:215)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:188)\n        at org.childhealthcare.diagnosis.servlet.BrokenLocaleFilter.doFilter(BrokenLocaleFilter.java:115)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:215)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:188)\n        at org.childhealthcare.diagnosis.servlet.EncodingFilter.doFilter(EncodingFilter.java:64)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:215)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:188)\n        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:213)\n        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:174)\n        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)\n        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:117)\n        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:108)\n        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:174)\n        at org.apache.jk.server.JkCoyoteHandler.invoke(JkCoyoteHandler.java:200)\n        at org.apache.jk.common.HandlerRequest.invoke(HandlerRequest.java:283)\n        at org.apache.jk.common.ChannelSocket.invoke(ChannelSocket.java:773)\n        at org.apache.jk.common.ChannelSocket.processConnection(ChannelSocket.java:703)\n        at org.apache.jk.common.ChannelSocket$SocketConnection.runIt(ChannelSocket.java:895)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:689)\n        at java.lang.Thread.run(Thread.java:595)\n\nNow, the exception itself is legitimate: there\'s an uninitialized object in the filter that\'s being dereferenced, and an NPE is thrown.\n\nThe problem is that Tomcat should be successfully initializing the filter /before/ the doFilter method is ever called. Since init() will always fail given my configuration, the filter should never come into service, and the NPE should not be observed.\n\nSection 6.2.1 of the 2.4 servlet spec states:\n\n\"\nThe container must ensure that it has instantiated a filter of the appropriate class for each filter in the list, and called its init(FilterConfig config) method. The filter may throw an exception to indicate that it cannot function properly. If the exception is of type UnavailableException, the container may examine the isPermanent attribute of the exception and may choose to retry the filter at some later time.\n\"\n\nWhile not explicitly stated here, it seems that the call to init() should be successful (i.e. no exceptions are thrown) before the filter is put into service -- similar to the way a servlet is handled. Filters should be able to rely on objects being properly initialized in init().','2008-11-19 09:20:32','Christopher Schultz','Tomcat Developers Mailing List','CLOSED INVALID','Tomcat 5','Catalina','P2 normal','5e72e59','Mark Emlyn David Thomas','2009-08-24 04:22:21','Extract the SimpleHttpClient in to a separate class and move it to a more logical package since it will be reused. Don\'t override method unnecessarily. Add test case for bug 46243','test/org/apache/catalina/connector/TestRequest.java\ntest/org/apache/catalina/core/TestStandardContext.java\ntest/org/apache/catalina/startup/SimpleHttpClient.java'),(1705,44041,'Bug 44041 – WebappClassLoader duplicate class definition under high Load if hasExternalRepositories is true','','2007-12-07 13:55:58','Philippe Mouawad','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 critical','6534cf3','Mark Emlyn David Thomas','2009-08-17 18:20:29','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=44041 Remove previous sync that didn\'t fix the issue Make loadClass synchronized like java.lang.ClassLoader I was concerned about possible performance implications but I saw no detectable change in start-up time with this change.','java/org/apache/catalina/loader/WebappClassLoader.java'),(1706,47699,'Bug 47699 – CATALINA_PID can be over-written by failed start','If CATALINA_PID is defined and start is called twice in succession CATALINA_PID will be over-written by second start (that will fail as the ports are in use). This will leave the PID file referencing the wrong PID.\n\nThis could be fixed be preventing a start if the PID file already exists. This requires adding code to remove the PID file on successful stop. Since the stop command returns before the process exits, some form of timeout is necessary.\n\nPatch to follow shortly.','2009-08-17 05:59:59','Mark Thomas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Native:Integration','P2 normal','8f246ce','Mark Emlyn David Thomas','2009-08-17 09:01:31','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47699 Better handling of PID files','bin/catalina.sh'),(1707,42390,'Bug 42390 – JSP compilation error with nested tagfile tags with variables with \"AT_BEGIN\" scope','Given a tagfile \"test.tag\" in /WEB-INF/tags/t:\n---- begin test.tag ----\n<%@ variable name-given=\"X\" scope=\"AT_BEGIN\" %>\n<jsp:doBody/>\n---- end test.tag ----\nthe following JSP \"testTest.jsp\":\n---- begin testTest.jsp ----\n<t:test><t:test/></t:test>\n---- end testTest.jsp ----\ngives a JSP compilation error:\norg.apache.jasper.JasperException: Unable to compile class for JSP: \nStacktrace:\n        at\norg.apache.jasper.compiler.DefaultErrorHandler.javacError(DefaultErrorHandler.java:85)\n        at\norg.apache.jasper.compiler.ErrorDispatcher.javacError(ErrorDispatcher.java:330)\n        at\norg.apache.jasper.compiler.JDTCompiler.generateClass(JDTCompiler.java:435)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:298)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:277)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:265)\n        at\norg.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:564)\n        at\norg.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:299)\n        at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:315)\n        at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:265)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:803)\n        at\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:269)\n        at\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:188)\n        at\norg.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:210)\n        at\norg.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:174)\n        at\norg.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)\n        at\norg.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:117)\n        at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:542)\n        at\norg.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:108)\n        at\norg.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:151)\n        at\norg.apache.coyote.http11.Http11Processor.process(Http11Processor.java:870)\n        at\norg.apache.coyote.http11.Http11BaseProtocol$Http11ConnectionHandler.processConnection(Http11BaseProtocol.java:665)\n        at\norg.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:528)\n        at\norg.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:81)\n        at\norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:685)\n        at java.lang.Thread.run(Thread.java:613)','2007-05-11 00:59:37','MicroNova YUZU Team','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P1 major','45c64b6','Mark Emlyn David Thomas','2009-08-16 14:05:41','Restore fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=42390 I have done some more testing with tag files, simple tags and tags and can\'t find any regressions. The TCK also passes.','java/org/apache/jasper/compiler/ScriptingVariabler.java'),(1708,45403,'Bug 45403 – Tomcat does not reload application','Tomcat does not reload application if\n 1)a file in WEB-INF/lib is a symbolic link file, and\n 2)the actual file of the symbolic link file changed, and\n 3)allowLinking attribute is false\n\nIn case of the above, Tomcat throws a NamingException.\nApplication reloading works well if allowLinking attribute is set to true.\nThe reason of the above would be as allows.\n\n--------------------\nWebappClassLoader:addJar\n\n  long lastModified =\n      ((ResourceAttributes) resources.getAttributes(jar))\n       .getLastModified();\n--------------------\n\n\nI was wondering if application reloading should work when allowLinking attribute\nis false.\nOr should Tomcat disregard the Jar (doesn\'t load it)\nwhen \"allowLinking=false\"?','2008-07-15 18:39:38','kawasima','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','6eaf2fe','Konstantin Kolinko','2009-08-15 21:55:25','Return \'false\' if nested copyDir call failed. It is part of the patch for issue 45403 that was applied in rev.804462','java/org/apache/catalina/loader/WebappLoader.java'),(1709,45403,'Bug 45403 – Tomcat does not reload application','Tomcat does not reload application if\n 1)a file in WEB-INF/lib is a symbolic link file, and\n 2)the actual file of the symbolic link file changed, and\n 3)allowLinking attribute is false\n\nIn case of the above, Tomcat throws a NamingException.\nApplication reloading works well if allowLinking attribute is set to true.\nThe reason of the above would be as allows.\n\n--------------------\nWebappClassLoader:addJar\n\n  long lastModified =\n      ((ResourceAttributes) resources.getAttributes(jar))\n       .getLastModified();\n--------------------\n\n\nI was wondering if application reloading should work when allowLinking attribute\nis false.\nOr should Tomcat disregard the Jar (doesn\'t load it)\nwhen \"allowLinking=false\"?','2008-07-15 18:39:38','kawasima','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','a1711fa','Mark Emlyn David Thomas','2009-08-15 08:07:42','Apply Konstantin\'s new patch for https://issues.apache.org/bugzilla/show_bug.cgi?id=45403','java/org/apache/catalina/loader/LocalStrings.properties\njava/org/apache/catalina/loader/WebappLoader.java'),(1710,45403,'Bug 45403 – Tomcat does not reload application','Tomcat does not reload application if\n 1)a file in WEB-INF/lib is a symbolic link file, and\n 2)the actual file of the symbolic link file changed, and\n 3)allowLinking attribute is false\n\nIn case of the above, Tomcat throws a NamingException.\nApplication reloading works well if allowLinking attribute is set to true.\nThe reason of the above would be as allows.\n\n--------------------\nWebappClassLoader:addJar\n\n  long lastModified =\n      ((ResourceAttributes) resources.getAttributes(jar))\n       .getLastModified();\n--------------------\n\n\nI was wondering if application reloading should work when allowLinking attribute\nis false.\nOr should Tomcat disregard the Jar (doesn\'t load it)\nwhen \"allowLinking=false\"?','2008-07-15 18:39:38','kawasima','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','5c512f9','Mark Emlyn David Thomas','2009-08-15 08:06:24','Revert r701358 for https://issues.apache.org/bugzilla/show_bug.cgi?id=45403','java/org/apache/naming/resources/FileDirContext.java'),(1711,47612,'Bug 47612 – [PATCH] fix unsafe public string array in AbstractCreateStatementInterceptor','','2009-07-30 18:21:37','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P5 enhancement','4f5a5e4','Filip Hanik','2009-08-05 12:19:34','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47612 patch provided by sebb Abstract classes, private-> protected for subclass access','modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/interceptor/AbstractCreateStatementInterceptor.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/interceptor/AbstractQueryReport.java'),(1712,47577,'Bug 47577 – Unused imports and other compilation warnings','','2009-07-24 17:38:41','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 minor','f9caf3a','Filip Hanik','2009-08-05 12:10:05','patch by sebb for https://issues.apache.org/bugzilla/show_bug.cgi?id=47577','modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/DataSourceProxy.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/FairBlockingQueue.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/MultiLockFairBlockingQueue.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/PoolProperties.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/PooledConnection.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/ProxyConnection.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/interceptor/ConnectionState.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/interceptor/SlowQueryReport.java'),(1713,47452,'Bug 47452 – Patch for build.xml - javadoc classpath and junit formatter','','2009-06-29 18:16:05','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','62ef2cf','Filip Hanik','2009-08-05 12:05:39','apply patch from sebb for https://issues.apache.org/bugzilla/show_bug.cgi?id=47452','modules/jdbc-pool/build.xml'),(1714,47583,'Bug 47583 – Fix occasional test failure in TestConcurrency','','2009-07-26 06:43:28','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','278dedc','Mark Emlyn David Thomas','2009-07-30 15:40:54','Fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=47583 Fix timing related failures. Patch suggested by sebb','modules/jdbc-pool/test/org/apache/tomcat/jdbc/test/TestConcurrency.java'),(1715,47577,'Bug 47577 – Unused imports and other compilation warnings','','2009-07-24 17:38:41','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 minor','5259331','Mark Emlyn David Thomas','2009-07-30 15:21:04','Partial fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=47577 A handful of generics fixes.','modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/DataSourceFactory.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/PoolProperties.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/interceptor/SlowQueryReportJmx.java'),(1716,47577,'Bug 47577 – Unused imports and other compilation warnings','','2009-07-24 17:38:41','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 minor','6ebdf18','Mark Emlyn David Thomas','2009-07-30 15:10:02','Partial fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=47577 Cosmetic fixes. Main benefit is noise reduction in Eclipse error list','modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/DataSource.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/DataSourceProxy.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/FairBlockingQueue.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/JdbcInterceptor.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/PoolProperties.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/PooledConnection.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/ProxyConnection.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/interceptor/AbstractCreateStatementInterceptor.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/interceptor/AbstractQueryReport.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/interceptor/ConnectionState.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/interceptor/SlowQueryReport.java'),(1717,47577,'Bug 47577 – Unused imports and other compilation warnings','','2009-07-24 17:38:41','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 minor','73caafb','Mark Emlyn David Thomas','2009-07-30 14:29:30','Partial fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=47577 Imports / casts','modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/jmx/ConnectionPoolMBean.java'),(1718,47577,'Bug 47577 – Unused imports and other compilation warnings','','2009-07-24 17:38:41','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 minor','3dcc091','Mark Emlyn David Thomas','2009-07-30 14:25:37','Partial fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=47577 Remove unused imports.','modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/ConnectionPool.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/DataSource.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/DataSourceFactory.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/DataSourceProxy.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/PooledConnection.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/jmx/ConnectionPool.java'),(1719,47576,'Bug 47576 – Javadoc errors - Exception name misspelt','The files\n\nFairBlockingQueue.java\nMultiLockFairBlockingQueue.java\n\nuse\n \n* @throws UnsupportedOperation\n\nThis should be\n\n* @throws UnsupportedOperationException','2009-07-24 17:27:54','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','abbb922','Mark Emlyn David Thomas','2009-07-30 14:13:36','https://issues.apache.org/bugzilla/show_bug.cgi?id=47576 Fix exception name in Javadoc Patch provided by sebb','modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/FairBlockingQueue.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/MultiLockFairBlockingQueue.java'),(1720,47569,'Bug 47569 – Test cases do not clear up afterwards','Some of the test cases (e.g. TestTomcat) start a Tomcat server,\n\nThis creates the directory tree\n\ntomcat.8080/work...\n\nwhich is not deleted when the test finishes.','2009-07-23 13:08:38','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 minor','a9e00d5','Mark Emlyn David Thomas','2009-07-30 14:10:35','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47569 Use the new base class so tests clean up after themselves','test/org/apache/catalina/connector/TestRequest.java\ntest/org/apache/catalina/startup/TestTomcat.java'),(1721,47568,'Bug 47568 – TestTomcat fails to delete work directory','TestTomcat.setUp() creates a work directory, but does not delete it in tearDown()','2009-07-23 12:56:58','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Catalina','P2 trivial','cfb18a0','Mark Emlyn David Thomas','2009-07-30 03:01:13','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47568 Create the tmp dir where intended Remove it when we are done','test/org/apache/catalina/startup/TestTomcat.java'),(1722,47567,'Bug 47567 – Add description for default build target','There\'s no description for the default build target - deploy - so it does not show up when using \"ant -p\".','2009-07-23 12:33:06','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Integration','P2 enhancement','97c969b','Mark Emlyn David Thomas','2009-07-30 02:35:54','Follow up to https://issues.apache.org/bugzilla/show_bug.cgi?id=47567 Add descriptions to the extras build script','extras.xml'),(1723,47567,'Bug 47567 – Add description for default build target','There\'s no description for the default build target - deploy - so it does not show up when using \"ant -p\".','2009-07-23 12:33:06','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Integration','P2 enhancement','2a483df','Mark Emlyn David Thomas','2009-07-30 02:29:50','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47567 Add some descriptions to the build file.','build.xml'),(1724,41824,'Bug 41824 – Unable to use nested type in TLD','','2007-03-12 10:40:25','Renaud Waldura','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 normal','768af9f','Mark Emlyn David Thomas','2009-07-24 15:06:54','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=41824 Need to use canonical rather than binary form when writing code','java/org/apache/jasper/compiler/JspUtil.java'),(1725,47566,'Bug 47566 – Update to NSIS 2.45','NSIS have released version 2.45, which has some fixes for Windows 7','2009-07-23 12:30:19','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Integration','P2 enhancement','e104752','Konstantin Kolinko','2009-07-24 14:31:58','Update to NSIS 2.45 https://issues.apache.org/bugzilla/show_bug.cgi?id=47566','build.properties.default'),(1726,46907,'Bug 46907 – Jasper with log4j in web-app classpath and debug level enabled prevents reading HTTP POST stream from JSP','This is on Tomcat 5.5.x (don\'t remember the last rev. number, not my current machine).\n\nWhen log4j is in the classpath of the web-app and is configured to log at debug level, Jasper dumps the whole HTTP POST request body as debug traces. This consumes the HttpServletRequest input stream which then arrives unusable for the user at the beginning of the JSP code (using  HttpServletRequest.getInputStream(), the stream is already at its end).\nA workaround is to disable debug traces for Japser class in log4j.properties, but Jasper should not consume the HttpServletRequest input stream whatever mode it runs into.','2009-03-24 15:20:17','Olivier Lau','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 major','50d0e6e','Mark Emlyn David Thomas','2009-07-23 13:48:56','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46907 Debug logging should not cause the input stream to be swallowed There are better, less intrusive ways to read request bodies','java/org/apache/jasper/servlet/JspServlet.java'),(1727,40881,'Bug 40881 – Unable to receive message through  TCP channel -> Nullpointer','- Message replication failes on the replciated node on creation of\n  a new session (login via form authentication).\n\n-  async cluster configruation is active\n\n- 2 cluster nodes\n\n- statup executed one by one, the second node was added after the first was up fully\n\n- is fully reproducable\n\nError LOG:\n----------------------------------------------------\n\nUnable to receive message through  TCP channel\n java.lang.NullPointerException\n        at\norg.apache.catalina.cluster.session.DeltaRequest.execute(DeltaRequest.java:176)\n        at\norg.apache.catalina.cluster.session.DeltaManager.handleSESSION_DELTA(DeltaManager.java:1573)\n        at\norg.apache.catalina.cluster.session.DeltaManager.messageReceived(DeltaManager.java:1522)\n        at\norg.apache.catalina.cluster.session.DeltaManager.messageDataReceived(DeltaManager.java:1271)\n        at\norg.apache.catalina.cluster.session.ClusterSessionListener.messageReceived(ClusterSessionListener.java\n:85)\n        at\norg.apache.catalina.cluster.tcp.SimpleTcpCluster.receive(SimpleTcpCluster.java:1167)\n        at\norg.apache.catalina.cluster.tcp.ClusterReceiverBase.messageDataReceived(ClusterReceiverBase.java:426)\n        at\norg.apache.catalina.cluster.io.ObjectReader.execute(ObjectReader.java:107)\n        at\norg.apache.catalina.cluster.tcp.TcpReplicationThread.drainChannel(TcpReplicationThread.java:138)\n        at\norg.apache.catalina.cluster.tcp.TcpReplicationThread.run(TcpReplicationThread.java:69)\n\n\n\ncluster confirguation:\n----------------------------------------------------\n   <Cluster  className=\"org.apache.catalina.cluster.tcp.SimpleTcpCluster\"\n                                         doClusterLog=\"true\"\n                                         clusterLogName=\"clusterlog\"\n                                         useDirtyFlag=\"true\"\n                                         expireSessionsOnShutdown=\"false\"\n                                         notifyListenersOnReplication=\"true\"\n                                        \nmanagerClassName=\"org.apache.catalina.cluster.session.DeltaManager\"\n                                        >\n               <Membership \nclassName=\"org.apache.catalina.cluster.mcast.McastService\"\n                                                          mcastAddr=\"228.0.0.4\"\n                                                          mcastPort=\"45552\"\n                                                          mcastFrequency=\"500\"\n                                                          mcastDropTime=\"3000\"/>\n               <Receiver\nclassName=\"org.apache.catalina.cluster.tcp.ReplicationListener\"\n                              tcpListenAddress=\"auto\"\n                              tcpListenPort=\"4001\"\n                              tcpSelectorTimeout=\"100\"\n                              tcpThreadCount=\"6\" />\n\n<!--\n               <Sender\nclassName=\"org.apache.catalina.cluster.tcp.ReplicationTransmitter\"\n                             replicationMode=\"pooled\"\n                             ackTimeout=\"15000\"\n                             waitForAck=\"false\" />\n-->\n        <Sender\n                       \nclassName=\"org.apache.catalina.cluster.tcp.ReplicationTransmitter\"\n                        replicationMode=\"asynchronous\"\n                        doProcessingStats=\"true\"\n                        doWaitAckStats=\"true\"\n                        waitForAck=\"true\"\n                        ackTimeout=\"30000\"\n                        resend=\"true\"\n                        keepAliveTimeout=\"320000\"\n                        keepAliveMaxRequestCount=\"-1\" />\n\n               <Valve className=\"org.apache.catalina.cluster.tcp.ReplicationValve\"\n                             \nfilter=\".*\\.gif;.*\\.js;.*\\.css;.*\\.png;.*\\.jpeg;.*\\.jpg;.*\\.htm;.*\\.html;.*\\.txt;\"\n                              primaryIndicator=\"true\" />\n\n         <!--\n                  <Deployer               \nclassName=\"org.apache.catalina.cluster.deploy.FarmWarDeployer\"\n                                            tempDir=\"${catalina.base}/war-temp\"\n                                          deployDir=\"${catalina.base}/war-deploy/\"\n                                           watchDir=\"${catalina.base}/war-listen/\"\n                                       watchEnabled=\"true\"/>\n          -->\n      </Cluster>','2006-11-02 13:37:08','paul hettl','Tomcat Developers Mailing List','REOPENED','Tomcat 7','Cluster','P2 enhancement','f3d3920','Mark Emlyn David Thomas','2009-07-23 13:39:51','Preparatory work for https://issues.apache.org/bugzilla/show_bug.cgi?id=40881 As proposed on the dev list, remove the Realm from GenericPrincipal','java/org/apache/catalina/ha/session/DeltaRequest.java\njava/org/apache/catalina/ha/session/DeltaSession.java\njava/org/apache/catalina/ha/session/SerializablePrincipal.java\njava/org/apache/catalina/ha/session/SimpleTcpReplicationManager.java\njava/org/apache/catalina/realm/DataSourceRealm.java\njava/org/apache/catalina/realm/GenericPrincipal.java\njava/org/apache/catalina/realm/JAASRealm.java\njava/org/apache/catalina/realm/JDBCRealm.java\njava/org/apache/catalina/realm/JNDIRealm.java\njava/org/apache/catalina/realm/MemoryRealm.java\njava/org/apache/catalina/realm/RealmBase.java\njava/org/apache/catalina/realm/UserDatabaseRealm.java\njava/org/apache/catalina/startup/Tomcat.java\ntest/org/apache/catalina/ha/session/TestSerializablePrincipal.java'),(1728,47518,'Bug 47518 – Valve Interface Javadocs for invoke method references non-existent method','It appears that the Valve interface javadoc hasn\'t been updated since around TC 5.5. Here is a snip of what it currently available from TC\'s website (6.0.20 I would guess):\n\n\"\n# If the corresponding Response was not generated (and control was not returned, call the next Valve in the pipeline (if there is one) by executing context.invokeNext().\n\n.\n.\n.\n\n# Modify the HTTP headers included with the Response after the invokeNext() method has returned.\n# Perform any actions on the output stream associated with the specified Response after the invokeNext() method has returned.\n\"\n\nThe invokeNext method has not existed in the Valve interface in many versions. I believe the replacement is:\n\nthis.getNext().invoke(request, response)\n\nI\'m happy to provide a doc patch if getNext().invoke(request, response) is the expected replacement for invokeNext(request, response).\n\nNote that the docs for 5.5 also have the same problem. Please let me know if I should log that separately.','2009-07-13 06:40:01','Christopher Schultz','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P2 normal','9dc93f5','Mark Emlyn David Thomas','2009-07-21 02:24:58','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47518 Fix reference to old method in Valve Javadoc Patch by Christopher Schultz','java/org/apache/catalina/Valve.java'),(1729,47413,'Bug 47413 – There is difference in composite ${a}${b} EL expressions between 6.0.18 and 6.0.20','In Tomcat 6.0.18, <c:out> tag that has undefined reference in its value  (like the following snippet) outputs empty string(\"\"), but in Tomcat 6.0.20 outputs null. This is a critical bug.. Please fix it ASAP.\n\n===\n<c:out value=\"${foo.undefined.bar}\" />\n===','2009-06-24 01:45:05','masatonagai','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Servlet & JSP API','P2 critical','b7853df','Konstantin Kolinko','2009-07-18 22:52:32','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47413 First part of a composite expression \"${a}${b}\" was not coerced to String','java/org/apache/jasper/compiler/Generator.java'),(1730,41564,'Bug 41564 – service.bat does not install tomcat as a service properly on Windows Vista','','2007-02-07 19:07:26','Andreas Knecht','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Native:Packaging','P3 major','f92252e','Mark Emlyn David Thomas','2009-07-18 07:53:41','Fixed https://issues.apache.org/bugzilla/show_bug.cgi?id=41564 Updated Tomcat6 to Tomcat 7 I couldn\'t see anything obviously obsolete so I removed the warning.','webapps/docs/windows-service-howto.xml'),(1731,41661,'Bug 41661 – JspConfig.init() is not synchronized','The \'JspConfig.init()\' method can be called simultaneously from multiple threads\nat the same time, but it is not synchronized, so the initialization code in the\nbody can be executed simultaneously by multiple threads. This can lead to a\n\'jsp-property-group\' configuration being added twice to the \'jspProperties\'\nvector. The symptom we noticed was that on some runs, the contents of the\n\'include-prelude\' and \'include-coda\' elements would be included twice in all\ncompiled jsp files.\n\nThis bug is hard to reproduce because it requires a run where the first thing\nthat happens is that multiple jsp files are requested simultaneously. However,\nafter adding a field containing a synchronization object and synchronizing on it\nacross the \n\nif (!initialized) {\n...\n}\n\nblock, we haven\'t seen the problem reoccur.','2007-02-20 13:40:39','Doug Hauge','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 normal','4425c62','Mark Emlyn David Thomas','2009-07-17 16:12:49','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=41661 Thread safety issue with JspConfig.init(). There is one JspConfig object per context and as per 41661, issues have been seen with this on real systems.','java/org/apache/jasper/compiler/JspConfig.java'),(1732,41661,'Bug 41661 – JspConfig.init() is not synchronized','The \'JspConfig.init()\' method can be called simultaneously from multiple threads\nat the same time, but it is not synchronized, so the initialization code in the\nbody can be executed simultaneously by multiple threads. This can lead to a\n\'jsp-property-group\' configuration being added twice to the \'jspProperties\'\nvector. The symptom we noticed was that on some runs, the contents of the\n\'include-prelude\' and \'include-coda\' elements would be included twice in all\ncompiled jsp files.\n\nThis bug is hard to reproduce because it requires a run where the first thing\nthat happens is that multiple jsp files are requested simultaneously. However,\nafter adding a field containing a synchronization object and synchronizing on it\nacross the \n\nif (!initialized) {\n...\n}\n\nblock, we haven\'t seen the problem reoccur.','2007-02-20 13:40:39','Doug Hauge','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 normal','4425c62','Mark Emlyn David Thomas','2009-07-17 16:12:49','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=41661 Thread safety issue with JspConfig.init(). There is one JspConfig object per context and as per 41661, issues have been seen with this on real systems.','java/org/apache/jasper/compiler/JspConfig.java'),(1733,41059,'Bug 41059 – WebAppClassLoader clearReferences code break running threads','When the WebAppClassLoader stops it manually sets all static and final \nvariables to null in the clearReferences method.  This results in NPEs for any \nthread that was not stopped and not expecting its final or static variables to \nbe null.  This is particularly a problem with hot deploys since the unload \nfails and terminating the deploy.','2006-11-28 11:53:02','James Birmingham','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P3 major','a9f0239','Mark Emlyn David Thomas','2009-07-17 13:19:59','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=41059 Reduce one possible source of errors if using ENABLE_CLEAR_REFERENCES=true Patch by Curt Arnold','java/org/apache/catalina/loader/WebappClassLoader.java'),(1734,40551,'Bug 40551 – Sticky sessions using PersistentManager enter indeterminate state on node failover','If a cluster of nodes is being load balanced with sticky sessions, and a\nparticular node becomes unavailable, any sessions bound to that node must be\nredistributed.  Particularly in the case of mod_jk these sessions will not be\nbound to whichever node the failover occurred on because the jessionid will\nstill contain the JVM route of the original failed node, thus placing the\nsession in an indeterminate state and losing sticky properties.\n\nI am attaching a patch that will trigger a session to rebind itself to a new\nnode if the jvmroutes don\'t match and replace the jessionid in the browser\'s cookie.','2006-09-20 01:33:41','Chris Chandler','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 major','f0d447d','Mark Emlyn David Thomas','2009-07-16 16:07:19','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=40551 Enable the JvmRouteBinderValve to work with PersistentManagers as well as clusters','java/org/apache/catalina/ha/session/JvmRouteBinderValve.java\njava/org/apache/catalina/ha/session/LocalStrings.properties'),(1735,47515,'Bug 47515 – Tomcat can\'t replicate session when it is started.','','2009-07-12 23:08:36','Ryuichi Yoshihara','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Cluster','P2 normal','83e98da','Filip Hanik','2009-07-16 10:12:16','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47515 Patch submitted by Ryuichi Yoshihara','java/org/apache/catalina/ha/session/DeltaManager.java'),(1736,47444,'Bug 47444 – Removal of Jakarta references','There are still quite a few references to Jakarta Commons and even Jakarta Tomcat in the documentation.\n\nPatch to follow','2009-06-28 06:13:34','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P2 normal','59bb134','Mark Emlyn David Thomas','2009-07-15 03:15:10','Remainder of fix in trunk for 47444 Update references to Jakarta in Javadoc and JspC','java/org/apache/catalina/ant/jmx/package.html\njava/org/apache/catalina/ant/package.html\njava/org/apache/catalina/servlets/CGIServlet.java\njava/org/apache/jasper/resources/LocalStrings.properties\njava/org/apache/jasper/resources/LocalStrings_es.properties\njava/org/apache/jasper/resources/LocalStrings_fr.properties\njava/org/apache/jasper/resources/LocalStrings_ja.properties\njava/org/apache/tomcat/util/digester/CallMethodRule.java\njava/org/apache/tomcat/util/digester/package.html\njava/org/apache/tomcat/util/modeler/package.html'),(1737,47444,'Bug 47444 – Removal of Jakarta references','There are still quite a few references to Jakarta Commons and even Jakarta Tomcat in the documentation.\n\nPatch to follow','2009-06-28 06:13:34','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P2 normal','0cc8b34','Mark Emlyn David Thomas','2009-07-15 02:53:20','Partial fix for bug 47444. Update taglib URIs in examples, removing Jakarta references','webapps/examples/WEB-INF/jsp/debug-taglib.tld\nwebapps/examples/WEB-INF/jsp/example-taglib.tld\nwebapps/examples/WEB-INF/web.xml\nwebapps/examples/jsp/jsp2/el/functions.jsp\nwebapps/examples/jsp/jsp2/jspattribute/jspattribute.jsp\nwebapps/examples/jsp/jsp2/jspattribute/shuffle.jsp\nwebapps/examples/jsp/jsp2/misc/config.jsp\nwebapps/examples/jsp/jsp2/misc/dynamicattrs.jsp\nwebapps/examples/jsp/simpletag/foo.jsp\nwebapps/examples/jsp/source.jsp'),(1738,40380,'Bug 40380 – Potential syncro problem in StandardSession.expire(boolean)','public void expire(boolean notify) {\n\n        // Mark this session as \"being expired\" if needed\n        if (expiring)\n            return;\n\n// No man\'s land here\n\n        synchronized (this) {\n\n            if (manager == null)\n                return;\n\n            expiring = true;','2006-08-31 18:57:30','Claude Qu','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Servlet & JSP API','P2 normal','6f3e56e','Mark Emlyn David Thomas','2009-07-14 13:22:47','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=40380 Correct synchronisation of expire() Should now only run one per session','java/org/apache/catalina/session/StandardSession.java'),(1739,47524,'Bug 47524 – McastServiceImpl executor is not dispatching events.','','2009-07-14 06:20:02','Ariel','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 7','Cluster','P2 normal','aa8a2d3','Filip Hanik','2009-07-14 10:46:34','Patch by arielandres@hotmail.com Fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=47524','java/org/apache/catalina/tribes/membership/McastServiceImpl.java\njava/org/apache/catalina/tribes/transport/ReceiverBase.java\njava/org/apache/catalina/tribes/util/ExecutorFactory.java'),(1740,39194,'Bug 39194 – classpath inconsistent between Windows and Unix for tools.jar','I have found out (the hard way) that on Unix tools.jar is not included in the\nclasspath, while in our Windows test envionment, it is.\n\nI need the java compiler accessible for a 3rd-party library, coincidently\ncalled Jasperreports.\n\nSince the documentation states that tools.jar _is_ available,  I would ask\nthat it is made so by correcting setclasspath.sh, which only puts\ntools.jar in the classpath for the \'debug\' and \'javac\' commands.\n\nThat is nt consistent with the behavior of setclasspath.bat on Windows,\nwhich always adds tools.jar.\n\nThanks!','2006-04-04 01:43:54','Jason Brittain','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','8784b6a','Mark Emlyn David Thomas','2009-07-12 12:28:21','Alternative fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=39194 Only add tools.jar to classpath when using debug option Remove references to undocumented, half-implemented javac option Remove unused environment variables','bin/catalina.bat\nbin/catalina.sh\nbin/setclasspath.bat\nbin/setclasspath.sh'),(1741,39194,'Bug 39194 – classpath inconsistent between Windows and Unix for tools.jar','I have found out (the hard way) that on Unix tools.jar is not included in the\nclasspath, while in our Windows test envionment, it is.\n\nI need the java compiler accessible for a 3rd-party library, coincidently\ncalled Jasperreports.\n\nSince the documentation states that tools.jar _is_ available,  I would ask\nthat it is made so by correcting setclasspath.sh, which only puts\ntools.jar in the classpath for the \'debug\' and \'javac\' commands.\n\nThat is nt consistent with the behavior of setclasspath.bat on Windows,\nwhich always adds tools.jar.\n\nThanks!','2006-04-04 01:43:54','Jason Brittain','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','e00e395','Mark Emlyn David Thomas','2009-07-12 12:07:58','Revert r791331 that fixed https://issues.apache.org/bugzilla/show_bug.cgi?id=39194','bin/catalina.bat\nbin/catalina.sh\nbin/setclasspath.bat\nbin/setclasspath.sh'),(1742,47149,'Bug 47149 – Build fail (encoding error)on Chinese version Windows XP OS','When I build tomcat 6.0 trunk on my Chinese version Windows XP OS, I got an encoding error. So I\'d like add <compilerarg line=\"-encoding UTF-8 \"/> into all the <javac></javac> nodes in build.xml and dist.xml. Since I could only upload one file each time, I only upload revised version of build.xml. \n\nThis is my first time to issue a bugzilla entry, sorry for the non-standard format.','2009-05-04 07:10:13','Xie Xiaodong','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P2 minor','6f7f90f','Konstantin Kolinko','2009-07-09 18:53:56','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47149 Explicitly specify encoding for the source files','modules/bayeux/build.xml\nmodules/jdbc-pool/build.xml\nmodules/tomcat-lite/build.xml'),(1743,39231,'Bug 39231 – The JAAS contract for LoginModule is broken','The issue is that the custom JAAS\'s LoginModule.logout() method is never \ncalled. I guess this has been never implemented correctly (at least since \nTomcat 5.5.9).\n\nThe thing is that according to the JAAS spec, the LoginContext.logout() is \nsupposed to invoke the logout method for each LoginModule configured for this \nLoginContext.\n\nSo, somebody should be sure to call LoginContext.logout() method. The caller \nfor this method could be either a server or a client. \n\nSo, either Tomcat should provide some means to access the LoginContext to the \nclients, or Tomcat should take the responsibility to call this method by itself.\n\nI guess the solution could be for Tomcat to associate the instance of \nLoginContext with the user\'s session, and then Tomcat could invoke \nLoginContext.logout() when the session is being invalidated (both when the \nsession times out or invalidated explicitely).\n\nI hope that I am correctly interpreting the JAAS spec.','2006-04-06 21:19:49','Seva Popov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P3 normal','80f8ec6','Mark Emlyn David Thomas','2009-07-07 12:33:02','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=39231 The JAAS contract for LoginModule says we have to call logout(). This won\'t always work (eg if there is no session) but is a reasonable effort.','java/org/apache/catalina/realm/GenericPrincipal.java\njava/org/apache/catalina/realm/JAASRealm.java\njava/org/apache/catalina/session/LocalStrings.properties\njava/org/apache/catalina/session/StandardSession.java'),(1744,47478,'Bug 47478 – DeltaSession ignores notifyListenersOnReplication when BackupManager is used.','','2009-07-06 03:05:17','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Cluster','P2 normal','c1099f7','Filip Hanik','2009-07-06 11:45:32','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47478 Patch provided by Keiichi Fujino','java/org/apache/catalina/ha/session/DeltaSession.java'),(1745,39194,'Bug 39194 – classpath inconsistent between Windows and Unix for tools.jar','I have found out (the hard way) that on Unix tools.jar is not included in the\nclasspath, while in our Windows test envionment, it is.\n\nI need the java compiler accessible for a 3rd-party library, coincidently\ncalled Jasperreports.\n\nSince the documentation states that tools.jar _is_ available,  I would ask\nthat it is made so by correcting setclasspath.sh, which only puts\ntools.jar in the classpath for the \'debug\' and \'javac\' commands.\n\nThat is nt consistent with the behavior of setclasspath.bat on Windows,\nwhich always adds tools.jar.\n\nThanks!','2006-04-04 01:43:54','Jason Brittain','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','2e75c63','Mark Emlyn David Thomas','2009-07-05 18:46:51','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=39194 Align classpath for all platforms:  - only add tools.jar to the classpath when required  - document optional javac argument for catalina.sh|bat  - make sure javac without generating warnings on start Include a patch for setclasspath.sh by Jason Brittain','bin/catalina.bat\nbin/catalina.sh\nbin/setclasspath.bat\nbin/setclasspath.sh'),(1746,39194,'Bug 39194 – classpath inconsistent between Windows and Unix for tools.jar','I have found out (the hard way) that on Unix tools.jar is not included in the\nclasspath, while in our Windows test envionment, it is.\n\nI need the java compiler accessible for a 3rd-party library, coincidently\ncalled Jasperreports.\n\nSince the documentation states that tools.jar _is_ available,  I would ask\nthat it is made so by correcting setclasspath.sh, which only puts\ntools.jar in the classpath for the \'debug\' and \'javac\' commands.\n\nThat is nt consistent with the behavior of setclasspath.bat on Windows,\nwhich always adds tools.jar.\n\nThanks!','2006-04-04 01:43:54','Jason Brittain','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','9a53fdc','Mark Emlyn David Thomas','2009-07-05 17:48:51','Add the CLAASSPATH to the output (will be useful while working on 39194 as well as generally useful to see if it has been modified from the default) Fix a minor alignment niggle with JRE_HOME in cataina.sh','bin/catalina.bat\nbin/catalina.sh'),(1747,39089,'Bug 39089 – java.lang.InternalError: name is too long to represent','','2006-03-23 21:48:03','Erik G','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 critical','56954e2','Mark Emlyn David Thomas','2009-07-05 10:24:43','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=39089 Add a know issues section to the Jasper docs detailing the error described in 39089 and providing some possible workarounds','webapps/docs/jasper-howto.xml'),(1748,39089,'Bug 39089 – java.lang.InternalError: name is too long to represent','','2006-03-23 21:48:03','Erik G','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 critical','56954e2','Mark Emlyn David Thomas','2009-07-05 10:24:43','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=39089 Add a know issues section to the Jasper docs detailing the error described in 39089 and providing some possible workarounds','webapps/docs/jasper-howto.xml'),(1749,38797,'Bug 38797 – 5.5.12 and 5.5.15 emit different code on <jsp:getProperty>','Compiling this code:\n\n<jsp:getProperty name=\"person\" property=\"name\"/>\n\nresults in this with the Jasper of Tomcat 5.5.15:\n\nout.write(org.apache.jasper.runtime.JspRuntimeLibrary.toString(org.apache.jasper.runtime.JspRuntimeLibrary.handleGetProperty(_jspx_page_context.getAttribute(\"person\",\nPageContext.PAGE_SCOPE), \"name\")));\n\nAnd this with the Jasper of Tomcat 5.5.12 and before (checked 5.5.12, 5.0.28 and\nsome versions in between):\n\nout.write(org.apache.jasper.runtime.JspRuntimeLibrary.toString(org.apache.jasper.runtime.JspRuntimeLibrary.handleGetProperty(_jspx_page_context.findAttribute(\"person\"),\n\"name\")));\n\nMy property is in the session\'s scope, so the property is not found and an\nexception is thrown:\n\nSCHWERWIEGEND: Servlet.service() for servlet jsp threw exception\norg.apache.jasper.JasperException: Attempted a bean operation on a null object.\n	at\norg.apache.jasper.runtime.JspRuntimeLibrary.handleGetProperty(JspRuntimeLibrary.java:601)\n	at\norg.apache.jsp.title_jsp._jspx_meth_iku_restricted_0(org.apache.jsp.title_jsp:146)\n	at org.apache.jsp.title_jsp._jspService(org.apache.jsp.title_jsp:104)\n	at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:97)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:802)\n	at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:332)\n	at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:314)\n	at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:264)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:802)\n	at\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:252)\n	at\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)\n	at\norg.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:672)\n	at\norg.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:574)\n	at\norg.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:499)\n\nBTW: version 5.5.15 is missing in the bugzilla, so I selected 5.5.14','2006-02-27 18:40:15','Kurt Huwig','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 normal','202a33e','Mark Emlyn David Thomas','2009-07-05 07:30:22','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=38797 Revert previous fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=37933 and implement an alternative that doesn\'t have the side effects described in 38797','java/org/apache/jasper/compiler/Generator.java\njava/org/apache/jasper/compiler/PageInfo.java'),(1750,37933,'Bug 37933 – Bugs in Tomcat','','2005-12-16 07:00:20','manokaran','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Servlet & JSP API','P1 major','202a33e','Mark Emlyn David Thomas','2009-07-05 07:30:22','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=38797 Revert previous fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=37933 and implement an alternative that doesn\'t have the side effects described in 38797','java/org/apache/jasper/compiler/Generator.java\njava/org/apache/jasper/compiler/PageInfo.java'),(1751,38797,'Bug 38797 – 5.5.12 and 5.5.15 emit different code on <jsp:getProperty>','Compiling this code:\n\n<jsp:getProperty name=\"person\" property=\"name\"/>\n\nresults in this with the Jasper of Tomcat 5.5.15:\n\nout.write(org.apache.jasper.runtime.JspRuntimeLibrary.toString(org.apache.jasper.runtime.JspRuntimeLibrary.handleGetProperty(_jspx_page_context.getAttribute(\"person\",\nPageContext.PAGE_SCOPE), \"name\")));\n\nAnd this with the Jasper of Tomcat 5.5.12 and before (checked 5.5.12, 5.0.28 and\nsome versions in between):\n\nout.write(org.apache.jasper.runtime.JspRuntimeLibrary.toString(org.apache.jasper.runtime.JspRuntimeLibrary.handleGetProperty(_jspx_page_context.findAttribute(\"person\"),\n\"name\")));\n\nMy property is in the session\'s scope, so the property is not found and an\nexception is thrown:\n\nSCHWERWIEGEND: Servlet.service() for servlet jsp threw exception\norg.apache.jasper.JasperException: Attempted a bean operation on a null object.\n	at\norg.apache.jasper.runtime.JspRuntimeLibrary.handleGetProperty(JspRuntimeLibrary.java:601)\n	at\norg.apache.jsp.title_jsp._jspx_meth_iku_restricted_0(org.apache.jsp.title_jsp:146)\n	at org.apache.jsp.title_jsp._jspService(org.apache.jsp.title_jsp:104)\n	at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:97)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:802)\n	at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:332)\n	at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:314)\n	at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:264)\n	at javax.servlet.http.HttpServlet.service(HttpServlet.java:802)\n	at\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:252)\n	at\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)\n	at\norg.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:672)\n	at\norg.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:574)\n	at\norg.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:499)\n\nBTW: version 5.5.15 is missing in the bugzilla, so I selected 5.5.14','2006-02-27 18:40:15','Kurt Huwig','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 normal','202a33e','Mark Emlyn David Thomas','2009-07-05 07:30:22','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=38797 Revert previous fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=37933 and implement an alternative that doesn\'t have the side effects described in 38797','java/org/apache/jasper/compiler/Generator.java\njava/org/apache/jasper/compiler/PageInfo.java'),(1752,47149,'Bug 47149 – Build fail (encoding error)on Chinese version Windows XP OS','When I build tomcat 6.0 trunk on my Chinese version Windows XP OS, I got an encoding error. So I\'d like add <compilerarg line=\"-encoding UTF-8 \"/> into all the <javac></javac> nodes in build.xml and dist.xml. Since I could only upload one file each time, I only upload revised version of build.xml. \n\nThis is my first time to issue a bugzilla entry, sorry for the non-standard format.','2009-05-04 07:10:13','Xie Xiaodong','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P2 minor','3a5e373','Konstantin Kolinko','2009-07-03 20:06:05','Explicitly specify encoding for the source files Fixes https://issues.apache.org/bugzilla/show_bug.cgi?id=47149','build.xml\nextras.xml'),(1753,47443,'Bug 47443 – developers.html references non-existent vendors page','','2009-06-28 06:07:22','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P2 minor','896243e','Mark Emlyn David Thomas','2009-07-03 02:41:40','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47443 Point to wiki for support rather than non-existent Jakarta page','webapps/docs/developers.xml'),(1754,37984,'Bug 37984 – JNDIRealm.java not able to handle MD5 password','I\'m using JNDIRealm to authenticate to OpenLDAP 2.2.28.  Within OpenLDAP I\'ve\nconfigured the userPassword attribute for each user to contain the MD5 digest,\nand each is prefixed with the string \"{MD5}\".  I am not an LDAP expert by any\nmeans but I believe this prefix is a standard convention.  Anyway assuming this\nis a convention then JNDIRealm needs to strip off the \"{MD5}\" portion much like\nit does with \"{SHA1}\".  See attached patch which accomplishes this and I\nverified it works in my environment.','2005-12-21 05:51:20','Eric Lenio','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P3 normal','c6818a0','Mark Emlyn David Thomas','2009-07-01 18:13:33','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=37984 Strip {MD5} as well as {SHA} from digested passwords','java/org/apache/catalina/realm/JNDIRealm.java'),(1755,47458,'Bug 47458 – Allow test database settings to be specified in build.properties','','2009-06-30 05:52:59','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 enhancement','8999533','Filip Hanik','2009-06-30 15:15:28','Apply patch by sebb from https://issues.apache.org/bugzilla/show_bug.cgi?id=47458 Store db properties in build.properties using a prefix of testdb','modules/jdbc-pool/build.properties.default\nmodules/jdbc-pool/build.xml'),(1756,47440,'Bug 47440 – Remove DB-specific SQL statements from test cases (SELECT 1)','Some of the test cases assume that the JDBC provider supports \"SELECT 1\" as a valid SQL statement; however this is not always the case, e.g. Derby requires a table name to select from.\n\nThe solution provided in the patches is to use the validation query defined in the properties set up for the test, rather than always using \"SELECT 1\".','2009-06-27 05:17:55','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 enhancement','d92da6e','Filip Hanik','2009-06-29 10:36:57','Make properties configurable and resolve https://issues.apache.org/bugzilla/show_bug.cgi?id=47440','modules/jdbc-pool/test/org/apache/tomcat/jdbc/test/CheckOutThreadTest.java\nmodules/jdbc-pool/test/org/apache/tomcat/jdbc/test/DefaultProperties.java\nmodules/jdbc-pool/test/org/apache/tomcat/jdbc/test/TestSlowQueryReport.java'),(1757,47439,'Bug 47439 – PooledConnection.connect() fails to check for null connection','PooledConnection.connect() fails to check for null return from java.sql.Driver.connect() method.\n\nThis can result in an NPE when the connection is used later.','2009-06-27 05:01:35','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','ef96fa2','Filip Hanik','2009-06-28 11:58:13','Better error message according to https://issues.apache.org/bugzilla/show_bug.cgi?id=47439','modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/PooledConnection.java'),(1758,38352,'Bug 38352 – Additional Entries for Default catalina.policy file.','This patch adds additional entries to the catalina.policy file. Specifically:\n\nThe catalina.base/shared directory is added and given equal permissions to\ncatalina.home/common\n\njava.io.tmpdir is now readable.\njavax.servlet.context.tempdir is now readable. I think to be compliant with the\nspec, this must be allowed.\n\nDirectory specified by java.io.tmpdir (which is what tomcat points\njavax.servlet.context.tempdir to) is now read, write, delete. Again, I think the\nspec requires this.','2006-01-22 20:27:46','George Sexton','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','76a4eb3','Mark Emlyn David Thomas','2009-06-19 09:03:42','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=38352 The JSPLoader needs to have read/write permission to the context\'s temp directory, as per the spec.','java/org/apache/jasper/compiler/JspRuntimeContext.java');
INSERT INTO `bug_commit` VALUES (1759,37794,'Bug 37794 – getParameter() fails on POST with transfer-encoding: chunked','Overview: When an HTTP/1.1 client (for example J2ME) POST with\ntransfer-encoding: chunked to a servlet, the getParameter() family and\ngetQueryString() methods fail to retrieve the correct result by returning\nnothing. In contrast, reading until end-of-file on the servlets input stream\nproduces correct result.\n\nSteps to reproduce: Send a chunked POST request, with a=0 in the first chunk,\nsleep 1 s, then send &b=0 in the next, followed by a 0-chunk and trailer. On the\nreceiving servlet, call getParameterNames() or getParameter().\n\nActual Results: null\n\nExpected results: a=0&b=1\n\nBuild: Tomcat 5.5.12\n\nAdditional Builds and Platforms:\n- getParameter() does fail on:\n    Tomcat 4.1.18\n    Tomcat 4.1.24\n    Tomcat 5.5.12\n- getParameter() doesn\'t fail on:\n    Jetty 5.1.6\n\nAdditional Information: Please refer to the log below for Tomcat behaviour. It\nis from a simple test client and servlet written to demonstrate the bug.\nTomcat 5.5.12 log:\n\n****************************\n1) Reading the body - PASS *\n****************************\n    [junit] // testChunked(localhost, 8080)\n    [junit] // Sending request to host localhost port 8080\n    [junit] POST /testchunked/EchoServlet/getBody HTTP/1.1\n    [junit] User-Agent: no.riiber.net.http.test.chunked.EchoClient (chunked-test)\n    [junit] content-type: application/x-www-form-urlencoded\n    [junit] connection: Close\n    [junit] host: localhost:8080\n    [junit] transfer-encoding: chunked\n\n    [junit] 3\n    [junit] a=0\n    [junit] 4\n    [junit] &b=1\n    [junit] // Reading response from host localhost port 8080\n    [junit] HTTP/1.1 200 OK\n    [junit] Server: Apache-Coyote/1.1\n    [junit] Content-Type: text/plain;charset=ISO-8859-1\n    [junit] Content-Length: 9\n    [junit] Date: Mon, 05 Dec 2005 07:48:59 GMT\n    [junit] Connection: close\n\n    [junit] a=0&b=1\n    [junit] // PASS: a=0\n    [junit] // PASS: &b=1\n***************************************\n2) Reading using getQuerySTring: FAILS\n***************************************\n    [junit] // testChunked(localhost, 8080)\n    [junit] // Sending request to host localhost port 8080\n    [junit] POST /testchunked/EchoServlet/getQueryString HTTP/1.1\n    [junit] User-Agent: no.riiber.net.http.test.chunked.EchoClient (chunked-test)\n    [junit] content-type: application/x-www-form-urlencoded\n    [junit] connection: Close\n    [junit] host: localhost:8080\n    [junit] transfer-encoding: chunked\n\n    [junit] 3\n    [junit] a=0\n    [junit] 4\n    [junit] &b=1\n    [junit] // Reading response from host localhost port 8080\n    [junit] HTTP/1.1 200 OK\n    [junit] Server: Apache-Coyote/1.1\n    [junit] Content-Type: text/plain;charset=ISO-8859-1\n    [junit] Content-Length: 6\n    [junit] Date: Mon, 05 Dec 2005 07:48:59 GMT\n    [junit] Connection: close\n\n    [junit] null\n    [junit] // *** FAIL: a=0 is not present in response from\n/testchunked/EchoServlet/getQueryString ***\n    [junit] // *** FAIL: &b=1 is not present in response from\n/testchunked/EchoServlet/getQueryString ***\n********************************************\n3) Reading using getParameterNames(): FAILS\n*********************************************\n    [junit] // testChunked(localhost, 8080)\n    [junit] // Sending request to host localhost port 8080\n    [junit] POST /testchunked/EchoServlet/getParameterNamesAndValues HTTP/1.1\n    [junit] User-Agent: no.riiber.net.http.test.chunked.EchoClient (chunked-test)\n    [junit] content-type: application/x-www-form-urlencoded\n    [junit] connection: Close\n    [junit] host: localhost:8080\n    [junit] transfer-encoding: chunked\n\n    [junit] 3\n    [junit] a=0\n    [junit] 4\n    [junit] &b=1\n    [junit] // Reading response from host localhost port 8080\n    [junit] HTTP/1.1 200 OK\n    [junit] Server: Apache-Coyote/1.1\n    [junit] Content-Type: text/plain;charset=ISO-8859-1\n    [junit] Content-Length: 2\n    [junit] Date: Mon, 05 Dec 2005 07:49:02 GMT\n    [junit] Connection: close\n\n\n    [junit] // *** FAIL: a=0 is not present in response from\n/testchunked/EchoServlet/getParameterNamesAndValues ***\n    [junit] // *** FAIL: &b=1 is not present in response from\n/testchunked/EchoServlet/getParameterNamesAndValues ***\n\nBest regards\nArne Riiber','2005-12-05 18:43:35','Arne Riiber','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Servlet & JSP API','P2 normal','1dd88f7','Mark Emlyn David Thomas','2009-06-19 08:55:56','Add a header case-sensitivity test for 37794 test case (as reported by Tim)','test/org/apache/catalina/connector/TestRequest.java'),(1760,47308,'Bug 47308 – Cannot join in the cluster membership.','','2009-06-03 03:39:06','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Cluster','P2 normal','51fd68b','Filip Hanik','2009-06-18 13:08:38','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47308 Patch provided by Keiichi Fujino with one change, default is false','java/org/apache/catalina/tribes/membership/McastService.java\njava/org/apache/catalina/tribes/membership/McastServiceImpl.java\nwebapps/docs/config/cluster-membership.xml'),(1761,47389,'Bug 47389 – DeltaManager doesn\'t do the session replication. (notifySessionListenersOnReplication=false)','','2009-06-18 03:39:55','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Cluster','P2 normal','c768090','Filip Hanik','2009-06-18 11:27:55','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47389 patch provided by  Keiichi Fujino','java/org/apache/catalina/ha/session/DeltaManager.java'),(1762,37794,'Bug 37794 – getParameter() fails on POST with transfer-encoding: chunked','Overview: When an HTTP/1.1 client (for example J2ME) POST with\ntransfer-encoding: chunked to a servlet, the getParameter() family and\ngetQueryString() methods fail to retrieve the correct result by returning\nnothing. In contrast, reading until end-of-file on the servlets input stream\nproduces correct result.\n\nSteps to reproduce: Send a chunked POST request, with a=0 in the first chunk,\nsleep 1 s, then send &b=0 in the next, followed by a 0-chunk and trailer. On the\nreceiving servlet, call getParameterNames() or getParameter().\n\nActual Results: null\n\nExpected results: a=0&b=1\n\nBuild: Tomcat 5.5.12\n\nAdditional Builds and Platforms:\n- getParameter() does fail on:\n    Tomcat 4.1.18\n    Tomcat 4.1.24\n    Tomcat 5.5.12\n- getParameter() doesn\'t fail on:\n    Jetty 5.1.6\n\nAdditional Information: Please refer to the log below for Tomcat behaviour. It\nis from a simple test client and servlet written to demonstrate the bug.\nTomcat 5.5.12 log:\n\n****************************\n1) Reading the body - PASS *\n****************************\n    [junit] // testChunked(localhost, 8080)\n    [junit] // Sending request to host localhost port 8080\n    [junit] POST /testchunked/EchoServlet/getBody HTTP/1.1\n    [junit] User-Agent: no.riiber.net.http.test.chunked.EchoClient (chunked-test)\n    [junit] content-type: application/x-www-form-urlencoded\n    [junit] connection: Close\n    [junit] host: localhost:8080\n    [junit] transfer-encoding: chunked\n\n    [junit] 3\n    [junit] a=0\n    [junit] 4\n    [junit] &b=1\n    [junit] // Reading response from host localhost port 8080\n    [junit] HTTP/1.1 200 OK\n    [junit] Server: Apache-Coyote/1.1\n    [junit] Content-Type: text/plain;charset=ISO-8859-1\n    [junit] Content-Length: 9\n    [junit] Date: Mon, 05 Dec 2005 07:48:59 GMT\n    [junit] Connection: close\n\n    [junit] a=0&b=1\n    [junit] // PASS: a=0\n    [junit] // PASS: &b=1\n***************************************\n2) Reading using getQuerySTring: FAILS\n***************************************\n    [junit] // testChunked(localhost, 8080)\n    [junit] // Sending request to host localhost port 8080\n    [junit] POST /testchunked/EchoServlet/getQueryString HTTP/1.1\n    [junit] User-Agent: no.riiber.net.http.test.chunked.EchoClient (chunked-test)\n    [junit] content-type: application/x-www-form-urlencoded\n    [junit] connection: Close\n    [junit] host: localhost:8080\n    [junit] transfer-encoding: chunked\n\n    [junit] 3\n    [junit] a=0\n    [junit] 4\n    [junit] &b=1\n    [junit] // Reading response from host localhost port 8080\n    [junit] HTTP/1.1 200 OK\n    [junit] Server: Apache-Coyote/1.1\n    [junit] Content-Type: text/plain;charset=ISO-8859-1\n    [junit] Content-Length: 6\n    [junit] Date: Mon, 05 Dec 2005 07:48:59 GMT\n    [junit] Connection: close\n\n    [junit] null\n    [junit] // *** FAIL: a=0 is not present in response from\n/testchunked/EchoServlet/getQueryString ***\n    [junit] // *** FAIL: &b=1 is not present in response from\n/testchunked/EchoServlet/getQueryString ***\n********************************************\n3) Reading using getParameterNames(): FAILS\n*********************************************\n    [junit] // testChunked(localhost, 8080)\n    [junit] // Sending request to host localhost port 8080\n    [junit] POST /testchunked/EchoServlet/getParameterNamesAndValues HTTP/1.1\n    [junit] User-Agent: no.riiber.net.http.test.chunked.EchoClient (chunked-test)\n    [junit] content-type: application/x-www-form-urlencoded\n    [junit] connection: Close\n    [junit] host: localhost:8080\n    [junit] transfer-encoding: chunked\n\n    [junit] 3\n    [junit] a=0\n    [junit] 4\n    [junit] &b=1\n    [junit] // Reading response from host localhost port 8080\n    [junit] HTTP/1.1 200 OK\n    [junit] Server: Apache-Coyote/1.1\n    [junit] Content-Type: text/plain;charset=ISO-8859-1\n    [junit] Content-Length: 2\n    [junit] Date: Mon, 05 Dec 2005 07:49:02 GMT\n    [junit] Connection: close\n\n\n    [junit] // *** FAIL: a=0 is not present in response from\n/testchunked/EchoServlet/getParameterNamesAndValues ***\n    [junit] // *** FAIL: &b=1 is not present in response from\n/testchunked/EchoServlet/getParameterNamesAndValues ***\n\nBest regards\nArne Riiber','2005-12-05 18:43:35','Arne Riiber','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Servlet & JSP API','P2 normal','19aada7','Mark Emlyn David Thomas','2009-06-16 16:30:43','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=37794 Handle chunked POSTs. If maxPostSize is exceeded, a 500 results.','java/org/apache/catalina/connector/LocalStrings.properties\njava/org/apache/catalina/connector/Request.java'),(1763,37794,'Bug 37794 – getParameter() fails on POST with transfer-encoding: chunked','Overview: When an HTTP/1.1 client (for example J2ME) POST with\ntransfer-encoding: chunked to a servlet, the getParameter() family and\ngetQueryString() methods fail to retrieve the correct result by returning\nnothing. In contrast, reading until end-of-file on the servlets input stream\nproduces correct result.\n\nSteps to reproduce: Send a chunked POST request, with a=0 in the first chunk,\nsleep 1 s, then send &b=0 in the next, followed by a 0-chunk and trailer. On the\nreceiving servlet, call getParameterNames() or getParameter().\n\nActual Results: null\n\nExpected results: a=0&b=1\n\nBuild: Tomcat 5.5.12\n\nAdditional Builds and Platforms:\n- getParameter() does fail on:\n    Tomcat 4.1.18\n    Tomcat 4.1.24\n    Tomcat 5.5.12\n- getParameter() doesn\'t fail on:\n    Jetty 5.1.6\n\nAdditional Information: Please refer to the log below for Tomcat behaviour. It\nis from a simple test client and servlet written to demonstrate the bug.\nTomcat 5.5.12 log:\n\n****************************\n1) Reading the body - PASS *\n****************************\n    [junit] // testChunked(localhost, 8080)\n    [junit] // Sending request to host localhost port 8080\n    [junit] POST /testchunked/EchoServlet/getBody HTTP/1.1\n    [junit] User-Agent: no.riiber.net.http.test.chunked.EchoClient (chunked-test)\n    [junit] content-type: application/x-www-form-urlencoded\n    [junit] connection: Close\n    [junit] host: localhost:8080\n    [junit] transfer-encoding: chunked\n\n    [junit] 3\n    [junit] a=0\n    [junit] 4\n    [junit] &b=1\n    [junit] // Reading response from host localhost port 8080\n    [junit] HTTP/1.1 200 OK\n    [junit] Server: Apache-Coyote/1.1\n    [junit] Content-Type: text/plain;charset=ISO-8859-1\n    [junit] Content-Length: 9\n    [junit] Date: Mon, 05 Dec 2005 07:48:59 GMT\n    [junit] Connection: close\n\n    [junit] a=0&b=1\n    [junit] // PASS: a=0\n    [junit] // PASS: &b=1\n***************************************\n2) Reading using getQuerySTring: FAILS\n***************************************\n    [junit] // testChunked(localhost, 8080)\n    [junit] // Sending request to host localhost port 8080\n    [junit] POST /testchunked/EchoServlet/getQueryString HTTP/1.1\n    [junit] User-Agent: no.riiber.net.http.test.chunked.EchoClient (chunked-test)\n    [junit] content-type: application/x-www-form-urlencoded\n    [junit] connection: Close\n    [junit] host: localhost:8080\n    [junit] transfer-encoding: chunked\n\n    [junit] 3\n    [junit] a=0\n    [junit] 4\n    [junit] &b=1\n    [junit] // Reading response from host localhost port 8080\n    [junit] HTTP/1.1 200 OK\n    [junit] Server: Apache-Coyote/1.1\n    [junit] Content-Type: text/plain;charset=ISO-8859-1\n    [junit] Content-Length: 6\n    [junit] Date: Mon, 05 Dec 2005 07:48:59 GMT\n    [junit] Connection: close\n\n    [junit] null\n    [junit] // *** FAIL: a=0 is not present in response from\n/testchunked/EchoServlet/getQueryString ***\n    [junit] // *** FAIL: &b=1 is not present in response from\n/testchunked/EchoServlet/getQueryString ***\n********************************************\n3) Reading using getParameterNames(): FAILS\n*********************************************\n    [junit] // testChunked(localhost, 8080)\n    [junit] // Sending request to host localhost port 8080\n    [junit] POST /testchunked/EchoServlet/getParameterNamesAndValues HTTP/1.1\n    [junit] User-Agent: no.riiber.net.http.test.chunked.EchoClient (chunked-test)\n    [junit] content-type: application/x-www-form-urlencoded\n    [junit] connection: Close\n    [junit] host: localhost:8080\n    [junit] transfer-encoding: chunked\n\n    [junit] 3\n    [junit] a=0\n    [junit] 4\n    [junit] &b=1\n    [junit] // Reading response from host localhost port 8080\n    [junit] HTTP/1.1 200 OK\n    [junit] Server: Apache-Coyote/1.1\n    [junit] Content-Type: text/plain;charset=ISO-8859-1\n    [junit] Content-Length: 2\n    [junit] Date: Mon, 05 Dec 2005 07:49:02 GMT\n    [junit] Connection: close\n\n\n    [junit] // *** FAIL: a=0 is not present in response from\n/testchunked/EchoServlet/getParameterNamesAndValues ***\n    [junit] // *** FAIL: &b=1 is not present in response from\n/testchunked/EchoServlet/getParameterNamesAndValues ***\n\nBest regards\nArne Riiber','2005-12-05 18:43:35','Arne Riiber','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Servlet & JSP API','P2 normal','f540cc8','Mark Emlyn David Thomas','2009-06-16 16:18:14','Test case for bug 37794. The generic code will move out of this class if it turns out to be useful for other test cases','test/org/apache/catalina/connector/TestRequest.java'),(1764,47369,'Bug 47369 – DeltaRequest is never reset. (use BackupManager)','','2009-06-15 03:34:59','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Cluster','P2 normal','b3e2be4','Filip Hanik','2009-06-15 13:35:07','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47369 Patch provided by Keiichi Fujino','java/org/apache/catalina/tribes/tipis/AbstractReplicatedMap.java'),(1765,47124,'Bug 47124 – Run the unit tests as part of the build!!!','','2009-04-30 00:06:39','Marc Guillemot','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 enhancement','2cc9958','Mark Emlyn David Thomas','2009-06-15 12:21:22','Partly address bug 47124: Name unit tests consistently. All JUnit test cases are named Test*. There was at least one class named Test* that was not a JUnit test case. These were renamed *Test. Helper / stub implementations are named Tester*','java/org/apache/catalina/startup/Tomcat.java\ntest/org/apache/TestAll.java\ntest/org/apache/catalina/ha/session/TestPrincipal.java\ntest/org/apache/catalina/ha/session/TestSerializablePrincipal.java\ntest/org/apache/catalina/ha/session/TesterPrincipal.java\ntest/org/apache/catalina/ha/session/TesterSerializablePrincipal.java\ntest/org/apache/catalina/startup/TestTomcat.java\ntest/org/apache/catalina/startup/TomcatStartupAPITest.java\ntest/org/apache/catalina/tribes/test/NioSenderTest.java\ntest/org/apache/catalina/tribes/test/TestNioSender.java\ntest/org/apache/catalina/tribes/test/TribesTestSuite.java\ntest/org/apache/catalina/tribes/test/channel/ChannelStartStop.java\ntest/org/apache/catalina/tribes/test/channel/TestChannelStartStop.java\ntest/org/apache/catalina/tribes/test/membership/MemberSerialization.java\ntest/org/apache/catalina/tribes/test/membership/TestMemberSerialization.java'),(1766,43343,'Bug 43343 – Loss of data and concurrency issue with Catalina session persistent storage','A user was asking questions on the tomcat users mailing list about TC and how it\nhandled concurrency in sessions and session passivation/object caching of\nsessions when they are inactive etc. I thought, surely this is using locks etc,\nso had responded as such. Then I got curious. I started looking in the code and\nfound that indeed TC has a concurrency issue when the session is to pushed to\ndisk if it is inactive or the max number of live sessions is too high.\n\nThe problem is a user could have a session getting ready to become inactive. The\nserver is beginning to write the session out to disk. The user then comes in on\na request and gets the current session. They set an attribute. The web\napplication and the user think all is OK. But in reality the data they just put\ninto the session will be lost. The server just dumped their session to disk\ncontaining the old data as they updated the copy. So, the next time they come in\nthe session will be pulled from disk with the old values and anything they put\ninto it will have been lost. Depending on the application this could be very bad.\n\nTo see the issue go to the file:\njava/org/apache/catalina/session/PersistentManagerBase.java\n\nmethods:\nswapIn\nswapOut\nwriteSession\nfindSession\n(other related)\nthen the different stores load and save methods. There is nothing keeping this\nfrom happening.\n\nIf a lock is on a per session level this should keep it snappy for all other\nrequests etc. Either the session could be used as the lock or an object instance\nvariable on the session instance.\n\nI noticed there is a comment in the source code for\nPersistentManagerBase.processMaxIdleSwaps which reads:\n// Swap out all sessions idle longer than maxIdleSwap\n// FIXME: What\'s preventing us from mangling a session during\n// a request?\n\nSo, apparently someone thought of this. Nothing is keeping it from mangling a\nsession currently.\n\nWhat might be a fix is a session is given an instance variable which can be used\nfor a synchronization lock at the session level. In\nPersistentManagerBase.findSession, this lock would be used before the session\ncan be returned. After the session map is accessed it should then return null if\nthe session had been passivating before it was asked to be found. The session\nwould then be loaded from storage again before it was ever given back to be\naccessed had it been passivating. It would also be used in\nPersistentManagerBase.* which call swapOut.\n\nThe code would look like this (might explain it better):\n\nStandardSession:\n\n/**\n Used for locking the session during persistence operations.\n**/\nInteger persistence_locker = new Integer(0);\n\nPersistentManagerBase:\n\n    /**\n     * Return the active Session, associated with this Manager, with the\n     * specified session id (if any); otherwise return <code>null</code>.\n     * This method checks the persistence store if persistence is enabled,\n     * otherwise just uses the functionality from ManagerBase.\n     *\n     * @param id The session id for the session to be returned\n     *\n     * @exception IllegalStateException if a new session cannot be\n     *  instantiated for any reason\n     * @exception IOException if an input/output error occurs while\n     *  processing this request\n     */\n    public Session findSession(String id) throws IOException {\n\n        Session session = super.findSession(id);\n        //OK, at this point, we\'re not sure if another thread is trying to\n        //remove the session or not so the only way around this is to lock\n        //it (or attempt to) and then try to get it by this session id again.\n        //If the other code ran swapOut, then we should get a null back during\n        //this run, and if not, then by doing this we lock it out and then can\n        //access the session safely and will call access on it to update the\n        //access time and hopefully keep the processes from running swapOut\n        //so, we\'re adding two accesses to the hashmap instead of one for\n        //each request. But, we know we get the session or null back after\n        //the other process has had a chance to remove it or not.\n        if(session!=null{\n	        synchronized(session.persistence_locker){\n				session = super.findSession(session.getIdInternal());\n				if(session!=null){\n				   //we need to do this here\n				   //to keep any external calling code from messing up the\n				   //concurrency.\n				   session.access();\n				}\n			}\n		}\n        if (session != null)\n            return (session);\n\n        // See if the Session is in the Store\n        session = swapIn(id);\n        return (session);\n\n    }\n\n    /**\n     * Swap idle sessions out to Store if they are idle too long.\n     */\n    protected void processMaxIdleSwaps() {\n\n        if (!isStarted() || maxIdleSwap < 0)\n            return;\n\n        Session sessions[] = findSessions();\n        long timeNow = System.currentTimeMillis();\n\n        // Swap out all sessions idle longer than maxIdleSwap\n        // FIXME: What\'s preventing us from mangling a session during\n        // a request?\n        if (maxIdleSwap >= 0) {\n            for (int i = 0; i < sessions.length; i++) {\n                StandardSession session = (StandardSession) sessions[i];\n                synchronized(session.persistence_locker){\n            	    if (!session.isValid())\n            	        continue;\n            	    int timeIdle = // Truncate, do not round up\n            	        (int) ((timeNow - session.getLastAccessedTime()) / 1000L);\n            	    if (timeIdle > maxIdleSwap && timeIdle > minIdleSwap) {\n            	        if (log.isDebugEnabled())\n            	            log.debug(sm.getString\n            	                (\"persistentManager.swapMaxIdle\",\n            	                 session.getIdInternal(), new Integer(timeIdle)));\n            	        try {\n            	            swapOut(session);\n            	        } catch (IOException e) {\n            	            ;   // This is logged in writeSession()\n            	        }\n            	    }\n				}\n            }\n        }\n\n    }\n\n\n    /**\n     * Swap idle sessions out to Store if too many are active\n     */\n    protected void processMaxActiveSwaps() {\n\n        if (!isStarted() || getMaxActiveSessions() < 0)\n            return;\n\n        Session sessions[] = findSessions();\n\n        // FIXME: Smarter algorithm (LRU)\n        if (getMaxActiveSessions() >= sessions.length)\n            return;\n\n        if(log.isDebugEnabled())\n            log.debug(sm.getString\n                (\"persistentManager.tooManyActive\",\n                 new Integer(sessions.length)));\n\n        int toswap = sessions.length - getMaxActiveSessions();\n        long timeNow = System.currentTimeMillis();\n\n        for (int i = 0; i < sessions.length && toswap > 0; i++) {\n		synchronized(sessions[i].persistence_locker){\n                    int timeIdle = // Truncate, do not round up\n            	    (int) ((timeNow - sessions[i].getLastAccessedTime()) / 1000L);\n	            if (timeIdle > minIdleSwap) {\n	                if(log.isDebugEnabled())\n	                    log.debug(sm.getString\n	                        (\"persistentManager.swapTooManyActive\",\n	                         sessions[i].getIdInternal(), new Integer(timeIdle)));\n	                try {\n	                    swapOut(sessions[i]);\n	                } catch (IOException e) {\n	                    ;   // This is logged in writeSession()\n	                }\n	                toswap--;\n	            }\n			}\n        }\n\n    }\n\n\n    /**\n     * Back up idle sessions.\n     */\n    protected void processMaxIdleBackups() {\n\n        if (!isStarted() || maxIdleBackup < 0)\n            return;\n\n        Session sessions[] = findSessions();\n        long timeNow = System.currentTimeMillis();\n\n        // Back up all sessions idle longer than maxIdleBackup\n        if (maxIdleBackup >= 0) {\n            for (int i = 0; i < sessions.length; i++) {\n                StandardSession session = (StandardSession) sessions[i];\n                synchronized(session.persistence_locker){\n                    if (!session.isValid())\n                	    continue;\n                	int timeIdle = // Truncate, do not round up\n                    	(int) ((timeNow - session.getLastAccessedTime()) / 1000L);\n                	if (timeIdle > maxIdleBackup) {\n                    	if (log.isDebugEnabled())\n                    	    log.debug(sm.getString\n                    	        (\"persistentManager.backupMaxIdle\",\n                    	        session.getIdInternal(), new Integer(timeIdle)));\n\n                    	try {\n                        	writeSession(session);\n                    	} catch (IOException e) {\n                        	;   // This is logged in writeSession()\n                    	}\n                	}\n            	}\n        	}\n	    }\n\n    }\n\n\n\nSo, currently one could very easily have a session and have some issues. Your\nuser would have a time when they thought they set something or your code could\nthink this then immediately the changes are lost. Anyways, that is what looks to\nbe the issue and a workable fix. The only place I saw other issues was inside of:\njava/org/apache/catalina/valves/PersistentValve.java\n\nwhere it incorrectly grabs the store from the PersistentManager and uses it\ndirectly instead of using the manager API. To me this is bad in that the manager\nis not able to be the manager and this other logic is accessing the store\ndirectly and should never happen...unless it is used only in test cases etc.\n\nThe only way you could possibly *sort of* workaround this issue would be to use\na HttpSessionActivationListener, but even then it would be hard to code up a\n100% reliable solution. You can see how this would *sort of* be a way to work\naround the issue by looking at the class StandardSession method passivate , and\nsee the events will be thrown to alert code the session will passivate, but it\nwould be pretty complicated and ugly to protect the session completely.','2007-09-10 10:54:45','Wade Chandler','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','1ef689a','Mark Emlyn David Thomas','2009-06-13 15:05:56','Enhancements to fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=43343 based on kkolinko\'s review','java/org/apache/catalina/session/PersistentManagerBase.java\nwebapps/docs/config/manager.xml'),(1767,47343,'Bug 47343 – Fails re-deploying, when we update context.xml.','','2009-06-10 03:54:19','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','cc1f0dd','Mark Emlyn David Thomas','2009-06-11 09:48:42','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47343 Regression in https://issues.apache.org/bugzilla/show_bug.cgi?id=42747 context.xml can now be edited without resources being deleted','java/org/apache/catalina/startup/HostConfig.java'),(1768,42747,'Bug 42747 – Context className attribute ignored for contexts deployed from descriptors in web/META-INF/context.xml','When deploying an app from a context descriptor inside a webapp/META-INF\ndirectory via context.xml, the className is ignored and the context is created\nas a StandardContext.  I\'ve tried to use a ReplicatedContext class in a cluster\nfrom this configuration and it does not work.  However, it does work if i move\nthe context.xml to $CATALINA_BASE/conf/[EngineName]/[HostName]/webapp.xml.','2007-06-26 11:41:53','randy hoffman','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','cc1f0dd','Mark Emlyn David Thomas','2009-06-11 09:48:42','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47343 Regression in https://issues.apache.org/bugzilla/show_bug.cgi?id=42747 context.xml can now be edited without resources being deleted','java/org/apache/catalina/startup/HostConfig.java'),(1769,47318,'Bug 47318 – Tomcat 6.0.20 does not include imports from included JSP','Tomcat 6.0.20 does not include imports from included JSP, i.e.,\n- JSP A includes JSP B.\n- JSP B has some page imports\n\nResult: JSP A is not able to see page imports imported in JSP B - the page imports imported in JSP B are not imported on JSP A generated class file.\n\nExpected Result: JSP A is able to see page imports imported in JSP B\n\nThis worked in Tomcat 6.0.18.','2009-06-04 19:21:41','Tim Funk','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 regression','064494e','Mark Emlyn David Thomas','2009-06-10 08:31:29','Better fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47318 Process include preludes and codas for top level JSP pages only','java/org/apache/jasper/compiler/Parser.java'),(1770,47237,'Bug 47237 – Put a hard limit on Http11NioProcessor objects','','2009-05-21 09:09:15','Filip Hanik','Tomcat Developers Mailing List','RESOLVED WORKSFORME','Tomcat 6','Connectors','P2 normal','074d9b4','Filip Hanik','2009-06-09 18:14:55','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47237 There is no need to associate the Http11NioProcessor with a socket in between requests unless there is a comet.','java/org/apache/coyote/http11/Http11NioProtocol.java'),(1771,47318,'Bug 47318 – Tomcat 6.0.20 does not include imports from included JSP','Tomcat 6.0.20 does not include imports from included JSP, i.e.,\n- JSP A includes JSP B.\n- JSP B has some page imports\n\nResult: JSP A is not able to see page imports imported in JSP B - the page imports imported in JSP B are not imported on JSP A generated class file.\n\nExpected Result: JSP A is able to see page imports imported in JSP B\n\nThis worked in Tomcat 6.0.18.','2009-06-04 19:21:41','Tim Funk','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 regression','0dec8e1','Mark Emlyn David Thomas','2009-06-05 19:35:14','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47318 Process include preludes and codas when processing directives and whole pages.','java/org/apache/jasper/compiler/Parser.java'),(1772,47299,'Bug 47299 – Cannot override StandardContext in embedding case because of StandardSession.fireContainerEvent','StandardSession.fireContainerEvent checks for the String class name! Why not just use an instanceof check here?','2009-06-02 07:19:36','Rob Harrop','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','468f370','Mark Emlyn David Thomas','2009-06-05 17:38:44','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47299 Simplify fireContainerEvent method and enable it to work with implementations that extend StandardContext. See http://svn.apache.org/viewvc?view=rev&revision=287710 for why it was written this way originally.','java/org/apache/catalina/session/StandardSession.java'),(1773,47158,'Bug 47158 – I think AccessLogValve has race condition problem','','2009-05-05 15:12:45','Xie Xiaodong','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','f00029e','Mark Emlyn David Thomas','2009-06-04 11:36:07','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47158 Thread safety issues','java/org/apache/catalina/valves/AccessLogValve.java'),(1774,43343,'Bug 43343 – Loss of data and concurrency issue with Catalina session persistent storage','A user was asking questions on the tomcat users mailing list about TC and how it\nhandled concurrency in sessions and session passivation/object caching of\nsessions when they are inactive etc. I thought, surely this is using locks etc,\nso had responded as such. Then I got curious. I started looking in the code and\nfound that indeed TC has a concurrency issue when the session is to pushed to\ndisk if it is inactive or the max number of live sessions is too high.\n\nThe problem is a user could have a session getting ready to become inactive. The\nserver is beginning to write the session out to disk. The user then comes in on\na request and gets the current session. They set an attribute. The web\napplication and the user think all is OK. But in reality the data they just put\ninto the session will be lost. The server just dumped their session to disk\ncontaining the old data as they updated the copy. So, the next time they come in\nthe session will be pulled from disk with the old values and anything they put\ninto it will have been lost. Depending on the application this could be very bad.\n\nTo see the issue go to the file:\njava/org/apache/catalina/session/PersistentManagerBase.java\n\nmethods:\nswapIn\nswapOut\nwriteSession\nfindSession\n(other related)\nthen the different stores load and save methods. There is nothing keeping this\nfrom happening.\n\nIf a lock is on a per session level this should keep it snappy for all other\nrequests etc. Either the session could be used as the lock or an object instance\nvariable on the session instance.\n\nI noticed there is a comment in the source code for\nPersistentManagerBase.processMaxIdleSwaps which reads:\n// Swap out all sessions idle longer than maxIdleSwap\n// FIXME: What\'s preventing us from mangling a session during\n// a request?\n\nSo, apparently someone thought of this. Nothing is keeping it from mangling a\nsession currently.\n\nWhat might be a fix is a session is given an instance variable which can be used\nfor a synchronization lock at the session level. In\nPersistentManagerBase.findSession, this lock would be used before the session\ncan be returned. After the session map is accessed it should then return null if\nthe session had been passivating before it was asked to be found. The session\nwould then be loaded from storage again before it was ever given back to be\naccessed had it been passivating. It would also be used in\nPersistentManagerBase.* which call swapOut.\n\nThe code would look like this (might explain it better):\n\nStandardSession:\n\n/**\n Used for locking the session during persistence operations.\n**/\nInteger persistence_locker = new Integer(0);\n\nPersistentManagerBase:\n\n    /**\n     * Return the active Session, associated with this Manager, with the\n     * specified session id (if any); otherwise return <code>null</code>.\n     * This method checks the persistence store if persistence is enabled,\n     * otherwise just uses the functionality from ManagerBase.\n     *\n     * @param id The session id for the session to be returned\n     *\n     * @exception IllegalStateException if a new session cannot be\n     *  instantiated for any reason\n     * @exception IOException if an input/output error occurs while\n     *  processing this request\n     */\n    public Session findSession(String id) throws IOException {\n\n        Session session = super.findSession(id);\n        //OK, at this point, we\'re not sure if another thread is trying to\n        //remove the session or not so the only way around this is to lock\n        //it (or attempt to) and then try to get it by this session id again.\n        //If the other code ran swapOut, then we should get a null back during\n        //this run, and if not, then by doing this we lock it out and then can\n        //access the session safely and will call access on it to update the\n        //access time and hopefully keep the processes from running swapOut\n        //so, we\'re adding two accesses to the hashmap instead of one for\n        //each request. But, we know we get the session or null back after\n        //the other process has had a chance to remove it or not.\n        if(session!=null{\n	        synchronized(session.persistence_locker){\n				session = super.findSession(session.getIdInternal());\n				if(session!=null){\n				   //we need to do this here\n				   //to keep any external calling code from messing up the\n				   //concurrency.\n				   session.access();\n				}\n			}\n		}\n        if (session != null)\n            return (session);\n\n        // See if the Session is in the Store\n        session = swapIn(id);\n        return (session);\n\n    }\n\n    /**\n     * Swap idle sessions out to Store if they are idle too long.\n     */\n    protected void processMaxIdleSwaps() {\n\n        if (!isStarted() || maxIdleSwap < 0)\n            return;\n\n        Session sessions[] = findSessions();\n        long timeNow = System.currentTimeMillis();\n\n        // Swap out all sessions idle longer than maxIdleSwap\n        // FIXME: What\'s preventing us from mangling a session during\n        // a request?\n        if (maxIdleSwap >= 0) {\n            for (int i = 0; i < sessions.length; i++) {\n                StandardSession session = (StandardSession) sessions[i];\n                synchronized(session.persistence_locker){\n            	    if (!session.isValid())\n            	        continue;\n            	    int timeIdle = // Truncate, do not round up\n            	        (int) ((timeNow - session.getLastAccessedTime()) / 1000L);\n            	    if (timeIdle > maxIdleSwap && timeIdle > minIdleSwap) {\n            	        if (log.isDebugEnabled())\n            	            log.debug(sm.getString\n            	                (\"persistentManager.swapMaxIdle\",\n            	                 session.getIdInternal(), new Integer(timeIdle)));\n            	        try {\n            	            swapOut(session);\n            	        } catch (IOException e) {\n            	            ;   // This is logged in writeSession()\n            	        }\n            	    }\n				}\n            }\n        }\n\n    }\n\n\n    /**\n     * Swap idle sessions out to Store if too many are active\n     */\n    protected void processMaxActiveSwaps() {\n\n        if (!isStarted() || getMaxActiveSessions() < 0)\n            return;\n\n        Session sessions[] = findSessions();\n\n        // FIXME: Smarter algorithm (LRU)\n        if (getMaxActiveSessions() >= sessions.length)\n            return;\n\n        if(log.isDebugEnabled())\n            log.debug(sm.getString\n                (\"persistentManager.tooManyActive\",\n                 new Integer(sessions.length)));\n\n        int toswap = sessions.length - getMaxActiveSessions();\n        long timeNow = System.currentTimeMillis();\n\n        for (int i = 0; i < sessions.length && toswap > 0; i++) {\n		synchronized(sessions[i].persistence_locker){\n                    int timeIdle = // Truncate, do not round up\n            	    (int) ((timeNow - sessions[i].getLastAccessedTime()) / 1000L);\n	            if (timeIdle > minIdleSwap) {\n	                if(log.isDebugEnabled())\n	                    log.debug(sm.getString\n	                        (\"persistentManager.swapTooManyActive\",\n	                         sessions[i].getIdInternal(), new Integer(timeIdle)));\n	                try {\n	                    swapOut(sessions[i]);\n	                } catch (IOException e) {\n	                    ;   // This is logged in writeSession()\n	                }\n	                toswap--;\n	            }\n			}\n        }\n\n    }\n\n\n    /**\n     * Back up idle sessions.\n     */\n    protected void processMaxIdleBackups() {\n\n        if (!isStarted() || maxIdleBackup < 0)\n            return;\n\n        Session sessions[] = findSessions();\n        long timeNow = System.currentTimeMillis();\n\n        // Back up all sessions idle longer than maxIdleBackup\n        if (maxIdleBackup >= 0) {\n            for (int i = 0; i < sessions.length; i++) {\n                StandardSession session = (StandardSession) sessions[i];\n                synchronized(session.persistence_locker){\n                    if (!session.isValid())\n                	    continue;\n                	int timeIdle = // Truncate, do not round up\n                    	(int) ((timeNow - session.getLastAccessedTime()) / 1000L);\n                	if (timeIdle > maxIdleBackup) {\n                    	if (log.isDebugEnabled())\n                    	    log.debug(sm.getString\n                    	        (\"persistentManager.backupMaxIdle\",\n                    	        session.getIdInternal(), new Integer(timeIdle)));\n\n                    	try {\n                        	writeSession(session);\n                    	} catch (IOException e) {\n                        	;   // This is logged in writeSession()\n                    	}\n                	}\n            	}\n        	}\n	    }\n\n    }\n\n\n\nSo, currently one could very easily have a session and have some issues. Your\nuser would have a time when they thought they set something or your code could\nthink this then immediately the changes are lost. Anyways, that is what looks to\nbe the issue and a workable fix. The only place I saw other issues was inside of:\njava/org/apache/catalina/valves/PersistentValve.java\n\nwhere it incorrectly grabs the store from the PersistentManager and uses it\ndirectly instead of using the manager API. To me this is bad in that the manager\nis not able to be the manager and this other logic is accessing the store\ndirectly and should never happen...unless it is used only in test cases etc.\n\nThe only way you could possibly *sort of* workaround this issue would be to use\na HttpSessionActivationListener, but even then it would be hard to code up a\n100% reliable solution. You can see how this would *sort of* be a way to work\naround the issue by looking at the class StandardSession method passivate , and\nsee the events will be thrown to alert code the session will passivate, but it\nwould be pretty complicated and ugly to protect the session completely.','2007-09-10 10:54:45','Wade Chandler','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','de1bd11','Mark Emlyn David Thomas','2009-05-25 18:32:57','Fix case B in bug 43343. Don\'t try to swap out a session that is being accessed.','java/org/apache/catalina/session/PersistentManagerBase.java'),(1775,43343,'Bug 43343 – Loss of data and concurrency issue with Catalina session persistent storage','A user was asking questions on the tomcat users mailing list about TC and how it\nhandled concurrency in sessions and session passivation/object caching of\nsessions when they are inactive etc. I thought, surely this is using locks etc,\nso had responded as such. Then I got curious. I started looking in the code and\nfound that indeed TC has a concurrency issue when the session is to pushed to\ndisk if it is inactive or the max number of live sessions is too high.\n\nThe problem is a user could have a session getting ready to become inactive. The\nserver is beginning to write the session out to disk. The user then comes in on\na request and gets the current session. They set an attribute. The web\napplication and the user think all is OK. But in reality the data they just put\ninto the session will be lost. The server just dumped their session to disk\ncontaining the old data as they updated the copy. So, the next time they come in\nthe session will be pulled from disk with the old values and anything they put\ninto it will have been lost. Depending on the application this could be very bad.\n\nTo see the issue go to the file:\njava/org/apache/catalina/session/PersistentManagerBase.java\n\nmethods:\nswapIn\nswapOut\nwriteSession\nfindSession\n(other related)\nthen the different stores load and save methods. There is nothing keeping this\nfrom happening.\n\nIf a lock is on a per session level this should keep it snappy for all other\nrequests etc. Either the session could be used as the lock or an object instance\nvariable on the session instance.\n\nI noticed there is a comment in the source code for\nPersistentManagerBase.processMaxIdleSwaps which reads:\n// Swap out all sessions idle longer than maxIdleSwap\n// FIXME: What\'s preventing us from mangling a session during\n// a request?\n\nSo, apparently someone thought of this. Nothing is keeping it from mangling a\nsession currently.\n\nWhat might be a fix is a session is given an instance variable which can be used\nfor a synchronization lock at the session level. In\nPersistentManagerBase.findSession, this lock would be used before the session\ncan be returned. After the session map is accessed it should then return null if\nthe session had been passivating before it was asked to be found. The session\nwould then be loaded from storage again before it was ever given back to be\naccessed had it been passivating. It would also be used in\nPersistentManagerBase.* which call swapOut.\n\nThe code would look like this (might explain it better):\n\nStandardSession:\n\n/**\n Used for locking the session during persistence operations.\n**/\nInteger persistence_locker = new Integer(0);\n\nPersistentManagerBase:\n\n    /**\n     * Return the active Session, associated with this Manager, with the\n     * specified session id (if any); otherwise return <code>null</code>.\n     * This method checks the persistence store if persistence is enabled,\n     * otherwise just uses the functionality from ManagerBase.\n     *\n     * @param id The session id for the session to be returned\n     *\n     * @exception IllegalStateException if a new session cannot be\n     *  instantiated for any reason\n     * @exception IOException if an input/output error occurs while\n     *  processing this request\n     */\n    public Session findSession(String id) throws IOException {\n\n        Session session = super.findSession(id);\n        //OK, at this point, we\'re not sure if another thread is trying to\n        //remove the session or not so the only way around this is to lock\n        //it (or attempt to) and then try to get it by this session id again.\n        //If the other code ran swapOut, then we should get a null back during\n        //this run, and if not, then by doing this we lock it out and then can\n        //access the session safely and will call access on it to update the\n        //access time and hopefully keep the processes from running swapOut\n        //so, we\'re adding two accesses to the hashmap instead of one for\n        //each request. But, we know we get the session or null back after\n        //the other process has had a chance to remove it or not.\n        if(session!=null{\n	        synchronized(session.persistence_locker){\n				session = super.findSession(session.getIdInternal());\n				if(session!=null){\n				   //we need to do this here\n				   //to keep any external calling code from messing up the\n				   //concurrency.\n				   session.access();\n				}\n			}\n		}\n        if (session != null)\n            return (session);\n\n        // See if the Session is in the Store\n        session = swapIn(id);\n        return (session);\n\n    }\n\n    /**\n     * Swap idle sessions out to Store if they are idle too long.\n     */\n    protected void processMaxIdleSwaps() {\n\n        if (!isStarted() || maxIdleSwap < 0)\n            return;\n\n        Session sessions[] = findSessions();\n        long timeNow = System.currentTimeMillis();\n\n        // Swap out all sessions idle longer than maxIdleSwap\n        // FIXME: What\'s preventing us from mangling a session during\n        // a request?\n        if (maxIdleSwap >= 0) {\n            for (int i = 0; i < sessions.length; i++) {\n                StandardSession session = (StandardSession) sessions[i];\n                synchronized(session.persistence_locker){\n            	    if (!session.isValid())\n            	        continue;\n            	    int timeIdle = // Truncate, do not round up\n            	        (int) ((timeNow - session.getLastAccessedTime()) / 1000L);\n            	    if (timeIdle > maxIdleSwap && timeIdle > minIdleSwap) {\n            	        if (log.isDebugEnabled())\n            	            log.debug(sm.getString\n            	                (\"persistentManager.swapMaxIdle\",\n            	                 session.getIdInternal(), new Integer(timeIdle)));\n            	        try {\n            	            swapOut(session);\n            	        } catch (IOException e) {\n            	            ;   // This is logged in writeSession()\n            	        }\n            	    }\n				}\n            }\n        }\n\n    }\n\n\n    /**\n     * Swap idle sessions out to Store if too many are active\n     */\n    protected void processMaxActiveSwaps() {\n\n        if (!isStarted() || getMaxActiveSessions() < 0)\n            return;\n\n        Session sessions[] = findSessions();\n\n        // FIXME: Smarter algorithm (LRU)\n        if (getMaxActiveSessions() >= sessions.length)\n            return;\n\n        if(log.isDebugEnabled())\n            log.debug(sm.getString\n                (\"persistentManager.tooManyActive\",\n                 new Integer(sessions.length)));\n\n        int toswap = sessions.length - getMaxActiveSessions();\n        long timeNow = System.currentTimeMillis();\n\n        for (int i = 0; i < sessions.length && toswap > 0; i++) {\n		synchronized(sessions[i].persistence_locker){\n                    int timeIdle = // Truncate, do not round up\n            	    (int) ((timeNow - sessions[i].getLastAccessedTime()) / 1000L);\n	            if (timeIdle > minIdleSwap) {\n	                if(log.isDebugEnabled())\n	                    log.debug(sm.getString\n	                        (\"persistentManager.swapTooManyActive\",\n	                         sessions[i].getIdInternal(), new Integer(timeIdle)));\n	                try {\n	                    swapOut(sessions[i]);\n	                } catch (IOException e) {\n	                    ;   // This is logged in writeSession()\n	                }\n	                toswap--;\n	            }\n			}\n        }\n\n    }\n\n\n    /**\n     * Back up idle sessions.\n     */\n    protected void processMaxIdleBackups() {\n\n        if (!isStarted() || maxIdleBackup < 0)\n            return;\n\n        Session sessions[] = findSessions();\n        long timeNow = System.currentTimeMillis();\n\n        // Back up all sessions idle longer than maxIdleBackup\n        if (maxIdleBackup >= 0) {\n            for (int i = 0; i < sessions.length; i++) {\n                StandardSession session = (StandardSession) sessions[i];\n                synchronized(session.persistence_locker){\n                    if (!session.isValid())\n                	    continue;\n                	int timeIdle = // Truncate, do not round up\n                    	(int) ((timeNow - session.getLastAccessedTime()) / 1000L);\n                	if (timeIdle > maxIdleBackup) {\n                    	if (log.isDebugEnabled())\n                    	    log.debug(sm.getString\n                    	        (\"persistentManager.backupMaxIdle\",\n                    	        session.getIdInternal(), new Integer(timeIdle)));\n\n                    	try {\n                        	writeSession(session);\n                    	} catch (IOException e) {\n                        	;   // This is logged in writeSession()\n                    	}\n                	}\n            	}\n        	}\n	    }\n\n    }\n\n\n\nSo, currently one could very easily have a session and have some issues. Your\nuser would have a time when they thought they set something or your code could\nthink this then immediately the changes are lost. Anyways, that is what looks to\nbe the issue and a workable fix. The only place I saw other issues was inside of:\njava/org/apache/catalina/valves/PersistentValve.java\n\nwhere it incorrectly grabs the store from the PersistentManager and uses it\ndirectly instead of using the manager API. To me this is bad in that the manager\nis not able to be the manager and this other logic is accessing the store\ndirectly and should never happen...unless it is used only in test cases etc.\n\nThe only way you could possibly *sort of* workaround this issue would be to use\na HttpSessionActivationListener, but even then it would be hard to code up a\n100% reliable solution. You can see how this would *sort of* be a way to work\naround the issue by looking at the class StandardSession method passivate , and\nsee the events will be thrown to alert code the session will passivate, but it\nwould be pretty complicated and ugly to protect the session completely.','2007-09-10 10:54:45','Wade Chandler','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','dd95184','Mark Emlyn David Thomas','2009-05-25 18:26:34','Stop access count going negative when session is swapped in. This fix is required for the fix for bug 43343.','java/org/apache/catalina/session/PersistentManagerBase.java'),(1776,47216,'Bug 47216 – Possible NPE in Http11Processor.action()','The code at around line 1075:\n\n        } else if (actionCode == ActionCode.ACTION_REQ_LOCAL_ADDR_ATTRIBUTE) {\n\n            if (localAddr == null)\n               localAddr = socket.getLocalAddress().getHostAddress();\n\nfails to check if \"socket != null\".\n\nSince this is checked everywhere else in the method this is probably a bug.\n\nThe method Http11Processor.parseHost() also references \"socket\" without checking for null. Within the class, it is only called by process(Socket), which guarantees that it won\'t be null.\n\nHowever once process() returns normally, socket will be set to null.\n\nThe parseHost() method is public, so it may be called when socket == null.\n\nPerhaps the parseHost() method should be private?','2009-05-18 18:13:50','Sebb','Tomcat Developers Mailing List','RESOLVED WONTFIX','Tomcat 6','Catalina','P2 normal','36feee0','Mark Emlyn David Thomas','2009-05-25 07:00:23','Reduce visibility of parseHost as discussed as a side issue to bug 47216.','java/org/apache/coyote/http11/Http11Processor.java'),(1777,47228,'Bug 47228 – Incorrect French translations','The files\n\njasper/resources/LocalStrings_fr.properties\nnaming/resources/LocalStrings_fr.properties\n\nhave the words  \"doit commencé\"\nThese should be \"doit commencer\"','2009-05-20 08:43:22','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','5b9f39e','Mark Emlyn David Thomas','2009-05-25 06:26:22','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47228 Correct French spellings. Patch provided by Sebb. (Trusting that his French is a lot better than mine)','java/org/apache/jasper/resources/LocalStrings_fr.properties\njava/org/apache/naming/resources/LocalStrings_fr.properties'),(1778,47235,'Bug 47235 – MySQL example should *not* include usage of the autoReconnect flag','','2009-05-21 07:47:38','Eric DeCosta','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P2 normal','68628722','Mark Emlyn David Thomas','2009-05-25 06:18:13','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47235 Remove use of auto-reconnect flag from MySQL examples','modules/jdbc-pool/doc/jdbc-pool.xml\nwebapps/docs/jndi-datasource-examples-howto.xml'),(1779,42390,'Bug 42390 – JSP compilation error with nested tagfile tags with variables with \"AT_BEGIN\" scope','Given a tagfile \"test.tag\" in /WEB-INF/tags/t:\n---- begin test.tag ----\n<%@ variable name-given=\"X\" scope=\"AT_BEGIN\" %>\n<jsp:doBody/>\n---- end test.tag ----\nthe following JSP \"testTest.jsp\":\n---- begin testTest.jsp ----\n<t:test><t:test/></t:test>\n---- end testTest.jsp ----\ngives a JSP compilation error:\norg.apache.jasper.JasperException: Unable to compile class for JSP: \nStacktrace:\n        at\norg.apache.jasper.compiler.DefaultErrorHandler.javacError(DefaultErrorHandler.java:85)\n        at\norg.apache.jasper.compiler.ErrorDispatcher.javacError(ErrorDispatcher.java:330)\n        at\norg.apache.jasper.compiler.JDTCompiler.generateClass(JDTCompiler.java:435)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:298)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:277)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:265)\n        at\norg.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:564)\n        at\norg.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:299)\n        at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:315)\n        at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:265)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:803)\n        at\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:269)\n        at\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:188)\n        at\norg.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:210)\n        at\norg.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:174)\n        at\norg.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)\n        at\norg.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:117)\n        at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:542)\n        at\norg.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:108)\n        at\norg.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:151)\n        at\norg.apache.coyote.http11.Http11Processor.process(Http11Processor.java:870)\n        at\norg.apache.coyote.http11.Http11BaseProtocol$Http11ConnectionHandler.processConnection(Http11BaseProtocol.java:665)\n        at\norg.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:528)\n        at\norg.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:81)\n        at\norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:685)\n        at java.lang.Thread.run(Thread.java:613)','2007-05-11 00:59:37','MicroNova YUZU Team','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P1 major','9e59eda','Mark Emlyn David Thomas','2009-05-22 11:46:17','Revert patch for 42390. More tetsing required.','java/org/apache/jasper/compiler/ScriptingVariabler.java'),(1780,46985,'Bug 46985 – Impossible condition in coyote.http11.Http11Processor.process(Socket socket)','coyote.http11.Http11Processor.process(Socket socket)\n...\n\n        int soTimeout = socket.getSoTimeout();\n        int oldSoTimeout = soTimeout;\n\n        int threadRatio = (endpoint.getCurrentThreadsBusy() * 100)\n                / endpoint.getMaxThreads();\n        if (threadRatio > 75) {\n            keepAliveLeft = 1;\n        }\n        \n        if (soTimeout != oldSoTimeout) {\n\nThe above condition will never be true. It looks like the code is trying to reset the timeout if it has not changed, but it will never do so.\n\nBoth the method and the class have a variable called \"socket\" which may be part of the problem - is the method trying to set the instance socket to have the same timeout as the parameter socket, or vice versa?\n\nThe socket parameter should be renamed.\n\nNote that the Javadoc appears to be completely wrong as well.','2009-04-07 16:36:50','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','45c1453','Mark Emlyn David Thomas','2009-05-22 11:30:30','Fix JavaDoc aspects of bug 46985. Based on kkolinko\'s proposed patch.','java/org/apache/coyote/http11/Http11Processor.java'),(1781,47234,'Bug 47234 – serviceStartTime is different in MemberImpl from McastServiceImpl','Hi,\nI\'m using the tribes cluster module in my own application (which has nothing to do with tomcat) and I\'m using the member alive time value to sort all the cluster members.\nThis bug produces the following:\nI have 2 nodes that were started almost at the same time and both nodes claim that the other node was started before them\n\nNODE1:\nRemote members: (-52.63.57.110:4001 ready=true suspect=false failing=false aliveTime=1526)\nLocal member: (-52.63.57.109:4000 ready=true suspect=false failing=false aliveTime=1236)\n\n\nNODE2:\nRemote members: (-52.63.57.109:4000 ready=true suspect=false failing=false aliveTime=2021)\nLocal member: (-52.63.57.110:4001 ready=true suspect=false failing=false aliveTime=1069)\n\n\nMy code do the following:\nMember[] members = groupChannel.getMembers();\nprintRemote(members);\nMember localMember = groupChannel.getLocalMember(true);\nprintLocal(localMember);\n\n\nIn that code (due to timing issues) it should possible the other way around (that every node claim to be started before the other) but not that case.\n\nThe issue occurs because when the McastService is started, it assigns a start  time to the local member. \npublic class McastService .... {\npublic void start(int level) {\n     ....\n    localMember.setServiceStartTime(System.currentTimeMillis());\n    ....\n    impl = new McastServiceImpl(localMember, ....);\n    impl.start(level);\n}\n}\nBut, then it creates and starts a McastServiceImpl which also stores a new serviceStartTime :-(\n \npublic class McastServiceImpl {\nprotected long serviceStartTime;\npublic void start(int level) {\n     ....\n    serviceStartTime = System.currentTimeMillis();\n    ....\n}\n}\n\nSo, we have 2 different start times. Unfortunately both times are used:\nTo get the local member, the impl.getServiceStartTime() is used:\n\npublic class McastService .... {\npublic Member getLocalMember(boolean alive) {\n  if ( alive && localMember != null && impl != null)\n      localMember.setMemberAliveTime(System.currentTimeMillis()-impl.getServiceStartTime());\n    return localMember;\n  }\n}\n\nBut, when the member is transmited throw the network, the MemberImpl.getServiceStartTime() is used.\npublic class MemberImpl .... {\n    public byte[] getData(boolean getalive, boolean reset)  {\n        if ( reset ) dataPkg = null;\n        //look in cache first\n        if ( dataPkg!=null ) {\n            if ( getalive ) {\n                //you\'d be surprised, but System.currentTimeMillis\n                //shows up on the profiler\n                long alive=System.currentTimeMillis()-getServiceStartTime();\n                XByteBuffer.toBytes( (long) alive, dataPkg, TRIBES_MBR_BEGIN.length+4);\n            }\n            return dataPkg;\n        }\n ......\n}\n\nThat produces that weird behaviour.\nIMHO, the fix should be setting the same \"serviceStartTime\" to both components.\n\nThis issue is affecting seriously my code. I would appreciate if you could fix it asap.\nI\'ve verified that the same code is present in trunk repository.\n\nRegards,\nAriel','2009-05-21 07:32:52','Ariel','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Cluster','P2 critical','9fa7640','Filip Hanik','2009-05-21 14:35:40','Consolidate the use of service start time into one local variable https://issues.apache.org/bugzilla/show_bug.cgi?id=47234','java/org/apache/catalina/tribes/membership/McastServiceImpl.java'),(1782,44943,'Bug 44943 – Inconsistent engine name Catalina vs Standalone in server.xml','','2008-05-06 09:41:44','bruce weertman','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Connector:AJP','P2 normal','fd5da5b','Konstantin Kolinko','2009-05-21 00:03:05','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=44943 Reduce copy/paste issues caused by different engine names. Applying the same fix to exe installations of Tomcat.','res/confinstall/server_2.xml'),(1783,47111,'Bug 47111 – do caching the resources like the docu say it (StringManager)','','2009-04-28 08:54:49','Jens Kapitza','Tomcat Developers Mailing List','RESOLVED WONTFIX','Tomcat 6','Catalina','P2 normal','96167ed','Mark Emlyn David Thomas','2009-05-02 19:36:24','Clean up inspired by https://issues.apache.org/bugzilla/show_bug.cgi?id=47111 Remove unused code.','java/org/apache/tomcat/util/res/StringManager.java'),(1784,47124,'Bug 47124 – Run the unit tests as part of the build!!!','','2009-04-30 00:06:39','Marc Guillemot','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 enhancement','05499f2','Mark Emlyn David Thomas','2009-05-02 19:12:17','Changes as a result of https://issues.apache.org/bugzilla/show_bug.cgi?id=47124 Add JUnit to build Provide TestSuite to run all tests','build.properties.default\ntest/build.xml\ntest/org/apache/TestAll.java'),(1785,47086,'Bug 47086 – Tomcat6 64-bit service wrapper should be included in a Tomcat distribution','','2009-04-23 14:47:03','Philip Pickett','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','8d0b34a','Mark Emlyn David Thomas','2009-05-01 20:46:56','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47086 Include the 64-bit windows binaries in the distribution Update the Windows installer to:  - auto detect the platform and install the correct binary for x86/amd64/ia64  - look for a 64-bit JVM on 64-bit platforms  - write the service registry information to the 64 bit section of the registry (rather than Wow6432Node) on 64-bit machines','dist.xml\nres/jvm.ini\nres/tomcat.nsi'),(1786,47080,'Bug 47080 – NPE in RealmBase.findSecurityConstraints when uri is null','','2009-04-22 11:21:13','Folke B.','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 major','f34455d','Mark Emlyn David Thomas','2009-05-01 16:12:09','Fix 47080: NPE in RealmBase.findSecurityConstraints when uri is null https://issues.apache.org/bugzilla/show_bug.cgi?id=47080','java/org/apache/catalina/realm/RealmBase.java'),(1787,47080,'Bug 47080 – NPE in RealmBase.findSecurityConstraints when uri is null','','2009-04-22 11:21:13','Folke B.','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 major','f34455d','Mark Emlyn David Thomas','2009-05-01 16:12:09','Fix 47080: NPE in RealmBase.findSecurityConstraints when uri is null https://issues.apache.org/bugzilla/show_bug.cgi?id=47080','java/org/apache/catalina/realm/RealmBase.java'),(1788,47050,'Bug 47050 – StandardHostValve.status unnecessarily HTML-escapes the error message','','2009-04-19 01:59:15','Roland Illig','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','1ad0501','Mark Emlyn David Thomas','2009-05-01 11:34:43','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47050 Remove unnecessary filtering','java/org/apache/catalina/core/StandardHostValve.java'),(1789,47046,'Bug 47046 – Shutdown does not unregister all MBeans','','2009-04-17 07:59:51','Rob Harrop','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','54b9da9','Mark Emlyn David Thomas','2009-04-29 18:47:53','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=47046 Unregister all MBeans, including when non-default engine names are used (which changes the domain of some of the MBeans)','java/org/apache/catalina/connector/MapperListener.java\njava/org/apache/catalina/mbeans/MBeanUtils.java\njava/org/apache/catalina/mbeans/ServerLifecycleListener.java'),(1790,46999,'Bug 46999 – change scope in ThreadPoolExecutor','change scope','2009-04-08 11:46:38','Jens Kapitza','Tomcat Developers Mailing List','RESOLVED INVALID','Tomcat 6','Catalina','P2 normal','abadf91','Mark Emlyn David Thomas','2009-04-29 06:22:00','Reduce scope - partial application of patch by Jens Kapitza from bug 46999','java/org/apache/tomcat/util/threads/ThreadPoolExecutor.java'),(1791,46925,'Bug 46925 – Nested groups in JNDI realm with non-recursive implementation','','2009-03-27 03:58:28','Stefan Zoerner','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 enhancement','d04dd88','Rainer Jung','2009-04-27 14:54:55','BZ 46925: Improve search for nested roles in JNDIRealm by replacing recursive search with iterative search. Patch provided by Stefan Zoerner.','java/org/apache/catalina/realm/JNDIRealm.java\nwebapps/docs/changelog.xml'),(1792,46538,'Bug 46538 – ETag must differ between compressed and uncompressed resource versions','','2009-01-15 05:19:32','Oliver Schoett','Tomcat Developers Mailing List','RESOLVED WONTFIX','Tomcat 6','Catalina','P2 normal','80e0d52','Mark Emlyn David Thomas','2009-04-17 04:43:34','Revert r765727 (fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=46538) - it fixes the reported issue but introduces other issues.','java/org/apache/coyote/http11/Constants.java\njava/org/apache/coyote/http11/Http11AprProcessor.java\njava/org/apache/coyote/http11/Http11NioProcessor.java\njava/org/apache/coyote/http11/Http11Processor.java'),(1793,46538,'Bug 46538 – ETag must differ between compressed and uncompressed resource versions','','2009-01-15 05:19:32','Oliver Schoett','Tomcat Developers Mailing List','RESOLVED WONTFIX','Tomcat 6','Catalina','P2 normal','8d76d21','Mark Emlyn David Thomas','2009-04-16 15:31:57','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46538 ETag must vary between compressed and uncompressed versions. Based on a patch by Oliver Schoett','java/org/apache/coyote/http11/Constants.java\njava/org/apache/coyote/http11/Http11AprProcessor.java\njava/org/apache/coyote/http11/Http11NioProcessor.java\njava/org/apache/coyote/http11/Http11Processor.java'),(1794,37929,'Bug 37929 – invalidated session causes pageContext methods to fail','javax.servlet.http.HttpSession methods such as getAttribute(),\ngetValue(), getAttributeNames(), getValueNames(), etc, throw an\nIllegalStateException if called on a session that has been\ninvalidated.\n\nSo, with the following code in a JSP page:\n\n    <% \n       session.invalidate(); \n       Object obj = pageContext.findAttribute(\"foo\");\n    %>\n\nAn IllegalStateException is thrown because pageContext.findAttribute()\neventually calls session.getAttribute() on a session that has been\ninvalidated.\n\nThe session that has been invalidated should simply be ignored when a\nmethod needs to process the various scopes (page, request, session,\napplication).\n\nThis impacts the following methods in PageContextImpl:\n\n   public int getAttributesScope(final String name)\n      which calls -> private int doGetAttributeScope(String name);\n   public Object findAttribute(final String name)\n      which calls -> private Object doFindAttribute(String name);\n   public void removeAttribute(final String name)\n      which calls -> private void doRemoveAttribute(String name);\n\nThe fix is to catch IllegalStateException and ignore it when processing\nthe attribute in session scope. The code then simply follows through to \nprocess application scope.\n\nNo need to worry about setAttribute() because it is always invoked\non a specific scope, and the spec already states\nthat java.lang.IllegalStateException must be thrown when called \non an invalidated session.\n\n  pageContext.setAttribute(\"foo\", \"value of foo\", PageContext.SESSION_SCOPE);\n\n  java.lang.IllegalStateException - if the scope is PageContext.SESSION_SCOPE \n  but the page that was requested does not participate in a session or \n  the session has been invalidated.\n\n---------------------------------------------------------------------------\n\nAt the same time, a fix should be done to method \"doRemoveAttribute(String\nname)\" where a try/catch block for Exception appears unnecessary.\n\n    private void doRemoveAttribute(String name){\n        try {\n            removeAttribute(name, PAGE_SCOPE);\n            removeAttribute(name, REQUEST_SCOPE);\n            if( session != null ) {\n                try {\n                    removeAttribute(name, SESSION_SCOPE);\n                } catch (IllegalStateException ex) {\n                    // Session has been invalidated.\n                    // Ignore and fall through to application scope.\n                }\n            }\n            removeAttribute(name, APPLICATION_SCOPE);\n        } catch (Exception ex) {\n            // we remove as much as we can, and\n            // simply ignore possible exceptions\n        }\n    }\n\nHere is a full analysis:\n\nStarting with \'removeAttribute(final String name)\'\n  - we check for null and throw NPE if necessary\n\n  - we call doRemoveAttribute(name)\n  \ndoRemoveAttribute(name)\n  - we call removeAttribute(name, scope) for each scope\n\nremoveAttribute(final String name, final int scope)\n  - this calls doRemoveAttribute(name, scope)\n\ndoRemoveAttribute(name, scope)\n  - page scope: attributes.remove -> won\'t throw an Exception\n  - request scope: request.removeAttribute -> no documented Exception thrown\n  - session scope: throws IllegalStateException if session is null\n  - app scope: context.removeAttribute -> no documented Exception thrown\n\nA null value for name is already checked in removeAttribute(final String name)\nand we throw NPE. So this situation (removing an attr from page or request\nscope throwing an NPE) won\'t happen.\n\nIn doRemoveAttribute(name), we already check on session != null\nbefore calling removeAttribute(name, SESSION_SCOPE). So there\nnormally is no IllegalStateException thrown (except for the invalidated\ncase).\n\nWhen removing an attribute from application (i.e., ServletContext)\nscope, any registered listeners will be notified, but the code that\ndoes that (see\nappserv-webtier/src/java/org/apache/catalina/core/ApplicationContext.\nremoveAttribute()) already catches any Throwable that a listener\nmay throw.\n\nThe try/catch block is therefore unnecessary.\nMoreover, if any of the removal actions from the different scopes could\nhave thrown an exception, each of them would have needed to be wrapped\ninside their own try/catch, so as to ensure that an exception in one\nscope does not cause any of the subsequent removals to be bypassed.\n\ndoRemoveAttribute(String name) has therefore been modified as follows:\n\n    private void doRemoveAttribute(String name){\n            removeAttribute(name, PAGE_SCOPE);\n            removeAttribute(name, REQUEST_SCOPE);\n            if( session != null ) {\n                try {\n                    removeAttribute(name, SESSION_SCOPE);\n                } catch (IllegalStateException ex) {\n                    // Session has been invalidated.\n                    // Ignore and fall through to application scope.\n                }\n            }\n            removeAttribute(name, APPLICATION_SCOPE);\n    }\n\n--------------------------\nChanges done on glassfish. ymmv on jasper for the diffs.\n\n--- PageContextImpl.java	9 Dec 2005 18:54:30 -0000	1.7\n+++ PageContextImpl.java	16 Dec 2005 00:11:21 -0000	1.8\n@@ -452,8 +452,13 @@\n             return REQUEST_SCOPE;\n \n         if (session != null) {\n+            try {\n             if (session.getAttribute(name) != null)\n                 return SESSION_SCOPE;\n+            } catch (IllegalStateException ex) {\n+ 	        // Session has been invalidated.\n+                // Ignore and fall through to application scope.\n+            }\n         }\n \n         if (context.getAttribute(name) != null)\n@@ -495,9 +500,14 @@\n             return o;\n \n         if (session != null) {\n+	    try {\n             o = session.getAttribute(name);\n-            if (o != null)\n-                return o;\n+ 	    } catch (IllegalStateException ex) {\n+ 	        // Session has been invalidated.\n+                // Ignore and fall through to application scope.\n+ 	    }\n+\n+ 	    if (o != null) return o;\n         }\n \n         return context.getAttribute(name);\n@@ -559,19 +569,18 @@\n         }\n     }\n \n-\n     private void doRemoveAttribute(String name){\n-        try {\n             removeAttribute(name, PAGE_SCOPE);\n             removeAttribute(name, REQUEST_SCOPE);\n             if( session != null ) {\n+            try {\n                 removeAttribute(name, SESSION_SCOPE);\n+            } catch (IllegalStateException ex) {\n+                // Session has been invalidated.\n+                // Ignore and fall through to application scope.\n             }\n-            removeAttribute(name, APPLICATION_SCOPE);\n-        } catch (Exception ex) {\n-            // we remove as much as we can, and\n-            // simply ignore possible exceptions\n         }\n+        removeAttribute(name, APPLICATION_SCOPE);\n     }\n \n     public JspWriter getOut() {','2005-12-16 01:58:15','Pierre Delisle','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P3 normal','04cacaf','Mark Emlyn David Thomas','2009-04-16 11:16:43','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=37929 by restoring r357410 that was lost in r379417','java/org/apache/jasper/runtime/PageContextImpl.java'),(1795,46924,'Bug 46924 – Session is lost when application is reloaded through touching the war file','','2009-03-26 16:18:25','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','9b0804e','Mark Emlyn David Thomas','2009-04-15 18:44:49','As a result of https://issues.apache.org/bugzilla/show_bug.cgi?id=46924 make the documentation clearer about what Tomcat will do if a WAR/DIR/context file is deleted or updated and auto-deploy is enabled.','webapps/docs/config/host.xml'),(1796,47013,'Bug 47013 – JSP not compiled at startup when used as a servlet','','2009-04-10 09:26:22','Robert Flaherty','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','c8cbc28','Mark Emlyn David Thomas','2009-04-14 18:16:53','Fix secondary issue reported as part of bug47013','java/org/apache/catalina/core/Constants.java\njava/org/apache/catalina/core/StandardWrapper.java'),(1797,42390,'Bug 42390 – JSP compilation error with nested tagfile tags with variables with \"AT_BEGIN\" scope','Given a tagfile \"test.tag\" in /WEB-INF/tags/t:\n---- begin test.tag ----\n<%@ variable name-given=\"X\" scope=\"AT_BEGIN\" %>\n<jsp:doBody/>\n---- end test.tag ----\nthe following JSP \"testTest.jsp\":\n---- begin testTest.jsp ----\n<t:test><t:test/></t:test>\n---- end testTest.jsp ----\ngives a JSP compilation error:\norg.apache.jasper.JasperException: Unable to compile class for JSP: \nStacktrace:\n        at\norg.apache.jasper.compiler.DefaultErrorHandler.javacError(DefaultErrorHandler.java:85)\n        at\norg.apache.jasper.compiler.ErrorDispatcher.javacError(ErrorDispatcher.java:330)\n        at\norg.apache.jasper.compiler.JDTCompiler.generateClass(JDTCompiler.java:435)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:298)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:277)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:265)\n        at\norg.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:564)\n        at\norg.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:299)\n        at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:315)\n        at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:265)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:803)\n        at\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:269)\n        at\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:188)\n        at\norg.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:210)\n        at\norg.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:174)\n        at\norg.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)\n        at\norg.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:117)\n        at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:542)\n        at\norg.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:108)\n        at\norg.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:151)\n        at\norg.apache.coyote.http11.Http11Processor.process(Http11Processor.java:870)\n        at\norg.apache.coyote.http11.Http11BaseProtocol$Http11ConnectionHandler.processConnection(Http11BaseProtocol.java:665)\n        at\norg.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:528)\n        at\norg.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:81)\n        at\norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:685)\n        at java.lang.Thread.run(Thread.java:613)','2007-05-11 00:59:37','MicroNova YUZU Team','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P1 major','a9fcfd5','Mark Emlyn David Thomas','2009-04-09 12:13:00','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=42390 Correct JSP compilation error with nested tagfile tags with variables with \"AT_BEGIN\" scope Patch provided by Konstantin Kolinko','java/org/apache/jasper/compiler/ScriptingVariabler.java'),(1798,42579,'Bug 42579 – [Patch] JNDIRealm fails to parse absolute names','Active Directory can respond to a query with SearchResult\'s that are not\nrelative.  We discovered this happening with a directory hosted across many\nservers when the userBase was not sufficient to identify a single server.\n\nIn getUserBySearch, JNDIRealm assumes that the SearchResult is relative and goes\nabout creating a DN for the user by appending together the various bits of names\nit gets back.  This is definitely wrong for absolute names which are URL\'s of\nthe form:  ldap://server/encoded_user_dn\n\nI discovered this issue in Tomcat 5.5 and a cursory look at the SVN repo for\nTomcat 6.0 reveals that this bug is also present there.  \n\nI have a patch for this issue which I will attach.','2007-06-04 14:13:14','Brandon DuRette','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','90e8d0d','Mark Emlyn David Thomas','2009-04-09 11:45:30','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=42579 Handle both relative and absolute search results Patch provided by Brandon DuRette','java/org/apache/catalina/realm/JNDIRealm.java'),(1799,46354,'Bug 46354 – LIMIT_BUFFER setting causes arraycopy errors','','2008-12-05 09:01:51','Ed Hill','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 major','78a994a','Mark Emlyn David Thomas','2009-04-09 11:11:46','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46354 ArrayIndexOutOfBoundsException when using org.apache.jasper.runtime.BodyContentImpl.LIMIT_BUFFER=true Pathc provided by Konstantin Kolinko','java/org/apache/jasper/runtime/BodyContentImpl.java'),(1800,46984,'Bug 46984 – Server incorrectly reports a 501 error on bad method name.  Should report 400 error.','','2009-04-07 07:44:46','Jason Smith','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Connector:HTTP','P3 minor','42a093b','Mark Emlyn David Thomas','2009-04-09 09:54:05','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46984 CR & LF in middle of method name should cause a 400 So client sees 400, stop processing the request once we know it is bad','java/org/apache/coyote/http11/Http11AprProcessor.java\njava/org/apache/coyote/http11/Http11NioProcessor.java\njava/org/apache/coyote/http11/Http11Processor.java\njava/org/apache/coyote/http11/InternalAprInputBuffer.java\njava/org/apache/coyote/http11/InternalInputBuffer.java\njava/org/apache/coyote/http11/InternalNioInputBuffer.java\njava/org/apache/coyote/http11/LocalStrings.properties'),(1801,46961,'Bug 46961 – org.apache.catalina.loader.WebappClassLoader throws exception related to Java 6 Bug 6434149','','2009-04-03 07:15:39','Eduardo Torres-Pardo','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','f109fb9','Mark Emlyn David Thomas','2009-04-09 08:54:09','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46961 Avoid tripping over http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6434149','java/org/apache/catalina/loader/WebappClassLoader.java'),(1802,46909,'Bug 46909 – <jsp:plugin> error','<jsp:plugin type=\"applet\"> generates type=\"application/x-java-applet;\" instead of type = \"application/x-java-applet\".\nFirefox with Java-plugin cannot display Java applets because \";\" is added.','2009-03-25 03:07:44','Takao','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 critical','80b90ee','Mark Emlyn David Thomas','2009-04-09 07:46:13','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46909 The \';\' should really only be used if there is a following parameter','java/org/apache/jasper/compiler/Generator.java'),(1803,46562,'Bug 46562 – Reader not closed','SHTML files are locked when using windows. Closing the reader solves the problem.','2009-01-19 08:17:14','Michael Rauner','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Servlets:SSI','P2 normal','6ecc35d','Mark Emlyn David Thomas','2009-04-09 07:06:34','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46562 Close the reader when we are done','java/org/apache/catalina/ssi/SSIServlet.java'),(1804,46998,'Bug 46998 – small fix to TaskThreadFactory','','2009-04-08 11:35:20','Jens Kapitza','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','0c48c98','Mark Emlyn David Thomas','2009-04-09 05:14:40','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46998 Reduce scope Patch provided by Jens Kapitza','java/org/apache/tomcat/util/threads/TaskThreadFactory.java'),(1805,46997,'Bug 46997 – small fix to TaskQueue','','2009-04-08 11:30:59','Jens Kapitza','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','4e1c4b2','Mark Emlyn David Thomas','2009-04-09 05:13:28','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46997 Code clean up Patch provided by Jens Kapitza','java/org/apache/tomcat/util/threads/TaskQueue.java'),(1806,46509,'Bug 46509 – Tomcat 5.5 security example gives j_security_check not available','The problem happens when using the security example (jsp-examples/security/) in tomcat 5.5.\n\nIf the user enters their password incorrectly they are redirected to error.jsp which has a link back to login.jsp. If you use this link and login with the correct credentials login.jsp is reloaded. If you try to login a 2nd time with the correct credentials you receive an error \"The requested resource (/jsp-examples/security/protected/j_security_check) is not available.\"\n\nThe problem is pretty simple. Since login.jsp, index.jsp and error.jsp are all in a secure realm using the link in error.jsp to reach login.jsp triggers authentication which brings up login.jsp as this is specified as <form-login-page> in web.xml.\n\nWhen the user is authenticated they are taken to the page in the realm they requested, which in this case is login.jsp. When they try to login for the 2nd time they get the error because they have already been authenticated and they are trying to load j_security_check (loading index.jsp proves they are logged in).\n\nThis fixes it:\n\nIn /jsp-examples/security/protected/error.jsp\n\nChange:\n<a href=\'<%= response.encodeURL(\"login.jsp\") %>\'>again</a>.\n\nTo:\n<a href=\'<%= response.encodeURL(\"/\") %>\'>again</a>.\n\nOnly checked on Windows and Linux, but since Tomcat is doing what it\'s supposed to do I imagine the example exhibits this behaviour on all platforms.','2009-01-10 19:02:53','Michael Moody','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Webapps:Examples','P5 trivial','008407e','Mark Emlyn David Thomas','2009-04-08 13:15:16','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46509 Use correct link on error page in JSP security example Patch provided by Michael Moody','webapps/examples/jsp/security/protected/error.jsp'),(1807,46991,'Bug 46991 – \"Bytes received \"  problem','use jk module\n\nsubmit some data with post method ,but  \"Bytes received\" always show zero\n\nsee source file ,JkCoyoteHandler.java ,in \"inovke\" method\n\n public int invoke( Msg msg, MsgContext ep )\n        throws IOException {\n        if( ep.isLogTimeEnabled() )\n            ep.setLong( MsgContext.TIMER_PRE_REQUEST, System.currentTimeMillis());\n\n        Request req=ep.getRequest();\n        Response res=req.getResponse();\n\n        if( log.isDebugEnabled() )\n            log.debug( \"Invoke \" + req + \" \" + res + \" \" + req.requestURI().toString());\n\n        res.setNote( epNote, ep );\n        ep.setStatus( MsgContext.JK_STATUS_HEAD );\n        RequestInfo rp = req.getRequestProcessor();\n        rp.setStage(Constants.STAGE_SERVICE);\n        try {\n            adapter.service( req, res );\n        } catch( Exception ex ) {\n            log.info(\"Error servicing request \" + req,ex);\n        }\n        if(ep.getStatus() != MsgContext.JK_STATUS_CLOSED) {\n            res.finish();\n        }\n      \n        req.recycle();         \n        req.updateCounters();   //see this line\n         res.recycle();\n        ep.recycle();\n        if( ep.getStatus() == MsgContext.JK_STATUS_ERROR ) {\n            return ERROR;\n        }\n        ep.setStatus( MsgContext.JK_STATUS_NEW );\n        rp.setStage(Constants.STAGE_KEEPALIVE);\n        return OK;\n    }\n\n the request object recycled,the \"byteRead\" property must be set to zero ,but at the next line ,begin to \"updateCounters\",this may be a bug','2009-04-08 01:37:54','huangfeng','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Manager application','P2 normal','a228c06','Mark Emlyn David Thomas','2009-04-08 12:13:23','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46991 Update the counters before we recycle the request','java/org/apache/jk/server/JkCoyoteHandler.java'),(1808,46990,'Bug 46990 – Synchronize target can be changed midway','','2009-04-07 18:52:10','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','f1fd999','Mark Emlyn David Thomas','2009-04-08 12:08:42','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46990 Various sync issues.','java/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/core/StandardHost.java\njava/org/apache/catalina/tribes/membership/Membership.java\njava/org/apache/catalina/util/InstanceSupport.java\njava/org/apache/catalina/util/LifecycleSupport.java'),(1809,46988,'Bug 46988 – JMXAccessorTask String constants should be final','','2009-04-07 17:18:48','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','81ebe8f','Mark Emlyn David Thomas','2009-04-08 11:28:08','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46988 Make constants final','java/org/apache/catalina/ant/jmx/JMXAccessorTask.java'),(1810,46986,'Bug 46986 – org.apache.jasper.Constants public arrays are mutable','There are various public String arrays in org.apache.jasper.Constants. Although the array variables are final, any code can change any of the array constants.','2009-04-07 17:14:51','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','f497f12','Mark Emlyn David Thomas','2009-04-08 11:25:05','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46986 Find bugs was complaining although these have not been reported as causing issues for any users.','java/org/apache/jasper/Constants.java\njava/org/apache/jasper/compiler/PageInfo.java\njava/org/apache/jasper/xmlparser/ParserUtils.java'),(1811,46985,'Bug 46985 – Impossible condition in coyote.http11.Http11Processor.process(Socket socket)','coyote.http11.Http11Processor.process(Socket socket)\n...\n\n        int soTimeout = socket.getSoTimeout();\n        int oldSoTimeout = soTimeout;\n\n        int threadRatio = (endpoint.getCurrentThreadsBusy() * 100)\n                / endpoint.getMaxThreads();\n        if (threadRatio > 75) {\n            keepAliveLeft = 1;\n        }\n        \n        if (soTimeout != oldSoTimeout) {\n\nThe above condition will never be true. It looks like the code is trying to reset the timeout if it has not changed, but it will never do so.\n\nBoth the method and the class have a variable called \"socket\" which may be part of the problem - is the method trying to set the instance socket to have the same timeout as the parameter socket, or vice versa?\n\nThe socket parameter should be renamed.\n\nNote that the Javadoc appears to be completely wrong as well.','2009-04-07 16:36:50','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','6bfbbcb','Mark Emlyn David Thomas','2009-04-08 10:58:20','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46985 There is still some optimisation possible but I think this is a good balance between clarity and oprimisation.','java/org/apache/coyote/http11/Http11Processor.java'),(1812,46967,'Bug 46967 – ManagerBase.setRandomFile error handling fix','On some platforms (z/OS for sure), the device file /dev/urandom can pass the \"f.exists()\" test, but throws an IOException of some kind when trying to open it.  The current code in ManagerBase.setRandomFile() doesn\'t handle this, which results in EVERY call to getRandom() to try again and log the error  \"Failed to close randomIS\".\n\nThe following changes to the method will add proper error handling to correct this (my changes marked \"// kjw\")\n\n    public void setRandomFile( String s ) {\n        // as a hack, you can use a static file - and genarate the same\n        // session ids ( good for strange debugging )\n        if (Globals.IS_SECURITY_ENABLED){\n            randomIS = (DataInputStream)AccessController.doPrivileged(new PrivilegedSetRandomFile());          \n        } else {\n            try{\n                devRandomSource=s;\n                File f=new File( devRandomSource );\n                if( ! f.exists() ) return;\n                randomIS= new DataInputStream( new FileInputStream(f));\n                randomIS.readLong();\n                if( log.isDebugEnabled() )\n                    log.debug( \"Opening \" + devRandomSource );\n            } catch( IOException ex ) {\n            	log.debug(\"Error reading \" + devRandomSource, ex); //kjw\n            	if (randomIS != null) {  // kjw: if opened\n	                try {\n	                    randomIS.close();\n	                } catch (Exception e) {\n	                    log.warn(\"Failed to close randomIS.\");\n	                }\n            	}                       // kjw \n            	devRandomSource = null; // kjw: don\'t try again automatically\n                randomIS=null;\n            }\n        }\n    }','2009-04-03 18:57:28','Kirk Wolf','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','243aa86','Mark Emlyn David Thomas','2009-04-08 08:59:21','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46967 and make behaviour consistent when running under a security manager. Based on a patch provided by Kirk Wolf','java/org/apache/catalina/session/ManagerBase.java'),(1813,46958,'Bug 46958 – manager XML interface hard-coded path in XSL transformation','','2009-04-02 16:55:36','Varun','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Manager application','P2 normal','a9a58fb','Mark Emlyn David Thomas','2009-04-08 07:40:08','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46958 Allow XML status to work irrespective of context path','java/org/apache/catalina/manager/Constants.java'),(1814,46933,'Bug 46933 – Using Java 1.5 in StringManager','','2009-03-27 15:34:14','Jens Kapitza','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','23c47da','Mark Emlyn David Thomas','2009-04-08 07:08:17','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46933 Simplify StringManager using Java 5 features. Based on a patch by Jens Kapitza. Include a test case to ensure simplification is OK for null input','java/org/apache/tomcat/util/res/StringManager.java\ntest/org/apache/tomcat/util/res/TestStringManager.java'),(1815,46982,'Bug 46982 – AccessLogValve reports correct time but incorrect offset following Spring DST transition.','This is a problem with AccessLogValve for tc5.5 as well as tc6.0 on all platforms.\n\nWith the system clock on my linux machine (Ubuntu in my case) to just before the US time change on March 8, I started Tomcat 5.5 and see the following messages in my Tomcat access log after accessing Tomcat JSP example pages at the time of DST transition:\n\n-: - [08/Mar/2009:01:56:20 -0700] GET /jsp-examples/jsp2/simpletag/book.jsp HTTP/1.1 200 1738 1 - {http-8080-Processor24}\n-: - [08/Mar/2009:03:01:22 -0700] GET /jsp-examples/jsp2/tagfiles/hello.jsp HTTP/1.1 200 2213 68 - {http-8080-Processor25}\n\nNote the offset of \"-0700\" both before and after DST transition.  Following a Tomcat restart the offset is correct:\n\n-: - [08/Mar/2009:03:19:42 -0600] GET /jsp-examples/jsp2/jspx/basic.jspx HTTP/1.1 200 1919 780 - {http-8080-Processor25}\n-: - [08/Mar/2009:03:19:59 -0600] GET /jsp-examples/jsp2/jspx/svgexample.html HTTP/1.1 200 2239 4 - {http-8080-Processor25}\n-: - [08/Mar/2009:03:19:59 -0600] GET /jsp-examples/jsp2/jspx/textRotate.jpg HTTP/1.1 200 26729 3 - {http-8080-Processor25}\n\n\nBTW, I ran the tzupdater before my tests:\n\nlinwin01-512> java -jar tzupdater.jar -V\ntzupdater version 1.3.12-b01\nJRE time zone data version: tzdata2009a\nEmbedded time zone data version: tzdata2009a\n\n\n\nThe problem is in the org.apache.catalina.valves.AccessLogValve which contains the following in its start method:\n\n\n// Initialize the timeZone, Date formatters, and currentDate\ntimezone = TimeZone.getDefault();\ntimeZoneNoDST = calculateTimeZoneOffset(timezone.getRawOffset());\nCalendar calendar = Calendar.getInstance(timezone);\nint offset = calendar.get(Calendar.DST_OFFSET);\ntimeZoneDST = calculateTimeZoneOffset(timezone.getRawOffset()+offset);\n\n\nBased on what I’ve seen, “int offset = calendar.get(Calendar.DST_OFFSET);” returns 0 when the current time is not in Daylight savings time and (for my timezone) 3600000 (60 * 60 * 1000) when the current time is in Daylight Savings.  It looks like the code assumes this is always the offset for Daylight Savings for the current timezone.  I have no idea if there are some locations/timezones where Daylight Savings Time does not have a 1 hour offset.\n\nBecause of this, if in a non-DST time period, timeZoneDST and timeZoneNoDST are set to the same value.  If in a DST time period, I believe they are set correctly so that the transition in Autumn works correctly.  I think the only problem is when moving ahead in Springtime (unless the software has been running for 6 months or so which caused the offset to be set correctly).','2009-04-07 07:32:55','Philip Pickett','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','360f8eb','Mark Emlyn David Thomas','2009-04-08 06:17:59','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46982 Use DST offset not current offset (which will be 0 when DST is not being used)','java/org/apache/catalina/valves/AccessLogValve.java'),(1816,46599,'Bug 46599 – Tomcat doc. should acknowledge longstanding Daemon bug','','2009-01-25 17:07:32','Trev','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P2 normal','d51d7f5','Mark Emlyn David Thomas','2009-04-07 15:36:18','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46599 Document known DAEMON issue','webapps/docs/windows-service-howto.xml'),(1817,46923,'Bug 46923 – AJP/1.3 Connector code/documentation mismatch','','2009-03-26 12:09:45','John Allison','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 normal','4788dc9','Mark Emlyn David Thomas','2009-03-27 08:25:56','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46923 Fully document protocol options for AJP.','webapps/docs/config/ajp.xml'),(1818,41606,'Bug 41606 – The jspInit method is called twice.','The problem is:\nThe jspInit method is called twice.\n\nThe definition is:\n-The JSP background compilations are enable.\n (In default web.xml, define checkInterval and define development false.)\n-Define the JSP with <servlet> and <load-on-startup> tag in web.xml.\n\nThe proposing:\norg/apache/jasper/compiler/Compiler.java \n----\npublic void compile(boolean compileClass, boolean jspcMode)\n    throws FileNotFoundException, JasperException, Exception\n{\n....\n    if( compileClass ) {\n        File targetFile = new File(ctxt.getClassFileName());\n        if (targetFile.exists()) {\n            long targetLastModified = targetFile.lastModified();\n            if (jsw != null) {\n                jsw.setServletClassLastModifiedTime(targetLastModified);\n            }   \n        }\n    }\n}// last of the method.\n----\n\nRegards,\nYuichiro','2007-02-13 20:46:54','Suzuki Yuichiro','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 normal','f36a2c4','Mark Emlyn David Thomas','2009-03-27 05:42:47','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=41606 Prevent double init() of JSP Patch provided by Chris Halstead','java/org/apache/jasper/compiler/Compiler.java'),(1819,46915,'Bug 46915 – Unable to get ResourceBundle keys in Tomcat 6','','2009-03-26 03:27:15','Kapil','Tomcat Developers Mailing List','RESOLVED INVALID','Tomcat 6','Servlet & JSP API','P2 normal','3cfc9d3','Mark Emlyn David Thomas','2009-03-26 10:28:11','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46915 When resolving ResourceBundle properties, don\'t claim to have resolved the property unless we really have resolved it.','java/javax/el/ResourceBundleELResolver.java'),(1820,46822,'Bug 46822 – Avoid redundant instantiations in StandardContext','','2009-03-08 22:56:01','Anthony Whitford','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P3 normal','b10d9da','Mark Emlyn David Thomas','2009-03-26 08:58:40','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46822 Avoid redundant object creation Patch provided by Anthony Whitford','java/org/apache/catalina/core/StandardContext.java'),(1821,46866,'Bug 46866 – Seed from current time is useless','fgrep -r \'new Random(System.currentTimeMillis())\' .\n\nGives 7 places where Random initialized with seed = currentTimeMillis. This is unnecessary, because better seed initialization happens in the default Random constructor.','2009-03-16 21:34:33','Stepan Koltsov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','fae26ce','Mark Emlyn David Thomas','2009-03-26 07:06:06','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46866 Better init of Random','java/org/apache/catalina/core/StandardServer.java\njava/org/apache/catalina/tribes/util/UUIDGenerator.java\ntest/org/apache/catalina/tribes/demos/LoadTest.java\ntest/org/apache/catalina/tribes/demos/MapDemo.java\ntest/org/apache/catalina/tribes/test/channel/TestDataIntegrity.java\ntest/org/apache/catalina/tribes/test/channel/TestMulticastPackages.java\ntest/org/apache/catalina/tribes/test/channel/TestRemoteProcessException.java\ntest/org/apache/catalina/tribes/test/channel/TestUdpPackages.java\ntest/org/apache/catalina/tribes/test/io/TestSenderConnections.java'),(1822,46875,'Bug 46875 – CometConnectionManagerValve: concurrent access on session object when calling HttpSession.invalidate()','When calling invalidate() on an valid HttpSession object CometConnectionManagerValve methods sessionDestroy(HttpSessionEvent se) and event(Request request, Response response, CometEvent event) are called concurrently.\n\nSo either a CometEvent with EventType.END and EventSubType.SESSION_END is never signaled via sessionDestroyed(...) or the HttpSession object has become invalid and the attribute holding comet requests can not be set or removed via event(...).\n\nI have configured CometConnectionManagerValve as a Valve element in context.xml and also as a Listener element in my applications web.xml.\n\n\n\nsee this stacktrace \'sessionDestroy() was a bit faster\':\n\nAn exception or error occurred in the container during the request processing\njava.lang.IllegalStateException: removeAttribute: Session already invalidated\n	at org.apache.catalina.session.StandardSession.removeAttribute(StandardSession.java:1206)\n	at org.apache.catalina.session.StandardSession.removeAttribute(StandardSession.java:1181)\n	at org.apache.catalina.session.StandardSessionFacade.removeAttribute(StandardSessionFacade.java:140)\n	at org.apache.catalina.valves.CometConnectionManagerValve.event(CometConnectionManagerValve.java:335)\n	at org.apache.catalina.core.StandardHostValve.event(StandardHostValve.java:179)\n	at org.apache.catalina.valves.ValveBase.event(ValveBase.java:200)\n	at org.apache.catalina.core.StandardEngineValve.event(StandardEngineValve.java:128)\n	at org.apache.catalina.connector.CoyoteAdapter.event(CoyoteAdapter.java:198)\n	at org.apache.coyote.http11.Http11NioProcessor.event(Http11NioProcessor.java:750)\n	at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.event(Http11NioProtocol.java:653)\n	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:2081)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:885)\n	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:907)\n	at java.lang.Thread.run(Thread.java:637)','2009-03-19 02:15:04','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED WONTFIX','Tomcat 6','Catalina','P2 major','08f7a5f','Mark Emlyn David Thomas','2009-03-25 14:57:43','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46875 Add try/catch to session access in case session has been invalidated','java/org/apache/catalina/valves/CometConnectionManagerValve.java'),(1823,45332,'Bug 45332 – Encoding issue - Admin password created by Windows installer','','2008-07-03 03:02:50','Michael Bürschgens','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','0b8d349','Mark Emlyn David Thomas','2009-03-25 13:49:14','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45332 When reading tomcat-users.xml try to ensure the digester supports the java encoding names. The windows installer will often use these names. The JVM does this by default. If the endorsed mechanism is used, an alternative parser may not support the Java encodings. This fix will only work for xerces.','java/org/apache/catalina/realm/LocalStrings.properties\njava/org/apache/catalina/realm/MemoryRealm.java\njava/org/apache/catalina/users/LocalStrings.properties\njava/org/apache/catalina/users/MemoryUserDatabase.java'),(1824,46816,'Bug 46816 – /status/all fails if using PersistentManager','conf/context.xml\n<?xml version=\'1.0\' encoding=\'utf-8\'?>\n<Context reloadable=\"false\" swallowOutput=\"false\"\n     cacheMaxSize=\"10240\" cachingAllowed=\"true\" cacheTTL=\"1800000\" >\n  <Manager className=\"org.apache.catalina.session.PersistentManager\" \n           saveOnRestart=\"false\">\n  </Manager>\n</Context>\n\n\njavax.management.AttributeNotFoundException:  Cannot find attribute sessionMaxAliveTime for org.apache.catalina.session.PersistentManager@d3ade7\n	org.apache.tomcat.util.modeler.ManagedBean.getGetter(ManagedBean.java:490)\n	org.apache.tomcat.util.modeler.BaseModelMBean.getAttribute(BaseModelMBean.java:180)\n	com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.getAttribute(DefaultMBeanServerInterceptor.java:666)\n	com.sun.jmx.mbeanserver.JmxMBeanServer.getAttribute(JmxMBeanServer.java:638)\n	org.apache.catalina.manager.StatusTransformer.writeManager(StatusTransformer.java:717)\n	org.apache.catalina.manager.StatusTransformer.writeContext(StatusTransformer.java:669)\n	org.apache.catalina.manager.StatusTransformer.writeDetailedState(StatusTransformer.java:594)\n	org.apache.catalina.manager.StatusManagerServlet.doGet(StatusManagerServlet.java:299)\n	javax.servlet.http.HttpServlet.service(HttpServlet.java:617)\n	javax.servlet.http.HttpServlet.service(HttpServlet.java:717)','2009-03-06 10:49:44','Eric Abbott','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Manager application','P2 normal','d45a69f','Mark Emlyn David Thomas','2009-03-07 11:54:46','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46816 Align mbean descriptor attributes with implementations','java/org/apache/catalina/session/mbeans-descriptors.xml'),(1825,46807,'Bug 46807 – Cannot disable jsp tag pooling','Set jvm param -Dorg.apache.jasper.runtime.JspFactoryImpl.USE_POOL=false.\nIn web.xml set enablePooling to false.\n\nCreated a custom tag that extends \nimport javax.servlet.jsp.tagext.BodyTagSupport;\n\n\nVerified by adding member field\nprivate long creation_time = System.currentTimeMillis();\n\ninside doInitBody()...\n  public void doInitBody() {\n    System.out.println(\"creation_time=\"+ creation_time);\n  }','2009-03-05 12:17:24','Eric Abbott','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','9effe17','Mark Emlyn David Thomas','2009-03-07 11:08:41','Fix remainder of https://issues.apache.org/bugzilla/show_bug.cgi?id=46807 Make it clear that enablePooling is a compilation, not a runtime option.','conf/web.xml\nwebapps/docs/jasper-howto.xml'),(1826,46807,'Bug 46807 – Cannot disable jsp tag pooling','Set jvm param -Dorg.apache.jasper.runtime.JspFactoryImpl.USE_POOL=false.\nIn web.xml set enablePooling to false.\n\nCreated a custom tag that extends \nimport javax.servlet.jsp.tagext.BodyTagSupport;\n\n\nVerified by adding member field\nprivate long creation_time = System.currentTimeMillis();\n\ninside doInitBody()...\n  public void doInitBody() {\n    System.out.println(\"creation_time=\"+ creation_time);\n  }','2009-03-05 12:17:24','Eric Abbott','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','c51536e','Mark Emlyn David Thomas','2009-03-07 11:00:22','Partial fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=46807 Correctly document org.apache.japser.runtime.JspFactoryImpl.USE_POOL','webapps/docs/jasper-howto.xml'),(1827,44988,'Bug 44988 – JPDA_OPTS in catalina.sh / catalina.bat is using old JDWP semantics','','2008-05-13 06:10:34','Cédrik LIME','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Native:Integration','P4 minor','19834ca','Mark Emlyn David Thomas','2009-03-03 17:20:16','Update docs to reflect changes for bug 44988','bin/catalina.bat\nbin/catalina.sh'),(1828,46666,'Bug 46666 – Why is disableUploadTimeout and KeepAliveTimeout correlated in Http11 Connector?','In Http11Processor.java\n\n        while (started && !error && keepAlive) {\n\n            // Parsing the request header\n            try {\n                if (!disableUploadTimeout && keptAlive) {\n                    if (keepAliveTimeout > 0) {\n                        socket.setSoTimeout(keepAliveTimeout);\n                    }\n                    else if (soTimeout > 0) {\n                        socket.setSoTimeout(soTimeout);\n                    }\n                }\n                inputBuffer.parseRequestLine();\n                request.setStartTime(System.currentTimeMillis());\n                keptAlive = true;\n                if (!disableUploadTimeout) {\n                    socket.setSoTimeout(timeout);\n                }\n\ndisableUploadTimeout  - This flag allows the servlet container to use a different, longer connection timeout while a servlet is being executed, which in the end allows either the servlet a longer amount of time to complete its execution, or a longer timeout during data upload. If not specified, this attribute is set to \"true\".\n\nThe code above is waiting on a new Http Request and precedes the servlet processing logic.  It seems odd to me that I must set disableTimeout to false to get my keepAliveTimeout set.  \n\nTo set keepalivetimout, I must implicitely enable upload timeout whether I need it or not.  It seems to me that the disableTimeout is unneccessary in the following line\n\nif (!disableUploadTimeout && keptAlive) {\n\nDo you agree with this?\n\nThanks for the insight','2009-02-04 08:28:34','Doug Drechsel','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 normal','ac6369a','Mark Emlyn David Thomas','2009-02-13 11:17:54','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46666 keepAliveTimeout should always be used regardless of setting of disableUploadTimeout','java/org/apache/coyote/http11/Http11Processor.java'),(1829,46696,'Bug 46696 – Missing AL headers','The following files in tomcat-trunk don\'t have AL headers; as far as I can tell, they should:\n\nmodules/jdbc-pool/sign.sh\nmodules/jdbc-pool/test/org/apache/tomcat/jdbc/test/StarvationTest.java','2009-02-11 09:41:23','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Servlet & JSP API','P2 normal','3b1b7b3','Mark Emlyn David Thomas','2009-02-12 09:34:26','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46696 Add missing license headers','modules/jdbc-pool/sign.sh\nmodules/jdbc-pool/test/org/apache/tomcat/jdbc/test/StarvationTest.java'),(1830,46695,'Bug 46695 – Missing svn props for TestMulticastPackages.java','Following command could be applied to tomcat-trunk to fix a missing SVN property:\n\nsvn ps svn:eol-style native test/org/apache/catalina/tribes/test/channel/TestMulticastPackages.java','2009-02-11 09:21:45','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','131e884','Mark Emlyn David Thomas','2009-02-12 06:44:37','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46695 Patch provided by sebb',''),(1831,46683,'Bug 46683 – Typo on french´s localization file','There´s a typo on french´s localization file, here:\njava/org/apache/catalina/loader/LocaStrings_fr.properties\n\nShould be: LocalStrings_fr.properties\n               ^Here','2009-02-09 10:37:55','Flavio Crispim','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 trivial','b6138bb','Mark Emlyn David Thomas','2009-02-12 06:35:11','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46683 Correct typo in filename','java/org/apache/catalina/loader/LocaStrings_fr.properties\njava/org/apache/catalina/loader/LocalStrings_fr.properties'),(1832,39396,'Bug 39396 – OPTIONS request on directory with no default file reports an incorrect list of allowed HTTP verbs','When an \"options\" http request is made to Tomcat to a directory that has no \ndefault file (like index.jsp) in it, Tomcat reports a full list of allowed \nverbs, when in fact, most of them are NOT allowed.  For example, a request to \na generic img directory:\n\nOPTIONS /img/ HTTP/1.0\n	Cookie: JSESSIONID=C46C2E18BE95AD91828C9370CBDF0AF2\n	Content-Length: 0\n	Accept: */*\n	Accept-Language: en-us\n	Connection: Keep-Alive\n	User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; \nSV1; .NET CLR 1.1\n	4322; InfoPath.1)\n\nReturns:\n\nHTTP/1.1 200 OK\nServer: Apache-Coyote/1.1\nAllow: GET, HEAD, POST, PUT, DELETE, TRACE, OPTIONS\nContent-Length: 0\nDate: Mon, 24 Apr 2006 15:11:16 GMT\nConnection: close\n\nWhich shows several destructive options available (PUT, DELETE).  But a \nrequest to DELETE or PUT (correctly) returns a 403 FORBIDDEN result:\n\nDELETE /img/ HTTP/1.0\n	Cookie: JSESSIONID=C46C2E18BE95AD91828C9370CBDF0AF2\n	Content-Length: 0\n	Accept: */*\n	Accept-Language: en-us\n	Connection: Keep-Alive\n	User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; \nSV1; .NET CLR 1.1\n	4322; InfoPath.1)\n\nReturns:\nHTTP/1.1 403 Forbidden\nServer: Apache-Coyote/1.1\nContent-Type: text/html;charset=utf-8\nContent-Length: 964\nDate: Mon, 24 Apr 2006 15:12:31 GMT\nConnection: close\n\nBecause the initial OPTIONS request returns a list containing dangerous verbs, \nthe directory will be flagged as a serious security vulnerability by most \nscanners (a false positive).\n\nThe issue DOES NOT occur when the directory HAS a default file in it:\nOPTIONS /user_management/ HTTP/1.0\n	Cookie: JSESSIONID=C46C2E18BE95AD91828C9370CBDF0AF2\n	Content-Length: 0\n	Accept: */*\n	Accept-Language: en-us\n	Connection: Keep-Alive\n	User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; \nSV1; .NET CLR 1.1\n	4322; InfoPath.1)\n\nReturns:\n\nHTTP/1.1 200 OK\nServer: Apache-Coyote/1.1\nSet-Cookie: JSESSIONID=BC992F0C86E2BCBD0A2E5F1B3A12C50C; Path=/\nContent-Type: text/html;charset=ISO-8859-1\nDate: Mon, 24 Apr 2006 15:14:27 GMT\nConnection: close','2006-04-24 15:15:57','Sean Molloy','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Connector:Coyote','P2 normal','9752018','Mark Emlyn David Thomas','2009-02-09 15:13:14','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=39396 Exclude TRACE in OPTIONS response by default. Include it where we know it is enabled.','java/org/apache/catalina/connector/RequestFacade.java\njava/org/apache/catalina/servlets/DefaultServlet.java'),(1833,39013,'Bug 39013 – Incorrect use of docBase from XML Context file deployment','','2006-03-17 13:07:53','Nic Daniau','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 minor','bee2396','Mark Emlyn David Thomas','2009-02-09 14:39:40','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=39013 When testing for invalid docBase, test for an exact match with the appBase dir','java/org/apache/catalina/startup/HostConfig.java'),(1834,38570,'Bug 38570 – if docBase path contains \"webapps\", a backslash is inserted','','2006-02-08 15:46:45','Edith','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','8d2b8ff','Mark Emlyn David Thomas','2009-02-09 14:05:44','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=38570 When checking docBase against appBase, make sure we check for an exact match against the appBase','java/org/apache/catalina/startup/ContextConfig.java'),(1835,38553,'Bug 38553 – Wrong HTTP code for failed CLIENT-CERT authentication','server.xml:\n===========\nI set clientAuth to \"want\"\n\ntomcat-user.xml:\n================\nI create a role and an user with the ssl certificate metadata\n\nweb.xml:\n========\nFor a private URL on my webseite, I create a security constraint like this one:\n\n <security-constraint>\n	<web-resource-collection>\n	<web-resource-name>App</web-resource-name>\n	    <url-pattern>/protected.jsp</url-pattern>\n	</web-resource-collection>\n	<auth-constraint>\n	    <role-name>tomcat</role-name>\n	</auth-constraint>\n	<user-data-constraint>\n	    <transport-guarantee>CONFIDENTIAL</transport-guarantee>\n	</user-data-constraint>\n    </security-constraint>\n\n    <login-config>\n      <auth-method>CLIENT-CERT</auth-method> \n    </login-config>\n\n    <security-role>\n      <role-name>tomcat</role-name>\n    </security-role>\n\nMy results: (I try to access the restricted JSP-Page)\n===========\n1) When there is the RIGHT client certificate in the browser keystore:\nit works :-)\n\n2) When there is the WRONG client certificate I get:\n\n  HTTP Status 401 - Cannot authenticate with the provided credentials\n  (this is ok, too)\n\n3) When there is NO client certificate I get:\n\n  HTTP Status 400 - No client certificate chain in this request\n\n400 usually stands for a bad request or bad syntax. \n\nThe Bug:\n========\nIn case 3 I expect to get HTTP Status 401.','2006-02-07 16:54:17','Markus','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Connector:Coyote','P2 normal','156f1ca','Mark Emlyn David Thomas','2009-02-04 05:43:10','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=38553 A lack of certs is normal if the user doesn\'t have a trusted cert. Return 401, not 400 in this case.','java/org/apache/catalina/authenticator/SSLAuthenticator.java'),(1836,38197,'Bug 38197 – taglib pool bug when tag is used with jsp:attribute','','2006-01-09 15:53:09','Diego Belfer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 major','2824a70','Mark Emlyn David Thomas','2009-02-04 05:26:28','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=38197 Take account of jsp:attribute elements when naming tag pools','java/org/apache/jasper/compiler/Generator.java'),(1837,46606,'Bug 46606 – WebdavServlet','','2009-01-26 07:18:21','Robert Jakob','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','f0bd732','Mark Emlyn David Thomas','2009-02-04 02:00:03','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46606 Max max depth limit configurable','java/org/apache/catalina/servlets/WebdavServlet.java'),(1838,46600,'Bug 46600 – maxKeepAliveRequests description in wrong section of documentation','','2009-01-25 23:31:41','Kirk True','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P2 trivial','0c8634e','Mark Emlyn David Thomas','2009-02-04 01:53:13','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46600 Correctly document maxKeepAliveRequests','webapps/docs/config/http.xml'),(1839,46498,'Bug 46498 – Client certificate is not requested when clientAuth is false and resource is protected by security constraint','Tomcat configuration manual states that clientAuth can be false and that \n\"A false value (which is the default) will not require a certificate chain unless the client requests a resource protected by a security constraint that uses CLIENT-CERT authentication. See the SSL HowTo for an example.\"\n\nNote: The SSL Howto doesn\'t have a \"false\" option described for clientAuth.\n\nAnyway, Tomcat doesn\'t request a client certificate when clienAuth is false and the resource is protect by a security constraint like this:\n  <security-constraint>\n    <web-resource-collection>\n      <web-resource-name>Certificados</web-resource-name>\n      <url-pattern>/Certificados/*</url-pattern>\n    </web-resource-collection>\n    <user-data-constraint>\n      <transport-guarantee>CONFIDENTIAL</transport-guarantee>\n    </user-data-constraint>\n  </security-constraint>\n\n  <login-config>\n    <auth-method>CLIENT-CERT</auth-method>\n  </login-config>\n\nTIA,\nPedro','2009-01-08 15:32:38','Pedro Ortigão','Tomcat Developers Mailing List','RESOLVED INVALID','Tomcat 6','Catalina','P2 major','43b59a7','Mark Emlyn David Thomas','2009-01-30 00:35:25','Minor clarification as a result of bug 46498','webapps/docs/ssl-howto.xml'),(1840,46564,'Bug 46564 – .tagx files don\'t compile if the document and page encoding casing differs','','2009-01-20 00:34:11','Daan Kets','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P3 normal','7d7f757','Mark Emlyn David Thomas','2009-01-30 00:30:23','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46564 Encoding test should be case insensitive','java/org/apache/jasper/compiler/Validator.java'),(1841,46563,'Bug 46563 – NIO protocol states default pollerThreadCount is 1, actually is # processors','pollerThreadCount\'s description is:\n\n    The number of threads to be used to run for the polling events. \n    Default value is 1. Can\'t see a reason to go above that. But \n    experiment and find your own results.\n\nThe code appears to default to Runtime.getRuntime().availableProcessors() which may be one, but in many cases is not.','2009-01-19 21:46:16','Kirk True','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P2 trivial','c0dc47f','Mark Emlyn David Thomas','2009-01-30 00:05:25','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46563','webapps/docs/config/http.xml'),(1842,46339,'Bug 46339 – Recursive tag files with JspFragment attributes fails','','2008-12-04 07:03:54','Jens Askengren','Tomcat Developers Mailing List','RESOLVED INVALID','Tomcat 6','Servlet & JSP API','P2 critical','5e4063c','Mark Emlyn David Thomas','2009-01-12 16:29:40','Revert r733072 after feedback from EG that original INVALID for https://issues.apache.org/bugzilla/show_bug.cgi?id=46339 was correct.','java/org/apache/jasper/compiler/Generator.java\njava/org/apache/jasper/runtime/JspContextWrapper.java'),(1843,46339,'Bug 46339 – Recursive tag files with JspFragment attributes fails','','2008-12-04 07:03:54','Jens Askengren','Tomcat Developers Mailing List','RESOLVED INVALID','Tomcat 6','Servlet & JSP API','P2 critical','abff9ca','Mark Emlyn David Thomas','2009-01-09 10:53:50','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46339 Before the invocation of a fragment, AT_BEGIN and NESTED variables should be copied from the current JspContext to the JspContext of the fragment (*instead* of the JspContext of the calling page or tag file). Patch provided by kinman@a.o TCK passes with this patch applied.','java/org/apache/jasper/compiler/Generator.java\njava/org/apache/jasper/runtime/JspContextWrapper.java'),(1844,37515,'Bug 37515 – smap not generated by JspC when used from Ant for precompilation','I\'ve noticed that in Tomcat 5.5.12 one can pass the JspC task an smapSuppressed\nattribute.\n\nUnfortunately, it appears that one *still* cannot do source-level debugging of\nJSPs when they are precompiled via JspC with smapSuppressed=false in 5.5.12.\n\nNote that the same JSP are source-level debuggable in exactly the same set up if\nthey are compiled on the fly by Tomcat.\n\nUnfortunately I am baffled as to why this does not work...','2005-11-15 22:57:47','Jess Holle','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 normal','0cde120','Mark Emlyn David Thomas','2009-01-05 18:50:55','Reported as part of https://issues.apache.org/bugzilla/show_bug.cgi?id=37515 Add options for Java 1.6 and 1.7','java/org/apache/jasper/compiler/JDTCompiler.java'),(1845,46471,'Bug 46471 – Compiled tag files from different tag libraries share the same package','','2009-01-04 16:12:40','Konstantin Kolinko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','3aaac85','Mark Emlyn David Thomas','2009-01-05 14:20:11','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46471 Use the URL of the JAR as well as the path within the JAR to identify a tag file to keep tag file definitions unique.','java/org/apache/jasper/compiler/ImplicitTagLibraryInfo.java\njava/org/apache/jasper/compiler/JspUtil.java\njava/org/apache/jasper/compiler/ParserController.java\njava/org/apache/jasper/compiler/TagFileProcessor.java\njava/org/apache/jasper/compiler/TagLibraryInfoImpl.java'),(1846,37515,'Bug 37515 – smap not generated by JspC when used from Ant for precompilation','I\'ve noticed that in Tomcat 5.5.12 one can pass the JspC task an smapSuppressed\nattribute.\n\nUnfortunately, it appears that one *still* cannot do source-level debugging of\nJSPs when they are precompiled via JspC with smapSuppressed=false in 5.5.12.\n\nNote that the same JSP are source-level debuggable in exactly the same set up if\nthey are compiled on the fly by Tomcat.\n\nUnfortunately I am baffled as to why this does not work...','2005-11-15 22:57:47','Jess Holle','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 normal','9083a85','Mark Emlyn David Thomas','2009-01-03 19:21:37','Add comment as a result of bug 37515','webapps/docs/jasper-howto.xml'),(1847,46462,'Bug 46462 – JSPWiki JSP compilation prevented by org.apache.jasper.Constants.JSP_PACKAGE_NAME','','2009-01-01 20:29:15','Andrew Jaquith','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 major','1ca03ff','Mark Emlyn David Thomas','2009-01-02 06:05:45','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46462 Limit the package test to org.apache.jsp.* rather than org.apache.jsp* to allow use of packages like org.apache.jspwiki','java/org/apache/jasper/servlet/JasperLoader.java'),(1848,36923,'Bug 36923 – Deactivated EL expressions are not parsed for jsp expressions/scriptlets/etc','JavaServer Pages Specification 2.0, section JSP.3.3.2 says:\n---\nSince the syntactic pattern ${expr} was not reserved in the JSP specifications\nbefore JSP 2.0, there may be situations where such a pattern appears but the\nintention is not to activate EL expression evaluation but rather to pass through\nthe pattern verbatim. To address this, the EL evaluation machinery can be\ndeactivated as indicated in this section.\n[...]\nThe default mode for JSP pages in a Web Application delivered using a web.xml\nusing the Servlet 2.3 or earlier format is to ignore EL expressions; this\nprovides for backward compatibility.\n---\n\nHowever, even with deactivated EL expression evaluation, jsp code like:\n<%@ page isELIgnored=\"true\" %>${<%= \"Hello, world!\" %>}\n\nwill produce output like:\n${<%= \"Hello, world!\" %>}\n\nwhich is of course not backwards-compatible with Servlet 2.3 / JSP 1.2 container\n(e.g., Tomcat 4.x), where the output would be:\n${Hello, world!}\n\nThe ${...} syntax is widely used, and any pre-2.0 jsp pages having it would be\nincompatible with Tomcat 5.x even though the standard tries to ensure the\ncompatibility.','2005-10-05 01:08:53','Yegor Borovikov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P3 normal','98f38ee','Mark Emlyn David Thomas','2009-01-01 14:02:21','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=36923 If EL is disabled, treat it as template text.','java/org/apache/jasper/compiler/Parser.java'),(1849,46223,'Bug 46223 – FairBlockingQueue throws ArrayIndexOutOfBoundsException','If the FairBlockingQueue iterator next() method is called after hasNext() returns false, then it throws an ArrayIndexOutOfBoundsException.\n\nThe normal behaviour for an Iterator is to throw NoSuchElementException.','2008-11-17 07:46:54','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','d1fb7bf','Mark Emlyn David Thomas','2008-12-28 19:30:00','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46223 Add a simple co-ordinator provided by Robert Newson','java/org/apache/catalina/tribes/group/interceptors/SimpleCoordinator.java\nwebapps/docs/config/cluster-interceptor.xml'),(1850,46223,'Bug 46223 – FairBlockingQueue throws ArrayIndexOutOfBoundsException','If the FairBlockingQueue iterator next() method is called after hasNext() returns false, then it throws an ArrayIndexOutOfBoundsException.\n\nThe normal behaviour for an Iterator is to throw NoSuchElementException.','2008-11-17 07:46:54','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','jdbc-pool','P2 normal','9ac8046','Mark Emlyn David Thomas','2008-12-28 19:11:28','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46223 Throw NoSuchElementException if next() is called on the Iterator when hasNext()==false','modules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/FairBlockingQueue.java'),(1851,46298,'Bug 46298 – JDBCRealm.open() throws NullPointerException if the specified driver doesn\'t handle the specified JDBC URL','','2008-11-25 23:25:56','Owen Jacobson','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 minor','e31998a','Mark Emlyn David Thomas','2008-12-28 18:46:49','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46298 Throw an exception if the driver doesn\'t support the supplied URL Based on a patch by Owen Jacobson','java/org/apache/catalina/realm/JDBCRealm.java\njava/org/apache/catalina/realm/LocalStrings.properties'),(1852,46344,'Bug 46344 – Two org.apache.AnnotationProcessor classes can cause ClassCastExceptions','In the binary packages of tomcat 6 the class org.apache.AnnotationProcessor exists twice. Once in the catalina.jar and once in the jasper.jar. Normally this isn\'t a problem because both contain the same code and there is normally only one classpath (one patches the other).\n\nBut in special environments this causes problems. In fact it isn\'t possible to use tomcat 6 in an OSGi environment where catalina and jasper are in different bundles with different classpaths because org.apache.catalina.util.DefaultAnnotationProcessor implements org.apache.AnnotationProcessor from the catalina bundle and jasper wants to cast it to org.apache.AnnotationProcessor from the jasper bundle which is in another classpath. That causes a ClassCastException.','2008-12-05 00:08:51','Roger Villars','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 major','116e0e9','Mark Emlyn David Thomas','2008-12-27 17:17:49','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46344 Put the org.apache classes in a separate jar Maven changes need validating.','build.xml\nres/maven/catalina.pom\nres/maven/jasper.pom\nres/maven/mvn-pub.xml'),(1853,46351,'Bug 46351 – Refactor a bit the build scripts','','2008-12-05 03:03:45','Marc Guillemot','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','4ecd0d0','Mark Emlyn David Thomas','2008-12-27 16:48:28','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46351 Simplify build scripts. Patch provided by Marc Guillemot','build.xml\nres/maven/mvn-pub.xml'),(1854,46261,'Bug 46261 – Context with %2F in name causes tomcat crash on shutdown','Context with %2F in name causes tomcat crash on shutdown\n\nSeveral years ago I worked on integrating tomcat 5.5 into our web application management infrastructure.  During the process I fixed several tomcat 5.5 bugs, but apparently never sent the fixes upstream.  Oops.\n\nOur application needs to be deployed to create a URL that looks like this:\n\n/product/customername/servlet\n\nI worked with several people on IRC to get tomcat5.5 to do this.  We had previously been using the path= parameter in the context xml file element with tomcat 4.1.  Unfortunately, it appears this feature was removed from tomcat5.5, and tomcat5.5 does not recurse into subdirectories when reading .xml context files.  The recommendation on IRC (after several suggestions which would not work for our environment) was to put %2F in the context xml file\'s name.  Such as this\n\nproduct%2Fcustomername.xml\n\nThis does work, however when you try to shutdown tomcat 6.0.18, you will get this crash:\n\nNov 9, 2008 10:56:17 PM org.apache.coyote.http11.Http11Protocol pause\nINFO: Pausing Coyote HTTP/1.1 on http-8180\nNov 9, 2008 10:56:18 PM org.apache.catalina.core.StandardService stop\nINFO: Stopping service Catalina\nNov 9, 2008 10:56:18 PM org.apache.catalina.startup.HostConfig undeployApps\nWARNING: Error while removing context [/product%2Fcustomername]\njava.lang.NullPointerException\n        at org.apache.catalina.core.ContainerBase.removeChild(ContainerBase.java:915)\n        at org.apache.catalina.startup.HostConfig.undeployApps(HostConfig.java:1191)\n        at org.apache.catalina.startup.HostConfig.stop(HostConfig.java:1162)\n        at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:313)\n        at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:117)\n        at org.apache.catalina.core.ContainerBase.stop(ContainerBase.java:1086)\n        at org.apache.catalina.core.ContainerBase.stop(ContainerBase.java:1098)\n        at org.apache.catalina.core.StandardEngine.stop(StandardEngine.java:448)\n        at org.apache.catalina.core.StandardService.stop(StandardService.java:584)\n        at org.apache.catalina.core.StandardServer.stop(StandardServer.java:744)\n        at org.apache.catalina.startup.Catalina.stop(Catalina.java:628)\n        at org.apache.catalina.startup.Catalina$CatalinaShutdownHook.run(Catalina.java:671)\nNov 9, 2008 10:56:18 PM org.apache.coyote.http11.Http11Protocol destroy\nINFO: Stopping Coyote HTTP/1.1 on http-8180','2008-11-21 08:34:21','Joe Kislo','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','85fc30c','Mark Emlyn David Thomas','2008-12-26 18:50:26','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46261 %2F in context paths should be treated literally, not as / - that is what \'#\' is for.','java/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/manager/HTMLManagerServlet.java'),(1855,46381,'Bug 46381 – Coerce EL expression to java.lang.Object breaks expression concatenation','','2008-12-11 07:13:00','Fabian Necci','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Servlet & JSP API','P2 critical','24bcb47','Mark Emlyn David Thomas','2008-12-26 18:43:09','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46381 Needs testign with the TCK before proposing for 6.0.x','java/org/apache/jasper/compiler/Generator.java'),(1856,46357,'Bug 46357 – FarmWarDeployer has nonsense condition','FarmWarDeployer has the following code at line 152:\n\n        if(econtainer == null && econtainer instanceof Engine) {\n\nThere\'s clearly something wrong with that condition.','2008-12-06 05:48:33','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','7e6a2ec','Mark Emlyn David Thomas','2008-12-26 18:37:33','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46357 Correct test for host\'s parent must be an engine','java/org/apache/catalina/ha/deploy/FarmWarDeployer.java'),(1857,46397,'Bug 46397 – Potential memory leak with TagHandlers and JspIdConsumer','','2008-12-15 00:43:53','Jochen Wuttke','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','5277185','Mark Emlyn David Thomas','2008-12-23 13:31:04','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46397 Don\'t pool tag instances that implement JspIdConsumer','java/org/apache/jasper/compiler/Generator.java'),(1858,46403,'Bug 46403 – Persistent cookies written by 6.0.18 do not work in Internet Explorer or Safari','','2008-12-15 13:46:47','Matt Wiseley','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 major','99c5ca6','Mark Emlyn David Thomas','2008-12-23 08:14:42','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46403 By default, always send the expires parameter with cookies to fix know IE6 and IE 7 issue. I don\'t like doing this but I can\'t see a better way.','java/org/apache/tomcat/util/http/ServerCookie.java\nwebapps/docs/config/systemprops.xml'),(1859,46304,'Bug 46304 – SecurityUtil -- no method caching for event() or doFilterEvent() ?','','2008-11-26 21:26:39','Thomas Maslen','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P3 minor','6d76eea','Mark Emlyn David Thomas','2008-12-22 16:12:27','Fix performance aspects of 46304. Note it is possible (depending on connector config) to have a servlet/filter responding to comet and non-comet events - hence why the array used in the methods cache has been extended.','java/org/apache/catalina/security/SecurityUtil.java'),(1860,46304,'Bug 46304 – SecurityUtil -- no method caching for event() or doFilterEvent() ?','','2008-11-26 21:26:39','Thomas Maslen','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P3 minor','e658558','Mark Emlyn David Thomas','2008-12-22 15:45:07','Fix non-performance aspects of https://issues.apache.org/bugzilla/show_bug.cgi?id=46304 Should use Principal when calling doFilterEvent','java/org/apache/catalina/core/ApplicationFilterChain.java'),(1861,46408,'Bug 46408 – Invalid cast in SecurityUtil','In case of PrivilegedActionException thrown in:\n\n    private static void execute(final Method method,\n                                final Object targetObject, \n                                final Object[] targetArguments,\n                                Principal principal)\n\nmethod, there is a false assumption in catch block, that PrivilegedActionException.getException() will return InvocationTargetException. It could be also IllegalAccessException and possibly other types of exceptions as well.\n\nHere is the stack trace provoked on catalina shutdown when enabled security manager:\njava.lang.ClassCastException: java.lang.IllegalAccessException cannot be cast to java.lang.reflect.InvocationTargetException\n        at org.apache.catalina.security.SecurityUtil.execute(SecurityUtil.java:278)\n        at org.apache.catalina.security.SecurityUtil.doAsPrivilege(SecurityUtil.java:218)\n        at org.apache.catalina.security.SecurityUtil.doAsPrivilege(SecurityUtil.java:178)\n        at org.apache.catalina.core.ApplicationFilterConfig.release(ApplicationFilterConfig.java:326)\n        at org.apache.catalina.core.StandardContext.filterStop(StandardContext.java:3744)\n        at org.apache.catalina.core.StandardContext.stop(StandardContext.java:4513)\n        at org.apache.catalina.core.ContainerBase.removeChild(ContainerBase.java:924)\n        at org.apache.catalina.startup.HostConfig.undeployApps(HostConfig.java:1191)\n        at org.apache.catalina.startup.HostConfig.stop(HostConfig.java:1162)\n        at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:313)\n        at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:117)\n        at org.apache.catalina.core.ContainerBase.stop(ContainerBase.java:1086)\n        at org.apache.catalina.core.ContainerBase.stop(ContainerBase.java:1098)\n        at org.apache.catalina.core.StandardEngine.stop(StandardEngine.java:448)\n        at org.apache.catalina.core.StandardService.stop(StandardService.java:584)\n        at org.apache.catalina.core.StandardServer.stop(StandardServer.java:744)\n        at org.apache.catalina.startup.Catalina.stop(Catalina.java:628)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at org.apache.catalina.startup.Bootstrap.stop(Bootstrap.java:300)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at org.apache.commons.daemon.support.DaemonLoader.stop(DaemonLoader.java:200)','2008-12-16 15:22:51','Kazimierz Pogoda','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','a1e4c86','Mark Emlyn David Thomas','2008-12-19 09:28:06','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46408 Don\'t make assumptions about exception type','java/org/apache/catalina/security/SecurityUtil.java'),(1862,46366,'Bug 46366 – Misleading text in RUNNING.txt','The text in RUNNING.txt on multiple instances suggests that one can supply an option \"-Dcatalina.base\" with the startup command.\n\nThis is not the case for \"startup.sh\" nor for \"catalina.sh\".\nCATALINA_BASE needs to be defined in $CATALINA_HOME/bin/setenv.sh in order for this to work.\n\nPlease modify the text in RUNNING.txt accordingly or modify \"catalina.sh\" to also accept this \"-D...\" -option.\n\nThanks in advance,\n    Tom.\n\nNB: Also noted the same issue in 5.5','2008-12-09 00:33:16','Tom Uijldert','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P4 minor','5419cb8','Mark Emlyn David Thomas','2008-12-18 11:01:55','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46366 Need to use environment variables to set catalina home/base','RUNNING.txt'),(1863,46125,'Bug 46125 – Setting large cookies in the request causes Tomcat to abort the connection','It is possible to store too many cookies, or cookies that are too large for the header to properly carry. That\'s not good web programming, but still, it is quite common when one is using a JS framework.\n\nIf such a set of cookies is constructed and sent to Tomcat as part of a request, Tomcat panics and simply aborts the connection. This leads to a blank screen with no source code on the client\'s browser. Or, it leads to a cryptic error, like Safari\'s infamous \"CFErrorDomainCFNetwork error 302\" that drives many a newsgroup to tears trying to figure out what is going wrong with the server.\n\nExpected: return a \'400 Bad Request error\' like apache does. That would help the user know what is wrong with the request and help find a better resolution to the condition.\n\nI am attaching an HTML file that demonstrates this bug. Please run it in Tomcat and Apache as a comparison. I believe Apache handles the situation correctly.','2008-10-29 17:44:01','Matt Bishop','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','74976b4','Mark Emlyn David Thomas','2008-12-12 10:41:13','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46125 for NIO and APR connectors Change the exception if the headers are too big to force a 400 status code rather than the current 200','java/org/apache/coyote/http11/InternalAprInputBuffer.java\njava/org/apache/coyote/http11/InternalNioInputBuffer.java'),(1864,46247,'Bug 46247 – SVN property patches','','2008-11-19 18:16:54','Sebb','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Modules','Bayeux','P2 normal','408175f','Mark Emlyn David Thomas','2008-12-05 10:57:43','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46247 svn property patches for trunk Patch provided be sebb at a.o','modules/bayeux/java/org/apache/cometd/bayeux/Bayeux.java\nmodules/bayeux/java/org/apache/cometd/bayeux/Channel.java\nmodules/bayeux/java/org/apache/cometd/bayeux/Client.java\nmodules/bayeux/java/org/apache/cometd/bayeux/DataFilter.java\nmodules/bayeux/java/org/apache/cometd/bayeux/Listener.java\nmodules/bayeux/java/org/apache/cometd/bayeux/Message.java\nmodules/bayeux/java/org/apache/cometd/bayeux/SecurityPolicy.java\nmodules/bayeux/java/org/apache/tomcat/bayeux/BayeuxException.java\nmodules/bayeux/java/org/apache/tomcat/bayeux/BayeuxRequest.java\nmodules/bayeux/java/org/apache/tomcat/bayeux/BayeuxServlet.java\nmodules/bayeux/java/org/apache/tomcat/bayeux/ChannelImpl.java\nmodules/bayeux/java/org/apache/tomcat/bayeux/ClientImpl.java\nmodules/bayeux/java/org/apache/tomcat/bayeux/HttpError.java\nmodules/bayeux/java/org/apache/tomcat/bayeux/MessageImpl.java\nmodules/bayeux/java/org/apache/tomcat/bayeux/RequestBase.java\nmodules/bayeux/java/org/apache/tomcat/bayeux/RequestFactory.java\nmodules/bayeux/java/org/apache/tomcat/bayeux/TomcatBayeux.java\nmodules/bayeux/java/org/apache/tomcat/bayeux/request/MetaConnectRequest.java\nmodules/bayeux/java/org/apache/tomcat/bayeux/request/MetaDisconnectRequest.java\nmodules/bayeux/java/org/apache/tomcat/bayeux/request/MetaHandshakeRequest.java\nmodules/bayeux/java/org/apache/tomcat/bayeux/request/MetaSubscribeRequest.java\nmodules/bayeux/java/org/apache/tomcat/bayeux/request/MetaUnsubscribeRequest.java\nmodules/bayeux/java/org/apache/tomcat/bayeux/request/PublishRequest.java\nmodules/bayeux/test/org/apache/cometd/bayeux/samples/BayeuxStockTicker.java\nmodules/bayeux/test/org/apache/cometd/bayeux/samples/EchoChatClient.java\nmodules/bayeux/webapps/cometd/WEB-INF/web.xml\nmodules/bayeux/webapps/cometd/examples/simplechat/ticker.html\nmodules/bayeux/webapps/cometd/index.html\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/interceptor/ConnectionState.java\nmodules/jdbc-pool/java/org/apache/tomcat/jdbc/pool/interceptor/SlowQueryReport.java\nres/META-INF/LICENSE\nres/META-INF/NOTICE\nres/procrun/amd64/tomcat6.exe\nres/procrun/amd64/tomcat6w.exe\nres/procrun/ia64/tomcat6.exe\nres/procrun/ia64/tomcat6w.exe\nres/procrun/tomcat6.exe\nres/procrun/tomcat6w.exe'),(1865,46232,'Bug 46232 – Can\'t override XML parser implementation using endorsed mechanism','','2008-11-18 11:43:27','Russ Tokuyama','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','3a703ff','Mark Emlyn David Thomas','2008-12-05 09:27:57','https://issues.apache.org/bugzilla/show_bug.cgi?id=46232 Don\'t override the endorsed dir if the user has set it Based on a patch by Russ Tokuyama','bin/setclasspath.bat\nbin/setclasspath.sh'),(1866,44285,'Bug 44285 – ssl.SessionId Cache Control','There is no way to control the ssl.SessionId cache size.\nThe default Sun JVM behavior is too keep a SoftReference cache that grows as much as it can. This has \na performance impact since the GC works harder because of the heap size.\n\nThe result is that with a system that has a lot of https clients, the memory grows to a very large size:\nWe have 700K of SessionIds in memory consuming a little over 800MB !!!\n\nI think the connector should have attributes that let me control the max time and size ssl.sessionid are \nkept (for reference, websphere let\'s you do that).\n\nAnother useful feature would be to let me explicitly invalidate a ssl.sessionid (during the request life \ncycle).','2008-01-23 05:29:19','Yuval Perlov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 enhancement','425a0df','Mark Emlyn David Thomas','2008-12-04 14:31:34','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=44285 Provide support for configuring the JSSE SSL session cache size and timeout','java/org/apache/tomcat/util/net/NioEndpoint.java\njava/org/apache/tomcat/util/net/jsse/JSSESocketFactory.java\nwebapps/docs/config/http.xml'),(1867,42077,'Bug 42077 – the iterator from javax.el.CompositeELResolver#getFeatureDescriptor() must not return null values','','2007-04-10 03:03:51','Mathias Broekelmann','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 major','8d5db6f','Mark Emlyn David Thomas','2008-11-23 18:35:05','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=42077 Don\'t include nulls in iterator. Based on a patch by Mathias Broekelmann','java/javax/el/CompositeELResolver.java'),(1868,42693,'Bug 42693 – JSP-Generation error with recursive tagfile structure','addendum: it\'s Version 6.13 (not available in combobox above)\n\nscenario:\n=========\na menu is decribed by a tree structure;\nrendering the menu is done by a tagfile \'render_menuitem\', which renders the\ncurrent item either as a leaf item (clicking on it causes an action) or as a\nnode item (clicking on it opens another next-level submenu);\nrendering the submenu is done by calling the tagfile again from within its body;\nthis worked fine with tomcat 5.0.x and 5.5.x\n\nto make it clear see the following pseudo code (the original code is to\nvoluminous): \ntagfile \'render_menuitem.tagx\':\n<jsp:root ...>\n   <jsp:directive.attribute name=\"menu_item\"/>\n   <c:choose>\n      <c:when test=\"${menu_item.isNode}\n         <div>node: ${menu_item.label}</div>\n         <c:forEach var=\"sub_item\" items=\"menu_item.children\">\n            <!-- THIS IS GOING TO CAUSE THE PROBLEM WITH TOMCAT6: -->\n            <tags:render_menuitem menu_item=\"${sub_item}\"/>\n         </c:forEach>\n      <c:when>\n      <c:otherwise>\n         <div>leaf: ${menu_item.label}</div>\n      </c:otherwise>\n   </c:choose>\n</jsp:root>\n\nfaulty behaviour:\n================\nwith tomcat 6.0.13, the generated Java-Source for the tagfile reveals, that the\nbody of the doTag() method is empty and therefore emits no html; the compilation\nitself was silently done, no error or warning was shown in the logfiles.','2007-06-18 10:10:02','Frank Hofmann','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P1 critical','b5a5094','Mark Emlyn David Thomas','2008-11-23 16:25:22','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=42693 I want to do some more testing before proposing this one','java/org/apache/jasper/compiler/Compiler.java'),(1869,42707,'Bug 42707 – add host alias using jmx doesn\'t take affect until restart','','2007-06-20 14:46:49','Ted Leung','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','23a8ba0','Mark Emlyn David Thomas','2008-11-08 20:57:34','Fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=42707 I debated adding the addContainerListener() meethod to JMX. I\'ll leave it a little while for people to comment on this (or anything else) before I propose this one for 6.0.x.','java/org/apache/catalina/connector/MapperListener.java\njava/org/apache/tomcat/util/http/mapper/Mapper.java'),(1870,42747,'Bug 42747 – Context className attribute ignored for contexts deployed from descriptors in web/META-INF/context.xml','When deploying an app from a context descriptor inside a webapp/META-INF\ndirectory via context.xml, the className is ignored and the context is created\nas a StandardContext.  I\'ve tried to use a ReplicatedContext class in a cluster\nfrom this configuration and it does not work.  However, it does work if i move\nthe context.xml to $CATALINA_BASE/conf/[EngineName]/[HostName]/webapp.xml.','2007-06-26 11:41:53','randy hoffman','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','400f344','Mark Emlyn David Thomas','2008-11-08 20:45:26','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=42747 I\'ve tested this with all the combinations I could think of and ensured that the order of the redploy resources is consistent. The summary of changes is: - context.xml takes effect on first deploy rather than next restart - context.xml from DIR is now copied to conf/<eng>/<host> in the same manner as context.xml from WAR I also fixed a couple of edge cases I spotted and changed a few local variables to make the code easier to understand.','java/org/apache/catalina/startup/HostConfig.java'),(1871,42673,'Bug 42673 – SSI virtual include broken for context path with slashes','If the context path of an application contains slashes (e.g. \"a/b\") the method\ngetPathWithoutContext of class\norg.apache.catalina.ssi.SSIServletExternalResolver simply cuts from the second\nslash, so for url \"/a/b/do?..\" it tries to include \"b/do?..\" instead of \"do?..\".\n\nThe patch is to include the context path and strip the path off:\n\nLine 419\nString noContext = getPathWithoutContext(normContext.getContextPath(), normalized);\n\nLine 356ff\nprotected String getPathWithoutContext(final String contextPath, final String\nservletPath) {\n   if (servletPath.startsWith(contextPath)) {\n      return servletPath.substring(contextPath.length());\n    }\n    return servletPath;\n}','2007-06-15 05:08:34','Peter Jodeleit','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','4d5cca1','Mark Emlyn David Thomas','2008-11-08 20:35:58','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=42673 Correctly handle includes with multi-level contexts Patch provided by Peter Jodeleit','java/org/apache/catalina/ssi/SSIServletExternalResolver.java'),(1872,46011,'Bug 46011 – Cannot access to Principal via Subject.getSubject(AccessController.getContext())','Cannot access to Principal via Subject.getSubject(AccessController.getContext()).\n\nProblem is that in method internalDoFilter of ApplicationFilterChain in call of filter chain the code determinate the Principal but don\'t use it:\n\n                if( Globals.IS_SECURITY_ENABLED ) {\n                    final ServletRequest req = request;\n                    final ServletResponse res = response;\n                    Principal principal = \n                        ((HttpServletRequest) req).getUserPrincipal();\n\n                    Object[] args = new Object[]{req, res, this};\n                    SecurityUtil.doAsPrivilege\n                        (\"doFilter\", filter, classType, args);\n                    \n                    args = null;\n                } else {  \n\nIn this manner a SecurityUtil.doAsPrivilege will be called with Principal == null\nand method execute create a Subject with no Principals.\nThen call a Subject.doAsPrivileged(subject, pea, null);  and this do not propagate Principals. I obtain a Subject without Principals calling Subject.getSubject(AccessController.getContext()).\n\nIn attachment we send our solution','2008-10-15 02:56:56','tsveg1','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 major','e148369','Mark Emlyn David Thomas','2008-11-05 11:17:16','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46011 Make Principal accessible (if set) via Subject.getSubject(AccessController.getContext()) when processing filters. Based on a patch provided by tsveg1','java/org/apache/catalina/core/ApplicationFilterChain.java\njava/org/apache/catalina/security/SecurityUtil.java'),(1873,46121,'Bug 46121 – \"resources\" ant task clashes with ant 1.7 \"resources\" element','','2008-10-29 08:30:43','Matt Wildig','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Manager application','P2 minor','0ec09e0','Mark Emlyn David Thomas','2008-11-03 18:47:38','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46121 Add note about resources clash and using namespaces to resolve it.','webapps/docs/manager-howto.xml'),(1874,46047,'Bug 46047 – Issue when using include directive inside tag files that are inside jar files','','2008-10-21 02:20:44','Cédric Mailleux','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 critical','38ef38d','Mark Emlyn David Thomas','2008-11-03 17:47:26','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46047 Include jar in path for dependencies if they are in a JAR Patch provided by Cédric Mailleux','java/org/apache/jasper/compiler/ParserController.java'),(1875,41861,'Bug 41861 – Tomcat Windows installer behaves unexpectedly','Assume Tomcat 5.5 running on Windows.\nInstallation done using the Windows installer.\ntomcat5w.exe is used to start/stop the service.\n\nTried to update to 6.0 using Windows installer, again.\n\nThe installer fails to see\n-	Tomcat is running\n-	version 5.5 is still installed.\n\nThe installer comes up with a message: Apache Tomcat Setup failed to install\nTomcat6 service. Check your settings and permissions. Ignore and continue anyway\n(not recommended)?\n\nThis message is not clear.\nWhat action are we to take? Should we continue even though it is not recommended?\n\nWhen continuation is chosen, everything runs to completion where the option “Run\nApache Tomcat” is presented. When this option is taken, the result is:\nApplication System Error.\nThe requested service is not available. Unable to open the service ‘Tomcat6’.\n\nIt does not help simply to stop the running Tomcat 5.5\nOne must *uninstall* Tomcat 5.5 (in order to remove the Windows service).\n\nRepeating the installation then succeeds.\nThe installer, however, should be able to handle this in an \"integrated\" way.','2007-03-16 03:31:23','Hubert Kauker','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','5161495','Mark Emlyn David Thomas','2008-11-03 09:31:59','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=41861 Change service name from \"Apache Tomcat\" to \"Apache Tomcat 6\". Full version number is still present in the description.','res/tomcat.nsi'),(1876,42409,'Bug 42409 – Extra response headers not sent when using custom error page','If I create a servlet that does the following:\n\nresponse.setHeader(\"X-BUG\", \"Value\");\nresponse.sendError(HttpServletResponse.SC_BAD_REQUEST);\n\nIf I use the tomcat default error page for 400 responses, the response will\ncontain the header \"X-BUG\" with value \"Value\".\n\nHowever, if I create a custom error page, the response headers do NOT contain\nthe \"X-BUG\" header in the response. \n\nHere is my web.xml, for example:\n\n<error-page>\n    <error-code>400</error-code>\n    <location>/400.jsp</location>\n</error-page>\n\n400.jsp contains plain html:\n\n<html>\n<body>\n<h3>Custom 400 error page</h3>\n</body>\n</html>','2007-05-14 09:03:17','Hayden James','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P3 major','e0489c8','Mark Emlyn David Thomas','2008-11-03 09:28:17','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=42409 The spec says reset the buffer, therefore use the resetBuffer() method. This makes custom and standard error handling consistent.','java/org/apache/catalina/core/StandardHostValve.java'),(1877,46051,'Bug 46051 – Servlet response writer does not respect line.separator system property','','2008-10-21 10:54:42','Chris Hubick','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','f4bef20','Mark Emlyn David Thomas','2008-11-01 20:48:28','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46051 The PrintWriter interface requires that the line separator is platform dependant. Not that this makes much sense for a web application but there is a spec so we shoud stick to it.','java/org/apache/catalina/connector/CoyoteWriter.java'),(1878,46125,'Bug 46125 – Setting large cookies in the request causes Tomcat to abort the connection','It is possible to store too many cookies, or cookies that are too large for the header to properly carry. That\'s not good web programming, but still, it is quite common when one is using a JS framework.\n\nIf such a set of cookies is constructed and sent to Tomcat as part of a request, Tomcat panics and simply aborts the connection. This leads to a blank screen with no source code on the client\'s browser. Or, it leads to a cryptic error, like Safari\'s infamous \"CFErrorDomainCFNetwork error 302\" that drives many a newsgroup to tears trying to figure out what is going wrong with the server.\n\nExpected: return a \'400 Bad Request error\' like apache does. That would help the user know what is wrong with the request and help find a better resolution to the condition.\n\nI am attaching an HTML file that demonstrates this bug. Please run it in Tomcat and Apache as a comparison. I believe Apache handles the situation correctly.','2008-10-29 17:44:01','Matt Bishop','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','fbb839a','Mark Emlyn David Thomas','2008-11-01 20:34:01','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46125 Change the exception if the headers are too big to force a 400 status code rather than the current 200','java/org/apache/coyote/http11/InternalInputBuffer.java'),(1879,46105,'Bug 46105 – URIEncoding doesn\'t affect after form-authentication redirect','How to reproduce bug.\n\nConfigure tomcat connector with URIEncoding=UTF-8 attribute.\nMake a simple page that write out any request parameter. Configure this page as protected with form-based authentication.\nTry to access page, e.g.\n\n/site/page.jsp?q=%xx%yy%zz%tt\n\nwhere q=%xx%yy%zz is value in UTF-8 charset.\n\nWhen page is being accessed for the first time, then after authentication, parameter \"q\" is incorrectly interpreted (it seems as it was in ISO8859-1 or anything else, but not UTF-8).\n\nBut subsequent access to the _same_ URI, i.e.\n/site/page.jsp?q=%xx%yy%zz%tt\n\ngives perfect result.\n\nI also tried useBobyEncodingForURI=true and request.setCharacterEncoding(\"UTF-8\") - nothing is changed.','2008-10-27 23:37:52','Maxim Kuleshov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Connector:HTTP','P3 normal','d9def07','Mark Emlyn David Thomas','2008-10-30 19:46:41','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46105 Correctly set URI encoding when replaying request after FORM auth','java/org/apache/catalina/authenticator/FormAuthenticator.java'),(1880,46106,'Bug 46106 – Broken link in documentation','It seems that the link to DefaultContext element is broken.','2008-10-28 01:22:59','Keisuke Kamada','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P2 normal','e4030df','Mark Emlyn David Thomas','2008-10-28 07:50:43','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46106 Remove references to DefaultContext from docs','webapps/docs/config/context.xml\nwebapps/docs/config/engine.xml\nwebapps/docs/config/globalresources.xml\nwebapps/docs/config/host.xml'),(1881,46067,'Bug 46067 – documentation grammar/spelling','A few grammar/spelling mistakes:\n\nrecieving = receiving\n\nComet support allows a servlet to process IO aynchronously, <here>recieving</here> events\n\nimplments = implements\n\nThe following pseudo code servlet <here>implments</here> asynchronous\n\nsimple = simply\n\nTo set a timeout, <here>simple</here> set a request attribute','2008-10-22 15:52:45','Fu-Tung','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P2 normal','995aaac','Mark Emlyn David Thomas','2008-10-27 18:48:21','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46067 Correct some typos.','webapps/docs/aio.xml'),(1882,46075,'Bug 46075 – FileUpload memory usage','The DefaultFileItem class in pacakge org.apache.tomcat.util.http.fileupload creates a ByteArrayOutputStream of the full threshold size for every control on the submitted form. I have a form with 63 controls (checkboxes, text boxes and one File input), and I set the threshold to 20 Meg to allow upload of large image files into memory. I get an OutOfMemory exception since it tries to allocate 63 lots of 20M, although only 1 control requires the requested size.\n\nI think it would be much more sensible to create the ByteArrayOutputStream with an initial size of only a few kilobytes size it automatically increases its size as data is written to it.','2008-10-23 03:35:53','Richard Wilson','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Servlet & JSP API','P2 normal','85e71cf','Mark Emlyn David Thomas','2008-10-27 18:40:48','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46075 Don\'t automatically create the ByteArrayOutputStream with the full threshold - we probably won\'t need it in most cases.','java/org/apache/tomcat/util/http/fileupload/DeferredFileOutputStream.java'),(1883,46085,'Bug 46085 – Session are incorrectly expired due to thread unsafe code','','2008-10-24 12:53:09','Philip Shore','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 major','6344b96','Mark Emlyn David Thomas','2008-10-27 14:31:50','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46085 Hard to reproduce thread safety issue with session expiration.','java/org/apache/catalina/session/StandardSession.java'),(1884,46096,'Bug 46096 – DefaultAnnotationProcessor.processAnnotations should use doPrivileged to call getDeclaredFields','If tomcat is running with a SecurityManager, and a JSP uses PageContext.forward, DefaultAnnotationProcessor code can be called with untristed code on the call stack.\n\nThe processAnnotations method contains the line:\n\n   Field[] fields = instance.getClass().getDeclaredFields();\n\ngetDeclaredFields() is subject to security checks so this throws a java.security.AccessControlException.\n\nDefaultAnnotationProcessor is part of the code in the catlina lib directory, which is granted AllPermissions in the standard policy file.  However, because there is untrusted JSP code on the stack, these permissions are not used.\n\nThe call to getDeclaredFields() should be wrapped in an AccessController.doPrivileged call to avoid the exception.','2008-10-27 05:44:55','Richard Evans','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','428c03b','Mark Emlyn David Thomas','2008-10-27 13:28:16','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=46096 Allow for running under a security manager when processing annotations.','java/org/apache/catalina/core/DefaultInstanceManager.java'),(1885,45906,'Bug 45906 – Fix ResourceAttributes ETag handling','','2008-09-27 15:07:04','Chris Hubick','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','4a4ae47','Mark Emlyn David Thomas','2008-10-27 07:43:24','Previous commit undid some of the fixes for bug 45906. Correct that error.','java/org/apache/naming/resources/ResourceAttributes.java'),(1886,45735,'Bug 45735 – Updated ResourceAttributes.getETag','After looking at a user\'s list post, I noticed the implementation was not consistent with the other getters (like getName).\n\nI propose changing it to:\n    public String getETag(boolean strong) {\n        if (strong) {\n            // The strong ETag must always be calculated by the resources\n            if (strongETag != null)\n                return strongETag;\n            if (attributes != null) {\n                Attribute attribute = attributes.get(ETAG);\n                if (attribute != null) {\n                    try {\n                        strongETag = attribute.get().toString();\n                    } catch (NamingException e) {\n                        ; // No value for the attribute\n                    }\n                }\n            }\n            return strongETag;\n        } else {\n            // The weakETag is contentLenght + lastModified\n            if (weakETag == null) {\n                weakETag = \"W/\\\"\" + getContentLength() + \"-\" \n                    + getLastModified() + \"\\\"\";\n            }\n            return weakETag;\n        }\n    }','2008-09-03 10:48:23','Remy Maucherat','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 minor','e40c910','Mark Emlyn David Thomas','2008-10-24 17:23:08','Apply Remy\'s patch for 45735 and align trunk with 6.0.x.','java/org/apache/naming/resources/ResourceAttributes.java'),(1887,45285,'Bug 45285 – RESOURCES DECLARED IN PARENT CLASSES ARE NOT INJECTED','According to the section EE.5.2.3 of the Java EE specification:\n------------------------\nResource annotations may appear on any of the classes listed above, or on any superclass of any class listed above. A resource annotation on any class in the inheritance hierarchy defines a resource needed by the application component.\n------------------------\n\nI use JSF managed beans with @EJB annotated members.\nIf a resource is annotated in a super class of a class it\'s not injected.\n\nExample:\n\npublic class Base{\n@EJB\nprivate SomeService service;\n....\n}\n\npublic class Child implements Base{\n....\n}\n\nBase class used as managed bean has \'service\' injected.\nChild class used as managed bean does NOT have \'service\' injected.\n\nIf I dare suggest the problem source ...\n\nAs I can see org.apache.catalina.util.DefaultAnnotationProcessor is used. It has the following lines in its  \'public void processAnnotations(Object instance)\' method:\n....\nField[] fields = instance.getClass().getDeclaredFields();\n....\nMethod[] methods = instance.getClass().getDeclaredMethods();\n....\n\n\nClass.getDeclaredFields method returns \'public, protected, default (package) access, and private fields, but excludes inherited fields\'.\n\nThe same thing is with Class.getDeclaredMethods.','2008-06-25 23:58:28','Florent BENOIT','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Servlet & JSP API','P3 normal','a08831a','Mark Emlyn David Thomas','2008-10-20 05:11:55','Default JNDI name for annotation lookup should be based on the class where the annotation was found which isn\'t always the class of the instance being created. Reported as part of the follow-up to https://issues.apache.org/bugzilla/show_bug.cgi?id=45285 Based on a patch for 6.0.x provided by Florent BENOIT.','java/org/apache/catalina/core/DefaultInstanceManager.java'),(1888,42565,'Bug 42565 – jsp /expression language ternary expression without space before colon stopped working','','2007-06-01 08:43:44','Thomas Wiesel','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','9ca996d','Mark Emlyn David Thomas','2008-10-19 17:26:40','Fix the remaining EL / TCK issues. With this patch the EL TCK tests pass and my test cases for bugs 42565, 44994, 45015, 45451, 45427, 45511 and some additional tests for edge cases all pass.','java/org/apache/jasper/compiler/Generator.java'),(1889,44994,'Bug 44994 – JSP EL condition expression fails when nested: ${a ? b ? x: y: z}','','2008-05-13 23:38:42','James Manger','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','9ca996d','Mark Emlyn David Thomas','2008-10-19 17:26:40','Fix the remaining EL / TCK issues. With this patch the EL TCK tests pass and my test cases for bugs 42565, 44994, 45015, 45451, 45427, 45511 and some additional tests for edge cases all pass.','java/org/apache/jasper/compiler/Generator.java'),(1890,45015,'Bug 45015 – Quoting in attributes','According to JSP 2.0 specification (chapter 1.7 page 72,73)\n\nThis code is illegal:\n<mytags:tag value=\"<%= \"hi!\" %>\" />\n\nInstead the correct sentence would be:\n<mytags:tag value=\'<%= \"hi!\" %>\' />\n<mytags:tag value=\"<%= \\\"hi!\\\" %>\" />\n<mytags:tag value=\'<%= \\\"name\\\" %>\' />\n...\n\nBut Tomcat 5.5 accept the first sentence. It\'s not a real bug but accepting a wrong sentence allow developpers to write code which does not respect the JSP specification. And when this code is executing in another servlet container (Websphere 6.1 for example) it doesn\'t work.','2008-05-16 04:22:28','Eric Taix','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Servlet & JSP API','P2 normal','9ca996d','Mark Emlyn David Thomas','2008-10-19 17:26:40','Fix the remaining EL / TCK issues. With this patch the EL TCK tests pass and my test cases for bugs 42565, 44994, 45015, 45451, 45427, 45511 and some additional tests for edge cases all pass.','java/org/apache/jasper/compiler/Generator.java'),(1891,45451,'Bug 45451 – Tag file attribute evaluation','','2008-07-22 01:37:27','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','9ca996d','Mark Emlyn David Thomas','2008-10-19 17:26:40','Fix the remaining EL / TCK issues. With this patch the EL TCK tests pass and my test cases for bugs 42565, 44994, 45015, 45451, 45427, 45511 and some additional tests for edge cases all pass.','java/org/apache/jasper/compiler/Generator.java'),(1892,45427,'Bug 45427 – Unmatched quotes inside EL break JSP parser','','2008-07-17 23:44:39','Sean Flanigan','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','9ca996d','Mark Emlyn David Thomas','2008-10-19 17:26:40','Fix the remaining EL / TCK issues. With this patch the EL TCK tests pass and my test cases for bugs 42565, 44994, 45015, 45451, 45427, 45511 and some additional tests for edge cases all pass.','java/org/apache/jasper/compiler/Generator.java'),(1893,45511,'Bug 45511 – EL \"empty\" keyword does not work','When using ${empty(xxx)}, EL parser thinks it is an unknown function :empty and throws ClassCastException:\n\njava.lang.ClassCastException: java.lang.NullPointerException\n	at org.apache.el.lang.ExpressionBuilder.prepare(ExpressionBuilder.java:135)\n	at org.apache.el.lang.ExpressionBuilder.build(ExpressionBuilder.java:147)\n	at org.apache.el.lang.ExpressionBuilder.createValueExpression(ExpressionBuilder.java:190)\n	at org.apache.el.ExpressionFactoryImpl.createValueExpression(ExpressionFactoryImpl.java:68)\n	at org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate(PageContextImpl.java:924)\n\n\nI think it is because of some changes in ELParser.java....\n\nwith best regards\nGrzegorz Grzybek','2008-07-31 02:36:27','Grzegorz Grzybek','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 major','9ca996d','Mark Emlyn David Thomas','2008-10-19 17:26:40','Fix the remaining EL / TCK issues. With this patch the EL TCK tests pass and my test cases for bugs 42565, 44994, 45015, 45451, 45427, 45511 and some additional tests for edge cases all pass.','java/org/apache/jasper/compiler/Generator.java'),(1894,45977,'Bug 45977 – Duplicate comment in code - CoyoteAdapter.java','The XXX comments below seem to say the same thing.  Not sure what the XXX represents.\n\n\n    /**\n     * Parse additional request parameters.\n     */\n    protected boolean postParseRequest(org.apache.coyote.Request req, \n                                       Request request,\n    		                       org.apache.coyote.Response res, \n                                       Response response)\n            throws Exception {\n\n        // XXX the processor needs to set a correct scheme and port prior to this point, \n        // in ajp13 protocols dont make sense to get the port from the connector..\n        // XXX the processor may have set a correct scheme and port prior to this point, \n        // in ajp13 protocols dont make sense to get the port from the connector...\n        // otherwise, use connector configuration\n        if (! req.scheme().isNull()) {\n            // use processor specified scheme to determine secure state\n            request.setSecure(req.scheme().equals(\"https\"));','2008-10-09 08:28:02','Fu-Tung','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','e277f6c','Mark Emlyn David Thomas','2008-10-09 18:58:03','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45977 Trivial comment clean up. No plans to backport this.','java/org/apache/catalina/connector/CoyoteAdapter.java'),(1895,45451,'Bug 45451 – Tag file attribute evaluation','','2008-07-22 01:37:27','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','b6803c9','Mark Emlyn David Thomas','2008-10-07 15:10:51','EG confirmed that attribute values should be fully escaped, including any EL. Note this does not fix bug 45451.','java/org/apache/jasper/compiler/Parser.java'),(1896,45951,'Bug 45951 – Provide support for renaming  JSESSIONID','','2008-10-05 15:15:52','André-John Mas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','e85ed8c','Mark Emlyn David Thomas','2008-10-06 14:25:55','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45951 Based on jfclere\'s patch','java/org/apache/catalina/Globals.java\njava/org/apache/catalina/authenticator/Constants.java\njava/org/apache/jasper/Constants.java\nwebapps/docs/config/systemprops.xml'),(1897,43656,'Bug 43656 – ELSupport.coerceToType won\'t handle null for java.lang.Number','If ELSupport.coerceToType is called with an BigDecimal instance as the first Parameter \'obj\' and \nBigDecimal.class as type it should return the inputted value.\n\nInstead the BigDecimal is converted into a double and back into a BigDecimal which leads to a diffenent \nvalue. This happens in Line 228:\n\n        if (BigInteger.class.equals(type)) {\n            if (number instanceof BigDecimal) {\n                return ((BigDecimal) number).toBigInteger();\n            }\n            return BigInteger.valueOf(number.longValue()); // This leads to a different value.\n        }\n\nExample: Run the Method with new BigDecimal(\"0.19\"), BigDecimal.class as parameters.\nThis should result in a BigDecimal with value 0.19. Instead i got \n0.190000000000000002220446049250313080847263336181640625.\n\n The easiest solution is to compare the class of the object to coerce with the target class and return the \ninputted value if the are equal in ELSupport.coerceToType Method:\n\npublic final static Object coerceToType(final Object obj, final Class type) throws \nIllegalArgumentException {\n		if (type == null || Object.class.equals(type) || type.equals(obj.getClass())) {\n			return obj;\n		}\n...','2007-10-18 18:02:47','Nils Eckert','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Servlet & JSP API','P2 normal','65d5ba1','Mark Emlyn David Thomas','2008-10-03 12:19:01','Fix regression in previous fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=43656 Patch provided by Nils Eckert.','java/org/apache/el/lang/ELSupport.java\ntest/org/apache/el/lang/TestELSupport.java'),(1898,45940,'Bug 45940 – jndi-resources-howto.html lists \'user\' not \'username\' as a <Resource> attribute','user - Database username to be passed to our JDBC driver. \n\ns/b\n\n    username - Database username to be passed to our JDBC driver.','2008-10-02 10:07:18','Robert Flaherty','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P2 minor','fb92c70','Mark Emlyn David Thomas','2008-10-03 08:15:53','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45940 typo user->username','webapps/docs/jndi-resources-howto.xml'),(1899,45403,'Bug 45403 – Tomcat does not reload application','Tomcat does not reload application if\n 1)a file in WEB-INF/lib is a symbolic link file, and\n 2)the actual file of the symbolic link file changed, and\n 3)allowLinking attribute is false\n\nIn case of the above, Tomcat throws a NamingException.\nApplication reloading works well if allowLinking attribute is set to true.\nThe reason of the above would be as allows.\n\n--------------------\nWebappClassLoader:addJar\n\n  long lastModified =\n      ((ResourceAttributes) resources.getAttributes(jar))\n       .getLastModified();\n--------------------\n\n\nI was wondering if application reloading should work when allowLinking attribute\nis false.\nOr should Tomcat disregard the Jar (doesn\'t load it)\nwhen \"allowLinking=false\"?','2008-07-15 18:39:38','kawasima','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','3a221c7','Mark Emlyn David Thomas','2008-10-03 08:09:16','Better fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=45403 With this patch, the allowLinking flag applies to all web application resources. It is very slightly slower. On my machine with allowLinking=false, the change to line 899 increases the time from ~7 microseconds to create the file to ~70 microseconds to create and validate the file. As far as I can tell, this change is only going to affect context start times. If directory listings are enabled in the default servlet, they will also be slightly slower but they were horribly slow to start with.','java/org/apache/naming/resources/FileDirContext.java'),(1900,45933,'Bug 45933 – Error processing TLD file in webapp with XML parser','','2008-10-01 23:51:18','Eddy Chan','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P3 normal','f69637f','Mark Emlyn David Thomas','2008-10-03 07:53:28','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45933 Don\'t use parser from web-app for tld files','java/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/startup/LocalStrings.properties\njava/org/apache/catalina/startup/TldConfig.java'),(1901,45403,'Bug 45403 – Tomcat does not reload application','Tomcat does not reload application if\n 1)a file in WEB-INF/lib is a symbolic link file, and\n 2)the actual file of the symbolic link file changed, and\n 3)allowLinking attribute is false\n\nIn case of the above, Tomcat throws a NamingException.\nApplication reloading works well if allowLinking attribute is set to true.\nThe reason of the above would be as allows.\n\n--------------------\nWebappClassLoader:addJar\n\n  long lastModified =\n      ((ResourceAttributes) resources.getAttributes(jar))\n       .getLastModified();\n--------------------\n\n\nI was wondering if application reloading should work when allowLinking attribute\nis false.\nOr should Tomcat disregard the Jar (doesn\'t load it)\nwhen \"allowLinking=false\"?','2008-07-15 18:39:38','kawasima','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','4172ef2','Mark Emlyn David Thomas','2008-10-01 10:23:09','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45403 When listing the resources for a collection, don\'t include invalid resources, particularly linked resources when allowLinking=false','java/org/apache/naming/resources/FileDirContext.java'),(1902,45906,'Bug 45906 – Fix ResourceAttributes ETag handling','','2008-09-27 15:07:04','Chris Hubick','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','378d062','Mark Emlyn David Thomas','2008-09-29 09:24:36','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45906 Improve ResourceAttributes ETag handling. Patch provided by Chris Hubick','java/org/apache/catalina/servlets/DefaultServlet.java\njava/org/apache/catalina/servlets/WebdavServlet.java\njava/org/apache/naming/resources/ResourceAttributes.java'),(1903,45851,'Bug 45851 – FarmWarDeployer fails to properly unpack copied war on target node','','2008-09-19 22:17:57','Paul McGurn','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Cluster','P2 normal','c340c69','Mark Emlyn David Thomas','2008-09-26 13:37:34','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45851 Correct NPE when cluster is defined at engine level Ensure that only 1 thread writes the replicated WAR to disk and that the messages containing the WAR are processed in the correct order.','java/org/apache/catalina/ha/deploy/FarmWarDeployer.java\njava/org/apache/catalina/ha/deploy/FileMessageFactory.java'),(1904,45878,'Bug 45878 – Generated jars do not contain proper manifests or N & L files','This seems to be a regression since 5.5.x.\n\nThe jars in the binary distribution of 6.0.18 contain a MANIFEST, but the contents are minimal, for example jsp-api.jar contains:\n\nManifest-Version: 1.0\nAnt-Version: Apache Ant 1.7.0\nCreated-By: 1.5.0_12-b04 (Sun Microsystems Inc.)\n\nwhereas the jsp-api.jar in 5.5.27 contains:\n\nManifest-Version: 1.0\nAnt-Version: Apache Ant 1.7.0\nCreated-By: 1.4.2_12-b03 (Sun Microsystems Inc.)\n\nName: javax/servlet/jsp/\nSpecification-Title: Java API for JavaServer Pages\nSpecification-Version: 2.0\nSpecification-Vendor: Sun Microsystems, Inc.\nImplementation-Title: javax.servlet.jsp\nImplementation-Version: 2.0.public_draft\nImplementation-Vendor: Apache Software Foundation\n\n\nI think all the generated jars should contain the following properties:\n\nBuilt-By:\nName: \nSpecification-Title:\nSpecification-Version:\nSpecification-Vendor:\nImplementation-Title:\nImplementation-Version:\nImplementation-Vendor:\nX-Compile-Source-JDK:\nX-Compile-Target-JDK:\n\nAlso, all the jars should contain NOTICE and LICENSE files.','2008-09-24 08:23:55','Sebb','Tomcat Developers Mailing List','NEW','Tomcat 6','Native:Packaging','P2 enhancement','7a8302e','Mark Emlyn David Thomas','2008-09-25 19:20:48','Partial fix for 45878. If we are happy with this approach for the spec JARs, extend it to the remaining Tomcat JARs.','build.xml\nres/META-INF/LICENSE\nres/META-INF/NOTICE\nres/jsp-api.jar.manifest\nres/servlet-api.jar.manifest'),(1905,45879,'Bug 45879 – Windows installer fails to install NOTICE and RELEASE-NOTES','The Windows service installer fails to install the NOTICE and RELEASE-NOTES files in the target directory.','2008-09-24 08:29:15','Sebb','Tomcat Developers Mailing List','REOPENED','Tomcat 6','Native:Packaging','P2 enhancement','dbc9549','Mark Emlyn David Thomas','2008-09-24 12:21:25','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45879 Move the NOTICE file to the install dir','build.xml\nres/tomcat.nsi'),(1906,45852,'Bug 45852 – conf/tomcat-users.xml has invalid encoding \"cp932\".','Tomcat failed to startup because of it.','2008-09-20 00:17:35','Yousei Itou','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','64851bd','Mark Emlyn David Thomas','2008-09-24 11:47:40','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45852 Add special handling a for charset that Java uses a non-default name for','res/tomcat.nsi'),(1907,45026,'Bug 45026 – Custom HTTP-Error codes get remapped to 500er codes','We use Apache 2.2.8 with mod_JK 1.2.26 as a load-balancer for a Tomcat 5.5 cluster.\nWe use Custom HTTP-Error codes like 450 for authentication-purposes. Those\ncodes get remapped to 500.\nThe Error-Code 450 is in the RFC2616 described as valid return code so this is\na bug.\n\nThe custom error-codes worked fine in Apache 1.3.41 with MOD_JK/1.2.25.\n\nYou can easily reproduce this bug by writing a simple jsp-page with the following\nline:\n<%response.setStatus(450);%>','2008-05-18 04:16:12','Jan Schulte','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Connectors','Common','P2 normal','03097fa','Rainer Jung','2008-09-19 14:51:14','Add Mark\'s proposed fix for BZ 45026: mod_jk + httpd 2.x fails with a null status message.','java/org/apache/jk/common/JkInputStream.java'),(1908,42565,'Bug 42565 – jsp /expression language ternary expression without space before colon stopped working','','2007-06-01 08:43:44','Thomas Wiesel','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','d0c1a7e','Mark Emlyn David Thomas','2008-09-18 15:42:54','Add explicit lookaheads where they could be ambiguity. This resolves some TCK failures with the fix for 42565.','java/org/apache/el/parser/ELParser.jjt'),(1909,45419,'Bug 45419 – Return Accept-Ranges from DefaultServlet','Currently the DefaultServlet accepts the \"Ranges\" request header, but doesn\'t indicate this in its response by returning \"Accept-Ranges: bytes\". Although this is not required in HTTP/1.1, setting the header is required in order for the Adobe Acrobat plugin to correctly handle Linearized PDF\'s (which can speed download by allowing random access to a PDF file).\n\nAlthough it\'s not strictly necessary according to the specification I can\'t think of any reason why this header is not safe to set in a response from DefaultServlet, which is always dealing with static files, and not doing so has a negative impact on serving large PDF files - so I\'m filing it as a bug rather than an RFE.','2008-07-17 07:38:07','Mike Bremford','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','633545f','Mark Emlyn David Thomas','2008-09-17 15:26:22','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45419 Set the Accept-Ranges header on content served from the DefaultServlet. This can be disabled via configuration if required.','conf/web.xml\njava/org/apache/catalina/servlets/DefaultServlet.java\nwebapps/docs/default-servlet.xml'),(1910,45427,'Bug 45427 – Unmatched quotes inside EL break JSP parser','','2008-07-17 23:44:39','Sean Flanigan','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','bfa3f54','Mark Emlyn David Thomas','2008-09-17 08:46:45','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45427 Yet another EL bug. Correct paring of quoted stings.','java/org/apache/jasper/compiler/Parser.java'),(1911,45441,'Bug 45441 – Matching of relevant servlet filters fails when request is forwarded...','I ran into a situation where Tomcat will not execute appropriate filters on a request that has been forwarded.\n\nI\'m using the handy URLRewriteFilter implementation (from tuckey.org).  When I forwarded a request internally, filters that had a matching url-pattern (in the web.xml file) and with a dispatcher setting of both REQUEST and FORWARD were not invoked.\n\nOn tracing the code (hours later), I found that the problem lies inside the ApplicationDispatcher code.  It set the DISPATCHER_REQUEST_PATH_ATTR state attribue to be the servletPath.  That meant that only matches using the servlet path would match, but longer (more exact) urls would fail to match.\n\nFor example, using the following filter mapping:\n\n<filter-mapping>\n   <filter-name>my-filter</filter-name>		   \n   <url-pattern>/app/level/mycode.do</url-pattern>\n   <dispatcher>REQUEST</dispatcher> \n   <dispatcher>FORWARD</dispatcher>\n</filter-mapping>\n\nwould not match a request that was forwarded to /app/level/mycode.do, which it should! \n\nChanging the url pattern to be \"/app/*\" would match, but \"/app/level/*\" would not, since the servletPath was /app in this example.\n\nThe fix for this is quite simple.  In the ApplicationDispatcher.java code, in the method processRequest() (which is only called for forwards), change the following statement:\n\nstate.outerRequest.setAttribute\n   (ApplicationFilterFactory.DISPATCHER_REQUEST_PATH_ATTR,\n   servletPath);\n\nto use requestURI instead as follows:\n\nstate.outerRequest.setAttribute\n   (ApplicationFilterFactory.DISPATCHER_REQUEST_PATH_ATTR,\n   requestURI );\n\nThis resolves the problem and let all the examples above correctly match and run the filter on a forward.\n\nI believe includes will also be broken in the same manner. Similar changes to the doInclude() method in ApplicationDispatcher.java will likely resolve that issue as well, though I have not tested this personally.\n\nBe nice to see this resolved in 6.0.17+.\n\nThanks!\n\n....Andrzej','2008-07-20 10:54:40','Andrzej Taramina','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','2c0fffe','Mark Emlyn David Thomas','2008-09-17 07:11:42','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45441 Filters for INCLUDE/FORWARD need to be matched against servletPath+pathinfo','java/org/apache/catalina/core/ApplicationDispatcher.java'),(1912,45823,'Bug 45823 – AccessLogValve doesn\'t correctly handles combined log format (with patch)','','2008-09-17 02:20:05','Per Landberg','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','678b516','Mark Emlyn David Thomas','2008-09-17 06:56:37','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45823 Log \'-\' rather than null when request headers are not present Based on a patch by Per Landberg','java/org/apache/catalina/valves/AccessLogValve.java'),(1913,45447,'Bug 45447 – Spanish translations','','2008-07-21 05:51:02','Jesus Marin','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','c60a723','Mark Emlyn David Thomas','2008-09-16 17:37:02','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45447 Updated Spanish translations. Patch provided by Jesus Marin.','java/org/apache/catalina/authenticator/LocalStrings_es.properties\njava/org/apache/catalina/connector/LocalStrings_es.properties\njava/org/apache/catalina/core/LocalStrings_es.properties\njava/org/apache/catalina/loader/LocalStrings_es.properties\njava/org/apache/catalina/manager/LocalStrings_es.properties\njava/org/apache/catalina/realm/LocalStrings_es.properties\njava/org/apache/catalina/servlets/LocalStrings_es.properties\njava/org/apache/catalina/session/LocalStrings_es.properties\njava/org/apache/catalina/startup/LocalStrings_es.properties\njava/org/apache/catalina/users/LocalStrings_es.properties\njava/org/apache/catalina/util/LocalStrings_es.properties\njava/org/apache/catalina/valves/LocalStrings_es.properties\njava/org/apache/coyote/http11/LocalStrings_es.properties\njava/org/apache/jasper/resources/LocalStrings_es.properties\njava/org/apache/naming/LocalStrings_es.properties\njava/org/apache/naming/resources/LocalStrings_es.properties\njava/org/apache/tomcat/util/net/jsse/res/LocalStrings_es.properties\njava/org/apache/tomcat/util/net/res/LocalStrings_es.properties'),(1914,45451,'Bug 45451 – Tag file attribute evaluation','','2008-07-22 01:37:27','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','5ec1dab','Mark Emlyn David Thomas','2008-09-16 17:12:38','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45451 Testing for this threw up all sorts of other failures around use of \\${...} These should all now be fixed. The two pass parsing means we can do away with the previous \'replace with unused unicode character\' trick.','java/org/apache/jasper/Constants.java\njava/org/apache/jasper/compiler/Compiler.java\njava/org/apache/jasper/compiler/Generator.java\njava/org/apache/jasper/compiler/JspDocumentParser.java\njava/org/apache/jasper/compiler/JspUtil.java\njava/org/apache/jasper/compiler/Parser.java\njava/org/apache/jasper/compiler/ParserController.java\njava/org/apache/jasper/compiler/Validator.java'),(1915,45785,'Bug 45785 – ClassCastException if directory ending with .jar exists in WEB-INF/lib','Exception occurs if there is a directory in WEB-INF/lib having a .jar ending (e.g. foo.jar). Don\'t know if it makes sense to create such a dir in WEB-INF/lib, in my case a bug in another tool created such a dir. \n\nBut in any case: Tomcat should not crash because of such a directory, IMHO.\n\njava.lang.ClassCastException: org.apache.naming.resources.FileDirContext cannot be cast to org.apache.naming.resources.Resource\n	at org.apache.catalina.util.ExtensionValidator.validateApplication(ExtensionValidator.java:182)\n	at org.apache.catalina.core.StandardContext.start(StandardContext.java:4167)\n	at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:791)\n	at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:771)\n	at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:525)\n	at org.apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.java:627)\n	at org.apache.catalina.startup.HostConfig.deployDescriptors(HostConfig.java:553)\n	at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:488)\n	at org.apache.catalina.startup.HostConfig.start(HostConfig.java:1149)\n	at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:311)\n	at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:117)\n	at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1053)\n	at org.apache.catalina.core.StandardHost.start(StandardHost.java:719)\n	at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1045)\n	at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:443)\n	at org.apache.catalina.core.StandardService.start(StandardService.java:516)\n	at org.apache.catalina.core.StandardServer.start(StandardServer.java:710)\n	at org.apache.catalina.startup.Catalina.start(Catalina.java:578)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n	at java.lang.reflect.Method.invoke(Method.java:597)\n	at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:288)\n	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:413)','2008-09-11 12:22:35','Andreas Sahlbach','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','15b77ca','Mark Emlyn David Thomas','2008-09-14 16:01:21','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45785 Ignore directories named xxx.jar in WEB-INF/lib','java/org/apache/catalina/loader/WebappLoader.java\njava/org/apache/catalina/util/ExtensionValidator.java'),(1916,43117,'Bug 43117 – Dangerousness of workDir setting on Context','','2007-08-14 01:09:44','Takayuki Kaneko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','87f1997','Mark Emlyn David Thomas','2008-09-10 16:02:34','Include fix for 43117 in trunk','java/org/apache/catalina/core/StandardContext.java'),(1917,45618,'Bug 45618 – Selector is not closed.','','2008-08-11 22:45:15','Hao Zhong','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 trivial','d69b378','Mark Emlyn David Thomas','2008-09-02 17:44:37','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45618 Make sure the selector is closed. Almost certain not to be an issue in any real deployment but still - technically - a bug.','java/org/apache/catalina/tribes/transport/nio/ParallelNioSender.java'),(1918,45413,'Bug 45413 – Contribution of Bayeux implementation for Tomcat','','2008-07-16 17:49:44','Filip Hanik','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 enhancement','83fe69a','Filip Hanik','2008-09-02 16:00:36','Added in Bayeux implementation, as per https://issues.apache.org/bugzilla/show_bug.cgi?id=45413 to build, ant download ant ant -f extras.xml bayeux','.classpath\nCOPYRIGHT\nbuild.properties.default\nbuild.xml\nextras.xml\njava/org/apache/cometd/bayeux/Bayeux.java\njava/org/apache/cometd/bayeux/Channel.java\njava/org/apache/cometd/bayeux/Client.java\njava/org/apache/cometd/bayeux/DataFilter.java\njava/org/apache/cometd/bayeux/Listener.java\njava/org/apache/cometd/bayeux/Message.java\njava/org/apache/cometd/bayeux/SecurityPolicy.java\njava/org/apache/tomcat/bayeux/BayeuxException.java\njava/org/apache/tomcat/bayeux/BayeuxRequest.java\njava/org/apache/tomcat/bayeux/BayeuxServlet.java\njava/org/apache/tomcat/bayeux/ChannelImpl.java\njava/org/apache/tomcat/bayeux/ClientImpl.java\njava/org/apache/tomcat/bayeux/HttpError.java\njava/org/apache/tomcat/bayeux/MessageImpl.java\njava/org/apache/tomcat/bayeux/RequestBase.java\njava/org/apache/tomcat/bayeux/RequestFactory.java\njava/org/apache/tomcat/bayeux/TomcatBayeux.java\njava/org/apache/tomcat/bayeux/request/MetaConnectRequest.java\njava/org/apache/tomcat/bayeux/request/MetaDisconnectRequest.java\njava/org/apache/tomcat/bayeux/request/MetaHandshakeRequest.java\njava/org/apache/tomcat/bayeux/request/MetaSubscribeRequest.java\njava/org/apache/tomcat/bayeux/request/MetaUnsubscribeRequest.java\njava/org/apache/tomcat/bayeux/request/PublishRequest.java\ntest/org/apache/cometd/bayeux/samples/EchoChatClient.java\nwebapps/cometd/WEB-INF/filters.json\nwebapps/cometd/WEB-INF/web.xml\nwebapps/cometd/examples/chat/chat.css\nwebapps/cometd/examples/chat/chat.js\nwebapps/cometd/examples/chat/index.html\nwebapps/cometd/examples/dojo/dojo/dojo.js\nwebapps/cometd/examples/dojo/dojo/dojo.js.uncompressed.js\nwebapps/cometd/examples/dojo/dojo/dojo.xd.js\nwebapps/cometd/examples/dojo/dojo/dojo.xd.js.uncompressed.js\nwebapps/cometd/examples/dojo/dojox/cometd.js\nwebapps/cometd/examples/dojo/dojox/cometd.js.uncompressed.js\nwebapps/cometd/examples/dojo/dojox/cometd.xd.js\nwebapps/cometd/examples/dojo/dojox/cometd.xd.js.uncompressed.js\nwebapps/cometd/examples/dojo/dojox/cometd/session.js\nwebapps/cometd/examples/dojo/dojox/cometd/timestamp.js\nwebapps/cometd/examples/dojo/dojox/cometd/timesync.js\nwebapps/cometd/examples/echo/index.html\nwebapps/cometd/examples/simplechat/cometdchat.htm\nwebapps/cometd/examples/tictactoe/resources/0.gif\nwebapps/cometd/examples/tictactoe/resources/1.gif\nwebapps/cometd/examples/tictactoe/resources/10.gif\nwebapps/cometd/examples/tictactoe/resources/blank.gif\nwebapps/cometd/examples/tictactoe/resources/tictactoe.css\nwebapps/cometd/examples/tictactoe/ttt1.htm\nwebapps/cometd/examples/timesync/index.html\nwebapps/cometd/index.html\nwebapps/docs/changelog.xml'),(1919,45628,'Bug 45628 – ExtensionValidator doesn\'t handle wrapped lines in MANIFEST.MF','','2008-08-13 12:47:56','Larry Hartsook','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','3773ec4','Mark Emlyn David Thomas','2008-09-02 11:46:00','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45628 Jars that declare no deps should return that deps are satisfied','java/org/apache/catalina/util/ManifestResource.java'),(1920,45666,'Bug 45666 – JspContextWrapper contains infinite loop in include(String relativeUrlPath, boolean flush)','public void include(String relativeUrlPath, boolean flush)\n			throws ServletException, IOException {\n		include(relativeUrlPath, false); // XXX\n	}\n\njust calls itself it seems. Perhaps this should be (just a guess):\n\npublic void include(String relativeUrlPath, boolean flush)\n			throws ServletException, IOException {\n		invokingJspCtxt.include(relativeUrlPath, false); // XXX\n	}\n\nThis came up for me when I had a .tag file that had an include in it. \n\nI was using Tomcat 5.5 but looking at the source of JspContextWrapper.java it looks like this issue is in 5.5 as well as 6 (and the svn trunk).','2008-08-21 06:47:17','Tom Wadzinski','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 normal','ccc1014','Mark Emlyn David Thomas','2008-08-31 17:06:01','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45666 Patch provided by Tom Wadzinski','java/org/apache/jasper/runtime/JspContextWrapper.java'),(1921,45648,'Bug 45648 – Function \'f:length\' not found','','2008-08-18 19:54:44','Carlos Costa e Silva','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P3 regression','6d40691','Mark Emlyn David Thomas','2008-08-31 15:35:05','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45648 Note ELParser.java is auto-generated','java/org/apache/el/parser/ELParser.java\njava/org/apache/el/parser/ELParser.jjt'),(1922,45691,'Bug 45691 – Jasper creates duplicate variable names','Sometimes a JSP\'s Java code, which have been generated by Jasper, has duplicate variable names. Therefore the JSP cannot be compiled and tomcat delivers an HTTP status code 500. You get an error message like this\n\norg.apache.jasper.JasperException: Unable to compile class for JSP: \nAn error occurred at line: 10 in the jsp file: /test1.jsp\nDuplicate local variable _jspx_temp0\n7: 		<c:set var=\"a\">\n8: 			<jsp:attribute name=\"value\"><%= new java.util.Date().toString() %></jsp:attribute>\n9: 		</c:set>\n10: 		<c:set var=\"b\">\n11: 			<jsp:attribute name=\"value\"><%= new java.util.Date().toString() %></jsp:attribute>\n12: 		</c:set>\n13: 		<h1>Test 1</h1>\n\nThe reason of this error is the generation of variable names like _jspx_temp0, which are created for <jsp:attribute> tags. At the beginning of parsing a JSP file a counter is reset to 0. Every time an <jsp:attribute> tag occurs, the counter is used to build a variable name _jspx_temp<counter>. Thereafter the counter will be incremented. Unfortunately the counter is a static member of the JspUtil class. Suppose there\'s a thread 1, which created _jspx_temp4. The counter is 5. Now a second thread (thread 2) starts and resets the counter. Afterwards thread 2 creates _jspx_temp0 to _jspx_temp3. The counter is 4 by now. Then thread 2 stops and thread 1 continues. The next variable\'s name in thread 1 will be _jspx_temp4, which already exists. Therefore the generated java class cannot be compiled.','2008-08-26 07:23:33','Stefan Birkner','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','337d6a6','Mark Emlyn David Thomas','2008-08-31 09:47:57','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45691 Make temporary variable name generation safe when multiple compilations are running in parallel','java/org/apache/jasper/compiler/Compiler.java\njava/org/apache/jasper/compiler/JspUtil.java\njava/org/apache/jasper/compiler/Node.java\njava/org/apache/jasper/compiler/TagPluginManager.java'),(1923,45074,'Bug 45074 – Add configuration parameters for finer tuning of Http11AprProtocol thread usage','','2008-05-23 15:44:19','Alex Barclay','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 enhancement','6a1f316','Jean-Frederic Clere','2008-08-27 03:42:58','Fix for PR#45074','java/org/apache/coyote/http11/Http11AprProtocol.java\nwebapps/docs/changelog.xml'),(1924,44809,'Bug 44809 – Improve AprLifecycleListener Error Messages','','2008-04-11 10:18:59','Marvin','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 enhancement','46055c5','Jean-Frederic Clere','2008-08-27 03:23:40','Fix for PR#44809','java/org/apache/catalina/core/AprLifecycleListener.java\nwebapps/docs/changelog.xml'),(1925,43327,'Bug 43327 – Socket bind fails on tomcat startup when using apr','I\'m running debian sid, kernel 2.6.22 and use tomcat 6.0.14 together with apr\n1.2.11. no special tomcat configuration (out of the box).\nOn start up of tomcat I get the following error log:\n\nDebugging apr revealed a problem with IPV6:\napr_socket_create() assigns a AF_INET6 socket,\napr_socket_bind tries to bind a AF_INET address which fails.\n\nINFO: Loaded Apache Tomcat Native library 1.1.10.\nSep 7, 2007 6:05:16 PM org.apache.catalina.core.AprLifecycleListener init\nINFO: APR capabilities: IPv6 [true], sendfile [true], accept filters [false],\nrandom [true].\nSep 7, 2007 6:05:16 PM org.apache.coyote.http11.Http11AprProtocol init\nSEVERE: Error initializing endpoint\njava.lang.Exception: Socket bind failed: [22] Invalid argument\n    at org.apache.tomcat.util.net.AprEndpoint.init(AprEndpoint.java:612)\n    at org.apache.coyote.http11.Http11AprProtocol.init(Http11AprProtocol.java:121)\n    at org.apache.catalina.connector.Connector.initialize(Connector.java:1059)\n  \nregards\nerik','2007-09-07 07:22:31','Erik Moller','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Native','Library','P2 normal','fea7658','Jean-Frederic Clere','2008-08-21 09:34:40','JAVA part of the #43327 fix.','java/org/apache/tomcat/util/net/AprEndpoint.java'),(1926,45528,'Bug 45528 – Tomcat 5 fails to detect a matching certificate and stuck in an infinite loop','','2008-08-03 04:22:43','Assaf Vizner','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Connector:Coyote','P2 major','3e05eb3','Mark Emlyn David Thomas','2008-08-21 04:36:43','Update patch for 45528','java/org/apache/tomcat/util/net/jsse/JSSESocketFactory.java'),(1927,45655,'Bug 45655 – check permisson','','2008-08-19 14:13:35','Jens Kapitza','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 trivial','b266836','Mark Emlyn David Thomas','2008-08-20 19:36:36','Remove unnecessary casts. Reported by Jens Kapitza in https://issues.apache.org/bugzilla/show_bug.cgi?id=45655','java/org/apache/juli/ClassLoaderLogManager.java'),(1928,45528,'Bug 45528 – Tomcat 5 fails to detect a matching certificate and stuck in an infinite loop','','2008-08-03 04:22:43','Assaf Vizner','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Connector:Coyote','P2 major','fb8f976','Mark Emlyn David Thomas','2008-08-20 19:20:42','Improved fix for 45528 (invalid SSL config). It is a variation on the previous patch that: - does the check earlier - uses an unbound socket so there is no possibility of a client connection - uses the String manager for the error message Note: I gave up on the alterntaive javax.crypto.Cipher suggestion as the cipher names are different and there is no easy conversion.','java/org/apache/tomcat/util/net/jsse/JSSESocketFactory.java\njava/org/apache/tomcat/util/net/jsse/res/LocalStrings.properties'),(1929,45608,'Bug 45608 – Race conditions on field countAllocated of class org.apache.catalina.core.StandardWrapper','We found field countAllocated are accessed by allocate() and deallocate() without any protections by locks.\n\nHere is a trace log,\n\n  Thread http-8081-1 id: 23 : READ\n      [org.apache.catalina.core.StandardWrapper : allocate : 820]\n      [org.apache.catalina.core.StandardWrapperValve : invoke : 129]\n      [org.apache.catalina.core.StandardContextValve : invoke : 175]\n      [org.apache.catalina.core.StandardHostValve : invoke : 128]\n      [org.apache.catalina.valves.ErrorReportValve : invoke : 104]\n      [org.apache.catalina.core.StandardEngineValve : invoke : 109]\n      [org.apache.catalina.connector.CoyoteAdapter : service : 261]\n      [org.apache.coyote.http11.Http11Processor : process : 844]\n      [org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler : process : 581]\n      [org.apache.tomcat.util.net.JIoEndpoint$Worker : run : 447]\n      [java.lang.Thread : run : 735]\n\n  Thread http-8081-4 id: 26 : WRITE\n\n      [org.apache.catalina.core.StandardWrapper : deallocate : 871]\n      [org.apache.catalina.core.StandardWrapperValve : invoke : 298]\n      [org.apache.catalina.core.StandardContextValve : invoke : 175]\n      [org.apache.catalina.core.StandardHostValve : invoke : 128] \n      [org.apache.catalina.valves.ErrorReportValve : invoke : 104] \n      [org.apache.catalina.core.StandardEngineValve : invoke : 109]\n      [org.apache.catalina.connector.CoyoteAdapter : service : 261]\n      [org.apache.coyote.http11.Http11Processor : process : 844]\n      [org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler : process : 581]\n      [org.apache.tomcat.util.net.JIoEndpoint$Worker : run : 447]\n      [java.lang.Thread : run : 735]\n\nThread http-8081-4 and http-8081-1 will access countAllocated in parallel.  Since increment and decrement is *NOT* atomic, we think it is a potential race condition.','2008-08-10 21:27:37','Yao Qi','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','816ecb8','Mark Emlyn David Thomas','2008-08-12 11:10:23','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45608 Use AtomicInteger for countAllocated to prevent race conditions.','java/org/apache/catalina/core/StandardWrapper.java'),(1930,45528,'Bug 45528 – Tomcat 5 fails to detect a matching certificate and stuck in an infinite loop','','2008-08-03 04:22:43','Assaf Vizner','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Connector:Coyote','P2 major','24dfc12','Mark Emlyn David Thomas','2008-08-10 13:24:51','Fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=45528. Test the SSL socket before returning it to make sure the specified certificate will work with the specified ciphers.','java/org/apache/tomcat/util/net/jsse/JSSESocketFactory.java'),(1931,41407,'Bug 41407 – CLIENT-CERT Authentication with JAASRealm not working','I tried to config my webapp to authenticate user by CLIENT-CERT auth method.\n\nI verified my JAAS LoginModule by using \"BASIC\" to auth method and successfully \nauthenticated user login.\n\nAfter studying Tomcat 5.5.20 source, I found that the problem is caused by the \nRealmBase.java and JAASRealm.java.\n\nif CLIENT-CERT auth method is used, SSLAuthenticator will call the :\n\n  JAASRealm.authenticate(X509Certificate certs[])\n\nAs JAASRealm didn\'t override authenticate(X509Certificate certs[]), RealmBase\'s \nauthenticate will be used and it will only validate the certs and then call\ngetPrincipal(X509Certificate) and then getPrincipal(String) is being called to \nget the Principal. However, in JAASRealm, this function always return null.\n\nThat means Tomcat can\'t use JAASRealm with CLIENT-CERT auth method.\n\nThanks\nButler','2007-01-18 18:33:49','Butler','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','6d78232','Mark Emlyn David Thomas','2008-08-09 10:32:47','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=41407 Add support for CLIENT-CERT authentication to JAAS realm.','java/org/apache/catalina/realm/JAASCallbackHandler.java\njava/org/apache/catalina/realm/JAASMemoryLoginModule.java\njava/org/apache/catalina/realm/JAASRealm.java'),(1932,45576,'Bug 45576 – JAASRealm not working with DigestAuthenticator','','2008-08-06 02:12:34','wasp','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','c984c6a','Mark Emlyn David Thomas','2008-08-09 08:10:34','Fix bug https://issues.apache.org/bugzilla/show_bug.cgi?id=45576 Get the JAASRealm working with DIGEST authentication.','java/org/apache/catalina/realm/JAASCallbackHandler.java\njava/org/apache/catalina/realm/JAASMemoryLoginModule.java\njava/org/apache/catalina/realm/JAASRealm.java'),(1933,45585,'Bug 45585 – Tomcat doesn\'t start when JULI is not used (NoClassDefFoundError)','If there is no file CATALINA_BASE/conf/logging.properties, then Tomcat will not start and the JVM outputs the following error:\n\nException in thread \"main\" java.lang.NoClassDefFoundError:\n\nwithout any additional information.\n\nQuoting from a user\'s mail:\n\nI believe commit 652629 (which appeared in 6.0.17) broke catalina.sh startup when JULI is not used -- that is, when $CATALINA_BASE/conf/logging.properties does not exist.  If this file is absent, LOGGING_CONFIG is not set.  However the variable appears quoted in the shell command to exec the JVM:\n\n    \"$_RUNJAVA\" $JAVA_OPTS \"$LOGGING_CONFIG\" $CATALINA_OPTS ...\n\nWhich introduces an empty argument when LOGGING_CONFIG is unset, and the JVM interprets this empty argument as the class to be invoked.\n\nThree possible fixes are:\n\n* Set LOGGING_CONFIG to a harmless flag if JULI is not used.  With my Sun JVM, a plain -D is safe.  I don\'t know how portable this is.  It isn\'t very pretty.\n\n* Maintain separate JVM invocations for the cases when LOGGING_CONFIG is set and when it\'s unset.  This involves more code duplication.  The code in question is already duplicated; I\'m not sure whether that argues for or against this strategy.\n\n* Use a one-item shell array with an @ subscript, which is immune to word splitting when between double quotes but expands to nothing when unpopulated.  For example:\n\n    LOGGING_CONFIG[0]=\"-Djava.util.logging.config.file=$CATALINA_BASE/conf/logging.properties\"\n\nfollowed by:\n\n    \"$_RUNJAVA\" $JAVA_OPTS \"${LOGGING_CONFIG[@]}\" $CATALINA_OPTS ...\n\nThis method may be too clever.  I think POSIX requires shell arrays but being portable to true Bourne shell would require $@, which is already being used.','2008-08-06 23:42:31','Rainer Jung','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','338a03c','Mark Emlyn David Thomas','2008-08-08 11:49:24','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45585 using a suggestion from Ian Ward Comfort','bin/catalina.sh'),(1934,45591,'Bug 45591 – NullPointerException during shutdown in JKMain.pause()','On startup, if Tomcat discovers that the main port is already bound to another process, it fails and tries to execute the shutdown code.  In some situations (I\'m not sure which), the org.apache.jk.server.JKMain instance variable wEnv is null at this point, which causes a NullPointerException when JKMain.pause() is called (see stacktrace below).  Since this is occurring within a shutdown hook thread, it can result in a dirty shutdown of the JVM.  I\'ve observed this with Tomcat 5.5.20, but I looked over the code in 5.5.26 and it looks like the same problem is still present.\n\nFortunately, the solution is very simple.  Just add the following if test at the beginning of JKMain.pause():\n\n        if (wEnv == null) {\n          return;\n        }\n\n\nStacktrace:\nSEVERE: StandardServer.await: create[8006]: \njava.net.BindException: Address already in use: JVM_Bind\n	at java.net.PlainSocketImpl.socketBind(Native Method)\n	at java.net.PlainSocketImpl.bind(PlainSocketImpl.java:359)\n	at java.net.ServerSocket.bind(ServerSocket.java:319)\n	at java.net.ServerSocket.<init>(ServerSocket.java:185)\n	at org.apache.catalina.core.StandardServer.await(StandardServer.java:372)\n	at org.apache.catalina.startup.Catalina.await(Catalina.java:615)\n	at org.apache.catalina.startup.Catalina.start(Catalina.java:575)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n	at java.lang.reflect.Method.invoke(Method.java:585)\n	at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:294)\n	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:432)\nAug 7, 2008 3:25:34 PM org.apache.coyote.http11.Http11BaseProtocol pause\nINFO: Pausing Coyote HTTP/1.1 on http-8000\nAug 7, 2008 3:25:34 PM org.apache.catalina.connector.Connector pause\nSEVERE: Protocol handler pause failed\njava.lang.NullPointerException\n	at org.apache.jk.server.JkMain.pause(JkMain.java:678)\n	at org.apache.jk.server.JkCoyoteHandler.pause(JkCoyoteHandler.java:162)\n	at org.apache.catalina.connector.Connector.pause(Connector.java:1031)\n	at org.apache.catalina.core.StandardService.stop(StandardService.java:491)\n	at org.apache.catalina.core.StandardServer.stop(StandardServer.java:743)\n	at org.apache.catalina.startup.Catalina.stop(Catalina.java:601)\n	at org.apache.catalina.startup.Catalina$CatalinaShutdownHook.run(Catalina.java:644)','2008-08-07 12:35:38','Matt Passell','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Connector:AJP','P2 normal','38a62a6','Mark Emlyn David Thomas','2008-08-08 10:31:20','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45591 - NPE on start-up failure in some cases','java/org/apache/jk/server/JkMain.java'),(1935,45532,'Bug 45532 – Spelling van = can','Note that this logging <here>van</here> be very verbose depending','2008-08-04 01:12:38','Fu-Tung','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P2 normal','3481d54','Mark Emlyn David Thomas','2008-08-04 18:00:38','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45532 Doc typo','webapps/docs/logging.xml'),(1936,42565,'Bug 42565 – jsp /expression language ternary expression without space before colon stopped working','','2007-06-01 08:43:44','Thomas Wiesel','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','dfd2dad','Mark Emlyn David Thomas','2008-08-01 12:11:14','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=42565 This patch:  - limits the regexp for namespace to what is in the spec  - removes the namespace token since the maximal munch rule means that there is a risk the second and third parts of a ternary expression would, incorrectly, be interpreted as a fucntion call.  - modifies the lookahead for function to be more explicit about what to look for My set of weird and wonderful test cases (mixing ternary, fucntion and empty) now all work. Updated generated files will follow.','java/org/apache/el/parser/ELParser.jjt'),(1937,42565,'Bug 42565 – jsp /expression language ternary expression without space before colon stopped working','','2007-06-01 08:43:44','Thomas Wiesel','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','e36293e','Mark Emlyn David Thomas','2008-08-01 12:05:47','Revert fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=42565 since it caused https://issues.apache.org/bugzilla/show_bug.cgi?id=45511 A better fix for 42565 will follow','java/org/apache/el/parser/ELParser.jjt'),(1938,45511,'Bug 45511 – EL \"empty\" keyword does not work','When using ${empty(xxx)}, EL parser thinks it is an unknown function :empty and throws ClassCastException:\n\njava.lang.ClassCastException: java.lang.NullPointerException\n	at org.apache.el.lang.ExpressionBuilder.prepare(ExpressionBuilder.java:135)\n	at org.apache.el.lang.ExpressionBuilder.build(ExpressionBuilder.java:147)\n	at org.apache.el.lang.ExpressionBuilder.createValueExpression(ExpressionBuilder.java:190)\n	at org.apache.el.ExpressionFactoryImpl.createValueExpression(ExpressionFactoryImpl.java:68)\n	at org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate(PageContextImpl.java:924)\n\n\nI think it is because of some changes in ELParser.java....\n\nwith best regards\nGrzegorz Grzybek','2008-07-31 02:36:27','Grzegorz Grzybek','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 major','e36293e','Mark Emlyn David Thomas','2008-08-01 12:05:47','Revert fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=42565 since it caused https://issues.apache.org/bugzilla/show_bug.cgi?id=45511 A better fix for 42565 will follow','java/org/apache/el/parser/ELParser.jjt'),(1939,42565,'Bug 42565 – jsp /expression language ternary expression without space before colon stopped working','','2007-06-01 08:43:44','Thomas Wiesel','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','e36293e','Mark Emlyn David Thomas','2008-08-01 12:05:47','Revert fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=42565 since it caused https://issues.apache.org/bugzilla/show_bug.cgi?id=45511 A better fix for 42565 will follow','java/org/apache/el/parser/ELParser.jjt'),(1940,45509,'Bug 45509 – One typo, one grammer','Typo at <here> tags\n\nBuild the commons-logging additional component using the extras.xml Ant build script which is part of <here>teh</here> Tomcat source bundle.\n\nGrammer at <here> tags\n\nTomcat 6 <here>uses defines</here> loggers by Engine and Host names.','2008-07-30 15:18:49','Fu-Tung','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P2 normal','52f9b2d','Mark Emlyn David Thomas','2008-07-30 18:37:11','Fix 45509 - typos','webapps/docs/logging.xml'),(1941,45453,'Bug 45453 – JDBCRealm.getRoles bad synchronization causes hangs w/ DIGEST authentication','JDBCRealm.getRoles bad synchronization causes hangs w/ DIGEST authentication\n\nJDBCRealm caches PreparedStatement preparedRoles. That, and missing synchronization in JDBCRealm and/or DigestAuthenticator allow two threads to call getRoles simultaneously so that T1 will do stmt.executeQuery() while T2 does stmt.setString(1, userName) plus another .executeQuery() on the same PreparedStatement object.\n\nIn the worst case, the JDBC driver gets confused by this, and blocks forever waiting for server response, causing all other threads that try to access DB hang. (This was observed with PostgreSQL 8.3-603-jdbc4 JDBC driver)\n\norg.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:451)\norg.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:350)\norg.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:254)\norg.apache.catalina.realm.JDBCRealm.getRoles(JDBCRealm.java:631)\norg.apache.catalina.realm.JDBCRealm.getPrincipal(JDBCRealm.java:596)\norg.apache.catalina.realm.RealmBase.authenticate(RealmBase.java:399)\norg.apache.catalina.authenticator.DigestAuthenticator.findPrincipal(DigestAuthenticator.java:283)\norg.apache.catalina.authenticator.DigestAuthenticator.authenticate(DigestAuthenticator.java:176)','2008-07-22 02:25:02','Santtu Hyrkkö','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','9d3cad7','Mark Emlyn David Thomas','2008-07-29 10:58:05','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45453 Add yet more synchronisation to JDBCRealm. Based on a patch provided by Santtu Hyrkk.','java/org/apache/catalina/realm/JDBCRealm.java'),(1942,45459,'Bug 45459 – Startup Listener error message unhelpful','','2008-07-22 08:44:55','Fu-Tung','Tomcat Developers Mailing List','RESOLVED WONTFIX','Tomcat 6','Jasper','P2 normal','4cab5f3','Mark Emlyn David Thomas','2008-07-29 10:29:27','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45459 Provide info on possible cause of exception.','java/org/apache/catalina/core/LocalStrings.properties\njava/org/apache/catalina/core/StandardContext.java'),(1943,45422,'Bug 45422 – typo corrections, ssl-howto','','2008-07-17 13:20:57','David Barnes','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P2 normal','36de115','Jean-Frederic Clere','2008-07-18 02:39:45','Grammar + typos: Fix PR#45422','webapps/docs/ssl-howto.xml'),(1944,42727,'Bug 42727 – CoyoteReader readLine returns null for some post request bodies that are a multiple of MAX_LINE_LENGTH in size','','2007-06-23 06:29:58','mike','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Connector:Coyote','P3 normal','92f847d','Mark Emlyn David Thomas','2008-07-17 18:09:18','Fix bug 42727. Handle request lines that are exact multiples of 4096 in length. Patch provided by Will Pugh.','java/org/apache/catalina/connector/CoyoteReader.java'),(1945,42722,'Bug 42722 – Potential NullPointerException in org.apache.catalina.servlets.CGIServlet','','2007-06-22 05:21:27','Nils Hammar','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','d41f610','Mark Emlyn David Thomas','2008-07-10 17:11:16','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=42722 Possible NPE in CGIServlet.java Patch provided by Nils Hammar','java/org/apache/catalina/servlets/CGIServlet.java'),(1946,42565,'Bug 42565 – jsp /expression language ternary expression without space before colon stopped working','','2007-06-01 08:43:44','Thomas Wiesel','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','1f17ad2','Mark Emlyn David Thomas','2008-07-10 16:53:24','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=42565 el ternary expression without space before colon now works Patch provided by Lucas Galfaso This is just the jjt patch. The resulting changes to the generated code will follow.','java/org/apache/el/parser/ELParser.jjt'),(1947,42678,'Bug 42678 – docBase ignored even if its not a subdir of appBase','I use latest 6.0 SVN snapshot. I store deployable WARs in \"webapps-dist\" (aside\n\"webapps\"). This is my setup:\n\nbash-3.2$ ls $CATALINA_BASE \nconf  logs  temp  tomcat-dist  webapps  webapps-dist  work\nbash-3.2$ ls  webapps-dist\nsample.war\nbash-3.2$ cat conf/Catalina/localhost/sample.xml\n<Context docBase=\"${catalina.base}/webapps-dist/sample.war\"/>\n\nthis ends up in: \n\nWARNUNG: A docBase /home/juergen/java/tomcat/webapps-dist/sample.war inside the\nhost appBase has been specified, and will be ignored','2007-06-15 15:07:50','J','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 minor','252fca1','Mark Emlyn David Thomas','2008-07-10 13:01:23','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=42678 Only ignore docBase it it really is a subdir of appBase Patch provided by juergen','java/org/apache/catalina/startup/HostConfig.java'),(1948,45285,'Bug 45285 – RESOURCES DECLARED IN PARENT CLASSES ARE NOT INJECTED','According to the section EE.5.2.3 of the Java EE specification:\n------------------------\nResource annotations may appear on any of the classes listed above, or on any superclass of any class listed above. A resource annotation on any class in the inheritance hierarchy defines a resource needed by the application component.\n------------------------\n\nI use JSF managed beans with @EJB annotated members.\nIf a resource is annotated in a super class of a class it\'s not injected.\n\nExample:\n\npublic class Base{\n@EJB\nprivate SomeService service;\n....\n}\n\npublic class Child implements Base{\n....\n}\n\nBase class used as managed bean has \'service\' injected.\nChild class used as managed bean does NOT have \'service\' injected.\n\nIf I dare suggest the problem source ...\n\nAs I can see org.apache.catalina.util.DefaultAnnotationProcessor is used. It has the following lines in its  \'public void processAnnotations(Object instance)\' method:\n....\nField[] fields = instance.getClass().getDeclaredFields();\n....\nMethod[] methods = instance.getClass().getDeclaredMethods();\n....\n\n\nClass.getDeclaredFields method returns \'public, protected, default (package) access, and private fields, but excludes inherited fields\'.\n\nThe same thing is with Class.getDeclaredMethods.','2008-06-25 23:58:28','Florent BENOIT','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Servlet & JSP API','P3 normal','518cc2a','Mark Emlyn David Thomas','2008-07-09 16:50:18','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45285 Should look for annotations all the way up the class hierarchy','java/org/apache/catalina/core/DefaultInstanceManager.java'),(1949,45323,'Bug 45323 – Documentation doesn\'t specify that each context.xml may only contain one <Context/> element','','2008-07-01 23:05:19','Lars Kotthoff','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Webapps:Documentation','P2 minor','5e20980','Mark Emlyn David Thomas','2008-07-06 16:02:06','Fix bug 45323. Add note that context.xml files can only contain a single Context.','webapps/docs/config/context.xml'),(1950,45332,'Bug 45332 – Encoding issue - Admin password created by Windows installer','','2008-07-03 03:02:50','Michael Bürschgens','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','b746731','Mark Emlyn David Thomas','2008-07-06 15:31:20','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45332 Specify the correct encoding (the current windows code page) rather than assuming UTF-8 when creating tomcat-users.xml','res/confinstall/tomcat-users_1.xml\nres/tomcat.nsi'),(1951,45310,'Bug 45310 – aliaises >> aliases','','2008-06-29 10:29:21','ole ersoy','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P2 normal','ce58da8','Mark Emlyn David Thomas','2008-07-04 03:52:17','Fix 45310, 45308 and a couple of additional typos. Also use OpenSSL consistently and fix a very long line.','webapps/docs/ssl-howto.xml'),(1952,45308,'Bug 45308 – alaises >> aliases','','2008-06-29 10:24:07','ole ersoy','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P2 normal','ce58da8','Mark Emlyn David Thomas','2008-07-04 03:52:17','Fix 45310, 45308 and a couple of additional typos. Also use OpenSSL consistently and fix a very long line.','webapps/docs/ssl-howto.xml'),(1953,45317,'Bug 45317 – DeltaManager always reports default timeout value for receiving session state on startup','Hi there,\n\nIf I override the state transfer timeout:\n          <Manager className=\"org.apache.catalina.ha.session.DeltaManager\"\n                   stateTransferTimeout=\"10\"\n                   expireSessionsOnShutdown=\"false\"\n                   notifyListenersOnReplication=\"true\"/>\n\nDeltaManager continues to log the default timeout value (ie: \"This operation will timeout if no session state has been received within 60 seconds.\"):\n\n2008-07-01 14:31:30,419 WARN [org.apache.catalina.ha.session.DeltaManager] - Manager [localhost#/manager], requesting session state from org.apache.catalina.tribes.membership.MemberImpl[tcp://{10, -64, 104, -55}:15000,{10, -64, 104, -55},15000, alive=18586,id={-62 91 -70 -63 -111 50 70 -33 -104 41 -48 -32 91 34 -83 -55 }, payload={}, command={}, domain={}, ]. This operation will timeout if no session state has been received within 60 seconds. \n2008-07-01 14:31:35,310 WARN [org.apache.catalina.ha.ClusterListener] - Context manager doesn\'t exist:localhost#/host-manager \n\nBut it actually uses the correct timeout value (ie: \"timing out after 10,100 ms\"):\n\n2008-07-01 14:31:40,518 ERROR [org.apache.catalina.ha.session.DeltaManager] - Manager [localhost#/manager]: No session state send at 01/07/08 14:31 received, timing out after 10,100 ms. \n\nThis is only an incorrect message, but it is quite annoying especially coupled with the fact that the above configuration is only documented for tomcat 5 (where syntax is subtly different).','2008-07-01 07:50:35','Viktor Radnai','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Cluster','P5 trivial','36bb5d9','Filip Hanik','2008-07-02 16:41:10','Fix for bug 45317, document and properly output the session timeout time','java/org/apache/catalina/ha/session/DeltaManager.java\njava/org/apache/catalina/ha/session/LocalStrings.properties\nwebapps/docs/config/cluster-manager.xml'),(1954,45309,'Bug 45309 – implmentations >> implementations','','2008-06-29 10:26:12','ole ersoy','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P2 normal','3b0204f','Jean-Frederic Clere','2008-07-02 04:44:37','typo: 45309','webapps/docs/ssl-howto.xml'),(1955,36155,'Bug 36155 – tomcat chooses wrong host if using mod_jk','','2005-08-12 05:08:52','Sven','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Connectors','Common','P2 normal','f23907d','William Barker','2008-06-27 22:11:48','port fix for BZ 36155 from the JK Connector','java/org/apache/coyote/ajp/AjpMessage.java'),(1956,45277,'Bug 45277 – Minor Spelling: ${sytstemPropertyName} >> ${systemPropertyName}','','2008-06-25 10:27:48','ole ersoy','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P2 normal','4773531','Mark Emlyn David Thomas','2008-06-27 17:48:41','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45277 Correct typo','webapps/docs/logging.xml'),(1957,43683,'Bug 43683 – Accessing Servlet while Reloading context gives 404 error','','2007-10-23 09:43:12','Joe Kislo','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','39a2465','Mark Emlyn David Thomas','2008-06-27 17:39:27','Fix for part 3 of https://issues.apache.org/bugzilla/show_bug.cgi?id=43683 This isn\'t perfect but it narrows the window for the race condition significantly. A perfect fix would require syncing most (all?) of allocate() which is on the critical path.','java/org/apache/catalina/core/StandardWrapper.java'),(1958,45272,'Bug 45272 – Version 1 cookie not persisted in IE','A cookie with value \"MIGCBgkrBgEEAYI3WAOgdTBzBgorBgEEAYI3WAMBoGUwYwIDAgABAgJmAwICAMAECN7UUhW1gKdu%0ABBBgywr0Nm%2FxNVdoCHCcNMB2BDiF%2FIwn6i47%2B1H0fKHpkJeDVFhEvyYKke1zTGupImD7r2JOcdo%2F%0A6%2FK85sELQu%2BbOW%2BH9lhDfwdxHA%3D%3D\"\nand version 1 is persisted correctly and returned using tomcat 5.5.26 and Firefox but not persisted using tomcat 5.5.26 and IE.\n\nThis issue is not present in 5.5.25.','2008-06-24 10:56:24','Dave','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','c892641','Filip Hanik','2008-06-26 14:25:30','doco update for fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=45272','webapps/docs/changelog.xml'),(1959,45272,'Bug 45272 – Version 1 cookie not persisted in IE','A cookie with value \"MIGCBgkrBgEEAYI3WAOgdTBzBgorBgEEAYI3WAMBoGUwYwIDAgABAgJmAwICAMAECN7UUhW1gKdu%0ABBBgywr0Nm%2FxNVdoCHCcNMB2BDiF%2FIwn6i47%2B1H0fKHpkJeDVFhEvyYKke1zTGupImD7r2JOcdo%2F%0A6%2FK85sELQu%2BbOW%2BH9lhDfwdxHA%3D%3D\"\nand version 1 is persisted correctly and returned using tomcat 5.5.26 and Firefox but not persisted using tomcat 5.5.26 and IE.\n\nThis issue is not present in 5.5.25.','2008-06-24 10:56:24','Dave','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','b00e836','Filip Hanik','2008-06-26 14:24:18','work around for IE not being RFC compliant, IE doesn\'t like quotes around the path value, even though a slash is considered a header delimiter and must be quoted, fix for bug https://issues.apache.org/bugzilla/show_bug.cgi?id=45272','java/org/apache/tomcat/util/http/ServerCookie.java'),(1960,45279,'Bug 45279 – McastServiceImpl leaks sockets.','McastServiceImpl does not close its socket in stop() as it claims. It merely calls leaveGroup(), which is sufficient to stop receiving messages, but does not close the socket. \n\nThis causes a file descriptor leak each time the service is stopped.\n\nadd;\n\nsocket.close();\n\nafter leaveGroup();','2008-06-25 12:21:15','Robert Newson','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Cluster','P2 normal','a2a7714','Filip Hanik','2008-06-25 16:44:48','fix for bug 45279, close multicast socket on close','java/org/apache/catalina/tribes/membership/McastServiceImpl.java'),(1961,45015,'Bug 45015 – Quoting in attributes','According to JSP 2.0 specification (chapter 1.7 page 72,73)\n\nThis code is illegal:\n<mytags:tag value=\"<%= \"hi!\" %>\" />\n\nInstead the correct sentence would be:\n<mytags:tag value=\'<%= \"hi!\" %>\' />\n<mytags:tag value=\"<%= \\\"hi!\\\" %>\" />\n<mytags:tag value=\'<%= \\\"name\\\" %>\' />\n...\n\nBut Tomcat 5.5 accept the first sentence. It\'s not a real bug but accepting a wrong sentence allow developpers to write code which does not respect the JSP specification. And when this code is executing in another servlet container (Websphere 6.1 for example) it doesn\'t work.','2008-05-16 04:22:28','Eric Taix','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Servlet & JSP API','P2 normal','04b1925','Mark Emlyn David Thomas','2008-06-20 17:34:09','Provide an option to disable the fix for 45015 that raised an error if attributes were not correctly quoted.','java/org/apache/jasper/compiler/Parser.java\nwebapps/docs/config/systemprops.xml'),(1962,45195,'Bug 45195 – Possible regression issue with HttpSession.getAtttribute()','We just upgraded from Tomcat 5.0.x to 5.5.26.  In Tomcat 5.0.x, the following code returned NULL to obj:\n\nHttpSession session = request.getSession(true);\nObject obj = session.getAttribute(null);\n\nIn Tomcat 5.5.26, that same code raises this exception:\n\njava.lang.NullPointerException\njava.util.Hashtable.get(Unknown Source)\norg.apache.catalina.session.StandardSession.getAttribute(StandardSession.java:1024) org.apache.catalina.session.StandardSessionFacade.getAttribute(StandardSessionFacade.java:110) NewServlet.processRequest(NewServlet.java:29) NewServlet.doGet(NewServlet.java:52) javax.servlet.http.HttpServlet.service(HttpServlet.java:690) javax.servlet.http.HttpServlet.service(HttpServlet.java:803)\n\nI know how to code around it, but doesn\'t this qualify as a bug, at least for regression purposes?\n\nFYI: I\'m using JDK 5.','2008-06-12 11:59:07','Jonathan','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Unknown','P2 normal','cfd911b','Mark Emlyn David Thomas','2008-06-17 18:13:00','Additional check related to bug 45195.','java/org/apache/catalina/session/StandardSession.java'),(1963,45212,'Bug 45212 – AbstractReplicatedMap.entrySet returns values not entries.','AbstractReplicatedMap implements entrySet() as follows;\n\n        public Set entrySet() {\n            LinkedHashSet set = new LinkedHashSet(super.size());\n            Iterator i = super.entrySet().iterator();\n            while ( i.hasNext() ) {\n                Map.Entry e = (Map.Entry)i.next();\n                Object key = e.getKey();\n                MapEntry entry = (MapEntry)super.get(key);\n                if ( entry != null && entry.isPrimary() ) set.add(entry.getValue());\n            }\n            return Collections.unmodifiableSet(set);\n        }\n\nthis returns a set of all the *values*, the line set.add(entry.getValue()) should be set.add(entry);','2008-06-16 08:09:43','Robert Newson','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Cluster','P2 normal','eea89da','Mark Emlyn David Thomas','2008-06-17 18:04:50','Apply Filip\'s better patch for https://issues.apache.org/bugzilla/show_bug.cgi?id=45212 Map.entrySet() should return entries, not values','java/org/apache/catalina/tribes/tipis/AbstractReplicatedMap.java'),(1964,45212,'Bug 45212 – AbstractReplicatedMap.entrySet returns values not entries.','AbstractReplicatedMap implements entrySet() as follows;\n\n        public Set entrySet() {\n            LinkedHashSet set = new LinkedHashSet(super.size());\n            Iterator i = super.entrySet().iterator();\n            while ( i.hasNext() ) {\n                Map.Entry e = (Map.Entry)i.next();\n                Object key = e.getKey();\n                MapEntry entry = (MapEntry)super.get(key);\n                if ( entry != null && entry.isPrimary() ) set.add(entry.getValue());\n            }\n            return Collections.unmodifiableSet(set);\n        }\n\nthis returns a set of all the *values*, the line set.add(entry.getValue()) should be set.add(entry);','2008-06-16 08:09:43','Robert Newson','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Cluster','P2 normal','706e5b3','Mark Emlyn David Thomas','2008-06-16 13:22:36','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45212 Map.entrySet() should return entries, not values','java/org/apache/catalina/tribes/tipis/AbstractReplicatedMap.java'),(1965,43683,'Bug 43683 – Accessing Servlet while Reloading context gives 404 error','','2007-10-23 09:43:12','Joe Kislo','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','ab86870','Mark Emlyn David Thomas','2008-06-13 16:40:27','Another fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=43683 There was a short period where the context didn\'t appear in the mapper that resulted in some more 404s.','java/org/apache/catalina/connector/MapperListener.java'),(1966,45195,'Bug 45195 – Possible regression issue with HttpSession.getAtttribute()','We just upgraded from Tomcat 5.0.x to 5.5.26.  In Tomcat 5.0.x, the following code returned NULL to obj:\n\nHttpSession session = request.getSession(true);\nObject obj = session.getAttribute(null);\n\nIn Tomcat 5.5.26, that same code raises this exception:\n\njava.lang.NullPointerException\njava.util.Hashtable.get(Unknown Source)\norg.apache.catalina.session.StandardSession.getAttribute(StandardSession.java:1024) org.apache.catalina.session.StandardSessionFacade.getAttribute(StandardSessionFacade.java:110) NewServlet.processRequest(NewServlet.java:29) NewServlet.doGet(NewServlet.java:52) javax.servlet.http.HttpServlet.service(HttpServlet.java:690) javax.servlet.http.HttpServlet.service(HttpServlet.java:803)\n\nI know how to code around it, but doesn\'t this qualify as a bug, at least for regression purposes?\n\nFYI: I\'m using JDK 5.','2008-06-12 11:59:07','Jonathan','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Unknown','P2 normal','9b7c3a1','Mark Emlyn David Thomas','2008-06-13 13:43:51','Fix bug 45195. NPE when calling getAttribute(null). The spec is unclear but this is a regression from 5.0.x','java/org/apache/catalina/session/StandardSession.java'),(1967,45101,'Bug 45101 – DirContextURLConnection - Format Date Header Values per HTTP spec','','2008-05-29 13:42:51','Chris Hubick','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','e0200b0','Mark Emlyn David Thomas','2008-05-29 17:32:02','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45101 Format dates for header value from DirContextURLConnection using HTTP format. Patch provided by Chris Hubick.','java/org/apache/naming/resources/DirContextURLConnection.java'),(1968,43683,'Bug 43683 – Accessing Servlet while Reloading context gives 404 error','','2007-10-23 09:43:12','Joe Kislo','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','36e7f3e','Mark Emlyn David Thomas','2008-05-28 16:42:22','Additional fix for https://issues.apache.org/bugzilla/show_bug.cgi?id=43683 If the context is reloaded, the classloader will have changed so need to reset it','java/org/apache/catalina/core/StandardContextValve.java'),(1969,42747,'Bug 42747 – Context className attribute ignored for contexts deployed from descriptors in web/META-INF/context.xml','When deploying an app from a context descriptor inside a webapp/META-INF\ndirectory via context.xml, the className is ignored and the context is created\nas a StandardContext.  I\'ve tried to use a ReplicatedContext class in a cluster\nfrom this configuration and it does not work.  However, it does work if i move\nthe context.xml to $CATALINA_BASE/conf/[EngineName]/[HostName]/webapp.xml.','2007-06-26 11:41:53','randy hoffman','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','3b0ea85','Mark Emlyn David Thomas','2008-05-22 15:17:38','Revert changes for 42747 whilst I work on a better fix.','java/org/apache/catalina/startup/HostConfig.java'),(1970,42747,'Bug 42747 – Context className attribute ignored for contexts deployed from descriptors in web/META-INF/context.xml','When deploying an app from a context descriptor inside a webapp/META-INF\ndirectory via context.xml, the className is ignored and the context is created\nas a StandardContext.  I\'ve tried to use a ReplicatedContext class in a cluster\nfrom this configuration and it does not work.  However, it does work if i move\nthe context.xml to $CATALINA_BASE/conf/[EngineName]/[HostName]/webapp.xml.','2007-06-26 11:41:53','randy hoffman','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','ebc90c5','Mark Emlyn David Thomas','2008-05-19 17:47:19','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=42747. Actually fixes a number of related bugs:  - For a new WAR, use META-INF/context.xml for first initiation rather than copying it then using it on next start  - For a new dir, use META-INF/context.xml for first initiation  - For a new dir, copy any META-INF/context.xml to $CATALINA_BASE/[engine]/[host]/contextPath.xml','java/org/apache/catalina/startup/HostConfig.java'),(1971,42750,'Bug 42750 – Http Post requests not handled correctly if there is more than one space between the \"POST\" and the URL','','2007-06-26 16:57:13','Dick Salisbury','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Connector:Coyote','P3 normal','f93376d','Mark Emlyn David Thomas','2008-05-19 16:07:20','Note: This patch is on the critical path. Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=42750 Making parsing of the request line tolerant of multiple SP and/or HT rather than requiring single SP characters.','java/org/apache/coyote/http11/InternalAprInputBuffer.java\njava/org/apache/coyote/http11/InternalInputBuffer.java\njava/org/apache/coyote/http11/InternalNioInputBuffer.java'),(1972,43094,'Bug 43094 – Allowing non-file based keystore and other providers','Hello,\n\nI would like to use the MacOSX Keychain store for providing my \ncertificates to Tomcat. Generally speaking, this can be done by loading the\nKeyStore like this:\n\n  KeyStore keyStore = KeyStore.getInstance(\"KeychainStore\",\"Apple\");\n  keyStore.load(null, null);\n  \nIn fact, it seems to work without specifying the \"Apple\" provider too.\nHowever, similarly to PKCS11, this type does not require an input file.\n\nThe problem is that org.apache.tomcat.util.net.jsse.JSSESocketFactory\nalways tries to load a file, except when the type is PKCS11.\n\nNot specifying a keystoreFile or truststoreFile parameter defaults to\ntrying to load ~/.keystore. I would like to suggest the following patch\nwhich allows to specify an empty value, indicating the no file needs to\nbe loaded:\n\n--- JSSESocketFactory.java.old  2007-08-11 22:58:24.000000000 +0200\n+++ JSSESocketFactory.java      2007-08-11 23:24:53.000000000 +0200\n@@ -307,7 +307,7 @@\n         InputStream istream = null;\n         try {\n             ks = KeyStore.getInstance(type);\n-            if(! \"PKCS11\".equalsIgnoreCase(type) ) {\n+            if(! \"\".equalsIgnoreCase(path) ) {\n                 File keyStoreFile = new File(path);\n                 if (!keyStoreFile.isAbsolute()) {\n                     keyStoreFile = new File(System.getProperty(\"catalina.base\"),\n                     \n                     \nThis way, not having to load a file is not limited to PKCS11, but could be \nused by other keystore types.\nUsing this patch, the following configuration works fine with keys and\ncertificates stored in the Apple Keychain (for some reason, the KeychainStore \nrequires a non-empty password; it seems to work whatever the password is, \nsince it may be asked interactively by the Keychain utility, depending on \nhow it is set up)\n\n<Connector SSLEnabled=\"true\" clientAuth=\"want\"\n	keystoreFile=\"\" keystorePass=\"-\"\n	keystoreType=\"KeychainStore\" maxThreads=\"150\" port=\"8443\"\n	keyAlias=\"myhost.mydomain.tld\"\n	protocol=\"HTTP/1.1\" scheme=\"https\" secure=\"true\" sslProtocol=\"TLS\"\n	truststoreFile=\"\"\n	truststorePass=\"-\" truststoreType=\"KeychainStore\" />\n			\n\nRegards,\n\nBruno.','2007-08-11 14:50:54','Bruno Harbulot','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 normal','8b0004d','Mark Emlyn David Thomas','2008-05-17 15:55:55','Additional patch from https://issues.apache.org/bugzilla/show_bug.cgi?id=43094 Make SSL providers configurable. Based on a patch by Bruno Harbulot.','java/org/apache/tomcat/util/net/jsse/JSSESocketFactory.java\nwebapps/docs/config/http.xml'),(1973,44994,'Bug 44994 – JSP EL condition expression fails when nested: ${a ? b ? x: y: z}','','2008-05-13 23:38:42','James Manger','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','a415669','Mark Emlyn David Thomas','2008-05-17 13:33:43','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=44994 Correct BNF grammar so  ${0 lt a ? 1 lt a ? \"many\": \"one\": \"none\"} does not throw an exception The patch is bigger than I would like due to the code generation tools used','java/org/apache/el/parser/ELParser.html\njava/org/apache/el/parser/ELParser.java\njava/org/apache/el/parser/ELParser.jjt\njava/org/apache/el/parser/ELParserConstants.java\njava/org/apache/el/parser/ELParserTokenManager.java\njava/org/apache/el/parser/ParseException.java'),(1974,45015,'Bug 45015 – Quoting in attributes','According to JSP 2.0 specification (chapter 1.7 page 72,73)\n\nThis code is illegal:\n<mytags:tag value=\"<%= \"hi!\" %>\" />\n\nInstead the correct sentence would be:\n<mytags:tag value=\'<%= \"hi!\" %>\' />\n<mytags:tag value=\"<%= \\\"hi!\\\" %>\" />\n<mytags:tag value=\'<%= \\\"name\\\" %>\' />\n...\n\nBut Tomcat 5.5 accept the first sentence. It\'s not a real bug but accepting a wrong sentence allow developpers to write code which does not respect the JSP specification. And when this code is executing in another servlet container (Websphere 6.1 for example) it doesn\'t work.','2008-05-16 04:22:28','Eric Taix','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Servlet & JSP API','P2 normal','955bfac','Mark Emlyn David Thomas','2008-05-16 18:28:09','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=45015 You can\'t use an unescaped quote in an attribute value if you have quoted the value using that quote character','java/org/apache/jasper/compiler/Parser.java\njava/org/apache/jasper/resources/LocalStrings.properties'),(1975,44968,'Bug 44968 – say in error message which keystore causes the problems','since a server.xml may have multiple keystores, if there are problems, say which one is the culprit.\n\ni.e. in org.apache.tomcat.util.net.jsse.JSSESocketFactory.getStore(String type, String path, String pass) in the catch blocks, cite at least the \"type\", and \"path\", better even also the \'<Service name\' and \'<Connector port\'\n\n\n\nMay 10, 2008 8:03:10 AM org.apache.coyote.http11.Http11Protocol init\nSEVERE: Error initializing endpoint\njava.io.IOException: Keystore was tampered with, or password was incorrect\n        at sun.security.provider.JavaKeyStore.engineLoad(JavaKeyStore.java:768)\n        at java.security.KeyStore.load(KeyStore.java:1150)\n        at org.apache.tomcat.util.net.jsse.JSSESocketFactory.getStore(JSSESocketFactory.java:321)\n        at org.apache.tomcat.util.net.jsse.JSSESocketFactory.getKeystore(JSSESocketFactory.java:261)\n        at org.apache.tomcat.util.net.jsse.JSSESocketFactory.getKeyManagers(JSSESocketFactory.java:412)\n        at org.apache.tomcat.util.net.jsse.JSSESocketFactory.init(JSSESocketFactory.java:383)\n        at org.apache.tomcat.util.net.jsse.JSSESocketFactory.createSocket(JSSESocketFactory.java:127)\n        at org.apache.tomcat.util.net.JIoEndpoint.init(JIoEndpoint.java:496)\n        at org.apache.coyote.http11.Http11Protocol.init(Http11Protocol.java:177)\n        at org.apache.catalina.connector.Connector.initialize(Connector.java:1059)\n        at org.apache.catalina.core.StandardService.initialize(StandardService.java:677)\n        at org.apache.catalina.core.StandardServer.initialize(StandardServer.java:792)\n        at org.apache.catalina.startup.Catalina.load(Catalina.java:518)\n        at org.apache.catalina.startup.Catalina.load(Catalina.java:538)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)','2008-05-11 06:28:00','Ralf Hauser','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 normal','4607cef','Mark Emlyn David Thomas','2008-05-15 13:07:31','Improved fix https://issues.apache.org/bugzilla/show_bug.cgi?id=44968 as a single patch Provide more information when keystore load fails','java/org/apache/tomcat/util/net/jsse/JSSESocketFactory.java'),(1976,44968,'Bug 44968 – say in error message which keystore causes the problems','since a server.xml may have multiple keystores, if there are problems, say which one is the culprit.\n\ni.e. in org.apache.tomcat.util.net.jsse.JSSESocketFactory.getStore(String type, String path, String pass) in the catch blocks, cite at least the \"type\", and \"path\", better even also the \'<Service name\' and \'<Connector port\'\n\n\n\nMay 10, 2008 8:03:10 AM org.apache.coyote.http11.Http11Protocol init\nSEVERE: Error initializing endpoint\njava.io.IOException: Keystore was tampered with, or password was incorrect\n        at sun.security.provider.JavaKeyStore.engineLoad(JavaKeyStore.java:768)\n        at java.security.KeyStore.load(KeyStore.java:1150)\n        at org.apache.tomcat.util.net.jsse.JSSESocketFactory.getStore(JSSESocketFactory.java:321)\n        at org.apache.tomcat.util.net.jsse.JSSESocketFactory.getKeystore(JSSESocketFactory.java:261)\n        at org.apache.tomcat.util.net.jsse.JSSESocketFactory.getKeyManagers(JSSESocketFactory.java:412)\n        at org.apache.tomcat.util.net.jsse.JSSESocketFactory.init(JSSESocketFactory.java:383)\n        at org.apache.tomcat.util.net.jsse.JSSESocketFactory.createSocket(JSSESocketFactory.java:127)\n        at org.apache.tomcat.util.net.JIoEndpoint.init(JIoEndpoint.java:496)\n        at org.apache.coyote.http11.Http11Protocol.init(Http11Protocol.java:177)\n        at org.apache.catalina.connector.Connector.initialize(Connector.java:1059)\n        at org.apache.catalina.core.StandardService.initialize(StandardService.java:677)\n        at org.apache.catalina.core.StandardServer.initialize(StandardServer.java:792)\n        at org.apache.catalina.startup.Catalina.load(Catalina.java:518)\n        at org.apache.catalina.startup.Catalina.load(Catalina.java:538)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)','2008-05-11 06:28:00','Ralf Hauser','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 normal','e8ff559','Mark Emlyn David Thomas','2008-05-13 18:32:17','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=44968 Provide more information when keystore load fails','java/org/apache/tomcat/util/net/jsse/JSSESocketFactory.java\njava/org/apache/tomcat/util/net/jsse/res/LocalStrings.properties'),(1977,44986,'Bug 44986 – JSP compilation exception with pageEncoding=\"utf-8\"  and file with byte order marks','JSP-File has byte order marks. If the attribute is set to \"UTF-8\" (upper case) or the file has no byte order marks, the compilation workes fine. \n\n{code} \n12:32:16,946 ERROR [[jsp]] Servlet.service() for servlet jsp threw exception \norg.apache.jasper.JasperException: /dialog.jsp(2,0) Page-encoding specified in XML prolog (UTF-8) is different from that specified in page directive (utf-8) \nat org.apache.jasper.compiler.DefaultErrorHandler.jspError(DefaultErrorHandler.java:40) \nat org.apache.jasper.compiler.ErrorDispatcher.dispatch(ErrorDispatcher.java:407) \nat org.apache.jasper.compiler.ErrorDispatcher.jspError(ErrorDispatcher.java:236) \nat org.apache.jasper.compiler.Validator$DirectiveVisitor.comparePageEncodings(Validator.java:362) \nat org.apache.jasper.compiler.Validator$DirectiveVisitor.visit(Validator.java:197) \nat org.apache.jasper.compiler.Node$PageDirective.accept(Node.java:590) \nat org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2338) \nat org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2388) \nat org.apache.jasper.compiler.Node$Visitor.visit(Node.java:2394) \nat org.apache.jasper.compiler.Node$Root.accept(Node.java:489) \nat org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2338) \nat org.apache.jasper.compiler.Validator.validate(Validator.java:1700) \nat org.apache.jasper.compiler.Compiler.generateJava(Compiler.java:178) \nat org.apache.jasper.compiler.Compiler.compile(Compiler.java:306) \nat org.apache.jasper.compiler.Compiler.compile(Compiler.java:286) \nat org.apache.jasper.compiler.Compiler.compile(Compiler.java:273) \nat org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:566) \nat org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:316) \nat org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:336) \nat org.apache.jasper.servlet.JspServlet.service(JspServlet.java:265) \nat javax.servlet.http.HttpServlet.service(HttpServlet.java:803) \nat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290) \nat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206) \nat org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:654) \nat org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:445) \nat org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:379) \nat org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:292) \nat de.cit.jsp.control.DispatchServlet.forward(DispatchServlet.java:286) \nat de.cit.jsp.control.DispatchServlet.doGet(DispatchServlet.java:272) \nat javax.servlet.http.HttpServlet.service(HttpServlet.java:690) \nat javax.servlet.http.HttpServlet.service(HttpServlet.java:803) \nat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290) \nat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206) \nat de.cit.util.javax.servlet.ValidationFilter.doFilter(ValidationFilter.java:108) \nat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235) \nat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206) \nat de.cit.util.javax.servlet.jsp.XHtmlContentTypeFilter.doFilter(XHtmlContentTypeFilter.java:36) \nat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235) \nat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206) \nat org.jboss.web.tomcat.filters.ReplyHeaderFilter.doFilter(ReplyHeaderFilter.java:96) \nat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235) \nat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206) \nat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:230) \nat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175) \nat org.jboss.web.tomcat.security.SecurityAssociationValve.invoke(SecurityAssociationValve.java:179) \nat org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:432) \nat org.jboss.web.tomcat.security.JaccContextValve.invoke(JaccContextValve.java:84) \nat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127) \nat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102) \nat org.jboss.web.tomcat.service.jca.CachedConnectionValve.invoke(CachedConnectionValve.java:157) \nat org.apache.catalina.authenticator.SingleSignOn.invoke(SingleSignOn.java:420) \nat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109) \nat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:262) \nat org.apache.coyote.ajp.AjpProcessor.process(AjpProcessor.java:437) \nat org.apache.coyote.ajp.AjpProtocol$AjpConnectionHandler.process(AjpProtocol.java:366) \nat org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:446) \nat java.lang.Thread.run(Thread.java:619) \n{code} \n\nCase insensitive camparison in org.apache.jasper.compiler.Validator.comparePageEncodings(...) seems to fix the problem: \n{code} \n        /* \n         * Compares page encodings specified in various places, and throws \n         * exception in case of page encoding mismatch. \n         * \n         * @param pageDirEnc The value of the pageEncoding attribute of the page \n         * directive @param pageDir The page directive node \n         * \n         * @throws JasperException in case of page encoding mismatch \n         */ \n        private String comparePageEncodings(String pageDirEnc, \n                Node.PageDirective pageDir) throws JasperException { \n\n            Node.Root root = pageDir.getRoot(); \n            String configEnc = root.getJspConfigPageEncoding(); \n\n            /* \n             * Compare the \'pageEncoding\' attribute of the page directive with \n             * the encoding specified in the JSP config element whose URL \n             * pattern matches this page. Treat \"UTF-16\", \"UTF-16BE\", and \n             * \"UTF-16LE\" as identical. \n             */ \n            if (configEnc != null) { \n                if (!pageDirEnc.equalsIgnoreCase(configEnc) \n                        && (!pageDirEnc.toUpperCase().startsWith(\"UTF-16\") || !configEnc \n                                .toUpperCase().startsWith(\"UTF-16\"))) { \n                    err.jspError(pageDir, \n                            \"jsp.error.config_pagedir_encoding_mismatch\", \n                            configEnc, pageDirEnc); \n                } else { \n                    return configEnc; \n                } \n            } \n\n            /* \n             * Compare the \'pageEncoding\' attribute of the page directive with \n             * the encoding specified in the XML prolog (only for XML syntax, \n             * and only if JSP document contains XML prolog with encoding \n             * declaration). Treat \"UTF-16\", \"UTF-16BE\", and \"UTF-16LE\" as \n             * identical. \n             */ \n            if ((root.isXmlSyntax() && root.isEncodingSpecifiedInProlog()) || root.isBomPresent()) { \n                String pageEnc = root.getPageEncoding(); \n                if (!pageDirEnc.equalsIgnoreCase(pageEnc) \n                        && (!pageDirEnc.toUpperCase().startsWith(\"UTF-16\") || !pageEnc \n                                .toUpperCase().startsWith(\"UTF-16\"))) { \n                    err.jspError(pageDir, \n                            \"jsp.error.prolog_pagedir_encoding_mismatch\", \n                            pageEnc, pageDirEnc); \n                } else { \n                    return pageEnc; \n                } \n            } \n             \n            return pageDirEnc; \n        } \n{code}','2008-05-13 04:42:11','Ralf Zimmermann','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','3c84dcf','Mark Emlyn David Thomas','2008-05-13 17:40:59','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=44986 Convert to upper case before comparing encoding names','java/org/apache/jasper/compiler/Validator.java'),(1978,44988,'Bug 44988 – JPDA_OPTS in catalina.sh / catalina.bat is using old JDWP semantics','','2008-05-13 06:10:34','Cédrik LIME','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Native:Integration','P4 minor','16c6021','Mark Emlyn David Thomas','2008-05-13 16:13:22','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=44988 Use Java 5 syntax to start debugger. Patch provided by Cédrik Lime.','bin/catalina.bat\nbin/catalina.sh'),(1979,42934,'Bug 42934 – sessionDidActivate() called before contextInitialized()','I\'m using Seam and a Seam app depends upon the Seam application being\ninitialized before you can do much of anything in Seam.\n\nThat said Seam puts some hooks into the sessionDidActivate() and\nsessionDidPassivate() events.  Because of that when I start up my app\nI\'m getting a Seam IllegalStateException because the\ncontextInitialized() event is fired after sessionDidActivate() so Seam\nis not yet initialized it\'s Session hooks are being fired.\n\nWhat makes me think this is a bug is that sessionWillPassivate() is being\ncorrectly called before contextDestroyed() so it would seem that\nsessionDidActivate() being called before contextInitialized() would be\ninconsistent behavior.\n\nSo to sum up I think tomcat should fire context and session events in the\nfollowing order:\n\ncontextInitialized\nsessionDidActivate\nsessionWillPassivate\ncontextDestroyed\n\n\nAs a side note Tomcat 5 follows what I think is the completely wrong but\nconsistent order by firing events in this order:\n\nsessionDidActivate\ncontextInitialized\ncontextDestroyed\nsessionWillPassivate','2007-07-18 14:40:10','Mike Youngstrom','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','a9cb6a6','Mark Emlyn David Thomas','2008-05-09 16:21:20','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=42934 Trigger contextInitialized() before sessionDidActivate() TCK tests all pass but I want to give this a little longer in trunk before proposing it for 6.0.x','java/org/apache/catalina/core/StandardContext.java'),(1980,42943,'Bug 42943 – jsp:text gets confused with other *:text elements in a JSP tag file','','2007-07-20 03:46:22','Vojtech Toman','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 normal','17b4436','Mark Emlyn David Thomas','2008-05-08 17:53:35','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=42943 Make sure the nested element is inside a <jsp:text> element','java/org/apache/jasper/compiler/JspDocumentParser.java'),(1981,44955,'Bug 44955 – Winodws  Service  endorsed directory','When installing Tomcat6 using the Windows Installer,  the  Java Options are setup to define the endorsed   ir  as  -Djava.endorsed.dirs=${catalina.home}\\common\\endorsed    However, if using the   service.bat   it sets this  to  -Djava.endorsed.dirs=${catalina.home}\\endorsed\n\nThe latter is the way the DOC  describes the location of the endorsed dirs.\nI think the windows installer   is Incorrect.   I can go back in and change the Registry  but is very distruptive and confusing  and causes   deployment problems','2008-05-08 12:59:10','Bruce Carson','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Native:Integration','P2 normal','179a7eb','Mark Emlyn David Thomas','2008-05-08 17:32:46','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=44955 Use correct location for endorsed dir.','res/tomcat.nsi'),(1982,44943,'Bug 44943 – Inconsistent engine name Catalina vs Standalone in server.xml','','2008-05-06 09:41:44','bruce weertman','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Connector:AJP','P2 normal','3981607','Mark Emlyn David Thomas','2008-05-07 13:20:41','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=44943 Reduce copy/paste issues caused by different engine names.','conf/server.xml'),(1983,43013,'Bug 43013 – No mention of limitation regarding deployment with multi-level context paths (e.g. /123/456)','If I understand correctly, the manager app doesn\'t support deployment with\nmulti-level context paths e.g. path=\"/123/456\".\n\nI couldn\'t see any mention of this limitation in the docs. Would be useful if it\nwas mentioned there.\n\nAlso, if trying to do this, the deployment fails but with no explanation. It\nshould be simple to add a test for multi-level paths and exit with an\nappropriate error message, e.g.\n\nInserting after this block from org.apache.catalina.manager.ManagerServlet\n\n        // Validate the requested context path\n        if ((path == null) || path.length() == 0 || !path.startsWith(\"/\")) {\n            writer.println(sm.getString(\"managerServlet.invalidPath\", path));\n            return;\n        }\n\nthe following code at line 588:\n\n        if (path.lastIndexOf(\"/\") > 0) {\n            writer.println(sm.getString(\"managerServlet.unsupportedPath\", path));\n            return;\n        }\n\nAdding appropriate messages to properties files of course.\n\n\nIt would be even better if the manager could deploy apps using such a context\npath but that would be an enhancement so I\'ll request that separately.','2007-08-02 02:53:54','Tomcat Developers Mailing List','Tomcat Developers Mailing List','','Tomcat 5','Webapps:Manager','P2 normal','7125c9f','Mark Emlyn David Thomas','2008-05-05 14:18:00','Fix bugs https://issues.apache.org/bugzilla/show_bug.cgi?id=43013 and https://issues.apache.org/bugzilla/show_bug.cgi?id=44021 Add support to manger and deployer for wars and dirs that use # to denote multi-level contexts.','java/org/apache/catalina/manager/HTMLManagerServlet.java\njava/org/apache/catalina/manager/ManagerServlet.java\njava/org/apache/catalina/startup/ContextConfig.java\njava/org/apache/catalina/startup/HostConfig.java'),(1984,44021,'Bug 44021 – Deployer cannot deploy wars with #s','','2007-12-04 15:34:01','Eric Benzacar','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P1 enhancement','7125c9f','Mark Emlyn David Thomas','2008-05-05 14:18:00','Fix bugs https://issues.apache.org/bugzilla/show_bug.cgi?id=43013 and https://issues.apache.org/bugzilla/show_bug.cgi?id=44021 Add support to manger and deployer for wars and dirs that use # to denote multi-level contexts.','java/org/apache/catalina/manager/HTMLManagerServlet.java\njava/org/apache/catalina/manager/ManagerServlet.java\njava/org/apache/catalina/startup/ContextConfig.java\njava/org/apache/catalina/startup/HostConfig.java'),(1985,43080,'Bug 43080 – Suspicious url pattern warning logged to wrong webapp','\"Suspicious url pattern\" warnings are logged to the wrong webapp, not the one\nactually using them.\n\nThese log events are coming from SecurityCollection.java.','2007-08-09 15:18:42','Marius Scurtescu','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','332d0f0','Mark Emlyn David Thomas','2008-05-04 06:41:48','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=43080 and https://issues.apache.org/bugzilla/show_bug.cgi?id=43079 Move warning to StandardContext so a) we can check all url-patterns and b) we associate the message with the context.','java/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/deploy/SecurityCollection.java'),(1986,43079,'Bug 43079 – pattern verification broken','','2007-08-09 15:12:32','Marius Scurtescu','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','332d0f0','Mark Emlyn David Thomas','2008-05-04 06:41:48','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=43080 and https://issues.apache.org/bugzilla/show_bug.cgi?id=43079 Move warning to StandardContext so a) we can check all url-patterns and b) we associate the message with the context.','java/org/apache/catalina/core/StandardContext.java\njava/org/apache/catalina/deploy/SecurityCollection.java'),(1987,43094,'Bug 43094 – Allowing non-file based keystore and other providers','Hello,\n\nI would like to use the MacOSX Keychain store for providing my \ncertificates to Tomcat. Generally speaking, this can be done by loading the\nKeyStore like this:\n\n  KeyStore keyStore = KeyStore.getInstance(\"KeychainStore\",\"Apple\");\n  keyStore.load(null, null);\n  \nIn fact, it seems to work without specifying the \"Apple\" provider too.\nHowever, similarly to PKCS11, this type does not require an input file.\n\nThe problem is that org.apache.tomcat.util.net.jsse.JSSESocketFactory\nalways tries to load a file, except when the type is PKCS11.\n\nNot specifying a keystoreFile or truststoreFile parameter defaults to\ntrying to load ~/.keystore. I would like to suggest the following patch\nwhich allows to specify an empty value, indicating the no file needs to\nbe loaded:\n\n--- JSSESocketFactory.java.old  2007-08-11 22:58:24.000000000 +0200\n+++ JSSESocketFactory.java      2007-08-11 23:24:53.000000000 +0200\n@@ -307,7 +307,7 @@\n         InputStream istream = null;\n         try {\n             ks = KeyStore.getInstance(type);\n-            if(! \"PKCS11\".equalsIgnoreCase(type) ) {\n+            if(! \"\".equalsIgnoreCase(path) ) {\n                 File keyStoreFile = new File(path);\n                 if (!keyStoreFile.isAbsolute()) {\n                     keyStoreFile = new File(System.getProperty(\"catalina.base\"),\n                     \n                     \nThis way, not having to load a file is not limited to PKCS11, but could be \nused by other keystore types.\nUsing this patch, the following configuration works fine with keys and\ncertificates stored in the Apple Keychain (for some reason, the KeychainStore \nrequires a non-empty password; it seems to work whatever the password is, \nsince it may be asked interactively by the Keychain utility, depending on \nhow it is set up)\n\n<Connector SSLEnabled=\"true\" clientAuth=\"want\"\n	keystoreFile=\"\" keystorePass=\"-\"\n	keystoreType=\"KeychainStore\" maxThreads=\"150\" port=\"8443\"\n	keyAlias=\"myhost.mydomain.tld\"\n	protocol=\"HTTP/1.1\" scheme=\"https\" secure=\"true\" sslProtocol=\"TLS\"\n	truststoreFile=\"\"\n	truststorePass=\"-\" truststoreType=\"KeychainStore\" />\n			\n\nRegards,\n\nBruno.','2007-08-11 14:50:54','Bruno Harbulot','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 normal','3dc422e','Mark Emlyn David Thomas','2008-05-03 16:22:57','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=43094 Support any keystoreType that doesn\'t need a file.','java/org/apache/tomcat/util/net/jsse/JSSESocketFactory.java\nwebapps/docs/config/http.xml'),(1988,43117,'Bug 43117 – Dangerousness of workDir setting on Context','','2007-08-14 01:09:44','Takayuki Kaneko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','5ec5681','Mark Emlyn David Thomas','2008-05-03 15:49:57','Fix bug 43117. Setting an empty workDir can delete all of CATALINA_HOME. Patch provided by Takayuki Kaneko.','java/org/apache/catalina/core/StandardContext.java'),(1989,43191,'Bug 43191 – compressableMimeType attribute ignored','I have set compression=\"on\" and compressableMimeType=\"text/html\" in server.xml.\nIt appears that the value of compressableMimeType is being ignored. My XML\nresponses are all coming back gzipped. If I switch to compression=\"off\" the\nresponses are not gzipped, but as soon as I turn it on, regardless of the value\nof compressableMimeType, the XML responses are coming back gzipped.\n\nA full Connector tag follows. Note that this is just an example -- I have tried\nmany values for compressableMimeType (that do NOT include text/xml) and the\nresponses are still compressed.\n\n      <Connector port=\"7630\" address=\"${jboss.bind.address}\"\n         maxThreads=\"20\" minSpareThreads=\"4\" maxSpareThreads=\"10\" strategy=\"ms\"\nmaxHttpHeaderSize=\"8192\"\n         emptySessionPath=\"true\" enableLookups=\"false\" redirectPort=\"7643\"\nacceptCount=\"16\"\n         connectionTimeout=\"20000\" disableUploadTimeout=\"true\"\n         compression=\"off\"\n        \ncompressableMimeType=\"text/html,text/javascript,application/x-javascript,application/javascript\"\n/>','2007-08-22 15:02:44','Dave Wood','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Connector:HTTP','P2 normal','e2524a8','Mark Emlyn David Thomas','2008-05-03 06:14:00','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=43191 No way to turn off compression for some file types. Based on a patch by Len Popp','java/org/apache/coyote/http11/Http11AprProcessor.java\njava/org/apache/coyote/http11/Http11NioProcessor.java\njava/org/apache/coyote/http11/Http11Processor.java'),(1990,43150,'Bug 43150 – Tomcat and path with pound sign (#) -> ClassNotFoundException','Tomcat will not start if it\'s located and launched from a path with a # (pound)\ncharacter somewhere. You\'ll find all informations in the given mail-thread on\ntomcat-user, including some developer specific informations.\n\nOne part of the problem is the usage of File.toURL in URLClassloader...\n\nI\'d really appreciate it if this problem could be fixed/worked around (see\nmail-thread for hints).\n\nbtw. the same applies to version 5.5 and probably earlier versions too.\n\nthanks!','2007-08-16 14:35:07','Markus Schiegl','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','fa91954','Mark Emlyn David Thomas','2008-05-01 17:25:01','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=43150 # in installation path stops Tomcat starting','java/org/apache/catalina/startup/ClassLoaderFactory.java\njava/org/apache/jasper/JspCompilationContext.java'),(1991,43333,'Bug 43333 – Messed up \"Asynchronous writes\" (sendfile) documentation','Documentation states, that to use tomcat sendfile functionality, developer needs\nto set _response_ attributes but its _request_ attributes, that must be set.\n\nAlso attribute for end offset is wrong - should it be\n\"org.apache.tomcat.sendfile.end\"?\n\nI think that it would be good to mention, that its necessery to set proper\nresponse content length header.','2007-09-09 01:55:47','Bartek Jablonski','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P2 minor','7b15ea9','Mark Emlyn David Thomas','2008-05-01 17:20:45','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=43333 Correct sendfile docs.','webapps/docs/aio.xml'),(1992,43343,'Bug 43343 – Loss of data and concurrency issue with Catalina session persistent storage','A user was asking questions on the tomcat users mailing list about TC and how it\nhandled concurrency in sessions and session passivation/object caching of\nsessions when they are inactive etc. I thought, surely this is using locks etc,\nso had responded as such. Then I got curious. I started looking in the code and\nfound that indeed TC has a concurrency issue when the session is to pushed to\ndisk if it is inactive or the max number of live sessions is too high.\n\nThe problem is a user could have a session getting ready to become inactive. The\nserver is beginning to write the session out to disk. The user then comes in on\na request and gets the current session. They set an attribute. The web\napplication and the user think all is OK. But in reality the data they just put\ninto the session will be lost. The server just dumped their session to disk\ncontaining the old data as they updated the copy. So, the next time they come in\nthe session will be pulled from disk with the old values and anything they put\ninto it will have been lost. Depending on the application this could be very bad.\n\nTo see the issue go to the file:\njava/org/apache/catalina/session/PersistentManagerBase.java\n\nmethods:\nswapIn\nswapOut\nwriteSession\nfindSession\n(other related)\nthen the different stores load and save methods. There is nothing keeping this\nfrom happening.\n\nIf a lock is on a per session level this should keep it snappy for all other\nrequests etc. Either the session could be used as the lock or an object instance\nvariable on the session instance.\n\nI noticed there is a comment in the source code for\nPersistentManagerBase.processMaxIdleSwaps which reads:\n// Swap out all sessions idle longer than maxIdleSwap\n// FIXME: What\'s preventing us from mangling a session during\n// a request?\n\nSo, apparently someone thought of this. Nothing is keeping it from mangling a\nsession currently.\n\nWhat might be a fix is a session is given an instance variable which can be used\nfor a synchronization lock at the session level. In\nPersistentManagerBase.findSession, this lock would be used before the session\ncan be returned. After the session map is accessed it should then return null if\nthe session had been passivating before it was asked to be found. The session\nwould then be loaded from storage again before it was ever given back to be\naccessed had it been passivating. It would also be used in\nPersistentManagerBase.* which call swapOut.\n\nThe code would look like this (might explain it better):\n\nStandardSession:\n\n/**\n Used for locking the session during persistence operations.\n**/\nInteger persistence_locker = new Integer(0);\n\nPersistentManagerBase:\n\n    /**\n     * Return the active Session, associated with this Manager, with the\n     * specified session id (if any); otherwise return <code>null</code>.\n     * This method checks the persistence store if persistence is enabled,\n     * otherwise just uses the functionality from ManagerBase.\n     *\n     * @param id The session id for the session to be returned\n     *\n     * @exception IllegalStateException if a new session cannot be\n     *  instantiated for any reason\n     * @exception IOException if an input/output error occurs while\n     *  processing this request\n     */\n    public Session findSession(String id) throws IOException {\n\n        Session session = super.findSession(id);\n        //OK, at this point, we\'re not sure if another thread is trying to\n        //remove the session or not so the only way around this is to lock\n        //it (or attempt to) and then try to get it by this session id again.\n        //If the other code ran swapOut, then we should get a null back during\n        //this run, and if not, then by doing this we lock it out and then can\n        //access the session safely and will call access on it to update the\n        //access time and hopefully keep the processes from running swapOut\n        //so, we\'re adding two accesses to the hashmap instead of one for\n        //each request. But, we know we get the session or null back after\n        //the other process has had a chance to remove it or not.\n        if(session!=null{\n	        synchronized(session.persistence_locker){\n				session = super.findSession(session.getIdInternal());\n				if(session!=null){\n				   //we need to do this here\n				   //to keep any external calling code from messing up the\n				   //concurrency.\n				   session.access();\n				}\n			}\n		}\n        if (session != null)\n            return (session);\n\n        // See if the Session is in the Store\n        session = swapIn(id);\n        return (session);\n\n    }\n\n    /**\n     * Swap idle sessions out to Store if they are idle too long.\n     */\n    protected void processMaxIdleSwaps() {\n\n        if (!isStarted() || maxIdleSwap < 0)\n            return;\n\n        Session sessions[] = findSessions();\n        long timeNow = System.currentTimeMillis();\n\n        // Swap out all sessions idle longer than maxIdleSwap\n        // FIXME: What\'s preventing us from mangling a session during\n        // a request?\n        if (maxIdleSwap >= 0) {\n            for (int i = 0; i < sessions.length; i++) {\n                StandardSession session = (StandardSession) sessions[i];\n                synchronized(session.persistence_locker){\n            	    if (!session.isValid())\n            	        continue;\n            	    int timeIdle = // Truncate, do not round up\n            	        (int) ((timeNow - session.getLastAccessedTime()) / 1000L);\n            	    if (timeIdle > maxIdleSwap && timeIdle > minIdleSwap) {\n            	        if (log.isDebugEnabled())\n            	            log.debug(sm.getString\n            	                (\"persistentManager.swapMaxIdle\",\n            	                 session.getIdInternal(), new Integer(timeIdle)));\n            	        try {\n            	            swapOut(session);\n            	        } catch (IOException e) {\n            	            ;   // This is logged in writeSession()\n            	        }\n            	    }\n				}\n            }\n        }\n\n    }\n\n\n    /**\n     * Swap idle sessions out to Store if too many are active\n     */\n    protected void processMaxActiveSwaps() {\n\n        if (!isStarted() || getMaxActiveSessions() < 0)\n            return;\n\n        Session sessions[] = findSessions();\n\n        // FIXME: Smarter algorithm (LRU)\n        if (getMaxActiveSessions() >= sessions.length)\n            return;\n\n        if(log.isDebugEnabled())\n            log.debug(sm.getString\n                (\"persistentManager.tooManyActive\",\n                 new Integer(sessions.length)));\n\n        int toswap = sessions.length - getMaxActiveSessions();\n        long timeNow = System.currentTimeMillis();\n\n        for (int i = 0; i < sessions.length && toswap > 0; i++) {\n		synchronized(sessions[i].persistence_locker){\n                    int timeIdle = // Truncate, do not round up\n            	    (int) ((timeNow - sessions[i].getLastAccessedTime()) / 1000L);\n	            if (timeIdle > minIdleSwap) {\n	                if(log.isDebugEnabled())\n	                    log.debug(sm.getString\n	                        (\"persistentManager.swapTooManyActive\",\n	                         sessions[i].getIdInternal(), new Integer(timeIdle)));\n	                try {\n	                    swapOut(sessions[i]);\n	                } catch (IOException e) {\n	                    ;   // This is logged in writeSession()\n	                }\n	                toswap--;\n	            }\n			}\n        }\n\n    }\n\n\n    /**\n     * Back up idle sessions.\n     */\n    protected void processMaxIdleBackups() {\n\n        if (!isStarted() || maxIdleBackup < 0)\n            return;\n\n        Session sessions[] = findSessions();\n        long timeNow = System.currentTimeMillis();\n\n        // Back up all sessions idle longer than maxIdleBackup\n        if (maxIdleBackup >= 0) {\n            for (int i = 0; i < sessions.length; i++) {\n                StandardSession session = (StandardSession) sessions[i];\n                synchronized(session.persistence_locker){\n                    if (!session.isValid())\n                	    continue;\n                	int timeIdle = // Truncate, do not round up\n                    	(int) ((timeNow - session.getLastAccessedTime()) / 1000L);\n                	if (timeIdle > maxIdleBackup) {\n                    	if (log.isDebugEnabled())\n                    	    log.debug(sm.getString\n                    	        (\"persistentManager.backupMaxIdle\",\n                    	        session.getIdInternal(), new Integer(timeIdle)));\n\n                    	try {\n                        	writeSession(session);\n                    	} catch (IOException e) {\n                        	;   // This is logged in writeSession()\n                    	}\n                	}\n            	}\n        	}\n	    }\n\n    }\n\n\n\nSo, currently one could very easily have a session and have some issues. Your\nuser would have a time when they thought they set something or your code could\nthink this then immediately the changes are lost. Anyways, that is what looks to\nbe the issue and a workable fix. The only place I saw other issues was inside of:\njava/org/apache/catalina/valves/PersistentValve.java\n\nwhere it incorrectly grabs the store from the PersistentManager and uses it\ndirectly instead of using the manager API. To me this is bad in that the manager\nis not able to be the manager and this other logic is accessing the store\ndirectly and should never happen...unless it is used only in test cases etc.\n\nThe only way you could possibly *sort of* workaround this issue would be to use\na HttpSessionActivationListener, but even then it would be hard to code up a\n100% reliable solution. You can see how this would *sort of* be a way to work\naround the issue by looking at the class StandardSession method passivate , and\nsee the events will be thrown to alert code the session will passivate, but it\nwould be pretty complicated and ugly to protect the session completely.','2007-09-10 10:54:45','Wade Chandler','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','a96861d','Mark Emlyn David Thomas','2008-05-01 17:11:26','Fix bug 43343. Correctly handle the case where a request arrives for a session we are in the middle of persisting.','java/org/apache/catalina/session/PersistentManagerBase.java\njava/org/apache/catalina/valves/PersistentValve.java'),(1993,43142,'Bug 43142 – webapp expanded in a FOLDER named webapps/xxx.war is loaded TWICE','reproduce: copy the expanded of file xxx.war file in a FOLDER \ntomcat/webapps/xxx.war\n\nbug: tomcat will load the app TWICE','2007-08-16 06:24:52','Raul Igrisan','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 minor','6a8b1bb','Mark Emlyn David Thomas','2008-05-01 03:00:14','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=43142 If someone is daft enough to name their directory xxx.war, don\'t assume it is a war file.','java/org/apache/catalina/startup/HostConfig.java'),(1994,43366,'Bug 43366 – Session Statistics command in manager fails with \"Unknown command /sessions\"','','2007-09-12 08:15:55','Greg Johnson','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Manager application','P2 normal','f4a7632','Mark Emlyn David Thomas','2008-04-27 13:59:02','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=43366 Provide backwards compatibility for sessions command','java/org/apache/catalina/manager/ManagerServlet.java'),(1995,44877,'Bug 44877 – ClassCastException due to bad TagHandlerPool name generation of two different tags','','2008-04-25 13:43:26','illod','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 normal','dfa25f4','Mark Emlyn David Thomas','2008-04-27 13:19:48','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=44877 Prevent collisions in tag pool names','java/org/apache/jasper/compiler/Generator.java'),(1996,43425,'Bug 43425 – Non-compliant annotations','','2007-09-18 21:33:56','Dain Sundstrom','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Servlet & JSP API','P2 major','48131cd','Mark Emlyn David Thomas','2008-04-25 18:55:38','Fix bug https://issues.apache.org/bugzilla/show_bug.cgi?id=43425 Annotations not spec compliant. Patch provided by Dain Sundstrom.','java/javax/annotation/security/DenyAll.java\njava/javax/ejb/EJB.java\njava/javax/persistence/PersistenceContext.java\njava/javax/persistence/PersistenceProperty.java'),(1997,43617,'Bug 43617 – attribute values within a .tag(x) file are not properly escaped','','2007-10-12 18:29:40','Lucas Galfaso','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','304ee0d','Mark Emlyn David Thomas','2008-04-25 18:40:55','Better fix https://issues.apache.org/bugzilla/show_bug.cgi?id=43617 Correctly handle quotes in attribute values for tag(x) files.','java/org/apache/jasper/compiler/Generator.java'),(1998,43578,'Bug 43578 – Tomcat fails to start on linux if CATALINA_HOME contains a space','I\'ve managed to reproduce this on Fedora core 6 and Ubuntu Feisty using the\nbinary distribution tarballs of tomcat 6.0.14 and 5.5.25.\n\nexport JAVA_HOME=<path to java>\ntar xzf <path to tarball>/apache-tomcat-*.tar.gz\nmv apache-tomcat* \"my tomcat directory\"\nbash \"my tomcat directory/bin/catalina.sh\" run\n\nresult:\nUsing CATALINA_BASE:   /home/basil/test/my tomcat directory\nUsing CATALINA_HOME:   /home/basil/test/my tomcat directory\nUsing CATALINA_TMPDIR: /home/basil/test/my tomcat directory/temp\nUsing JRE_HOME:       /usr/lib/jvm/java-6-sun\nException in thread \"main\" java.lang.NoClassDefFoundError: tomcat\n\nif \"my tomcat directory\" is replaced with, for example, \"mytomcatdirectory\",\ntomcat starts with no error. This error will also occur if a parent directory\ncontains a space and CATALINA_HOME itself doesn\'t.','2007-10-09 07:35:47','Basil Revelas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 regression','a9d1234','Mark Emlyn David Thomas','2008-04-25 18:07:55','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=43578 Tomcat doesn\'t start in linux if CATALINA_BASE contains a space Patch provided by Ray Sauers','bin/catalina.sh'),(1999,43470,'Bug 43470 – ClassCastException at org.apache.catalina.deploy.NamingResources','NamingResources reads\n\n    public void removeLocalEjb(String name) {\n\n        entries.remove(name);\n\n        ContextLocalEjb localEjb = null;\n        synchronized (localEjbs) {\n            localEjb = (ContextLocalEjb) ejbs.remove(name);\n        }\n        if (localEjb != null) {\n            support.firePropertyChange(\"localEjb\", localEjb, null);\n            localEjb.setNamingResources(null);\n        }\n\n    }\n\nif should be \n\n    public void removeLocalEjb(String name) {\n\n        entries.remove(name);\n\n        ContextLocalEjb localEjb = null;\n        synchronized (localEjbs) {\n            localEjb = (ContextLocalEjb) localEjbs.remove(name); // The error\nwas in this line\n        }\n        if (localEjb != null) {\n            support.firePropertyChange(\"localEjb\", localEjb, null);\n            localEjb.setNamingResources(null);\n        }\n\n    }\n\nRegards,\n  lg','2007-09-24 19:41:40','Lucas Galfaso','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','fd05f6f','Mark Emlyn David Thomas','2008-04-25 14:38:38','Fix compiler warnings for o.a.c.deploy.* Note using generics would have highlighted bug 43470','java/org/apache/catalina/deploy/ContextHandler.java\njava/org/apache/catalina/deploy/ContextService.java\njava/org/apache/catalina/deploy/ContextTransaction.java\njava/org/apache/catalina/deploy/FilterDef.java\njava/org/apache/catalina/deploy/NamingResources.java\njava/org/apache/catalina/deploy/ResourceBase.java'),(2000,43470,'Bug 43470 – ClassCastException at org.apache.catalina.deploy.NamingResources','NamingResources reads\n\n    public void removeLocalEjb(String name) {\n\n        entries.remove(name);\n\n        ContextLocalEjb localEjb = null;\n        synchronized (localEjbs) {\n            localEjb = (ContextLocalEjb) ejbs.remove(name);\n        }\n        if (localEjb != null) {\n            support.firePropertyChange(\"localEjb\", localEjb, null);\n            localEjb.setNamingResources(null);\n        }\n\n    }\n\nif should be \n\n    public void removeLocalEjb(String name) {\n\n        entries.remove(name);\n\n        ContextLocalEjb localEjb = null;\n        synchronized (localEjbs) {\n            localEjb = (ContextLocalEjb) localEjbs.remove(name); // The error\nwas in this line\n        }\n        if (localEjb != null) {\n            support.firePropertyChange(\"localEjb\", localEjb, null);\n            localEjb.setNamingResources(null);\n        }\n\n    }\n\nRegards,\n  lg','2007-09-24 19:41:40','Lucas Galfaso','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','72eb723','Mark Emlyn David Thomas','2008-04-25 14:16:36','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=43470 Based on a changes provided by Lucas Galfaso','java/org/apache/catalina/deploy/NamingResources.java'),(2001,43617,'Bug 43617 – attribute values within a .tag(x) file are not properly escaped','','2007-10-12 18:29:40','Lucas Galfaso','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','40ca63c','Mark Emlyn David Thomas','2008-04-23 17:52:11','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=43617 Correctly handle quotes in attribute values for tag(x) files.','java/org/apache/jasper/compiler/Generator.java'),(2002,43683,'Bug 43683 – Accessing Servlet while Reloading context gives 404 error','','2007-10-23 09:43:12','Joe Kislo','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','b8661d5','Mark Emlyn David Thomas','2008-04-22 16:46:26','Remy\'s better fix for 43683.','java/org/apache/catalina/core/StandardContextValve.java'),(2003,31257,'Bug 31257 – java.endorsed.dirs is not used when JSP compilation is forked','When the JSP compiler forks a javac process, it should check to see what the \ncurrently endorsed directories are (check the system \nproperty \"java.endorsed.dirs\" - otherwise, classes end up missing and JSP \npages do not properly compile.  We experienced a problem when we explicitly \nset the java.endorsed.dirs property on the command line, and the JSP compiler \ndid not use it when javac was forked.\n\nI have patched org.apache.jasper.compiler.Compiler to support this:\n*** src.original\\jakarta-tomcat-jasper\\jasper2\n\\src\\share\\org\\apache\\jasper\\compiler\\Compiler.java       Tue Jun 15 17:30:35 \n2004\n--- src\\org\\apache\\jasper\\compiler\\Compiler.java        Thu Sep 16 00:05:14 \n2004\n\n***************\n*** 349,358 ****\n--- 349,369 ----\n              extdirs.setPath(exts);\n              javac.setExtdirs(extdirs);\n              info.append(\"    extension dir=\" + exts + \"\\n\");\n          }\n\n+         // Add endorsed directories\n+         String endorsed = System.getProperty(\"java.endorsed.dirs\");\n+         if(endorsed != null) {\n+             Javac.ImplementationSpecificArgument endorsedArg = \njavac.createCompilerArg();\n+             endorsedArg.setLine(\"-J-Djava.endorsed.dirs=\"+endorsed);\n+             info.append(\"    endorsed dir=\" + endorsed + \"\\n\");\n+         }\n+         else {\n+             info.append(\"    no endorsed dirs specified\\n\");\n+         }\n+\n          // Configure the compiler object\n          javac.setEncoding(javaEncoding);\n          javac.setClasspath(path);\n          javac.setDebug(ctxt.getOptions().getClassDebugInfo());\n\ntrue, i should probably check ctxt.getOptions().getFork() in the if() as well, \nbut since i always fork it doesn\'t matter to me.','2004-09-16 05:10:06','James DeFelice','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P3 critical','0ea3e15','Mark Emlyn David Thomas','2008-04-20 18:39:35','Fix bug 31257. Quote endorsed dirs if they contain a space.','java/org/apache/jasper/compiler/AntCompiler.java'),(2004,29936,'Bug 29936 – XML parser loading problems by container','I\'m trying to use JSTL 1.1 with this version of tomcat and have both saxon and \ncrimson in my web-app.\n\nIf we have crimson and saxon in our webapp lib then tomcat tries to use crimson \nas the xml parser when reading the web.xml and compiling the jsp and we get the \nprefix error:\n\norg.apache.jasper.JasperException: <h3>Validation error messages from \nTagLibraryValidator for c</h3><p>null: java.lang.IllegalStateException: can\'t \ndeclare any more prefixes in this context</p><h3>Validation error messages from \nTagLibraryValidator for fmt</h3><p>null: java.lang.IllegalStateException: can\'t \ndeclare any more prefixes in this context</p>\n\nIf we remove crimson, tomcat uses saxon (aelfred parser) and this fails on \nreading the web.xml (javax.xml.parsers.ParserConfigurationException: AElfred \nparser is namespace-aware)\n\nIf we remove saxon and crimson then we are okay (defaults to xerces in the \ntomcat endorsed directory?)\n\nIt seems to me that tomcat is using the parser in my web-app to read the \nweb.xml rather than using xerces from the endorsed directory.  \n\nThe same web-app runs without problems in version 5.0.16.  \n\nTomcat seems to be using the service provider mechanism in 5.0.25 as I have \nproperty files in C:\\Java\\jakarta-tomcat-5.0.25\n\\work\\Catalina\\localhost\\diabetes\\loader\\META-INF\\services (can\'t find any \ndocuments on this).\n\nIf I\'m using more than one parser won\'t this cause problems as tomcat is \nsetting only one parser and xslt processor here?\n\nAny comments are gratefully received.\n\nThanks,\nPeter Neville','2004-07-06 15:18:51','peter neville','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P3 blocker','06c23d8','Mark Emlyn David Thomas','2008-04-20 16:47:57','Fix bug 29936. In some circumstances, Tomcat would use the parser from a webapp to parse web.xml and possibly context.xml files.','java/org/apache/catalina/startup/ContextConfig.java'),(2005,43656,'Bug 43656 – ELSupport.coerceToType won\'t handle null for java.lang.Number','If ELSupport.coerceToType is called with an BigDecimal instance as the first Parameter \'obj\' and \nBigDecimal.class as type it should return the inputted value.\n\nInstead the BigDecimal is converted into a double and back into a BigDecimal which leads to a diffenent \nvalue. This happens in Line 228:\n\n        if (BigInteger.class.equals(type)) {\n            if (number instanceof BigDecimal) {\n                return ((BigDecimal) number).toBigInteger();\n            }\n            return BigInteger.valueOf(number.longValue()); // This leads to a different value.\n        }\n\nExample: Run the Method with new BigDecimal(\"0.19\"), BigDecimal.class as parameters.\nThis should result in a BigDecimal with value 0.19. Instead i got \n0.190000000000000002220446049250313080847263336181640625.\n\n The easiest solution is to compare the class of the object to coerce with the target class and return the \ninputted value if the are equal in ELSupport.coerceToType Method:\n\npublic final static Object coerceToType(final Object obj, final Class type) throws \nIllegalArgumentException {\n		if (type == null || Object.class.equals(type) || type.equals(obj.getClass())) {\n			return obj;\n		}\n...','2007-10-18 18:02:47','Nils Eckert','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Servlet & JSP API','P2 normal','52e4790','Mark Emlyn David Thomas','2008-04-19 05:47:07','More fixes for bug 43656 so new test case passes.','java/org/apache/el/lang/ELSupport.java'),(2006,43656,'Bug 43656 – ELSupport.coerceToType won\'t handle null for java.lang.Number','If ELSupport.coerceToType is called with an BigDecimal instance as the first Parameter \'obj\' and \nBigDecimal.class as type it should return the inputted value.\n\nInstead the BigDecimal is converted into a double and back into a BigDecimal which leads to a diffenent \nvalue. This happens in Line 228:\n\n        if (BigInteger.class.equals(type)) {\n            if (number instanceof BigDecimal) {\n                return ((BigDecimal) number).toBigInteger();\n            }\n            return BigInteger.valueOf(number.longValue()); // This leads to a different value.\n        }\n\nExample: Run the Method with new BigDecimal(\"0.19\"), BigDecimal.class as parameters.\nThis should result in a BigDecimal with value 0.19. Instead i got \n0.190000000000000002220446049250313080847263336181640625.\n\n The easiest solution is to compare the class of the object to coerce with the target class and return the \ninputted value if the are equal in ELSupport.coerceToType Method:\n\npublic final static Object coerceToType(final Object obj, final Class type) throws \nIllegalArgumentException {\n		if (type == null || Object.class.equals(type) || type.equals(obj.getClass())) {\n			return obj;\n		}\n...','2007-10-18 18:02:47','Nils Eckert','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Servlet & JSP API','P2 normal','56bee0d','Mark Emlyn David Thomas','2008-04-19 05:44:35','Add test case for bug 43656. Based on a patch from Konstantin Kolinko.','test/org/apache/el/lang/TestELSupport.java'),(2007,43656,'Bug 43656 – ELSupport.coerceToType won\'t handle null for java.lang.Number','If ELSupport.coerceToType is called with an BigDecimal instance as the first Parameter \'obj\' and \nBigDecimal.class as type it should return the inputted value.\n\nInstead the BigDecimal is converted into a double and back into a BigDecimal which leads to a diffenent \nvalue. This happens in Line 228:\n\n        if (BigInteger.class.equals(type)) {\n            if (number instanceof BigDecimal) {\n                return ((BigDecimal) number).toBigInteger();\n            }\n            return BigInteger.valueOf(number.longValue()); // This leads to a different value.\n        }\n\nExample: Run the Method with new BigDecimal(\"0.19\"), BigDecimal.class as parameters.\nThis should result in a BigDecimal with value 0.19. Instead i got \n0.190000000000000002220446049250313080847263336181640625.\n\n The easiest solution is to compare the class of the object to coerce with the target class and return the \ninputted value if the are equal in ELSupport.coerceToType Method:\n\npublic final static Object coerceToType(final Object obj, final Class type) throws \nIllegalArgumentException {\n		if (type == null || Object.class.equals(type) || type.equals(obj.getClass())) {\n			return obj;\n		}\n...','2007-10-18 18:02:47','Nils Eckert','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Servlet & JSP API','P2 normal','d7e6345','Mark Emlyn David Thomas','2008-04-18 14:10:06','Fix bug 43656. coerceToType() modified some values. Patch provided by Nils Eckert.','java/org/apache/el/lang/ELSupport.java'),(2008,43683,'Bug 43683 – Accessing Servlet while Reloading context gives 404 error','','2007-10-23 09:43:12','Joe Kislo','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','c6b57c6','Mark Emlyn David Thomas','2008-04-17 18:07:38','Patch for bug 43683. It could be more efficient if wrapper.started was visible but that would have made the patch quite invasive.','java/org/apache/catalina/core/StandardContextValve.java'),(2009,44380,'Bug 44380 – TldConfig / Scan of URL that are not files','The TldConfig class (org.apache.catalina.startup) is asking ClassLoader and all\nparent ClassLoader in order to get the URLs and then assume that the URLs are\nusing \"file\" protocol.\n\nBut when Tomcat is embedded, sometimes the URL are not always using \"file\"\nprotocol and then new File() will fail.\n\nThe given patch is to skip the URLs that are not using file protocol (that\navoids ugly NPE in the \"new File(urls[i].toURI());\" call','2008-02-08 05:29:21','Florent BENOIT','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','2edf51e','Mark Emlyn David Thomas','2008-04-11 19:07:10','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=44380 Don\'t bother scanning non-file URLs for TLDs. Patch provided by Florent BENOIT','java/org/apache/catalina/startup/TldConfig.java'),(2010,44389,'Bug 44389 – Cleanup of org.apache.naming.resources.CacheEntry resources (memory leak)','Hi,\n\n   I am memory profiling a webapp for my company because we suspect it has\nmemory leaks when redeploying. This webapp has to be redeployed several times a\nweek for security reasons (most of the time it is undeployed) and the memory\nleaks forced us to shutdown tomcat once a week to avoid OOM exception.\n\n   I\'m using jvm1.5 and tomcat 6.0.13 (also tried with 6.0.14 and today with\n6.0.16), and Yourkit as the profiling tool. I have made the test in both linux\nand windows.\n\n   I have created a JMeter test to deploy the app using the manager, make some\nrequest to the app and then undeploy it using again the manager app in a loop.\nAfter some redeployments, I got my OutOfMemoryException. Then I checked with my\nprofiling tool and found that my own classes were correctly destroyed, and the\nclasses retaining more memory were these ones (listed as a heirarchy):\n\n   org.apache.catalina.core.ApplicationContext$DispatchData\n   org.apache.catalina.core.ApplicationContext\nmapper of  org.apache.catalina.core.StandardContext\ncontext of  org.apache.tomcat.util.http.mapper.Mapper\nresources of  org.apache.tomcat.util.http.mapper.Mapper$Context  cache of \norg.apache.naming.resources.ProxyDirContext  cache of \norg.apache.naming.resources.ResourceCache\norg.apache.naming.resources.CacheEntry[]\n\n   The number of objects of each class were exactly the number of times I had\nredeployed the webapp. I have checked the contents of CacheEntry inside\nCacheEntry[] and it has an attribute \"name\" and the contents are the jsps and\ntld files of my app. There are as many CacheEntry with the same jsp attribute as\ntimes the webapp has been reloaded, so I guess there is no cleaning of\nCacheEntry resources at context shutdown.\n\n   To reproduce this, a simple webapp with 2 jsp and a taglibrary can be used.\nDeploy and undeploy it many times so you can see how the count of these objects\ngrows in memory.','2008-02-11 02:03:09','Diego Rodriguez','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','6723b35','Mark Emlyn David Thomas','2008-04-11 18:34:45','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=44389 Make nested class static so it doesn\'t hold a reference to the ApplciationContext instance.','java/org/apache/catalina/core/ApplicationContext.java'),(2011,44391,'Bug 44391 – SSI handling of escaped characters broken','In org.apache.catalina.ssi.SSIProcessor the method parseParamNames is broken. If\nI have a SSI directive like <!--#set var=\"test\" value=\"blubb\\\"\\\"\" --> the method\ndetects three parameters instead of two. This is because there are two\nconsecutive escaped characters. Although the first one \\\" is detected correctly\nthe next one isn\'t because the flag escaped is still set to true, although this\ncharacter isn\'t escaped anymore.\n\nYou have to replace\n\nboolean escaped = false;\nfor (; bIdx < cmd.length() && quotes != 2; bIdx++) {\n  char c = cmd.charAt(bIdx);\n  // Need to skip escaped characters\n  if (c == \'\\\\\' && !escaped) {\n    escaped = true;\n    bIdx++;\n    continue;\n  }\n  escaped = false;\n  if (c == \'\"\') quotes++;\n}\n\nby \n\nfor (; bIdx < cmd.length() && quotes != 2; bIdx++) {\n  char c = cmd.charAt(bIdx);\n  // Need to skip escaped characters\n  if (c == \'\\\\\') {\n    bIdx++;\n    continue;\n  }\n  if (c == \'\"\') quotes++;\n}\n\nJust removing the flag escaped is sufficient, because you don\'t have to remember\nwhether the last character was escaped and that should have no influence to\nconsecutive characters.\n\nThe bug still exists in the HEAD revision of the repository.','2008-02-11 04:37:40','Konrad Windszus','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','df75937','Mark Emlyn David Thomas','2008-04-11 17:25:59','Fix bug44391. Handling of escaped characters was incorrect.','java/org/apache/catalina/ssi/SSIProcessor.java'),(2012,44494,'Bug 44494 – Requests greater than 8k being truncated.','After updating to Tomcat 5.5.26 from Tomcat 5.5.23 we appear to be having trouble with requests, that are greater than 8k, being truncated with the CoyoteRequest.getReader() method.\n\nThe following steps caused this issue to appear:\n1. I constructed a post request from a jsp page which exceeded 8k in size.\n2. In the corresponding servlet I call request.getReader() and pipe the returned BufferedReader into a string.\n3. Inspection of the string reveals that the content is  being truncated after 8k.\n4. If I replace the request.getReader() method call with request.getInputStream() no truncation occurs. Also, after reverting back to Tomcat 5.5.23 and using the request.getReader() method no truncation occurs.','2008-02-26 19:47:31','Jonathan Rubin','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Connector:Coyote','P2 normal','d7a2eed','Mark Emlyn David Thomas','2008-04-11 17:02:41','Fix for garbage test in bug 44494. Patch provided by Suzuki Yuichiro.','java/org/apache/tomcat/util/buf/B2CConverter.java'),(2013,44494,'Bug 44494 – Requests greater than 8k being truncated.','After updating to Tomcat 5.5.26 from Tomcat 5.5.23 we appear to be having trouble with requests, that are greater than 8k, being truncated with the CoyoteRequest.getReader() method.\n\nThe following steps caused this issue to appear:\n1. I constructed a post request from a jsp page which exceeded 8k in size.\n2. In the corresponding servlet I call request.getReader() and pipe the returned BufferedReader into a string.\n3. Inspection of the string reveals that the content is  being truncated after 8k.\n4. If I replace the request.getReader() method call with request.getInputStream() no truncation occurs. Also, after reverting back to Tomcat 5.5.23 and using the request.getReader() method no truncation occurs.','2008-02-26 19:47:31','Jonathan Rubin','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Connector:Coyote','P2 normal','067e924','Mark Emlyn David Thomas','2008-04-11 16:52:10','Re-instate Rainer\'s code that fixes the 44494 test case for read with maxHttpHeaderSize > 8192.','java/org/apache/catalina/connector/InputBuffer.java'),(2014,44392,'Bug 44392 – HTML entities not resolved in SSI filter','HTML entities which are contained in an SSI set directive aren\'t resolved by the\nSSI filter (in contrary to what is done by mod_include of Apaches HTTP).\n\nmod_include resolves all HTML entities in most of the attribute values of ssi\ndirectives. It also resolves \\\" to \" and \\$ to $.\n\nThe ssi filter of tomcat resolves all escaped character which are escaped with a\nbackslash, but no HTML entities at all.\n\nApart from that, giving encoding \"entity\" should be different from giving\nencoding=\"none\" to the SSI echo directive. One should replace all invalid HTML\ncharacters by valid HTML entities and the other one should do nothing.\n\nThe encoding is especially important if you wan\'t to store a HTML-Comment within\na SSI variable.\n\nIf I want to store a variable test with the value \"<!-- testvalue \"x\" -->\"\n\n\n<!--#set var=\"test\" value=\"<!-- testvalue \"x\" -->\"-->\n\nfor mod_include you must write:\n\n<!--#set var=\"test\" value=\"<!&#45;&#45; testvalue \\\"x\\\" &#45;&#45;>\" -->\n\nfor Tomcats SSI you must write:\n\n<!--#set var=\"test\" value=\"<!\\-\\- testvalue \\\"x\\\" \\-\\->\" -->\n\nAnd there should be a difference whether I output this variable with\n<!--#echo var=\"test\" encoding=\"none\" -->  \nwhich should lead to <!-- testvalue \"x\" -->, or\n<!--#echo var=\"test\" encoding=\"entity\" -->\nwhich should lead to &lt;!-- testvalue &quot;x&quot; --&gt;','2008-02-11 05:37:37','Konrad Windszus','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','75fbd91','Mark Emlyn David Thomas','2008-04-11 16:07:26','Fix bug 44392. HTML entities not resolved in SSI.','java/org/apache/catalina/ssi/SSIEcho.java\njava/org/apache/catalina/ssi/SSIMediator.java'),(2015,44408,'Bug 44408 – EL-expression evaluation slow due to synchronization caused by JspFactory.getDefaultFactory','','2008-02-13 03:36:02','Robert Andersson','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P4 minor','1f41c3d','Mark Emlyn David Thomas','2008-04-10 13:29:23','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=44408 Avoid bottleneck by calling the synchronized method only once. Patch provided by Robert Andersson.','java/org/apache/jasper/runtime/PageContextImpl.java'),(2016,44428,'Bug 44428 – FunctionMapperImpl.Function throws a NPE in certain circumstances','In FunctionMapperImpl.Function it is possible for writeExternal to fail if the\nclass has just been de-serialised and is then serialised again.\n\nIf you look at writeExternal:\n\n   public void writeExternal(ObjectOutput out) throws IOException {\n      out.writeUTF((this.prefix != null) ? this.prefix : \"\");\n      out.writeUTF(this.localName);\n      out.writeUTF(this.m.getDeclaringClass().getName());\n      out.writeUTF(this.m.getName());\n      out.writeObject(ReflectionUtil.toTypeNameArray(\n         this.m.getParameterTypes()));\n   }\n\nyou can see that it externalises the function to be invoked by using the\nreference to the Method itself.\n\nIf you look at readExternal however:\n\n   public void readExternal(ObjectInput in) throws IOException,\n         ClassNotFoundException {\n            \n      this.prefix = in.readUTF();\n      if (\"\".equals(this.prefix)) this.prefix = null;\n      this.localName = in.readUTF();\n      this.owner = in.readUTF();\n      this.name = in.readUTF();\n      this.types = (String[]) in.readObject();\n   }\n\nYou can see that it doesn\'t restore the Method after deserialisation. The method\nis restored if it is accessed, however if it\'s not and then serialisation is\nperformed writeExternal will throw a NPE (as m is still null).\n\nThe fix is to either get the method to be reconstructed as soon as\ndeserialisation completes - or perhaps to be a bit more efficient, in\nwriteExternal change it such that if m is null it externalises using the\ncomponents of the method:\n\n   public void writeExternal(ObjectOutput out) throws IOException {\n      out.writeUTF((this.prefix != null) ? this.prefix : \"\");\n      out.writeUTF(this.localName);\n      if (m == null) {\n         out.writeUTF(this.owner);\n         out.writeUTF(this.name);\n         out.writeObject(this.types);\n      } else if (this.m != null) {\n         out.writeUTF(this.m.getDeclaringClass().getName());\n         out.writeUTF(this.m.getName());\n         out.writeObject(ReflectionUtil.toTypeNameArray(\n            this.m.getParameterTypes()));\n      }\n   }','2008-02-15 02:36:16','Lee Smith','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Servlet & JSP API','P2 normal','0035fd4','Mark Emlyn David Thomas','2008-04-09 18:33:01','Fix bug 44428. Make sure m is not null to prevent NPE.','java/org/apache/el/lang/FunctionMapperImpl.java'),(2017,44785,'Bug 44785 – Documentation f the MaxThread default value for AJP connector','Hello,\n\nThe maxThread value of the AJP connector is 200 by default.\nBut the documentation indicates a value of 40 which is wrong\n\nAJP connector uses the org.apache.tomcat.util.threads the set up this value.\n\n\n-------------\n\nmaxThreads	\n\nThe maximum number of request processing threads to be created by this Connector, which therefore determines the maximum number of simultaneous requests that can be handled. If not specified, this attribute is set to 40. If an executor is associated with this connector, this attribute is ignored as the connector will execute tasks using the executor rather than an internal thread pool.\n\n-------------\n\nThanks,\nLionel','2008-04-09 07:08:07','lionel crine','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P5 trivial','c3e2a53','Mark Emlyn David Thomas','2008-04-09 17:59:05','Fix bug 44785. Correct deafult maxThreads for AJP connector.','webapps/docs/config/ajp.xml'),(2018,44766,'Bug 44766 – Tomcat\'s EL implementation doesn\'t coerce custom Number subclasses','','2008-04-07 08:17:32','Maksim Kaszynski','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 major','d6cff98','Mark Emlyn David Thomas','2008-04-08 18:26:05','Better patch for 44766. I still can\'t see why the original code listed the classes individually.','java/org/apache/el/lang/ELArithmetic.java'),(2019,44766,'Bug 44766 – Tomcat\'s EL implementation doesn\'t coerce custom Number subclasses','','2008-04-07 08:17:32','Maksim Kaszynski','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 major','110f782','Mark Emlyn David Thomas','2008-04-08 17:25:04','This fixes 44766 but I can\'t see why the code was written as originally coded. Any light much appreciated. I\'ll give it a couple of days and then, assuming there are no objections, propose it for 6.0.x.','java/org/apache/el/lang/ELArithmetic.java'),(2020,44494,'Bug 44494 – Requests greater than 8k being truncated.','After updating to Tomcat 5.5.26 from Tomcat 5.5.23 we appear to be having trouble with requests, that are greater than 8k, being truncated with the CoyoteRequest.getReader() method.\n\nThe following steps caused this issue to appear:\n1. I constructed a post request from a jsp page which exceeded 8k in size.\n2. In the corresponding servlet I call request.getReader() and pipe the returned BufferedReader into a string.\n3. Inspection of the string reveals that the content is  being truncated after 8k.\n4. If I replace the request.getReader() method call with request.getInputStream() no truncation occurs. Also, after reverting back to Tomcat 5.5.23 and using the request.getReader() method no truncation occurs.','2008-02-26 19:47:31','Jonathan Rubin','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Connector:Coyote','P2 normal','7bf4082','Mark Emlyn David Thomas','2008-04-07 18:47:54','All of the issues I was seeing with mark/reset were due to states that resulted in a call to CharChunk.flushBuffer(). I tried many different ways to fix it but by far the simplest was this patch that just increases the size of the CharChunk internal buffer when creating the mark sufficiently that flushBuffer() is never called. With this patch I can\'t break mark/reset with bug 44494\'s test case in single or multibyte mode.','java/org/apache/catalina/connector/InputBuffer.java'),(2021,44494,'Bug 44494 – Requests greater than 8k being truncated.','After updating to Tomcat 5.5.26 from Tomcat 5.5.23 we appear to be having trouble with requests, that are greater than 8k, being truncated with the CoyoteRequest.getReader() method.\n\nThe following steps caused this issue to appear:\n1. I constructed a post request from a jsp page which exceeded 8k in size.\n2. In the corresponding servlet I call request.getReader() and pipe the returned BufferedReader into a string.\n3. Inspection of the string reveals that the content is  being truncated after 8k.\n4. If I replace the request.getReader() method call with request.getInputStream() no truncation occurs. Also, after reverting back to Tomcat 5.5.23 and using the request.getReader() method no truncation occurs.','2008-02-26 19:47:31','Jonathan Rubin','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Connector:Coyote','P2 normal','0c66ed7','Mark Emlyn David Thomas','2008-04-07 18:43:52','Remy\'s resizing fix from bug 44494','java/org/apache/tomcat/util/buf/CharChunk.java'),(2022,44595,'Bug 44595 – Add possibility to request the QueueSize of an executor via JMX','','2008-03-13 01:34:50','Ruediger Pluem','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 enhancement','c3c525b','Jean-Frederic Clere','2008-04-07 05:29:41','Submitted by Ruediger Pluem. PR#44595','java/org/apache/catalina/core/StandardThreadExecutor.java'),(2023,44759,'Bug 44759 – can\'t run ant task dist-javadoc as described in BUILDING.txt','','2008-04-05 09:11:32','Stephen Bannasch','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P2 minor','4290b57','Mark Emlyn David Thomas','2008-04-05 16:11:16','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=44759 Need source to generate javadocs Patch provided by Stephen Bannasch.','dist.xml'),(2024,44715,'Bug 44715 – Missing attribute in the AJP Connector (jk) configuration Doc.','','2008-03-31 12:49:34','Fred K','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Webapps:Documentation','P2 normal','0351fff','Mark Emlyn David Thomas','2008-04-01 14:33:38','Better fix for bug 44715. Document use of secret for AJP connector.','webapps/docs/config/ajp.xml'),(2025,44715,'Bug 44715 – Missing attribute in the AJP Connector (jk) configuration Doc.','','2008-03-31 12:49:34','Fred K','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Webapps:Documentation','P2 normal','9b6fa18','Mark Emlyn David Thomas','2008-03-31 18:19:20','Fix bug 44715. Document use of secret for AJP connector.','webapps/docs/config/ajp.xml'),(2026,44494,'Bug 44494 – Requests greater than 8k being truncated.','After updating to Tomcat 5.5.26 from Tomcat 5.5.23 we appear to be having trouble with requests, that are greater than 8k, being truncated with the CoyoteRequest.getReader() method.\n\nThe following steps caused this issue to appear:\n1. I constructed a post request from a jsp page which exceeded 8k in size.\n2. In the corresponding servlet I call request.getReader() and pipe the returned BufferedReader into a string.\n3. Inspection of the string reveals that the content is  being truncated after 8k.\n4. If I replace the request.getReader() method call with request.getInputStream() no truncation occurs. Also, after reverting back to Tomcat 5.5.23 and using the request.getReader() method no truncation occurs.','2008-02-26 19:47:31','Jonathan Rubin','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Connector:Coyote','P2 normal','3924a08','Mark Emlyn David Thomas','2008-03-30 17:13:36','Apply Remy\'s patch for 44494 for multi-byte character data.','java/org/apache/tomcat/util/buf/B2CConverter.java'),(2027,44529,'Bug 44529 – RealmBase authorization via hasResourcePermission not fully servlet spec compliant','The authorization implementation in RealmBase, in the hasResourcePermission method is not fully servlet specification compliant. The spec (both 2.4 and 2.5) states:\n\n\"...\nA security constraint that does not contain an authorization constraint shall combine with authorization constraints that name or imply roles to allow unauthenticated access. \nThe special case of an authorization constraint that names no roles shall combine with any other constraints to override their affects and cause access to be precluded.\n...\"\n\nIn Tomcat this works fine as long as there aren\'t weird (but legal!) combinations or security-constraints on the same URLs.\n\nExample:\n\n  <security-constraint>\n    <web-resource-collection>\n      <url-pattern>/someUrl/*</url-pattern>\n      <http-method>POST</http-method>\n    </web-resource-collection>\n    <!-- no auth-constraint, to allow everyone -->\n  </security-constraint>\n\n  <security-constraint>\n    <web-resource-collection>\n      <url-pattern>/someUrl/*</url-pattern>\n      <http-method>POST</http-method>\n    </web-resource-collection>\n    <!-- no roles, to allow noone -->\n    <auth-constraint />\n  </security-constraint>\n\n(if we ignore that this kind of configuration is pretty pointless,)\nthe spec dictates that a POST to /someUrl/index.html should be denied access.\nTomcat grants it. (both 5.5.23 and 6.0.14 do)\n\n\nExample 2:\n\n  <security-constraint>\n    <web-resource-collection>\n      <url-pattern>/someUrl/*</url-pattern>\n      <http-method>POST</http-method>\n    </web-resource-collection>\n    <!-- no roles, to allow noone -->\n    <auth-constraint />\n  </security-constraint>\n\n  <security-constraint>\n    <web-resource-collection>\n      <url-pattern>/someUrl/*</url-pattern>\n      <http-method>POST</http-method>\n    </web-resource-collection>\n    <auth-constraint>\n      <role-name>*</role-name>\n    </auth-constraint>\n  </security-constraint>\n\nNow it gets interesting. In \"strict\" mode, access to /someUrl/index.html is denied (regardless of the web.xml-configured security roles and the roles the user has).\nIn \"auth-only\" mode, access is always granted, and in \"strict auth-only\" mode access is granted if there are no web.xml-configured security roles.\nNow these modes are a Tomcat addition to the spec, but I feel access should have been denied in all modes, both to stay in line with the spec and to keep the behaviour predictable.','2008-03-04 08:04:54','Robert-Jan Westerhof','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 minor','7be2374','Mark Emlyn David Thomas','2008-03-29 10:48:24','https://issues.apache.org/bugzilla/show_bug.cgi?id=44529 No roles (deny all) trumps no auth-constraint (allow all)','java/org/apache/catalina/realm/RealmBase.java'),(2028,44673,'Bug 44673 – ServletInputStream still readable even when closed','','2008-03-25 15:32:18','Damien Bonvillain','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','ca41a27','Mark Emlyn David Thomas','2008-03-25 19:36:56','Fix bug 44673. Throw IOE if stream is closed and a call is made to any read(), ready(), mark(), reset(), or skip() method as per javadocs for Reader.','java/org/apache/catalina/connector/InputBuffer.java\njava/org/apache/catalina/connector/LocalStrings.properties'),(2029,44541,'Bug 44541 – Document packetSize attribute','','2008-03-05 08:21:52','Etienne Dysli','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Connector:AJP','P2 normal','e5d495e','Mark Emlyn David Thomas','2008-03-25 17:27:04','Fix bug 44541 - document packetSize for the AJP connector.','webapps/docs/config/ajp.xml'),(2030,44611,'Bug 44611 – DirContextURLConnection Header Bugs','','2008-03-15 21:32:08','Chris Hubick','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','024afb6','Mark Emlyn David Thomas','2008-03-24 17:30:03','Fix bug 44611 https://issues.apache.org/bugzilla/show_bug.cgi?id=44611 DirContextURLConnection: 1) Does not implement the getHeaderFields() method 2) It\'s implementation of getHeaderField(String name) is case sensitive. 3) It returns an empty string \"\", rather than null, for header values which don\'t exist. Patch provided by Chris Hubick.','java/org/apache/naming/resources/DirContextURLConnection.java\njava/org/apache/naming/resources/ResourceAttributes.java'),(2031,44611,'Bug 44611 – DirContextURLConnection Header Bugs','','2008-03-15 21:32:08','Chris Hubick','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','024afb6','Mark Emlyn David Thomas','2008-03-24 17:30:03','Fix bug 44611 https://issues.apache.org/bugzilla/show_bug.cgi?id=44611 DirContextURLConnection: 1) Does not implement the getHeaderFields() method 2) It\'s implementation of getHeaderField(String name) is case sensitive. 3) It returns an empty string \"\", rather than null, for header values which don\'t exist. Patch provided by Chris Hubick.','java/org/apache/naming/resources/DirContextURLConnection.java\njava/org/apache/naming/resources/ResourceAttributes.java'),(2032,44620,'Bug 44620 – infinit loop in nio connector code','The code below has a chance to cause tomcat enter dead loop in class InternalNioOutputBuffer \n\n    private synchronized void addToBB(byte[] buf, int offset, int length) throws IOException {\n -->       while (socket.getBufHandler().getWriteBuffer().remaining() < length) {\n            flushBuffer();\n        }\n\nwhen the buffer size of socket is smaller than length. \nThe default size of socket comes from socket.appWriteBufSize, which is 8192; The value of length is limited by maxHttpHeaderSize, which is 9000. Well, the chance for dead loop exists and happened.\nIt can be avoid if we config the two value correctly in server.xml','2008-03-17 08:53:41','tangy','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P4 normal','53acd2f','Mark Emlyn David Thomas','2008-03-24 16:52:42','Fix BZ 44620 https://issues.apache.org/bugzilla/show_bug.cgi?id=44620 Move the code that handles writing more than the output buffer can accept in a single write to the method that does the writing. This then protects all calls to addToBB() from the issue described in BZ 44620 and does not require the socket.appWriteBufSize to be >= maxHttpHeaderSize','java/org/apache/coyote/http11/InternalNioOutputBuffer.java'),(2033,44620,'Bug 44620 – infinit loop in nio connector code','The code below has a chance to cause tomcat enter dead loop in class InternalNioOutputBuffer \n\n    private synchronized void addToBB(byte[] buf, int offset, int length) throws IOException {\n -->       while (socket.getBufHandler().getWriteBuffer().remaining() < length) {\n            flushBuffer();\n        }\n\nwhen the buffer size of socket is smaller than length. \nThe default size of socket comes from socket.appWriteBufSize, which is 8192; The value of length is limited by maxHttpHeaderSize, which is 9000. Well, the chance for dead loop exists and happened.\nIt can be avoid if we config the two value correctly in server.xml','2008-03-17 08:53:41','tangy','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P4 normal','53acd2f','Mark Emlyn David Thomas','2008-03-24 16:52:42','Fix BZ 44620 https://issues.apache.org/bugzilla/show_bug.cgi?id=44620 Move the code that handles writing more than the output buffer can accept in a single write to the method that does the writing. This then protects all calls to addToBB() from the issue described in BZ 44620 and does not require the socket.appWriteBufSize to be >= maxHttpHeaderSize','java/org/apache/coyote/http11/InternalNioOutputBuffer.java'),(2034,44620,'Bug 44620 – infinit loop in nio connector code','The code below has a chance to cause tomcat enter dead loop in class InternalNioOutputBuffer \n\n    private synchronized void addToBB(byte[] buf, int offset, int length) throws IOException {\n -->       while (socket.getBufHandler().getWriteBuffer().remaining() < length) {\n            flushBuffer();\n        }\n\nwhen the buffer size of socket is smaller than length. \nThe default size of socket comes from socket.appWriteBufSize, which is 8192; The value of length is limited by maxHttpHeaderSize, which is 9000. Well, the chance for dead loop exists and happened.\nIt can be avoid if we config the two value correctly in server.xml','2008-03-17 08:53:41','tangy','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P4 normal','53acd2f','Mark Emlyn David Thomas','2008-03-24 16:52:42','Fix BZ 44620 https://issues.apache.org/bugzilla/show_bug.cgi?id=44620 Move the code that handles writing more than the output buffer can accept in a single write to the method that does the writing. This then protects all calls to addToBB() from the issue described in BZ 44620 and does not require the socket.appWriteBufSize to be >= maxHttpHeaderSize','java/org/apache/coyote/http11/InternalNioOutputBuffer.java'),(2035,44633,'Bug 44633 – say which jar/class is wrong when throwing UnsupportedClassVersionError','after happily using tomcat 6/java6, we had to move back to tomcat 5/java5. \n\nUnfortunately, it seems that one jar or .class files not yet compiled under java5 got there too.\n\nSuggestion:\n\nin  at org.apache.catalina.loader.WebappClassLoader.findClassInternal(WebappClassLoader.java:1815)\n\ncatch UnsupportedClassVersionError and re-throw it after adding hints with which class sought/jar file it happens!\n\njava.lang.reflect.InvocationTargetException\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:585)\n        at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:294)\n        at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:432)\nCaused by: java.lang.UnsupportedClassVersionError: Bad version number in .class file\n        at java.lang.ClassLoader.defineClass1(Native Method)\n        at java.lang.ClassLoader.defineClass(ClassLoader.java:620)\n        at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:124)\n        at org.apache.catalina.loader.WebappClassLoader.findClassInternal(WebappClassLoader.java:1815)\n        at org.apache.catalina.loader.WebappClassLoader.findClass(WebappClassLoader.java:869)\n        at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1322)\n        at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1201)\n        at org.apache.catalina.core.StandardWrapper$1.run(StandardWrapper.java:1017)\n        at java.security.AccessController.doPrivileged(Native Method)\n        at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1013)\n        at org.apache.catalina.core.StandardWrapper.load(StandardWrapper.java:932)\n        at org.apache.catalina.core.StandardContext.loadOnStartup(StandardContext.java:3951)\n        at org.apache.catalina.core.StandardContext.start(StandardContext.java:4225)\n        at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1013)\n        at org.apache.catalina.core.StandardHost.start(StandardHost.java:718)\n        at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1013)\n        at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:442)\n        at org.apache.catalina.core.StandardService.start(StandardService.java:450)\n        at org.apache.catalina.core.StandardServer.start(StandardServer.java:709)\n        at org.apache.catalina.startup.Catalina.start(Catalina.java:551)\n        ... 6 more','2008-03-19 08:25:39','Ralf Hauser','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','326b621','Mark Emlyn David Thomas','2008-03-24 16:30:14','Use Rainer\'s improved patch for bug 44633','java/org/apache/catalina/loader/LocalStrings.properties\njava/org/apache/catalina/loader/WebappClassLoader.java'),(2036,44633,'Bug 44633 – say which jar/class is wrong when throwing UnsupportedClassVersionError','after happily using tomcat 6/java6, we had to move back to tomcat 5/java5. \n\nUnfortunately, it seems that one jar or .class files not yet compiled under java5 got there too.\n\nSuggestion:\n\nin  at org.apache.catalina.loader.WebappClassLoader.findClassInternal(WebappClassLoader.java:1815)\n\ncatch UnsupportedClassVersionError and re-throw it after adding hints with which class sought/jar file it happens!\n\njava.lang.reflect.InvocationTargetException\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:585)\n        at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:294)\n        at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:432)\nCaused by: java.lang.UnsupportedClassVersionError: Bad version number in .class file\n        at java.lang.ClassLoader.defineClass1(Native Method)\n        at java.lang.ClassLoader.defineClass(ClassLoader.java:620)\n        at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:124)\n        at org.apache.catalina.loader.WebappClassLoader.findClassInternal(WebappClassLoader.java:1815)\n        at org.apache.catalina.loader.WebappClassLoader.findClass(WebappClassLoader.java:869)\n        at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1322)\n        at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1201)\n        at org.apache.catalina.core.StandardWrapper$1.run(StandardWrapper.java:1017)\n        at java.security.AccessController.doPrivileged(Native Method)\n        at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1013)\n        at org.apache.catalina.core.StandardWrapper.load(StandardWrapper.java:932)\n        at org.apache.catalina.core.StandardContext.loadOnStartup(StandardContext.java:3951)\n        at org.apache.catalina.core.StandardContext.start(StandardContext.java:4225)\n        at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1013)\n        at org.apache.catalina.core.StandardHost.start(StandardHost.java:718)\n        at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1013)\n        at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:442)\n        at org.apache.catalina.core.StandardService.start(StandardService.java:450)\n        at org.apache.catalina.core.StandardServer.start(StandardServer.java:709)\n        at org.apache.catalina.startup.Catalina.start(Catalina.java:551)\n        ... 6 more','2008-03-19 08:25:39','Ralf Hauser','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','479d941','Mark Emlyn David Thomas','2008-03-24 11:57:42','Fix bug 44633. Tell use which class failed to load due to wrong version number.','java/org/apache/catalina/loader/LocalStrings.properties\njava/org/apache/catalina/loader/WebappClassLoader.java'),(2037,44646,'Bug 44646 – IllegalStateException when using CometConnectionManagerValve','We\'re writing an application that processes requests using both a normal servlet and a CometProcessor. The normal servlet handles user authentication and logout (among other things). Once the user has been authenticated, the client makes a Comet request, which is open until the server has something to push to the client. When the user decides to log out, we need to stop processing Comet events for that client. I enabled the CometConnectionManagerValve in context.xml, hoping I would get an END event when the session goes away. Instead, I get an IllegalStateException:\nMar 10, 2008 2:05:41 PM org.apache.catalina.connector.CoyoteAdapter event\nSEVERE: An exception or error occurred in the container during the request processing\njava.lang.IllegalStateException: Cannot create a session after the response has been committed\n   at org.apache.catalina.connector.Request.doGetSession(Request.java:2301)\n   at org.apache.catalina.connector.Request.getSession(Request.java:2075)\n   at org.apache.catalina.valves.CometConnectionManagerValve.event(CometConnectionManagerValve.java:311)\n   at org.apache.catalina.core.StandardHostValve.event(StandardHostValve.java:179)\n   at org.apache.catalina.valves.ValveBase.event(ValveBase.java:200)\n   at org.apache.catalina.core.StandardEngineValve.event(StandardEngineValve.java:128)\n   at org.apache.catalina.connector.CoyoteAdapter.event(CoyoteAdapter.java:198)\n   at org.apache.coyote.http11.Http11NioProcessor.event(Http11NioProcessor.java:749)\n   at org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.event(Http11NioProtocol.java:653)\n   at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:2080)\n   at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:885)\n   at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:907)\n   at java.lang.Thread.run(Thread.java:619)\n\nPresumably my servlet handles the \"logout\" request, and after sending a response to the client, calls invalidate() on the HttpSession. Subsequently, CometConnectionManagerValue.event() calls request.getSession(true), resulting in the IllegalStateException.','2008-03-20 09:33:14','Dan Rabe','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 normal','fdac1d6','Mark Emlyn David Thomas','2008-03-23 19:22:07','Fix https://issues.apache.org/bugzilla/show_bug.cgi?id=44646 The problem was wider than the issue described in the bug report. The session listener and the valve are different objects so the connection list wasn\'t visible to the session listener. I couldn\'t see an easy way to make them the same object so I used two lists - one for the valve (stored in the valve) and one for the session (stored in the session). This valve now works for a simple comet app.','java/org/apache/catalina/valves/CometConnectionManagerValve.java\njava/org/apache/catalina/valves/LocalStrings.properties'),(2038,44558,'Bug 44558 – cite attempted address when throwing \"Cannot assign requested address\"','SEVERE: Error starting endpoint\njava.net.BindException: Cannot assign requested address:2217\n        at org.apache.tomcat.util.net.JIoEndpoint.init(JIoEndpoint.java:501)\n        at org.apache.tomcat.util.net.JIoEndpoint.start(JIoEndpoint.java:515)\n        at org.apache.coyote.http11.Http11Protocol.start(Http11Protocol.java:203)\n        at org.apache.catalina.connector.Connector.start(Connector.java:1131)\n        at org.apache.catalina.core.StandardService.start(StandardService.java:531)\n        at org.apache.catalina.core.StandardServer.start(StandardServer.java:710)\n        at org.apache.catalina.startup.Catalina.start(Catalina.java:578)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n\nsaying which address a bind was attempted for would accelerate the error resolution quite a bit!','2008-03-07 07:41:10','Ralf Hauser','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 normal','7bd915c','Mark Emlyn David Thomas','2008-03-09 13:31:48','Fix bug 44558. Include address in bind exception message.','java/org/apache/tomcat/util/net/JIoEndpoint.java'),(2039,44562,'Bug 44562 – HEAD requests cannot go through request dispatch include.','','2008-03-07 13:19:40','david jencks','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Servlet & JSP API','P2 normal','288b2ae','Mark Emlyn David Thomas','2008-03-09 13:19:00','Fix bug 44562. HEAD requests fail with rd.include(). Patch provided by David Jencks.','java/javax/servlet/http/HttpServlet.java'),(2040,44494,'Bug 44494 – Requests greater than 8k being truncated.','After updating to Tomcat 5.5.26 from Tomcat 5.5.23 we appear to be having trouble with requests, that are greater than 8k, being truncated with the CoyoteRequest.getReader() method.\n\nThe following steps caused this issue to appear:\n1. I constructed a post request from a jsp page which exceeded 8k in size.\n2. In the corresponding servlet I call request.getReader() and pipe the returned BufferedReader into a string.\n3. Inspection of the string reveals that the content is  being truncated after 8k.\n4. If I replace the request.getReader() method call with request.getInputStream() no truncation occurs. Also, after reverting back to Tomcat 5.5.23 and using the request.getReader() method no truncation occurs.','2008-02-26 19:47:31','Jonathan Rubin','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Connector:Coyote','P2 normal','030c7ac','Filip Hanik','2008-02-27 15:12:18','Revert back to original patch proposed for UTF8 parsing. This also fixes the regression for 6.0.16 and 5.5.26 (and possibly 4.1.37) mentioned in http://issues.apache.org/bugzilla/show_bug.cgi?id=44494','java/org/apache/catalina/connector/InputBuffer.java\njava/org/apache/tomcat/util/buf/B2CConverter.java'),(2041,43878,'Bug 43878 – Tag-file classes get loaded for each JSP -> perm gen space problem','','2007-11-16 01:20:37','Christoph Korn','Tomcat Developers Mailing List','RESOLVED WONTFIX','Tomcat 6','Jasper','P2 normal','2c09c16','Mark Emlyn David Thomas','2008-02-21 17:02:50','Revert r616563 which was a fix for bug 43878 that has now been marked as WONTFIX.','java/org/apache/jasper/JspCompilationContext.java\njava/org/apache/jasper/compiler/JspRuntimeContext.java'),(2042,43741,'Bug 43741 – .tag files in a .tar recompiled for each .jsp -- extremely slow (with fix)','Jasper is *extremely* slow at compiling .tag files packaged in a .jar -- tens \nof seconds per JSP. One cause is that .tag files are repeatedly recompiled for \neach .jsp even though they have not changed.\n\nThe following few lines fix this.  The added code is marked between // --------\n AJB markers.  \nIt effectively turns off the timestamp checking on .jar files.\n\nThis does NOT actually introduce a bug.  There is an existing bug in that .jsp \nfiles are not \nautomatically recompiled if any .tags in .jars are changed.  So you need to \npurge work in either case.  \nA proper fix would be to check dependencies properly, at least to the .jar \nfile itself.  \nBut the current fix is *much* better that the existing behavior.\n\nThere are better solutions, but an 80% solution is better than no solution.\n\n\n// Tomcat 6.0.10 Src deployed version.\n\npublic class JspCompilationContext {...\n\n    public void compile() throws JasperException, FileNotFoundException {\n        createCompiler();\n\n        // ------------ begin AJB\n        // Hack to stop .tag files that are packaged in .jars being recompiled \nfor every single .jsp that uses them.\n        // The hack means that .tag files will not be automatically recompiled \nif they change -- you need to delete work area.\n        // But that was actually an existing bug -- .jsps are not dependent on \nthe .tag .jars so the work area needed deleting anyway.\n        // (Outstanding is to compile multiple .tags in one pass and so make \nthe process Much faster.)\n        boolean outDated;\n        if (isPackagedTagFile) outDated = ! new File(getClassFileName()).exists\n();\n        else outDated = jspCompiler.isOutDated();\n//        AjbLog.log(\"### Compiler.compile \" + jspUri + \" pkgTagFile \" + \nisPackagedTagFile + \" outDated \" + outDated + \" \" + getClassFileName());\n        if (outDated) {\n//     if (isPackagedTagFile || jspCompiler.isOutDated()) { // original code.\n//     ---------------- end AJB\n            try {\n                jspCompiler.removeGeneratedFiles();\n                jspLoader = null;\n                jspCompiler.compile();\n                jsw.setReload(true);\n                jsw.setCompilationException(null);\n            } catch (JasperException ex) {\n                // Cache compilation exception\n                jsw.setCompilationException(ex);\n                throw ex;\n            } catch (Exception ex) {\n                JasperException je = new JasperException(\n                            Localizer.getMessage(\"jsp.error.unable.compile\"),\n                            ex);\n                // Cache compilation exception\n                jsw.setCompilationException(je);\n                throw je;\n            }\n        }\n    }','2007-10-30 21:10:48','Anthony Berglas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 major','551ffe0','Mark Emlyn David Thomas','2008-02-04 17:58:21','Fix for bug 43741. Correctly handle dependencies for tag files in JARs.','java/org/apache/jasper/JspCompilationContext.java\njava/org/apache/jasper/compiler/Compiler.java\njava/org/apache/jasper/compiler/TagFileProcessor.java'),(2043,44337,'Bug 44337 – Dir listing crashes if no readme-file present','DefaultServlet docu 6.0  says about attibute readmeFile:\nIf a directory listing is presented, a readme file\n *may* \nalso be presented with the listing. This file is inserted\n.....\n\nThis was true for 5.5.x.\n\n6.0.14 crashes if the file is absent in the listed directory.\njavax.servlet.ServletException: \nError opening readme resource at\norg.apache.catalina.servlets.DefaultServlet.getReadme(DefaultServlet.java:1418)\n\nThis new behaviour blocks the listing of big directory trees managed by others,\nwhere the work-around is nor feasible.\n\nWork around 1: readme file in *every* subdir, empty (length=0) if none wanted \n     (and subsequent changes in the used XSL-Transformers)\nWork around 2: Change \"may\" to  \"must\" in docu.\n\nRepair: fix DefaultServlet\n\nFrom web.xml:\n\n    <servlet>\n        <servlet-name>default</servlet-name>\n        <servlet-class>org.apache.catalina.servlets.DefaultServlet</servlet-class>\n        <init-param>\n            <param-name>listings</param-name>\n            <param-value>true</param-value>\n        </init-param>\n        <init-param>\n            <param-name>globalXsltFile</param-name>\n            <param-value>D:\\www\\serv-intra\\meva-dir-li.xsl</param-value>\n        </init-param>\n        <init-param>\n            <param-name>readmeFile</param-name>\n            <param-value>readme.htm</param-value>\n        </init-param>\n        <load-on-startup>1</load-on-startup>\n    </servlet>','2008-02-01 01:54:32','Dr. Albrecht Weinert','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 blocker','8a3b14b','Timothy A. Funk','2008-02-03 21:10:39','http://issues.apache.org/bugzilla/show_bug.cgi?id=44337 Dir listing crashes if no readme-file present','java/org/apache/catalina/servlets/DefaultServlet.java'),(2044,43701,'Bug 43701 – Error while starting tomcat','this is my NIO Connector configuration in server.xml \n<Connector acceptCount=\"100\" enableLookups=\"false\" port=\"80\"\nprotocol=\"org.apache.coyote.http11.Http11NioProtocol\" \n      acceptorThreadCount=\"2\" socket.bufferPool=\"-1\" connectionTimeout=\"60000\"\nmaxKeepAliveRequests=\"-1\" maxThreads=\"200\"\n      minSpareThreads=\"25\" redirectPort=\"8443\" />\n\nwhen I am starting my tomcat it is giving following error in the console several\ntime \nSEVERE: \njava.lang.NullPointerException\n	at org.apache.tomcat.util.net.NioEndpoint.setSocketOptions(NioEndpoint.java:985)\n	at org.apache.tomcat.util.net.NioEndpoint$Acceptor.run(NioEndpoint.java:1169)\n	at java.lang.Thread.run(Thread.java:595)','2007-10-26 03:01:21','prabhat','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P1 critical','bf6ce6f','Filip Hanik','2008-02-03 14:06:00','Fix defect 43701','java/org/apache/tomcat/util/net/NioEndpoint.java\nwebapps/docs/changelog.xml'),(2045,43741,'Bug 43741 – .tag files in a .tar recompiled for each .jsp -- extremely slow (with fix)','Jasper is *extremely* slow at compiling .tag files packaged in a .jar -- tens \nof seconds per JSP. One cause is that .tag files are repeatedly recompiled for \neach .jsp even though they have not changed.\n\nThe following few lines fix this.  The added code is marked between // --------\n AJB markers.  \nIt effectively turns off the timestamp checking on .jar files.\n\nThis does NOT actually introduce a bug.  There is an existing bug in that .jsp \nfiles are not \nautomatically recompiled if any .tags in .jars are changed.  So you need to \npurge work in either case.  \nA proper fix would be to check dependencies properly, at least to the .jar \nfile itself.  \nBut the current fix is *much* better that the existing behavior.\n\nThere are better solutions, but an 80% solution is better than no solution.\n\n\n// Tomcat 6.0.10 Src deployed version.\n\npublic class JspCompilationContext {...\n\n    public void compile() throws JasperException, FileNotFoundException {\n        createCompiler();\n\n        // ------------ begin AJB\n        // Hack to stop .tag files that are packaged in .jars being recompiled \nfor every single .jsp that uses them.\n        // The hack means that .tag files will not be automatically recompiled \nif they change -- you need to delete work area.\n        // But that was actually an existing bug -- .jsps are not dependent on \nthe .tag .jars so the work area needed deleting anyway.\n        // (Outstanding is to compile multiple .tags in one pass and so make \nthe process Much faster.)\n        boolean outDated;\n        if (isPackagedTagFile) outDated = ! new File(getClassFileName()).exists\n();\n        else outDated = jspCompiler.isOutDated();\n//        AjbLog.log(\"### Compiler.compile \" + jspUri + \" pkgTagFile \" + \nisPackagedTagFile + \" outDated \" + outDated + \" \" + getClassFileName());\n        if (outDated) {\n//     if (isPackagedTagFile || jspCompiler.isOutDated()) { // original code.\n//     ---------------- end AJB\n            try {\n                jspCompiler.removeGeneratedFiles();\n                jspLoader = null;\n                jspCompiler.compile();\n                jsw.setReload(true);\n                jsw.setCompilationException(null);\n            } catch (JasperException ex) {\n                // Cache compilation exception\n                jsw.setCompilationException(ex);\n                throw ex;\n            } catch (Exception ex) {\n                JasperException je = new JasperException(\n                            Localizer.getMessage(\"jsp.error.unable.compile\"),\n                            ex);\n                // Cache compilation exception\n                jsw.setCompilationException(je);\n                throw je;\n            }\n        }\n    }','2007-10-30 21:10:48','Anthony Berglas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 major','61aefb5','Mark Emlyn David Thomas','2008-02-01 17:32:13','Revert fix for 43741. Aim for better fix that handles tag files in JARs.','java/org/apache/jasper/JspCompilationContext.java'),(2046,44282,'Bug 44282 – WebappClassLoader.findClass calls getClassLoader without privileges','When logging is in TRACE mode or lower,\norg.apache.catalina.loader.WebappClassLoader.findClass(String) calls\ngetClassLoader() without a privileged block.  With security enabled, this will\ncause a SecurityException if the RuntimePermission to getClassLoader is not granted.','2008-01-22 23:50:47','Eddy Chan','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P4 minor','948598d','Mark Emlyn David Thomas','2008-01-30 18:24:48','Fix bug 44282. Do call to getClassLoader() in a privileged block.','java/org/apache/catalina/loader/WebappClassLoader.java'),(2047,43878,'Bug 43878 – Tag-file classes get loaded for each JSP -> perm gen space problem','','2007-11-16 01:20:37','Christoph Korn','Tomcat Developers Mailing List','RESOLVED WONTFIX','Tomcat 6','Jasper','P2 normal','b396ffc','Mark Emlyn David Thomas','2008-01-29 18:37:08','Better fix for 43878. If we aren\'t re-loading, use a single class loader for JSPs and tag files to reduce perm gen space usage','java/org/apache/jasper/JspCompilationContext.java\njava/org/apache/jasper/compiler/JspRuntimeContext.java'),(2048,43741,'Bug 43741 – .tag files in a .tar recompiled for each .jsp -- extremely slow (with fix)','Jasper is *extremely* slow at compiling .tag files packaged in a .jar -- tens \nof seconds per JSP. One cause is that .tag files are repeatedly recompiled for \neach .jsp even though they have not changed.\n\nThe following few lines fix this.  The added code is marked between // --------\n AJB markers.  \nIt effectively turns off the timestamp checking on .jar files.\n\nThis does NOT actually introduce a bug.  There is an existing bug in that .jsp \nfiles are not \nautomatically recompiled if any .tags in .jars are changed.  So you need to \npurge work in either case.  \nA proper fix would be to check dependencies properly, at least to the .jar \nfile itself.  \nBut the current fix is *much* better that the existing behavior.\n\nThere are better solutions, but an 80% solution is better than no solution.\n\n\n// Tomcat 6.0.10 Src deployed version.\n\npublic class JspCompilationContext {...\n\n    public void compile() throws JasperException, FileNotFoundException {\n        createCompiler();\n\n        // ------------ begin AJB\n        // Hack to stop .tag files that are packaged in .jars being recompiled \nfor every single .jsp that uses them.\n        // The hack means that .tag files will not be automatically recompiled \nif they change -- you need to delete work area.\n        // But that was actually an existing bug -- .jsps are not dependent on \nthe .tag .jars so the work area needed deleting anyway.\n        // (Outstanding is to compile multiple .tags in one pass and so make \nthe process Much faster.)\n        boolean outDated;\n        if (isPackagedTagFile) outDated = ! new File(getClassFileName()).exists\n();\n        else outDated = jspCompiler.isOutDated();\n//        AjbLog.log(\"### Compiler.compile \" + jspUri + \" pkgTagFile \" + \nisPackagedTagFile + \" outDated \" + outDated + \" \" + getClassFileName());\n        if (outDated) {\n//     if (isPackagedTagFile || jspCompiler.isOutDated()) { // original code.\n//     ---------------- end AJB\n            try {\n                jspCompiler.removeGeneratedFiles();\n                jspLoader = null;\n                jspCompiler.compile();\n                jsw.setReload(true);\n                jsw.setCompilationException(null);\n            } catch (JasperException ex) {\n                // Cache compilation exception\n                jsw.setCompilationException(ex);\n                throw ex;\n            } catch (Exception ex) {\n                JasperException je = new JasperException(\n                            Localizer.getMessage(\"jsp.error.unable.compile\"),\n                            ex);\n                // Cache compilation exception\n                jsw.setCompilationException(je);\n                throw je;\n            }\n        }\n    }','2007-10-30 21:10:48','Anthony Berglas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 major','cc639cc','Mark Emlyn David Thomas','2008-01-29 18:14:23','Fix bug 43741. Tag files in JARs were getting compiled once for every JSP that used them. Patch provided by Anthony Berglas.','java/org/apache/jasper/JspCompilationContext.java'),(2049,43878,'Bug 43878 – Tag-file classes get loaded for each JSP -> perm gen space problem','','2007-11-16 01:20:37','Christoph Korn','Tomcat Developers Mailing List','RESOLVED WONTFIX','Tomcat 6','Jasper','P2 normal','d93473e','Mark Emlyn David Thomas','2008-01-28 16:05:04','Revert attempt to fix 43878 since patch is obviously wrong.','java/org/apache/jasper/JspCompilationContext.java\njava/org/apache/jasper/compiler/JspRuntimeContext.java'),(2050,44268,'Bug 44268 – Multiple registrations of same ServletContextListener class not possible','When I register the same class implementing ServletContextListener twice or more\nits\' contextInitialized methods only gets called once.\n\nThe servlet specifications (2.4 and 2.5) say the conforming container has to \ncall the listeners in the same order they are registered in the deployment\ndescriptor.\nThe case that one listener class is registered twice is not mentioned\nexplicitly in the specification, though.\n\nExample:\n<listener>\n  <listener-class>test.ServletContextListener1</listener-class>\n</listener>\n<listener>\n  <listener-class>test.ServletContextListener2</listener-class>\n</listener>\n<listener>\n  <listener-class>test.ServletContextListener1</listener-class>\n</listener>\n\ntest.ServletContextListener1 and test.ServletContextListener2 get called,\nbut test.ServletContextListener1 does not get called again.\n\nApache Tomcat 5.5.25 has the same bug.','2008-01-18 08:42:18','Stefan Fleiter','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 enhancement','cdff09f','Mark Emlyn David Thomas','2008-01-21 16:14:57','Log a warning if a duplicate listener is ignored. Result of bug 44268.','java/org/apache/catalina/core/LocalStrings.properties\njava/org/apache/catalina/core/StandardContext.java'),(2051,44223,'Bug 44223 – Tomcat ignores the \"javax.net.ssl.trustStoreType\" system property','Set up a SSL Connector with a keystore in JKS format:\n\n<Connector ... SSLEnabled=\"true\"\nkeystoreFile=\"tomcat.keystore\" keystoreType=\"JKS\">\n\nLet\'s say you need a custom truststore (e.g. for authenticating self-signed \nclient certificates), and that this truststore is also needed by some of your \nwebapps, not only Tomcat. The natural thing to do then is to configure this \ntruststore globally for the whole JVM, not in server.xml.\n\nLet\'s also assume this truststore is in a different format (e.g. PKCS#12). So \nbefore starting Tomcat, you do this:\n\nexport JAVA_OPTS=\"-Djavax.net.ssl.trustStore=trusted.keystore -\nDjavax.net.ssl.trustStoreType=PKCS12\"\n\nWell, it doesn\'t work. If you look at tomcat/logs/catalina.out, you will see a \nkeystore-related exception. Upon further debugging, you will discover the \nproblem is that Tomcat is trying to open the truststore as if it were in JKS \nformat, even though it is clearly specified as type PKCS12 in JAVA_OPTS above.','2008-01-14 04:24:16','Ivan Todoroski','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 normal','f9e41b8','Mark Emlyn David Thomas','2008-01-18 15:57:51','Fix bug 44223. Use all the trust store system properties.','java/org/apache/tomcat/util/net/jsse/JSSESocketFactory.java'),(2052,43315,'Bug 43315 – scriptdef should be able to load multiple script files','After writing several tasks in javascript I\'ve not found a way to reuse parts of\nthe code between scripts. As with the browser, the <scriptdef> task should allow\nmutliple script files to be loaded into the context/scope to create the complete\nscript. For example:\n\n  <scriptdef name=\"foo\">\n    <attribute name=\"bar\"/>\n    <script language=\"javascript\" src=\"foobar.js\"/>\n    <script language=\"javascript\" src=\"foobar2.js\"/>\n    <script language=\"ruby\" src=\"foobar.ruby\"/>\n  </scriptdef>\n\nIdeally. If problematic, the language could be part of the scriptdef, like so:\n\n  <scriptdef language=\"javascript\" name=\"foo\">\n    <attribute name=\"bar\"/>\n    <script src=\"foobar.js\"/>\n    <script src=\"foobar2.js\"/>\n  </scriptdef>\n\nThen it would be little more than the concatenation of the set of <script> tag\'s\nsrc values.','2007-09-05 18:10:21','Don Griffin','Ant Notifications List','NEW','Ant','Optional Tasks','P2 enhancement','8d61a50','Mark Emlyn David Thomas','2008-01-16 18:42:37','Fix 43315. Display value rather than key.','java/org/apache/catalina/manager/HTMLManagerServlet.java'),(2053,43468,'Bug 43468 – HTMLManagerServlet NullPointerException listing context','Obtained the following NullPointerException, stack trace below\n\njava.lang.NullPointerException\n	org.apache.catalina.manager.HTMLManagerServlet.list(HTMLManagerServlet.java:437)\n	org.apache.catalina.manager.HTMLManagerServlet.doGet(HTMLManagerServlet.java:136)\n\nCode is:\n\nargs[11] = new Integer(context.getManager().getMaxInactiveInterval()/60);\n\nSeemingly the getManager() is returning null.','2007-09-24 18:46:12','Gary Feltham','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Manager application','P2 normal','e14afee','Mark Emlyn David Thomas','2008-01-16 18:40:53','Fix bug 43468. Prevent NPE.','build.properties.default\njava/org/apache/catalina/manager/HTMLManagerServlet.java\njava/org/apache/catalina/manager/LocalStrings.properties'),(2054,43173,'Bug 43173 – Logging documentation says to put logging.properties in common/classes','In the java.util.logging section of the logging documentation there\'s the\nfollowing line:\n\n\"Example logging.properties file to be placed in common/classes:\"\n\nI think it should say:\n\"Example logging.properties contained in $CATALINA_HOME/conf:\"','2007-08-20 21:03:54','ole ersoy','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P2 normal','f806ed1','Mark Emlyn David Thomas','2008-01-16 18:30:19','Fix bug 43173. Correct location for logging.properties.','webapps/docs/logging.xml'),(2055,43344,'Bug 43344 – Misspelling in if.jsp example','','2007-09-10 11:33:06','Tim Nowaczyk','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Examples','P2 trivial','6be0486','Mark Emlyn David Thomas','2008-01-10 16:53:14','Fix bug 43344. Correct typo. Patch provided by Tim Nowaczyk.','conf/tomcat-users.xml\nwebapps/examples/jsp/tagplugin/if.jsp'),(2056,11117,'Bug 11117 – Coyote connector does not correctly deal with large PUT when using chunked transfer encoding','I\'ve built a small test servlet (included below) that shows this behaviour.\n\nIf I upload data to tomcat (configured to use the HTTP/1.1 Coyote connector)\nusing a chunked transfer-encoding on a PUT, then the result (i.e. what I read\nusing the servlet\'s request.getInputStream() is corrupted.\n\nThis _only_ happens on large PUTs (it happens every time I tried it (about 10)\non a large PUT - I was testing with something around 700 kB, and another thing\nof about 1 MB, but does NOT always corrupt it in the same way. I did not see any\ncorruption on small files (~50 kB and smaller), though I didn\'t test this\nextensively.\n\nThe total length of the data read is exactly correct (712080 bytes in my first\ntest). At the first point of corruption in the file, a chunk header appears in\nthe output (\"\\r\\n1000\\r\\n\") followed by correct data from about 700 bytes later\non, then a second copy (in the correct place, I think) of the corrupt data (i.e.\ncorrect data, followed by the chunk header, followed by some data repeated, the\nsecond instance of which is in the correct place - so the first instance is\nbeing produced _instead_ of the correct data for that point in the input).\n\nTest servlet follows:\n\nimport java.io.*;\n\nimport javax.servlet.*;\nimport javax.servlet.http.*;\n\npublic class Test extends HttpServlet\n{\n\n    public void doPut(HttpServletRequest req, HttpServletResponse res)\n                throws ServletException, IOException\n    {\n        FileOutputStream fos = new FileOutputStream(\"/tmp/servlet-out\");\n\n        InputStream is = req.getInputStream();\n\n        byte buf[] = new byte[2000];\n        int ret;\n\n        while((ret = is.read(buf)) > 0) {\n            fos.write(buf, 0, ret);\n        }\n\n        fos.close();\n        is.close();\n\n        PrintWriter pw = res.getWriter();\n        pw.println(\"Done\");\n        pw.flush();\n        pw.close();\n    }\n}','2002-07-24 07:44:57','Michael Smith','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 4','Connector:Coyote HTTP/1.1','P3 major','1cc6641','Filip Hanik','2008-01-08 16:45:03','fix regression for bug 11117 while maintaining the no need to proceed and block for comet connections that handle chunked input','java/org/apache/coyote/http11/filters/ChunkedInputFilter.java'),(2057,43743,'Bug 43743 – Cannot jspc precompile jsps with nested .tag files','myjsp.jsp:  HELLO <tag1/>\ntag1.tag:  <tag2>\ntag2.tag:  WORLD\n\nCrashes (null pointer)  while trying to load tag2.class, called by  \nTagFileProcessor.loadTagFile.\n\nVery Initial analysis:-\nTagFileProcessor.loadTagFile creates wrapper, but ctxt.getTagFileJarUrl\n(tagFilePath) returns null for nested .tag.\nThus in JspCompilationContext.Compile  JspCCtx.isPackagedFile == false, so \noutDated test is wrong\nSo tag2.tag not compiled, thus class cannot be loaded.\n\nBut problem also appears if tags not packaged in a .jar, so there is more \ngoing on.\n\nWork around is to create dummy.jsp that calls the .tags in leaf first order \nso .class files are created.','2007-10-30 21:25:38','Anthony Berglas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P3 normal','98b8ba2','Mark Emlyn David Thomas','2008-01-07 18:15:59','Fix bug 43743. Correctly handle nest tag files packaged in a jar.','java/org/apache/jasper/compiler/Parser.java'),(2058,43839,'Bug 43839 – I think the implement is difference with the document in function CoyoteAdapter.postParseRequest','','2007-11-11 19:35:39','Yuan Qingyun','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 major','7196ac0','Mark Emlyn David Thomas','2008-01-04 15:59:59','Fix possible NPE when no ROOT application is deployed in fix for bug 43839.','java/org/apache/catalina/connector/CoyoteAdapter.java'),(2059,43840,'Bug 43840 – Unexpected behaviour when GenericPrincipal is serialized using the SerializablePrincipal in a cluster.','The method \'getUserPrincipal()\' in the GenericPrincipal class returns itself or\na provided Principal if possible. This is also the return value of the\nrequest.getUserPrincipal() method. This works fine in a non-clustered environment.\n\nHowever the behaviour of this method changes when the GenericPrincipal is\nserialized by the SerializablePrincipal class. In the initial node of a cluster\nthe request.getUserPrincipal() method behaves normally. However after the\nprincipal is serialized to another node it no longer contains the internal\nPrincipal object, so the same method call will now return a different object.\n\nI think a solution could be:\n\n1) If there exists an internal userPrincipal AND it is Serializable then\nserialize it along with the other properties of GenericPrincipal.\n\n2) Recreate it at the other end if it is available in the object stream.\n\nIn this manner users with custom Principal objects that implement\njava.io.Serializable will have predictable results from the\nrequest.getUserPrincipal method across nodes in a cluster.\n\nI\'d appreciate your thoughts on this.\n\nThanks,\nAshley','2007-11-11 20:12:16','ashley','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Cluster','P2 normal','32f20e8','Mark Emlyn David Thomas','2008-01-03 17:04:48','Improve fix for 43840 with better error handling, a better variable name and a bit of other clean-up.','java/org/apache/catalina/ha/session/LocalStrings.properties\njava/org/apache/catalina/ha/session/SerializablePrincipal.java\ntest/org/apache/catalina/ha/session/TestSerializablePrincipal.java'),(2060,43758,'Bug 43758 – java.lang.NullPointerException from org.apache.jasper.compiler.ServletWriter.printMultiLn() on validation of JSPX with empty <jsp:scriptlet> element','','2007-10-31 11:58:06','Alexander Chernikov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P3 minor','61ce1a3','Mark Emlyn David Thomas','2008-01-01 15:04:45','Fix bug 43758. Return empty string rather than null to prevent the NPEs that happen otherwise.','java/org/apache/jasper/compiler/Node.java'),(2061,43775,'Bug 43775 – The tomcat6.exe in source download in tar.gz is broken (ok in zip)','Hi,\n\nI observed that following files in the source download apache-tomcat-6.0.14-\nsrc.tar.gz \n\n   apache-tomcat-6.0.14-src/res/procrun/tomcat6.exe\n   apache-tomcat-6.0.14-src/res/procrun/tomcat6w.exe\n\ndo not work.  However, the same files in apache-tomcat-6.0.14-src.zip do work \nproperly.\n\nOn Linux I expended the zip file in apache-tomcat-6.0.14-src-zip and tar.gz in \napache-tomcat-6.0.14-src then diffed the content:\n\nbash-3.1$ diff -bBr --brief apache-tomcat-6.0.14-src apache-tomcat-6.0.14-src-\nzip\nFiles apache-tomcat-6.0.14-src/native/connector/os/win32/logmessages.bin and \napache-tomcat-6.0.14-src-zip/native/connector/os/win32/logmessages.bin differ\nFiles apache-tomcat-6.0.14-src/res/procrun/amd64/tomcat6.exe and apache-tomcat-\n6.0.14-src-zip/res/procrun/amd64/tomcat6.exe differ\nFiles apache-tomcat-6.0.14-src/res/procrun/amd64/tomcat6w.exe and apache-\ntomcat-6.0.14-src-zip/res/procrun/amd64/tomcat6w.exe differ\nFiles apache-tomcat-6.0.14-src/res/procrun/ia64/tomcat6.exe and apache-tomcat-\n6.0.14-src-zip/res/procrun/ia64/tomcat6.exe differ\nFiles apache-tomcat-6.0.14-src/res/procrun/ia64/tomcat6w.exe and apache-tomcat-\n6.0.14-src-zip/res/procrun/ia64/tomcat6w.exe differ\nFiles apache-tomcat-6.0.14-src/res/procrun/tomcat6.exe and apache-tomcat-\n6.0.14-src-zip/res/procrun/tomcat6.exe differ\nFiles apache-tomcat-6.0.14-src/res/procrun/tomcat6w.exe and apache-tomcat-\n6.0.14-src-zip/res/procrun/tomcat6w.exe differ\nFiles apache-tomcat-6.0.14-\nsrc/webapps/docs/architecture/requestProcess/requestProcess.pdf and apache-\ntomcat-6.0.14-src-\nzip/webapps/docs/architecture/requestProcess/requestProcess.pdf differ\nFiles apache-tomcat-6.0.14-\nsrc/webapps/docs/architecture/startup/serverStartup.pdf and apache-tomcat-\n6.0.14-src-zip/webapps/docs/architecture/startup/serverStartup.pdf differ\nFiles apache-tomcat-6.0.14-src/webapps/docs/tribes/leader-election-initiate-\nelection.dia and apache-tomcat-6.0.14-src-zip/webapps/docs/tribes/leader-\nelection-initiate-election.dia differ\nFiles apache-tomcat-6.0.14-src/webapps/docs/tribes/leader-election-message-\narrives.dia and apache-tomcat-6.0.14-src-zip/webapps/docs/tribes/leader-\nelection-message-arrives.dia differ\n\nYou will also observe that the 2 pdf in the tar.gz will not open without an \nerror whereas the same files in the zip will open properly.\n\nI wonder if the problem starts in the dist.xml Ant script <target \nname=\"package-src-tgz\">\n\n<fixcrlf srcdir=\"${tomcat.dist}/src\" \nexcludes=\"**/*.jar,**/*.gif,**/*.bmp,**/*.jpg,**/*.ico,**/*.war\" eol=\"lf\"/>\n\nThe exclude list should probably exclude also: pdf and exe (also .dia \nand .bin?)\n\nWhat do you think?\n\nKind Regards,\nFred','2007-11-01 12:58:29','Fred K','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','5c8c055','Mark Emlyn David Thomas','2008-01-01 13:11:06','Fix bug 43775. Don\'t change line endings for binary files.','dist.xml'),(2062,43800,'Bug 43800 – Severe error with native dll and SSL','I have configuration where where Tomcat loads the SSL connector correctly when\nthe native library is not installed, but has an error when the native library is\nadded to the classpath.\n\nConfiguration is a fresh install with this added to server.xml:\n	<Connector port=\"8443\" protocol=\"HTTP/1.1\" SSLEnabled=\"true\"\n               maxThreads=\"10\" scheme=\"https\" secure=\"true\"\n               clientAuth=\"true\" sslProtocol=\"TLS\"\n               keystoreFile=\"C:\\SmartHealth\\SmartdevelopmentSSLStore\"\n               keystorePass=\"W0Lv3r1n3\"\n               truststoreFile=\"C:\\SmartHealth\\truststore\"\n               truststorePass=\"changeit\"/>\n\nError is:\n\n7/11/2007 10:07:07 org.apache.catalina.core.AprLifecycleListener init\nINFO: Loaded Apache Tomcat Native library 1.1.10.\n7/11/2007 10:07:07 org.apache.catalina.core.AprLifecycleListener init\nINFO: APR capabilities: IPv6 [false], sendfile [true], accept filters [false],\nrandom [true].\n7/11/2007 10:07:08 org.apache.coyote.http11.Http11AprProtocol init\nINFO: Initializing Coyote HTTP/1.1 on http-8080\n7/11/2007 10:07:08 org.apache.coyote.http11.Http11AprProtocol init\nSEVERE: Error initializing endpoint\njava.lang.Exception: No Certificate file specified\n	at org.apache.tomcat.jni.SSLContext.setCertificate(Native Method)\n	at org.apache.tomcat.util.net.AprEndpoint.init(AprEndpoint.java:684)\n	at org.apache.coyote.http11.Http11AprProtocol.init(Http11AprProtocol.java:121)\n	at org.apache.catalina.connector.Connector.initialize(Connector.java:1059)\n	at org.apache.catalina.core.StandardService.initialize(StandardService.java:677)\n	at org.apache.catalina.core.StandardServer.initialize(StandardServer.java:792)\n	at org.apache.catalina.startup.Catalina.load(Catalina.java:518)\n	at org.apache.catalina.startup.Catalina.load(Catalina.java:538)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n	at\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n	at java.lang.reflect.Method.invoke(Method.java:585)\n	at org.apache.catalina.startup.Bootstrap.load(Bootstrap.java:260)\n	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:412)\n7/11/2007 10:07:08 org.apache.catalina.startup.Catalina load\nSEVERE: Catalina.start\nLifecycleException:  Protocol handler initialization failed:\njava.lang.Exception: No Certificate file specified\n	at org.apache.catalina.connector.Connector.initialize(Connector.java:1061)\n	at org.apache.catalina.core.StandardService.initialize(StandardService.java:677)\n	at org.apache.catalina.core.StandardServer.initialize(StandardServer.java:792)\n	at org.apache.catalina.startup.Catalina.load(Catalina.java:518)\n	at org.apache.catalina.startup.Catalina.load(Catalina.java:538)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n	at\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n	at java.lang.reflect.Method.invoke(Method.java:585)\n	at org.apache.catalina.startup.Bootstrap.load(Bootstrap.java:260)\n	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:412)\n7/11/2007 10:07:08 org.apache.catalina.startup.Catalina load\nINFO: Initialization processed in 1864 ms\n7/11/2007 10:07:08 org.apache.catalina.core.StandardService start\nINFO: Starting service Catalina\n7/11/2007 10:07:08 org.apache.catalina.core.StandardEngine start\nINFO: Starting Servlet Engine: Apache Tomcat/6.0.14\n7/11/2007 10:07:10 org.apache.coyote.http11.Http11AprProtocol start\nINFO: Starting Coyote HTTP/1.1 on http-8080\n7/11/2007 10:07:10 org.apache.coyote.http11.Http11AprProtocol start\nSEVERE: Error starting endpoint\njava.lang.Exception: Socket bind failed: [730048] Only one usage of each socket\naddress (protocol/network address/port) is normally permitted.  \n	at org.apache.tomcat.util.net.AprEndpoint.init(AprEndpoint.java:612)\n	at org.apache.tomcat.util.net.AprEndpoint.start(AprEndpoint.java:717)\n	at org.apache.coyote.http11.Http11AprProtocol.start(Http11AprProtocol.java:151)\n	at org.apache.catalina.connector.Connector.start(Connector.java:1132)\n	at org.apache.catalina.core.StandardService.start(StandardService.java:531)\n	at org.apache.catalina.core.StandardServer.start(StandardServer.java:710)\n	at org.apache.catalina.startup.Catalina.start(Catalina.java:566)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n	at\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n	at java.lang.reflect.Method.invoke(Method.java:585)\n	at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:288)\n	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:413)\n7/11/2007 10:07:10 org.apache.catalina.startup.Catalina start\nSEVERE: Catalina.start: \nLifecycleException:  service.getName(): \"Catalina\";  Protocol handler start\nfailed: java.lang.Exception: Socket bind failed: [730048] Only one usage of each\nsocket address (protocol/network address/port) is normally permitted.  \n	at org.apache.catalina.connector.Connector.start(Connector.java:1139)\n	at org.apache.catalina.core.StandardService.start(StandardService.java:531)\n	at org.apache.catalina.core.StandardServer.start(StandardServer.java:710)\n	at org.apache.catalina.startup.Catalina.start(Catalina.java:566)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n	at\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n	at java.lang.reflect.Method.invoke(Method.java:585)\n	at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:288)\n	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:413)\n7/11/2007 10:07:10 org.apache.catalina.startup.Catalina start\nINFO: Server startup in 2449 ms','2007-11-06 15:09:16','Larry Singer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Native','Library','P2 normal','a36d340','Mark Emlyn David Thomas','2008-01-01 12:33:12','Fix bug 43800. Make clearer relationship between APR and native in docs, error messages and the installer.','java/org/apache/catalina/core/LocalStrings.properties\nres/tomcat.nsi\nwebapps/docs/apr.xml\nwebapps/docs/project.xml'),(2063,43840,'Bug 43840 – Unexpected behaviour when GenericPrincipal is serialized using the SerializablePrincipal in a cluster.','The method \'getUserPrincipal()\' in the GenericPrincipal class returns itself or\na provided Principal if possible. This is also the return value of the\nrequest.getUserPrincipal() method. This works fine in a non-clustered environment.\n\nHowever the behaviour of this method changes when the GenericPrincipal is\nserialized by the SerializablePrincipal class. In the initial node of a cluster\nthe request.getUserPrincipal() method behaves normally. However after the\nprincipal is serialized to another node it no longer contains the internal\nPrincipal object, so the same method call will now return a different object.\n\nI think a solution could be:\n\n1) If there exists an internal userPrincipal AND it is Serializable then\nserialize it along with the other properties of GenericPrincipal.\n\n2) Recreate it at the other end if it is available in the object stream.\n\nIn this manner users with custom Principal objects that implement\njava.io.Serializable will have predictable results from the\nrequest.getUserPrincipal method across nodes in a cluster.\n\nI\'d appreciate your thoughts on this.\n\nThanks,\nAshley','2007-11-11 20:12:16','ashley','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Cluster','P2 normal','c0e0dba','Mark Emlyn David Thomas','2007-12-30 16:59:31','Implement a fix for bug 43840 along with a rudimentary test case.','java/org/apache/catalina/ha/session/SerializablePrincipal.java\ntest/org/apache/catalina/ha/session/TestPrincipal.java\ntest/org/apache/catalina/ha/session/TestSerializablePrincipal.java'),(2064,43868,'Bug 43868 – MBeanServer invoke issue','Impossible to invoke \"removeRole\" or other MBean methods and \"setAttribute\" by\nMBeanServer cause of the same bug in ManagedBean.java at both lines 545\n(getSetter method) and 604 (getInvoke method):\n        object = this;\nMust be replace by:\n        object = bean;\n\nFortunately getGetter method is correct.','2007-11-15 01:26:51','Fred','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','ccadbbc','Mark Emlyn David Thomas','2007-12-29 17:45:21','Fix bug 43868. MBean methods getInvoke and getSetter were broken.','java/org/apache/tomcat/util/modeler/ManagedBean.java'),(2065,43878,'Bug 43878 – Tag-file classes get loaded for each JSP -> perm gen space problem','','2007-11-16 01:20:37','Christoph Korn','Tomcat Developers Mailing List','RESOLVED WONTFIX','Tomcat 6','Jasper','P2 normal','84bd363','Mark Emlyn David Thomas','2007-12-29 14:28:41','Fix bug 43878. When development mode isn\'t being used, use a single JasperLoader. The main benefit is a reduction in the use of perm gen space when there are many JSPs all using the same few tags since the tags are loaded once rather than once per JSP.','java/org/apache/jasper/JspCompilationContext.java\njava/org/apache/jasper/compiler/JspRuntimeContext.java'),(2066,43285,'Bug 43285 – Missing EL Coercion causes argument type mismatch','I\'ll attach a sample web application reproducing the error. Note that this error\nonly occurs when using Tomcat 6.0.x (i.e. it works with Jetty as it uses Sun\'s\nEL RI). Moreover it doesn\'t matter which JSF implementation you\'re using to\nreproduce the error (I just wanted to mention that as it\'s definitely no bug in\nMyFaces even though the following stack trace shows a FacesException).\n\nThe exception stack trace:\njavax.faces.FacesException: Exception while calling broadcast on component :\n{Component-Path : [Class: javax.faces.component.UIViewRoot,ViewId: /home.jsp][\nClass: javax.faces.component.html.HtmlForm,Id: j_id_jsp_923754602_1][Class:\njavax.faces.component.html.HtmlCommandButton,Id: j_id_jsp_923754602_3]}\n        at javax.faces.component.UIComponentBase.broadcast(UIComponentBase.java:494)\n        at javax.faces.component.UICommand.broadcast(UICommand.java:105)\n        at javax.faces.component.UIViewRoot._broadcastForPhase(UIViewRoot.java:292)\n        at javax.faces.component.UIViewRoot.process(UIViewRoot.java:209)\n        at javax.faces.component.UIViewRoot.processApplication(UIViewRoot.java:117)\n        at\norg.apache.myfaces.lifecycle.InvokeApplicationExecutor.execute(InvokeApplicationExecutor.java:32)\n        at\norg.apache.myfaces.lifecycle.LifecycleImpl.executePhase(LifecycleImpl.java:95)\n        at org.apache.myfaces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:70)\n        at javax.faces.webapp.FacesServlet.service(FacesServlet.java:144)\n        at\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n        at\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at\norg.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)\n        at\norg.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)\n        at\norg.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:128)\n        at\norg.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)\n        at\norg.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n        at\norg.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:263)\n        at\norg.apache.coyote.http11.Http11Processor.process(Http11Processor.java:844)\n        at\norg.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:584)\n        at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:447)\n        at java.lang.Thread.run(Thread.java:619)\nCaused by: org.apache.jasper.el.JspELException: /home.jsp(12,3)\n\'#{numberBean.number}\' java.lang.IllegalArgumentException: argument type mismatch\n        at\norg.apache.jasper.el.JspValueExpression.setValue(JspValueExpression.java:94)\n        at\norg.apache.myfaces.event.SetPropertyActionListener.processAction(SetPropertyActionListener.java:72)\n        at javax.faces.event.ActionEvent.processListener(ActionEvent.java:48)\n        at javax.faces.component.UIComponentBase.broadcast(UIComponentBase.java:489)\n        ... 20 more\nCaused by: java.lang.IllegalArgumentException: argument type mismatch\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n        at\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at javax.el.BeanELResolver.setValue(BeanELResolver.java:108)\n        at javax.el.CompositeELResolver.setValue(CompositeELResolver.java:68)\n        at\norg.apache.myfaces.el.unified.resolver.FacesCompositeELResolver.access$501(FacesCompositeELResolver.java:46)\n        at\norg.apache.myfaces.el.unified.resolver.FacesCompositeELResolver$6.invoke(FacesCompositeELResolver.java:132)\n        at\norg.apache.myfaces.el.unified.resolver.FacesCompositeELResolver.invoke(FacesCompositeELResolver.java:148)\n        at\norg.apache.myfaces.el.unified.resolver.FacesCompositeELResolver.setValue(FacesCompositeELResolver.java:128)\n        at org.apache.el.parser.AstValue.setValue(AstValue.java:114)\n        at org.apache.el.ValueExpressionImpl.setValue(ValueExpressionImpl.java:249)\n        at\norg.apache.jasper.el.JspValueExpression.setValue(JspValueExpression.java:85)\n        ... 23 more','2007-09-02 13:14:26','Bernhard Huemer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Servlet & JSP API','P2 enhancement','c5bcc98','Timothy A. Funk','2007-12-26 21:10:38','http://issues.apache.org/bugzilla/show_bug.cgi?id=43285 Missing EL Coercion causes argument type mismatch','java/org/apache/el/parser/AstValue.java'),(2067,42503,'Bug 42503 – ServletContext.getResourceAsStream returns stale data','Under certain conditions, the resource cache implementation used by the\nservlet/JSP engine (in org.apache.naming.resource) does not detect that a file\nin its cache has been modified and therefore returns the previous contents of\nthe file.\n\nThis happens only \n * when the file contents are modified but the file length doesn\'t change\n * until the time the first change in the file is detected after server startup\n   \nTo reproduce the problem, put the attached test.jsp and test.txt into the ROOT\nweb app and then do the following. (I used Tomcat 6\'s trunk for the test)\n\n% cat test.txt\nabcd\n% telnet . 9080 \nTrying 0.0.0.0...\nConnected to ..\nEscape character is \'^]\'.\nGET /test.jsp HTTP/1.0\n\nHTTP/1.1 200 OK\nServer: Apache-Coyote/1.1\nSet-Cookie: JSESSIONID=706D6FE8B06687509D42E79DBEE266EF; Path=/\nContent-Type: text/html\nContent-Length: 26\nDate: Wed, 23 May 2007 23:03:05 GMT\nConnection: close\n\n\n\nFile contents=[\nabcd\n\n]\nConnection to . closed by foreign host.\n\n% cat test.txt (change the contents but not the size)\nefgh\n % telnet . 9080 \nTrying 0.0.0.0...\nConnected to ..\nEscape character is \'^]\'.\nGET /test.jsp HTTP/1.0\n\nHTTP/1.1 200 OK\nServer: Apache-Coyote/1.1\nSet-Cookie: JSESSIONID=2B144247B747F54184114FA82869DE14; Path=/\nContent-Type: text/html\nContent-Length: 26\nDate: Wed, 23 May 2007 23:04:24 GMT\nConnection: close\n\n\n\nFile contents=[\nabcd\n\n]','2007-05-23 16:52:35','Arvind Srinivasan','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P3 normal','2441155','Timothy A. Funk','2007-12-26 20:57:02','http://issues.apache.org/bugzilla/show_bug.cgi?id=42503 ServletContext.getResourceAsStream returns stale data','java/org/apache/naming/resources/FileDirContext.java'),(2068,43914,'Bug 43914 – HTTP spec violation when generating HTTP redirects for folders without trailing slash','','2007-11-20 05:53:53','Ivan Todoroski','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Connector:Coyote','P2 normal','e452200','Mark Emlyn David Thomas','2007-12-26 16:23:17','Fix bug 43914. Location headers must be encoded. Patch provided by Ivan Todoroski.','java/org/apache/catalina/connector/CoyoteAdapter.java'),(2069,43839,'Bug 43839 – I think the implement is difference with the document in function CoyoteAdapter.postParseRequest','','2007-11-11 19:35:39','Yuan Qingyun','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 major','5be0421','Mark Emlyn David Thomas','2007-12-26 15:54:44','Fix for bug 43839. When cookie based session tracking has been disabled, URL based session tracking would fail due to the presence of a session cookie from a parent context. Based on a patch by Yuan Qingyun.','java/org/apache/catalina/connector/CoyoteAdapter.java'),(2070,43909,'Bug 43909 – EL EvaluationContext wrapper hides locale','org.apache.el.lang.EvaluationContext doesn\'t pass locale to the wrapped\nELContext as does org.apache.jasper.el.ELContextWrapper. This prohibits using of\nthe locale for it\'s original purpose.','2007-11-19 23:06:25','Tuomas Kiviaho','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','fdb170e','Mark Emlyn David Thomas','2007-12-24 14:24:59','Fix bug 43909. Make sure locale maps to wrapped ELContext. Patch provided by Tuomas Kiviaho.','java/org/apache/el/lang/EvaluationContext.java'),(2071,43944,'Bug 43944 – org.apache.el.lang.ELArithmetic.coerce throws MissingResourceException for key el.convert','The class org.apache.el.lang.ELArithmetic\nhas the following code snippet:\n\nthrow new IllegalArgumentException(MessageFactory.get(\"el.convert\", obj, \nobjType));\n\nBut the key \"el.convert\" doesn\'t exist in \"org.apache.el.Messages\". As a \nresult, I\'m receiving the exception:\njava.util.MissingResourceException: Can\'t find resource for bundle \njava.util.PropertyResourceBundle, key el.convert\n	at java.util.ResourceBundle.getObject(ResourceBundle.java:325)\n	at java.util.ResourceBundle.getString(ResourceBundle.java:285)\n	at org.apache.el.util.MessageFactory.getArray(MessageFactory.java:67)\n	at org.apache.el.util.MessageFactory.get(MessageFactory.java:47)\n	at org.apache.el.lang.ELArithmetic.coerce(ELArithmetic.java:367)\n	at org.apache.el.lang.ELArithmetic.add(ELArithmetic.java:238)\n	at org.apache.el.parser.AstPlus.getValue(AstPlus.java:24)\n	at org.apache.el.ValueExpressionImpl.getValue\n(ValueExpressionImpl.java:186)','2007-11-22 19:23:45','Thai Ha','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Servlet & JSP API','P2 normal','c228054','Mark Emlyn David Thomas','2007-12-24 10:51:53','Fix bug 43944. Use a message that exists.','java/org/apache/el/lang/ELArithmetic.java'),(2072,44088,'Bug 44088 – Cannot expire session via html manager webapp','The html manager webapp done not work correctly when clicking the expire\nsessions button. The idle param is missing from the form.\n\nThe following html shows this bug...\n\n<form method=\"POST\" action=\"/manager/html/expire?path=/\">\n  <small>\n  &nbsp;<input type=\"submit\" value=\"Expire sessions\">&nbsp;with idle\n&ge;&nbsp;<input type=\"text\" name=\"expire\" size=\"5\" value=\"30\">&nbsp;minutes&nbsp;\n  </small>\n  </form>\n\nThe name of the text input should be idle.','2007-12-17 15:14:23','Ben Short','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Manager application','P2 normal','df2b1e6','Mark Emlyn David Thomas','2007-12-23 18:07:48','Fix bug 44088. Expire button didn\'t work. Patch by Ben Short.','java/org/apache/catalina/manager/HTMLManagerServlet.java'),(2073,44084,'Bug 44084 – JAASRealm useContextClassLoader has problems','The useContextClassLoader config option doesn\'t work right. \n\n- it is ignored when setting userClassNames and roleClassNames \n- it\'s respected when the LoginContext is created, but that is insufficient,\nbecause all the needed classes are not necessarily loaded until\nloginContext.login() is called\n\nPatch to follow. With it I\'m able to keep everything related to the JAASRealm in\nmy webapp.','2007-12-15 14:27:25','Noah Levitt','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','46721e4','Mark Emlyn David Thomas','2007-12-23 16:55:38','Fix 44084 with a patch provided by Noah Levitt. I also made a few additional fixes to line lengths etc.','java/org/apache/catalina/realm/JAASRealm.java'),(2074,43236,'Bug 43236 – Response.setCharacterEncoding() fails after Response.getWriter() and Response.reset()','The class org.apache.catalina.connector.Response\n\nresets the internal hold coyoteResponse and outputBuffer during reset():\n\n    public void reset() {\n        if (included)\n            return;     // Ignore any call from an included servlet\n        coyoteResponse.reset();\n        outputBuffer.reset();\n    }\n\nbut if anyone has already set the characterEncoding (e.g. to UTF-8) and already\ngot the writer, than all following invocations of request.setCharacterEncoding()\nwill do nothing, because the internal save flag for usingWriter is not reseted.\nThis is very annoying, because the coyoteResponse.reset(), resets the\ncharacterEncoding to iso8859-1. So I have no change to change/reset the\ncharaterEncoding to UTF-8.\nI\'ll think if you reset the response, you should also reset the usingWriter flag\nor add another special flag, that works with this circumstances.','2007-08-29 03:56:43','Olaf Meske','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 major','71bd193','Mark Emlyn David Thomas','2007-12-18 18:46:19','Fix bug 43236. Reset the usingWriter and associated flags when the response is reset.','java/org/apache/catalina/connector/Response.java'),(2075,43241,'Bug 43241 – ServletContext.getResourceAsStream()  does not follow API specs for Path','','2007-08-29 12:54:18','George Sexton','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Servlet & JSP API','P2 normal','8f91433','Mark Emlyn David Thomas','2007-12-18 18:08:51','Fix bug 43241. Patch provided by John Kew.','java/org/apache/catalina/core/ApplicationContext.java'),(2076,44041,'Bug 44041 – WebappClassLoader duplicate class definition under high Load if hasExternalRepositories is true','','2007-12-07 13:55:58','Philippe Mouawad','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 critical','e74295f','Mark Emlyn David Thomas','2007-12-10 17:24:40','Fix bug 44041. A small sync is required to prevent attempts to load the same class twice.','java/org/apache/catalina/loader/WebappClassLoader.java'),(2077,43993,'Bug 43993 – mime mapping for WS-Policy','','2007-11-29 04:28:05','Fabian Ritzmann','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','7230179','Timothy A. Funk','2007-12-04 21:14:27','43993 - mime mapping for WS-Policy Patch by Fabian Ritzmann','conf/web.xml'),(2078,43530,'Bug 43530 – Bad links on Apache Tomcat 6.0 Documentation Index','','2007-10-01 20:25:41','John','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Documentation','P2 trivial','077aac7','Timothy A. Funk','2007-12-01 20:11:50','BZ  43530','build.xml\nwebapps/docs/funcspecs/project.xml\nwebapps/docs/index.xml'),(2079,43594,'Bug 43594 – setenv.sh/setenv.bat  seems a better candidate for CATALINA_BASE','In my opinion, setenv.sh/setenv.bat  seems a better candidate for CATALINA_BASE.\nAnd I\'m canvassing for opinions that agree or disagree.\n\nIn terms of rationale, I think those that understand the concept of having a\nseparate CATALINA_BASE/CATALINA_HOME will see the obvious rationale there.\nsetenv.sh/setenv.bat is the container of settings for a Tomcat instance, so you\nshould be able to have different settings for different Tomcat instances\ndeployed against one installed version of Tomcat.\n\nI will attach a patch that implements this.','2007-10-10 16:44:26','Shaddy Baddah','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P5 normal','709bb3e','Mark Emlyn David Thomas','2007-12-01 14:48:16','Fix bug 43594. Use setenv from CATALINA_BASE (if set) in preference to the one in CATALINA_HOME. Patch provided by Shaddy Baddah.','RUNNING.txt\nbin/catalina.bat\nbin/catalina.sh'),(2080,43611,'Bug 43611 – autodeployment with unpackWARs=\"true\" does not work, when a context for that war file exists in server.xml','if a context for the war file exists in server.xml, the manager uploads the new\n.war file, but does not expand it, if the necessary directory does not exist,\nand if the directory exists, it is not overwritten, so you see the old application.\n\nsee server.xml\n\n<Host name=\"xxx\" appBase=\"webapps\" unpackWARs=\"true\">\n        <Context path=\"/yyy\">\n...\n\nif I don\'t have a context for yyy in server.xml, autodeploy works as expected.\n\nEven if you say, remove context from the manager application, it is always there\nin the application view, you can\'t remove it.\n\nAnd finally, it never cleans up the work directory for the application yyy,\nwhich I guess, is just a subsequent error of the above behaviour.','2007-10-12 05:15:52','Thomas Fuerle','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Connector:HTTP','P2 major','ffbbe88','Mark Emlyn David Thomas','2007-12-01 13:26:13','Fix bug 43611. Provide an error message if user tries to upload a war for a context defined in server.xml rather than failing silently.','java/org/apache/catalina/manager/HTMLManagerServlet.java\njava/org/apache/catalina/manager/LocalStrings.properties'),(2081,43622,'Bug 43622 – compression / minCompressionSize attribute not properly implemented','2 of the compression related attributes for the http connector are:\n\ncompression = on | off | force | <integer val>\nThe documentation states that integer val will be implemented as:\ncompression=\"on\" and minCompressionSize = <integer val>\n\nminCompressionSize = <integer val>\n(The documentation for 5.5.12 doesnt mention this at all, but read this in the\nserver.xml)\n\nThe problem is that the documenation gives the impression that only setting\ncompression=\"some integer val\" is sufficient, however the way the code is\nwritten, the value of \"minCompressionSize\" always overrides the value specified\nin the \"compression\" field. Even if minCompressionSize isnt set, it will still\nget the default value of 2048 and override whatever value was there in the\n\"compression\" field.\n\nI looked at the implementation of the http11 connector and found the following\ncode that might be the culprit:\n\nIn org.apache.coyote.http11.Http11BaseProtocol.Http11ConnectionHandler.init\n    processor.setCompression( proto.compression );\n    processor.setCompressionMinSize( proto.compressionMinSize);\n\nsince the \"setCompressionMinSize\" is called after compressionMinSize, its value\nwill override the value read from compression atttribute.\n\n\nI have looked at the code for Tomcat 6.0 also, and the problems appears to still\nbe present.','2007-10-15 03:51:24','redeemer','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Connector:HTTP','P3 minor','d1d0619','Mark Emlyn David Thomas','2007-11-30 14:13:33','Fix bug 43622. Don\'t overwrite the min compression size set by the compression attribute with the default.','java/org/apache/coyote/http11/Http11AprProtocol.java\njava/org/apache/coyote/http11/Http11NioProtocol.java\njava/org/apache/coyote/http11/Http11Protocol.java'),(2082,43757,'Bug 43757 – Improper parsing of response.sendRedirect() in JSP source','Tomcat is throwing a java.lang.illegalStateException due to an attempted\nresponse.sendRedirect() after the time for such matters has come and gone...\nBut, this appears to be a symptom of bad .jsp parsing at runtime.\n\n==========================\n\norg.apache.jasper.JasperException: Exception in JSP: /buslog.jsp:42\n\n39: // if (session.getAttribute(\"isAuth\") == null) {\n40: //     session.setAttribute(\"messageToUser\",\"Authentication failed.\");\n41: //        you.shouldNotParseThis();\n42: //     response.sendRedirect(\"./index.jsp\");\n43: // }\n44: \n45: // if (session.getAttribute(\"isAuth\") != null) {\n\n==============================\n\nThese lines are commented out in the source, and should not conceivably cause a\nruntime error. Changing \"response.sendRedirect(...)\" to\n\"response.sendAbendOMG(...)\" suppresses the error. I am willing to provide the\ncomplete source if necessary.\n\nBuild and execution environments are NetBeans 5.5.1 with bundled Tomcat 5.5.17.','2007-10-31 11:55:53','Charles Stahl','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 normal','eb87635','Mark Emlyn David Thomas','2007-11-29 17:27:23','Fix bug 43757. Rather than use string matching to work out the line in the JSP with the error, use the SMAP info and the knowledge that for a scriptlet there is a one to one line mapping.','java/org/apache/jasper/compiler/ErrorDispatcher.java'),(2083,43957,'Bug 43957 – service.bat doesn\'t configure logging like the Windows installer','If Tomcat is unpacked from the zip file and started manually, all the log files\nspecified in logging.properties are created - admin.DATE.log, catalina.DATE.log,\nand so on.\n\nIf Tomcat is installed using the Windows Service Installer, and the service is\nstarted, the log files are also created correctly.\n\nHowever, if Tomcat is unpacked from the zip file and installed as a service\n(using \'service install\'), and the service is started, the log files aren\'t\ncreated. This is due to two JVM options that aren\'t set up -\njava.util.logging.manager and java.util.logging.config.file.\n\nFor consistency, service.bat should set these options, like the Windows\ninstaller does. The attached patch fixes this.','2007-11-25 12:49:59','Richard Fearn','Tomcat Developers Mailing List','CLOSED FIXED','Tomcat 5','Catalina','P3 trivial','51fa863','Mark Emlyn David Thomas','2007-11-27 17:57:28','Fix bug 43957. Service.bat doesn\'t configure logging correctly. Patch provided by  Richard Fearn.','bin/service.bat'),(2084,43706,'Bug 43706 – Fix a litmus warning for WebdavServlet','','2007-10-26 07:03:28','Panagiotis Astithas','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','324387d','Mark Emlyn David Thomas','2007-11-27 17:05:57','Fix bug 43706. Copy/move should return 201 if successful. Based on a patch by Panagiotis Astithas.','java/org/apache/catalina/servlets/WebdavServlet.java'),(2085,43887,'Bug 43887 – StandardWrapper.registerJMX() doesn\'t log exceptions correctly','I was getting some rather unhelpful error messages when trying to deploy a\nweb.xml that included illegal servlet names. I tracked them down to this part of\n/org/apache/catalina/core/StandardWrapper.java:\n\n        } catch( Exception ex ) {\n            log.info(\"Error registering servlet with jmx \" + this);\n        }\n\nThis should probably be changed to:\n\n            log.info(\"Error registering servlet with jmx \" + ex);\n\nSame thing for the catch block ten lines below this one.\n\n\nI first noticed this in 5.5.23, but this code is still present in 6.0 trunk.','2007-11-16 15:31:21','Mike Baranczak','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 minor','9314e5b','Mark Emlyn David Thomas','2007-11-23 16:12:32','Fix bug 43887. Include exception in the log message.','java/org/apache/catalina/core/StandardWrapper.java'),(2086,43893,'Bug 43893 – WebdavServlet returns incorrect values for the \"href\" property when it is mapped with / url prefix, instead of /*','','2007-11-18 00:04:05','Ivan Todoroski','Tomcat Developers Mailing List','RESOLVED WONTFIX','Tomcat 6','Catalina','P2 normal','3c61f9b','Mark Emlyn David Thomas','2007-11-23 14:02:38','Update WebDAV javadocs as a result of bug 43893','java/org/apache/catalina/servlets/WebdavServlet.java'),(2087,43702,'Bug 43702 – Class Files Have Unnecessarily Long Names when Using SimpleTags','I have been using Tomcat 5.5.7 (though I have checked this on the\nlatest 5.5 and 6.0 releases too) and had some problems with very\nlong class file names when using the SimpleTag interface for a\ncustom tag in a JSP document (the XML representation).\n\nFrom my reading of the code in Jasper, and my observation of the files\non my disk, if I have a JSP file \"WebContent/mypages/MyPage.jspx\",\nthen a class file named \"work/org/apache/jsp/mypages/MyPage_jspx.class\"\nwill be generated by Jasper.\n\nIf I use the SimpleTag interface for one of my custom tags on that\nJSP, a \"helper\" class (an inner class of the \"MyPage_jspx\" class) is\nalso generated. The naming convention appends \"Helper\" to the \"outer\"\nclass name to create the inner class name resulting in a class file\nnamed \"work/org/apache/jsp/mypages/MyPage_jspx$MyPage_jspxHelper.class\".\n\nAs there is only one \"helper\" class required, it could just be named\n\"Helper\", instead of \"MyPage_jspxHelper\". The \"outer\" class provides\na namespace that is duplicated unnecessarily in the name of the inner\nclass. Another alternative would be to generate this as an independent\nclass instead of an inner class (they could reside in the same source\nfile).\n\nThis may not seem to be a particularly important issue, but it becomes\na real problem if the name of the JSP is very long. We generate JSP\nfiles from other sources that often use very long names (the names\nare chosen by our customers, so we do not have a lot of control over\nhow long they can get). We have recently started to use the SimpleTag\ninterface to try to reduce the size of the Java classes generated by\nJasper (the generated code is more compact, as there is less code needed\nto handle return values, etc.) However, we quickly found that if a\ndeveloper\'s project directory was deeply nested on the file system\n(i.e., the path to the \"work\" directory) and/or the JSPs had long names\n(some names were as long as 96 characters) that the filesystem path\nlength limit on Windows was exceeded and we got \"class not found\"\nerrors from Tomcat at run-time for classes that clearly existed on the\nfilesystem. I have seen these errors before in other circumstances and\nthey are caused when the path length limit is exceeded.\n\nA trivial change to the Jasper code generator to avoid replicating the\nname of the \"outer\" class in the name of the inner \"helper\" class would\ngo a long way to alleviating this problem. I cannot think of any reason\nwhy this would not be a useful improvement to Jasper. It is a one line\nchange to the constructor of the \"org.apache.jasper.compiler.Generator\"\nclass where the FragmentHelperClass object is created (and probably in\nsome other area where references to this helper are generated into the\nservlet code).\n\nOther improvements to the compactness of the generated code could also\nbe made by more extensive use of \"import\" statements, but that would\nprobably not have any effect on the size of the \".class\" file after\ncompilation (or would it?).\n\nFor our part, we have had to stop using the SimpleTag interface for\nour custom tags, and have to start investigating a way of truncating\nlong JSP file names to avoid being caught out by Jasper\'s verbosity\nand the Windows path length limit.\n\nShould I report this issues separately against Tomcat 6?','2007-10-26 03:17:17','D Gardner','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 normal','5142153','Mark Emlyn David Thomas','2007-11-16 15:11:45','Include Fix for bug 43702 in trunk. Inner class files have unnecessarily long names.','java/org/apache/jasper/compiler/Generator.java'),(2088,43846,'Bug 43846 – Race condition with NIO connector parsing chunked response','The problem seems to relate to parsing the body content when the **Transfer-\nEncoding: chunked** header is present.  It appears that the chunk length gets\ncorrupted under load and the client is unable to parse the chunk out of the \nresponse body.\n\nWhen the NIO connector parameter **socket.appWriteBufSize** is set to a value \nlarger than the total response body, the error condition does not occur.\n\nOne might succesfully argue that this is proper performance tuning.  The Tomcat \ndocuments point out that to scale a large number of long held connections, the \nbuffer sizes may need to be less than the response body (the memory footprint \nwould be quite large otherwise).\n\nCould there be a race condition involving the response buffering code?  \n\nI have confirmed this behavior on both JDKs 1.5 and 1.6 on both Windows 2003 \nand Linux.\n\nApache Bench does not appear to fully parse the response so it will not be \nhelpful in reproducing the issue.   The Grinder framework does.  I am including \nthe Grinder scripts so that the issue may be reproduced.','2007-11-12 09:08:54','Guy Molinari','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 regression','de80680','Filip Hanik','2007-11-15 10:29:02','Fix BZ 43846 http://issues.apache.org/bugzilla/show_bug.cgi?id=43846 and port improvements from sandbox','java/org/apache/coyote/http11/Http11NioProcessor.java\njava/org/apache/coyote/http11/Http11NioProtocol.java\njava/org/apache/coyote/http11/InternalNioInputBuffer.java\njava/org/apache/coyote/http11/InternalNioOutputBuffer.java\njava/org/apache/tomcat/util/MutableInteger.java\njava/org/apache/tomcat/util/net/NioBlockingSelector.java\njava/org/apache/tomcat/util/net/NioChannel.java\njava/org/apache/tomcat/util/net/NioEndpoint.java\njava/org/apache/tomcat/util/net/NioSelectorPool.java\njava/org/apache/tomcat/util/net/SecureNioChannel.java'),(2089,43846,'Bug 43846 – Race condition with NIO connector parsing chunked response','The problem seems to relate to parsing the body content when the **Transfer-\nEncoding: chunked** header is present.  It appears that the chunk length gets\ncorrupted under load and the client is unable to parse the chunk out of the \nresponse body.\n\nWhen the NIO connector parameter **socket.appWriteBufSize** is set to a value \nlarger than the total response body, the error condition does not occur.\n\nOne might succesfully argue that this is proper performance tuning.  The Tomcat \ndocuments point out that to scale a large number of long held connections, the \nbuffer sizes may need to be less than the response body (the memory footprint \nwould be quite large otherwise).\n\nCould there be a race condition involving the response buffering code?  \n\nI have confirmed this behavior on both JDKs 1.5 and 1.6 on both Windows 2003 \nand Linux.\n\nApache Bench does not appear to fully parse the response so it will not be \nhelpful in reproducing the issue.   The Grinder framework does.  I am including \nthe Grinder scripts so that the issue may be reproduced.','2007-11-12 09:08:54','Guy Molinari','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 regression','de80680','Filip Hanik','2007-11-15 10:29:02','Fix BZ 43846 http://issues.apache.org/bugzilla/show_bug.cgi?id=43846 and port improvements from sandbox','java/org/apache/coyote/http11/Http11NioProcessor.java\njava/org/apache/coyote/http11/Http11NioProtocol.java\njava/org/apache/coyote/http11/InternalNioInputBuffer.java\njava/org/apache/coyote/http11/InternalNioOutputBuffer.java\njava/org/apache/tomcat/util/MutableInteger.java\njava/org/apache/tomcat/util/net/NioBlockingSelector.java\njava/org/apache/tomcat/util/net/NioChannel.java\njava/org/apache/tomcat/util/net/NioEndpoint.java\njava/org/apache/tomcat/util/net/NioSelectorPool.java\njava/org/apache/tomcat/util/net/SecureNioChannel.java'),(2090,43675,'Bug 43675 – Classloader leak in org.apache.tomcat.util.http.ServerCookie','','2007-10-23 01:32:34','Davide Romanini','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','307bb44','Mark Emlyn David Thomas','2007-11-13 18:13:24','Better patch for BZ 43675 in response to Remy\'s -1 to previous patch','java/org/apache/jasper/xmlparser/ParserUtils.java\njava/org/apache/tomcat/util/http/ServerCookie.java'),(2091,43675,'Bug 43675 – Classloader leak in org.apache.tomcat.util.http.ServerCookie','','2007-10-23 01:32:34','Davide Romanini','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','51aedf0','Mark Emlyn David Thomas','2007-10-30 22:39:35','Propose fix for 43675.','STATUS'),(2092,43702,'Bug 43702 – Class Files Have Unnecessarily Long Names when Using SimpleTags','I have been using Tomcat 5.5.7 (though I have checked this on the\nlatest 5.5 and 6.0 releases too) and had some problems with very\nlong class file names when using the SimpleTag interface for a\ncustom tag in a JSP document (the XML representation).\n\nFrom my reading of the code in Jasper, and my observation of the files\non my disk, if I have a JSP file \"WebContent/mypages/MyPage.jspx\",\nthen a class file named \"work/org/apache/jsp/mypages/MyPage_jspx.class\"\nwill be generated by Jasper.\n\nIf I use the SimpleTag interface for one of my custom tags on that\nJSP, a \"helper\" class (an inner class of the \"MyPage_jspx\" class) is\nalso generated. The naming convention appends \"Helper\" to the \"outer\"\nclass name to create the inner class name resulting in a class file\nnamed \"work/org/apache/jsp/mypages/MyPage_jspx$MyPage_jspxHelper.class\".\n\nAs there is only one \"helper\" class required, it could just be named\n\"Helper\", instead of \"MyPage_jspxHelper\". The \"outer\" class provides\na namespace that is duplicated unnecessarily in the name of the inner\nclass. Another alternative would be to generate this as an independent\nclass instead of an inner class (they could reside in the same source\nfile).\n\nThis may not seem to be a particularly important issue, but it becomes\na real problem if the name of the JSP is very long. We generate JSP\nfiles from other sources that often use very long names (the names\nare chosen by our customers, so we do not have a lot of control over\nhow long they can get). We have recently started to use the SimpleTag\ninterface to try to reduce the size of the Java classes generated by\nJasper (the generated code is more compact, as there is less code needed\nto handle return values, etc.) However, we quickly found that if a\ndeveloper\'s project directory was deeply nested on the file system\n(i.e., the path to the \"work\" directory) and/or the JSPs had long names\n(some names were as long as 96 characters) that the filesystem path\nlength limit on Windows was exceeded and we got \"class not found\"\nerrors from Tomcat at run-time for classes that clearly existed on the\nfilesystem. I have seen these errors before in other circumstances and\nthey are caused when the path length limit is exceeded.\n\nA trivial change to the Jasper code generator to avoid replicating the\nname of the \"outer\" class in the name of the inner \"helper\" class would\ngo a long way to alleviating this problem. I cannot think of any reason\nwhy this would not be a useful improvement to Jasper. It is a one line\nchange to the constructor of the \"org.apache.jasper.compiler.Generator\"\nclass where the FragmentHelperClass object is created (and probably in\nsome other area where references to this helper are generated into the\nservlet code).\n\nOther improvements to the compactness of the generated code could also\nbe made by more extensive use of \"import\" statements, but that would\nprobably not have any effect on the size of the \".class\" file after\ncompilation (or would it?).\n\nFor our part, we have had to stop using the SimpleTag interface for\nour custom tags, and have to start investigating a way of truncating\nlong JSP file names to avoid being caught out by Jasper\'s verbosity\nand the Windows path length limit.\n\nShould I report this issues separately against Tomcat 6?','2007-10-26 03:17:17','D Gardner','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 normal','dfc21d6','Mark Emlyn David Thomas','2007-10-30 22:17:34','Propose fix for 43702.','STATUS'),(2093,37284,'Bug 37284 – guess JDK location on Mac OS X','Under Mac OS X there is defined standard JDK location. JDK 1.5 shipped by Apple is always installed to \n/System/Library/Frameworks/JavaVM.framework/Versions/1.5/Home.\n\nSimple patch checks whether this JDK exists if JAVA_HOME and JRE_HOME are unset.\n\n===\n--- ./catalina.sh.orig  2005-10-28 01:12:12.000000000 +0400\n+++ ./catalina.sh       2005-10-28 01:11:38.000000000 +0400\n@@ -45,9 +45,11 @@\n # OS specific support.  $var _must_ be set to either true or false.\n cygwin=false\n os400=false\n+darwin=false\n case \"`uname`\" in\n CYGWIN*) cygwin=true;;\n OS400*) os400=true;;\n+Darwin*) darwin=true;;\n esac\n \n # resolve links - $0 may be a softlink\n--- ./setclasspath.sh.orig      2005-10-28 01:10:05.000000000 +0400\n+++ ./setclasspath.sh   2005-10-28 01:19:52.000000000 +0400\n@@ -10,9 +10,13 @@\n \n # Make sure prerequisite environment variables are set\n if [ -z \"$JAVA_HOME\" -a -z \"$JRE_HOME\" ]; then\n-  echo \"Neither the JAVA_HOME nor the JRE_HOME environment variable is defined\"\n-  echo \"At least one of these environment variable is needed to run this program\"\n-  exit 1\n+  if $darwin && [ -d \"/System/Library/Frameworks/JavaVM.framework/Versions/1.5/Home\" ]; then\n+    export JAVA_HOME=\"/System/Library/Frameworks/JavaVM.framework/Versions/1.5/Home\"\n+  else\n+    echo \"Neither the JAVA_HOME nor the JRE_HOME environment variable is defined\"\n+    echo \"At least one of these environment variable is needed to run this program\"\n+    exit 1\n+  fi\n fi\n if [ -z \"$JAVA_HOME\" -a \"$1\" = \"debug\" ]; then\n   echo \"JAVA_HOME should point to a JDK in order to run in debug mode.\"\n--- ./startup.sh.orig   2005-10-28 01:10:30.000000000 +0400\n+++ ./startup.sh        2005-10-28 01:11:01.000000000 +0400\n@@ -7,9 +7,11 @@\n \n # Better OS/400 detection: see Bugzilla 31132\n os400=false\n+darwin=false\n case \"`uname`\" in\n CYGWIN*) cygwin=true;;\n OS400*) os400=true;;\n+Darwin*) darwin=true;;\n esac\n \n # resolve links - $0 may be a softlink\n===','2005-10-27 23:30:08','Stepan Koltsov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Native:Packaging','P2 trivial','dd54441','Jean-Frederic Clere','2007-10-22 05:07:39','It also improve the fix for 37284.','STATUS'),(2094,43668,'Bug 43668 – ApplicationDispatcher.doForward for non-HTTP request is always NULL','','2007-10-21 13:16:07','Mailmur','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 critical','4cbea0a','William Barker','2007-10-21 22:38:24','Propose fix to BZ 43668','STATUS'),(2095,43479,'Bug 43479 – APR sendfile thread leaks memory','The APR sendfile thread leaks memory by adding SendfileData objects to its\nHashMap and failing to remove them.','2007-09-25 19:49:30','Chris Elving','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Native','Library','P3 normal','16464d6','Remy Maucherat','2007-10-10 20:29:00','- 43479: Memory leak cleaning up sendfile connections (submitted by the bug reporter). - 42925: No timeout for sendfile (fix TODO item that had been forgotten).','STATUS\njava/org/apache/tomcat/util/net/AprEndpoint.java\nwebapps/docs/changelog.xml'),(2096,42925,'Bug 42925 – Sendfile thread uses 100% cpu for long periods','Tomcat 6.13 using APR, running under jsvc on linux (debian, but tomcat isn\'t\ninstalled via apt-get) 2.6.21 SMP. Sun Java 1.6.0.\n\nAfter tomcat was running for a short while (<15mins), cpu usage on one cpu would\ngo to 100%, as shown by top. Using ps xU tomcat -fL showed that one tomcat\nthread was using far more cpu than all the others. Cross-referencing the thread\nid to a thread dump (from kill -3) showed that it was the sendfile thread that\nwas consuming all the cpu time.\n\nTomcat was still responding to requests while this was going on, but obviously\nthe high cpu load was not necessary or helpful. Watching cpu usage via top\nshowed that at times it would return to normal, but never for long.\n\nWorkaround: I added \'useSendfile=\"false\"\' to the http connector, restarted\ntomcat, and it has now run with normal cpu usage for over 12 hours.','2007-07-18 01:53:44','Chris Lear','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 major','16464d6','Remy Maucherat','2007-10-10 20:29:00','- 43479: Memory leak cleaning up sendfile connections (submitted by the bug reporter). - 42925: No timeout for sendfile (fix TODO item that had been forgotten).','STATUS\njava/org/apache/tomcat/util/net/AprEndpoint.java\nwebapps/docs/changelog.xml'),(2097,42925,'Bug 42925 – Sendfile thread uses 100% cpu for long periods','Tomcat 6.13 using APR, running under jsvc on linux (debian, but tomcat isn\'t\ninstalled via apt-get) 2.6.21 SMP. Sun Java 1.6.0.\n\nAfter tomcat was running for a short while (<15mins), cpu usage on one cpu would\ngo to 100%, as shown by top. Using ps xU tomcat -fL showed that one tomcat\nthread was using far more cpu than all the others. Cross-referencing the thread\nid to a thread dump (from kill -3) showed that it was the sendfile thread that\nwas consuming all the cpu time.\n\nTomcat was still responding to requests while this was going on, but obviously\nthe high cpu load was not necessary or helpful. Watching cpu usage via top\nshowed that at times it would return to normal, but never for long.\n\nWorkaround: I added \'useSendfile=\"false\"\' to the http connector, restarted\ntomcat, and it has now run with normal cpu usage for over 12 hours.','2007-07-18 01:53:44','Chris Lear','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 major','92cb2c0','Remy Maucherat','2007-10-05 17:14:32','- 42925: Another minor patch.','STATUS'),(2098,43453,'Bug 43453 – ClassCastException at org.apache.catalina.core.StandardContext.findStatusPage(int)','StandardContext.java reads\n\n    public String findStatusPage(int status) {\n        return ((String) statusPages.get(new Integer(status)));\n    }\n\nThis is wrong and it should be\n\n    public String findStatusPage(int status) {\n        return ((ErrorPage) statusPages.get(new Integer(status))).getLocation();\n    }\n\nRegards,\n  lg','2007-09-23 13:50:20','Lucas Galfaso','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','73b5e41','Timothy A. Funk','2007-09-23 19:53:05','bug 43453: ClassCastException at  org.apache.catalina.core.StandardContext.findStatusPage(int)','java/org/apache/catalina/core/StandardContext.java\nwebapps/docs/changelog.xml'),(2099,41797,'Bug 41797 – CNFE/NPE thrown from function mapper when externalizing','ClassNotFoundException is thrown from function mapper when it is (re)mapping a\ngiven class/method name pair back to method instance. This may happen due to\nserialization.\n\nPatch is simply to replace used Class.forName with ReflectionUtil.forName \n\njava.lang.ClassNotFoundException: \n	at java.net.URLClassLoader$1.run(URLClassLoader.java:200)\n	at java.security.AccessController.doPrivileged(Native Method)\n	at java.net.URLClassLoader.findClass(URLClassLoader.java:188)\n	at java.lang.ClassLoader.loadClass(ClassLoader.java:306)\n	at java.lang.ClassLoader.loadClass(ClassLoader.java:251)\n	at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:319)\n	at java.lang.Class.forName0(Native Method)\n	at java.lang.Class.forName(Class.java:164)\n	at\norg.apache.el.lang.FunctionMapperImpl$Function.getMethod(FunctionMapperImpl.java:147)\n	at\norg.apache.el.lang.FunctionMapperImpl.resolveFunction(FunctionMapperImpl.java:53)\n	at org.apache.el.parser.AstFunction.getValue(AstFunction.java:71)\n	at org.apache.el.ValueExpressionImpl.getValue(ValueExpressionImpl.java:186)\n	at com.sun.facelets.el.TagValueExpression.getValue(TagValueExpression.java:71)','2007-03-09 01:08:21','Tuomas Kiviaho','Tomcat Developers Mailing List','CLOSED FIXED','Tomcat 6','Jasper','P2 major','4b17634','Timothy A. Funk','2007-09-23 19:33:56','bug 41797: CNFE/NPE thrown from function mapper when externalizing Patch by Tuomas Kiviaho- tuomas.kiviahos at ikis fi (submit part2 of the patch as seem in comment #3)','java/org/apache/el/lang/FunctionMapperImpl.java'),(2100,41797,'Bug 41797 – CNFE/NPE thrown from function mapper when externalizing','ClassNotFoundException is thrown from function mapper when it is (re)mapping a\ngiven class/method name pair back to method instance. This may happen due to\nserialization.\n\nPatch is simply to replace used Class.forName with ReflectionUtil.forName \n\njava.lang.ClassNotFoundException: \n	at java.net.URLClassLoader$1.run(URLClassLoader.java:200)\n	at java.security.AccessController.doPrivileged(Native Method)\n	at java.net.URLClassLoader.findClass(URLClassLoader.java:188)\n	at java.lang.ClassLoader.loadClass(ClassLoader.java:306)\n	at java.lang.ClassLoader.loadClass(ClassLoader.java:251)\n	at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:319)\n	at java.lang.Class.forName0(Native Method)\n	at java.lang.Class.forName(Class.java:164)\n	at\norg.apache.el.lang.FunctionMapperImpl$Function.getMethod(FunctionMapperImpl.java:147)\n	at\norg.apache.el.lang.FunctionMapperImpl.resolveFunction(FunctionMapperImpl.java:53)\n	at org.apache.el.parser.AstFunction.getValue(AstFunction.java:71)\n	at org.apache.el.ValueExpressionImpl.getValue(ValueExpressionImpl.java:186)\n	at com.sun.facelets.el.TagValueExpression.getValue(TagValueExpression.java:71)','2007-03-09 01:08:21','Tuomas Kiviaho','Tomcat Developers Mailing List','CLOSED FIXED','Tomcat 6','Jasper','P2 major','4461a96','Timothy A. Funk','2007-09-22 14:05:54','bug 41797: CNFE/NPE thrown from function mapper when externalizing Patch by Tuomas Kiviaho- tuomas.kiviahos at ikis fi','java/org/apache/el/lang/FunctionMapperImpl.java\nwebapps/docs/changelog.xml'),(2101,43435,'Bug 43435 – AbstractReplicatedMap.memberDisappeared is executed more than the necessity.','','2007-09-20 04:51:07','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Cluster','P2 normal','5aed2f5','Filip Hanik','2007-09-21 14:26:31','bz http://issues.apache.org/bugzilla/show_bug.cgi?id=43435','java/org/apache/catalina/tribes/tipis/AbstractReplicatedMap.java\nwebapps/docs/changelog.xml'),(2102,43356,'Bug 43356 – keystoreFile parameter, when specified as relative, is not treated relative to $CATALINA_BASE or catalina.base property for NioEndPoint','','2007-09-11 11:42:39','Peter Lynch','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Connectors','P2 normal','28da141','Filip Hanik','2007-09-14 17:30:29','Backport from earlier fix http://issues.apache.org/bugzilla/show_bug.cgi?id=43356','java/org/apache/coyote/http11/Http11NioProtocol.java\njava/org/apache/tomcat/util/net/NioEndpoint.java'),(2103,42831,'Bug 42831 – Permissions aren\'t set correctly on $CATALINA_HOME/bin/version.sh','-rw-r--r--   1 root  admin     784 May  4 21:42 version.sh\nshould be -rwxr-xr-x\n\nOS, above, should be \"All Unix,\" but it\'s not an option.\nVersion, above, should be 6.0.13, but it\'s not an option.','2007-07-07 03:56:16','David Livesay','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','4aa093e','Timothy A. Funk','2007-09-13 14:16:23','Bug 42831','dist.xml'),(2104,43057,'Bug 43057 – Typo of \"TDC\" in deployment docs','The documentation for Deployments mentions \"TDC\", but from what I can tell there\nis no such thing.  I suspect it is supposed to be \"TCD\" which make a lot more\nsense for the Deployment docs.','2007-08-07 17:58:00','Brett C.','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 trivial','93136d1','Timothy A. Funk','2007-09-13 13:57:17','BZ 43057 - Trivail doc fix','webapps/docs/deployer-howto.xml'),(2105,39013,'Bug 39013 – Incorrect use of docBase from XML Context file deployment','','2006-03-17 13:07:53','Nic Daniau','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 minor','872420c','Mark Emlyn David Thomas','2007-09-13 07:32:38','Take account of bug 39013. Not sure if it is valid but there is a warning about it in the context docs.','webapps/docs/virtual-hosting-howto.xml'),(2106,33774,'Bug 33774 – JNDIRealm fails when server disconnects after time','Using the JNDIRealm for authentication, if the LDAP server is set to \nautomatically disconnect the client (in this case, tomcat\'s JNDIRealm), tomcat \ndoes not discover this until it attempts another login.  If the connection has \nbeen reset, it results in a failed login attempt for the user.  So the first \ntime somebody logs into the application after some period of time (I think the \ntimeout is pretty short on our LDAP server), the user will get one failed \nlogin attempt before a real one.\n\nI\'ve not seen in the documentation any properties on the JNDIRealm an amount \nof time to hold the connection open before electively disconnecting it.\n\n2005-02-28 07:47:39 JNDIRealm[/iso]:   Searching for myuserid\n2005-02-28 07:47:39 JNDIRealm[/iso]:   base: ou=users,dc=company,dc=com  \nfilter: (&(objectClass=user)(uid=myuserid))\n2005-02-28 07:47:39 JNDIRealm[/iso]: Exception performing authentication\njavax.naming.CommunicationException: Connection reset [Root exception is \njava.net.SocketException: Connection reset]; remaining \nname \'ou=ou=users,dc=company,dc=com\'\n        at com.sun.jndi.ldap.LdapCtx.doSearch(LdapCtx.java:1961)\n        at com.sun.jndi.ldap.LdapCtx.searchAux(LdapCtx.java:1806)\n        at com.sun.jndi.ldap.LdapCtx.c_search(LdapCtx.java:1731)\n        at com.sun.jndi.toolkit.ctx.ComponentDirContext.p_search\n(ComponentDirContext.java:368)\n        at com.sun.jndi.toolkit.ctx.PartialCompositeDirContext.search\n(PartialCompositeDirContext.java:338)\n        at com.sun.jndi.toolkit.ctx.PartialCompositeDirContext.search\n(PartialCompositeDirContext.java:321)\n        at javax.naming.directory.InitialDirContext.search\n(InitialDirContext.java:248)\n        at org.apache.catalina.realm.JNDIRealm.getUserBySearch\n(JNDIRealm.java:1074)\n        at org.apache.catalina.realm.JNDIRealm.getUser(JNDIRealm.java:967)\n        at org.apache.catalina.realm.JNDIRealm.authenticate(JNDIRealm.java:916)\n        at org.apache.catalina.realm.JNDIRealm.authenticate(JNDIRealm.java:809)\n        at org.apache.catalina.authenticator.FormAuthenticator.authenticate\n(FormAuthenticator.java:235)\n        at org.apache.catalina.authenticator.AuthenticatorBase.invoke\n(AuthenticatorBase.java:446)\n        at org.apache.catalina.core.StandardValveContext.invokeNext\n(StandardValveContext.java:102)\n        at org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:520)\n        at org.apache.catalina.core.StandardHostValve.invoke\n(StandardHostValve.java:137)\n        at org.apache.catalina.core.StandardValveContext.invokeNext\n(StandardValveContext.java:104)\n        at org.apache.catalina.valves.ErrorReportValve.invoke\n(ErrorReportValve.java:118)\n        at org.apache.catalina.core.StandardValveContext.invokeNext\n(StandardValveContext.java:102)\n        at org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:520)\n        at org.apache.catalina.core.StandardEngineValve.invoke\n(StandardEngineValve.java:109)\n        at org.apache.catalina.core.StandardValveContext.invokeNext\n(StandardValveContext.java:104)\n        at org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:520)\n        at org.apache.catalina.core.ContainerBase.invoke\n(ContainerBase.java:929)\n        at org.apache.coyote.tomcat5.CoyoteAdapter.service\n(CoyoteAdapter.java:160)\n        at org.apache.jk.server.JkCoyoteHandler.invoke\n(JkCoyoteHandler.java:300)\n        at org.apache.jk.common.HandlerRequest.invoke(HandlerRequest.java:374)\n        at org.apache.jk.common.ChannelSocket.invoke(ChannelSocket.java:743)\n        at org.apache.jk.common.ChannelSocket.processConnection\n(ChannelSocket.java:675)\n        at org.apache.jk.common.SocketConnection.runIt(ChannelSocket.java:866)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:684)\n        at java.lang.Thread.run(Thread.java:595)\nCaused by: java.net.SocketException: Connection reset\n        at java.net.SocketInputStream.read(SocketInputStream.java:168)\n        at java.io.BufferedInputStream.fill(BufferedInputStream.java:218)\n        at java.io.BufferedInputStream.read1(BufferedInputStream.java:256)\n        at java.io.BufferedInputStream.read(BufferedInputStream.java:313)\n        at com.sun.jndi.ldap.Connection.run(Connection.java:780)\n        ... 1 more\n\n2005-02-28 07:47:39 JNDIRealm[/iso]: Closing directory context','2005-02-28 17:25:59','Will Stranathan','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','96558d3','Mark Emlyn David Thomas','2007-09-04 22:14:45','Improve fix for 33774 by adding check for alternative exception to the remaining point where it could be seen.','java/org/apache/catalina/realm/JNDIRealm.java'),(2107,30949,'Bug 30949 – After Failed Include, Request and Response not Unwrapped','In org.apache.catalina.core.ApplicationDispatcher.doInclude(ServletRequest \nrequest, ServletResponse response), after invoke() is called to perform the \ninclude, the request and response objects are normally unwrapped.  However, if \na ServletException or IOException is thrown, the unwrapping does not take place.\n\nThis leads to problems in environments in which cross context includes are \nbeing performed.  For example, \n\n1.  Web App A performs an include to a Servlet in Web App B\n2.  The Servlet in Web App B throws a ServletException\n3.  Web App A catches the ServletException and attempts to forward to an error \njsp.\n\nStep 3 above will fail due to the fact that the request has not been \nunwrapped.  The active request will contain the ServletContext of web app B and \nthe jsp file will not be found.','2004-08-30 23:54:36','Scott Goldstein','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P3 normal','4dd22a5','Mark Emlyn David Thomas','2007-09-04 22:01:02','Port improved fix for bug 30949 to TC6.','java/org/apache/catalina/core/ApplicationDispatcher.java\nwebapps/docs/changelog.xml'),(2108,43175,'Bug 43175 – typo of web-app_2_4.xsd and web-app_2_5.xsd','','2007-08-21 06:50:10','Takayuki Kaneko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 minor','a80a6dd','Mark Emlyn David Thomas','2007-08-29 20:44:55','Fix bug 43175. Typos in servlet XSD files. Patch provided by Takayuki Kaneko.','LICENSE\njava/javax/servlet/resources/web-app_2_4.xsd\njava/javax/servlet/resources/web-app_2_5.xsd\nwebapps/docs/changelog.xml'),(2109,43216,'Bug 43216 – ACTIVITY_CHECK does not work correctly when Tomcat is restarted','','2007-08-26 09:28:12','Takayuki Kaneko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','9c37a01','Peter Rossbach','2007-08-28 09:33:18','Fix bug 43216: Set correct StandardSession#accessCount as StandardSession.ACTIVITY_CHECK is true.','java/org/apache/catalina/session/StandardManager.java\nwebapps/docs/changelog.xml'),(2110,43215,'Bug 43215 – typo of cluster send options.','','2007-08-26 01:18:22','Takayuki Kaneko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Cluster','P2 normal','3d781d2','Peter Rossbach','2007-08-28 09:17:43','Fix big 43215: Thanks Takayuki to report it -:)','webapps/docs/config/cluster-manager.xml\nwebapps/docs/config/cluster.xml'),(2111,42466,'Bug 42466 – globalresources.xml has a wrong link','The GlobalNamingResources Component document has a wrong link to JNDI Resource\nHOW-TO document.','2007-05-21 03:40:26','Takayoshi Kimura','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 trivial','b0c9a39','Timothy A. Funk','2007-08-21 21:42:35','42466 globalresources.xml has a wrong link patch from       Takayoshi Kimura takayoshi at  gmails doooot com','webapps/docs/config/globalresources.xml'),(2112,42466,'Bug 42466 – globalresources.xml has a wrong link','The GlobalNamingResources Component document has a wrong link to JNDI Resource\nHOW-TO document.','2007-05-21 03:40:26','Takayoshi Kimura','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 trivial','be1e80b','Timothy A. Funk','2007-08-21 21:39:17','42466 globalresources.xml has a wrong link patch from   	 Takayoshi Kimura takayoshi at  gmails doooot com','webapps/docs/config/globalresources.xml'),(2113,43155,'Bug 43155 – commons-logging-api.jar in catalina.sh unnecessary ?','In the script ${catalina.home}/bin/catalina.sh line 135 the classpath is set \nto:\nCLASSPATH=\"$CLASSPATH\":\"$CATALINA_HOME\"/bin/bootstrap.jar:\"$CATALINA_HOME\"/bin/\ncommons-logging-api.jar\n\nReading the logging documention under the Tomcat 6 web site it seems that \nthis ./bin/commons-logging-api.jar in the classpath is not required anymore \nand thus this seems unnecessary.\n\nRgds - Fred','2007-08-17 08:41:45','Fred K','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 trivial','8c03bc9','Timothy A. Funk','2007-08-21 21:26:43','43155 remove commons-logging-api.jar since it ain\'t there','bin/catalina.sh'),(2114,43155,'Bug 43155 – commons-logging-api.jar in catalina.sh unnecessary ?','In the script ${catalina.home}/bin/catalina.sh line 135 the classpath is set \nto:\nCLASSPATH=\"$CLASSPATH\":\"$CATALINA_HOME\"/bin/bootstrap.jar:\"$CATALINA_HOME\"/bin/\ncommons-logging-api.jar\n\nReading the logging documention under the Tomcat 6 web site it seems that \nthis ./bin/commons-logging-api.jar in the classpath is not required anymore \nand thus this seems unnecessary.\n\nRgds - Fred','2007-08-17 08:41:45','Fred K','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 trivial','237f531','Timothy A. Funk','2007-08-21 21:25:09','43155 remove commons-logging-api.jar since it ain\'t there','bin/catalina.sh'),(2115,42569,'Bug 42569 – Small grammar correction on default Tomcat index.html page','I didn\'t see this already in the list of Tomcat 6 bugs. Tomcat version is\n6.0.13, which isn\'t in the list of versions above. File is\n$CATALINA_HOME/webapps/ROOT/index.html. In the line saying, \'If you\'re seeing\nthis page, and you don\'t think you should be, then ___either___ you\'re\n___either___ a user who has arrived at new installation of Tomcat, or you\'re an\nadministrator who hasn\'t got his/her setup quite right.\', there are two\n\"either\"s, and having one or the other removed would make the sentence\ngrammatically correct. Very tiny issue of the lowest priority. Thanks for all\nyour efforts to make such a high quality product! :)','2007-06-02 22:45:43','Daniel Stickney','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P5 trivial','1e9c064','Timothy A. Funk','2007-08-21 21:20:17','42569 Small grammar correction on default Tomcat index.html page','webapps/ROOT/index.html'),(2116,42569,'Bug 42569 – Small grammar correction on default Tomcat index.html page','I didn\'t see this already in the list of Tomcat 6 bugs. Tomcat version is\n6.0.13, which isn\'t in the list of versions above. File is\n$CATALINA_HOME/webapps/ROOT/index.html. In the line saying, \'If you\'re seeing\nthis page, and you don\'t think you should be, then ___either___ you\'re\n___either___ a user who has arrived at new installation of Tomcat, or you\'re an\nadministrator who hasn\'t got his/her setup quite right.\', there are two\n\"either\"s, and having one or the other removed would make the sentence\ngrammatically correct. Very tiny issue of the lowest priority. Thanks for all\nyour efforts to make such a high quality product! :)','2007-06-02 22:45:43','Daniel Stickney','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P5 trivial','e3fdb66','Timothy A. Funk','2007-08-21 21:19:22','42569 Small grammar correction on default Tomcat index.html page','webapps/ROOT/index.html'),(2117,43102,'Bug 43102 – Invalid DTD - mbeans-descriptors.dtd','This causes the following output on startup:\n13/08/2007 14:25:22 org.apache.tomcat.util.digester.Digester fatalError\nSEVERE: Parse Fatal Error at line 17 column 6: The processing instruction \ntarget matching \"[xX][mM][lL]\" is not allowed.\norg.xml.sax.SAXParseException: The processing instruction target matching \"[xX]\n[mM][lL]\" is not allowed.\n\nThe <?xml prologue has to be the first thing in the file, cannot be preceded by \na comment.\n\nThis error was introduced in rev 56210 - this is the only dtd file affected as \nit the only one with the <?xml instruction.','2007-08-12 21:27:46','Ben Hatton','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P5 trivial','3b196f6','Mark Emlyn David Thomas','2007-08-13 21:27:51','Fix bug 43102. Patch by Ben Hatton.','java/org/apache/tomcat/util/modeler/mbeans-descriptors.dtd'),(2118,43053,'Bug 43053 – Session doesn\'t do time-out when BackUpManager is used.','I noticed a problem that the session doesn\'t do time-out when BackUpManager is \nused.\nTo detect the session time-out, ManagerBase.processExpires() of \nbackgroundProcess is executed. \nIn processExpires, the time-out of the session acquired in the \nManagerBase.findSessions() is checked(isValid()). \nAnd, in findSessions(), the list of the session is acquired from session map \n(sessions). \nWhen BackUpManager is used, session map (sessions) becomes the instance of \norg.apache.catalina.tribes.tipis.AbstractReplicatedMap. \n\nOnly the PRIMARY entry is returned in the method such as size(), entrySet() \nand keySet() of AbstractReplicatedMap. \n#PRIMARY entry means entry.isPrimary() returns true.\n#I found sizeFull(), keySetFull() and entrySetFull().\n#These methods return all the entries. \n\nTherefore, the target session by ManagerBase.processExpires() for the session \ntime-out check becomes only \nPRIMARY session. \nThe BACKUP session and the PROXY session become off the subject of the session \ntime-out check. \n\nWhen Tomcat in the cluster does Down, the session(PRIMARY) created by Tomcat \nthat does Down cannot do the time-out in BACKUP and PROXY. \n\nFor instance,\nIt has one session (sessionA) in three cluster configurations \n(tomcat1,tomcat2,tomcat3). \nThe first state of sessionA.\n sessionA is PRIMARY in tomcat1. \n sessionA is BACKUP in tomcat2. \n sessionA is PROXY in tomcat3. \n\nNow, tomcat1 does down (before doing the time-out).\nstate of sessionA is ...\n tomcat1 is down.\n sessionA is BACKUP in tomcat2. \n sessionA is PROXY in tomcat3. \n\nThis means PRIMARY doesn\'t exist. \nOf course if sessionA is accessed again, either tomcat2 or tomcat3 becomes \nPRIMARY. \nHowever, it is not guaranteed that sessionA is accessed again. \n\nThe target of the session time-out when BackUpManager is used is only PRIMARY.\n(see above)\nAs a result, sessionA never do time-out.','2007-08-07 03:32:41','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','248a29b','Filip Hanik','2007-08-09 19:30:41','backport from trunk http://issues.apache.org/bugzilla/show_bug.cgi?id=43053','java/org/apache/catalina/tribes/tipis/AbstractReplicatedMap.java\njava/org/apache/catalina/tribes/tipis/LazyReplicatedMap.java\njava/org/apache/catalina/tribes/tipis/ReplicatedMap.java\ntest/org/apache/catalina/tribes/demos/MapDemo.java'),(2119,43053,'Bug 43053 – Session doesn\'t do time-out when BackUpManager is used.','I noticed a problem that the session doesn\'t do time-out when BackUpManager is \nused.\nTo detect the session time-out, ManagerBase.processExpires() of \nbackgroundProcess is executed. \nIn processExpires, the time-out of the session acquired in the \nManagerBase.findSessions() is checked(isValid()). \nAnd, in findSessions(), the list of the session is acquired from session map \n(sessions). \nWhen BackUpManager is used, session map (sessions) becomes the instance of \norg.apache.catalina.tribes.tipis.AbstractReplicatedMap. \n\nOnly the PRIMARY entry is returned in the method such as size(), entrySet() \nand keySet() of AbstractReplicatedMap. \n#PRIMARY entry means entry.isPrimary() returns true.\n#I found sizeFull(), keySetFull() and entrySetFull().\n#These methods return all the entries. \n\nTherefore, the target session by ManagerBase.processExpires() for the session \ntime-out check becomes only \nPRIMARY session. \nThe BACKUP session and the PROXY session become off the subject of the session \ntime-out check. \n\nWhen Tomcat in the cluster does Down, the session(PRIMARY) created by Tomcat \nthat does Down cannot do the time-out in BACKUP and PROXY. \n\nFor instance,\nIt has one session (sessionA) in three cluster configurations \n(tomcat1,tomcat2,tomcat3). \nThe first state of sessionA.\n sessionA is PRIMARY in tomcat1. \n sessionA is BACKUP in tomcat2. \n sessionA is PROXY in tomcat3. \n\nNow, tomcat1 does down (before doing the time-out).\nstate of sessionA is ...\n tomcat1 is down.\n sessionA is BACKUP in tomcat2. \n sessionA is PROXY in tomcat3. \n\nThis means PRIMARY doesn\'t exist. \nOf course if sessionA is accessed again, either tomcat2 or tomcat3 becomes \nPRIMARY. \nHowever, it is not guaranteed that sessionA is accessed again. \n\nThe target of the session time-out when BackUpManager is used is only PRIMARY.\n(see above)\nAs a result, sessionA never do time-out.','2007-08-07 03:32:41','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','edebe0b','Filip Hanik','2007-08-09 15:54:51','more fixes, same bz http://issues.apache.org/bugzilla/show_bug.cgi?id=43053','java/org/apache/catalina/tribes/tipis/AbstractReplicatedMap.java'),(2120,43053,'Bug 43053 – Session doesn\'t do time-out when BackUpManager is used.','I noticed a problem that the session doesn\'t do time-out when BackUpManager is \nused.\nTo detect the session time-out, ManagerBase.processExpires() of \nbackgroundProcess is executed. \nIn processExpires, the time-out of the session acquired in the \nManagerBase.findSessions() is checked(isValid()). \nAnd, in findSessions(), the list of the session is acquired from session map \n(sessions). \nWhen BackUpManager is used, session map (sessions) becomes the instance of \norg.apache.catalina.tribes.tipis.AbstractReplicatedMap. \n\nOnly the PRIMARY entry is returned in the method such as size(), entrySet() \nand keySet() of AbstractReplicatedMap. \n#PRIMARY entry means entry.isPrimary() returns true.\n#I found sizeFull(), keySetFull() and entrySetFull().\n#These methods return all the entries. \n\nTherefore, the target session by ManagerBase.processExpires() for the session \ntime-out check becomes only \nPRIMARY session. \nThe BACKUP session and the PROXY session become off the subject of the session \ntime-out check. \n\nWhen Tomcat in the cluster does Down, the session(PRIMARY) created by Tomcat \nthat does Down cannot do the time-out in BACKUP and PROXY. \n\nFor instance,\nIt has one session (sessionA) in three cluster configurations \n(tomcat1,tomcat2,tomcat3). \nThe first state of sessionA.\n sessionA is PRIMARY in tomcat1. \n sessionA is BACKUP in tomcat2. \n sessionA is PROXY in tomcat3. \n\nNow, tomcat1 does down (before doing the time-out).\nstate of sessionA is ...\n tomcat1 is down.\n sessionA is BACKUP in tomcat2. \n sessionA is PROXY in tomcat3. \n\nThis means PRIMARY doesn\'t exist. \nOf course if sessionA is accessed again, either tomcat2 or tomcat3 becomes \nPRIMARY. \nHowever, it is not guaranteed that sessionA is accessed again. \n\nThe target of the session time-out when BackUpManager is used is only PRIMARY.\n(see above)\nAs a result, sessionA never do time-out.','2007-08-07 03:32:41','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','7f07947','Filip Hanik','2007-08-09 15:52:08','make the backup node become the primary so that we can still expire sessions http://issues.apache.org/bugzilla/show_bug.cgi?id=43053','java/org/apache/catalina/tribes/tipis/AbstractReplicatedMap.java'),(2121,42530,'Bug 42530 – ManagerBase.backgroundProcess throws NullPointerException.','','2007-05-27 21:26:55','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','b9cbbb5','Filip Hanik','2007-08-07 15:02:25','back port from trunk, bz http://issues.apache.org/bugzilla/show_bug.cgi?id=42530','java/org/apache/catalina/session/ManagerBase.java'),(2122,37326,'Bug 37326 – No error reported when <jsp:include> has non-existent target','','2005-11-01 22:59:43','Steve Kirk','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Servlet & JSP API','P2 normal','54ff82d','Mark Emlyn David Thomas','2007-08-04 14:13:40','Remove code testing for bug 37326 showed was not required.','java/org/apache/jasper/servlet/JspServletWrapper.java'),(2123,37326,'Bug 37326 – No error reported when <jsp:include> has non-existent target','','2005-11-01 22:59:43','Steve Kirk','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Servlet & JSP API','P2 normal','2cce4af','Mark Emlyn David Thomas','2007-08-04 14:13:04','Port fix for 37326. Ensure missing includes resources cause errors rather than being silently ignored.','java/org/apache/jasper/servlet/JspServlet.java\nwebapps/docs/changelog.xml'),(2124,42944,'Bug 42944 – plus sign in url-pattern in servlet-mapping does not work','Hi all,\n\nI had servlet-mappings that contain plus signs (they were created by JspC), e.g.:\n\n    <servlet-mapping>\n      <servlet-name>org.apache.jsp.suchergebnis_005fbu_002bbb_jsp</servlet-name>\n      <url-pattern>/suchergebnis_bu+bb.jsp</url-pattern>\n    </servlet-mapping>\n\nThis mapping does not work (the referred class is present)! When I change the\noriginal file names of the JSPs such that the plus signs are replaced by a minus\nsigns the following mapping results:\n\n    <servlet-mapping>\n      <servlet-name>org.apache.jsp.suchergebnis_005fbu_002dbb_jsp</servlet-name>\n      <url-pattern>/suchergebnis_bu-bb.jsp</url-pattern>\n    </servlet-mapping>\n\nNow the mapping works.\n\nTherefore I assume that there is a bug in handling servlet mappings with plus\nsigns in their url pattern.','2007-07-20 09:32:19','Stefan Wachter','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','44e36ea','Mark Emlyn David Thomas','2007-08-04 12:17:22','Port fix for bug 42944. + should only decoded to space in query strings.','java/org/apache/catalina/util/RequestUtil.java\nwebapps/docs/changelog.xml'),(2125,42979,'Bug 42979 – Fixed JSP and Servlet  for  CVE-2007-1355 are not included in the sample.war','The JSP and Servlet which are part of the sample application are not updated in\nthe war file. The sample.war file still contains the old files. So this security\nhole still exists in the latest tomcat distribution.','2007-07-26 07:24:32','Vijay','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Webapps:Documentation','P2 normal','8b17e7e','Mark Emlyn David Thomas','2007-07-30 19:48:45','Fix bug 42979. Update sample.war to include recent security fixes. Ported from TC5.','webapps/docs/appdev/sample/index.html\nwebapps/docs/appdev/sample/sample.war\nwebapps/docs/changelog.xml'),(2126,39212,'Bug 39212 – a bug in example code DummyCart.java','','2006-04-05 10:20:19','Jessica Hsu','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Webapps:Examples','P2 normal','8aa247e','Mark Emlyn David Thomas','2007-07-30 14:13:30','Port fix for 39212. Possible NPE and redundant code.','webapps/examples/WEB-INF/classes/sessions/DummyCart.java\nwebapps/examples/jsp/sessions/carts.jsp'),(2127,42951,'Bug 42951 – In catalina.sh CATALINA_OPTS is used for both start and stop.','Looks like an old bug in startup scripts, which has been fixed around 5.5.20,\nhas been reintroduced (or hasn\'t been ported) in 6.0.X:\nCATALINA_OPTS variable is used for stopping, while it\'s supposed to be used for\nstarting only:\n------------------\nelif [ \"$1\" = \"stop\" ] ; then\n\n  shift\n  FORCE=0\n  if [ \"$1\" = \"-force\" ]; then\n    shift\n    FORCE=1\n  fi\n\n  \"$_RUNJAVA\" $JAVA_OPTS $CATALINA_OPTS \\\n    -Djava.endorsed.dirs=\"$JAVA_ENDORSED_DIRS\" -classpath \"$CLASSPATH\" \\\n    -Dcatalina.base=\"$CATALINA_BASE\" \\\n    -Dcatalina.home=\"$CATALINA_HOME\" \\\n    -Djava.io.tmpdir=\"$CATALINA_TMPDIR\" \\\n    org.apache.catalina.startup.Bootstrap \"$@\" stop\n------------------\n\nThis makes impossible using JMX agent/jconsole as well as other tools which rely\non socket listening.\n\nI\'m not sure if catalina.bat does the same thing...\n\nI guess the latest 5.5.X version of catalina.sh (and probably .bat) shall be\nmerged into 6.6.X tree...','2007-07-22 10:28:48','Andrey Polozov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','6f210e6','Rainer Jung','2007-07-22 14:31:13','BZ 42951: Port r454193 (BZ 36976) from TC 5.5.x: Don\'t use CATALINA_OPTS when stopping Tomcat.','bin/catalina.bat\nbin/catalina.sh\nwebapps/docs/changelog.xml'),(2128,36976,'Bug 36976 – Tomcat VM does not shutdown with remote jmx enabled','When using tomcat with remote jmx it does not shutdown. Using it with local jmx\nworks perfectly.\n\njmx parameters set in catalina.bat as JAVA_OPTS\n-Dcom.sun.management.jmxremote\n-Dcom.sun.management.jmxremote.ssl=false\n-Dcom.sun.management.jmxremote.authenticate=false\n-Dcom.sun.management.jmxremote.port=5555\n\nCalling shutdown.bat I get the following error:\n\nError: Exception thrown by the agent : java.rmi.server.ExportException : Port\nalready in use: 5555;nested exception is:\n    java.net.BindException: Address already in use: JVM_Bind\n\nTomcat keeps running instead of performing a clean shutdown.\n\nJVM is a 1.5.0_04\nTomcat installation is a default from 5.5.9.zip without configuration changes','2005-10-08 13:01:14','Christian Elsen','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Unknown','P2 normal','6f210e6','Rainer Jung','2007-07-22 14:31:13','BZ 42951: Port r454193 (BZ 36976) from TC 5.5.x: Don\'t use CATALINA_OPTS when stopping Tomcat.','bin/catalina.bat\nbin/catalina.sh\nwebapps/docs/changelog.xml'),(2129,42951,'Bug 42951 – In catalina.sh CATALINA_OPTS is used for both start and stop.','Looks like an old bug in startup scripts, which has been fixed around 5.5.20,\nhas been reintroduced (or hasn\'t been ported) in 6.0.X:\nCATALINA_OPTS variable is used for stopping, while it\'s supposed to be used for\nstarting only:\n------------------\nelif [ \"$1\" = \"stop\" ] ; then\n\n  shift\n  FORCE=0\n  if [ \"$1\" = \"-force\" ]; then\n    shift\n    FORCE=1\n  fi\n\n  \"$_RUNJAVA\" $JAVA_OPTS $CATALINA_OPTS \\\n    -Djava.endorsed.dirs=\"$JAVA_ENDORSED_DIRS\" -classpath \"$CLASSPATH\" \\\n    -Dcatalina.base=\"$CATALINA_BASE\" \\\n    -Dcatalina.home=\"$CATALINA_HOME\" \\\n    -Djava.io.tmpdir=\"$CATALINA_TMPDIR\" \\\n    org.apache.catalina.startup.Bootstrap \"$@\" stop\n------------------\n\nThis makes impossible using JMX agent/jconsole as well as other tools which rely\non socket listening.\n\nI\'m not sure if catalina.bat does the same thing...\n\nI guess the latest 5.5.X version of catalina.sh (and probably .bat) shall be\nmerged into 6.6.X tree...','2007-07-22 10:28:48','Andrey Polozov','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','39be2ca','Rainer Jung','2007-07-22 14:29:59','BZ 42951: Port r454193 (BZ 36976) from TC 5.5.x: Don\'t use CATALINA_OPTS when stopping Tomcat.','bin/catalina.bat\nbin/catalina.sh\nwebapps/docs/changelog.xml'),(2130,36976,'Bug 36976 – Tomcat VM does not shutdown with remote jmx enabled','When using tomcat with remote jmx it does not shutdown. Using it with local jmx\nworks perfectly.\n\njmx parameters set in catalina.bat as JAVA_OPTS\n-Dcom.sun.management.jmxremote\n-Dcom.sun.management.jmxremote.ssl=false\n-Dcom.sun.management.jmxremote.authenticate=false\n-Dcom.sun.management.jmxremote.port=5555\n\nCalling shutdown.bat I get the following error:\n\nError: Exception thrown by the agent : java.rmi.server.ExportException : Port\nalready in use: 5555;nested exception is:\n    java.net.BindException: Address already in use: JVM_Bind\n\nTomcat keeps running instead of performing a clean shutdown.\n\nJVM is a 1.5.0_04\nTomcat installation is a default from 5.5.9.zip without configuration changes','2005-10-08 13:01:14','Christian Elsen','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Unknown','P2 normal','39be2ca','Rainer Jung','2007-07-22 14:29:59','BZ 42951: Port r454193 (BZ 36976) from TC 5.5.x: Don\'t use CATALINA_OPTS when stopping Tomcat.','bin/catalina.bat\nbin/catalina.sh\nwebapps/docs/changelog.xml'),(2131,42937,'Bug 42937 – The loop of LazyReplicatedMap.publishEntryInfo doesn\'t end.','The loop of LazyReplicatedMap.publishEntryInfo doesn\'t end.\n\nReproduction condition\n Tomcat6.0.13\n Three cluster configurations or more(tomcat1Atomcat2Atomcat3..).\n Use BackupManager.\n \norg.apache.catalina.tribes.tipis.LazyReplicatedMap.publishEntryInfo has \ndo-while loop.\nThe end condition of this loop is \"success==true\" or \"firstIdx==nextIdx\".\n\nIn the 157th line\n(UniqueId id = getChannel().send(backup, msg, getChannelSendOptions())),\nIf ChannelException is thrown (For instance, Tomcat of the destination is \nstopped), success keeps false.\nTherefore, it tries to send MapMessage to the next backup node. \nHowever, The 157th line is Member next = members[firstIdx].\nBecause firstIdx is immutable, MapMessage is send to The same node last time.\nAs a result, ChannelException is thrown again. \nIn this case, success keeps false forever.\n\nIn addition,\nfirstIdx==nextIdx never consists. \nBecause firstIdx is immutable, and nextIdx is either 0 or firstIdx + 1. \n(Both firstIdx and nextIdx never become 0 \n in three cluster configurations or more(tomcat1Atomcat2Atomcat3..).)\n\nThus, \nWhen ChannelException is thrown once, \nsuccess keeps false and firstIdx==nextIdx never consists.\nAs a result, \nThe do-while loop of LazyReplicatedMap.publishEntryInfo doesn\'t end.\n\nThe following messages are repeatedly output. \n***\nJul 19, 2007 4:23:05 PM org.apache.catalina.tribes.tipis.LazyReplicatedMap \npublishEntryInfo\nSEVERE: Unable to replicate backup \nkey:C46A261B805660196F84A9832F6DFC8B.tomcat1 to \nbackup:org.apache.catalina.tribes.membership.MemberImpl\n[tcp://XXXXXXXX:14001,XXXXXXXX,14001, alive=2735,id={-83 97 -47 -57 117 -79 \n76 -12 -97 -115 19 -40 -88 -34 -12 -92 }, payload={}, command={}, domain=\n{}, ]. Reason:Send failed, attempt:2 max:1; Faulty \nmembers:tcp://XXXXXXXX:14001; \norg.apache.catalina.tribes.ChannelException: Send failed, attempt:2 max:1; \nFaulty members:tcp://XXXXXXXX:14001; \n\n        ...omits\n\n	at org.apache.catalina.tribes.group.GroupChannel.send\n(GroupChannel.java:175)\n	at org.apache.catalina.tribes.tipis.LazyReplicatedMap.publishEntryInfo\n(LazyReplicatedMap.java:157)\n	at org.apache.catalina.tribes.tipis.AbstractReplicatedMap.put\n(AbstractReplicatedMap.java:878)\n	at org.apache.catalina.tribes.tipis.AbstractReplicatedMap.put\n(AbstractReplicatedMap.java:864)\n	at org.apache.catalina.session.ManagerBase.add(ManagerBase.java:740)\n	at org.apache.catalina.session.StandardSession.setId\n(StandardSession.java:368)\n	at org.apache.catalina.ha.session.DeltaSession.setId\n(DeltaSession.java:243)\n	at org.apache.catalina.session.ManagerBase.createSession\n(ManagerBase.java:829)\n	at org.apache.catalina.session.StandardManager.createSession\n(StandardManager.java:291)\n\n	...omits\n\nCaused by: java.net.ConnectException: Connection refused: no further \ninformation\n	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)\n	at sun.nio.ch.SocketChannelImpl.finishConnect\n(SocketChannelImpl.java:527)\n	at org.apache.catalina.tribes.transport.nio.NioSender.process\n(NioSender.java:87)\n	at org.apache.catalina.tribes.transport.nio.ParallelNioSender.doLoop\n(ParallelNioSender.java:130)\n        ... 42 more\n***','2007-07-19 02:35:43','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 major','78d1cf1','Filip Hanik','2007-07-19 10:21:35','BZ 42937, forward port from 6.0','java/org/apache/catalina/tribes/tipis/LazyReplicatedMap.java'),(2132,42937,'Bug 42937 – The loop of LazyReplicatedMap.publishEntryInfo doesn\'t end.','The loop of LazyReplicatedMap.publishEntryInfo doesn\'t end.\n\nReproduction condition\n Tomcat6.0.13\n Three cluster configurations or more(tomcat1Atomcat2Atomcat3..).\n Use BackupManager.\n \norg.apache.catalina.tribes.tipis.LazyReplicatedMap.publishEntryInfo has \ndo-while loop.\nThe end condition of this loop is \"success==true\" or \"firstIdx==nextIdx\".\n\nIn the 157th line\n(UniqueId id = getChannel().send(backup, msg, getChannelSendOptions())),\nIf ChannelException is thrown (For instance, Tomcat of the destination is \nstopped), success keeps false.\nTherefore, it tries to send MapMessage to the next backup node. \nHowever, The 157th line is Member next = members[firstIdx].\nBecause firstIdx is immutable, MapMessage is send to The same node last time.\nAs a result, ChannelException is thrown again. \nIn this case, success keeps false forever.\n\nIn addition,\nfirstIdx==nextIdx never consists. \nBecause firstIdx is immutable, and nextIdx is either 0 or firstIdx + 1. \n(Both firstIdx and nextIdx never become 0 \n in three cluster configurations or more(tomcat1Atomcat2Atomcat3..).)\n\nThus, \nWhen ChannelException is thrown once, \nsuccess keeps false and firstIdx==nextIdx never consists.\nAs a result, \nThe do-while loop of LazyReplicatedMap.publishEntryInfo doesn\'t end.\n\nThe following messages are repeatedly output. \n***\nJul 19, 2007 4:23:05 PM org.apache.catalina.tribes.tipis.LazyReplicatedMap \npublishEntryInfo\nSEVERE: Unable to replicate backup \nkey:C46A261B805660196F84A9832F6DFC8B.tomcat1 to \nbackup:org.apache.catalina.tribes.membership.MemberImpl\n[tcp://XXXXXXXX:14001,XXXXXXXX,14001, alive=2735,id={-83 97 -47 -57 117 -79 \n76 -12 -97 -115 19 -40 -88 -34 -12 -92 }, payload={}, command={}, domain=\n{}, ]. Reason:Send failed, attempt:2 max:1; Faulty \nmembers:tcp://XXXXXXXX:14001; \norg.apache.catalina.tribes.ChannelException: Send failed, attempt:2 max:1; \nFaulty members:tcp://XXXXXXXX:14001; \n\n        ...omits\n\n	at org.apache.catalina.tribes.group.GroupChannel.send\n(GroupChannel.java:175)\n	at org.apache.catalina.tribes.tipis.LazyReplicatedMap.publishEntryInfo\n(LazyReplicatedMap.java:157)\n	at org.apache.catalina.tribes.tipis.AbstractReplicatedMap.put\n(AbstractReplicatedMap.java:878)\n	at org.apache.catalina.tribes.tipis.AbstractReplicatedMap.put\n(AbstractReplicatedMap.java:864)\n	at org.apache.catalina.session.ManagerBase.add(ManagerBase.java:740)\n	at org.apache.catalina.session.StandardSession.setId\n(StandardSession.java:368)\n	at org.apache.catalina.ha.session.DeltaSession.setId\n(DeltaSession.java:243)\n	at org.apache.catalina.session.ManagerBase.createSession\n(ManagerBase.java:829)\n	at org.apache.catalina.session.StandardManager.createSession\n(StandardManager.java:291)\n\n	...omits\n\nCaused by: java.net.ConnectException: Connection refused: no further \ninformation\n	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)\n	at sun.nio.ch.SocketChannelImpl.finishConnect\n(SocketChannelImpl.java:527)\n	at org.apache.catalina.tribes.transport.nio.NioSender.process\n(NioSender.java:87)\n	at org.apache.catalina.tribes.transport.nio.ParallelNioSender.doLoop\n(ParallelNioSender.java:130)\n        ... 42 more\n***','2007-07-19 02:35:43','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 major','2af6488','Filip Hanik','2007-07-19 10:17:18','BZ 42937 use the correct index','java/org/apache/catalina/tribes/tipis/LazyReplicatedMap.java'),(2133,42840,'Bug 42840 – AbstractReplicatedMap.ping(timeout) throws ConcurrentModificationException','I noticed the following codes. \n\norg.apache.catalina.tribes.tipis.AbstractReplicatedMap.ping(long timeout) is \nas follows.\n\n   protected void ping(long timeout) throws ChannelException {\n      \n      .... omits \n      \n       //update our map of members, expire some if we didn\'t receive a ping \nback\n       synchronized (mapMembers) {\n           Iterator it = mapMembers.entrySet().iterator();\n           long now = System.currentTimeMillis();\n           while ( it.hasNext() ) {\n               Map.Entry entry = (Map.Entry)it.next();\n               long access = ((Long)entry.getValue()).longValue(); \n               if ( (now - access) > timeout ) memberDisappeared((Member)\nentry.getKey());\n           }\n       }//synch\n   }\n   \n(now - access) If > timeout is ture, memberDisappeared((Member)entry.getKey()) \nis executed. \nAnd org.apache.catalina.tribes.tipis.AbstractReplicatedMap.memberDisappeared\n(Member member) is as follows.  \n\n   public void memberDisappeared(Member member) {\n       boolean removed = false;\n       synchronized (mapMembers) {\n           removed = (mapMembers.remove(member) != null );\n       }\n       \n       .... omits \n       \n    }\n   \nmember(argument) is removeed from mapMembers(instance of HashMap). \n\nAs a result, when The 258th line Map.Entry entry=(Map.Entry) it.next() is \nexecuted again, \njava.util.ConcurrentModificationException is thrown.','2007-07-09 02:39:05','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','ee0ef53','Filip Hanik','2007-07-09 16:53:48','fix for bz 42840 http://issues.apache.org/bugzilla/show_bug.cgi?id=42840','java/org/apache/catalina/tribes/tipis/AbstractReplicatedMap.java'),(2134,42840,'Bug 42840 – AbstractReplicatedMap.ping(timeout) throws ConcurrentModificationException','I noticed the following codes. \n\norg.apache.catalina.tribes.tipis.AbstractReplicatedMap.ping(long timeout) is \nas follows.\n\n   protected void ping(long timeout) throws ChannelException {\n      \n      .... omits \n      \n       //update our map of members, expire some if we didn\'t receive a ping \nback\n       synchronized (mapMembers) {\n           Iterator it = mapMembers.entrySet().iterator();\n           long now = System.currentTimeMillis();\n           while ( it.hasNext() ) {\n               Map.Entry entry = (Map.Entry)it.next();\n               long access = ((Long)entry.getValue()).longValue(); \n               if ( (now - access) > timeout ) memberDisappeared((Member)\nentry.getKey());\n           }\n       }//synch\n   }\n   \n(now - access) If > timeout is ture, memberDisappeared((Member)entry.getKey()) \nis executed. \nAnd org.apache.catalina.tribes.tipis.AbstractReplicatedMap.memberDisappeared\n(Member member) is as follows.  \n\n   public void memberDisappeared(Member member) {\n       boolean removed = false;\n       synchronized (mapMembers) {\n           removed = (mapMembers.remove(member) != null );\n       }\n       \n       .... omits \n       \n    }\n   \nmember(argument) is removeed from mapMembers(instance of HashMap). \n\nAs a result, when The 258th line Map.Entry entry=(Map.Entry) it.next() is \nexecuted again, \njava.util.ConcurrentModificationException is thrown.','2007-07-09 02:39:05','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','ee0ef53','Filip Hanik','2007-07-09 16:53:48','fix for bz 42840 http://issues.apache.org/bugzilla/show_bug.cgi?id=42840','java/org/apache/catalina/tribes/tipis/AbstractReplicatedMap.java'),(2135,42840,'Bug 42840 – AbstractReplicatedMap.ping(timeout) throws ConcurrentModificationException','I noticed the following codes. \n\norg.apache.catalina.tribes.tipis.AbstractReplicatedMap.ping(long timeout) is \nas follows.\n\n   protected void ping(long timeout) throws ChannelException {\n      \n      .... omits \n      \n       //update our map of members, expire some if we didn\'t receive a ping \nback\n       synchronized (mapMembers) {\n           Iterator it = mapMembers.entrySet().iterator();\n           long now = System.currentTimeMillis();\n           while ( it.hasNext() ) {\n               Map.Entry entry = (Map.Entry)it.next();\n               long access = ((Long)entry.getValue()).longValue(); \n               if ( (now - access) > timeout ) memberDisappeared((Member)\nentry.getKey());\n           }\n       }//synch\n   }\n   \n(now - access) If > timeout is ture, memberDisappeared((Member)entry.getKey()) \nis executed. \nAnd org.apache.catalina.tribes.tipis.AbstractReplicatedMap.memberDisappeared\n(Member member) is as follows.  \n\n   public void memberDisappeared(Member member) {\n       boolean removed = false;\n       synchronized (mapMembers) {\n           removed = (mapMembers.remove(member) != null );\n       }\n       \n       .... omits \n       \n    }\n   \nmember(argument) is removeed from mapMembers(instance of HashMap). \n\nAs a result, when The 258th line Map.Entry entry=(Map.Entry) it.next() is \nexecuted again, \njava.util.ConcurrentModificationException is thrown.','2007-07-09 02:39:05','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','e6c35d9','Filip Hanik','2007-07-09 16:52:52','Fix BZ 42840 http://issues.apache.org/bugzilla/show_bug.cgi?id=42840','java/org/apache/catalina/tribes/tipis/AbstractReplicatedMap.java'),(2136,42840,'Bug 42840 – AbstractReplicatedMap.ping(timeout) throws ConcurrentModificationException','I noticed the following codes. \n\norg.apache.catalina.tribes.tipis.AbstractReplicatedMap.ping(long timeout) is \nas follows.\n\n   protected void ping(long timeout) throws ChannelException {\n      \n      .... omits \n      \n       //update our map of members, expire some if we didn\'t receive a ping \nback\n       synchronized (mapMembers) {\n           Iterator it = mapMembers.entrySet().iterator();\n           long now = System.currentTimeMillis();\n           while ( it.hasNext() ) {\n               Map.Entry entry = (Map.Entry)it.next();\n               long access = ((Long)entry.getValue()).longValue(); \n               if ( (now - access) > timeout ) memberDisappeared((Member)\nentry.getKey());\n           }\n       }//synch\n   }\n   \n(now - access) If > timeout is ture, memberDisappeared((Member)entry.getKey()) \nis executed. \nAnd org.apache.catalina.tribes.tipis.AbstractReplicatedMap.memberDisappeared\n(Member member) is as follows.  \n\n   public void memberDisappeared(Member member) {\n       boolean removed = false;\n       synchronized (mapMembers) {\n           removed = (mapMembers.remove(member) != null );\n       }\n       \n       .... omits \n       \n    }\n   \nmember(argument) is removeed from mapMembers(instance of HashMap). \n\nAs a result, when The 258th line Map.Entry entry=(Map.Entry) it.next() is \nexecuted again, \njava.util.ConcurrentModificationException is thrown.','2007-07-09 02:39:05','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','e6c35d9','Filip Hanik','2007-07-09 16:52:52','Fix BZ 42840 http://issues.apache.org/bugzilla/show_bug.cgi?id=42840','java/org/apache/catalina/tribes/tipis/AbstractReplicatedMap.java'),(2137,39813,'Bug 39813 – JMX proxy servlet newline escaping is incorrect','','2006-06-14 16:26:33','Robin Bramley','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Webapps:Manager','P4 trivial','1de403d','Rainer Jung','2007-07-09 04:45:22','BZ 39813: Correct handling of new line characters in JMX attributes. Patch provided by R Bramley. Ported from tc5.5.x r415029.','java/org/apache/catalina/manager/JMXProxyServlet.java\nwebapps/docs/changelog.xml'),(2138,39813,'Bug 39813 – JMX proxy servlet newline escaping is incorrect','','2006-06-14 16:26:33','Robin Bramley','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Webapps:Manager','P4 trivial','4904623','Rainer Jung','2007-07-09 04:44:50','BZ 39813: Correct handling of new line characters in JMX attributes. Patch provided by R Bramley. Ported from tc5.5.x r415029.','java/org/apache/catalina/manager/JMXProxyServlet.java\njava/org/apache/catalina/users/mbeans-descriptors.xml\nwebapps/docs/changelog.xml'),(2139,42803,'Bug 42803 – AbstractReplicatedMap.size() is not thread safe.','NullPointerException is thrown when the session is created. \nThe following are the error messages. \n\n** localhost.xxxx-xx-xx.log **\njava.lang.NullPointerException\n        at org.apache.catalina.tribes.tipis.AbstractReplicatedMap.size\n(AbstractReplicatedMap.java:989)\n        at org.apache.catalina.session.ManagerBase.add(ManagerBase.java:741)\n        at org.apache.catalina.session.StandardSession.setId\n(StandardSession.java:368)\n        at org.apache.catalina.ha.session.DeltaSession.setId\n(DeltaSession.java:243)\n        at org.apache.catalina.session.ManagerBase.createSession\n(ManagerBase.java:829)\n        at org.apache.catalina.session.StandardManager.createSession\n(StandardManager.java:291)\n        at org.apache.catalina.connector.Request.doGetSession\n(Request.java:2312)\n        at org.apache.catalina.connector.Request.getSession(Request.java:2075)\n        at org.apache.catalina.connector.RequestFacade.getSession\n(RequestFacade.java:833)\n        at org.apache.catalina.connector.RequestFacade.getSession\n(RequestFacade.java:844)\n        .........\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:690)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:803)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter\n(ApplicationFilterChain.java:290)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter\n(ApplicationFilterChain.java:206)\n        at org.apache.catalina.core.StandardWrapperValve.invoke\n(StandardWrapperValve.java:230)\n        at org.apache.catalina.core.StandardContextValve.invoke\n(StandardContextValve.java:175)\n        at org.apache.catalina.core.StandardHostValve.invoke\n(StandardHostValve.java:128)\n        at org.apache.catalina.ha.tcp.ReplicationValve.invoke\n(ReplicationValve.java:347)\n        at org.apache.catalina.valves.ErrorReportValve.invoke\n(ErrorReportValve.java:104)\n        at org.apache.catalina.core.StandardEngineValve.invoke\n(StandardEngineValve.java:109)\n        at org.apache.catalina.connector.CoyoteAdapter.service\n(CoyoteAdapter.java:261)\n        at org.apache.jk.server.JkCoyoteHandler.invoke\n(JkCoyoteHandler.java:190)\n        at org.apache.jk.common.HandlerRequest.invoke(HandlerRequest.java:283)\n        at org.apache.jk.common.ChannelSocket.invoke(ChannelSocket.java:767)\n        at org.apache.jk.common.ChannelSocket.processConnection\n(ChannelSocket.java:697)\n        at org.apache.jk.common.ChannelSocket$SocketConnection.runIt\n(ChannelSocket.java:889)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:686)\n        at java.lang.Thread.run(Thread.java:595)\n\n\n[Environment]\n  use BackupManager in Tomcat6.0.13.\n  <Manager className=\"org.apache.catalina.ha.session.BackupManager\" ... />\n\nI think org.apache.catalina.tribes.tipis.AbstractReplicatedMap.size() is not \nthread safe.\nAfter creating the session. (ManagerBase.java:829))\nTo update maxActive, the size of the session map is gotten.\nAnd org.apache.catalina.tribes.tipis.AbstractReplicatedMap.size() is as \nfollows. \n\n  public int size() {\n      //todo, implement a counter variable instead\n      //only count active members in this node\n      int counter = 0;\n      Iterator it = super.entrySet().iterator();\n      while (it.hasNext() ) {\n          Map.Entry e = (Map.Entry) it.next();\n          if ( e != null ) {\n              MapEntry entry = (MapEntry) super.get(e.getKey());\n              if (entry.isPrimary() && entry.getValue() != null) counter++; \n          }\n      }\n      return counter;\n  }\n\n\nWhile a certain Thread executes AbstractReplicatedMap.size()  \nanother Thread executes AbstractReplicatedMap.remove() by session.invalidate() \nand the session time-out. \n\nWhen the session is removed from the sessions by another thread after Iterator \nis gotten (line:984) \nentry(Session) acquired as follows might become Null. \n  \n  MapEntry entry = (MapEntry) super.get(e.getKey());\n\nTherefore, NullPointerException is thrown in the next line(line:989). \n\nIf Servlet that does only request.getSession() and session.invalidate() is \nexecuted by a high load,\nNullPointerExceprtion is immediately thrown. \n\n    public void doGet(HttpServletRequest request,\n        HttpServletResponse response) throws ServletException, IOException {\n        HttpSession session = request.getSession();\n        session.invalidate();\n    }','2007-07-03 03:05:26','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','b9a9787','Filip Hanik','2007-07-03 09:31:05','BZ 42803','java/org/apache/catalina/tribes/tipis/AbstractReplicatedMap.java'),(2140,42803,'Bug 42803 – AbstractReplicatedMap.size() is not thread safe.','NullPointerException is thrown when the session is created. \nThe following are the error messages. \n\n** localhost.xxxx-xx-xx.log **\njava.lang.NullPointerException\n        at org.apache.catalina.tribes.tipis.AbstractReplicatedMap.size\n(AbstractReplicatedMap.java:989)\n        at org.apache.catalina.session.ManagerBase.add(ManagerBase.java:741)\n        at org.apache.catalina.session.StandardSession.setId\n(StandardSession.java:368)\n        at org.apache.catalina.ha.session.DeltaSession.setId\n(DeltaSession.java:243)\n        at org.apache.catalina.session.ManagerBase.createSession\n(ManagerBase.java:829)\n        at org.apache.catalina.session.StandardManager.createSession\n(StandardManager.java:291)\n        at org.apache.catalina.connector.Request.doGetSession\n(Request.java:2312)\n        at org.apache.catalina.connector.Request.getSession(Request.java:2075)\n        at org.apache.catalina.connector.RequestFacade.getSession\n(RequestFacade.java:833)\n        at org.apache.catalina.connector.RequestFacade.getSession\n(RequestFacade.java:844)\n        .........\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:690)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:803)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter\n(ApplicationFilterChain.java:290)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter\n(ApplicationFilterChain.java:206)\n        at org.apache.catalina.core.StandardWrapperValve.invoke\n(StandardWrapperValve.java:230)\n        at org.apache.catalina.core.StandardContextValve.invoke\n(StandardContextValve.java:175)\n        at org.apache.catalina.core.StandardHostValve.invoke\n(StandardHostValve.java:128)\n        at org.apache.catalina.ha.tcp.ReplicationValve.invoke\n(ReplicationValve.java:347)\n        at org.apache.catalina.valves.ErrorReportValve.invoke\n(ErrorReportValve.java:104)\n        at org.apache.catalina.core.StandardEngineValve.invoke\n(StandardEngineValve.java:109)\n        at org.apache.catalina.connector.CoyoteAdapter.service\n(CoyoteAdapter.java:261)\n        at org.apache.jk.server.JkCoyoteHandler.invoke\n(JkCoyoteHandler.java:190)\n        at org.apache.jk.common.HandlerRequest.invoke(HandlerRequest.java:283)\n        at org.apache.jk.common.ChannelSocket.invoke(ChannelSocket.java:767)\n        at org.apache.jk.common.ChannelSocket.processConnection\n(ChannelSocket.java:697)\n        at org.apache.jk.common.ChannelSocket$SocketConnection.runIt\n(ChannelSocket.java:889)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:686)\n        at java.lang.Thread.run(Thread.java:595)\n\n\n[Environment]\n  use BackupManager in Tomcat6.0.13.\n  <Manager className=\"org.apache.catalina.ha.session.BackupManager\" ... />\n\nI think org.apache.catalina.tribes.tipis.AbstractReplicatedMap.size() is not \nthread safe.\nAfter creating the session. (ManagerBase.java:829))\nTo update maxActive, the size of the session map is gotten.\nAnd org.apache.catalina.tribes.tipis.AbstractReplicatedMap.size() is as \nfollows. \n\n  public int size() {\n      //todo, implement a counter variable instead\n      //only count active members in this node\n      int counter = 0;\n      Iterator it = super.entrySet().iterator();\n      while (it.hasNext() ) {\n          Map.Entry e = (Map.Entry) it.next();\n          if ( e != null ) {\n              MapEntry entry = (MapEntry) super.get(e.getKey());\n              if (entry.isPrimary() && entry.getValue() != null) counter++; \n          }\n      }\n      return counter;\n  }\n\n\nWhile a certain Thread executes AbstractReplicatedMap.size()  \nanother Thread executes AbstractReplicatedMap.remove() by session.invalidate() \nand the session time-out. \n\nWhen the session is removed from the sessions by another thread after Iterator \nis gotten (line:984) \nentry(Session) acquired as follows might become Null. \n  \n  MapEntry entry = (MapEntry) super.get(e.getKey());\n\nTherefore, NullPointerException is thrown in the next line(line:989). \n\nIf Servlet that does only request.getSession() and session.invalidate() is \nexecuted by a high load,\nNullPointerExceprtion is immediately thrown. \n\n    public void doGet(HttpServletRequest request,\n        HttpServletResponse response) throws ServletException, IOException {\n        HttpSession session = request.getSession();\n        session.invalidate();\n    }','2007-07-03 03:05:26','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','6a8c502','Filip Hanik','2007-07-03 09:29:43','Fix BZ 42803','java/org/apache/catalina/tribes/tipis/AbstractReplicatedMap.java'),(2141,42753,'Bug 42753 – Race condition when using available() or reading in CometProcessor.event()','Tomcat version: 6.0.13 (no 6.0.13 available in the version field)\n\nWhen trying to process data in CometProcessor.event() either during the BEGIN\nevent or during the READ event, it is impossible to guarantee that all data has\nbeen read before returning (since new data may arrive between the last statement\nbefore the return, and the return statement itself). However, the\nCoyoteProcessor does this check:\n\n } else if (!error && read && request.getAvailable()) {\n    // If this was a read and not all bytes have been read, or if no data\n    // was read from the connector, then it is an error\n    error = true;\n    log.error(sm.getString(\"coyoteAdapter.read\"));\n } \n\ncausing a severe error and the Comet request to break when this race condition\nmanifests itself.\n\nI am using the following code according to the aio.html description to read data\nin my comet event handler:\n\n  while (request.getInputStream().available() > 0) {\n     // read some data\n  }\n  // ***** NO MORE DATA AVAILABLE\n  return;\n\nAnd I am experiencing the error as described in certain conditions (rapid\narrival of fragmented data):\n\nSEVERE: The servlet did not read all available bytes during the processing of\nthe read event','2007-06-27 05:21:53','Sebastiaan van Erk','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P1 normal','a6ea14d','Filip Hanik','2007-06-29 09:07:27','Bugzilla 42753 Same fix as 6.0 branch','java/org/apache/catalina/core/ApplicationFilterFactory.java'),(2142,41722,'Bug 41722 – role-link tag in web.xml can not  be omitted.','The application with follwing web.xml can not be deployed.\n---\n    <servlet>\n      <servlet-name>sample</servlet-name>\n      <servlet-class>sample.TheServlet</servlet-class>\n      <security-role-ref>\n        <role-name>users</role-name>\n      </security-role-ref>\n    </servlet>\n\n    <servlet-mapping>\n    ....\n    </servlet-mapping>\n\n    <security-role>\n      <role-name>users</role-name>\n     </security-role>\n---\n\"java.lang.IllegalArgumentException: Can\'t convert argument: null\" occurred.\n\nThe Specification says:\n---\nThe security-role-ref element declares the security role reference in a\ncomponent’s or in a deployment component’s code.\nIt consists of an optional description, the security role name\nused in the code(role-name), and an optional link to a security role(role-link).\n---\n<role-link> is optional.','2007-02-28 01:00:41','Suzuki Yuichiro','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Servlet & JSP API','P2 normal','ba25bfb','Mark Emlyn David Thomas','2007-06-24 13:28:45','Port fix for bug 41722. role-link in web.xml should be optional.','java/org/apache/catalina/deploy/SecurityRoleRef.java\njava/org/apache/catalina/startup/WebRuleSet.java\nwebapps/docs/changelog.xml'),(2143,42314,'Bug 42314 – Jasper output no details with compilation error in specific case.','Jasper output no details when Jasper cannot find\nmappings between generated servlet code (with mistakes)\nand former JSP.\nOne example JSP is the following. \n(The imported class in the JSP is not found.)\n---\n<%@\n  page import = \"not.exist.class\"\n%>\n---','2007-05-02 01:13:16','Suzuki Yuichiro','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 normal','6c6ad83','Mark Emlyn David Thomas','2007-06-24 07:45:44','Close streams as noted in bug 42314.','java/org/apache/jasper/compiler/JavacErrorDetail.java'),(2144,42547,'Bug 42547 – Same env-entry (web.xml) and ResourceLink (context) names causes NPE','Having the following in web.xml:\n\n  <env-entry>\n    <env-entry-name>testIt</env-entry-name>\n    <env-entry-type>java.lang.String</env-entry-type>\n    <env-entry-value>test</env-entry-value>\n  </env-entry>\n\nand the following in your context descriptor:\n\n  <ResourceLink name=\"testIt\"\n                global=\"testIt\"\n                type=\"java.lang.String\"/>\n\ncauses an NPE on context load.\n\njava.lang.NullPointerException\n	at\norg.apache.catalina.deploy.NamingResources.addEnvironment(NamingResources.java:188)\n	\nThis assumes you have an entry for \'testIt\' in the <GlobalNamingResources>\nsection of server.xml to link to.\n\nThis worked in 5.5.20. No longer works in 5.5.23.','2007-05-30 11:29:37','John Hutchnson','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P3 normal','53add24','Mark Emlyn David Thomas','2007-06-23 11:00:51','Port fix for bug 42547. Fix NPE when a ResourceLink tries to override an env-entry.','java/org/apache/catalina/deploy/NamingResources.java\nwebapps/docs/changelog.xml'),(2145,42643,'Bug 42643 – Duplicate JSP function mapper variables','When we deploy ~20 or so web apps at a time, we invariably end up with an app or\ntwo on each server that has compilation errors due to code generated like this:\n\nstatic private org.apache.jasper.runtime.ProtectedFunctionMapper _jspx_fnmap_0;\nstatic private org.apache.jasper.runtime.ProtectedFunctionMapper _jspx_fnmap_1;\nstatic private org.apache.jasper.runtime.ProtectedFunctionMapper _jspx_fnmap_2;\nstatic private org.apache.jasper.runtime.ProtectedFunctionMapper _jspx_fnmap_3;\nstatic private org.apache.jasper.runtime.ProtectedFunctionMapper _jspx_fnmap_4;\nstatic private org.apache.jasper.runtime.ProtectedFunctionMapper _jspx_fnmap_5;\nstatic private org.apache.jasper.runtime.ProtectedFunctionMapper _jspx_fnmap_6;\nstatic private org.apache.jasper.runtime.ProtectedFunctionMapper _jspx_fnmap_7;\nstatic private org.apache.jasper.runtime.ProtectedFunctionMapper _jspx_fnmap_0;\nstatic private org.apache.jasper.runtime.ProtectedFunctionMapper _jspx_fnmap_1;\nstatic private org.apache.jasper.runtime.ProtectedFunctionMapper _jspx_fnmap_2;\nstatic private org.apache.jasper.runtime.ProtectedFunctionMapper _jspx_fnmap_3;\nstatic private org.apache.jasper.runtime.ProtectedFunctionMapper _jspx_fnmap_4;\nstatic private org.apache.jasper.runtime.ProtectedFunctionMapper _jspx_fnmap_5;\nstatic private org.apache.jasper.runtime.ProtectedFunctionMapper _jspx_fnmap_6;\nstatic private org.apache.jasper.runtime.ProtectedFunctionMapper _jspx_fnmap_7;\n\nThis looks like it might be as simple as unsynchronized access to the static\n\'currFunc\' in ELFunctionMapper, but I\'m far from an expert on this code and\nunfortunately lack the time to become one. :)\n\nThis only appears to happen when we mass-deploy apps, and we can resolve it by\ndeleting the generated .java file and manually restarting the affected app.','2007-06-12 07:34:16','Cott Lang','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 major','5b65cf4','Mark Emlyn David Thomas','2007-06-16 11:39:21','Port fix bug 42643. Prevent creation of duplicate function mapper variables. Fix various compiler warnings.','java/org/apache/jasper/compiler/ELFunctionMapper.java\nwebapps/docs/changelog.xml'),(2146,42650,'Bug 42650 – PooledParallelSender.sendMessage throws NullpointerException','org.apache.catalina.tribes.transport.PooledSender.getSender() has the \npossibility of returning Null. \nHowever, \norg.apache.catalina.tribes.transport.nio.PooledParallelSender.sendMessage \ndoesn\'t check Null. \n(PooledParallelSender.sendMessage calls getSender())\nTherefore, NullpointerException is thrown. \nFinally, NullpointerException is thrown in the finally block. \n\nThe following are the stack traces. \n\norg.apache.catalina.tribes.ChannelException: java.lang.NullPointerException; \nNo faulty members identified.\n    at org.apache.catalina.tribes.group.GroupChannel.send\n(GroupChannel.java:225)\n    at org.apache.catalina.tribes.group.GroupChannel.send\n(GroupChannel.java:175)\n    at org.apache.catalina.ha.tcp.SimpleTcpCluster.send\n(SimpleTcpCluster.java:835)\n    at org.apache.catalina.ha.tcp.SimpleTcpCluster.sendClusterDomain\n(SimpleTcpCluster.java:814)\n    at org.apache.catalina.ha.tcp.ReplicationValve.send\n(ReplicationValve.java:551)\n    at org.apache.catalina.ha.tcp.ReplicationValve.sendMessage\n(ReplicationValve.java:535)\n    at \norg.apache.catalina.ha.tcp.ReplicationValve.sendSessionReplicationMessage\n(ReplicationValve.java:517)\n    at org.apache.catalina.ha.tcp.ReplicationValve.sendReplicationMessage\n(ReplicationValve.java:428)\n    at org.apache.catalina.ha.tcp.ReplicationValve.invoke\n(ReplicationValve.java:362)\n    at org.apache.catalina.connector.CoyoteAdapter.service\n(CoyoteAdapter.java:261)\n    at org.apache.jk.server.JkCoyoteHandler.invoke(JkCoyoteHandler.java:190)\n    at org.apache.jk.common.HandlerRequest.invoke(HandlerRequest.java:283)\n    at org.apache.jk.common.ChannelSocket.invoke(ChannelSocket.java:767)\n    at org.apache.jk.common.ChannelSocket.processConnection\n(ChannelSocket.java:697)\n    at org.apache.jk.common.ChannelSocket$SocketConnection.runIt\n(ChannelSocket.java:889)\n    at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:686)\n    at java.lang.Thread.run(Thread.java:595)\nCaused by: java.lang.NullPointerException\n    at org.apache.catalina.tribes.transport.PooledSender.returnSender\n(PooledSender.java:48)\n    at \norg.apache.catalina.tribes.transport.nio.PooledParallelSender.sendMessage\n(PooledParallelSender.java:52)\n    at org.apache.catalina.tribes.transport.ReplicationTransmitter.sendMessage\n(ReplicationTransmitter.java:80)\n    at org.apache.catalina.tribes.group.ChannelCoordinator.sendMessage\n(ChannelCoordinator.java:78)\n    at org.apache.catalina.tribes.group.ChannelInterceptorBase.sendMessage\n(ChannelInterceptorBase.java:75)\n    at \norg.apache.catalina.tribes.group.interceptors.TcpFailureDetector.sendMessage\n(TcpFailureDetector.java:87)\n    at org.apache.catalina.tribes.group.ChannelInterceptorBase.sendMessage\n(ChannelInterceptorBase.java:75)\n    at \norg.apache.catalina.tribes.group.interceptors.MessageDispatchInterceptor.sendMe\nssage(MessageDispatchInterceptor.java:73)\n    at org.apache.catalina.tribes.group.ChannelInterceptorBase.sendMessage\n(ChannelInterceptorBase.java:75)\n    at org.apache.catalina.tribes.group.GroupChannel.send\n(GroupChannel.java:216)\n\n\nWhen Sender cannot be acquired, it is necessary to throw ChannelException.\nOtherwise, because the exception can not catch with interceptor such as \norg.apache.catalina.tribes.group.interceptors.TcpFailureDetector, \nthe exception handling cannot be done. \nThe same processing of \norg.apache.catalina.tribes.transport.bio.PooledMultiSender checks Null.','2007-06-13 02:27:35','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','85d386f','Filip Hanik','2007-06-13 13:07:06','fix for BZ 42650 http://issues.apache.org/bugzilla/show_bug.cgi?id=42650','java/org/apache/catalina/tribes/transport/nio/PooledParallelSender.java'),(2147,42650,'Bug 42650 – PooledParallelSender.sendMessage throws NullpointerException','org.apache.catalina.tribes.transport.PooledSender.getSender() has the \npossibility of returning Null. \nHowever, \norg.apache.catalina.tribes.transport.nio.PooledParallelSender.sendMessage \ndoesn\'t check Null. \n(PooledParallelSender.sendMessage calls getSender())\nTherefore, NullpointerException is thrown. \nFinally, NullpointerException is thrown in the finally block. \n\nThe following are the stack traces. \n\norg.apache.catalina.tribes.ChannelException: java.lang.NullPointerException; \nNo faulty members identified.\n    at org.apache.catalina.tribes.group.GroupChannel.send\n(GroupChannel.java:225)\n    at org.apache.catalina.tribes.group.GroupChannel.send\n(GroupChannel.java:175)\n    at org.apache.catalina.ha.tcp.SimpleTcpCluster.send\n(SimpleTcpCluster.java:835)\n    at org.apache.catalina.ha.tcp.SimpleTcpCluster.sendClusterDomain\n(SimpleTcpCluster.java:814)\n    at org.apache.catalina.ha.tcp.ReplicationValve.send\n(ReplicationValve.java:551)\n    at org.apache.catalina.ha.tcp.ReplicationValve.sendMessage\n(ReplicationValve.java:535)\n    at \norg.apache.catalina.ha.tcp.ReplicationValve.sendSessionReplicationMessage\n(ReplicationValve.java:517)\n    at org.apache.catalina.ha.tcp.ReplicationValve.sendReplicationMessage\n(ReplicationValve.java:428)\n    at org.apache.catalina.ha.tcp.ReplicationValve.invoke\n(ReplicationValve.java:362)\n    at org.apache.catalina.connector.CoyoteAdapter.service\n(CoyoteAdapter.java:261)\n    at org.apache.jk.server.JkCoyoteHandler.invoke(JkCoyoteHandler.java:190)\n    at org.apache.jk.common.HandlerRequest.invoke(HandlerRequest.java:283)\n    at org.apache.jk.common.ChannelSocket.invoke(ChannelSocket.java:767)\n    at org.apache.jk.common.ChannelSocket.processConnection\n(ChannelSocket.java:697)\n    at org.apache.jk.common.ChannelSocket$SocketConnection.runIt\n(ChannelSocket.java:889)\n    at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:686)\n    at java.lang.Thread.run(Thread.java:595)\nCaused by: java.lang.NullPointerException\n    at org.apache.catalina.tribes.transport.PooledSender.returnSender\n(PooledSender.java:48)\n    at \norg.apache.catalina.tribes.transport.nio.PooledParallelSender.sendMessage\n(PooledParallelSender.java:52)\n    at org.apache.catalina.tribes.transport.ReplicationTransmitter.sendMessage\n(ReplicationTransmitter.java:80)\n    at org.apache.catalina.tribes.group.ChannelCoordinator.sendMessage\n(ChannelCoordinator.java:78)\n    at org.apache.catalina.tribes.group.ChannelInterceptorBase.sendMessage\n(ChannelInterceptorBase.java:75)\n    at \norg.apache.catalina.tribes.group.interceptors.TcpFailureDetector.sendMessage\n(TcpFailureDetector.java:87)\n    at org.apache.catalina.tribes.group.ChannelInterceptorBase.sendMessage\n(ChannelInterceptorBase.java:75)\n    at \norg.apache.catalina.tribes.group.interceptors.MessageDispatchInterceptor.sendMe\nssage(MessageDispatchInterceptor.java:73)\n    at org.apache.catalina.tribes.group.ChannelInterceptorBase.sendMessage\n(ChannelInterceptorBase.java:75)\n    at org.apache.catalina.tribes.group.GroupChannel.send\n(GroupChannel.java:216)\n\n\nWhen Sender cannot be acquired, it is necessary to throw ChannelException.\nOtherwise, because the exception can not catch with interceptor such as \norg.apache.catalina.tribes.group.interceptors.TcpFailureDetector, \nthe exception handling cannot be done. \nThe same processing of \norg.apache.catalina.tribes.transport.bio.PooledMultiSender checks Null.','2007-06-13 02:27:35','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','85d386f','Filip Hanik','2007-06-13 13:07:06','fix for BZ 42650 http://issues.apache.org/bugzilla/show_bug.cgi?id=42650','java/org/apache/catalina/tribes/transport/nio/PooledParallelSender.java'),(2148,42650,'Bug 42650 – PooledParallelSender.sendMessage throws NullpointerException','org.apache.catalina.tribes.transport.PooledSender.getSender() has the \npossibility of returning Null. \nHowever, \norg.apache.catalina.tribes.transport.nio.PooledParallelSender.sendMessage \ndoesn\'t check Null. \n(PooledParallelSender.sendMessage calls getSender())\nTherefore, NullpointerException is thrown. \nFinally, NullpointerException is thrown in the finally block. \n\nThe following are the stack traces. \n\norg.apache.catalina.tribes.ChannelException: java.lang.NullPointerException; \nNo faulty members identified.\n    at org.apache.catalina.tribes.group.GroupChannel.send\n(GroupChannel.java:225)\n    at org.apache.catalina.tribes.group.GroupChannel.send\n(GroupChannel.java:175)\n    at org.apache.catalina.ha.tcp.SimpleTcpCluster.send\n(SimpleTcpCluster.java:835)\n    at org.apache.catalina.ha.tcp.SimpleTcpCluster.sendClusterDomain\n(SimpleTcpCluster.java:814)\n    at org.apache.catalina.ha.tcp.ReplicationValve.send\n(ReplicationValve.java:551)\n    at org.apache.catalina.ha.tcp.ReplicationValve.sendMessage\n(ReplicationValve.java:535)\n    at \norg.apache.catalina.ha.tcp.ReplicationValve.sendSessionReplicationMessage\n(ReplicationValve.java:517)\n    at org.apache.catalina.ha.tcp.ReplicationValve.sendReplicationMessage\n(ReplicationValve.java:428)\n    at org.apache.catalina.ha.tcp.ReplicationValve.invoke\n(ReplicationValve.java:362)\n    at org.apache.catalina.connector.CoyoteAdapter.service\n(CoyoteAdapter.java:261)\n    at org.apache.jk.server.JkCoyoteHandler.invoke(JkCoyoteHandler.java:190)\n    at org.apache.jk.common.HandlerRequest.invoke(HandlerRequest.java:283)\n    at org.apache.jk.common.ChannelSocket.invoke(ChannelSocket.java:767)\n    at org.apache.jk.common.ChannelSocket.processConnection\n(ChannelSocket.java:697)\n    at org.apache.jk.common.ChannelSocket$SocketConnection.runIt\n(ChannelSocket.java:889)\n    at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:686)\n    at java.lang.Thread.run(Thread.java:595)\nCaused by: java.lang.NullPointerException\n    at org.apache.catalina.tribes.transport.PooledSender.returnSender\n(PooledSender.java:48)\n    at \norg.apache.catalina.tribes.transport.nio.PooledParallelSender.sendMessage\n(PooledParallelSender.java:52)\n    at org.apache.catalina.tribes.transport.ReplicationTransmitter.sendMessage\n(ReplicationTransmitter.java:80)\n    at org.apache.catalina.tribes.group.ChannelCoordinator.sendMessage\n(ChannelCoordinator.java:78)\n    at org.apache.catalina.tribes.group.ChannelInterceptorBase.sendMessage\n(ChannelInterceptorBase.java:75)\n    at \norg.apache.catalina.tribes.group.interceptors.TcpFailureDetector.sendMessage\n(TcpFailureDetector.java:87)\n    at org.apache.catalina.tribes.group.ChannelInterceptorBase.sendMessage\n(ChannelInterceptorBase.java:75)\n    at \norg.apache.catalina.tribes.group.interceptors.MessageDispatchInterceptor.sendMe\nssage(MessageDispatchInterceptor.java:73)\n    at org.apache.catalina.tribes.group.ChannelInterceptorBase.sendMessage\n(ChannelInterceptorBase.java:75)\n    at org.apache.catalina.tribes.group.GroupChannel.send\n(GroupChannel.java:216)\n\n\nWhen Sender cannot be acquired, it is necessary to throw ChannelException.\nOtherwise, because the exception can not catch with interceptor such as \norg.apache.catalina.tribes.group.interceptors.TcpFailureDetector, \nthe exception handling cannot be done. \nThe same processing of \norg.apache.catalina.tribes.transport.bio.PooledMultiSender checks Null.','2007-06-13 02:27:35','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','46bda08','Filip Hanik','2007-06-13 13:05:14','fix for BZ 42650 http://issues.apache.org/bugzilla/show_bug.cgi?id=42650','java/org/apache/catalina/tribes/transport/nio/PooledParallelSender.java'),(2149,42650,'Bug 42650 – PooledParallelSender.sendMessage throws NullpointerException','org.apache.catalina.tribes.transport.PooledSender.getSender() has the \npossibility of returning Null. \nHowever, \norg.apache.catalina.tribes.transport.nio.PooledParallelSender.sendMessage \ndoesn\'t check Null. \n(PooledParallelSender.sendMessage calls getSender())\nTherefore, NullpointerException is thrown. \nFinally, NullpointerException is thrown in the finally block. \n\nThe following are the stack traces. \n\norg.apache.catalina.tribes.ChannelException: java.lang.NullPointerException; \nNo faulty members identified.\n    at org.apache.catalina.tribes.group.GroupChannel.send\n(GroupChannel.java:225)\n    at org.apache.catalina.tribes.group.GroupChannel.send\n(GroupChannel.java:175)\n    at org.apache.catalina.ha.tcp.SimpleTcpCluster.send\n(SimpleTcpCluster.java:835)\n    at org.apache.catalina.ha.tcp.SimpleTcpCluster.sendClusterDomain\n(SimpleTcpCluster.java:814)\n    at org.apache.catalina.ha.tcp.ReplicationValve.send\n(ReplicationValve.java:551)\n    at org.apache.catalina.ha.tcp.ReplicationValve.sendMessage\n(ReplicationValve.java:535)\n    at \norg.apache.catalina.ha.tcp.ReplicationValve.sendSessionReplicationMessage\n(ReplicationValve.java:517)\n    at org.apache.catalina.ha.tcp.ReplicationValve.sendReplicationMessage\n(ReplicationValve.java:428)\n    at org.apache.catalina.ha.tcp.ReplicationValve.invoke\n(ReplicationValve.java:362)\n    at org.apache.catalina.connector.CoyoteAdapter.service\n(CoyoteAdapter.java:261)\n    at org.apache.jk.server.JkCoyoteHandler.invoke(JkCoyoteHandler.java:190)\n    at org.apache.jk.common.HandlerRequest.invoke(HandlerRequest.java:283)\n    at org.apache.jk.common.ChannelSocket.invoke(ChannelSocket.java:767)\n    at org.apache.jk.common.ChannelSocket.processConnection\n(ChannelSocket.java:697)\n    at org.apache.jk.common.ChannelSocket$SocketConnection.runIt\n(ChannelSocket.java:889)\n    at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:686)\n    at java.lang.Thread.run(Thread.java:595)\nCaused by: java.lang.NullPointerException\n    at org.apache.catalina.tribes.transport.PooledSender.returnSender\n(PooledSender.java:48)\n    at \norg.apache.catalina.tribes.transport.nio.PooledParallelSender.sendMessage\n(PooledParallelSender.java:52)\n    at org.apache.catalina.tribes.transport.ReplicationTransmitter.sendMessage\n(ReplicationTransmitter.java:80)\n    at org.apache.catalina.tribes.group.ChannelCoordinator.sendMessage\n(ChannelCoordinator.java:78)\n    at org.apache.catalina.tribes.group.ChannelInterceptorBase.sendMessage\n(ChannelInterceptorBase.java:75)\n    at \norg.apache.catalina.tribes.group.interceptors.TcpFailureDetector.sendMessage\n(TcpFailureDetector.java:87)\n    at org.apache.catalina.tribes.group.ChannelInterceptorBase.sendMessage\n(ChannelInterceptorBase.java:75)\n    at \norg.apache.catalina.tribes.group.interceptors.MessageDispatchInterceptor.sendMe\nssage(MessageDispatchInterceptor.java:73)\n    at org.apache.catalina.tribes.group.ChannelInterceptorBase.sendMessage\n(ChannelInterceptorBase.java:75)\n    at org.apache.catalina.tribes.group.GroupChannel.send\n(GroupChannel.java:216)\n\n\nWhen Sender cannot be acquired, it is necessary to throw ChannelException.\nOtherwise, because the exception can not catch with interceptor such as \norg.apache.catalina.tribes.group.interceptors.TcpFailureDetector, \nthe exception handling cannot be done. \nThe same processing of \norg.apache.catalina.tribes.transport.bio.PooledMultiSender checks Null.','2007-06-13 02:27:35','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','46bda08','Filip Hanik','2007-06-13 13:05:14','fix for BZ 42650 http://issues.apache.org/bugzilla/show_bug.cgi?id=42650','java/org/apache/catalina/tribes/transport/nio/PooledParallelSender.java'),(2150,42648,'Bug 42648 – SWAP increases by the cluster of Tomca6','SWAP increases by the cluster of Tomca6 and operation becomes unstable. \n\nEnvironment\n Tomcat6.0.13\n JDK1.5.11\n memory : 2G\n Heap size : - Xmx1500m -Xms1500m\n\nSWAP increases only for direct=\"true\". \nIt occurs when operating for a long time by a high load. \n\n   <Receiver className=\"org.apache.catalina.tribes.transport.nio.NioReceiver\"\n        ... \n        direct=\"true\" />\n\nSWAP doesn\'t increase when setting it to direct =\"false\". \n\n   <Receiver className=\"org.apache.catalina.tribes.transport.nio.NioReceiver\"\n        ... \n        direct=\"false\" />\n        \nI noticed the following. \nIn org.apache.catalina.tribes.transport.nio.NioReplicationTask,buffer is made \nper run method.\n\n    public synchronized void run() { \n        if ( (getOptions() & OPTION_DIRECT_BUFFER) == OPTION_DIRECT_BUFFER ) {\n            buffer = ByteBuffer.allocateDirect(getRxBufSize());\n        }else {\n            buffer = ByteBuffer.allocate (getRxBufSize());\n        }\n\n        if (key == null) {\n            return;	// just in case\n        }\n        ....\n\nThe buffer is enough if made once. \n\nFor instance,\nThe creating of buffer by the run method is stopped. \n\n    public synchronized void run() { \n//    	if ( (getOptions() & OPTION_DIRECT_BUFFER) == OPTION_DIRECT_BUFFER ) {\n//            buffer = ByteBuffer.allocateDirect(getRxBufSize());\n//        }else {\n//            buffer = ByteBuffer.allocate (getRxBufSize());\n//        }\n    ....\n    \nCreating of buffer by the setRxBufSize method.\n\n    public void setRxBufSize(int rxBufSize) {\n        this.rxBufSize = rxBufSize;\n        if ( (getOptions() & OPTION_DIRECT_BUFFER) == OPTION_DIRECT_BUFFER ) {\n            buffer = ByteBuffer.allocateDirect(getRxBufSize());\n        }else {\n            buffer = ByteBuffer.allocate (getRxBufSize());\n        }\n    }\n    \nResult.\nSWAP doesn\'t increase.','2007-06-13 02:02:28','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P4 trivial','e79edcd','Filip Hanik','2007-06-13 13:00:21','fix for BZ 42648 http://issues.apache.org/bugzilla/show_bug.cgi?id=42648','java/org/apache/catalina/tribes/transport/nio/NioReplicationTask.java'),(2151,42648,'Bug 42648 – SWAP increases by the cluster of Tomca6','SWAP increases by the cluster of Tomca6 and operation becomes unstable. \n\nEnvironment\n Tomcat6.0.13\n JDK1.5.11\n memory : 2G\n Heap size : - Xmx1500m -Xms1500m\n\nSWAP increases only for direct=\"true\". \nIt occurs when operating for a long time by a high load. \n\n   <Receiver className=\"org.apache.catalina.tribes.transport.nio.NioReceiver\"\n        ... \n        direct=\"true\" />\n\nSWAP doesn\'t increase when setting it to direct =\"false\". \n\n   <Receiver className=\"org.apache.catalina.tribes.transport.nio.NioReceiver\"\n        ... \n        direct=\"false\" />\n        \nI noticed the following. \nIn org.apache.catalina.tribes.transport.nio.NioReplicationTask,buffer is made \nper run method.\n\n    public synchronized void run() { \n        if ( (getOptions() & OPTION_DIRECT_BUFFER) == OPTION_DIRECT_BUFFER ) {\n            buffer = ByteBuffer.allocateDirect(getRxBufSize());\n        }else {\n            buffer = ByteBuffer.allocate (getRxBufSize());\n        }\n\n        if (key == null) {\n            return;	// just in case\n        }\n        ....\n\nThe buffer is enough if made once. \n\nFor instance,\nThe creating of buffer by the run method is stopped. \n\n    public synchronized void run() { \n//    	if ( (getOptions() & OPTION_DIRECT_BUFFER) == OPTION_DIRECT_BUFFER ) {\n//            buffer = ByteBuffer.allocateDirect(getRxBufSize());\n//        }else {\n//            buffer = ByteBuffer.allocate (getRxBufSize());\n//        }\n    ....\n    \nCreating of buffer by the setRxBufSize method.\n\n    public void setRxBufSize(int rxBufSize) {\n        this.rxBufSize = rxBufSize;\n        if ( (getOptions() & OPTION_DIRECT_BUFFER) == OPTION_DIRECT_BUFFER ) {\n            buffer = ByteBuffer.allocateDirect(getRxBufSize());\n        }else {\n            buffer = ByteBuffer.allocate (getRxBufSize());\n        }\n    }\n    \nResult.\nSWAP doesn\'t increase.','2007-06-13 02:02:28','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P4 trivial','e79edcd','Filip Hanik','2007-06-13 13:00:21','fix for BZ 42648 http://issues.apache.org/bugzilla/show_bug.cgi?id=42648','java/org/apache/catalina/tribes/transport/nio/NioReplicationTask.java'),(2152,42648,'Bug 42648 – SWAP increases by the cluster of Tomca6','SWAP increases by the cluster of Tomca6 and operation becomes unstable. \n\nEnvironment\n Tomcat6.0.13\n JDK1.5.11\n memory : 2G\n Heap size : - Xmx1500m -Xms1500m\n\nSWAP increases only for direct=\"true\". \nIt occurs when operating for a long time by a high load. \n\n   <Receiver className=\"org.apache.catalina.tribes.transport.nio.NioReceiver\"\n        ... \n        direct=\"true\" />\n\nSWAP doesn\'t increase when setting it to direct =\"false\". \n\n   <Receiver className=\"org.apache.catalina.tribes.transport.nio.NioReceiver\"\n        ... \n        direct=\"false\" />\n        \nI noticed the following. \nIn org.apache.catalina.tribes.transport.nio.NioReplicationTask,buffer is made \nper run method.\n\n    public synchronized void run() { \n        if ( (getOptions() & OPTION_DIRECT_BUFFER) == OPTION_DIRECT_BUFFER ) {\n            buffer = ByteBuffer.allocateDirect(getRxBufSize());\n        }else {\n            buffer = ByteBuffer.allocate (getRxBufSize());\n        }\n\n        if (key == null) {\n            return;	// just in case\n        }\n        ....\n\nThe buffer is enough if made once. \n\nFor instance,\nThe creating of buffer by the run method is stopped. \n\n    public synchronized void run() { \n//    	if ( (getOptions() & OPTION_DIRECT_BUFFER) == OPTION_DIRECT_BUFFER ) {\n//            buffer = ByteBuffer.allocateDirect(getRxBufSize());\n//        }else {\n//            buffer = ByteBuffer.allocate (getRxBufSize());\n//        }\n    ....\n    \nCreating of buffer by the setRxBufSize method.\n\n    public void setRxBufSize(int rxBufSize) {\n        this.rxBufSize = rxBufSize;\n        if ( (getOptions() & OPTION_DIRECT_BUFFER) == OPTION_DIRECT_BUFFER ) {\n            buffer = ByteBuffer.allocateDirect(getRxBufSize());\n        }else {\n            buffer = ByteBuffer.allocate (getRxBufSize());\n        }\n    }\n    \nResult.\nSWAP doesn\'t increase.','2007-06-13 02:02:28','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P4 trivial','beebd80','Filip Hanik','2007-06-13 12:55:27','Fix for BZ 42648 http://issues.apache.org/bugzilla/show_bug.cgi?id=42648','java/org/apache/catalina/tribes/transport/nio/NioReplicationTask.java'),(2153,42648,'Bug 42648 – SWAP increases by the cluster of Tomca6','SWAP increases by the cluster of Tomca6 and operation becomes unstable. \n\nEnvironment\n Tomcat6.0.13\n JDK1.5.11\n memory : 2G\n Heap size : - Xmx1500m -Xms1500m\n\nSWAP increases only for direct=\"true\". \nIt occurs when operating for a long time by a high load. \n\n   <Receiver className=\"org.apache.catalina.tribes.transport.nio.NioReceiver\"\n        ... \n        direct=\"true\" />\n\nSWAP doesn\'t increase when setting it to direct =\"false\". \n\n   <Receiver className=\"org.apache.catalina.tribes.transport.nio.NioReceiver\"\n        ... \n        direct=\"false\" />\n        \nI noticed the following. \nIn org.apache.catalina.tribes.transport.nio.NioReplicationTask,buffer is made \nper run method.\n\n    public synchronized void run() { \n        if ( (getOptions() & OPTION_DIRECT_BUFFER) == OPTION_DIRECT_BUFFER ) {\n            buffer = ByteBuffer.allocateDirect(getRxBufSize());\n        }else {\n            buffer = ByteBuffer.allocate (getRxBufSize());\n        }\n\n        if (key == null) {\n            return;	// just in case\n        }\n        ....\n\nThe buffer is enough if made once. \n\nFor instance,\nThe creating of buffer by the run method is stopped. \n\n    public synchronized void run() { \n//    	if ( (getOptions() & OPTION_DIRECT_BUFFER) == OPTION_DIRECT_BUFFER ) {\n//            buffer = ByteBuffer.allocateDirect(getRxBufSize());\n//        }else {\n//            buffer = ByteBuffer.allocate (getRxBufSize());\n//        }\n    ....\n    \nCreating of buffer by the setRxBufSize method.\n\n    public void setRxBufSize(int rxBufSize) {\n        this.rxBufSize = rxBufSize;\n        if ( (getOptions() & OPTION_DIRECT_BUFFER) == OPTION_DIRECT_BUFFER ) {\n            buffer = ByteBuffer.allocateDirect(getRxBufSize());\n        }else {\n            buffer = ByteBuffer.allocate (getRxBufSize());\n        }\n    }\n    \nResult.\nSWAP doesn\'t increase.','2007-06-13 02:02:28','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P4 trivial','beebd80','Filip Hanik','2007-06-13 12:55:27','Fix for BZ 42648 http://issues.apache.org/bugzilla/show_bug.cgi?id=42648','java/org/apache/catalina/tribes/transport/nio/NioReplicationTask.java'),(2154,33774,'Bug 33774 – JNDIRealm fails when server disconnects after time','Using the JNDIRealm for authentication, if the LDAP server is set to \nautomatically disconnect the client (in this case, tomcat\'s JNDIRealm), tomcat \ndoes not discover this until it attempts another login.  If the connection has \nbeen reset, it results in a failed login attempt for the user.  So the first \ntime somebody logs into the application after some period of time (I think the \ntimeout is pretty short on our LDAP server), the user will get one failed \nlogin attempt before a real one.\n\nI\'ve not seen in the documentation any properties on the JNDIRealm an amount \nof time to hold the connection open before electively disconnecting it.\n\n2005-02-28 07:47:39 JNDIRealm[/iso]:   Searching for myuserid\n2005-02-28 07:47:39 JNDIRealm[/iso]:   base: ou=users,dc=company,dc=com  \nfilter: (&(objectClass=user)(uid=myuserid))\n2005-02-28 07:47:39 JNDIRealm[/iso]: Exception performing authentication\njavax.naming.CommunicationException: Connection reset [Root exception is \njava.net.SocketException: Connection reset]; remaining \nname \'ou=ou=users,dc=company,dc=com\'\n        at com.sun.jndi.ldap.LdapCtx.doSearch(LdapCtx.java:1961)\n        at com.sun.jndi.ldap.LdapCtx.searchAux(LdapCtx.java:1806)\n        at com.sun.jndi.ldap.LdapCtx.c_search(LdapCtx.java:1731)\n        at com.sun.jndi.toolkit.ctx.ComponentDirContext.p_search\n(ComponentDirContext.java:368)\n        at com.sun.jndi.toolkit.ctx.PartialCompositeDirContext.search\n(PartialCompositeDirContext.java:338)\n        at com.sun.jndi.toolkit.ctx.PartialCompositeDirContext.search\n(PartialCompositeDirContext.java:321)\n        at javax.naming.directory.InitialDirContext.search\n(InitialDirContext.java:248)\n        at org.apache.catalina.realm.JNDIRealm.getUserBySearch\n(JNDIRealm.java:1074)\n        at org.apache.catalina.realm.JNDIRealm.getUser(JNDIRealm.java:967)\n        at org.apache.catalina.realm.JNDIRealm.authenticate(JNDIRealm.java:916)\n        at org.apache.catalina.realm.JNDIRealm.authenticate(JNDIRealm.java:809)\n        at org.apache.catalina.authenticator.FormAuthenticator.authenticate\n(FormAuthenticator.java:235)\n        at org.apache.catalina.authenticator.AuthenticatorBase.invoke\n(AuthenticatorBase.java:446)\n        at org.apache.catalina.core.StandardValveContext.invokeNext\n(StandardValveContext.java:102)\n        at org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:520)\n        at org.apache.catalina.core.StandardHostValve.invoke\n(StandardHostValve.java:137)\n        at org.apache.catalina.core.StandardValveContext.invokeNext\n(StandardValveContext.java:104)\n        at org.apache.catalina.valves.ErrorReportValve.invoke\n(ErrorReportValve.java:118)\n        at org.apache.catalina.core.StandardValveContext.invokeNext\n(StandardValveContext.java:102)\n        at org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:520)\n        at org.apache.catalina.core.StandardEngineValve.invoke\n(StandardEngineValve.java:109)\n        at org.apache.catalina.core.StandardValveContext.invokeNext\n(StandardValveContext.java:104)\n        at org.apache.catalina.core.StandardPipeline.invoke\n(StandardPipeline.java:520)\n        at org.apache.catalina.core.ContainerBase.invoke\n(ContainerBase.java:929)\n        at org.apache.coyote.tomcat5.CoyoteAdapter.service\n(CoyoteAdapter.java:160)\n        at org.apache.jk.server.JkCoyoteHandler.invoke\n(JkCoyoteHandler.java:300)\n        at org.apache.jk.common.HandlerRequest.invoke(HandlerRequest.java:374)\n        at org.apache.jk.common.ChannelSocket.invoke(ChannelSocket.java:743)\n        at org.apache.jk.common.ChannelSocket.processConnection\n(ChannelSocket.java:675)\n        at org.apache.jk.common.SocketConnection.runIt(ChannelSocket.java:866)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run\n(ThreadPool.java:684)\n        at java.lang.Thread.run(Thread.java:595)\nCaused by: java.net.SocketException: Connection reset\n        at java.net.SocketInputStream.read(SocketInputStream.java:168)\n        at java.io.BufferedInputStream.fill(BufferedInputStream.java:218)\n        at java.io.BufferedInputStream.read1(BufferedInputStream.java:256)\n        at java.io.BufferedInputStream.read(BufferedInputStream.java:313)\n        at com.sun.jndi.ldap.Connection.run(Connection.java:780)\n        ... 1 more\n\n2005-02-28 07:47:39 JNDIRealm[/iso]: Closing directory context','2005-02-28 17:25:59','Will Stranathan','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','6d2a325','Mark Emlyn David Thomas','2007-06-01 21:42:17','Port fix for 33774. Retry on ServiceUnavailableException','java/org/apache/catalina/realm/JNDIRealm.java\nwebapps/docs/changelog.xml'),(2155,42497,'Bug 42497 – 304 response should consistently include ETag header','','2007-05-23 09:00:19','Len Popp','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','0114b2d','Mark Emlyn David Thomas','2007-06-01 20:42:36','Port fix for bug 42497. Include ETag header on 304 response as per RFC2616. Patch provided by Len Popp.','java/org/apache/catalina/servlets/DefaultServlet.java\nwebapps/docs/changelog.xml'),(2156,42509,'Bug 42509 – API signature errors in javax.servlet.jsp','','2007-05-24 05:47:12','Paul McMahan','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','6e07f1f','Filip Hanik','2007-06-01 03:40:37','Forward port of BZ 42509 and BZ 42515','java/javax/el/BeanELResolver.java\njava/javax/el/ResourceBundleELResolver.java\njava/javax/servlet/jsp/el/ScopedAttributeELResolver.java\njava/javax/servlet/jsp/tagext/TagInfo.java'),(2157,42515,'Bug 42515 – API signature discrepancies in el-api','The el-api doesn\'t exactly match the API specification for JEE5 javax.el.\n\n\nSpecifically, the following method signatures:\n\n- javax.el.BeanELResolver$BeanProperties\npublic final javax.el.BeanELResolver$BeanProperty getBeanProperty(java.lang.String)\n\n- javax.el.BeanELResolver$BeanProperty\npublic final java.lang.Class getPropertyType()\n\n- javax.el.BeanELResolver$BeanProperty\npublic final java.lang.reflect.Method getReadMethod()\n\n- javax.el.BeanELResolver$BeanProperty\npublic final java.lang.reflect.Method getWriteMethod()\n\n- javax.el.ResourceBundleELResolver\npublic java.util.Iterator getFeatureDescriptors(javax.el.ELContext,java.lang.Object)\n\n\nshould replace these method signatures :\n\n- javax.el.BeanELResolver$BeanProperties\npublic final java.lang.Class<?> getType()\n\n- javax.el.BeanELResolver$BeanProperties\npublic final javax.el.BeanELResolver$BeanProperty\nget(javax.el.ELContext,java.lang.String)\n\n- javax.el.BeanELResolver$BeanProperty\npublic final java.lang.Class<?> getType()\n\n- javax.el.BeanELResolver$BeanProperty\nmethod  public final java.lang.reflect.Method read(javax.el.ELContext)\n\n- javax.el.BeanELResolver$BeanProperty\npublic final java.lang.reflect.Method write(javax.el.ELContext)\n\n- javax.el.ResourceBundleELResolver:\npublic java.util.Iterator<java.beans.FeatureDescriptor>\ngetFeatureDescriptors(javax.el.ELContext,java.lang.Object)','2007-05-24 12:11:58','Paul McMahan','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','6e07f1f','Filip Hanik','2007-06-01 03:40:37','Forward port of BZ 42509 and BZ 42515','java/javax/el/BeanELResolver.java\njava/javax/el/ResourceBundleELResolver.java\njava/javax/servlet/jsp/el/ScopedAttributeELResolver.java\njava/javax/servlet/jsp/tagext/TagInfo.java'),(2158,42509,'Bug 42509 – API signature errors in javax.servlet.jsp','','2007-05-24 05:47:12','Paul McMahan','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','089609a','Filip Hanik','2007-06-01 03:38:39','Fix signatures BZ 42509 BZ 42515 Submitted by Paul McMahan','java/javax/el/BeanELResolver.java\njava/javax/el/ResourceBundleELResolver.java\njava/javax/servlet/jsp/el/ScopedAttributeELResolver.java\njava/javax/servlet/jsp/tagext/TagInfo.java'),(2159,42515,'Bug 42515 – API signature discrepancies in el-api','The el-api doesn\'t exactly match the API specification for JEE5 javax.el.\n\n\nSpecifically, the following method signatures:\n\n- javax.el.BeanELResolver$BeanProperties\npublic final javax.el.BeanELResolver$BeanProperty getBeanProperty(java.lang.String)\n\n- javax.el.BeanELResolver$BeanProperty\npublic final java.lang.Class getPropertyType()\n\n- javax.el.BeanELResolver$BeanProperty\npublic final java.lang.reflect.Method getReadMethod()\n\n- javax.el.BeanELResolver$BeanProperty\npublic final java.lang.reflect.Method getWriteMethod()\n\n- javax.el.ResourceBundleELResolver\npublic java.util.Iterator getFeatureDescriptors(javax.el.ELContext,java.lang.Object)\n\n\nshould replace these method signatures :\n\n- javax.el.BeanELResolver$BeanProperties\npublic final java.lang.Class<?> getType()\n\n- javax.el.BeanELResolver$BeanProperties\npublic final javax.el.BeanELResolver$BeanProperty\nget(javax.el.ELContext,java.lang.String)\n\n- javax.el.BeanELResolver$BeanProperty\npublic final java.lang.Class<?> getType()\n\n- javax.el.BeanELResolver$BeanProperty\nmethod  public final java.lang.reflect.Method read(javax.el.ELContext)\n\n- javax.el.BeanELResolver$BeanProperty\npublic final java.lang.reflect.Method write(javax.el.ELContext)\n\n- javax.el.ResourceBundleELResolver:\npublic java.util.Iterator<java.beans.FeatureDescriptor>\ngetFeatureDescriptors(javax.el.ELContext,java.lang.Object)','2007-05-24 12:11:58','Paul McMahan','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','089609a','Filip Hanik','2007-06-01 03:38:39','Fix signatures BZ 42509 BZ 42515 Submitted by Paul McMahan','java/javax/el/BeanELResolver.java\njava/javax/el/ResourceBundleELResolver.java\njava/javax/servlet/jsp/el/ScopedAttributeELResolver.java\njava/javax/servlet/jsp/tagext/TagInfo.java'),(2160,42559,'Bug 42559 – ErrorReportValve does not provide an error report','rev 535915 changed the behavior of ErrorReportValve in tomcat6 to not produce an\nerror report when response.sendError() is called. For example, using this code\nin a servlet\'s service() does not produce an error report:\n\nresponse.sendError(HttpServletResponse.SC_GONE, \"error occurred\");\n\nThe underlying cause is that the valve\'s check for response.isCommitted() was\nreplaced with response.isAppCommitted().  The latter returns true, which causes\nthe Valve\'s invoke() method to immediately return instead of producing the report.','2007-05-31 09:09:05','Paul McMahan','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 regression','71eccb3','Remy Maucherat','2007-05-31 19:08:24','- 42559: I did not make equivalent modifications (the isCommitted method was not invoked on the facade).','java/org/apache/catalina/valves/ErrorReportValve.java'),(2161,39425,'Bug 39425 – catalina.policy & precompiled jsps','Precompiled JSPs needs following additional permission if running with\nsecuritymanager:\npermission java.util.PropertyPermission\n\"org.apache.jasper.runtime.BodyContentImpl.LIMIT_BUFFER\", \"read\";\n\nPlease add this line in the sample policy file (catalina.policy) or change the\ncode in org.apache.jasper.runtime.BodyContentImpl:\n   private static final boolean LIMIT_BUFFER = \nBoolean.valueOf(System.getProperty(\"org.apache.jasper.runtime.BodyContentImpl.LIMIT_BUFFER\",\n\"false\")).booleanValue();','2006-04-27 09:03:25','Gernot','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 normal','e32e38b','Mark Emlyn David Thomas','2007-05-30 22:44:55','Port fix for bug 39425. Add additional permission required for precompiled JSPs.','conf/catalina.policy\nwebapps/docs/changelog.xml'),(2162,42530,'Bug 42530 – ManagerBase.backgroundProcess throws NullPointerException.','','2007-05-27 21:26:55','Keiichi Fujino','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','41d0120','Remy Maucherat','2007-05-28 06:06:31','- Redo findSessions which was outdated (42530 claims concurrency problems that I can\'t reproduce).','java/org/apache/catalina/session/ManagerBase.java'),(2163,42436,'Bug 42436 – service-qname and soap-header not parsed correctly','','2007-05-16 09:19:07','Paul McMahan','Tomcat Developers Mailing List','CLOSED FIXED','Tomcat 6','Catalina','P2 major','23c6dbb','Fabien Carrion','2007-05-22 23:56:10','Correction Bug 42436 patch from Paul McMahan','java/org/apache/catalina/startup/WebRuleSet.java'),(2164,39875,'Bug 39875 – RealmBase#init() needs cleanup','','2006-06-23 11:15:08','Takayoshi Kimura','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','0ea4c7c','Mark Emlyn David Thomas','2007-05-22 22:44:56','Port fix for bug 39875. Fix genrics compiler warnings.','java/org/apache/catalina/realm/RealmBase.java\nwebapps/docs/changelog.xml'),(2165,42438,'Bug 42438 – Duplicate JSP temp variable declaration when jsp:attribute used in conjunction with custom tags','','2007-05-16 17:43:51','Brian Lenz','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 major','5e188bc','Mark Emlyn David Thomas','2007-05-22 22:42:08','Port fix for bug 42438. Duplicate temp variable was created. Patch provided by Brian Lenz.','java/org/apache/jasper/compiler/Node.java\nwebapps/docs/changelog.xml'),(2166,42436,'Bug 42436 – service-qname and soap-header not parsed correctly','','2007-05-16 09:19:07','Paul McMahan','Tomcat Developers Mailing List','CLOSED FIXED','Tomcat 6','Catalina','P2 major','7638a3f','Fabien Carrion','2007-05-22 03:40:22','Correction Bug 42436 patch from Paul McMahan','java/org/apache/catalina/startup/WebRuleSet.java'),(2167,42459,'Bug 42459 – Tomcat Web Application Manager table error','html table -> tr wrong formating when stop (not last) in Tomcat Web Application \nManager.','2007-05-19 13:32:58','Pawe&#322;','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 trivial','33c9949','Rainer Jung','2007-05-20 13:12:08','Fix BZ 42459: Manager webap table format error for stopped and undeployed webapps.','java/org/apache/catalina/manager/HTMLManagerServlet.java\nwebapps/docs/changelog.xml'),(2168,42444,'Bug 42444 – Potential NullPointerException in org.apache.catalina.valves.AccessLogValve','','2007-05-17 08:15:53','Nils Hammar','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','776736f','Timothy A. Funk','2007-05-19 14:31:09','bug 42444: prevent NPE Patch provided by Nils Hammar (funkman)','java/org/apache/catalina/valves/AccessLogValve.java\nwebapps/docs/changelog.xml'),(2169,42401,'Bug 42401 – RUNNING.txt has wrong info about required Java environment','','2007-05-11 19:34:15','Sebastian von Knorring','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Webapps:Documentation','P5 minor','a175efa','Mark Emlyn David Thomas','2007-05-12 17:11:40','Fix bug 42401. Provide better JRE/JDK information.','RUNNING.txt\nbin/catalina.bat\nwebapps/docs/changelog.xml'),(2170,42361,'Bug 42361 – POST content type incorrect for multipart forms after login','When using a form with a custom encoding (e.g. \"multipart/form-data\"), the\ncontent type is not restored after a redirect to a login page (auth-method = FORM).\n\nTo reproduce:\n- A page that POSTs using multipart/form-data encoding (or anything other than\napplication/x-www-form-urlencoded) to a result page that is protected by a login\npage (auth-method=FORM) is invoked.\n- Even though the multipart POST data exists (verified by reading input stream\nof request from result page) the content type of the request is always\n\"application/x-www-form-urlencoded\".  \n- This only happens when redirected to the login page first.  It does not happen\nif already logged in.','2007-05-08 16:06:35','Peter Runge','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','637acc5','Mark Emlyn David Thomas','2007-05-08 19:58:24','Fix bug 42361. Handle multi-part forms when saving request during FORM auth. Patch provided by Peter Runge.','java/org/apache/catalina/authenticator/FormAuthenticator.java\njava/org/apache/catalina/authenticator/SavedRequest.java\nwebapps/docs/changelog.xml'),(2171,42309,'Bug 42309 – Request: support for NIO in Embedded Tomcat','in org.apache.catalina.startup.Embedded there is no direct API to create an NIO\nconnector. This would be very helpful for all applications which use tomcat in\nembedded mode and require the CometProcessor.','2007-05-01 02:03:28','ron','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 enhancement','9546005','Filip Hanik','2007-05-03 11:49:09','Ability to create a connector using a custom protocol specification for embedded. Fix for bug 42309','java/org/apache/catalina/startup/Embedded.java'),(2172,42308,'Bug 42308 – with APR bytessent bytesreceived performance data is not collected','with APR bytes received and bytes sent are always 0.','2007-05-01 01:57:57','ron','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','4a04722','Remy Maucherat','2007-05-01 08:46:12','- 42308: nextRequest recycles the request.','java/org/apache/coyote/http11/Http11AprProcessor.java\njava/org/apache/coyote/http11/Http11AprProtocol.java\njava/org/apache/coyote/http11/Http11NioProcessor.java\njava/org/apache/coyote/http11/InternalNioInputBuffer.java'),(2173,42202,'Bug 42202 – if you install tomcat in a directory with spaces it ignores TLD files inside jar files','if you install tomcat or a web application in a directory with spaces in the\nname, for example \"C:\\Program Files\\vds\\tomcat\" for tomcat or \"C:\\Program\nFiles\\vds\\console\" for a web application.\nthe TLD files that are inside the META-INF directory of the jar files will not\nbe loaded.\n\nthe problem is is the file treatment inside the TldConfig class ...\nI have attached a patch with the correction.\nthis bug is found in Tomcat 6 too','2007-04-23 14:07:38','Rodrigo Urubatan','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 major','f9ddaba','Remy Maucherat','2007-04-24 09:42:07','- 42202: Fix a problem handling %xx encoded URLs (unfortunately, some are encoded - the webapp CL and the system CL -   and some are not - the URL CL).','java/org/apache/catalina/startup/TldConfig.java'),(2174,41655,'Bug 41655 – Some variable informations are not output in some languages.','I noticed that some variable informations are not output to the log in some \nlocales.\n\nIt is because the variable informations has not been described to the \nproperties file, though the value is given by the argument of \nStringManager#getString. \n\n-org.apache.catalina.startup.LocalStrings_fr.properties\n                             LocalStrings_es.properties\n                             LocalStrings_ja.properties\n key:\n    contextConfig.applicationParse  ... {0} not exists.\n    contextConfig.tldEntryException ... {2} not exists.\n    contextConfig.tldFileException  ... {1} not exists.\n    contextConfig.tldJarException   ... {1} not exists.\n\n-org.apache.jasper.resources.LocalStrings_ja.properties\n key:\n    jsp.error.bad.scratch.dir  ... {0} not exists.\n\nI hope for them to be written in the properties files to debug applications \neasily.','2007-02-19 04:44:01','Suzuki Yuichiro','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P5 trivial','20bd80a','Mark Emlyn David Thomas','2007-04-18 22:58:35','Complete fix for 41655.','java/org/apache/catalina/startup/LocalStrings_ja.properties\njava/org/apache/jasper/resources/LocalStrings_ja.properties\nwebapps/docs/changelog.xml'),(2175,42071,'Bug 42071 – If a JSP throws an UnavailableException twice, an IllegalStateException occurs.','If a JSP throws an UnavailableException twice, an IllegalStateException occurs.\n\nfirst access:\nJSP throws UnavailableException.\n\nsecond access:\nIf the JSP throws an UnavailableException again then an IllegalStateException\noccurs and Tomcat returns status code:500 to the client.\n\nThe problem is not that the IllegalStateException occurs.\nThe problem is that the JSP can be called even though it cannot be used.','2007-04-08 17:49:37','kawasima','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 normal','508f513','Mark Emlyn David Thomas','2007-04-18 22:28:08','Fix bug 42071 - ISE on multiple UnavailableExceptions. Allow recovery after an UnavailableException','java/org/apache/jasper/servlet/JspServletWrapper.java\nwebapps/docs/changelog.xml'),(2176,41869,'Bug 41869 – Should EL (Expression Language) expressions result in the TagData.REQUEST_TIME_VALUE object?','I have a custom tag with attributes defined in the TLD file as allowing run-\ntime expression values, meaning:\n\n  <rtexprvalue>true</rtexprvalue>\n\n\nI also have a TagExtraInfo class that I am using to validate the values \nprovided.\n\nInside my TagExtraInfo sub-class I have code such as this:\n\n   Object attr = data.getAttribute(\"groupSize\");\n \n   if ( attr != null &&\n        !attr.equals(TagData.REQUEST_TIME_VALUE)\n   {\n \nand so on.   When, in my JSP, I provide attribute values such as \"<%= 10 * 14 \n%\" (JSP scriplet) I do indeed get the TagData.REQUEST_TIME_VALUE object back \non this call.\n\nHowever, when I instead have an EL value, something like \"${groupSizeValue}\", \nI do not received the REQUEST_TIME_VALUE distinguished object back.  I receive \na String object, containing the text \"${groupSizeValue}\".  Is this the correct \nbehavior?  Everything I have read (books, Google searches, etc.) seems to \npoint me in the thinking that this is a bug.\n\n\nFrom looking at the tomcat 5.5.20 and 5.5.23 source code, I see where the \nJspAttribute (nested class of Node) is created.  In the Validator class, line \n1117, is the creation for this object passing the constant \"false\" for \nthe \"expr\" argument (5th argument to the 1st ctor of this class).  I believe \nit is line 1117 that would be getting executed since the if statement \npreceding this is:\n\n   if (el.containsEL() && !pageInfo.isELIgnored()) {\n \n \nSo, my question is, why would an EL expression when EL is not being ignored be \nconsidered not an expression?','2007-03-16 12:43:38','David L. Diehl','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Unknown','P2 normal','ce4cd2e','Mark Emlyn David Thomas','2007-04-17 21:30:25','Revert previous fix for 41869 and apply Remy\'s suggested fix.','java/org/apache/jasper/compiler/Validator.java'),(2177,41869,'Bug 41869 – Should EL (Expression Language) expressions result in the TagData.REQUEST_TIME_VALUE object?','I have a custom tag with attributes defined in the TLD file as allowing run-\ntime expression values, meaning:\n\n  <rtexprvalue>true</rtexprvalue>\n\n\nI also have a TagExtraInfo class that I am using to validate the values \nprovided.\n\nInside my TagExtraInfo sub-class I have code such as this:\n\n   Object attr = data.getAttribute(\"groupSize\");\n \n   if ( attr != null &&\n        !attr.equals(TagData.REQUEST_TIME_VALUE)\n   {\n \nand so on.   When, in my JSP, I provide attribute values such as \"<%= 10 * 14 \n%\" (JSP scriplet) I do indeed get the TagData.REQUEST_TIME_VALUE object back \non this call.\n\nHowever, when I instead have an EL value, something like \"${groupSizeValue}\", \nI do not received the REQUEST_TIME_VALUE distinguished object back.  I receive \na String object, containing the text \"${groupSizeValue}\".  Is this the correct \nbehavior?  Everything I have read (books, Google searches, etc.) seems to \npoint me in the thinking that this is a bug.\n\n\nFrom looking at the tomcat 5.5.20 and 5.5.23 source code, I see where the \nJspAttribute (nested class of Node) is created.  In the Validator class, line \n1117, is the creation for this object passing the constant \"false\" for \nthe \"expr\" argument (5th argument to the 1st ctor of this class).  I believe \nit is line 1117 that would be getting executed since the if statement \npreceding this is:\n\n   if (el.containsEL() && !pageInfo.isELIgnored()) {\n \n \nSo, my question is, why would an EL expression when EL is not being ignored be \nconsidered not an expression?','2007-03-16 12:43:38','David L. Diehl','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Unknown','P2 normal','9d0ec06','Mark Emlyn David Thomas','2007-04-17 20:32:36','Fix bug 41869. TagData.getAttribute() should return TagData.REQUEST_TIME_VALUE when the attribute value is an EL expression.','java/org/apache/jasper/compiler/Validator.java\nwebapps/docs/changelog.xml'),(2178,42130,'Bug 42130 – Corrections to manager app\'s manager.xml and broken links.','','2007-04-15 11:37:32','Rashmi Rubdi','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P5 normal','add269f','Remy Maucherat','2007-04-16 18:59:24','- Fix links (42130).','java/org/apache/catalina/manager/host/LocalStrings.properties'),(2179,42130,'Bug 42130 – Corrections to manager app\'s manager.xml and broken links.','','2007-04-15 11:37:32','Rashmi Rubdi','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P5 normal','011a4b3','Remy Maucherat','2007-04-16 18:59:03','- Fix links (42130).','java/org/apache/catalina/manager/LocalStrings.properties'),(2180,42130,'Bug 42130 – Corrections to manager app\'s manager.xml and broken links.','','2007-04-15 11:37:32','Rashmi Rubdi','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P5 normal','d79be72','Remy Maucherat','2007-04-16 17:01:16','- Update path (part of 42130).','webapps/manager/manager.xml'),(2181,42130,'Bug 42130 – Corrections to manager app\'s manager.xml and broken links.','','2007-04-15 11:37:32','Rashmi Rubdi','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P5 normal','167b35c','Remy Maucherat','2007-04-16 17:00:52','- Update path (part of 42130).','webapps/host-manager/host-manager.xml\nwebapps/host-manager/manager.xml'),(2182,41990,'Bug 41990 – several mime types missing from conf/web.xml','conf/web.xml\n\nplease add:\n\n    <mime-mapping>\n        <extension>wmv</extension>\n        <mime-type>video/x-ms-wmv</mime-type>\n    </mime-mapping>','2007-03-29 17:56:04','Jon Stevens','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Connector:HTTP','P2 normal','dfd1416','Mark Emlyn David Thomas','2007-04-15 16:04:25','Fix bug 41990. Add some new mime-type mappings.','conf/web.xml\nwebapps/docs/changelog.xml'),(2183,42025,'Bug 42025 – Incorrect documentation in RemoteAddrValve/RemoteHostValve','','2007-04-02 16:22:49','Renaud Waldura','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Webapps:Documentation','P2 normal','77ba62e','Mark Emlyn David Thomas','2007-04-15 15:26:34','Fix bug 42025. Refer to correct regular expression implementation','webapps/docs/changelog.xml\nwebapps/docs/config/valve.xml'),(2184,42039,'Bug 42039 – Tomcat doesn\'t output the stack trace of UnavailableException.','When UnavailableException is thrown from the Servlet:init, Tomcat doesn\'t output\nthe stack trace of UnavailableException.\n\nThe cause of problem is lost.\n\nTomcat should output the stack trace at the \"invoke\" method of\nStandardWrapperValue.','2007-04-03 16:54:58','kawasima','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','c3d2ce4','Mark Emlyn David Thomas','2007-04-15 13:45:34','Fix bug 42039. Log a stack trace if a servlet throws an UnavailableException. Patch provided by Kawasima Kazuh Remove some unused code.','java/org/apache/catalina/core/StandardWrapperValve.java'),(2185,42119,'Bug 42119 – request.getCharacterEncoding misparses charset=UTF-8; xyz=3','(This bug is also present in Coyote source 6.0.10.)\n\nIf there is an HTTP header\n Content-Type: text/abc; charset=UTF-8; xyz=3\nrequest.getCharacterEncoding() returns \"UTF-8; xyz=3\" but Tomcat 4.1.24 returns\n\"UTF-8\".\n\nIn Tomcat 4.1.24, request.getCharacterEncoding uses parseCharacterEncoding\ndefined in\n \njakarta-tomcat-4.1.24-src/catalina/src/share/org/apache/catalina/util/RequestUtil.java\n\nand it correctly handles the case of other Content-Type parameters.\n\nIn Tomcat 5.5.23, however, request.getCharacterEncoding uses\ngetCharsetFromContentType defined in \nfrom\napache-tomcat-5.5.23-src/connectors/util/java/org/apache/tomcat/util/http/ContentType.java\n\nwhich does not search for a possible terminating semicolon in the charset, thus\nerroneously including additional characters in the charset.\n\nThe code in 5.5.23 has a comment begins\n     // Basically return everything after \";charset=\"\n\nPlease consider using the code from 4.1.24\n\nThis problem showed up when Content-Type was multipart/mixed and a client\nspecified a charset parameter to Content-Type; however, it will occur in any\nContent-Type where charset is specified and is not the last parameter.','2007-04-13 12:01:02','Leigh L. Klotz, Jr.','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Connector:Coyote','P3 normal','4cf171a','Mark Emlyn David Thomas','2007-04-14 20:22:47','Fix bug 42119 using approach suggested by Leigh L Klotz Jr of using RequestUtil implementation.','java/org/apache/tomcat/util/http/ContentType.java\nwebapps/docs/changelog.xml'),(2186,42085,'Bug 42085 – java.util.Logging duplicated since 5.5.23.  5.5.20 is OK','We use the followwing logging.properties in our WebApplication:\n\n----------%<--------------------%<----------------\nhandlers = 1tivoli.java.util.logging.FileHandler,\n2product.java.util.logging.FileHandler\n\n# Handlers for the root logger\n.handlers = 1tivoli.java.util.logging.FileHandler,\n2product.java.util.logging.FileHandler\n\n1tivoli.java.util.logging.FileHandler.level = INFO\n1tivoli.java.util.logging.FileHandler.pattern = /var/log/product/tivoli%g.log\n# limit Output to 1MB\n1tivoli.java.util.logging.FileHandler.limit=1048576\n# Limit rotation to 10 Logs ...\n1tivoli.java.util.logging.FileHandler.count=10\n1tivoli.java.util.logging.FileHandler.append=true\n1tivoli.java.util.logging.FileHandler.formatter=de.customer.product.tivoli.TivoliFormatter\n\n2product.java.util.logging.FileHandler.level = FINEST\n2product.java.util.logging.FileHandler.pattern = /var/log/product/product%g.log\n# limit Output to 1MB\n2product.java.util.logging.FileHandler.limit=1048576\n# Limit rotation to 5 Logs ...\n2product.java.util.logging.FileHandler.count=5\n2product.java.util.logging.FileHandler.append=true\n2product.java.util.logging.FileHandler.formatter=java.util.logging.SimpleFormatter\n----------%<--------------------%<----------------\n\nWhen using apache-tomcat-5.5.23 every Line in the Logfiles\nis duplicated. Debugging I found that the TivoliFormatter \nis actually created twice. And the root-logger has actually\n4 Handlers and not two as intended. This does not allow us an\nupgrade beyond 5.5.20.\n\nFound on Linux64Bit and Windows-XP, both with JDK 1.5_R11','2007-04-10 23:13:02','Klaus Halfmann','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina:Modules','P3 regression','fa2b746','Remy Maucherat','2007-04-12 11:34:51','- 42085: The handlers for the root logger are now added in addLogger when they are explicitly specified.','java/org/apache/juli/ClassLoaderLogManager.java'),(2187,42072,'Bug 42072 – The call of the jspDestroy method violates it about the Java Servlet Specification 2.4, SRV.2.3.2.1.','When a JSP is accessed for a second time, the jspDestroy method is called even\nif a ServletException is thrown from the init method of the class that extends\nHttpJspPage.\n\nThis violates the Java Servlet Specification 2.4, SRV.2.3.2.1.','2007-04-08 18:07:02','kawasima','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 major','3d27771','Mark Emlyn David Thomas','2007-04-09 19:31:09','Fix bug 42072. Don\'t call destroy() if init() fails. Patch provided by Kawasima Kazuh. Ported from TC5.5','java/org/apache/jasper/servlet/JspServletWrapper.java\nwebapps/docs/changelog.xml'),(2188,41289,'Bug 41289 – Error when deploying XML Configuration file URL','I tried to deploy a webapp using a context.xml file under manager webapp and\nreceived this error:\n\njava.io.FileNotFoundException:\n/opt/apache-tomcat-6.0.2/conf/Catalina/localhost/mywebapp3.xml (No such file or\ndirectory)\n        at java.io.FileOutputStream.open(Native Method)\n        at java.io.FileOutputStream.<init>(FileOutputStream.java:179)\n        at java.io.FileOutputStream.<init>(FileOutputStream.java:131)\n        at\norg.apache.catalina.manager.ManagerServlet.copyInternal(ManagerServlet.java:1570)\n        at org.apache.catalina.manager.ManagerServlet.copy(ManagerServlet.java:1530)\n        at\norg.apache.catalina.manager.ManagerServlet.deploy(ManagerServlet.java:803)\n        at\norg.apache.catalina.manager.HTMLManagerServlet.deployInternal(HTMLManagerServlet.java:249)\n        at\norg.apache.catalina.manager.HTMLManagerServlet.doGet(HTMLManagerServlet.java:96)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:690)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:803)\n        at\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)\n        at\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)\n        at\norg.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:228)\n        at\norg.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)\n        at\norg.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:525)\n        at\norg.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:128)\n        at\norg.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:105)\n        at\norg.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n        at\norg.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:212)\n        at\norg.apache.coyote.http11.Http11Processor.process(Http11Processor.java:818)\n        at\norg.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:624)\n        at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:445)\n        at java.lang.Thread.run(Thread.java:613)\n\nI did checked and noticed apache-tomcat-6.0.2/conf/Catalina directory no longer\nexists in version 6. Did something changed?','2007-01-04 07:42:41','Zemian Deng','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','d721522','Remy Maucherat','2007-04-05 09:22:17','- 41289: create configBase, since it is no longer created elsewhere. - Submitted by Shiva Kumar H R.','java/org/apache/catalina/manager/ManagerServlet.java'),(2189,41973,'Bug 41973 – IPv6 APR Connectors assumes IPv4-mapped IPv6 address support','','2007-03-28 11:13:03','Kurt Miller','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Native','Library','P2 normal','8980bfd','Mladen Turk','2007-04-03 06:47:06','Fix #41973 by not initializing IPV6 if address is null. APR cannot listen both on IPV4 and IPV6 on some platforms (e.g BSD and Windows).','java/org/apache/tomcat/util/net/AprEndpoint.java'),(2190,41973,'Bug 41973 – IPv6 APR Connectors assumes IPv4-mapped IPv6 address support','','2007-03-28 11:13:03','Kurt Miller','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Native','Library','P2 normal','27928b3','Mladen Turk','2007-04-03 06:45:51','Fix #41973 by not initializing IPV6 if address is null. APR cannot listen both on IPV4 and IPV6 on some platforms (e.g BSD and Windows).','java/org/apache/tomcat/util/net/AprEndpoint.java'),(2191,41786,'Bug 41786 – bin/catalina.sh inconsistently references CATALINA_HOME and CATALINA_BASE for logging configuration','This issue is fixed with:\n\n--- catalina.sh.orig    2007-02-13 08:04:44.000000000 -0500\n+++ catalina.sh 2007-03-07 09:54:31.488965000 -0500\n@@ -162,7 +162,7 @@\n fi\n\n # Set juli LogManager if it is present\n-if [ -r \"$CATALINA_HOME\"/conf/logging.properties ]; then\n+if [ -r \"$CATALINA_BASE\"/conf/logging.properties ]; then\n   JAVA_OPTS=\"$JAVA_OPTS\n\"-Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager\"\n\"-Djava.util.logging.config.file=\"$CATALINA_BASE/conf/logging.properties\"\n fi','2007-03-07 09:06:50','Mike Hanafey','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P4 minor','bd3dfdb','Filip Hanik','2007-03-27 03:10:29','fix 41786','bin/catalina.bat\nbin/catalina.sh\nwebapps/docs/changelog.xml'),(2192,41703,'Bug 41703 – Variable assigned with it\'s own value.','','2007-02-26 02:18:39','Nils Hammar','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','2049b78','Filip Hanik','2007-03-27 02:58:27','Fixed 41703','java/org/apache/catalina/ha/authenticator/SingleSignOnMessage.java\nwebapps/docs/changelog.xml'),(2193,41682,'Bug 41682 – ClassCastException with BackupManager + debug logging','(Still happening in 6.0.9, though that isn\'t an option in Bugzilla)\n\nIf I use the BackupManager for session replication AND turn on debug logging, I\nget this exception when I try to invalidate the session:\n\njava.lang.ClassCastException: org.apache.catalina.ha.session.BackupManager\ncannot be cast to org.apache.catalina.ha.session.DeltaManager\n	at org.apache.catalina.ha.session.DeltaSession.expire(DeltaSession.java:361)\n	at org.apache.catalina.ha.session.DeltaSession.expire(DeltaSession.java:352)\n	at org.apache.catalina.session.StandardSession.expire(StandardSession.java:660)\n	at\norg.apache.catalina.session.StandardSession.invalidate(StandardSession.java:1112)\n	at\norg.apache.catalina.session.StandardSessionFacade.invalidate(StandardSessionFacade.java:150)\n\nThe bug is easy to find in the source.  If debug logging is enabled, it tries to\ncast manager to DeltaManager without an instanceof, even though it is doing an\ninstanceof immediately after:\n\n    public void expire(boolean notify, boolean notifyCluster) {\n        String expiredId = getIdInternal();\n        super.expire(notify);\n\n        if (notifyCluster) {\n            if (log.isDebugEnabled())\n                log.debug(sm.getString(\"deltaSession.notifying\",\n                                       ((DeltaManager)manager).getName(),\n                                       new Boolean(isPrimarySession()),\n                                       expiredId));\n            if ( manager instanceof DeltaManager ) {\n                ( (DeltaManager) manager).sessionExpired(expiredId);\n            }\n        }\n    }','2007-02-22 13:05:50','Graham Johnson','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','12d912d','Filip Hanik','2007-03-27 02:52:10','fix 41682','java/org/apache/catalina/ha/session/DeltaSession.java\nwebapps/docs/changelog.xml'),(2194,41166,'Bug 41166 – Unable to start ReplicatedContext','I try to test the Cluster function. I got a problem: something like following \napears in the $CATALINA_HOME/logs/catalina.out\n\nSEVERE: Unable to start ReplicatedContext\njava.lang.ClassCastException: org.apache.naming.resources.ProxyDirContext \ncannot be cast to java.io.Serializable\n        at \norg.apache.catalina.tribes.tipis.AbstractReplicatedMap$MapEntry.setValue\n(AbstractReplicatedMap.java:1060)\n\nI didn\'t change any file in $CATALINA_HOME except server.xml, the any thing I \nchanged in server.xml is uncomment the line: \n<Cluster className=\"org.apache.catalina.ha.tcp.SimpleTcpCluster\"/>. \n\nand I add a context configuration file test.xml to \n$CATALINA_HOME/conf/Catalina/localhost with the flolling content\n\n[Aray@BONC-01 conf]$ cat Catalina/localhost/test.xml\n<Context\n        className=\"org.apache.catalina.ha.context.ReplicatedContext\"\n        path=\"/test\" docBase=\"/var/www/ClusterTest\"\n        debug=\"0\" privileged=\"true\" reloadable=\"true\"\n>\n\nthe web.xml file in /var/www/ClusterTest has no <distributable/> element \n\n\nI am worrying about I can\'t explain the problem clearly with my poor English. \nSo I paste the stepes I do as following:\n\n[Aray@BONC-01 apache-tomcat-6.0.2]$ which java\n/usr/java/jdk1.6.0/bin/java\n[Aray@BONC-01 apache-tomcat-6.0.2]$ java -version\njava version \"1.6.0-rc\"\nJava(TM) SE Runtime Environment (build 1.6.0-rc-b104)\nJava HotSpot(TM) Client VM (build 1.6.0-rc-b104, mixed mode, sharing)\n[Aray@BONC-01 apache-tomcat-6.0.2]$ echo $JAVA_HOME\n/usr/java/jdk1.6.0\n[Aray@BONC-01 apache-tomcat-6.0.2]$ echo $CLASSPATH\n\n[Aray@BONC-01 apache-tomcat-6.0.2]$ uname -a\nLinux BONC-01 2.6.9-34.EL #1 Wed Mar 8 00:07:35 CST 2006 i686 i686 i386 \nGNU/Linux\n[root@BONC-01 local]# cat /etc/redhat-release\nCentOS release 4.3 (Final)\n[Aray@BONC-01 apache-tomcat-6.0.2]$ cd conf\n[Aray@BONC-01 conf]$ cat server.xml\n<!-- Note:  A \"Server\" is not itself a \"Container\", so you may not\n     define subcomponents such as \"Valves\" at this level.\n     Documentation at /docs/config/server.html\n -->\n<Server port=\"8005\" shutdown=\"SHUTDOWN\">\n\n  <!--APR library loader. Documentation at /docs/apr.html -->\n  <Listener className=\"org.apache.catalina.core.AprLifecycleListener\" \nSSLEngine=\"on\" />\n  <!--Initialize Jasper prior to webapps are loaded. Documentation \nat /docs/jasper-howto.html -->\n  <Listener className=\"org.apache.catalina.core.JasperListener\" />\n  <!-- JMX Support for the Tomcat server. Documentation at /docs/non-\nexistent.html -->\n  <Listener className=\"org.apache.catalina.mbeans.ServerLifecycleListener\" />\n  <Listener \nclassName=\"org.apache.catalina.mbeans.GlobalResourcesLifecycleListener\" />\n\n  <!-- Global JNDI resources\n       Documentation at /docs/jndi-resources-howto.html\n  -->\n  <GlobalNamingResources>\n    <!-- Editable user database that can also be used by\n         UserDatabaseRealm to authenticate users\n    -->\n    <Resource name=\"UserDatabase\" auth=\"Container\"\n              type=\"org.apache.catalina.UserDatabase\"\n              description=\"User database that can be updated and saved\"\n              factory=\"org.apache.catalina.users.MemoryUserDatabaseFactory\"\n              pathname=\"conf/tomcat-users.xml\" />\n  </GlobalNamingResources>\n\n  <!-- A \"Service\" is a collection of one or more \"Connectors\" that share\n       a single \"Container\" Note:  A \"Service\" is not itself a \"Container\",\n       so you may not define subcomponents such as \"Valves\" at this level.\n       Documentation at /docs/config/service.html\n   -->\n  <Service name=\"Catalina\">\n\n    <!-- A \"Connector\" represents an endpoint by which requests are received\n         and responses are returned. Documentation at :\n         Java HTTP Connector: /docs/config/http.html (blocking & non-blocking)\n         Java AJP  Connector: /docs/config/ajp.html\n         APR (HTTP/AJP) Connector: /docs/apr.html\n         Define a non-SSL HTTP/1.1 Connector on port 8080\n    -->\n    <Connector port=\"8080\" protocol=\"HTTP/1.1\"\n               maxThreads=\"150\" connectionTimeout=\"20000\"\n               redirectPort=\"8443\" />\n\n    <!-- Define a SSL HTTP/1.1 Connector on port 8443\n         This connector uses the JSSE configuration, when using APR, the\n         connector should be using the OpenSSL style configuration\n         described in the APR documentation -->\n    <!--\n    <Connector port=\"8443\" protocol=\"HTTP/1.1\"\n               maxThreads=\"150\" scheme=\"https\" secure=\"true\"\n               clientAuth=\"false\" sslProtocol=\"TLS\" />\n    -->\n\n    <!-- Define an AJP 1.3 Connector on port 8009 -->\n    <Connector port=\"8009\" protocol=\"AJP/1.3\" redirectPort=\"8443\" />\n\n\n    <!-- An Engine represents the entry point (within Catalina) that processes\n         every request.  The Engine implementation for Tomcat stand alone\n         analyzes the HTTP headers included with the request, and passes them\n         on to the appropriate Host (virtual host).\n         Documentation at /docs/config/engine.html -->\n\n    <!-- You should set jvmRoute to support load-balancing via AJP ie :\n    <Engine name=\"Standalone\" defaultHost=\"localhost\" jvmRoute=\"jvm1\">\n    -->\n    <Engine name=\"Catalina\" defaultHost=\"localhost\">\n\n      <!--For clustering, please take a look at documentation at:\n          /docs/cluster-howto.html  (simple how to)\n          /docs/config/cluster.html (reference documentation) -->\n\n      <Cluster className=\"org.apache.catalina.ha.tcp.SimpleTcpCluster\"/>\n\n\n      <!-- The request dumper valve dumps useful debugging information about\n           the request and response data received and sent by Tomcat.\n           Documentation at: /docs/config/valve.html -->\n      <!--\n      <Valve className=\"org.apache.catalina.valves.RequestDumperValve\"/>\n      -->\n\n      <!-- This Realm uses the UserDatabase configured in the global JNDI\n           resources under the key \"UserDatabase\".  Any edits\n           that are performed against this UserDatabase are immediately\n           available for use by the Realm.  -->\n      <Realm className=\"org.apache.catalina.realm.UserDatabaseRealm\"\n             resourceName=\"UserDatabase\"/>\n\n      <!-- Define the default virtual host\n           Note: XML Schema validation will not work with Xerces 2.2.\n       -->\n      <Host name=\"localhost\"  appBase=\"webapps\"\n            unpackWARs=\"true\" autoDeploy=\"true\"\n            xmlValidation=\"false\" xmlNamespaceAware=\"false\">\n\n        <!-- SingleSignOn valve, share authentication between web applications\n             Documentation at: /docs/config/valve.html -->\n        <!--\n        <Valve className=\"org.apache.catalina.authenticator.SingleSignOn\" />\n        -->\n\n        <!-- Access log processes all example.\n             Documentation at: /docs/config/valve.html -->\n        <!--\n        <Valve className=\"org.apache.catalina.valves.FastCommonAccessLogValve\" \ndirectory=\"logs\"\n               prefix=\"localhost_access_log.\" suffix=\".txt\" pattern=\"common\" \nresolveHosts=\"false\"/>\n        -->\n\n      </Host>\n    </Engine>\n  </Service>\n</Server>\n\n[Aray@BONC-01 conf]$ mkdir Catalina\n[Aray@BONC-01 conf]$ ln -s /usr/local/tomcatConf/localhost/ Catalina/localhost\n[Aray@BONC-01 conf]$ cat Catalina/localhost/test.xml\n<Context\n        className=\"org.apache.catalina.ha.context.ReplicatedContext\"\n        path=\"/test\" docBase=\"/var/www/ClusterTest\"\n        debug=\"0\" privileged=\"true\" reloadable=\"true\"\n>\n</Context>\n[Aray@BONC-01 conf]$ cd ..\n[Aray@BONC-01 apache-tomcat-6.0.2]$ ls\nbin  conf  lib  LICENSE  logs  NOTICE  RELEASE-NOTES  RUNNING.txt  temp  \nwebapps  work\n[Aray@BONC-01 apache-tomcat-6.0.2]$ rm logs/*\n[Aray@BONC-01 apache-tomcat-6.0.2]$ bin/catalina.sh version\nUsing CATALINA_BASE:   /home/Aray/download/apache-tomcat-6.0.2\nUsing CATALINA_HOME:   /home/Aray/download/apache-tomcat-6.0.2\nUsing CATALINA_TMPDIR: /home/Aray/download/apache-tomcat-6.0.2/temp\nUsing JRE_HOME:       /usr/java/jdk1.6.0\nServer version: Apache Tomcat/6.0.2\nServer built:   Nov 16 2006 12:31:06\nServer number:  6.0.2.0\nOS Name:        Linux\nOS Version:     2.6.9-34.EL\nArchitecture:   i386\nJVM Version:    1.6.0-rc-b104\nJVM Vendor:     Sun Microsystems Inc.\n[Aray@BONC-01 apache-tomcat-6.0.2]$ bin/startup.sh\nUsing CATALINA_BASE:   /home/Aray/download/apache-tomcat-6.0.2\nUsing CATALINA_HOME:   /home/Aray/download/apache-tomcat-6.0.2\nUsing CATALINA_TMPDIR: /home/Aray/download/apache-tomcat-6.0.2/temp\nUsing JRE_HOME:       /usr/java/jdk1.6.0\n[Aray@BONC-01 apache-tomcat-6.0.2]$ cat logs/catalina.out\nINFO: Initializing Coyote HTTP/1.1 on http-8080\nDec 13, 2006 4:07:39 PM org.apache.catalina.startup.Catalina load\nINFO: Initialization processed in 2532 ms\nDec 13, 2006 4:07:40 PM org.apache.catalina.core.StandardService start\nINFO: Starting service Catalina\nDec 13, 2006 4:07:40 PM org.apache.catalina.core.StandardEngine start\nINFO: Starting Servlet Engine: Apache Tomcat/6.0.2\nDec 13, 2006 4:07:40 PM org.apache.catalina.ha.tcp.SimpleTcpCluster start\nINFO: Cluster is about to start\nDec 13, 2006 4:07:40 PM org.apache.catalina.tribes.transport.ReceiverBase bind\nINFO: Receiver Server Socket bound to:/127.0.0.1:4000\nDec 13, 2006 4:07:40 PM org.apache.catalina.tribes.membership.McastServiceImpl \nsetupSocket\nINFO: Setting cluster mcast soTimeout to 500\nDec 13, 2006 4:07:40 PM org.apache.catalina.tribes.membership.McastServiceImpl \nwaitForMembers\nINFO: Sleeping for 1000 milliseconds to establish cluster membership, start \nlevel:4\nDec 13, 2006 4:07:41 PM org.apache.catalina.tribes.membership.McastServiceImpl \nwaitForMembers\nINFO: Done sleeping, membership established, start level:4\nDec 13, 2006 4:07:41 PM org.apache.catalina.tribes.membership.McastServiceImpl \nwaitForMembers\nINFO: Sleeping for 1000 milliseconds to establish cluster membership, start \nlevel:8\nDec 13, 2006 4:07:42 PM org.apache.catalina.tribes.membership.McastServiceImpl \nwaitForMembers\nINFO: Done sleeping, membership established, start level:8\nDec 13, 2006 4:07:42 PM org.apache.catalina.core.StandardHost start\nINFO: XML validation disabled\nDec 13, 2006 4:07:42 PM org.apache.catalina.tribes.tipis.AbstractReplicatedMap \ninit\nINFO: Initializing AbstractReplicatedMap with context name:/test\nDec 13, 2006 4:07:43 PM org.apache.catalina.ha.context.ReplicatedContext start\nSEVERE: Unable to start ReplicatedContext\njava.lang.ClassCastException: org.apache.naming.resources.ProxyDirContext \ncannot be cast to java.io.Serializable\n        at \norg.apache.catalina.tribes.tipis.AbstractReplicatedMap$MapEntry.setValue\n(AbstractReplicatedMap.java:1060)\n        at \norg.apache.catalina.tribes.tipis.AbstractReplicatedMap$MapEntry.<init>\n(AbstractReplicatedMap.java:1005)\n        at org.apache.catalina.tribes.tipis.AbstractReplicatedMap.put\n(AbstractReplicatedMap.java:859)\n        at org.apache.catalina.core.ApplicationContext.setAttribute\n(ApplicationContext.java:756)\n        at org.apache.catalina.core.ApplicationContextFacade.setAttribute\n(ApplicationContextFacade.java:334)\n        at org.apache.catalina.core.StandardContext.start\n(StandardContext.java:4296)\n        at org.apache.catalina.ha.context.ReplicatedContext.start\n(ReplicatedContext.java:55)\n        at org.apache.catalina.core.ContainerBase.addChildInternal\n(ContainerBase.java:760)\n        at org.apache.catalina.core.ContainerBase.addChild\n(ContainerBase.java:740)\n        at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:525)\n        at org.apache.catalina.startup.HostConfig.deployDescriptor\n(HostConfig.java:626)\n        at org.apache.catalina.startup.HostConfig.deployDescriptors\n(HostConfig.java:553)\n        at org.apache.catalina.startup.HostConfig.deployApps\n(HostConfig.java:488)\n        at org.apache.catalina.startup.HostConfig.start(HostConfig.java:1138)\n        at org.apache.catalina.startup.HostConfig.lifecycleEvent\n(HostConfig.java:311)\n        at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent\n(LifecycleSupport.java:120)\n        at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1022)\n        at org.apache.catalina.core.StandardHost.start(StandardHost.java:719)\n        at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1014)\n        at org.apache.catalina.core.StandardEngine.start\n(StandardEngine.java:443)\n        at org.apache.catalina.core.StandardService.start\n(StandardService.java:451)\n        at org.apache.catalina.core.StandardServer.start\n(StandardServer.java:710)\n        at org.apache.catalina.startup.Catalina.start(Catalina.java:552)\n        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n        at sun.reflect.NativeMethodAccessorImpl.invoke\n(NativeMethodAccessorImpl.java:39)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke\n(DelegatingMethodAccessorImpl.java:25)\n        at java.lang.reflect.Method.invoke(Method.java:597)\n        at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:288)\n        at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:413)\nDec 13, 2006 4:07:43 PM org.apache.catalina.core.ContainerBase addChildInternal\nSEVERE: ContainerBase.addChild: start:\nLifecycleException:  Failed to start ReplicatedContext:  \njava.lang.ClassCastException: org.apache.naming.resources.ProxyDirContext \ncannot be cast to java.io.Serializable\n        at org.apache.catalina.ha.context.ReplicatedContext.start\n(ReplicatedContext.java:58)','2006-12-13 00:18:02','Aray','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','4f96d21','Filip Hanik','2007-03-27 00:44:06','fixes for http://issues.apache.org/bugzilla/show_bug.cgi?id=41166 although there is still work to be done, need to separate Tomcat attributes vs. application attributes','java/org/apache/catalina/core/ApplicationContext.java\njava/org/apache/catalina/ha/context/ReplicatedContext.java\njava/org/apache/catalina/tribes/tipis/AbstractReplicatedMap.java'),(2195,41675,'Bug 41675 – Add a debug statement when some necessary header information is missing','Reference: org.apache.coyote.http11.Http11Processor.java\n\nIt would be helpful for developers to get informed when some required header\ninformation is missing. eg when headers.getValue(\"host\"); returns null and\nhttp11 is true.\n\nCouldn\'t you add a log.debug statement that informs the user about missing\nheader-fields? (For example in Http11Processor.java:1391)','2007-02-22 00:36:16','C','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Connector:Coyote','P2 enhancement','7fd4fa8','Yoav Shapira','2007-03-25 19:08:01','Bugzilla 41675: add a couple of DEBUG-level logging statements to Http11Processor.java when sending error responses.','java/org/apache/coyote/http11/Http11Processor.java\nwebapps/docs/changelog.xml'),(2196,41227,'Bug 41227 – When the jasper compiler fails to compile a JSP, it doesn\'t print the name of the file','When you precompile a large set of JSPs and the compile fails for a file, jspc\ndoesn\'t print the name of the file, so you have no idea which JSP is broken. All\nyou get is the name of the last *successfully* compiled JSP if you make it\nverbose (so the error is in the *next* file which isn\'t listed).\n\nEither print the name of each JSP as you compile it or print the name when you\nencounter an error.','2006-12-21 09:03:56','Aaron Digulla','Tomcat Developers Mailing List','RESOLVED WORKSFORME','Tomcat 5','Jasper','P3 enhancement','34fe5cf','Yoav Shapira','2007-03-25 18:46:46','Bugzilla 41227: add a bit of DEBUG-level logging to JspC so users know what file is being compiled.','java/org/apache/jasper/JspC.java\nwebapps/docs/changelog.xml'),(2197,40150,'Bug 40150 – Incorrect User/Role classnames are silently ignored.','org.apache.catalina.realm.JAASRealm does not verify any of the class names that\nare set through setRoleClassNames() and setUserClassNames().\n\nIf an incorrect class name (e.g. a typo) is configured in context.xml, this is\nunnoticed by JAASRealm. The result is that during authentication, when the\nsubject\'s principals are checked against the configured class names, the\nprincipals are not recognised, and therefore not added to the subject.\n\nThe fact an incorrect configured class name is currently not detected and logged\nmakes it very hard to find the source of the problem. It can be easily fixed by\nchecking the class names in the two methods mentioned above. The class must\nexist, and it must implement java.security.Principal, which is currently not\nenforced/checked by the code.','2006-08-01 08:52:32','Tom','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 blocker','400d684','Yoav Shapira','2007-03-25 17:42:05','Bugzilla 40150: validate user and role classes in JAASRealm.  While I\'m there, typify the relevant lists of class names so that JDK 5+ doesn\'t complain about unchecked operations in this class.','build.xml\njava/org/apache/catalina/realm/JAASRealm.java\nwebapps/docs/changelog.xml'),(2198,39540,'Bug 39540 – Connectors Documentation Suggestion','As with the release of Apache 2.2.2 (on Windows as well), I suggest that\nmod_ajp_proxy be included in the valid list of connectors. (and perhaps\ndeprecating the use of mod_jk on the newer versions)\n\nIt makes configuration of AJP13 support very easy on httpd:\n\n<IfModule proxy_module>\n<IfModule proxy_ajp_module>\nProxyRequests On\nProxyPass /tomcatmanual ajp://localhost:8009/tomcat-docs\n</IfModule>\n</IfModule>','2006-05-10 03:59:03','V. Karthik Kumar','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Webapps:Documentation','P5 enhancement','6c812a3','Yoav Shapira','2007-03-25 17:21:29','Bugzilla 39540: add link to mod_proxy_ajp httpd config docs.','webapps/docs/changelog.xml\nwebapps/docs/config/ajp.xml'),(2199,39883,'Bug 39883 – using antiResourceLocking in context.xml outside of webapp dir causes app delete on shutdown','I have an application installed at c:\\speechapps\\Application_1\n\ncontaining a META-INF with context.xml.  In the context.xml I have \nreloadable=\"false\" antiJarLocking=\"true\" and antiResourceLocking=\"true\" \nalongiwth the standard docBase and path.  No other entries are present.  If I \nuse the manager interface I can install the application and it works fine.  If \nI then shutdown tomcat gracefully, the application is completely deleted from \nthe file system.  The context from the /conf/Catalina/localhost is not \ndeleted.  On start of tomcat the application is not loaded (since it has been \ndeleted from the file system).  If I use the antiResourceLocking=true in the \nwebapps directory it does not delete the application content only when used \noutside of webapps.  \n\nTo work around this I removed the antiResourceLocking from the context.xml.  \nThis seems to resolve the issue for now.  This may be a good addition to the \ndocs somewhere.','2006-06-23 15:19:41','Jeff Macomber','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','3208a3d','Yoav Shapira','2007-03-25 11:44:59','Bugzilla 39883: add documentation warning about the use of antiResourceLocking on a webapp that\'s outside th Host\'s appBase.','webapps/docs/changelog.xml\nwebapps/docs/config/context.xml'),(2200,41790,'Bug 41790 – JDTCompiler::getContents does not close the reader','In the class org.apache.jasper.compiler.JDTCompiler:\n-------------------------------------------------------------------------\npublic char[] getContents() {\n                char[] result = null;\n                try {\n                    InputStreamReader isReader =\n                        new InputStreamReader(new FileInputStream(sourceFile),\n                                ctxt.getOptions().getJavaEncoding());\n                    Reader reader = new BufferedReader(isReader);\n                    if (reader != null) {\n                        char[] chars = new char[8192];\n                        StringBuffer buf = new StringBuffer();\n                        int count;\n                        while ((count = reader.read(chars, 0, \n                                                    chars.length)) > 0) {\n                            buf.append(chars, 0, count);\n                        }\n                        result = new char[buf.length()];\n                        buf.getChars(0, result.length, result, 0);\n                    }\n                } catch (IOException e) {\n                    log.error(\"Compilation error\", e);\n                }\n                return result;\n            }\n-------------------------------------------------------------------------\nthe variable \"reader\" is not closed after use it. if I update jsp files \nfrequently, it will exhaust the system file handler. \"too many files\" errors \nwill come.\n\nI test it on Redhat linux, the same problem will occured in tomcat 5 and tomcat \n6.','2007-03-07 19:02:57','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 normal','455b6f8','Remy Maucherat','2007-03-08 11:02:35','- 41790: close file stream.','java/org/apache/jasper/compiler/JDTCompiler.java'),(2201,41747,'Bug 41747 – error in ant task description','Wrong description of ant task \'deploy\': Instead of\n   ... war=\"${build}${path}.war\"/>\nshould be written\n   ... war=\"file:${build}${path}.war\"/>','2007-03-02 06:08:59','Ingolf Knopf','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Webapps:Documentation','P2 trivial','e4569e6','Mark Emlyn David Thomas','2007-03-04 22:05:49','Port fix for bug 41747. Correct minor error in ant script example for deploy.','webapps/docs/changelog.xml\nwebapps/docs/manager-howto.xml'),(2202,41752,'Bug 41752 – Wrong message on exception in MemoryRealm','When Digester read tomcat-user.xml file and exception is throw, then is created\nnew LifecycleException. As first parameter of this Exception is message string.\nThis string is hardcoded to \"memoryRealm.readXml\", so I thing that log message\nwill be wrong too!\n\nI think that there must be used StringManager.\n\nactual implementation:\n\nDigester digester = getDigester();\ntry {\n  synchronized (digester) {\n    digester.push(this);\n    digester.parse(file);\n  }\n} \ncatch (Exception e) {\n  throw new LifecycleException(\"memoryRealm.readXml\", e);\n} \nfinally {\n  digester.reset();\n}\n\n\nfixed:\n\nDigester digester = getDigester();\ntry {\n  synchronized (digester) {\n    digester.push(this);\n    digester.parse(file);\n  }\n} \ncatch (Exception e) {\n  throw new LifecycleException(sm.getString(\"memoryRealm.readXml\"), e);\n} \nfinally {\n  digester.reset();\n}','2007-03-02 16:28:19','Ales Milan','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','e33b67a','Mark Emlyn David Thomas','2007-03-03 11:24:08','Port fix for bug 41752. Correct error message on exception in MemoryRealm. Patch provided by Ales Milan.','java/org/apache/catalina/realm/MemoryRealm.java\nwebapps/docs/changelog.xml'),(2203,41655,'Bug 41655 – Some variable informations are not output in some languages.','I noticed that some variable informations are not output to the log in some \nlocales.\n\nIt is because the variable informations has not been described to the \nproperties file, though the value is given by the argument of \nStringManager#getString. \n\n-org.apache.catalina.startup.LocalStrings_fr.properties\n                             LocalStrings_es.properties\n                             LocalStrings_ja.properties\n key:\n    contextConfig.applicationParse  ... {0} not exists.\n    contextConfig.tldEntryException ... {2} not exists.\n    contextConfig.tldFileException  ... {1} not exists.\n    contextConfig.tldJarException   ... {1} not exists.\n\n-org.apache.jasper.resources.LocalStrings_ja.properties\n key:\n    jsp.error.bad.scratch.dir  ... {0} not exists.\n\nI hope for them to be written in the properties files to debug applications \neasily.','2007-02-19 04:44:01','Suzuki Yuichiro','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P5 trivial','4d3f6a8','Mark Emlyn David Thomas','2007-03-03 11:12:41','Port partial fix for bug 41655. Update some of the translations and fix a few obvious typos.','java/org/apache/catalina/startup/LocalStrings_es.properties\njava/org/apache/catalina/startup/LocalStrings_fr.properties'),(2204,41666,'Bug 41666 – If-Unmodified-Since failure','The If-Unmodified-Since header doesn\'t work enoughly.\n\nfailed case:\n The If-Unmodified-Since header value: 1000000(milliseconds)\n The lastModified value of target resource: 1001000(milliseconds)\n\nIn this case, the response\'s status code should be SC_PRECONDITION_FAILED,\nbut the result is not so.\n\ncaused by:\nIn DefaultServlet#checkIfUnmodifiedSince:\n    if ( lastModified > (headerValue + 1000)) {\n\nI think it should be:\n    if ( lastModified >= (headerValue + 1000)) {','2007-02-21 01:44:28','Suzuki Yuichiro','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P4 minor','9ac3428','Mark Emlyn David Thomas','2007-03-03 11:03:11','Port fix for bug 41666. Correct handling of boundary conditions for If-Unmodified-Since and If-Modified-Since headers. Patch provided by Suzuki Yuichiro.','java/org/apache/catalina/servlets/DefaultServlet.java\nwebapps/docs/changelog.xml'),(2205,41739,'Bug 41739 – The servlet with the value 0 in <load-on-startup> tag must be loaded at first.','Servlet 2.4 specification says:\n---\nIf the value is a positive integer or 0, the container must load\nand initialize the servlet as the application is deployed. \nThe container must guarantee that servlets marked with lower integers\nare loaded before servlets marked with higher integers.\n---\nI think the servlet with value 0 in <load-on-startup> tag must be loaded at the \nfirst.\n\nHowever, Tomcat loads the servlet at the last.','2007-03-01 06:09:41','Suzuki Yuichiro','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P3 normal','01d38a5','Mark Emlyn David Thomas','2007-03-01 21:38:26','Port fix for bug 41739. Servlets with a load-on-startup value of zero should be loaded first.','java/org/apache/catalina/core/StandardContext.java\nwebapps/docs/changelog.xml'),(2206,41608,'Bug 41608 – The log level is different at same messages.','I suggest a little message improvement.\n\nThe log level is different at same messages.\nThe message \"Servlet.service() for servlet {0} threw exception\" is \noutput in eight places, but the message level is not same.\n\n--org.apache.catalina.core.ApplicationDispatcher#invoke\n...\nwrapper.getLogger().error(sm.getString(\"applicationDispatcher.serviceException\",\n    wrapper.getName()), e);\n...\nwrapper.getLogger().error(sm.getString(\"applicationDispatcher.serviceException\",\n    wrapper.getName()), e);\n...\nwrapper.getLogger().error(sm.getString(\"applicationDispatcher.serviceException\",\n    wrapper.getName()), rootCause);\n...\nwrapper.getLogger().error(sm.getString(\"applicationDispatcher.serviceException\",\n    wrapper.getName()), e);\n\n\n--org.apache.catalina.core.StandardWrapperValve#invoke\ncontainer.getLogger().warn(sm.getString(\"standardWrapper.serviceException\",\n    wrapper.getName()), e);\n...\ncontainer.getLogger().warn(sm.getString(\"standardWrapper.serviceException\",\n    wrapper.getName()), e);\n...\ncontainer.getLogger().error(sm.getString(\"standardWrapper.serviceException\",\n    wrapper.getName()), rootCause);\n...\ncontainer.getLogger().error(sm.getString(\"standardWrapper.serviceException\",\n    wrapper.getName()), e);\n\nAre there any reasons for using getLogger().warn()?\nI think it would be better that all of them use getLogger().error(...).','2007-02-13 21:45:29','Suzuki Yuichiro','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P5 trivial','8ba8334','Mark Emlyn David Thomas','2007-02-15 22:09:39','Port fix bug 41608. Make log levels consistent.','java/org/apache/catalina/core/StandardWrapperValve.java\nwebapps/docs/changelog.xml'),(2207,41578,'Bug 41578 – Avoid SimplePool.get/put synchronization in JspFactoryImpl','Only 1 instance of the JspFactory object (JspFactoryImpl) is created.\nConsequently there is a single SimplePool of PageContext objects for all JSP\nrequests and so every JSP request must synchronize on the lock inside SimplePool\nwhen getting and releasing a PageContext instance. Moreover, the pool has a\nfixed capacity and after that, the code in JspFactoryImpl will first acquire the\nlock to see if there are any free objects in the pool, failing which a new\nPageContext object is created.\n\nInstead of a single process-wide pool, a per thread pool of PageContext objects\ncan be used by JspFactoryImpl.','2007-02-09 00:00:43','Arvind Srinivasan','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P4 enhancement','4612c8a','Remy Maucherat','2007-02-09 21:19:57','- As suggested in 41578, experiment with a thread local pool, but in a simpler way (and with an upper bound).','java/org/apache/jasper/runtime/JspFactoryImpl.java'),(2208,41558,'Bug 41558 – Unnecessary synchronization caused by JspFactory.getDefaultFactory while servicing JSPs','Tomcat version: 6.0.x trunk\n\nEvery generated JSP has \n\n    try {\n      _jspxFactory = JspFactory.getDefaultFactory();\n      response.setContentType(\"text/html\");\n\nin its _jspService method.\n\nThe use of JspFactory.getDefaultFactory during request processing should be\navoided as it is a *static synchronized* method.\n\nI have a diff that addresses this and will attach it to this bug.','2007-02-07 06:03:18','Arvind Srinivasan','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P4 enhancement','1a8c492','Remy Maucherat','2007-02-07 17:55:21','- 41558: Don\'t call synced method on every request, submitted by Arvind Srinivasan.','java/org/apache/jasper/compiler/Generator.java\njava/org/apache/jasper/compiler/JspRuntimeContext.java\njava/org/apache/jasper/runtime/HttpJspBase.java'),(2209,41521,'Bug 41521 – filter-mapping doesn\'t support * for servlet-name','SRV 6.2.5 of the servlet 2.5 spec introduces support for \'*\' as the servlet-name\nin a filter-mapping.  TC6 does not currently support that value as specified. I\nwill attach a patch shortly.','2007-02-01 14:18:55','Paul McMahan','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 normal','8b0d130','Remy Maucherat','2007-02-07 17:53:07','- 41521: Support * for servlet-name, submitted by Paul McMahan.','java/org/apache/catalina/core/ApplicationFilterFactory.java\njava/org/apache/catalina/deploy/FilterMap.java'),(2210,39088,'Bug 39088 – StandardWrapper getRootCause() infinite loop','The \"// Extra aggressive rootCause finding\" in StandardWrapper.java is an\nunderstatement.  It causes an infinite loop in certain cases.  For example, the\nsemantics of the following exception class are that getRootCause() returns the\none and only root cause of the exception chain, which in this case can be the\nexception itself.  It is not derived from ServletException, thus is not bound to\nreturn null at the end of the chain as ServletException does.  Its not safe to\nuse reflection to call an arbitrary method of an arbitrary Exception class, just\nbecause it happens to have the same name as the method in ServletException.\n\npublic class MyException \n   extends Exception\n{\n   public MyException(Throwable cause) {\n      this.cause = cause;\n   }\n   Throwable cause;\n   public Throwable getCause() {\n      return cause;\n   }\n   public Throwable getRootCause() {\n      if (cause instanceof VCOMException) {\n         return ((VCOMException) exception).getRootCause();\n      }\n      return cause == null ? this : cause;\n   }\n}','2006-03-23 21:02:08','Jonathan Leech','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P3 minor','4fcdec3','Mark Emlyn David Thomas','2007-01-28 20:45:06','Revert port of 39088 as per discussion on dev list.','java/org/apache/catalina/core/StandardWrapper.java\njava/org/apache/catalina/valves/ErrorReportValve.java\nwebapps/docs/changelog.xml'),(2211,41466,'Bug 41466 – NIO Connector: IllegalArgumentException: You can only write using the application write buffer provided by the handler','Trying to use NIO connector instead of APR connector using Tomcat6 HEAD, I get\nan IllegalArgumentException while in a call to sendAck.  \n\nLooking at InternalNioOutputBuffer.sendAck(), it uses ByteBuffer.wrap() to\ncreate a new ByteBuffer and uses this ByteBuffer in a call to writeToSocket.\nThere is a check in SecureNioChannel.write() that the ByteBuffer is the one\nstored in the \n\nCommenting the line 372 in SecureNioChannel.java fixes the problem.\n//if ( src != bufHandler.getWriteBuffer() ) throw new\nIllegalArgumentException(\"You can only write using the application write buffer\nprovided by the handler.\");\nBut I guess that the check is here for a valid reason, and a better fix would\nvery likely consist in fixing the sendAck or in adding an \"or\" condition to the\ntest for the case of sendAck().\n\nGRAVE: Cannot find message associated with key standardWrapper.acknowledgeException\njava.lang.IllegalArgumentException: You can only write using the application\nwrite buffer provided by the handler.\n	at org.apache.tomcat.util.net.SecureNioChannel.write(SecureNioChannel.java:372)\n	at org.apache.tomcat.util.net.NioSelectorPool.write(NioSelectorPool.java:111)\n	at\norg.apache.coyote.http11.InternalNioOutputBuffer.writeToSocket(InternalNioOutputBuffer.java:434)\n	at\norg.apache.coyote.http11.InternalNioOutputBuffer.sendAck(InternalNioOutputBuffer.java:418)\n	at org.apache.coyote.http11.Http11NioProcessor.action(Http11NioProcessor.java:1028)\n	at org.apache.coyote.Response.action(Response.java:183)\n	at org.apache.coyote.Response.acknowledge(Response.java:310)\n	at org.apache.catalina.connector.Response.sendAcknowledgement(Response.java:1154)\n	at\norg.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:169)\n	at\norg.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)\n	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:128)\n	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:105)\n	at\norg.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)\n	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:212)\n	at org.apache.coyote.http11.Http11NioProcessor.process(Http11NioProcessor.java:888)\n	at\norg.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler.process(Http11NioProtocol.java:624)\n	at org.apache.tomcat.util.net.NioEndpoint$Worker.run(NioEndpoint.java:1467)\n	at java.lang.Thread.run(Thread.java:595)','2007-01-25 09:12:11','Christophe Pierret','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 major','fce171f','Filip Hanik','2007-01-28 16:35:53','Fix for bugzilla 41466 When using the NioChannel and SecureNioChannel its important to use the channels buffers','java/org/apache/tomcat/util/net/NioSelectorPool.java'),(2212,39088,'Bug 39088 – StandardWrapper getRootCause() infinite loop','The \"// Extra aggressive rootCause finding\" in StandardWrapper.java is an\nunderstatement.  It causes an infinite loop in certain cases.  For example, the\nsemantics of the following exception class are that getRootCause() returns the\none and only root cause of the exception chain, which in this case can be the\nexception itself.  It is not derived from ServletException, thus is not bound to\nreturn null at the end of the chain as ServletException does.  Its not safe to\nuse reflection to call an arbitrary method of an arbitrary Exception class, just\nbecause it happens to have the same name as the method in ServletException.\n\npublic class MyException \n   extends Exception\n{\n   public MyException(Throwable cause) {\n      this.cause = cause;\n   }\n   Throwable cause;\n   public Throwable getCause() {\n      return cause;\n   }\n   public Throwable getRootCause() {\n      if (cause instanceof VCOMException) {\n         return ((VCOMException) exception).getRootCause();\n      }\n      return cause == null ? this : cause;\n   }\n}','2006-03-23 21:02:08','Jonathan Leech','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P3 minor','20f7a87','Mark Emlyn David Thomas','2007-01-27 19:55:24','Port fix bug 39088 that prevents infinite loops when an exception is thrown the returns itself for getRootCause(). Also port changes that enable the root cause to be found when the nesting is particularly extreme.','java/org/apache/catalina/core/StandardWrapper.java\njava/org/apache/catalina/valves/ErrorReportValve.java\nwebapps/docs/changelog.xml'),(2213,39572,'Bug 39572 – fixes to use CompressionFilter in WebSphere app server','There are a couple of small bugs in the compression filter classes that are\ntriggered by using the filter in WebSphere 5.1 or 6. Here are patches.\n\n- CompressionResponseStream should not compress the output stream if the\nresponse has been committed (because then it cannot write the Content-Encoding:\ngzip header, and the browser displays the compressed output as-is)\n- CompressionServletResponseWrapper causes a NullPointerException if you flush\nbefore writing anything','2006-05-12 22:28:57','Eric Hedstr','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Webapps:Examples','P3 normal','f06d41f','Mark Emlyn David Thomas','2007-01-27 18:07:51','Port fix bug 39572. Improvements to CompressionFilter provided by Eric Hedström. Also cleaned up unused imports and methods.','webapps/docs/changelog.xml\nwebapps/examples/WEB-INF/classes/compressionFilters/CompressionFilterTestServlet.java\nwebapps/examples/WEB-INF/classes/compressionFilters/CompressionResponseStream.java\nwebapps/examples/WEB-INF/classes/compressionFilters/CompressionServletResponseWrapper.java'),(2214,41265,'Bug 41265 – JspServlet\'s checkInterval parameter cannot be set to 0 implicitly','conf\\web.xml\'s JspServlet init parameters include \'checkInterval\', whose value\nis explained as follows:\n  If development is false and checkInterval is greater than zero, background\ncompilations are enabled.\n\nIf I add the following parameters one would think the background compilations\nwould be disabled (the value is not greater than zero).\n\n        <init-param>\n            <param-name>checkInterval</param-name>\n            <param-value>0</param-value>\n        </init-param>\n        <init-param>\n            <param-name>development</param-name>\n            <param-value>false</param-value>\n        </init-param>\n\nHowever, the value is changed to 300 and the following warning is outputted:\nDec 30, 2006 7:13:57 PM org.apache.jasper.EmbeddedServletOptions <init>\nWARNING: Warning: Invalid value for the initParam checkInterval. Will use the\ndefault value of \"300\" seconds\n\nAccording to the comment in web.xml \"0\" was a valid value. Either the comment or\nthe validity check is wrong. Or my understanding of them.','2006-12-30 02:34:23','Dies Koper','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P3 minor','39fe247','Mark Emlyn David Thomas','2007-01-27 17:56:47','Port fix bug 41265 by removing the code that resets checkInterval values of zero to 300. If checkInterval is not specified it defaults to zero anyway and removing the code was easier than trying to explain in the documentation why the stated default could not be explicitly set.','java/org/apache/jasper/EmbeddedServletOptions.java\nwebapps/docs/changelog.xml'),(2215,40526,'Bug 40526 – tomcat 5.5.17 catalina.bat - dropped support for JPDA_OPTS environment variable','We have upgraded from tomcat 4.1.18 to 5.5.17, and have found that our \nsystem start up process on Windows can no longer set jpda debugger \noptions on the tomcat java command line.\n\nThis occurs because the 5.5.17 catalina.bat file no longer supports \nthe environment variable $JPDA_OPTS, which our start up process used \nto use to place jpda information. What is interesting is that \ncatalina.sh STILL supports JPDA_OPTS. So we have this problem on windows only.\n\nIs this an intentional change?\n\nThe above comment was sent to tomcate users list. Mark Thomas responded:\n\nNot that I can tell. If you care to create a patch and submit it to bugzilla \nI\'ll take a look.\n\nI have made the fix, and I am sending it for approval. I have a zip file with \nthe correction, and the output of a diff -u on the original and corrected \nversion of the catalina.bat and the catalina.sh scripts. I do not see on this \nbug entry page any place to attach this zip file. Please let me know how I can \nsend the changes to the community.\n\nBelow is a summary of changes made:\n\nChanges include revised catalina.sh and catalina.bat files supporting \nJPDA_OPTS (supported in tomcat 4.1.18), and support for a new JPDA_SUSPEND.\n\ncatalina.sh changes:\n\n1. Documented JPDA_OPTS in the script (this was missing) \n\n2. Added support for JPDA_SUSPEND environment variable. If not specified, it \ndefaults to \"n\" (backward compatible).\n\ncatalina.bat changes: \n\n1. Added back support for JPDA_OPTS. I basically re-implemented as it was in \ntomcat 4.1.18. Note that its only implemented in the non-security execution \nbranch (this is how it was in tomcat 4.1.18).\n\n2. Documented JPDA_OPTS in the script.\n\n3. Added support for JPDA_SUSPEND environment variable. If not specified, it \ndefaults to \"n\" (backward compatible).','2006-09-16 14:38:15','Kurt Roy','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 minor','815e19e','Mark Emlyn David Thomas','2007-01-27 17:45:06','Port fix bug 40526. Return support for JPDA_OPTS to catalina.bat and add a new option JPDA_SUSPEND. Patch provided by Kurt Roy.','bin/catalina.bat\nbin/catalina.sh\nwebapps/docs/changelog.xml'),(2216,40524,'Bug 40524 – request.getAuthType() returns different string from HttpServletRequest.CLIENT_CERT_AUTH','using inspect:\n\nrequest.getAuthType()\n  (java.lang.String) CLIENT-CERT\n	 \nHttpServletRequest.CLIENT_CERT_AUTH\n   (java.lang.String) CLIENT_CERT\n\napi says they should be the same object (== should work)','2006-09-16 01:49:08','Dario Andrade','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Servlet & JSP API','P2 major','dc33554','Mark Emlyn David Thomas','2007-01-27 16:32:52','Port fix bug 40524. request.getAuthType() now returns CLIENT_CERT rather than CLIENT-CERT as per the spec. Now only web.xml, o.a.c.deploy.LoginConfig and Authenticators.properties use CLIENT-CERT.','java/org/apache/catalina/authenticator/Constants.java\njava/org/apache/catalina/authenticator/SSLAuthenticator.java\njava/org/apache/catalina/authenticator/SingleSignOn.java\njava/org/apache/catalina/authenticator/SingleSignOnEntry.java\nwebapps/docs/changelog.xml'),(2217,41217,'Bug 41217 – SingleSignOn Cookie does not honor https access: Login Information Disclosure','When using the SingleSignOn Valve\n(org.apache.catalina.authenticator.SingleSignOn) via https the Cookie\nJSESSIONIDSSO is transmitted without the \"secure\" attribute, resulting in it\nbeing transmitted to any content that is - by purpose or error - requested via\nhttp from the same server. \n\nAs the content of the SSO-Cookie is confidential (it will lead to automatically\nlogged in sessions in other contexts - https or non-https) this should never happen.\n\nSorry to have no patch. I\'ve not installed the complete source distribution in\nmy development environment, but it seems the points to change are \norg.apache.catalina.authenticator.AuthenticatorBase.register(...), the code of\ninterest being (from 5.5.30 source distribution)\n\n            Cookie cookie = new Cookie(Constants.SINGLE_SIGN_ON_COOKIE, ssoId);\n            cookie.setMaxAge(-1);\n            cookie.setPath(\"/\");\n            hres.addCookie(cookie);\n\nAs hres is an org.apache.catalina.HttpRequest, and I\'ve looked through the code\nto find org.apache.catalina.Request.setSecure() but no ...isSecure() (though\nthis is mentioned in the Javadoc for ...setSecure()) I suppose there needs to be\nanother change to provide isSecure on Request or HttpRequest, but this is\ndifficult to tell only from the editor.\nIf isSecure() was there, there\'d be a \n            cookie.setSecure(hres.isSecure()) \nmissing in the statements above...','2006-12-20 05:13:27','Olaf Kock','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 major','11b9c92','Mark Emlyn David Thomas','2007-01-27 16:25:41','Port fox for bug 41217. Set secure attribute on SSO cookie when cookie is created during a secure request. Patch provided by Chris Halstead.','java/org/apache/catalina/authenticator/AuthenticatorBase.java\nwebapps/docs/changelog.xml'),(2218,41327,'Bug 41327 – Jasper does\'nt display the full path of the file in a 404 Not found  error page','','2007-01-09 00:32:55','Vijay','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 trivial','3a6225a','Mark Emlyn David Thomas','2007-01-27 16:14:06','Port fix for bug 41327. Show full URI for a 404.','java/org/apache/jasper/servlet/JspServlet.java\nwebapps/docs/changelog.xml'),(2219,37869,'Bug 37869 – Cannot obtain client certificate with SSL / client certificate authentication using APR components','','2005-12-12 11:49:58','sergio','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Connector:HTTP','P2 normal','2257ea5','Remy Maucherat','2007-01-18 12:58:17','- 37869: Refix getting certificates. - 40960: Throw a timeout exception when getting a timeout. - Submitted by Christophe Pierret.','java/org/apache/coyote/http11/Http11AprProcessor.java\njava/org/apache/coyote/http11/InternalAprInputBuffer.java'),(2220,40960,'Bug 40960 – Timeout when reading from underlying socket does throw IOException with APR and SocketTimeoutException without APR','Timeout when reading from underlying socket does throw IOException with APR and\nSocketTimeoutException without APR.\nThis difference causes servlet code handling \"timeout exceptions\" to break (and\nnot be fixeable) if APR is used.\nIn class \"org.apache.coyote.http11.InternalAprInputBuffer\" for method \"boolean\nfill() throws IOException\":\n(in block if (!parsingHeader) ) The return code for Socket.recvbb  is not\nchecked for Status.ETIMEDOUT or Status.TIMEUP, therefore an IOException is\nthrown whatever the reason for the exception.  This is a behavior change from\nnon-APR HTTP 1.1 connector.\n\nThe following new code for the fill method fixes the issue:\n   /**\n     * Fill the internal buffer using data from the undelying input stream.\n     *\n     * @return false if at end of stream\n     */\n    protected boolean fill()\n        throws IOException {\n\n        int nRead = 0;\n\n        if (parsingHeader) {\n\n            if (lastValid == buf.length) {\n                throw new IOException\n                    (sm.getString(\"iib.requestheadertoolarge.error\"));\n            }\n\n            bbuf.clear();\n            nRead = Socket.recvbb\n                (socket, 0, buf.length - lastValid);\n            if (nRead > 0) {\n                bbuf.limit(nRead);\n                bbuf.get(buf, pos, nRead);\n                lastValid = pos + nRead;\n            } else {\n                if ((-nRead) == Status.EAGAIN) {\n                    return false;\n                } else {\n                    throw new IOException(sm.getString(\"iib.failedread\"));\n                }\n            }\n\n        } else {\n\n            buf = bodyBuffer;\n            pos = 0;\n            lastValid = 0;\n            bbuf.clear();\n            nRead = Socket.recvbb\n                (socket, 0, buf.length);\n            if (nRead > 0) {\n                bbuf.limit(nRead);\n                bbuf.get(buf, 0, nRead);\n                lastValid = nRead;\n            } else {\n// CP: Start change\n		if ((-nRead) == Status.ETIMEDOUT || (-nRead) == Status.TIMEUP) {\n			throw new java.net.SocketTimeoutException(sm.getString(\"iib.failedread\"));\n		} else {\n			throw new IOException(sm.getString(\"iib.failedread\"));\n		}\n// CP: End change\n            }\n\n        }\n\n        return (nRead > 0);\n\n    }\n\nSince SocketTimeOutException is also an IOException, this modification cannot\nbreak code that does not filter timeout exceptions.','2006-11-13 10:22:30','Christophe Pierret','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Connector:HTTP','P2 normal','2257ea5','Remy Maucherat','2007-01-18 12:58:17','- 37869: Refix getting certificates. - 40960: Throw a timeout exception when getting a timeout. - Submitted by Christophe Pierret.','java/org/apache/coyote/http11/Http11AprProcessor.java\njava/org/apache/coyote/http11/InternalAprInputBuffer.java'),(2221,41260,'Bug 41260 – [Contribution] WebAppLoader and DirContext implementations for handling with expanded webapp during development','Background:\nThrough the customization of the <Loader> and <Resources> elements in a context\ndefinition tomcat allow to plug in custom implementations that can handle a\nwebapp also if not assembled in a standard way.\nThis is especially useful during development and I saw several implementations\nof custom classloaders in the past (see for example the one used by the Sysdeo\ntomcat plugin for Eclipse, or other implementations for eclipse Webtools\nadapters): this makes possible for IDE users to develop and update classes\nwithout the need for fully republishing jars in WEB-INF/lib. The addition of a\ncustom classloader also needs the modification of the server (or common) loader\nin catalina.properties.\nBy using a custom DirContext is also possible to handle tld files that should be\nplaced in WEB-INF or in the META-INF directory of jars in the classpath by\n\"virtually publishing\" them to the WEB-INF dir, making a webapp with unexpanded\njars behave like a standard one.\n\nSince these \"development versions\" of a webapp classloader are fairly simple and\ncould be made very generic I think that it makes sense to add such a\ncustomizable classloader directly to the tomcat distribution.\n\nI have implemented two fairly simple extension that allow a \"virtualClasspath\"\nelement that can be used to configure additional classpath entries. This is a\nsample context configuration:\n\n<Context docBase=\"\\webapps\\mydocbase\">\n  <Loader className=\"org.apache.catalina.loader.VirtualWebappLoader\"\n              virtualClasspath=\"\\dir\\classes;\\somedir\\somejar.jar\"/>\n  <Resources className=\"org.apache.naming.resources.VirtualDirContext\"\n              virtualClasspath=\"\\dir\\classes;\\somedir\\somejar.jar\"/>\n</Context>\n\n\nI would be happy to see them integrated in the tomcat codebase, so that any\ndevelopment environment that needs a simplified way of loading webapps could\nmake use of it without having to reinvent them...','2006-12-29 06:16:43','Fabrizio Giustina','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 enhancement','8a92701','Timothy A. Funk','2007-01-03 06:59:32','Update on http://issues.apache.org/bugzilla/show_bug.cgi?id=41260','java/org/apache/catalina/loader/VirtualWebappLoader.java\njava/org/apache/naming/resources/VirtualDirContext.java'),(2222,41260,'Bug 41260 – [Contribution] WebAppLoader and DirContext implementations for handling with expanded webapp during development','Background:\nThrough the customization of the <Loader> and <Resources> elements in a context\ndefinition tomcat allow to plug in custom implementations that can handle a\nwebapp also if not assembled in a standard way.\nThis is especially useful during development and I saw several implementations\nof custom classloaders in the past (see for example the one used by the Sysdeo\ntomcat plugin for Eclipse, or other implementations for eclipse Webtools\nadapters): this makes possible for IDE users to develop and update classes\nwithout the need for fully republishing jars in WEB-INF/lib. The addition of a\ncustom classloader also needs the modification of the server (or common) loader\nin catalina.properties.\nBy using a custom DirContext is also possible to handle tld files that should be\nplaced in WEB-INF or in the META-INF directory of jars in the classpath by\n\"virtually publishing\" them to the WEB-INF dir, making a webapp with unexpanded\njars behave like a standard one.\n\nSince these \"development versions\" of a webapp classloader are fairly simple and\ncould be made very generic I think that it makes sense to add such a\ncustomizable classloader directly to the tomcat distribution.\n\nI have implemented two fairly simple extension that allow a \"virtualClasspath\"\nelement that can be used to configure additional classpath entries. This is a\nsample context configuration:\n\n<Context docBase=\"\\webapps\\mydocbase\">\n  <Loader className=\"org.apache.catalina.loader.VirtualWebappLoader\"\n              virtualClasspath=\"\\dir\\classes;\\somedir\\somejar.jar\"/>\n  <Resources className=\"org.apache.naming.resources.VirtualDirContext\"\n              virtualClasspath=\"\\dir\\classes;\\somedir\\somejar.jar\"/>\n</Context>\n\n\nI would be happy to see them integrated in the tomcat codebase, so that any\ndevelopment environment that needs a simplified way of loading webapps could\nmake use of it without having to reinvent them...','2006-12-29 06:16:43','Fabrizio Giustina','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 enhancement','2fc968b','Timothy A. Funk','2007-01-02 19:51:31','http://issues.apache.org/bugzilla/show_bug.cgi?id=41260 [Contribution] WebAppLoader and DirContext implementations for handling with expanded webapp during development','java/org/apache/catalina/loader/VirtualWebappLoader.java\njava/org/apache/naming/resources/VirtualDirContext.java'),(2223,40820,'Bug 40820 – Default JSP factory not initialized early enough','With the latest TC6 code, I\'m seeing a problem that did not exist on earlier TC6\ndrivers.  Sorry that I can\'t put a finger on when this problem arose.  I looked\ninto relevant source files (like JspRuntimeContext) but haven\'t found the source\nof the problem. \n\nHere\'s the issue (a testcase will be attached). \n\nThe app is very simple: it installs ServletContextListener for the purpose of\nadding a custom ELResolver.  It accomplishes this via: \n\n    public void contextInitialized(ServletContextEvent evt) { \n        ServletContext context = evt.getServletContext(); \n        JspApplicationContext jspContext =\nJspFactory.getDefaultFactory().getJspApplicationContext(context); \n        jspContext.addELResolver(new ChipsELResolver()); \n    } \n\n\nThe problem is that JspFactory.getDefaultFactory() is returning null; see below.\n\nOct 4, 2006 5:32:18 PM org.apache.catalina.core.AprLifecycleListener lifecycleEv \nent \nINFO: The Apache Tomcat Native library which allows optimal performance in produ \nction environments was not found on the java.library.path: C:\\javaFor6.0BuildJDK \n15\\java\\jre\\bin;.;C:\\javaFor6.0BuildJDK15\\java\\bin;c:\\mantis2.1\\mantis\\bin;C:\\se \ntupIBASE;C:\\Perl\\bin\\;C:\\WINDOWS\\system32;C:\\WINDOWS;C:\\WINDOWS\\System32\\Wbem;c: \n\\Python22;C:\\Program Files\\PC-Doctor for Windows\\services;c:\\cvsnt-2.0.4;c:\\ecli \npse;w:\\;w:\\bin;C:\\Program Files\\QuickTime\\QTSystem\\;C:\\Diskeeper\\;C:\\CMVC\\exe;C: \n\\CMVC\\exe\\bin;;C:\\CMVCDC50;C:\\CMVCDC50;C:\\CMVCDC50; \nOct 4, 2006 5:32:18 PM org.apache.coyote.http11.Http11Protocol init \nINFO: Initializing Coyote HTTP/1.1 on http-8080 \nOct 4, 2006 5:32:19 PM org.apache.catalina.startup.Catalina load \nINFO: Initialization processed in 1234 ms \nOct 4, 2006 5:32:19 PM org.apache.catalina.core.StandardService start \nINFO: Starting service Catalina \nOct 4, 2006 5:32:19 PM org.apache.catalina.core.StandardEngine start \nINFO: Starting Servlet Engine: Apache Tomcat/6.0.0-dev \nOct 4, 2006 5:32:19 PM org.apache.catalina.core.StandardHost start \nINFO: XML validation disabled \nOct 4, 2006 5:32:19 PM org.apache.catalina.startup.HostConfig deployWAR \nINFO: Deploying web application archive ELResolverTest.war \nChipsListener.contextInitialized  evt= javax.servlet.ServletContextEvent[source= \norg.apache.catalina.core.ApplicationContextFacade@3fbe3fbe] \nChipsListener.contextInitialized  context= org.apache.catalina.core.ApplicationC \nontextFacade@3fbe3fbe \nChipsListener.contextInitialized  JspFactory.getDefaultFactory()= null \nOct 4, 2006 5:32:20 PM org.apache.catalina.core.StandardContext start \nSEVERE: Error listenerStart \nOct 4, 2006 5:32:20 PM org.apache.catalina.core.StandardContext start \nSEVERE: Context [/ELResolverTest] startup failed due to previous errors \nOct 4, 2006 5:32:21 PM org.apache.coyote.http11.Http11Protocol start \nINFO: Starting Coyote HTTP/1.1 on http-8080 \nOct 4, 2006 5:32:21 PM org.apache.jk.common.ChannelSocket init \nINFO: JK: ajp13 listening on /0.0.0.0:8009 \nOct 4, 2006 5:32:21 PM org.apache.jk.server.JkMain start \nINFO: Jk running ID=0 time=0/63  config=null \nOct 4, 2006 5:32:21 PM org.apache.catalina.startup.Catalina start \nINFO: Server startup in 2657 ms \n\n\nThis is easily reproducible when you deploy the ELResolverTest.war *before* the\nserver has started (I assume JspFactory.setDefaultFactory() hasn\'t been invoked\nat the time the listeners are being installed).  If you deploy the WAR *after*\nthe server starts, the problem does not manifest and the app works --- until you\nstop and restart the server.','2006-10-26 07:52:03','Scott Johnson','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 minor','a1b1bed','Timothy A. Funk','2007-01-02 19:36:57','http://issues.apache.org/bugzilla/show_bug.cgi?id=40820 Default JSP factory not initialized early enough','java/org/apache/catalina/core/JasperListener.java'),(2224,39409,'Bug 39409 – Formatting bug with javax/el/LocalStrings.properties','This is a patch for a formatting error on all properties in the\njavax/el/LocalStrings.properties file for Jasper 6.\n\nAgain, I can\'t find anywhere to post this, so I\'m posting it here on the Tomcat\n5 list and hoping it finds the right home.','2006-04-26 14:36:01','Jan Bartel','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','2e16163','Timothy A. Funk','2007-01-02 09:53:35','Formatting bug with javax/el/LocalStrings.properties http://issues.apache.org/bugzilla/show_bug.cgi?id=39409','java/javax/el/LocalStrings.properties'),(2225,41182,'Bug 41182 – Jasper ignores JspServlet\'s \'classpath\' init param','JspServlet describes and reads a servlet init parameter \'classpath\'.\nDocumentation says: \n\n\"classpath - What class path should I use while compiling generated servlets? By\ndefault the classpath is created dynamically based on the current web application.\"\n\nCurrent behaviour is that the configured classpath is only considered if no\nclasspath is configured as servlet context attribute. \n\n---JspRuntimeContext:335----\nString cp = (String) context.getAttribute(Constants.SERVLET_CLASSPATH);\nif (cp == null || cp.equals(\"\")) {\n  cp = options.getClassPath();\n}\n\nIt seems that when running within tomcat the context attribute is usually\npresent and therefore the classpath from the servlet init parameter is not\nconsidered.','2006-12-15 07:07:24','Werner Loibl','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 normal','8c21684','Mark Emlyn David Thomas','2006-12-30 21:19:07','Port doc update for 41182 from TC5','webapps/docs/jasper-howto.xml'),(2226,37869,'Bug 37869 – Cannot obtain client certificate with SSL / client certificate authentication using APR components','','2005-12-12 11:49:58','sergio','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Connector:HTTP','P2 normal','efb55ee','Remy Maucherat','2006-12-18 18:16:46','- 37869: Also use the SSL_INFO_CLIENT_CERT field if the chain is empty. - Submitted by Grzegorz Grzybek.','java/org/apache/coyote/http11/Http11AprProcessor.java'),(2227,41051,'Bug 41051 – Keystore alias shouldn\'t be case sensitive','The \"alias\" attribute of the non-APR SSL connector seems to be case-sensitive.\nIf I specify \"classServer\" for the alias I get:\n\n28-Nov-2006 1:03:18 AM org.apache.tomcat.util.net.PoolTcpEndpoint acceptSocket\nSEVERE: Endpoint [SSL: ServerSocket[addr=0.0.0.0/0.0.0.0,port=0,localport=443]]\nignored exception: java.net.SocketException: SSL handshake\nerrorjavax.net.ssl.SSLException: No available certificate or key corresponds to\nthe SSL cipher suites which are enabled.\njava.net.SocketException: SSL handshake errorjavax.net.ssl.SSLException: No\navailable certificate or key corresponds to the SSL cipher suites which are enabled.\n	at\norg.apache.tomcat.util.net.jsse.JSSESocketFactory.acceptSocket(JSSESocketFactory.java:113)\n	at\norg.apache.tomcat.util.net.PoolTcpEndpoint.acceptSocket(PoolTcpEndpoint.java:407)\n	at\norg.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:70)\n	at\norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:684)\n	at java.lang.Thread.run(Unknown Source)\n\n   Whereas if I use an alias of \"classserver\" (all lowercase) it works just\nfine. To make matters worse, the keystore was generated with an alias\n\"classServer\" so the lowercase is actually incorrect, and when you hit a webpage\nthrough SSL the certificate will indeed show \"classServer\" using camel-casing.\n\n   My guess is that this indicates some sort of Tomcat or JDK bug.\njava.security.Keystore.setCertificateEntry() will actually throw an exception if\none tries storing two keys whose aliases only differ by casing, which is why I\nsay the alias has to be treated as case-insensitive.\n\n   If it isn\'t fixable, this behavior should at least be documented in the SSL\n\"howto\" document beside the bold lettering which reminds readers that passwords\nare case-sensitive.','2006-11-27 22:15:58','Gili','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Connector:HTTP','P2 normal','b23b029','Mark Emlyn David Thomas','2006-12-07 22:37:17','Port fix for bug 41051.','webapps/docs/config/http.xml\nwebapps/docs/ssl-howto.xml'),(2228,41074,'Bug 41074 – Output of tag \"jsp:plugin\" is not conform to XHTML.','The jsp comiler outputs all tag required for an object in upper case letters. \nTo be conform with XHTML lower case is required, but all tags are hard coded in \nthe generator.','2006-11-29 05:35:54','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 normal','5f9c18d','Mark Emlyn David Thomas','2006-12-07 21:34:01','Port fix for bug 41074. Make jsp:plugin output XHTML compliant','java/org/apache/jasper/compiler/Generator.java\nwebapps/docs/changelog.xml'),(2229,40581,'Bug 40581 – Symbolic links not (re)followed when application is reloaded','When the path of the docBase of an application contains a symbolic link Tomcat\nstill consider the initial targeted folder after a reload.\n\nEx:\nwhen file system first contains:\n/foo/myApp_version1 (dir)\n/foo/myApp -> /foo/myApp_version1 (symbolic link)\n\nTomcat is started and then application myApp is stopped. Symbolic link is\nchanged to point to myApp_version2:\n/foo/myApp_version1 (dir)\n/foo/myApp_version2 (dir)\n/foo/myApp -> /foo/myApp_version2 (symbolic link)\n\nand finally application myApp is started. The problem is that the displayed web\napplication is still the one contained in /foo/myApp_version1 (the initially\ntargeted folder)and not the one contained in /foo/myApp_version2.','2006-09-22 12:29:06','Marc Guillemot','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','5448766','Mark Emlyn David Thomas','2006-12-07 21:26:28','Port fix for bug 40581. Add note about using symbolic links.','webapps/docs/config/context.xml'),(2230,40585,'Bug 40585 – org.apache.juli.FileHandler does not allow programmatic creation using parametrized constructor','If org.apache.juli.FileHandler is created programmatically with parametrized\nconstructor \n\npublic FileHandler(String directory, String prefix, String suffix)\n\n, FileHandler ignores custom constructor parameters, creates log handler with \ndefault configuration and writes log file to \n\"${catalina_home}/bin/logs\" with the name \"juli.YYYY-MM-DD.log\"\n(YYYY, MM and DD are substituted with actual year, month and date)\n\nIt looks like the problem is in the fact parametrized constructor calls \ndefault constructor. Default constructor in turn performs handler configuration\nfrom LogManager properties and creates a log file based on this default \nconfiguration. \n\nThis makes custom constructor parameters effectively ignored.','2006-09-22 18:06:20','Alexandr Ufimtsev','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina:Modules','P4 minor','c6b3f71','Mark Emlyn David Thomas','2006-12-07 21:24:30','Port fix for 40585. Fix parametrised constructor so parameters have an effect','java/org/apache/juli/FileHandler.java\nwebapps/docs/changelog.xml'),(2231,41089,'Bug 41089 – JspFactoryImpl has SPEC_VERSION = \"2.0\"','org.apache.jasper.runtime.JspFactoryImpl has \n\nprivate static final String SPEC_VERSION = \"2.0\";\n\nShould be:\n\nprivate static final String SPEC_VERSION = \"2.1\";','2006-11-30 10:12:31','Stan Silvert','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','514256e','Timothy A. Funk','2006-12-01 07:14:23','Bug 41089 and JSP.6.3.2 Table JSP.6-2 Attributes for the <jsp:root> standard action version (required) The version of the JSP specification used in this page. Valid values are \"1.2\", \"2.0\", and \"2.1\". It is a translation error if the container does not support the specified version.','java/org/apache/jasper/compiler/ImplicitTagLibraryInfo.java\njava/org/apache/jasper/compiler/PageDataImpl.java\njava/org/apache/jasper/compiler/Validator.java\njava/org/apache/jasper/resources/LocalStrings.properties\njava/org/apache/jasper/resources/LocalStrings_es.properties'),(2232,41057,'Bug 41057 – Tomcat leaks memory on every request','','2006-11-28 10:07:27','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','de5c3b7','Remy Maucherat','2006-11-28 19:30:07','- 41057: Caching large strings uses too much memory and is a bit pointless, so add an upper bound to the String length.','java/org/apache/tomcat/util/buf/StringCache.java'),(2233,41008,'Bug 41008 – POST request ignores command line parameters','example:\n<form method=\"POST\" action=\"test.exe?test1\"><input type=\"hidden\"\nvalue=\"test2\"><input type=\"submit\"></form>\n\nthis code does invoke the test.exe without passing the test1 command line parameter\n\nthe example works in apache httpd and ms iis\n\nfix:\n\nCGIServlet.java\n\n           if (!\"GET\".equals(req.getMethod()) && !\"POST\".equals(req.getMethod()) &&\n                    !\"HEAD\".equals(req.getMethod()))\n                return;','2006-11-21 09:20:32','Thomas Wiesel','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Servlets:CGI','P5 normal','b70962f','Mark Emlyn David Thomas','2006-11-24 18:58:18','Port fix bug 41008. Enable POST to be used with indexed queries. Patch provided by Chris Halstead.','java/org/apache/catalina/servlets/CGIServlet.java\nwebapps/docs/changelog.xml'),(2234,40999,'Bug 40999 – Unable to manage truststoreFile, truststorePass, truststoreType','It is impossible to manage of some attributes needed to confiure SSL connection\nusing JMX. Connector section in server.xml file may define truststoreFile,\ntruststorePass, truststoreType attributes to configure SSL connection. But these\nattributes are not available via JMX interface. \nFirst I have found that there is not description of these attributes in \n(%SRC_ROOT%\\container\\catalina\\src\\share\\org\\apache\\catalina\\connector\\mbeans-descriptors.xml)\nfile.\n \nAs result these attributes are not available to manage SSL connection using\nTomcat Administration Application.','2006-11-19 01:41:04','Mark Koshelev','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','195daaa','Mark Emlyn David Thomas','2006-11-20 18:37:43','Port relevant parts of fix for bug 40999.','java/org/apache/catalina/connector/mbeans-descriptors.xml\nwebapps/docs/changelog.xml'),(2235,38198,'Bug 38198 – When using context xml definitions standalone file, tomcat wrongly uses the file name instead the context path definition','When deploying an application in Tomcat 5.5 (been observed in 5.5.8 but not in  \n5.0.30), using a context definition xml file, such as  \n<TOMCAT_CONF>/Catalina/hostname/myapp.xml, tomcat ignores the context path  \ndefinition in the XML file (i.e. <context path=\"/some/path\">) and instead uses  \nthe file name (i.e. \"myapp\" in this case) as the path.  \n  \nThis makes it impossible to create complex server configurations where  \napplications are hosted not under the root of the server, in addition to being  \nconfusing, counter-intuitive and just plain wrong.  \n \nThe behavior should be reverted to how it was handled under tomcat 5.0.','2006-01-09 16:24:59','Oded Arbel','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Unknown','P1 major','45b245f','Mark Emlyn David Thomas','2006-11-19 19:27:23','Port fix for bug 38198. Improve context name aspect of host documentation.','webapps/docs/changelog.xml\nwebapps/docs/config/host.xml'),(2236,40901,'Bug 40901 – listings page does not escape XML characters','On Solaris you can have a file or directory name called \"<b>xxx\" or \"<i>yyy\".\nUsing Tomcat\'s listings feature, you get a directory listing with the file name\nin bold or italics.\n\nI am not familiar with Javascript or cross-site scripting security problems, but\nI believe Tomcat escapes XML characters like \">\" and \"<\" to prevent client\nbrowsers to interpret HTML codes that are not intended to be interpreted as such\nfor the default error page.\nI think the same should be done for listings, or a warning should be added to\nthe documentation not to use it if you have no control over the file/directory\nnames you list.','2006-11-05 20:38:27','Dies Koper','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Unknown','P2 normal','cb2c655','Mark Emlyn David Thomas','2006-11-19 19:17:55','Port fix for bug 40901. Encode directory listing output. Based on a patch by Chris Halstead.','java/org/apache/catalina/servlets/DefaultServlet.java\nwebapps/docs/changelog.xml'),(2237,40929,'Bug 40929 – Misleading comments in StandardClassLoader','Sometime during the Tomcat 5 development, the StandardClassLoader in\norg.apache.catalina.loader package was stripped down, and is now just a\nURLClassLoader.\n\nI work with code that extends the StandardClassLoader (we use the automatic\nreloading of jar files), and during an upgrade from tomcat 4 to tomcat 5.5 found\ndifficultly trying to figure out what had happened to the code.  I ended up\nhaving to install SVN and do a svn log to figure out why the code was removed.\n\nWhen the code was stripped down, the comments in the java file (and therefore in\nthe javadoc api) remained identical, so the javadoc api for the class is very\nmisleading.  For instance, the comments say that the class implements Reloader,\nwhen it in fact does not.\n\nThe class comments should be updated to reflect the state of the code.\n\nI can\'t see this as being very high priority, but it would likely be an easy to\nfix for people whom are in the code regularly, and it would make the javadoc\nmuch more readable for people that extend the StandardClassLoader for their own\npurposes.','2006-11-08 14:23:40','Robert Young','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 trivial','6009702','Mark Emlyn David Thomas','2006-11-19 19:13:26','Port fix for bug 40929. Update JavaDoc','java/org/apache/catalina/loader/StandardClassLoader.java\nwebapps/docs/changelog.xml'),(2238,40860,'Bug 40860 – Tomcat loses request parameters','','2006-11-01 04:29:15','Thiago Costa','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 critical','e713e77','Mark Emlyn David Thomas','2006-11-19 19:10:03','Port fix bug 40860. Additional logging if parameter processing fails.','java/org/apache/catalina/connector/LocalStrings.properties\njava/org/apache/catalina/connector/Request.java\njava/org/apache/tomcat/util/http/Parameters.java\nwebapps/docs/changelog.xml'),(2239,37509,'Bug 37509 – ClassLoaderLogManager remove \'\\n\' at the end of logging.properties values','The method ClassLoaderLogManager.replace(String) that is in charge of replacing\nsystem properties at the begining of the property also modify the end of the\nproperty due to a call to trim.\n\nThis implies that Logger/Handler/Formatter that relies on properties endding\nwith some spases (including \'\\n\') will have a different behaviour with JDK\nLogManger and tomcat ClassLoaderLogManager\n\na modified verstion of this method could be:\n\n    protected String replace(String str) {\n// start modification    	\n//        String result = str.trim();  // commented out\n    	\n    	int len = str.length();\n    	int st = 0;\n    	while ((st < len) && (str.charAt(st) <= \' \')) {\n    	    st++;\n    	}\n    	String result = (st > 0) ? str.substring(st) : str;\n// end modification        \n        \n        if (result.startsWith(\"${\")) {\n            int pos = result.indexOf(\'}\');\n            if (pos != -1) {\n                String propName = result.substring(2, pos);\n                String replacement = System.getProperty(propName);\n                if (replacement != null) {\n                    result = replacement + result.substring(pos + 1);\n                }\n            }\n        }\n        return result;\n    }','2005-11-15 18:22:38','Franck Hamelin','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Unknown','P2 normal','a6d6962','Mark Emlyn David Thomas','2006-11-19 19:01:37','Port fix for bug 37509.','java/org/apache/juli/ClassLoaderLogManager.java\nwebapps/docs/changelog.xml'),(2240,40844,'Bug 40844 – JDBCRealm.getPassword throws NullPointerException','JDBCRealm.getPassword throws NullPointerException\n\nI\'m using tomcat 5.5.20 with postgresql-8.1-407.jdbc3.jar and postgresql-8.1.4\non Ubuntu Dapper. Authenticating two users simultaneously with HTTP DIGEST\ncauses sometimes the following errors and a 401 Unauthorized reply:\n\n30.10.2006 14:24:54 org.apache.catalina.realm.JDBCRealm getPassword\nSEVERE: Exception performing authentication\norg.postgresql.util.PSQLException: ERROR: invalid message format\n        at\norg.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:1525)\n        at\norg.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1309)\n        at\norg.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:188)\n        at\norg.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:452)\n        at\norg.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:354)\n        at\norg.postgresql.jdbc2.AbstractJdbc2Statement.executeQuery(AbstractJdbc2Statement.java:258)\n        at org.apache.catalina.realm.JDBCRealm.getPassword(JDBCRealm.java:546)\n        at org.apache.catalina.realm.RealmBase.getDigest(RealmBase.java:1156)\n        at org.apache.catalina.realm.RealmBase.authenticate(RealmBase.java:365)\n        at\norg.apache.catalina.authenticator.DigestAuthenticator.findPrincipal(DigestAuthenticator.java:282)\n        at\norg.apache.catalina.authenticator.DigestAuthenticator.authenticate(DigestAuthenticator.java:175)\n        at\norg.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:490)\n        at\norg.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:126)\n        at\norg.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:105)\n        at\norg.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:107)\n        at\norg.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:148)\n        at\norg.apache.coyote.http11.Http11Processor.process(Http11Processor.java:869)\n        at\norg.apache.coyote.http11.Http11BaseProtocol$Http11ConnectionHandler.processConnection(Http11BaseProtocol.java:664)\n        at\norg.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:527)\n        at\norg.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:80)\n        at\norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:684)\n        at java.lang.Thread.run(Thread.java:595)\n30.10.2006 14:24:54 org.apache.catalina.connector.CoyoteAdapter service\nSEVERE: An exception or error occurred in the container during the request\nprocessing\njava.lang.NullPointerException\n        at org.apache.catalina.realm.JDBCRealm.getPassword(JDBCRealm.java:568)\n        at org.apache.catalina.realm.JDBCRealm.getPrincipal(JDBCRealm.java:594)\n        at org.apache.catalina.realm.RealmBase.authenticate(RealmBase.java:398)\n        at\norg.apache.catalina.authenticator.DigestAuthenticator.findPrincipal(DigestAuthenticator.java:282)\n        at\norg.apache.catalina.authenticator.DigestAuthenticator.authenticate(DigestAuthenticator.java:175)\n        at\norg.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:490)\n        at\norg.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:126)\n        at\norg.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:105)\n        at\norg.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:107)\n        at\norg.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:148)\n        at\norg.apache.coyote.http11.Http11Processor.process(Http11Processor.java:869)\n        at\norg.apache.coyote.http11.Http11BaseProtocol$Http11ConnectionHandler.processConnection(Http11BaseProtocol.java:664)\n        at\norg.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:527)\n        at\norg.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:80)\n        at\norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:684)\n        at java.lang.Thread.run(Thread.java:595)','2006-10-30 06:25:52','Santtu Hyrkkö','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','be9d523','Mark Emlyn David Thomas','2006-11-19 18:52:52','Port fix for bug 40844. Missing syncs.','java/org/apache/catalina/realm/JDBCRealm.java\nwebapps/docs/changelog.xml'),(2241,40913,'Bug 40913 – JasperException raised against valid attribute','In org.apache.jasper.compiler.Validator.checkXmlAttributes(), the validation \nfor deferred values and methods is raising an exception when an rtexprvalue \nattribute is legitimate.\n\n------Stacktrace------\norg.apache.jasper.JasperException: \norg.apache.jasper.JasperException: /index.jsp(83,0)\n      According to TLD or attribute directive in tag file, attribute items \ndoes not accept any expressions\n    org.apache.jasper.servlet.JspServletWrapper.handleJspException\n(JspServletWrapper.java:565)\n    org.apache.jasper.servlet.JspServletWrapper.service\n(JspServletWrapper.java:354)\n    org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:320)\n    org.apache.jasper.servlet.JspServlet.service(JspServlet.java:266)\n    javax.servlet.http.HttpServlet.service(HttpServlet.java:803)\n\n\n\n------relevant code in checkXmlAttributes()------\n if (!deferred && (tldAttrs[j].isDeferredMethod() || tldAttrs\n[j].isDeferredValue())) {\n     // Only deferred expressions are allowed for this attribute\n     err.jspError(n, \"jsp.error.attribute.custom.non_rt_with_expr\",\n             tldAttrs[j].getName());\n }\n\n------testcase------\n<c:forEach var=\"k\" items=\"${colors}\">\n  <li><font color=\"${k}\">This line is ${k}</font>.\n</c:forEach>\n\nThe TLD for JSTL 1.2 says items can be an rtexprvalue and also a deferred-\nvalue.  So the above usage is correct.\nAttaching a testcase WAR.\n\n------summary------\nI don\'t think this code is really necessary; at least, it needs to be relaxed \nto allow tai.canBeRequestTime() values.','2006-11-06 16:24:05','Scott Johnson','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','f7ca96d','Remy Maucherat','2006-11-07 05:45:01','- 40913: Fix the second test when an expression is used.','java/org/apache/jasper/compiler/Validator.java'),(2242,34956,'Bug 34956 – Tomcat should enforce the requirements from servlet 2.4 specification SRV.8.2','Tomcat should enforce the requirements from servlet 2.4 specification SRV.8.2\n\nSRV.8.2 Using a Request Dispatcher\n\n\"To use a request dispatcher, a servlet calls either the include method or\nforward method of the RequestDispatcher interface. The parameters to these\nmethods can be either the request and response arguments that were passed in via\nthe service method of the Servlet interface, or instances of subclasses of the\nrequest and response wrapper classes that have been introduced for version 2.3\nof the specification. In the latter case, the wrapper instances must wrap the\nrequest or response objects that the container passed into the service method.\nThe Container Provider must ensure that the dispatch of the request to a target\nservlet occurs in the same thread of the same VM as the original request\"\n\nJustification:\n==============\nThe absense of this enforcement leads to software beeing developed not following\nthe specification. The software cannot be deployed later on a container which\nconforms to the above paragraph and hence must be changed before deployment.\nThis somehow contradicts the idea of having a standards based infrastructure.','2005-05-18 14:47:47','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Servlet & JSP API','P2 normal','22d1ad7','Mark Emlyn David Thomas','2006-11-04 17:35:15','Port fix for bug 34956. Enforce requirements of SRV.8.2 / SRV.14.2.5.1','java/org/apache/catalina/core/ApplicationDispatcher.java\njava/org/apache/catalina/core/ApplicationFilterChain.java\njava/org/apache/catalina/core/LocalStrings.properties'),(2243,40817,'Bug 40817 – servlet-cgi throws index out of bounds exception on certain cgi','First, servlets-cgi.jar needs to exist and the servlet must be mapped:\nfor example:\n <servlet-mapping>\n   <servlet-name>cgi</servlet-name>\n   <url-pattern>*.pl</url-pattern>\n </servlet-mapping>\n\nTest perl cgi script:\n #!/usr/bin/perl\n print \"Content-type: text/plain\", \"\\n\\n\";\n print \"Hello world, from Perl\\n\";\n\nOne perl script is placed in www-root (\"/test.pl\") and the other in any\nsubfolder (\"/test/test.pl\" or \"/cgi-bin/test.pl\", etc.)\n\nThe cgi script in the subfolder will run fine.\nThe cgi script in the www-root will generate an exception:\njava.lang.StringIndexOutOfBoundsException: String index out of range: -1\n	java.lang.String.substring(String.java:1768)\n	java.lang.String.substring(String.java:1735)\n	org.apache.catalina.servlets.CGIServlet$CGIEnvironment.findCGI(CGIServlet.java:948)\n	org.apache.catalina.servlets.CGIServlet$CGIEnvironment.setCGIEnvironment(CGIServlet.java:1015)\n	org.apache.catalina.servlets.CGIServlet$CGIEnvironment.<init>(CGIServlet.java:766)\n	org.apache.catalina.servlets.CGIServlet.doGet(CGIServlet.java:584)\n	javax.servlet.http.HttpServlet.service(HttpServlet.java:689)\n	javax.servlet.http.HttpServlet.service(HttpServlet.java:802)\n\n\nThe problem is this line (line 948 in CGIServlet.java):\n\ncginame =              \ncurrentLocation.getParent().substring(webAppRootDir.length())+ File.separator +\nname;\n\nThe problem is that webAppRootDir is 1 char longer than\ncurrentLocation.getParent() because webAppRootDir ends with a File.separator (in\nthis case, a \"/\").  And removing the extra File.separator from webAppRootDir\nwill result in a different String related exception elsewhere.\n\nAnd here\'s a fix that works:\n\ncginame = (currentLocation.getParent() + \nFile.separator).substring(webAppRootDir.length()) + name;\n\n(If necessary, the fix can be made more adaptive by checking to see if it really\ndoes have a File.separator at the end and if not...add it...otherwise, let it\nbe, etc.)\n\n(on a side note, I have one more bug to fix; the ENV_VAR \"SCRIPT_FILENAME\" isn\'t\ndefined as it should be [required for PHP4/5] but I\'ll submit a different\nbug/fix for that.)','2006-10-25 20:02:52','Gene Hardesty','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Servlets:CGI','P2 major','6d274b4','Mark Emlyn David Thomas','2006-11-04 16:40:59','Port fix for bug 40817.','java/org/apache/catalina/servlets/CGIServlet.java'),(2244,40823,'Bug 40823 – Specifying default context w/empty path outside of server.xml','','2006-10-26 13:05:35','Jon Wilmoth','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Unknown','P2 normal','3c78f46','Mark Emlyn David Thomas','2006-11-04 16:37:20','Port fix bug 40823. Better context docs.','webapps/docs/config/context.xml'),(2245,37439,'Bug 37439 – Virtual Host selection across Services?','I have a TC 5.5 fronted by Apache2/mod_jk.\nTwo SSL sites on different ips, one for users, one for admins. The admin one is\napache password protected. Each apache ip virtual host uses a different worker\nto talk to TC on a different port in a different service. for example\n\n<Service name=\"User\">\n <Connector scheme=\"https\" secure=\"true\" address=\"127.0.0.1\" port=\"10004\"\ndebug=\"0\" useURIValidationHack=\"false\" protocol=\"AJP/1.3\"/>\n <Engine name=\"Standalone\" defaultHost=\"User\" debug=\"0\">\n  <Host name=\"User\" debug=\"0\" appBase=\"webapps/SomethingUser\" unpackWARs=\"false\">\n   <Context blahblah/>\n  </Host>\n </Engine>\n</Service>\n\n<Service name=\"Admin\">\n <Connector scheme=\"https\" secure=\"true\" address=\"127.0.0.1\" port=\"10005\"\ndebug=\"0\" useURIValidationHack=\"false\" protocol=\"AJP/1.3\"/>\n <Engine name=\"Standalone\" defaultHost=\"Admin\" debug=\"0\">\n  <Host name=\"Admin\" debug=\"0\" appBase=\"webapps/SomethingAdmin\" unpackWARs=\"false\">\n   <Context blahblah/>\n  </Host>\n </Engine>\n</Service>\n\nThe problem, and it may be intended behavior, is that if you connect to ip1 and\nspoof your Host header as \'Admin\', apache correctly routes the request (jk in\ndebug says it connects via 10004) to TC via the User worker, but then TC appears\nto match the virtual host name in a different service and serves admin content\ngetting around Apache\'s password protection.\nVia browsing a lot of bugs tonight I\'m aware of the useIPVHost element which I\ncould probably use to lock each host to the host apache intended, but this can\'t\nbe intended behaviour. Can it? Across Service tags? Why would you ever need more\nthan one service or connector then?\n\nHopefully at the very least this will spur a note in the docs. if it is\nintended, as this is potentially dangerous. LMK if you need anything else to\nreproduce.','2005-11-10 07:03:13','Robert Nice','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Unknown','P2 normal','598f14d','Mark Emlyn David Thomas','2006-11-04 16:24:01','Port fix bug 37439. Update engine docs with name uniqueness requirement.','webapps/docs/config/engine.xml'),(2246,37458,'Bug 37458 – Datarace on org.apache.catalina.loader.WebappClassLoader','In findClassInternal, it is possible that entry.manifest is set to null by \nanother thread right before calling definePackage(packageName, entry.manifest, \nentry.codeBase).','2005-11-10 21:34:17','Feng Chen','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','79631bb','Mark Emlyn David Thomas','2006-11-04 16:21:07','Port fix bug 37458. Remove the possibility of some NPE and IAE issues. Note for Remy - you had some ideas to improve this patch.','java/org/apache/catalina/loader/WebappClassLoader.java'),(2247,37070,'Bug 37070 – Servlets not recognized as MBeans','','2005-10-13 12:06:44','Sebastian Davids','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','b30062a','Mark Emlyn David Thomas','2006-10-22 19:05:45','Port fix for 37070 to TC6 along with the changes to remove references to the DefaultContext.','webapps/docs/funcspecs/mbean-names.xml'),(2248,39436,'Bug 39436 – Duplicate and Incorrect MIME Type for SVG','Tomcat has multiple entries for the SVG MIME Type (such as it is), including the\ndefunct \"image/svg-xml\".\n\nPlease correct it so that .svg and .svgz are both listed with the correct MIME\nType (\"image/svg+xml\") and remove the duplicate, incorrect reference to\n\"image/svg-xml\".','2006-04-27 21:12:54','schepers','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Unknown','P2 normal','c166907','Mark Emlyn David Thomas','2006-10-19 19:16:47','Port fix bug 39436. Correct MIME type for SVG.','conf/web.xml'),(2249,40723,'Bug 40723 – Wrong and misleading documentation in JDBCAccessLogValve','In the class JDBCAccessLogValve is an example for an table to hold access log \nvalues. In this table is a column ts which is defined as not null. This will \nonly work on MySQL, because this value is never written by the Valve and other \ndatabases will complain about a column which is not filled with a value.','2006-10-11 02:50:26','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P4 normal','9cb5aff','Mark Emlyn David Thomas','2006-10-17 22:37:58','Port fix 40723. Correct javadoc for JDBCAccessLogValve.','java/org/apache/catalina/valves/JDBCAccessLogValve.java'),(2250,40771,'Bug 40771 – Can\'t read POST data from within a filter or valve','I was attempting to create a Filter or Valve that could be placed in front of an\nAxis web service that would handle security according to the WS-Security\nspecification. That turned out to be a rabbit trail, but I did find and fix a\nbug that I discovered along the way. \n\nI ran into problems reading POST data (the web service request) from the\norg.apache.catalina.connector.Request object exposed in the Filter/Valve\ninterfaces. This is a chunk of code in a prototype Valve that didn\'t work:\n\nprivate ByteChunk getPOSTBody(Request request)\n      throws IOException\n  {\n    ByteChunk retval = new ByteChunk(request.getContentLength());\n    ByteChunk body = new ByteChunk(request.getContentLength());\n\n    int bytesRead;\n    do\n    {\n      bytesRead = request.getCoyoteRequest().doRead(body);\n      retval.append(body);\n    }\n    while (bytesRead >= 0) ;\n\n    //puts the data back into the pipe.\n    request.getCoyoteRequest().action\n        (ActionCode.ACTION_REQ_SET_BODY_REPLAY, retval);\n\n    return retval;\n  }\n\nThis code works as designed, however the problem occurs later on when Axis\nattempted to parse the web service request. I don\'t remember the exact Axis\nerror, but I was able to track the problem down to a bug in the\norg.apache.coyote.http11.filters.SavedRequestInputFilter class. The doRead\nmethod was not properly implemented to return a -1 when appropriate.\n\nHere is my modified version of the doRead method:\n\npublic int doRead(ByteChunk chunk, org.apache.coyote.Request request)\n            throws IOException {\n        int writeLength = 0;\n        \n        if (chunk.getLimit() > 0 && chunk.getLimit() < input.getLength()) {\n            writeLength = chunk.getLimit();\n        } else {\n        	writeLength = input.getLength();\n        }\n        if(input.getOffset()>= input.getEnd())\n            return -1;\n\n        input.substract(chunk.getBuffer(), 0, writeLength);\n        chunk.setOffset(0);\n        chunk.setEnd(writeLength);\n        \n        return writeLength;    \n    }\n\n\nThis bug won\'t show up unless someone tries to use a filter/valve to do\nsomething with web services. That\'s not too likely because that\'s what we have\nSOAPHandlers for.','2006-10-16 16:08:36','Michael Dufel','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Connector:Coyote','P4 minor','17eecdb','Mark Emlyn David Thomas','2006-10-17 22:26:48','Port fix bug 40771. Correct doRead method so Filters and Valves can read POST data. patch provided by Michael Dufel.','java/org/apache/coyote/http11/filters/SavedRequestInputFilter.java'),(2251,39724,'Bug 39724 – Bug on StandardPipeline.removeValve(Valve valve) for T5.5.16+','I run into this problem with T5 when tring to add/remove/add a valve to the\nstandard engine. -For what I understand an empty pipeline has:\nbasic = StandardEngineValve (For example);\nfirst = null;\n\n-If you add a valve you will get\nbasic = StandardEngineValve\nfirst = myValve (with myValve.next = StandardEngineValve)\n\n-If you remove the valve you will get\nbasic =StandardEngineValve\nfirst = StandardEngineValve\nNote that StandardEngineValve is in first too here.\n\n-If I try to add a new valve given the actual code in  addValve the valve will\nnot be added because (see the **) current = basic and current.getNext() = null;\n\naddValve(Valve valve) {\n \n       // Add this Valve to the set associated with this Pipeline\n       if (first == null) {\n           first = valve;\n           valve.setNext(basic);\n       } else {\n           Valve current = first;\n           while (current != null) {\n**                if (current.getNext() == basic) {\n                   current.setNext(valve);\n                   valve.setNext(basic);\n                   break;\n               }\n               current = current.getNext();\n           }\n       }\n\n   }','2006-06-05 14:01:56','David Gagnon','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','b18c29e','Mark Emlyn David Thomas','2006-10-02 21:08:32','Port fix for bug 39724. Removing the only valve from a pipeline did not return the pipeline to its original state. Patched provided by David Gagnon.','java/org/apache/catalina/core/StandardPipeline.java'),(2252,40528,'Bug 40528 – missing error message localisations','The following two error messages are used in JspRuntimeLibrary.java, but are missing from org/apache/\njasper/resources/LocalStrings.properties.\n\nGoogle gave me two values that seem to be about right:\n\njsp.error.beans.property.conversion=Unable to convert string \\\"{0}\\\" to class \\\"{1}\\\" for attribute \\\"{2}\\\": \n{3}\nsp.error.beans.propertyeditor.notregistered=Property Editor not registered with the \nPropertyEditorManager','2006-09-17 03:50:54','Ben Clifford','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 normal','d3f8ad3','Mark Emlyn David Thomas','2006-10-01 21:03:00','Port fix for bug 40528. Add missing messages.','java/org/apache/jasper/resources/LocalStrings.properties'),(2253,29727,'Bug 29727 – JNDI env-entry not reload when context reloaded','If environment entries are changed in web.xml, and the application context is \nrestarted, the values in the JNDI context are the old values.\n\nIf the environment entries are changed via the Tomcat \'admin\' interface, then \nthe values provided to the context are correct.\n\nThe following code is can be used to check the environment:\n\n        try {\n            InitialContext ic = new InitialContext();\n            NamingEnumeration enum = ic.listBindings(\"java:comp/env\");\n\n            while (enum.hasMore()) {\n                Binding binding = (Binding) enum.next();\n                jndi.setProperty(binding.getName(), \"\" + binding.getObject());\n                System.out.println(\"jndi setting: \" + binding.getName() + \"=\" \n+ binding.getObject());\n            }\n        } catch (NamingException e) {\n            System.err.println(\"unable to read JNDI settings, \" + e);\n        }\n\n\nThe web.xml fragment looks as follows:\n\n	<env-entry>\n		<env-entry-name>DatabaseURL</env-entry-name>\n		<env-entry-value>jdbc:hsqldb:hsql://localhost</env-entry-value>\n		<env-entry-type>java.lang.String</env-entry-type>\n	</env-entry>','2004-06-21 22:56:25','robert engels','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P3 normal','1a5e6e7','Mark Emlyn David Thomas','2006-10-01 20:38:42','Port fix bug 29727. Changes to env-entry values should take effect on web-app reload.','java/org/apache/catalina/deploy/NamingResources.java'),(2254,40625,'Bug 40625 – CGIServlet eats root cause','The code below doesn\'t make sense:\n<snip>\n            catch (IOException e){\n                log (\"Caught exception \" + e);\n                throw new IOException (e.toString());\n            }\n</snip>\n\nIt should be \"throw e;\".\n\nIMHO, It seems no need to log this exception here, so \nthe cache block can be removed.','2006-09-28 05:16:58','Takayoshi Kimura','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Servlets:CGI','P2 minor','bbb8fe1','Mark Emlyn David Thomas','2006-09-29 19:45:02','Port patch for 40625.','java/org/apache/catalina/servlets/CGIServlet.java'),(2255,40518,'Bug 40518 – The message key \"requestListenerValve.requestInit\" has not be referred to correctly.','The bug is:\n\nAn illegal message is output to the log when the listener application that \nimplements ServletRequestListener interface throws RuntimeException from the \nrequestInitialized method or the requestDestroyed method.\n\nmessage: \"Cannot find message associated with key \nrequestListenerValve.requestInit\"\n\ncause: The key exists in the properties \nfile \"org.apache.catalina.valves.LocalStrings.properties\", but the logic refers \nother properties file \"org.apache.catalina.core.LocalStrings.properties\"','2006-09-15 09:13:40','Suzuki Yuichiro','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','fda223a','Mark Emlyn David Thomas','2006-09-20 22:32:25','Port fix for bug 40518. Use correct message.','java/org/apache/catalina/core/LocalStrings.properties\njava/org/apache/catalina/core/LocalStrings_es.properties\njava/org/apache/catalina/core/LocalStrings_fr.properties\njava/org/apache/catalina/core/LocalStrings_ja.properties\njava/org/apache/catalina/core/StandardContextValve.java\njava/org/apache/catalina/valves/LocalStrings.properties\njava/org/apache/catalina/valves/LocalStrings_es.properties\njava/org/apache/catalina/valves/LocalStrings_fr.properties\njava/org/apache/catalina/valves/LocalStrings_ja.properties'),(2256,34399,'Bug 34399 – Undeploying fails when context defined in server.xml & server fails to stop','Steps to reproduce: \n \n1. autodeploy a web application by defining its context in server.xml \n2. start the Tomcat server \n3. use the Tomcat Manager to undeploy the application \n \nYou will get the \"OK - Undeployed application at context path /WebApplication\" \nmessage, but the application will NOT be undeployed, it will be only stopped. \n \nIf you try to stop the server after that, it will fail! \n \nI have used the shared installation (CATALINA_BASE dir), but I guess this \nwon\'t work for standalone Tomcat isntallation either.','2005-04-11 16:32:42','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Webapps:Manager','P4 normal','9dd8a23','Mark Emlyn David Thomas','2006-09-20 22:21:19','Port fix for bug 34399 - disable the undeploy option if the webapp has not been \'deployed\' This occurs, for example, if the webapp is defined in server.xml','java/org/apache/catalina/manager/HTMLManagerServlet.java\njava/org/apache/catalina/manager/LocalStrings.properties\njava/org/apache/catalina/manager/ManagerServlet.java\njava/org/apache/catalina/startup/HostConfig.java\njava/org/apache/catalina/startup/mbeans-descriptors.xml'),(2257,34509,'Bug 34509 – tag names that are xml:Name but not java identifier are not accepted','According to the JSP 2.0 specification, custom tag prefix and name should be \nof the type XML:Name. However, for Tomcat 5.5.8, if the name is not a legal \njava identifier, then a compilation error occurs. For instance, Tomcat won\'t \naccept Da~te`T#ag as a legal name for the Tag.','2005-04-19 00:45:34','elaine chien','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P3 normal','823101d','Mark Emlyn David Thomas','2006-09-15 21:14:21','port fix for bug 34509. Allow tag names to use full range of characters as defined by the spec.','java/org/apache/jasper/compiler/Generator.java'),(2258,33356,'Bug 33356 – Incorrect parsing of tag attributes','I get a org.apache.jasper.JasperException: with the error: \"The function string \nmust be used with a prefix when a default namespace is not specified\" when \ntrying to compile the following within a JSP page:\n\n<foo:set var=\"bar\" value=\"this $ is a { silly string (\"/>\n\n\"foo\" is our own tablib, it seems that Jasper seems to think that the string \nprovided to the value attribute contains some JSP/EL which it does not.\n\nIf I change the page to be:\n\n<c:set var=\"bar\" value=\"this $ is a { silly string (\"/>\n\nThen I do not get this error. However I need to use my own taglib.\nIn the foo.tld file, the \"value\" attribute of \"set\" has rtexprvalue=true.\nIf I set this to false then the problem goes away. However I noticed that c.tld \nin standard.jar also has rtexprvalue=true for the \"value\" attribute of \"set\". \nWhy the difference in behaviour ? We also wish to have rtexprvalue=true.','2005-02-02 14:55:18','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 major','b55e9c2','Mark Emlyn David Thomas','2006-09-09 23:53:42','Port fix for bug 33356 from TC5','java/org/apache/jasper/compiler/ELParser.java'),(2259,31804,'Bug 31804 – setParent() is not called on nested tags in a tag file (.tagx)','','2004-10-20 16:26:40','Firepica','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P3 major','2d6d717','Mark Emlyn David Thomas','2006-09-09 17:14:49','Port fix for bug 31804 from TC5. Set the parent of unnested tags within a tag file to be the tag represented by the tag file.','java/org/apache/jasper/compiler/Generator.java'),(2260,38713,'Bug 38713 – java.io.IOException: tmpFile.renameTo(classFile) failed when compiling new JSP (upon redeploy)','[http-8080-Processor24 ERROR 26902165 DispatcherServlet.serviceWrapper()] -\nCould not complete request\norg.apache.jasper.JasperException: Unable to compile class for JSP\n        at\norg.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:565)\n        at\norg.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:293)\n        at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:291)\n        at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:241)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:802)\n        at\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:252)\n        at\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)\n        at\norg.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:672)\n        at\norg.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:463)\n        at\norg.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:398)\n        at\norg.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:301)\n        at\norg.springframework.web.servlet.view.InternalResourceView.renderMergedOutputModel(InternalResourceView.java:97)\n        at\norg.springframework.web.servlet.view.AbstractView.render(AbstractView.java:250)\n        at\norg.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:928)\n        at\norg.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:705)\n        at\norg.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:625)\n        at\norg.springframework.web.servlet.FrameworkServlet.serviceWrapper(FrameworkServlet.java:386)\n        at\norg.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:346)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:689)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:802)\n        at\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:252)\n        at\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)\n        at\norg.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:213)\n        at\norg.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:178)\n        at\norg.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:126)\n        at\norg.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:105)\n        at\norg.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:107)\n        at\norg.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:148)\n        at\norg.apache.coyote.http11.Http11Processor.process(Http11Processor.java:856)\n        at\norg.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnection(Http11Protocol.java:744)\n        at\norg.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:527)\n        at\norg.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:80)\n        at\norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:684)\n        at java.lang.Thread.run(Thread.java:595)\n[http-8080-Processor24 ERROR 26902165 [wirelessapp].invoke()] -\nServlet.service() for servlet wirelessapp threw exception\njava.io.IOException: tmpFile.renameTo(classFile) failed\n        at\norg.apache.jasper.compiler.SmapUtil$SDEInstaller.install(SmapUtil.java:245)\n        at org.apache.jasper.compiler.SmapUtil.installSmap(SmapUtil.java:164)\n        at\norg.apache.jasper.compiler.AntCompiler.generateClass(AntCompiler.java:267)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:288)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:267)\n        at org.apache.jasper.compiler.Compiler.compile(Compiler.java:255)\n        at\norg.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:556)\n        at\norg.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:293)\n        at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:291)\n        at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:241)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:802)\n        at\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:252)\n        at\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)\n        at\norg.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:672)\n        at\norg.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:463)\n        at\norg.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:398)\n        at\norg.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:301)\n        at\norg.springframework.web.servlet.view.InternalResourceView.renderMergedOutputModel(InternalResourceView.java:97)\n        at\norg.springframework.web.servlet.view.AbstractView.render(AbstractView.java:250)\n        at\norg.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:928)\n        at\norg.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:705)\n        at\norg.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:625)\n        at\norg.springframework.web.servlet.FrameworkServlet.serviceWrapper(FrameworkServlet.java:386)\n        at\norg.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:346)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:689)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:802)\n        at\norg.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:252)\n        at\norg.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)\n        at\norg.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:213)\n        at\norg.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:178)\n        at\norg.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:126)\n        at\norg.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:105)\n        at\norg.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:107)\n        at\norg.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:148)\n        at\norg.apache.coyote.http11.Http11Processor.process(Http11Processor.java:856)\n        at\norg.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.processConnection(Http11Protocol.java:744)\n        at\norg.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:527)\n        at\norg.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:80)\n        at\norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:684)\n        at java.lang.Thread.run(Thread.java:595)','2006-02-20 08:08:04','Eric','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P3 normal','c7f0f60','Remy Maucherat','2006-09-02 05:28:35','- Separate processing of exceptions from the servlet (so that IOE doesn\'t cause problems anymore: bug 38713). - Only Compiler will attempt to remove the files (before the compilation), otherwise multiple things can happen   in parallel. - Code cleanup (I suppose I\'ll have to do a big cleanup soon ...).','java/org/apache/jasper/JspCompilationContext.java\njava/org/apache/jasper/compiler/Compiler.java\njava/org/apache/jasper/servlet/JspServletWrapper.java'),(2261,39704,'Bug 39704 – context with privileged=\"true\" do not setup properly inner loaders','Tomcat 5.5.17. When specifying in TOMCAT/conf/context.xml a loader tag, context\nwith privileged=\"true\" are not properly setup.\n\nFor example with this TOMCAT/conf/context.xml:\n[quote]\n<!-- The contents of this file will be loaded for each web application -->\n<Context>\n    <!-- Default set of monitored resources -->\n    <WatchedResource>WEB-INF/web.xml</WatchedResource>\n    <!-- * ADD THIS *  -->\n	 <Loader />\n    <!-- Uncomment this to disable session persistence across Tomcat restarts-->\n    <!--\n    <Manager pathname=\"\" />\n    -->\n\n</Context>\n[/quote]\n\ngives the following error at startup:\nERROR Exception starting filter BalancerFilter -\norg.apache.catalina.core.StandardContext.filterStart(StandardContext.java:3604)\njava.lang.NoClassDefFoundError: org/apache/tomcat/util/digester/Digester\n	at org.apache.webapp.balancer.RulesParser.createDigester(RulesParser.java:65)\n	at org.apache.webapp.balancer.RulesParser.<init>(RulesParser.java:43)\n	at org.apache.webapp.balancer.BalancerFilter.init(BalancerFilter.java:79)\n	at\norg.apache.catalina.core.ApplicationFilterConfig.getFilter(ApplicationFilterConfig.java:223)\n	at\norg.apache.catalina.core.ApplicationFilterConfig.setFilterDef(ApplicationFilterConfig.java:304)\n	at\norg.apache.catalina.core.ApplicationFilterConfig.<init>(ApplicationFilterConfig.java:77)\n	at org.apache.catalina.core.StandardContext.filterStart(StandardContext.java:3600)\n	at org.apache.catalina.core.StandardContext.start(StandardContext.java:4193)\n	at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:759)\n	at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:739)\n	at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:524)\n	at org.apache.catalina.startup.HostConfig.deployDirectory(HostConfig.java:904)\n	at org.apache.catalina.startup.HostConfig.deployDirectories(HostConfig.java:867)\n	at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:474)\n	at org.apache.catalina.startup.HostConfig.start(HostConfig.java:1122)\n	at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:310)\n	at\norg.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\n	at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1021)\n	at org.apache.catalina.core.StandardHost.start(StandardHost.java:718)\n	at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1013)\n	at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:442)\n	at org.apache.catalina.core.StandardService.start(StandardService.java:450)\n	at org.apache.catalina.core.StandardServer.start(StandardServer.java:709)\n	at org.apache.catalina.startup.Catalina.start(Catalina.java:551)\n	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n	at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)\n	at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)\n	at java.lang.reflect.Method.invoke(Unknown Source)\n	at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:294)\n	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:432)\nERROR Error filterStart -\norg.apache.catalina.core.StandardContext.start(StandardContext.java:4194)\nERROR Context [/balancer] startup failed due to previous errors -\norg.apache.catalina.core.StandardContext.start(StandardContext.java:4215)\n\nNote that this is a default install w/o any custom webapps just with the empty\nloader tag added.\n\nIt seems that the digester rules do not handle this case appropriately.','2006-06-02 09:48:13','Costin Leau','Tomcat Developers Mailing List','RESOLVED INVALID','Tomcat 5','Catalina','P2 normal','9930ead','Remy Maucherat','2006-09-01 19:06:02','- API change for the constructor of Loader: if not specified, the loader will get the parent CL from the context,   avoiding the problems of ignoring the privileged flag in some cases as seen in bug 39704.','java/org/apache/catalina/loader/WebappLoader.java\njava/org/apache/catalina/startup/ContextRuleSet.java'),(2262,40306,'Bug 40306 – mod_jk, POST request bodies are not restored on successful login when using mod_jk','After the FormAuthenticator intercepts a POST request to a protected resource,\nthe original request is not properly restored upon successful login when using\nmod_jk. When connectiong to tomcat directly (8080), the POST request is restored\nas expected.\n\nI\'ve tested this with mod_jk 1.2.15 and 1.2.18. It seems the problem is that the\norginal request is not saved properly. I (think) I\'ve narrowed down the issue in\n  FormAuthenticator.java. body.toString() was returning null. (The buffer was\nnull) so it looks like the root of the problem is that nothing is read from the\ninput stream.\n\nDuring testing I reverted to the old way of adding the request parameters\n(saved.addParameter()) to see if they were indeed there and it worked. \n\nI also tried,\nInputStream is = new BufferedInputStream(request.getInputStream()); \nwhich didn\'t work..\n\n\nfrom FormAuthenticator.java: \n\nprotected void saveRequest(Request request, Session session)\n        throws IOException {\n\n      ...\n\n      if (\"POST\".equalsIgnoreCase(request.getMethod())) {\n            ByteChunk body = new ByteChunk();\n            body.setLimit(request.getConnector().getMaxSavePostSize());\n\n            byte[] buffer = new byte[4096];\n            int bytesRead;\n            InputStream is = request.getInputStream();\n        \n            while ( (bytesRead = is.read(buffer) ) >= 0) {\n                body.append(buffer, 0, bytesRead);\n            }\n			\n            saved.setBody(body);\n        } \n\n        ...\n}','2006-08-23 19:48:03','Aaron Loucks','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat Connectors','Common','P2 major','a91b95e','William Barker','2006-08-28 00:49:31','Porting fix for BZ #40306','java/org/apache/coyote/ajp/AjpAprProcessor.java\njava/org/apache/jk/core/MsgContext.java'),(2263,38676,'Bug 38676 – permanently reloading tagfile classes without changes to the tagfile','Scenario:\n\n- jsp with a tag in it (tagfile, no taglib)\n- activate \"reloading\" in web.xml\n- clean work directory\n- start tomcat\n- load jsp\n\nTomcat generates/compiles/load the jsp and the tagfile classes. After\n\"checkInterval\" seconds the background compile thread \"JspRuntimeContext[\\*]\"\nloads the tagfile classes (and only them) again and again. This produces a lot\nof work for the garbage collector. (permanently class unloading of tagfile classes)\n\nA Breakpoint in the method loadTagFile() in JspServletWrapper.java will show\nthis. Perhaps the reload flag must be set to false after loading the TagFile?\n\nJspServletWrapper.java:\n...\n\nif(reload) {\n   tagHandlerClass = ctxt.load();\n   reload = false;  //perhaps, this solves the problem but i am not shure\n}\n\n...\n\nAfter restarting the server the problem is not present because no\nJspServletWrapper is instantiated for the tagfile an therefore the backround\ncompile task does not check the tagfile.','2006-02-16 11:48:57','Georg Zimmermann','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Jasper','P2 normal','edc20fa','Remy Maucherat','2006-08-18 10:32:34','- Add two lost Jasper patches (which were applied to the old Jasper/TC6 repository). - 38676 - 39803 (not sure if the fix is complete)','java/org/apache/el/lang/ELSupport.java\njava/org/apache/jasper/servlet/JspServletWrapper.java'),(2264,39803,'Bug 39803 – Unified EL impl doesn\'t support enums','Forgive me if Jacob already fixed this.  Now that Tomcat 6 Bugzilla seems to be\nworking, I wanted to get this in here so it won\'t be forgotten.\n\nLast time I checked, enum support, as defined in section 1.18.6 of the EL spec,\nwas missing.','2006-06-13 18:18:14','Stan Silvert','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Catalina','P2 blocker','edc20fa','Remy Maucherat','2006-08-18 10:32:34','- Add two lost Jasper patches (which were applied to the old Jasper/TC6 repository). - 38676 - 39803 (not sure if the fix is complete)','java/org/apache/el/lang/ELSupport.java\njava/org/apache/jasper/servlet/JspServletWrapper.java'),(2265,39592,'Bug 39592 – SSI does not correctly process HEAD request','Hello,\n\nI think there is a small bug in Tomcat 5.0 and 5.5 (at least I could see it already with many versions of \nTomcat).\n\nI use SSI \n          org.apache.catalina.ssi.SSIServlet\n\nand\n\n     <param-name>isVirtualWebappRelative</param-name>\n          <param-value>1</param-value>\n\n\nAll my pages (*.html) are processed by the SSI\n        <url-pattern>*.html</url-pattern>\n\nIf there is a normal GET request, SSI compiles a page and everything is just OK.\n\nHowever, for  the HEAD request to the same page (there is no need to compile the page) the SSI still \ntries to do it and generates a number of exceptions (see enclosed).\n\nThis error is not critical but overloads my catalina.out file. I do not think that it is difficult to fix it.\n\nI already reported this error to tomcat-dev, but decided to create a formal \"bug\" report at ASF Bugzilla \nto see if it was already fixed or not. This is not a big error, but it is annoying.\n\nThanks!\n\nWith the best regards,\nIgor Tetko\n\n*****\n\nApr 28, 2006 11:26:45 AM org.apache.catalina.core.ApplicationContext log\nSEVERE: #include--Couldn\'t include file: styles.html\njava.io.IOException: Couldn\'t find file: /incl/styles.html\n        at org.apache.catalina.ssi.SSIServletExternalResolver.getFileText(SSIServletExternalResolver.java:\n537)\n        at org.apache.catalina.ssi.SSIMediator.getFileText(SSIMediator.java:155)\n        at org.apache.catalina.ssi.SSIInclude.process(SSIInclude.java:44)\n        at org.apache.catalina.ssi.SSIProcessor.process(SSIProcessor.java:146)\n        at org.apache.catalina.ssi.SSIServlet.processSSI(SSIServlet.java:221)\n        at org.apache.catalina.ssi.SSIServlet.requestHandler(SSIServlet.java:187)\n        at org.apache.catalina.ssi.SSIServlet.doGet(SSIServlet.java:123)\n        at javax.servlet.http.HttpServlet.doHead(HttpServlet.java:270)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:706)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:802)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:252)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)\n        at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:672)\n        at org.apache.catalina.core.ApplicationDispatcher.doInclude(ApplicationDispatcher.java:574)\n        at org.apache.catalina.core.ApplicationDispatcher.include(ApplicationDispatcher.java:499)\n        at org.apache.catalina.ssi.SSIServletExternalResolver.getFileText(SSIServletExternalResolver.java:\n519)\n        at org.apache.catalina.ssi.SSIMediator.getFileText(SSIMediator.java:155)\n        at org.apache.catalina.ssi.SSIInclude.process(SSIInclude.java:44)\n        at org.apache.catalina.ssi.SSIProcessor.process(SSIProcessor.java:146)\n        at org.apache.catalina.ssi.SSIServlet.processSSI(SSIServlet.java:221)\n        at org.apache.catalina.ssi.SSIServlet.requestHandler(SSIServlet.java:187)\n        at org.apache.catalina.ssi.SSIServlet.doGet(SSIServlet.java:123)\n        at javax.servlet.http.HttpServlet.doHead(HttpServlet.java:270)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:706)\n        at javax.servlet.http.HttpServlet.service(HttpServlet.java:802)\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:252)\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:173)\n        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:213)\n        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:178)\n        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:126)\n        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:105)\n        at org.apache.catalina.valves.FastCommonAccessLogValve.invoke\n(FastCommonAccessLogValve.java:495)\n        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:107)\n        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:148)\n        at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:869)\n        at org.apache.coyote.http11.Http11BaseProtocol$Http11ConnectionHandler.processConnection\n(Http11BaseProtocol.java:664)\n        at org.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:527)\n        at org.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt\n(LeaderFollowerWorkerThread.java:80)\n        at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:684)\n        at java.lang.Thread.run(Thread.java:613)','2006-05-16 17:40:47','Igor Tetko','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Servlets:SSI','P2 minor','0f9844c','Mark Emlyn David Thomas','2006-07-26 20:34:35','Port of fix for bug 39592. Stop stack traces for HEAD requests.','java/org/apache/catalina/ssi/SSIServletExternalResolver.java'),(2266,40053,'Bug 40053 – documentation of shared lib location is inconsistent','','2006-07-16 20:35:43','Dietrich Schmidt','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Webapps:Documentation','P2 normal','df639cb','Mark Emlyn David Thomas','2006-07-22 18:04:22','Port fix for bug 40053. Correct app deployment doc with respect to shared lib and CATALINA_BASE.','webapps/docs/appdev/deployment.xml'),(2267,39689,'Bug 39689 – Tomcat Server Side Includes (SSI) do not work with single quotes','','2006-05-31 07:46:22','Jose Vano','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Servlets:SSI','P2 minor','8ed77be','Mark Emlyn David Thomas','2006-07-22 17:48:51','Port fix bug 39689. Allow same quoting for SSI attribute values as httpd.','java/org/apache/catalina/ssi/SSIProcessor.java'),(2268,34801,'Bug 34801 – PATCH: CGIServlet does not terminate child after a timeout','','2005-05-08 06:47:30','Tomcat Developers Mailing List','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Servlets:CGI','P3 enhancement','c30afec','Mark Emlyn David Thomas','2006-07-21 20:19:59','Port partial fix for 34801','java/org/apache/catalina/servlets/CGIServlet.java'),(2269,40012,'Bug 40012 – Legacy EL Support not resolving variables correctly','Given the following page:\n<% pageContext.setAttribute(\"t\", \"foo\"); %>\n${t}\n<%\nout.print(\n    pageContext.getExpressionEvaluator().evaluate(\n        \"${t}\",\n        String.class,\n        pageContext.getVariableResolver(),\n        null));\n%>\n\nYou will notice that the ${t} prints out fine when in the JSP but does not\nresolve using the scriplet and prints nothing.\n\nFor a sanity check, I tested this and it worked in glassfish to ensure I wasn\'t\ndoing anything odd.\n\nI\'m trying to find root cause; but haven\'t found it yet, so I\'m logging it in\ncase anyone else has the itch to scratch.','2006-07-11 13:00:29','Tim Funk','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 6','Jasper','P2 normal','01a9b59','Timothy A. Funk','2006-07-11 13:51:14','40012 - Legacy EL Support not resolving variables correctly','java/org/apache/jasper/el/VariableResolverImpl.java'),(2270,39865,'Bug 39865 – Not able to open Openoffice files','I am using tomcat 5.5. When I use to open the openoffice files (.odp, .odb, \netc.,) files the files are not opening and just appearing a small ican in the \ntop lesthand corner of the Internet Explorer browser.\n\nPlease help to fix this issue\n\n\nThanks\n\nregards\nkumar','2006-06-22 14:59:35','kumar','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P1 major','2ba5e6a','Mark Emlyn David Thomas','2006-07-08 18:55:15','Add open office mime-types. Port of fix for bug 39865 from TC5.','conf/web.xml'),(2271,39769,'Bug 39769 – Wrong class loader when the myServlet.destroy() called if myServlet is in the T5 shared directory','Hi all,\n\n  My web app needs to have Thread.currentThread().getContextClassLoader() always\nright.  When the application is unload it seem not be the case. \n\nMy classes are under the T5\'s shared directory (so all my\nservlet.getClass().getClassLoader() == the shared classloader i.e.:\nStandardCalssLoader.\n\nMy understanding is that when executing the code in my web app\nThread.currentThread().getContextClassLoader() should always give the\nWebappLoader used in the StandardContext.\n\nThe problem occurs in StandardWrapper.unload()  before calling the\nservlet.destroy() method\n\n....\n        ClassLoader oldCtxClassLoader =\n            Thread.currentThread().getContextClassLoader();\n        ClassLoader classLoader = instance.getClass().getClassLoader();\n\n        PrintStream out = System.out;\n        if (swallowOutput) {\n            SystemLogHandler.startCapture();\n        }\n\n        // Call the servlet destroy() method\n        try {\n            instanceSupport.fireInstanceEvent\n              (InstanceEvent.BEFORE_DESTROY_EVENT, instance);\n\n            Thread.currentThread().setContextClassLoader(classLoader);\n            if( System.getSecurityManager() != null) {\n                SecurityUtil.doAsPrivilege(\"destroy\",\n                                           instance);\n                SecurityUtil.remove(instance);                          \n            } else {\n                instance.destroy();\n            }\n\n....\n\nIn the code, the INSTANCE variable is my servlet and it have been loaded by the\nSHARED classloader.  So the classloader set in the thread is not the right one.\n It Should be the classloader related to StandardContext.getLoader()\n\nThis problem occurs when I try to close my T5 dos windows and I suppose will\noccurs when I will uninstall any webApp from my T5.\n\nI notice the problem in T5 5.5.16 but I verified and it\'s the same code in\n5.5.17.  So probably the problem is still there\n\n\nBest Regards\n/David Gagnon','2006-06-09 20:09:27','David Gagnon','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','276e5ac','Mark Emlyn David Thomas','2006-06-11 17:53:53','Port fix for bug 39769. Remove the classloader switching from unload. It was removed from load some time ago. Patch provided by David Gagnon.','java/org/apache/catalina/core/StandardWrapper.java'),(2272,39752,'Bug 39752 – Tomcat 5.5.17 SSI ignores request for .shtml','I followed the instructions for enabling Tomcat to process SSI requests \n(rename files, uncomment servlet and servlet mapping in web.xml) but I cannot \nget Tomcat 5.5.17 to serve up the page.  It ignores the request entirely and \nseems to return nothing.\n\nI\'ve been using this functionality in 5.5.9 with no problems.  I have both \nversions of Tomcat installed locally on my development machine and the files \nthat are processed in 5.5.9 are not processed in 5.5.17.  I\'ve also tried to \nmodify a separate machine running 5.5.15 and get the same behavoir as 5.5.17.','2006-06-07 15:54:46','Ed Lizak','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Servlets:SSI','P2 major','9149320','Mark Emlyn David Thomas','2006-06-09 19:09:40','Port fix for bug 39752 from 5.5.x.','conf/web.xml'),(2273,39699,'Bug 39699 – simple deploy failed in cluster (distributable flag)','Hi,\n\ni encounter a strange problem with my tomcat cluster and webapps deployment.\n\nserver.xml\n--------------------------------\n<Server port=\"8005\" shutdown=\"SHUTDOWN\">\n\n  <Listener className=\"org.apache.catalina.core.AprLifecycleListener\" />\n  <Listener className=\"org.apache.catalina.mbeans.ServerLifecycleListener\" />\n  <Listener\nclassName=\"org.apache.catalina.mbeans.GlobalResourcesLifecycleListener\" />\n  <Listener\nclassName=\"org.apache.catalina.storeconfig.StoreConfigLifecycleListener\"/>\n\n  <!-- Global JNDI resources -->\n  <GlobalNamingResources>\n\n    <Environment name=\"simpleValue\" type=\"java.lang.Integer\" value=\"30\"/>\n    <Resource name=\"UserDatabase\" auth=\"Container\"\n              type=\"org.apache.catalina.UserDatabase\"\n       description=\"User database that can be updated and saved\"\n           factory=\"org.apache.catalina.users.MemoryUserDatabaseFactory\"\n          pathname=\"conf/tomcat-users.xml\" />\n\n  </GlobalNamingResources>\n\n\n  <!-- Define the Tomcat Stand-Alone Service -->\n  <Service name=\"Catalina\">\n\n\n    <!-- Define a non-SSL HTTP/1.1 Connector on port 8080 -->\n    <Connector address=\"polen-integ\" port=\"8080\" maxHttpHeaderSize=\"8192\"\n               maxThreads=\"300\" minSpareThreads=\"25\" maxSpareThreads=\"100\"\n               enableLookups=\"false\" acceptCount=\"100\"\n               connectionTimeout=\"20000\" disableUploadTimeout=\"true\" />\n\n    <!-- Define an AJP 1.3 Connector on port 8009 -->\n    <Connector port=\"8009\"\n               address=\"polen-integ.sofinco.fr\"\n               minProcessors=\"20\" maxProcessors=\"0\" maxThreads=\"350\"\nminSpareThreads=\"50\" maxSpareThreads=\"100\"\n               enableLookups=\"false\" redirectPort=\"8080\" protocol=\"AJP/1.3\"\ndisableUploadTimeout=\"true\" />\n\n     <Engine name=\"Catalina\" defaultHost=\"localhost\" jvmRoute=\"uxdev103\" >\n\n      <Realm className=\"org.apache.catalina.realm.UserDatabaseRealm\"\nresourceName=\"UserDatabase\"/>\n\n      <Host name=\"localhost\" appBase=\"webapps\" unpackWARs=\"true\" autoDeploy=\"true\"\n       xmlValidation=\"false\" xmlNamespaceAware=\"false\" >\n\n <!-- Cluster Definition -->\n\n        <Cluster className=\"org.apache.catalina.cluster.tcp.SimpleTcpCluster\"\n                doClusterLog=\"true\" clusterLogName=\"clusterlog\"\n                expireSessionsOnShutdown=\"false\"\n                useDirtyFlag=\"true\"\n                notifyListenersOnReplication=\"true\">\n\n        <Membership className=\"org.apache.catalina.cluster.mcast.McastService\"\n                mcastAddr=\"228.0.0.4\"\n                mcastBindAddress=\"127.0.0.1\"\n                mcastClusterDomain=\"polen-integ\"\n                mcastPort=\"45564\"\n                mcastFrequency=\"1000\"\n                mcastDropTime=\"30000\"/>\n\n        <Receiver className=\"org.apache.catalina.cluster.tcp.ReplicationListener\"\n                tcpListenAddress=\"polen-integ\"\n                tcpSelectorTimeout=\"100\"\n                tcpThreadCount=\"6\"/>\n\n        <Sender className=\"org.apache.catalina.cluster.tcp.ReplicationTransmitter\"\n                replicationMode=\"fastasyncqueue\"\n                doTransmitterProcessingStats=\"true\"\n                doProcessingStats=\"false\"\n                doWaitAckStats=\"false\"\n                waitForAck=\"false\"\n                keepAliveMaxRequestCount=\"-1\"/>\n\n        <Valve className=\"org.apache.catalina.cluster.tcp.ReplicationValve\"\n               \nfilter=\".*\\.gif;.*\\.js;.*\\.css;.*\\.png;.*\\.jpeg;.*\\.jpg;.*\\.htm;.*\\.html;.*\\.txt;\"\n/>\n\n        <Valve className=\"org.apache.catalina.cluster.session.JvmRouteBinderValve\"\n                enabled=\"true\" />\n\n        <ClusterListener\nclassName=\"org.apache.catalina.cluster.session.ClusterSessionListener\" />\n\n        <ClusterListener\nclassName=\"org.apache.catalina.cluster.session.JvmRouteSessionIDBinderListener\" />\n\n        <Deployer className=\"org.apache.catalina.cluster.deploy.FarmWarDeployer\"\n                tempDir=\"/home/tomcat/polen-integ/tmp/war-temp/\"\n                deployDir=\"${catalina.base}/webapps\"\n                watchDir=\"/home/tomcat/polen-integ/tmp/war-listen/\"\n                watchEnabled=\"true\"/>\n\n        </Cluster>\n\n      </Host>\n    </Engine>\n\n  </Service>\n\n</Server>\n------------------------\n\n\n\nwhen i am trying to deploy a \'dsitributable\' (and only when this flag is\nenabled) i get the following errors :\n\n---------------------------\nINFO ContainerBackgroundProcessor[StandardEngine[Catalina]]\norg.apache.catalina.startup.HostConfig - Deploying web application archive po\nlen.war\n INFO ContainerBackgroundProcessor[StandardEngine[Catalina]]\norg.apache.catalina.loader.WebappClassLoader - Illegal access: this web appli\ncation instance has been stopped already.  Could not load java.io.PrintStream. \nThe eventual following stack trace is caused by an error t\nhrown for debugging purposes as well as to attempt to terminate the thread which\ncaused the illegal access, and has no functional impact.\n java.lang.IllegalStateException\n        at\norg.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1238)\n        at\norg.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1198)\n        at java.lang.ClassLoader.loadClassInternal(Unknown Source)\n        at org.apache.log4j.helpers.LogLog.error(LogLog.java:142)\n        at\norg.apache.log4j.helpers.PatternParser$DatePatternConverter.convert(PatternParser.java:447)\n        at\norg.apache.log4j.helpers.PatternConverter.format(PatternConverter.java:64)\n        at org.apache.log4j.PatternLayout.format(PatternLayout.java:503)\n        at org.apache.log4j.WriterAppender.subAppend(WriterAppender.java:301)\n        at\norg.apache.log4j.RollingFileAppender.subAppend(RollingFileAppender.java:234)\n        at org.apache.log4j.WriterAppender.append(WriterAppender.java:159)\n        at org.apache.log4j.AppenderSkeleton.doAppend(AppenderSkeleton.java:230)\n        at\norg.apache.log4j.helpers.AppenderAttachableImpl.appendLoopOnAppenders(AppenderAttachableImpl.java:65)\n        at org.apache.log4j.Category.callAppenders(Category.java:203)\n        at org.apache.log4j.Category.forcedLog(Category.java:388)\n        at org.apache.log4j.Category.log(Category.java:853)\n        at org.apache.commons.logging.impl.Log4JLogger.info(Log4JLogger.java:133)\n        at\norg.apache.catalina.cluster.session.DeltaManager.start(DeltaManager.java:976)\n        at org.apache.catalina.core.ContainerBase.setManager(ContainerBase.java:431)\n        at org.apache.catalina.core.StandardContext.start(StandardContext.java:4125)\n at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:739)\n        at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:524)\n        at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:809)\n        at org.apache.catalina.startup.HostConfig.deployWARs(HostConfig.java:698)\n        at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:472)\n        at org.apache.catalina.startup.HostConfig.check(HostConfig.java:1190)\n        at\norg.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:292)\n        at\norg.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\n        at\norg.apache.catalina.core.ContainerBase.backgroundProcess(ContainerBase.java:1305)\n        at\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1569)\n        at\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1578)\n        at\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.run(ContainerBase.java:1558)\n        at java.lang.Thread.run(Unknown Source)\nINFO ContainerBackgroundProcessor[StandardEngine[Catalina]]\norg.apache.catalina.loader.WebappClassLoader - Illegal access: this web applic\nation instance has been stopped already.  Could not load java.io.PrintStream. \nThe eventual following stack trace is caused by an error th\nrown for debugging purposes as well as to attempt to terminate the thread which\ncaused the illegal access, and has no functional impact.\n Java.lang.IllegalStateException\n        at\norg.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1238)\n        at\norg.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1198)\n        at java.lang.ClassLoader.loadClassInternal(Unknown Source)\n        at org.apache.log4j.helpers.LogLog.error(LogLog.java:142)\n        at\norg.apache.log4j.helpers.PatternParser$DatePatternConverter.convert(PatternParser.java:447)\n        at\norg.apache.log4j.helpers.PatternConverter.format(PatternConverter.java:64)\n        at org.apache.log4j.PatternLayout.format(PatternLayout.java:503)\n        at org.apache.log4j.WriterAppender.subAppend(WriterAppender.java:301)\n        at\norg.apache.log4j.RollingFileAppender.subAppend(RollingFileAppender.java:234)\n        at org.apache.log4j.WriterAppender.append(WriterAppender.java:159)\n        at org.apache.log4j.AppenderSkeleton.doAppend(AppenderSkeleton.java:230)\n        at\norg.apache.log4j.helpers.AppenderAttachableImpl.appendLoopOnAppenders(AppenderAttachableImpl.java:65)\n        at org.apache.log4j.Category.callAppenders(Category.java:203)\n        at org.apache.log4j.Category.forcedLog(Category.java:388)\n        at org.apache.log4j.Category.log(Category.java:853)\n        at org.apache.commons.logging.impl.Log4JLogger.info(Log4JLogger.java:133)\n        at\norg.apache.catalina.cluster.session.DeltaManager.start(DeltaManager.java:976)\n at org.apache.catalina.core.ContainerBase.setManager(ContainerBase.java:431)\n        at org.apache.catalina.core.StandardContext.start(StandardContext.java:4125)\n        at\norg.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:759)\n        at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:739)\n        at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:524)\n        at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:809)\n        at org.apache.catalina.startup.HostConfig.deployWARs(HostConfig.java:698)\n        at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:472)\n        at org.apache.catalina.startup.HostConfig.check(HostConfig.java:1190)\n        at\norg.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:292)\n        at\norg.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\n        at\norg.apache.catalina.core.ContainerBase.backgroundProcess(ContainerBase.java:1305)\n        at\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1569)\n        at\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1578)\n        at\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.run(ContainerBase.java:1558)\n        at java.lang.Thread.run(Unknown Source)\nINFO ContainerBackgroundProcessor[StandardEngine[Catalina]]\norg.apache.catalina.loader.WebappClassLoader - Illegal access: this web applic\nation instance has been stopped already.  Could not load\norg.apache.log4j.spi.VectorWriter.  The eventual following stack trace is caused\nby an error thrown for debugging purposes as well as to attempt to terminate the\nthread which caused the illegal access, and has no functi\nonal impact.\n java.lang.IllegalStateException\n        at\norg.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1238)\n        at\norg.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1198)\n        at java.lang.ClassLoader.loadClassInternal(Unknown Source)\n        at org.apache.log4j.spi.LoggingEvent.<init>(LoggingEvent.java:154)\n        at org.apache.log4j.Category.forcedLog(Category.java:388)\n        at org.apache.log4j.Category.log(Category.java:853)\n        at org.apache.commons.logging.impl.Log4JLogger.error(Log4JLogger.java:193)\n        at\norg.apache.catalina.cluster.session.DeltaManager.start(DeltaManager.java:990)\n        at org.apache.catalina.core.ContainerBase.setManager(ContainerBase.java:431)\n        at org.apache.catalina.core.StandardContext.start(StandardContext.java:4125)\n        at\norg.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:759)\n        at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:739)\n        at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:524)\n        at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:809)\n        at org.apache.catalina.startup.HostConfig.deployWARs(HostConfig.java:698)\n        at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:472)\n at org.apache.catalina.startup.HostConfig.check(HostConfig.java:1190)\n        at\norg.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:292)\n        at\norg.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\n        at\norg.apache.catalina.core.ContainerBase.backgroundProcess(ContainerBase.java:1305)\n        at\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1569)\n        at\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1578)\n        at\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.run(ContainerBase.java:1558)\n        at java.lang.Thread.run(Unknown Source)\nINFO ContainerBackgroundProcessor[StandardEngine[Catalina]]\norg.apache.catalina.loader.WebappClassLoader - Illegal access: this web applic\nation instance has been stopped already.  Could not load\norg.apache.log4j.spi.VectorWriter.  The eventual following stack trace is caused\nby an error thrown for debugging purposes as well as to attempt to terminate the\nthread which caused the illegal access, and has no functi\nonal impact.\n java.lang.IllegalStateException\n        at\norg.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1238)\n        at\norg.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1198)\n        at java.lang.ClassLoader.loadClassInternal(Unknown Source)\n        at org.apache.log4j.spi.LoggingEvent.<init>(LoggingEvent.java:154)\n        at org.apache.log4j.Category.forcedLog(Category.java:388)\n        at org.apache.log4j.Category.log(Category.java:853)\n        at org.apache.commons.logging.impl.Log4JLogger.error(Log4JLogger.java:193)\n        at\norg.apache.catalina.cluster.session.DeltaManager.start(DeltaManager.java:990)\n        at org.apache.catalina.core.ContainerBase.setManager(ContainerBase.java:431)\n        at org.apache.catalina.core.StandardContext.start(StandardContext.java:4125)\n        at\norg.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:759)\n        at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:739)\n        at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:524)\n        at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:809)\n        at org.apache.catalina.startup.HostConfig.deployWARs(HostConfig.java:698)\n        at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:472)\n        at org.apache.catalina.startup.HostConfig.check(HostConfig.java:1190)\n        at\norg.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:292)\n        at\norg.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\n        at\norg.apache.catalina.core.ContainerBase.backgroundProcess(ContainerBase.java:1305)\n        at\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1569)\n        at\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1578)\n        at\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.run(ContainerBase.java:1558)\n        at java.lang.Thread.run(Unknown Source)\nERROR ContainerBackgroundProcessor[StandardEngine[Catalina]]\norg.apache.commons.modeler.Registry - Null component Catalina:type=JspMonitor\n,name=jsp,WebModule=//localhost/polen,J2EEApplication=none,J2EEServer=none\n ERROR ContainerBackgroundProcessor[StandardEngine[Catalina]]\norg.apache.catalina.startup.HostConfig - Error deploying web application arc\nhive polen.war\n java.lang.NoClassDefFoundError: org/apache/log4j/spi/VectorWriter\n        at org.apache.log4j.spi.LoggingEvent.<init>(LoggingEvent.java:154)\n        at org.apache.log4j.Category.forcedLog(Category.java:388)\n        at org.apache.log4j.Category.log(Category.java:853)\n        at org.apache.commons.logging.impl.Log4JLogger.error(Log4JLogger.java:193)\n        at\norg.apache.catalina.cluster.session.DeltaManager.start(DeltaManager.java:990)\n        at org.apache.catalina.core.ContainerBase.setManager(ContainerBase.java:431)\n        at org.apache.catalina.core.StandardContext.start(StandardContext.java:4125)\n        at\norg.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:759)\n        at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:739)\n        at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:524)\n        at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:809)\n        at org.apache.catalina.startup.HostConfig.deployWARs(HostConfig.java:698)\n        at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:472)\n        at org.apache.catalina.startup.HostConfig.check(HostConfig.java:1190)\n        at\norg.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:292)\n        at\norg.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\n        at\norg.apache.catalina.core.ContainerBase.backgroundProcess(ContainerBase.java:1305)\n        at\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1569)\n        at\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1578)\n        at\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.run(ContainerBase.java:1558)\n        at java.lang.Thread.run(Unknown Source)\nERROR ContainerBackgroundProcessor[StandardEngine[Catalina]]\norg.apache.catalina.startup.HostConfig - Error deploying web application arch\nive polen.war\n java.lang.NoClassDefFoundError: org/apache/log4j/spi/VectorWriter\n        at org.apache.log4j.spi.LoggingEvent.<init>(LoggingEvent.java:154)\n        at org.apache.log4j.Category.forcedLog(Category.java:388)\n        at org.apache.log4j.Category.log(Category.java:853)\n        at org.apache.commons.logging.impl.Log4JLogger.error(Log4JLogger.java:193)\n        at\norg.apache.catalina.cluster.session.DeltaManager.start(DeltaManager.java:990)\n        at org.apache.catalina.core.ContainerBase.setManager(ContainerBase.java:431)\n        at org.apache.catalina.core.StandardContext.start(StandardContext.java:4125)\n\nat org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:759)\n        at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:739)\n        at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:524)\n        at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:809)\n        at org.apache.catalina.startup.HostConfig.deployWARs(HostConfig.java:698)\n        at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:472)\n        at org.apache.catalina.startup.HostConfig.check(HostConfig.java:1190)\n        at\norg.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:292)\n        at\norg.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)\n        at\norg.apache.catalina.core.ContainerBase.backgroundProcess(ContainerBase.java:1305)\n        at\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1569)\n        at\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1578)\n        at\norg.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.run(ContainerBase.java:1558)\n        at java.lang.Thread.run(Unknown Source)\n---------------\n\ni have tried to deployed via web manager application or simple copy of my war in\nwebapps directory... No luck, if i put \'<distributable/> flag in application\nweb.xml config file, i encounter this error ; i need to restart manually tomcat\ninstance... After this restart the application is correctly deployed without any\nerror...\nOf course if i disable cluster in server.xml, no problem...','2006-06-01 16:28:04','Christophe Yayon','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 critical','7b870a4','Remy Maucherat','2006-06-08 10:50:07','- Create clustered managers with the Catalina CL set as the context CL (as classloading may occur). - Should fix 39699.','java/org/apache/catalina/core/StandardContext.java'),(2274,38113,'Bug 38113 – getQueryString returns null instead of empty-string','','2006-01-03 23:06:03','Dan Jacobs','Tomcat Developers Mailing List','RESOLVED FIXED','Tomcat 5','Catalina','P2 normal','5675009','Remy Maucherat','2006-03-30 12:41:19','- Revert fix for 38113, which doesn\'t seem to be a bug, and appears to be causing regressions.','java/org/apache/catalina/connector/Request.java');
/*!40000 ALTER TABLE `bug_commit` ENABLE KEYS */;
UNLOCK TABLES;
/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */;

/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;

-- Dump completed on 2019-03-07  0:36:04
